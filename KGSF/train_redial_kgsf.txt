[32m2025-02-05 04:59:00.848[0m | [1mINFO    [0m | [36mcrslab.config.config[0m:[36m__init__[0m:[36m79[0m - [1m[Dataset: ReDial tokenized in nltk][0m
[32m2025-02-05 04:59:00.849[0m | [1mINFO    [0m | [36mcrslab.config.config[0m:[36m__init__[0m:[36m81[0m - [1m[Model: KGSF][0m
[32m2025-02-05 04:59:00.849[0m | [1mINFO    [0m | [36mcrslab.config.config[0m:[36m__init__[0m:[36m88[0m - [1m[Config]
{
    "dataset": "ReDial",
    "tokenize": "nltk",
    "embedding": "word2vec.npy",
    "context_truncate": 256,
    "response_truncate": 30,
    "scale": 1,
    "model": "KGSF",
    "token_emb_dim": 300,
    "kg_emb_dim": 128,
    "num_bases": 8,
    "n_heads": 2,
    "n_layers": 2,
    "ffn_size": 300,
    "dropout": 0.1,
    "attention_dropout": 0.0,
    "relu_dropout": 0.1,
    "learn_positional_embeddings": false,
    "embeddings_scale": true,
    "reduction": false,
    "n_positions": 1024,
    "pretrain": {
        "epoch": 3,
        "batch_size": 128,
        "optimizer": {
            "name": "Adam",
            "lr": 0.001
        }
    },
    "rec": {
        "epoch": 9,
        "batch_size": 128,
        "optimizer": {
            "name": "Adam",
            "lr": 0.001
        }
    },
    "conv": {
        "epoch": 90,
        "batch_size": 128,
        "optimizer": {
            "name": "Adam",
            "lr": 0.001
        },
        "lr_scheduler": {
            "name": "ReduceLROnPlateau",
            "patience": 3,
            "factor": 0.5
        },
        "gradient_clip": 0.1
    },
    "gpu": [
        0
    ],
    "model_name": "KGSF"
}[0m
[32m2025-02-05 04:59:06.898[0m | [1mINFO    [0m | [36mcrslab.data.dataset.base[0m:[36m__init__[0m:[36m49[0m - [1m[Finish data load][0m
  0%|          | 0/8104 [00:00<?, ?it/s] 14%|█▎        | 1110/8104 [00:00<00:00, 11092.45it/s] 28%|██▊       | 2246/8104 [00:00<00:00, 11248.78it/s] 42%|████▏     | 3394/8104 [00:00<00:00, 11338.51it/s] 56%|█████▌    | 4543/8104 [00:00<00:00, 11396.70it/s] 70%|███████   | 5683/8104 [00:00<00:00, 4429.33it/s]  84%|████████▍ | 6815/8104 [00:01<00:00, 5577.44it/s] 98%|█████████▊| 7966/8104 [00:01<00:00, 6717.20it/s]100%|██████████| 8104/8104 [00:01<00:00, 7051.54it/s]
  0%|          | 0/8104 [00:00<?, ?it/s] 23%|██▎       | 1884/8104 [00:00<00:00, 18754.39it/s] 47%|████▋     | 3793/8104 [00:00<00:00, 18923.98it/s] 70%|███████   | 5686/8104 [00:00<00:00, 5325.40it/s]  94%|█████████▎| 7578/8104 [00:00<00:00, 7430.14it/s]100%|██████████| 8104/8104 [00:00<00:00, 8198.94it/s]
  0%|          | 0/901 [00:00<?, ?it/s]100%|██████████| 901/901 [00:00<00:00, 11462.14it/s]
  0%|          | 0/901 [00:00<?, ?it/s]100%|██████████| 901/901 [00:00<00:00, 20331.45it/s]
  0%|          | 0/1342 [00:00<?, ?it/s] 93%|█████████▎| 1250/1342 [00:00<00:00, 12495.90it/s]100%|██████████| 1342/1342 [00:00<00:00, 12480.47it/s]
  0%|          | 0/1342 [00:00<?, ?it/s]100%|██████████| 1342/1342 [00:00<00:00, 22024.75it/s]
[32m2025-02-05 04:59:10.429[0m | [1mINFO    [0m | [36mcrslab.data.dataset.base[0m:[36m__init__[0m:[36m57[0m - [1m[Finish data preprocess][0m
[32m2025-02-05 04:59:12.453[0m | [1mINFO    [0m | [36mcrslab.model[0m:[36mget_model[0m:[36m51[0m - [1m[Build model KGSF][0m
[32m2025-02-05 04:59:16.605[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36m_load_embedding[0m:[36m64[0m - [1m[Load /gpfs/work5/0/prjs1158/KG/CRSLab_adapt/data/embedding/en/cc.en.300.bin for embedding metric[0m
[32m2025-02-05 04:59:16.606[0m | [1mINFO    [0m | [36mcrslab.evaluator[0m:[36mget_evaluator[0m:[36m32[0m - [1m[Build evaluator standard][0m
[32m2025-02-05 04:59:16.606[0m | [1mINFO    [0m | [36mcrslab.system[0m:[36mget_system[0m:[36m57[0m - [1m[Build system KGSF][0m
[32m2025-02-05 04:59:16.607[0m | [1mINFO    [0m | [36mcrslab.system.base[0m:[36mbuild_optimizer[0m:[36m142[0m - [1m[Build optimizer: Adam][0m
[32m2025-02-05 04:59:16.607[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mpretrain[0m:[36m120[0m - [1m[Pretrain epoch 0][0m
  0%|          | 0/92414 [00:00<?, ?it/s]100%|██████████| 92414/92414 [00:00<00:00, 2112720.67it/s]
[32m2025-02-05 04:59:16.651[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/358 [00:00<?, ?it/s]  0%|          | 1/358 [00:00<02:10,  2.73it/s]  1%|          | 2/358 [00:00<01:31,  3.89it/s]  1%|          | 3/358 [00:00<01:17,  4.56it/s]  1%|          | 4/358 [00:00<01:10,  4.99it/s]  1%|▏         | 5/358 [00:01<01:07,  5.27it/s]  2%|▏         | 6/358 [00:01<01:04,  5.44it/s]  2%|▏         | 7/358 [00:01<01:03,  5.56it/s]  2%|▏         | 8/358 [00:01<01:02,  5.64it/s]  3%|▎         | 9/358 [00:01<01:01,  5.68it/s]  3%|▎         | 10/358 [00:01<01:00,  5.73it/s]  3%|▎         | 11/358 [00:02<01:00,  5.76it/s]  3%|▎         | 12/358 [00:02<00:59,  5.78it/s]  4%|▎         | 13/358 [00:02<00:59,  5.80it/s]  4%|▍         | 14/358 [00:02<00:59,  5.81it/s]  4%|▍         | 15/358 [00:02<00:59,  5.80it/s]  4%|▍         | 16/358 [00:02<00:59,  5.78it/s]  5%|▍         | 17/358 [00:03<00:58,  5.81it/s]  5%|▌         | 18/358 [00:03<00:58,  5.81it/s]  5%|▌         | 19/358 [00:03<00:58,  5.79it/s]  6%|▌         | 20/358 [00:03<00:58,  5.77it/s]  6%|▌         | 21/358 [00:03<00:58,  5.75it/s]  6%|▌         | 22/358 [00:03<00:58,  5.77it/s]  6%|▋         | 23/358 [00:04<00:57,  5.80it/s]  7%|▋         | 24/358 [00:04<00:58,  5.73it/s]  7%|▋         | 25/358 [00:04<00:57,  5.75it/s]  7%|▋         | 26/358 [00:04<00:57,  5.76it/s]  8%|▊         | 27/358 [00:04<00:57,  5.78it/s]  8%|▊         | 28/358 [00:05<00:57,  5.78it/s]  8%|▊         | 29/358 [00:05<00:56,  5.79it/s]  8%|▊         | 30/358 [00:05<00:56,  5.80it/s]  9%|▊         | 31/358 [00:05<00:56,  5.81it/s]  9%|▉         | 32/358 [00:05<00:56,  5.82it/s]  9%|▉         | 33/358 [00:05<00:55,  5.84it/s]  9%|▉         | 34/358 [00:06<00:55,  5.81it/s] 10%|▉         | 35/358 [00:06<00:55,  5.81it/s] 10%|█         | 36/358 [00:06<00:55,  5.81it/s] 10%|█         | 37/358 [00:06<00:55,  5.82it/s] 11%|█         | 38/358 [00:06<00:54,  5.83it/s] 11%|█         | 39/358 [00:06<00:54,  5.83it/s] 11%|█         | 40/358 [00:07<00:54,  5.80it/s] 11%|█▏        | 41/358 [00:07<00:54,  5.80it/s] 12%|█▏        | 42/358 [00:07<00:54,  5.82it/s] 12%|█▏        | 43/358 [00:07<00:54,  5.81it/s] 12%|█▏        | 44/358 [00:07<00:54,  5.79it/s] 13%|█▎        | 45/358 [00:07<00:53,  5.80it/s] 13%|█▎        | 46/358 [00:08<00:53,  5.81it/s] 13%|█▎        | 47/358 [00:08<00:53,  5.82it/s] 13%|█▎        | 48/358 [00:08<00:53,  5.83it/s] 14%|█▎        | 49/358 [00:08<00:53,  5.83it/s] 14%|█▍        | 50/358 [00:08<00:53,  5.78it/s] 14%|█▍        | 51/358 [00:08<00:53,  5.78it/s] 15%|█▍        | 52/358 [00:09<00:53,  5.75it/s] 15%|█▍        | 53/358 [00:09<00:52,  5.77it/s] 15%|█▌        | 54/358 [00:09<00:52,  5.79it/s] 15%|█▌        | 55/358 [00:09<00:52,  5.79it/s] 16%|█▌        | 56/358 [00:09<00:52,  5.80it/s] 16%|█▌        | 57/358 [00:10<00:51,  5.80it/s] 16%|█▌        | 58/358 [00:10<00:51,  5.81it/s] 16%|█▋        | 59/358 [00:10<00:51,  5.81it/s] 17%|█▋        | 60/358 [00:10<00:51,  5.82it/s] 17%|█▋        | 61/358 [00:10<00:51,  5.82it/s] 17%|█▋        | 62/358 [00:10<00:51,  5.78it/s] 18%|█▊        | 63/358 [00:11<00:50,  5.80it/s] 18%|█▊        | 64/358 [00:11<00:50,  5.80it/s] 18%|█▊        | 65/358 [00:11<00:50,  5.82it/s] 18%|█▊        | 66/358 [00:11<00:50,  5.81it/s] 19%|█▊        | 67/358 [00:11<00:50,  5.80it/s] 19%|█▉        | 68/358 [00:11<00:49,  5.83it/s] 19%|█▉        | 69/358 [00:12<00:49,  5.81it/s] 20%|█▉        | 70/358 [00:12<00:49,  5.79it/s] 20%|█▉        | 71/358 [00:12<00:49,  5.81it/s] 20%|██        | 72/358 [00:12<00:49,  5.81it/s] 20%|██        | 73/358 [00:12<00:49,  5.81it/s] 21%|██        | 74/358 [00:12<00:48,  5.80it/s] 21%|██        | 75/358 [00:13<00:48,  5.79it/s] 21%|██        | 76/358 [00:13<00:48,  5.81it/s] 22%|██▏       | 77/358 [00:13<00:48,  5.81it/s] 22%|██▏       | 78/358 [00:13<00:48,  5.82it/s] 22%|██▏       | 79/358 [00:13<00:48,  5.74it/s] 22%|██▏       | 80/358 [00:13<00:48,  5.77it/s] 23%|██▎       | 81/358 [00:14<00:47,  5.78it/s] 23%|██▎       | 82/358 [00:14<00:47,  5.81it/s] 23%|██▎       | 83/358 [00:14<00:47,  5.77it/s] 23%|██▎       | 84/358 [00:14<00:47,  5.77it/s] 24%|██▎       | 85/358 [00:14<00:47,  5.78it/s] 24%|██▍       | 86/358 [00:15<00:46,  5.80it/s] 24%|██▍       | 87/358 [00:15<00:46,  5.80it/s] 25%|██▍       | 88/358 [00:15<00:46,  5.83it/s] 25%|██▍       | 89/358 [00:15<00:46,  5.84it/s] 25%|██▌       | 90/358 [00:15<00:45,  5.84it/s] 25%|██▌       | 91/358 [00:15<00:45,  5.84it/s] 26%|██▌       | 92/358 [00:16<00:45,  5.84it/s] 26%|██▌       | 93/358 [00:16<00:45,  5.83it/s] 26%|██▋       | 94/358 [00:16<00:45,  5.83it/s] 27%|██▋       | 95/358 [00:16<00:45,  5.84it/s] 27%|██▋       | 96/358 [00:16<00:44,  5.84it/s] 27%|██▋       | 97/358 [00:16<00:44,  5.85it/s] 27%|██▋       | 98/358 [00:17<00:44,  5.82it/s] 28%|██▊       | 99/358 [00:17<00:44,  5.82it/s] 28%|██▊       | 100/358 [00:17<00:44,  5.83it/s] 28%|██▊       | 101/358 [00:17<00:44,  5.81it/s] 28%|██▊       | 102/358 [00:17<00:43,  5.83it/s] 29%|██▉       | 103/358 [00:17<00:43,  5.82it/s] 29%|██▉       | 104/358 [00:18<00:43,  5.81it/s] 29%|██▉       | 105/358 [00:18<00:43,  5.80it/s] 30%|██▉       | 106/358 [00:18<00:43,  5.80it/s] 30%|██▉       | 107/358 [00:18<00:43,  5.82it/s] 30%|███       | 108/358 [00:18<00:42,  5.81it/s] 30%|███       | 109/358 [00:18<00:43,  5.77it/s] 31%|███       | 110/358 [00:19<00:42,  5.79it/s] 31%|███       | 111/358 [00:19<00:42,  5.79it/s] 31%|███▏      | 112/358 [00:19<00:42,  5.80it/s] 32%|███▏      | 113/358 [00:19<00:42,  5.82it/s] 32%|███▏      | 114/358 [00:19<00:41,  5.82it/s] 32%|███▏      | 115/358 [00:20<00:41,  5.80it/s] 32%|███▏      | 116/358 [00:20<00:41,  5.77it/s] 33%|███▎      | 117/358 [00:20<00:41,  5.79it/s] 33%|███▎      | 118/358 [00:20<00:41,  5.81it/s] 33%|███▎      | 119/358 [00:20<00:41,  5.82it/s] 34%|███▎      | 120/358 [00:20<00:40,  5.83it/s] 34%|███▍      | 121/358 [00:21<00:40,  5.83it/s] 34%|███▍      | 122/358 [00:21<00:40,  5.84it/s] 34%|███▍      | 123/358 [00:21<00:40,  5.83it/s] 35%|███▍      | 124/358 [00:21<00:40,  5.83it/s] 35%|███▍      | 125/358 [00:21<00:39,  5.84it/s] 35%|███▌      | 126/358 [00:21<00:39,  5.84it/s] 35%|███▌      | 127/358 [00:22<00:39,  5.83it/s] 36%|███▌      | 128/358 [00:22<00:39,  5.83it/s] 36%|███▌      | 129/358 [00:22<00:39,  5.84it/s] 36%|███▋      | 130/358 [00:22<00:39,  5.84it/s] 37%|███▋      | 131/358 [00:22<00:38,  5.83it/s] 37%|███▋      | 132/358 [00:22<00:38,  5.84it/s] 37%|███▋      | 133/358 [00:23<00:38,  5.85it/s] 37%|███▋      | 134/358 [00:23<00:38,  5.78it/s] 38%|███▊      | 135/358 [00:23<00:38,  5.79it/s] 38%|███▊      | 136/358 [00:23<00:38,  5.82it/s] 38%|███▊      | 137/358 [00:23<00:38,  5.80it/s] 39%|███▊      | 138/358 [00:23<00:37,  5.81it/s] 39%|███▉      | 139/358 [00:24<00:37,  5.81it/s] 39%|███▉      | 140/358 [00:24<00:37,  5.83it/s] 39%|███▉      | 141/358 [00:24<00:37,  5.85it/s] 40%|███▉      | 142/358 [00:24<00:36,  5.85it/s] 40%|███▉      | 143/358 [00:24<00:36,  5.85it/s] 40%|████      | 144/358 [00:24<00:36,  5.82it/s] 41%|████      | 145/358 [00:25<00:36,  5.83it/s] 41%|████      | 146/358 [00:25<00:36,  5.82it/s] 41%|████      | 147/358 [00:25<00:36,  5.80it/s] 41%|████▏     | 148/358 [00:25<00:36,  5.81it/s] 42%|████▏     | 149/358 [00:25<00:35,  5.81it/s] 42%|████▏     | 150/358 [00:26<00:35,  5.81it/s] 42%|████▏     | 151/358 [00:26<00:36,  5.61it/s] 42%|████▏     | 152/358 [00:26<00:36,  5.65it/s] 43%|████▎     | 153/358 [00:26<00:36,  5.68it/s] 43%|████▎     | 154/358 [00:26<00:35,  5.72it/s] 43%|████▎     | 155/358 [00:26<00:35,  5.75it/s] 44%|████▎     | 156/358 [00:27<00:34,  5.78it/s] 44%|████▍     | 157/358 [00:27<00:34,  5.77it/s] 44%|████▍     | 158/358 [00:27<00:34,  5.79it/s] 44%|████▍     | 159/358 [00:27<00:34,  5.81it/s] 45%|████▍     | 160/358 [00:27<00:34,  5.80it/s] 45%|████▍     | 161/358 [00:27<00:33,  5.82it/s] 45%|████▌     | 162/358 [00:28<00:33,  5.83it/s] 46%|████▌     | 163/358 [00:28<00:33,  5.84it/s] 46%|████▌     | 164/358 [00:28<00:33,  5.84it/s] 46%|████▌     | 165/358 [00:28<00:33,  5.82it/s] 46%|████▋     | 166/358 [00:28<00:32,  5.83it/s] 47%|████▋     | 167/358 [00:28<00:32,  5.83it/s] 47%|████▋     | 168/358 [00:29<00:32,  5.85it/s] 47%|████▋     | 169/358 [00:29<00:32,  5.84it/s] 47%|████▋     | 170/358 [00:29<00:32,  5.84it/s] 48%|████▊     | 171/358 [00:29<00:32,  5.83it/s] 48%|████▊     | 172/358 [00:29<00:31,  5.83it/s] 48%|████▊     | 173/358 [00:29<00:31,  5.82it/s] 49%|████▊     | 174/358 [00:30<00:31,  5.83it/s] 49%|████▉     | 175/358 [00:30<00:31,  5.81it/s] 49%|████▉     | 176/358 [00:30<00:31,  5.81it/s] 49%|████▉     | 177/358 [00:30<00:31,  5.81it/s] 50%|████▉     | 178/358 [00:30<00:30,  5.83it/s] 50%|█████     | 179/358 [00:31<00:30,  5.83it/s] 50%|█████     | 180/358 [00:31<00:30,  5.81it/s] 51%|█████     | 181/358 [00:31<00:30,  5.82it/s] 51%|█████     | 182/358 [00:31<00:30,  5.82it/s] 51%|█████     | 183/358 [00:31<00:30,  5.82it/s] 51%|█████▏    | 184/358 [00:31<00:30,  5.77it/s] 52%|█████▏    | 185/358 [00:32<00:29,  5.78it/s] 52%|█████▏    | 186/358 [00:32<00:29,  5.80it/s] 52%|█████▏    | 187/358 [00:32<00:29,  5.81it/s] 53%|█████▎    | 188/358 [00:32<00:29,  5.81it/s] 53%|█████▎    | 189/358 [00:32<00:29,  5.82it/s] 53%|█████▎    | 190/358 [00:32<00:28,  5.81it/s] 53%|█████▎    | 191/358 [00:33<00:29,  5.72it/s] 54%|█████▎    | 192/358 [00:33<00:28,  5.73it/s] 54%|█████▍    | 193/358 [00:33<00:28,  5.76it/s] 54%|█████▍    | 194/358 [00:33<00:28,  5.78it/s] 54%|█████▍    | 195/358 [00:33<00:28,  5.79it/s] 55%|█████▍    | 196/358 [00:33<00:27,  5.82it/s] 55%|█████▌    | 197/358 [00:34<00:27,  5.81it/s] 55%|█████▌    | 198/358 [00:34<00:27,  5.81it/s] 56%|█████▌    | 199/358 [00:34<00:27,  5.82it/s] 56%|█████▌    | 200/358 [00:34<00:27,  5.82it/s] 56%|█████▌    | 201/358 [00:34<00:26,  5.82it/s] 56%|█████▋    | 202/358 [00:34<00:26,  5.83it/s] 57%|█████▋    | 203/358 [00:35<00:26,  5.82it/s] 57%|█████▋    | 204/358 [00:35<00:26,  5.78it/s] 57%|█████▋    | 205/358 [00:35<00:26,  5.78it/s] 58%|█████▊    | 206/358 [00:35<00:26,  5.81it/s] 58%|█████▊    | 207/358 [00:35<00:26,  5.79it/s] 58%|█████▊    | 208/358 [00:36<00:25,  5.79it/s] 58%|█████▊    | 209/358 [00:36<00:25,  5.81it/s] 59%|█████▊    | 210/358 [00:36<00:25,  5.82it/s] 59%|█████▉    | 211/358 [00:36<00:25,  5.82it/s] 59%|█████▉    | 212/358 [00:36<00:25,  5.81it/s] 59%|█████▉    | 213/358 [00:36<00:24,  5.83it/s] 60%|█████▉    | 214/358 [00:37<00:24,  5.83it/s] 60%|██████    | 215/358 [00:37<00:24,  5.82it/s] 60%|██████    | 216/358 [00:37<00:24,  5.80it/s] 61%|██████    | 217/358 [00:37<00:24,  5.82it/s] 61%|██████    | 218/358 [00:37<00:24,  5.82it/s] 61%|██████    | 219/358 [00:37<00:23,  5.82it/s] 61%|██████▏   | 220/358 [00:38<00:23,  5.83it/s] 62%|██████▏   | 221/358 [00:38<00:23,  5.83it/s] 62%|██████▏   | 222/358 [00:38<00:23,  5.80it/s] 62%|██████▏   | 223/358 [00:38<00:23,  5.79it/s] 63%|██████▎   | 224/358 [00:38<00:23,  5.79it/s] 63%|██████▎   | 225/358 [00:38<00:22,  5.80it/s] 63%|██████▎   | 226/358 [00:39<00:22,  5.80it/s] 63%|██████▎   | 227/358 [00:39<00:22,  5.81it/s] 64%|██████▎   | 228/358 [00:39<00:22,  5.81it/s] 64%|██████▍   | 229/358 [00:39<00:22,  5.81it/s] 64%|██████▍   | 230/358 [00:39<00:22,  5.80it/s] 65%|██████▍   | 231/358 [00:39<00:21,  5.82it/s] 65%|██████▍   | 232/358 [00:40<00:21,  5.80it/s] 65%|██████▌   | 233/358 [00:40<00:21,  5.82it/s] 65%|██████▌   | 234/358 [00:40<00:21,  5.84it/s] 66%|██████▌   | 235/358 [00:40<00:21,  5.85it/s] 66%|██████▌   | 236/358 [00:40<00:20,  5.83it/s] 66%|██████▌   | 237/358 [00:41<00:20,  5.84it/s] 66%|██████▋   | 238/358 [00:41<00:20,  5.85it/s] 67%|██████▋   | 239/358 [00:41<00:20,  5.84it/s] 67%|██████▋   | 240/358 [00:41<00:20,  5.83it/s] 67%|██████▋   | 241/358 [00:41<00:20,  5.84it/s] 68%|██████▊   | 242/358 [00:41<00:19,  5.82it/s] 68%|██████▊   | 243/358 [00:42<00:19,  5.83it/s] 68%|██████▊   | 244/358 [00:42<00:19,  5.84it/s] 68%|██████▊   | 245/358 [00:42<00:19,  5.84it/s] 69%|██████▊   | 246/358 [00:42<00:20,  5.45it/s] 69%|██████▉   | 247/358 [00:42<00:20,  5.53it/s] 69%|██████▉   | 248/358 [00:42<00:19,  5.62it/s] 70%|██████▉   | 249/358 [00:43<00:19,  5.69it/s] 70%|██████▉   | 250/358 [00:43<00:18,  5.73it/s] 70%|███████   | 251/358 [00:43<00:18,  5.74it/s] 70%|███████   | 252/358 [00:43<00:18,  5.70it/s] 71%|███████   | 253/358 [00:43<00:18,  5.72it/s] 71%|███████   | 254/358 [00:43<00:18,  5.74it/s] 71%|███████   | 255/358 [00:44<00:17,  5.77it/s] 72%|███████▏  | 256/358 [00:44<00:17,  5.80it/s] 72%|███████▏  | 257/358 [00:44<00:17,  5.81it/s] 72%|███████▏  | 258/358 [00:44<00:17,  5.76it/s] 72%|███████▏  | 259/358 [00:44<00:17,  5.78it/s] 73%|███████▎  | 260/358 [00:45<00:16,  5.80it/s] 73%|███████▎  | 261/358 [00:45<00:16,  5.82it/s] 73%|███████▎  | 262/358 [00:45<00:16,  5.82it/s] 73%|███████▎  | 263/358 [00:45<00:16,  5.83it/s] 74%|███████▎  | 264/358 [00:45<00:16,  5.81it/s] 74%|███████▍  | 265/358 [00:45<00:15,  5.83it/s] 74%|███████▍  | 266/358 [00:46<00:15,  5.79it/s] 75%|███████▍  | 267/358 [00:46<00:15,  5.81it/s] 75%|███████▍  | 268/358 [00:46<00:15,  5.82it/s] 75%|███████▌  | 269/358 [00:46<00:15,  5.83it/s] 75%|███████▌  | 270/358 [00:46<00:15,  5.82it/s] 76%|███████▌  | 271/358 [00:46<00:14,  5.81it/s] 76%|███████▌  | 272/358 [00:47<00:14,  5.81it/s] 76%|███████▋  | 273/358 [00:47<00:14,  5.75it/s] 77%|███████▋  | 274/358 [00:47<00:14,  5.78it/s] 77%|███████▋  | 275/358 [00:47<00:14,  5.79it/s] 77%|███████▋  | 276/358 [00:47<00:14,  5.80it/s] 77%|███████▋  | 277/358 [00:47<00:13,  5.80it/s] 78%|███████▊  | 278/358 [00:48<00:13,  5.80it/s] 78%|███████▊  | 279/358 [00:48<00:13,  5.82it/s] 78%|███████▊  | 280/358 [00:48<00:13,  5.75it/s] 78%|███████▊  | 281/358 [00:48<00:13,  5.78it/s] 79%|███████▉  | 282/358 [00:48<00:13,  5.79it/s] 79%|███████▉  | 283/358 [00:48<00:12,  5.78it/s] 79%|███████▉  | 284/358 [00:49<00:12,  5.78it/s] 80%|███████▉  | 285/358 [00:49<00:12,  5.81it/s] 80%|███████▉  | 286/358 [00:49<00:12,  5.81it/s] 80%|████████  | 287/358 [00:49<00:12,  5.81it/s] 80%|████████  | 288/358 [00:49<00:12,  5.80it/s] 81%|████████  | 289/358 [00:50<00:11,  5.82it/s] 81%|████████  | 290/358 [00:50<00:11,  5.83it/s] 81%|████████▏ | 291/358 [00:50<00:11,  5.83it/s] 82%|████████▏ | 292/358 [00:50<00:11,  5.84it/s] 82%|████████▏ | 293/358 [00:50<00:11,  5.80it/s] 82%|████████▏ | 294/358 [00:50<00:10,  5.83it/s] 82%|████████▏ | 295/358 [00:51<00:10,  5.83it/s] 83%|████████▎ | 296/358 [00:51<00:10,  5.82it/s] 83%|████████▎ | 297/358 [00:51<00:10,  5.78it/s] 83%|████████▎ | 298/358 [00:51<00:10,  5.81it/s] 84%|████████▎ | 299/358 [00:51<00:10,  5.83it/s] 84%|████████▍ | 300/358 [00:51<00:09,  5.84it/s] 84%|████████▍ | 301/358 [00:52<00:09,  5.84it/s] 84%|████████▍ | 302/358 [00:52<00:09,  5.83it/s] 85%|████████▍ | 303/358 [00:52<00:09,  5.84it/s] 85%|████████▍ | 304/358 [00:52<00:09,  5.84it/s] 85%|████████▌ | 305/358 [00:52<00:09,  5.84it/s] 85%|████████▌ | 306/358 [00:52<00:08,  5.83it/s] 86%|████████▌ | 307/358 [00:53<00:08,  5.84it/s] 86%|████████▌ | 308/358 [00:53<00:08,  5.84it/s] 86%|████████▋ | 309/358 [00:53<00:08,  5.80it/s] 87%|████████▋ | 310/358 [00:53<00:08,  5.79it/s] 87%|████████▋ | 311/358 [00:53<00:08,  5.77it/s] 87%|████████▋ | 312/358 [00:53<00:07,  5.79it/s] 87%|████████▋ | 313/358 [00:54<00:07,  5.81it/s] 88%|████████▊ | 314/358 [00:54<00:07,  5.82it/s] 88%|████████▊ | 315/358 [00:54<00:07,  5.83it/s] 88%|████████▊ | 316/358 [00:54<00:07,  5.83it/s] 89%|████████▊ | 317/358 [00:54<00:07,  5.83it/s] 89%|████████▉ | 318/358 [00:54<00:06,  5.84it/s] 89%|████████▉ | 319/358 [00:55<00:06,  5.84it/s] 89%|████████▉ | 320/358 [00:55<00:06,  5.84it/s] 90%|████████▉ | 321/358 [00:55<00:06,  5.83it/s] 90%|████████▉ | 322/358 [00:55<00:06,  5.84it/s] 90%|█████████ | 323/358 [00:55<00:06,  5.82it/s] 91%|█████████ | 324/358 [00:56<00:05,  5.81it/s] 91%|█████████ | 325/358 [00:56<00:05,  5.80it/s] 91%|█████████ | 326/358 [00:56<00:05,  5.80it/s] 91%|█████████▏| 327/358 [00:56<00:05,  5.83it/s] 92%|█████████▏| 328/358 [00:56<00:05,  5.84it/s] 92%|█████████▏| 329/358 [00:56<00:04,  5.86it/s] 92%|█████████▏| 330/358 [00:57<00:04,  5.84it/s] 92%|█████████▏| 331/358 [00:57<00:04,  5.82it/s] 93%|█████████▎| 332/358 [00:57<00:04,  5.84it/s] 93%|█████████▎| 333/358 [00:57<00:04,  5.84it/s] 93%|█████████▎| 334/358 [00:57<00:04,  5.82it/s] 94%|█████████▎| 335/358 [00:57<00:04,  5.74it/s] 94%|█████████▍| 336/358 [00:58<00:03,  5.78it/s] 94%|█████████▍| 337/358 [00:58<00:03,  5.80it/s] 94%|█████████▍| 338/358 [00:58<00:03,  5.83it/s] 95%|█████████▍| 339/358 [00:58<00:03,  5.84it/s] 95%|█████████▍| 340/358 [00:58<00:03,  5.84it/s] 95%|█████████▌| 341/358 [00:58<00:02,  5.84it/s] 96%|█████████▌| 342/358 [00:59<00:02,  5.84it/s] 96%|█████████▌| 343/358 [00:59<00:02,  5.81it/s] 96%|█████████▌| 344/358 [00:59<00:02,  5.82it/s] 96%|█████████▋| 345/358 [00:59<00:02,  5.83it/s] 97%|█████████▋| 346/358 [00:59<00:02,  5.84it/s] 97%|█████████▋| 347/358 [00:59<00:01,  5.86it/s] 97%|█████████▋| 348/358 [01:00<00:01,  5.85it/s] 97%|█████████▋| 349/358 [01:00<00:01,  5.84it/s] 98%|█████████▊| 350/358 [01:00<00:01,  5.82it/s] 98%|█████████▊| 351/358 [01:00<00:01,  5.83it/s] 98%|█████████▊| 352/358 [01:00<00:01,  5.84it/s] 99%|█████████▊| 353/358 [01:00<00:00,  5.85it/s] 99%|█████████▉| 354/358 [01:01<00:00,  5.84it/s] 99%|█████████▉| 355/358 [01:01<00:00,  5.84it/s] 99%|█████████▉| 356/358 [01:01<00:00,  5.85it/s]100%|█████████▉| 357/358 [01:01<00:00,  5.79it/s]100%|██████████| 358/358 [01:01<00:00,  5.78it/s]100%|██████████| 358/358 [01:01<00:00,  5.79it/s]
[32m2025-02-05 05:00:18.739[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    grad norm  info_loss
        618.9      3.658[0m
[32m2025-02-05 05:00:18.739[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mpretrain[0m:[36m120[0m - [1m[Pretrain epoch 1][0m
  0%|          | 0/92414 [00:00<?, ?it/s]100%|██████████| 92414/92414 [00:00<00:00, 1075013.96it/s]
[32m2025-02-05 05:00:18.826[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/358 [00:00<?, ?it/s]  0%|          | 1/358 [00:00<01:02,  5.71it/s]  1%|          | 2/358 [00:00<01:02,  5.72it/s]  1%|          | 3/358 [00:00<01:01,  5.78it/s]  1%|          | 4/358 [00:00<01:00,  5.80it/s]  1%|▏         | 5/358 [00:00<01:00,  5.82it/s]  2%|▏         | 6/358 [00:01<01:00,  5.83it/s]  2%|▏         | 7/358 [00:01<01:00,  5.83it/s]  2%|▏         | 8/358 [00:01<01:00,  5.82it/s]  3%|▎         | 9/358 [00:01<01:00,  5.81it/s]  3%|▎         | 10/358 [00:01<00:59,  5.82it/s]  3%|▎         | 11/358 [00:01<00:59,  5.82it/s]  3%|▎         | 12/358 [00:02<00:59,  5.83it/s]  4%|▎         | 13/358 [00:02<00:59,  5.84it/s]  4%|▍         | 14/358 [00:02<00:58,  5.84it/s]  4%|▍         | 15/358 [00:02<00:58,  5.82it/s]  4%|▍         | 16/358 [00:02<00:58,  5.80it/s]  5%|▍         | 17/358 [00:02<00:58,  5.82it/s]  5%|▌         | 18/358 [00:03<00:58,  5.82it/s]  5%|▌         | 19/358 [00:03<00:58,  5.80it/s]  6%|▌         | 20/358 [00:03<00:58,  5.79it/s]  6%|▌         | 21/358 [00:03<00:58,  5.76it/s]  6%|▌         | 22/358 [00:03<00:58,  5.79it/s]  6%|▋         | 23/358 [00:03<00:57,  5.81it/s]  7%|▋         | 24/358 [00:04<00:58,  5.74it/s]  7%|▋         | 25/358 [00:04<00:57,  5.76it/s]  7%|▋         | 26/358 [00:04<00:57,  5.77it/s]  8%|▊         | 27/358 [00:04<00:57,  5.79it/s]  8%|▊         | 28/358 [00:04<00:57,  5.79it/s]  8%|▊         | 29/358 [00:05<00:56,  5.79it/s]  8%|▊         | 30/358 [00:05<00:56,  5.81it/s]  9%|▊         | 31/358 [00:05<00:56,  5.81it/s]  9%|▉         | 32/358 [00:05<00:55,  5.82it/s]  9%|▉         | 33/358 [00:05<00:55,  5.84it/s]  9%|▉         | 34/358 [00:05<00:55,  5.82it/s] 10%|▉         | 35/358 [00:06<00:55,  5.82it/s] 10%|█         | 36/358 [00:06<00:55,  5.81it/s] 10%|█         | 37/358 [00:06<00:55,  5.83it/s] 11%|█         | 38/358 [00:06<00:54,  5.83it/s] 11%|█         | 39/358 [00:06<00:54,  5.83it/s] 11%|█         | 40/358 [00:06<00:54,  5.84it/s] 11%|█▏        | 41/358 [00:07<00:54,  5.83it/s] 12%|█▏        | 42/358 [00:07<00:54,  5.84it/s] 12%|█▏        | 43/358 [00:07<00:54,  5.83it/s] 12%|█▏        | 44/358 [00:07<00:53,  5.83it/s] 13%|█▎        | 45/358 [00:07<00:53,  5.84it/s] 13%|█▎        | 46/358 [00:07<00:53,  5.84it/s] 13%|█▎        | 47/358 [00:08<00:53,  5.84it/s] 13%|█▎        | 48/358 [00:08<00:53,  5.85it/s] 14%|█▎        | 49/358 [00:08<00:52,  5.84it/s] 14%|█▍        | 50/358 [00:08<00:53,  5.80it/s] 14%|█▍        | 51/358 [00:08<00:53,  5.79it/s] 15%|█▍        | 52/358 [00:08<00:53,  5.76it/s] 15%|█▍        | 53/358 [00:09<00:52,  5.77it/s] 15%|█▌        | 54/358 [00:09<00:52,  5.79it/s] 15%|█▌        | 55/358 [00:09<00:52,  5.79it/s] 16%|█▌        | 56/358 [00:09<00:52,  5.80it/s] 16%|█▌        | 57/358 [00:09<00:51,  5.80it/s] 16%|█▌        | 58/358 [00:09<00:51,  5.81it/s] 16%|█▋        | 59/358 [00:10<00:51,  5.81it/s] 17%|█▋        | 60/358 [00:10<00:52,  5.64it/s] 17%|█▋        | 61/358 [00:10<00:52,  5.69it/s] 17%|█▋        | 62/358 [00:10<00:52,  5.69it/s] 18%|█▊        | 63/358 [00:10<00:51,  5.73it/s] 18%|█▊        | 64/358 [00:11<00:51,  5.74it/s] 18%|█▊        | 65/358 [00:11<00:50,  5.77it/s] 18%|█▊        | 66/358 [00:11<00:50,  5.77it/s] 19%|█▊        | 67/358 [00:11<00:50,  5.77it/s] 19%|█▉        | 68/358 [00:11<00:50,  5.80it/s] 19%|█▉        | 69/358 [00:11<00:49,  5.79it/s] 20%|█▉        | 70/358 [00:12<00:49,  5.78it/s] 20%|█▉        | 71/358 [00:12<00:49,  5.79it/s] 20%|██        | 72/358 [00:12<00:49,  5.79it/s] 20%|██        | 73/358 [00:12<00:49,  5.80it/s] 21%|██        | 74/358 [00:12<00:49,  5.79it/s] 21%|██        | 75/358 [00:12<00:48,  5.78it/s] 21%|██        | 76/358 [00:13<00:48,  5.79it/s] 22%|██▏       | 77/358 [00:13<00:48,  5.79it/s] 22%|██▏       | 78/358 [00:13<00:48,  5.80it/s] 22%|██▏       | 79/358 [00:13<00:48,  5.73it/s] 22%|██▏       | 80/358 [00:13<00:48,  5.76it/s] 23%|██▎       | 81/358 [00:13<00:48,  5.77it/s] 23%|██▎       | 82/358 [00:14<00:47,  5.79it/s] 23%|██▎       | 83/358 [00:14<00:47,  5.75it/s] 23%|██▎       | 84/358 [00:14<00:47,  5.76it/s] 24%|██▎       | 85/358 [00:14<00:47,  5.76it/s] 24%|██▍       | 86/358 [00:14<00:47,  5.78it/s] 24%|██▍       | 87/358 [00:15<00:46,  5.78it/s] 25%|██▍       | 88/358 [00:15<00:46,  5.81it/s] 25%|██▍       | 89/358 [00:15<00:46,  5.83it/s] 25%|██▌       | 90/358 [00:15<00:45,  5.83it/s] 25%|██▌       | 91/358 [00:15<00:45,  5.83it/s] 26%|██▌       | 92/358 [00:15<00:45,  5.82it/s] 26%|██▌       | 93/358 [00:16<00:45,  5.82it/s] 26%|██▋       | 94/358 [00:16<00:45,  5.81it/s] 27%|██▋       | 95/358 [00:16<00:45,  5.83it/s] 27%|██▋       | 96/358 [00:16<00:44,  5.83it/s] 27%|██▋       | 97/358 [00:16<00:44,  5.84it/s] 27%|██▋       | 98/358 [00:16<00:44,  5.81it/s] 28%|██▊       | 99/358 [00:17<00:44,  5.81it/s] 28%|██▊       | 100/358 [00:17<00:44,  5.82it/s] 28%|██▊       | 101/358 [00:17<00:44,  5.80it/s] 28%|██▊       | 102/358 [00:17<00:44,  5.82it/s] 29%|██▉       | 103/358 [00:17<00:43,  5.81it/s] 29%|██▉       | 104/358 [00:17<00:43,  5.80it/s] 29%|██▉       | 105/358 [00:18<00:43,  5.78it/s] 30%|██▉       | 106/358 [00:18<00:43,  5.78it/s] 30%|██▉       | 107/358 [00:18<00:43,  5.80it/s] 30%|███       | 108/358 [00:18<00:43,  5.79it/s] 30%|███       | 109/358 [00:18<00:43,  5.75it/s] 31%|███       | 110/358 [00:18<00:42,  5.77it/s] 31%|███       | 111/358 [00:19<00:42,  5.77it/s] 31%|███▏      | 112/358 [00:19<00:42,  5.78it/s] 32%|███▏      | 113/358 [00:19<00:42,  5.80it/s] 32%|███▏      | 114/358 [00:19<00:41,  5.81it/s] 32%|███▏      | 115/358 [00:19<00:41,  5.79it/s] 32%|███▏      | 116/358 [00:20<00:42,  5.76it/s] 33%|███▎      | 117/358 [00:20<00:41,  5.78it/s] 33%|███▎      | 118/358 [00:20<00:41,  5.80it/s] 33%|███▎      | 119/358 [00:20<00:41,  5.81it/s] 34%|███▎      | 120/358 [00:20<00:40,  5.81it/s] 34%|███▍      | 121/358 [00:20<00:40,  5.82it/s] 34%|███▍      | 122/358 [00:21<00:40,  5.82it/s] 34%|███▍      | 123/358 [00:21<00:40,  5.82it/s] 35%|███▍      | 124/358 [00:21<00:40,  5.82it/s] 35%|███▍      | 125/358 [00:21<00:40,  5.82it/s] 35%|███▌      | 126/358 [00:21<00:39,  5.82it/s] 35%|███▌      | 127/358 [00:21<00:39,  5.81it/s] 36%|███▌      | 128/358 [00:22<00:39,  5.79it/s] 36%|███▌      | 129/358 [00:22<00:39,  5.81it/s] 36%|███▋      | 130/358 [00:22<00:39,  5.81it/s] 37%|███▋      | 131/358 [00:22<00:39,  5.80it/s] 37%|███▋      | 132/358 [00:22<00:38,  5.81it/s] 37%|███▋      | 133/358 [00:22<00:38,  5.83it/s] 37%|███▋      | 134/358 [00:23<00:38,  5.76it/s] 38%|███▊      | 135/358 [00:23<00:38,  5.77it/s] 38%|███▊      | 136/358 [00:23<00:38,  5.80it/s] 38%|███▊      | 137/358 [00:23<00:38,  5.78it/s] 39%|███▊      | 138/358 [00:23<00:37,  5.79it/s] 39%|███▉      | 139/358 [00:23<00:37,  5.79it/s] 39%|███▉      | 140/358 [00:24<00:37,  5.81it/s] 39%|███▉      | 141/358 [00:24<00:37,  5.83it/s] 40%|███▉      | 142/358 [00:24<00:37,  5.83it/s] 40%|███▉      | 143/358 [00:24<00:36,  5.84it/s] 40%|████      | 144/358 [00:24<00:36,  5.80it/s] 41%|████      | 145/358 [00:25<00:36,  5.81it/s] 41%|████      | 146/358 [00:25<00:36,  5.81it/s] 41%|████      | 147/358 [00:25<00:36,  5.78it/s] 41%|████▏     | 148/358 [00:25<00:36,  5.80it/s] 42%|████▏     | 149/358 [00:25<00:36,  5.80it/s] 42%|████▏     | 150/358 [00:25<00:35,  5.80it/s] 42%|████▏     | 151/358 [00:26<00:36,  5.60it/s] 42%|████▏     | 152/358 [00:26<00:36,  5.64it/s] 43%|████▎     | 153/358 [00:26<00:36,  5.67it/s] 43%|████▎     | 154/358 [00:26<00:35,  5.71it/s] 43%|████▎     | 155/358 [00:26<00:35,  5.74it/s] 44%|████▎     | 156/358 [00:26<00:35,  5.77it/s] 44%|████▍     | 157/358 [00:27<00:34,  5.75it/s] 44%|████▍     | 158/358 [00:27<00:34,  5.78it/s] 44%|████▍     | 159/358 [00:27<00:34,  5.80it/s] 45%|████▍     | 160/358 [00:27<00:34,  5.75it/s] 45%|████▍     | 161/358 [00:27<00:34,  5.78it/s] 45%|████▌     | 162/358 [00:27<00:33,  5.80it/s] 46%|████▌     | 163/358 [00:28<00:33,  5.81it/s] 46%|████▌     | 164/358 [00:28<00:33,  5.81it/s] 46%|████▌     | 165/358 [00:28<00:33,  5.80it/s] 46%|████▋     | 166/358 [00:28<00:33,  5.81it/s] 47%|████▋     | 167/358 [00:28<00:32,  5.82it/s] 47%|████▋     | 168/358 [00:28<00:32,  5.83it/s] 47%|████▋     | 169/358 [00:29<00:32,  5.82it/s] 47%|████▋     | 170/358 [00:29<00:32,  5.82it/s] 48%|████▊     | 171/358 [00:29<00:32,  5.82it/s] 48%|████▊     | 172/358 [00:29<00:31,  5.82it/s] 48%|████▊     | 173/358 [00:29<00:31,  5.81it/s] 49%|████▊     | 174/358 [00:30<00:31,  5.81it/s] 49%|████▉     | 175/358 [00:30<00:31,  5.80it/s] 49%|████▉     | 176/358 [00:30<00:31,  5.80it/s] 49%|████▉     | 177/358 [00:30<00:31,  5.80it/s] 50%|████▉     | 178/358 [00:30<00:30,  5.81it/s] 50%|█████     | 179/358 [00:30<00:30,  5.82it/s] 50%|█████     | 180/358 [00:31<00:30,  5.80it/s] 51%|█████     | 181/358 [00:31<00:30,  5.80it/s] 51%|█████     | 182/358 [00:31<00:30,  5.81it/s] 51%|█████     | 183/358 [00:31<00:30,  5.81it/s] 51%|█████▏    | 184/358 [00:31<00:30,  5.76it/s] 52%|█████▏    | 185/358 [00:31<00:29,  5.77it/s] 52%|█████▏    | 186/358 [00:32<00:29,  5.78it/s] 52%|█████▏    | 187/358 [00:32<00:29,  5.80it/s] 53%|█████▎    | 188/358 [00:32<00:29,  5.80it/s] 53%|█████▎    | 189/358 [00:32<00:29,  5.81it/s] 53%|█████▎    | 190/358 [00:32<00:28,  5.80it/s] 53%|█████▎    | 191/358 [00:32<00:29,  5.71it/s] 54%|█████▎    | 192/358 [00:33<00:29,  5.72it/s] 54%|█████▍    | 193/358 [00:33<00:28,  5.75it/s] 54%|█████▍    | 194/358 [00:33<00:28,  5.77it/s] 54%|█████▍    | 195/358 [00:33<00:28,  5.78it/s] 55%|█████▍    | 196/358 [00:33<00:27,  5.81it/s] 55%|█████▌    | 197/358 [00:34<00:27,  5.80it/s] 55%|█████▌    | 198/358 [00:34<00:27,  5.80it/s] 56%|█████▌    | 199/358 [00:34<00:27,  5.80it/s] 56%|█████▌    | 200/358 [00:34<00:27,  5.80it/s] 56%|█████▌    | 201/358 [00:34<00:27,  5.81it/s] 56%|█████▋    | 202/358 [00:34<00:26,  5.81it/s] 57%|█████▋    | 203/358 [00:35<00:26,  5.81it/s] 57%|█████▋    | 204/358 [00:35<00:26,  5.76it/s] 57%|█████▋    | 205/358 [00:35<00:26,  5.77it/s] 58%|█████▊    | 206/358 [00:35<00:26,  5.79it/s] 58%|█████▊    | 207/358 [00:35<00:26,  5.78it/s] 58%|█████▊    | 208/358 [00:35<00:25,  5.78it/s] 58%|█████▊    | 209/358 [00:36<00:25,  5.80it/s] 59%|█████▊    | 210/358 [00:36<00:25,  5.80it/s] 59%|█████▉    | 211/358 [00:36<00:25,  5.81it/s] 59%|█████▉    | 212/358 [00:36<00:25,  5.79it/s] 59%|█████▉    | 213/358 [00:36<00:24,  5.81it/s] 60%|█████▉    | 214/358 [00:36<00:24,  5.81it/s] 60%|██████    | 215/358 [00:37<00:24,  5.80it/s] 60%|██████    | 216/358 [00:37<00:24,  5.79it/s] 61%|██████    | 217/358 [00:37<00:24,  5.81it/s] 61%|██████    | 218/358 [00:37<00:24,  5.80it/s] 61%|██████    | 219/358 [00:37<00:23,  5.80it/s] 61%|██████▏   | 220/358 [00:37<00:23,  5.81it/s] 62%|██████▏   | 221/358 [00:38<00:23,  5.81it/s] 62%|██████▏   | 222/358 [00:38<00:23,  5.77it/s] 62%|██████▏   | 223/358 [00:38<00:23,  5.77it/s] 63%|██████▎   | 224/358 [00:38<00:23,  5.77it/s] 63%|██████▎   | 225/358 [00:38<00:22,  5.78it/s] 63%|██████▎   | 226/358 [00:39<00:22,  5.79it/s] 63%|██████▎   | 227/358 [00:39<00:22,  5.80it/s] 64%|██████▎   | 228/358 [00:39<00:22,  5.80it/s] 64%|██████▍   | 229/358 [00:39<00:22,  5.81it/s] 64%|██████▍   | 230/358 [00:39<00:22,  5.79it/s] 65%|██████▍   | 231/358 [00:39<00:21,  5.81it/s] 65%|██████▍   | 232/358 [00:40<00:21,  5.79it/s] 65%|██████▌   | 233/358 [00:40<00:21,  5.80it/s] 65%|██████▌   | 234/358 [00:40<00:21,  5.82it/s] 66%|██████▌   | 235/358 [00:40<00:21,  5.83it/s] 66%|██████▌   | 236/358 [00:40<00:20,  5.82it/s] 66%|██████▌   | 237/358 [00:40<00:20,  5.82it/s] 66%|██████▋   | 238/358 [00:41<00:20,  5.83it/s] 67%|██████▋   | 239/358 [00:41<00:20,  5.83it/s] 67%|██████▋   | 240/358 [00:41<00:20,  5.82it/s] 67%|██████▋   | 241/358 [00:41<00:20,  5.83it/s] 68%|██████▊   | 242/358 [00:41<00:19,  5.81it/s] 68%|██████▊   | 243/358 [00:41<00:19,  5.81it/s] 68%|██████▊   | 244/358 [00:42<00:19,  5.82it/s] 68%|██████▊   | 245/358 [00:42<00:19,  5.83it/s] 69%|██████▊   | 246/358 [00:42<00:19,  5.81it/s] 69%|██████▉   | 247/358 [00:42<00:19,  5.78it/s] 69%|██████▉   | 248/358 [00:42<00:18,  5.79it/s] 70%|██████▉   | 249/358 [00:42<00:18,  5.81it/s] 70%|██████▉   | 250/358 [00:43<00:18,  5.81it/s] 70%|███████   | 251/358 [00:43<00:18,  5.79it/s] 70%|███████   | 252/358 [00:43<00:18,  5.78it/s] 71%|███████   | 253/358 [00:43<00:18,  5.74it/s] 71%|███████   | 254/358 [00:43<00:18,  5.75it/s] 71%|███████   | 255/358 [00:44<00:17,  5.77it/s] 72%|███████▏  | 256/358 [00:44<00:17,  5.79it/s] 72%|███████▏  | 257/358 [00:44<00:17,  5.80it/s] 72%|███████▏  | 258/358 [00:44<00:17,  5.75it/s] 72%|███████▏  | 259/358 [00:44<00:17,  5.77it/s] 73%|███████▎  | 260/358 [00:44<00:16,  5.78it/s] 73%|███████▎  | 261/358 [00:45<00:16,  5.80it/s] 73%|███████▎  | 262/358 [00:45<00:16,  5.81it/s] 73%|███████▎  | 263/358 [00:45<00:16,  5.82it/s] 74%|███████▎  | 264/358 [00:45<00:16,  5.79it/s] 74%|███████▍  | 265/358 [00:45<00:16,  5.81it/s] 74%|███████▍  | 266/358 [00:45<00:15,  5.79it/s] 75%|███████▍  | 267/358 [00:46<00:15,  5.80it/s] 75%|███████▍  | 268/358 [00:46<00:15,  5.81it/s] 75%|███████▌  | 269/358 [00:46<00:15,  5.81it/s] 75%|███████▌  | 270/358 [00:46<00:15,  5.80it/s] 76%|███████▌  | 271/358 [00:46<00:15,  5.79it/s] 76%|███████▌  | 272/358 [00:46<00:14,  5.79it/s] 76%|███████▋  | 273/358 [00:47<00:14,  5.73it/s] 77%|███████▋  | 274/358 [00:47<00:14,  5.76it/s] 77%|███████▋  | 275/358 [00:47<00:14,  5.78it/s] 77%|███████▋  | 276/358 [00:47<00:14,  5.78it/s] 77%|███████▋  | 277/358 [00:47<00:13,  5.79it/s] 78%|███████▊  | 278/358 [00:47<00:13,  5.79it/s] 78%|███████▊  | 279/358 [00:48<00:13,  5.81it/s] 78%|███████▊  | 280/358 [00:48<00:13,  5.79it/s] 78%|███████▊  | 281/358 [00:48<00:13,  5.80it/s] 79%|███████▉  | 282/358 [00:48<00:13,  5.80it/s] 79%|███████▉  | 283/358 [00:48<00:12,  5.78it/s] 79%|███████▉  | 284/358 [00:49<00:12,  5.78it/s] 80%|███████▉  | 285/358 [00:49<00:12,  5.79it/s] 80%|███████▉  | 286/358 [00:49<00:12,  5.80it/s] 80%|████████  | 287/358 [00:49<00:12,  5.80it/s] 80%|████████  | 288/358 [00:49<00:12,  5.78it/s] 81%|████████  | 289/358 [00:49<00:11,  5.81it/s] 81%|████████  | 290/358 [00:50<00:11,  5.81it/s] 81%|████████▏ | 291/358 [00:50<00:11,  5.81it/s] 82%|████████▏ | 292/358 [00:50<00:11,  5.82it/s] 82%|████████▏ | 293/358 [00:50<00:11,  5.78it/s] 82%|████████▏ | 294/358 [00:50<00:11,  5.80it/s] 82%|████████▏ | 295/358 [00:50<00:10,  5.80it/s] 83%|████████▎ | 296/358 [00:51<00:10,  5.80it/s] 83%|████████▎ | 297/358 [00:51<00:10,  5.76it/s] 83%|████████▎ | 298/358 [00:51<00:10,  5.78it/s] 84%|████████▎ | 299/358 [00:51<00:10,  5.80it/s] 84%|████████▍ | 300/358 [00:51<00:09,  5.81it/s] 84%|████████▍ | 301/358 [00:51<00:09,  5.81it/s] 84%|████████▍ | 302/358 [00:52<00:09,  5.81it/s] 85%|████████▍ | 303/358 [00:52<00:09,  5.82it/s] 85%|████████▍ | 304/358 [00:52<00:09,  5.82it/s] 85%|████████▌ | 305/358 [00:52<00:09,  5.82it/s] 85%|████████▌ | 306/358 [00:52<00:08,  5.80it/s] 86%|████████▌ | 307/358 [00:52<00:08,  5.82it/s] 86%|████████▌ | 308/358 [00:53<00:08,  5.81it/s] 86%|████████▋ | 309/358 [00:53<00:08,  5.78it/s] 87%|████████▋ | 310/358 [00:53<00:08,  5.77it/s] 87%|████████▋ | 311/358 [00:53<00:08,  5.75it/s] 87%|████████▋ | 312/358 [00:53<00:07,  5.77it/s] 87%|████████▋ | 313/358 [00:54<00:07,  5.79it/s] 88%|████████▊ | 314/358 [00:54<00:07,  5.80it/s] 88%|████████▊ | 315/358 [00:54<00:07,  5.80it/s] 88%|████████▊ | 316/358 [00:54<00:07,  5.80it/s] 89%|████████▊ | 317/358 [00:54<00:07,  5.80it/s] 89%|████████▉ | 318/358 [00:54<00:06,  5.81it/s] 89%|████████▉ | 319/358 [00:55<00:06,  5.81it/s] 89%|████████▉ | 320/358 [00:55<00:06,  5.82it/s] 90%|████████▉ | 321/358 [00:55<00:06,  5.81it/s] 90%|████████▉ | 322/358 [00:55<00:06,  5.82it/s] 90%|█████████ | 323/358 [00:55<00:06,  5.79it/s] 91%|█████████ | 324/358 [00:55<00:05,  5.79it/s] 91%|█████████ | 325/358 [00:56<00:05,  5.77it/s] 91%|█████████ | 326/358 [00:56<00:05,  5.77it/s] 91%|█████████▏| 327/358 [00:56<00:05,  5.80it/s] 92%|█████████▏| 328/358 [00:56<00:05,  5.82it/s] 92%|█████████▏| 329/358 [00:56<00:04,  5.83it/s] 92%|█████████▏| 330/358 [00:56<00:04,  5.82it/s] 92%|█████████▏| 331/358 [00:57<00:04,  5.84it/s] 93%|█████████▎| 332/358 [00:57<00:04,  5.85it/s] 93%|█████████▎| 333/358 [00:57<00:04,  5.84it/s] 93%|█████████▎| 334/358 [00:57<00:04,  5.81it/s] 94%|█████████▎| 335/358 [00:57<00:04,  5.73it/s] 94%|█████████▍| 336/358 [00:57<00:03,  5.76it/s] 94%|█████████▍| 337/358 [00:58<00:03,  5.79it/s] 94%|█████████▍| 338/358 [00:58<00:03,  5.81it/s] 95%|█████████▍| 339/358 [00:58<00:03,  5.82it/s] 95%|█████████▍| 340/358 [00:58<00:03,  5.82it/s] 95%|█████████▌| 341/358 [00:58<00:02,  5.82it/s] 96%|█████████▌| 342/358 [00:59<00:02,  5.82it/s] 96%|█████████▌| 343/358 [00:59<00:02,  5.79it/s] 96%|█████████▌| 344/358 [00:59<00:02,  5.80it/s] 96%|█████████▋| 345/358 [00:59<00:02,  5.81it/s] 97%|█████████▋| 346/358 [00:59<00:02,  5.82it/s] 97%|█████████▋| 347/358 [00:59<00:01,  5.80it/s] 97%|█████████▋| 348/358 [01:00<00:01,  5.80it/s] 97%|█████████▋| 349/358 [01:00<00:01,  5.79it/s] 98%|█████████▊| 350/358 [01:00<00:01,  5.79it/s] 98%|█████████▊| 351/358 [01:00<00:01,  5.79it/s] 98%|█████████▊| 352/358 [01:00<00:01,  5.80it/s] 99%|█████████▊| 353/358 [01:00<00:00,  5.82it/s] 99%|█████████▉| 354/358 [01:01<00:00,  5.82it/s] 99%|█████████▉| 355/358 [01:01<00:00,  5.82it/s] 99%|█████████▉| 356/358 [01:01<00:00,  5.83it/s]100%|█████████▉| 357/358 [01:01<00:00,  5.77it/s]100%|██████████| 358/358 [01:01<00:00,  5.86it/s]100%|██████████| 358/358 [01:01<00:00,  5.80it/s]
[32m2025-02-05 05:01:20.604[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    grad norm  info_loss
        2.391      .5010[0m
[32m2025-02-05 05:01:20.604[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mpretrain[0m:[36m120[0m - [1m[Pretrain epoch 2][0m
  0%|          | 0/92414 [00:00<?, ?it/s]100%|██████████| 92414/92414 [00:00<00:00, 1059131.33it/s]
[32m2025-02-05 05:01:20.692[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/358 [00:00<?, ?it/s]  0%|          | 1/358 [00:00<01:02,  5.70it/s]  1%|          | 2/358 [00:00<01:02,  5.71it/s]  1%|          | 3/358 [00:00<01:01,  5.76it/s]  1%|          | 4/358 [00:00<01:01,  5.79it/s]  1%|▏         | 5/358 [00:00<01:00,  5.80it/s]  2%|▏         | 6/358 [00:01<01:00,  5.81it/s]  2%|▏         | 7/358 [00:01<01:00,  5.81it/s]  2%|▏         | 8/358 [00:01<01:00,  5.80it/s]  3%|▎         | 9/358 [00:01<01:00,  5.78it/s]  3%|▎         | 10/358 [00:01<01:00,  5.80it/s]  3%|▎         | 11/358 [00:01<00:59,  5.80it/s]  3%|▎         | 12/358 [00:02<00:59,  5.81it/s]  4%|▎         | 13/358 [00:02<00:59,  5.82it/s]  4%|▍         | 14/358 [00:02<00:59,  5.82it/s]  4%|▍         | 15/358 [00:02<00:59,  5.80it/s]  4%|▍         | 16/358 [00:02<00:59,  5.78it/s]  5%|▍         | 17/358 [00:02<00:58,  5.80it/s]  5%|▌         | 18/358 [00:03<00:58,  5.81it/s]  5%|▌         | 19/358 [00:03<00:58,  5.78it/s]  6%|▌         | 20/358 [00:03<00:58,  5.77it/s]  6%|▌         | 21/358 [00:03<00:58,  5.74it/s]  6%|▌         | 22/358 [00:03<00:58,  5.77it/s]  6%|▋         | 23/358 [00:03<00:57,  5.79it/s]  7%|▋         | 24/358 [00:04<00:58,  5.72it/s]  7%|▋         | 25/358 [00:04<00:57,  5.75it/s]  7%|▋         | 26/358 [00:04<00:57,  5.75it/s]  8%|▊         | 27/358 [00:04<00:57,  5.77it/s]  8%|▊         | 28/358 [00:04<00:57,  5.77it/s]  8%|▊         | 29/358 [00:05<00:56,  5.78it/s]  8%|▊         | 30/358 [00:05<00:56,  5.79it/s]  9%|▊         | 31/358 [00:05<00:56,  5.80it/s]  9%|▉         | 32/358 [00:05<00:56,  5.82it/s]  9%|▉         | 33/358 [00:05<00:55,  5.83it/s]  9%|▉         | 34/358 [00:05<00:55,  5.82it/s] 10%|▉         | 35/358 [00:06<00:55,  5.81it/s] 10%|█         | 36/358 [00:06<00:55,  5.81it/s] 10%|█         | 37/358 [00:06<00:55,  5.82it/s] 11%|█         | 38/358 [00:06<00:54,  5.83it/s] 11%|█         | 39/358 [00:06<00:54,  5.83it/s] 11%|█         | 40/358 [00:06<00:54,  5.81it/s] 11%|█▏        | 41/358 [00:07<00:54,  5.81it/s] 12%|█▏        | 42/358 [00:07<00:54,  5.83it/s] 12%|█▏        | 43/358 [00:07<00:54,  5.83it/s] 12%|█▏        | 44/358 [00:07<00:53,  5.83it/s] 13%|█▎        | 45/358 [00:07<00:53,  5.84it/s] 13%|█▎        | 46/358 [00:07<00:53,  5.84it/s] 13%|█▎        | 47/358 [00:08<00:53,  5.84it/s] 13%|█▎        | 48/358 [00:08<00:53,  5.85it/s] 14%|█▎        | 49/358 [00:08<00:52,  5.84it/s] 14%|█▍        | 50/358 [00:08<00:53,  5.79it/s] 14%|█▍        | 51/358 [00:08<00:53,  5.78it/s] 15%|█▍        | 52/358 [00:08<00:53,  5.75it/s] 15%|█▍        | 53/358 [00:09<00:52,  5.77it/s] 15%|█▌        | 54/358 [00:09<00:52,  5.79it/s] 15%|█▌        | 55/358 [00:09<00:52,  5.79it/s] 16%|█▌        | 56/358 [00:09<00:52,  5.79it/s] 16%|█▌        | 57/358 [00:09<00:51,  5.79it/s] 16%|█▌        | 58/358 [00:10<00:51,  5.81it/s] 16%|█▋        | 59/358 [00:10<00:51,  5.81it/s] 17%|█▋        | 60/358 [00:10<00:51,  5.82it/s] 17%|█▋        | 61/358 [00:10<00:51,  5.82it/s] 17%|█▋        | 62/358 [00:10<00:51,  5.78it/s] 18%|█▊        | 63/358 [00:10<00:50,  5.80it/s] 18%|█▊        | 64/358 [00:11<00:50,  5.80it/s] 18%|█▊        | 65/358 [00:11<00:50,  5.82it/s] 18%|█▊        | 66/358 [00:11<00:50,  5.81it/s] 19%|█▊        | 67/358 [00:11<00:50,  5.80it/s] 19%|█▉        | 68/358 [00:11<00:49,  5.83it/s] 19%|█▉        | 69/358 [00:11<00:49,  5.82it/s] 20%|█▉        | 70/358 [00:12<00:49,  5.80it/s] 20%|█▉        | 71/358 [00:12<00:49,  5.81it/s] 20%|██        | 72/358 [00:12<00:49,  5.81it/s] 20%|██        | 73/358 [00:12<00:49,  5.82it/s] 21%|██        | 74/358 [00:12<00:48,  5.80it/s] 21%|██        | 75/358 [00:12<00:48,  5.80it/s] 21%|██        | 76/358 [00:13<00:48,  5.81it/s] 22%|██▏       | 77/358 [00:13<00:48,  5.81it/s] 22%|██▏       | 78/358 [00:13<00:48,  5.82it/s] 22%|██▏       | 79/358 [00:13<00:48,  5.74it/s] 22%|██▏       | 80/358 [00:13<00:48,  5.78it/s] 23%|██▎       | 81/358 [00:13<00:47,  5.78it/s] 23%|██▎       | 82/358 [00:14<00:47,  5.79it/s] 23%|██▎       | 83/358 [00:14<00:48,  5.73it/s] 23%|██▎       | 84/358 [00:14<00:47,  5.74it/s] 24%|██▎       | 85/358 [00:14<00:47,  5.75it/s] 24%|██▍       | 86/358 [00:14<00:47,  5.78it/s] 24%|██▍       | 87/358 [00:15<00:46,  5.79it/s] 25%|██▍       | 88/358 [00:15<00:46,  5.82it/s] 25%|██▍       | 89/358 [00:15<00:46,  5.84it/s] 25%|██▌       | 90/358 [00:15<00:45,  5.84it/s] 25%|██▌       | 91/358 [00:15<00:45,  5.84it/s] 26%|██▌       | 92/358 [00:15<00:45,  5.84it/s] 26%|██▌       | 93/358 [00:16<00:45,  5.84it/s] 26%|██▋       | 94/358 [00:16<00:45,  5.83it/s] 27%|██▋       | 95/358 [00:16<00:45,  5.84it/s] 27%|██▋       | 96/358 [00:16<00:44,  5.84it/s] 27%|██▋       | 97/358 [00:16<00:44,  5.85it/s] 27%|██▋       | 98/358 [00:16<00:44,  5.82it/s] 28%|██▊       | 99/358 [00:17<00:44,  5.83it/s] 28%|██▊       | 100/358 [00:17<00:44,  5.84it/s] 28%|██▊       | 101/358 [00:17<00:44,  5.82it/s] 28%|██▊       | 102/358 [00:17<00:43,  5.83it/s] 29%|██▉       | 103/358 [00:17<00:43,  5.82it/s] 29%|██▉       | 104/358 [00:17<00:43,  5.81it/s] 29%|██▉       | 105/358 [00:18<00:43,  5.80it/s] 30%|██▉       | 106/358 [00:18<00:43,  5.80it/s] 30%|██▉       | 107/358 [00:18<00:43,  5.83it/s] 30%|███       | 108/358 [00:18<00:42,  5.81it/s] 30%|███       | 109/358 [00:18<00:43,  5.77it/s] 31%|███       | 110/358 [00:18<00:42,  5.80it/s] 31%|███       | 111/358 [00:19<00:42,  5.79it/s] 31%|███▏      | 112/358 [00:19<00:42,  5.81it/s] 32%|███▏      | 113/358 [00:19<00:42,  5.82it/s] 32%|███▏      | 114/358 [00:19<00:41,  5.83it/s] 32%|███▏      | 115/358 [00:19<00:41,  5.81it/s] 32%|███▏      | 116/358 [00:19<00:41,  5.78it/s] 33%|███▎      | 117/358 [00:20<00:41,  5.80it/s] 33%|███▎      | 118/358 [00:20<00:41,  5.81it/s] 33%|███▎      | 119/358 [00:20<00:41,  5.82it/s] 34%|███▎      | 120/358 [00:20<00:40,  5.83it/s] 34%|███▍      | 121/358 [00:20<00:40,  5.84it/s] 34%|███▍      | 122/358 [00:21<00:40,  5.84it/s] 34%|███▍      | 123/358 [00:21<00:40,  5.83it/s] 35%|███▍      | 124/358 [00:21<00:40,  5.83it/s] 35%|███▍      | 125/358 [00:21<00:39,  5.84it/s] 35%|███▌      | 126/358 [00:21<00:39,  5.83it/s] 35%|███▌      | 127/358 [00:21<00:39,  5.82it/s] 36%|███▌      | 128/358 [00:22<00:39,  5.82it/s] 36%|███▌      | 129/358 [00:22<00:39,  5.84it/s] 36%|███▋      | 130/358 [00:22<00:39,  5.84it/s] 37%|███▋      | 131/358 [00:22<00:38,  5.82it/s] 37%|███▋      | 132/358 [00:22<00:38,  5.83it/s] 37%|███▋      | 133/358 [00:22<00:38,  5.85it/s] 37%|███▋      | 134/358 [00:23<00:38,  5.79it/s] 38%|███▊      | 135/358 [00:23<00:38,  5.79it/s] 38%|███▊      | 136/358 [00:23<00:38,  5.82it/s] 38%|███▊      | 137/358 [00:23<00:38,  5.80it/s] 39%|███▊      | 138/358 [00:23<00:37,  5.82it/s] 39%|███▉      | 139/358 [00:23<00:37,  5.82it/s] 39%|███▉      | 140/358 [00:24<00:37,  5.84it/s] 39%|███▉      | 141/358 [00:24<00:37,  5.82it/s] 40%|███▉      | 142/358 [00:24<00:37,  5.82it/s] 40%|███▉      | 143/358 [00:24<00:37,  5.81it/s] 40%|████      | 144/358 [00:24<00:37,  5.78it/s] 41%|████      | 145/358 [00:24<00:36,  5.80it/s] 41%|████      | 146/358 [00:25<00:36,  5.80it/s] 41%|████      | 147/358 [00:25<00:36,  5.78it/s] 41%|████▏     | 148/358 [00:25<00:36,  5.80it/s] 42%|████▏     | 149/358 [00:25<00:35,  5.81it/s] 42%|████▏     | 150/358 [00:25<00:35,  5.81it/s] 42%|████▏     | 151/358 [00:26<00:36,  5.62it/s] 42%|████▏     | 152/358 [00:26<00:36,  5.65it/s] 43%|████▎     | 153/358 [00:26<00:36,  5.68it/s] 43%|████▎     | 154/358 [00:26<00:35,  5.73it/s] 43%|████▎     | 155/358 [00:26<00:35,  5.75it/s] 44%|████▎     | 156/358 [00:26<00:34,  5.78it/s] 44%|████▍     | 157/358 [00:27<00:34,  5.77it/s] 44%|████▍     | 158/358 [00:27<00:34,  5.79it/s] 44%|████▍     | 159/358 [00:27<00:34,  5.82it/s] 45%|████▍     | 160/358 [00:27<00:34,  5.81it/s] 45%|████▍     | 161/358 [00:27<00:33,  5.82it/s] 45%|████▌     | 162/358 [00:27<00:33,  5.83it/s] 46%|████▌     | 163/358 [00:28<00:33,  5.85it/s] 46%|████▌     | 164/358 [00:28<00:33,  5.84it/s] 46%|████▌     | 165/358 [00:28<00:33,  5.83it/s] 46%|████▋     | 166/358 [00:28<00:32,  5.83it/s] 47%|████▋     | 167/358 [00:28<00:32,  5.84it/s] 47%|████▋     | 168/358 [00:28<00:32,  5.85it/s] 47%|████▋     | 169/358 [00:29<00:32,  5.84it/s] 47%|████▋     | 170/358 [00:29<00:32,  5.84it/s] 48%|████▊     | 171/358 [00:29<00:32,  5.83it/s] 48%|████▊     | 172/358 [00:29<00:31,  5.84it/s] 48%|████▊     | 173/358 [00:29<00:31,  5.83it/s] 49%|████▊     | 174/358 [00:29<00:31,  5.83it/s] 49%|████▉     | 175/358 [00:30<00:31,  5.81it/s] 49%|████▉     | 176/358 [00:30<00:31,  5.78it/s] 49%|████▉     | 177/358 [00:30<00:31,  5.79it/s] 50%|████▉     | 178/358 [00:30<00:30,  5.81it/s] 50%|█████     | 179/358 [00:30<00:30,  5.83it/s] 50%|█████     | 180/358 [00:31<00:30,  5.81it/s] 51%|█████     | 181/358 [00:31<00:30,  5.81it/s] 51%|█████     | 182/358 [00:31<00:30,  5.82it/s] 51%|█████     | 183/358 [00:31<00:30,  5.83it/s] 51%|█████▏    | 184/358 [00:31<00:30,  5.77it/s] 52%|█████▏    | 185/358 [00:31<00:29,  5.79it/s] 52%|█████▏    | 186/358 [00:32<00:29,  5.80it/s] 52%|█████▏    | 187/358 [00:32<00:29,  5.82it/s] 53%|█████▎    | 188/358 [00:32<00:29,  5.82it/s] 53%|█████▎    | 189/358 [00:32<00:28,  5.83it/s] 53%|█████▎    | 190/358 [00:32<00:28,  5.82it/s] 53%|█████▎    | 191/358 [00:32<00:29,  5.72it/s] 54%|█████▎    | 192/358 [00:33<00:28,  5.74it/s] 54%|█████▍    | 193/358 [00:33<00:28,  5.77it/s] 54%|█████▍    | 194/358 [00:33<00:28,  5.78it/s] 54%|█████▍    | 195/358 [00:33<00:28,  5.80it/s] 55%|█████▍    | 196/358 [00:33<00:27,  5.83it/s] 55%|█████▌    | 197/358 [00:33<00:27,  5.82it/s] 55%|█████▌    | 198/358 [00:34<00:27,  5.82it/s] 56%|█████▌    | 199/358 [00:34<00:27,  5.82it/s] 56%|█████▌    | 200/358 [00:34<00:27,  5.82it/s] 56%|█████▌    | 201/358 [00:34<00:26,  5.83it/s] 56%|█████▋    | 202/358 [00:34<00:26,  5.83it/s] 57%|█████▋    | 203/358 [00:34<00:26,  5.82it/s] 57%|█████▋    | 204/358 [00:35<00:26,  5.78it/s] 57%|█████▋    | 205/358 [00:35<00:26,  5.78it/s] 58%|█████▊    | 206/358 [00:35<00:26,  5.81it/s] 58%|█████▊    | 207/358 [00:35<00:26,  5.79it/s] 58%|█████▊    | 208/358 [00:35<00:25,  5.79it/s] 58%|█████▊    | 209/358 [00:36<00:25,  5.81it/s] 59%|█████▊    | 210/358 [00:36<00:25,  5.81it/s] 59%|█████▉    | 211/358 [00:36<00:25,  5.82it/s] 59%|█████▉    | 212/358 [00:36<00:25,  5.80it/s] 59%|█████▉    | 213/358 [00:36<00:24,  5.83it/s] 60%|█████▉    | 214/358 [00:36<00:24,  5.83it/s] 60%|██████    | 215/358 [00:37<00:24,  5.82it/s] 60%|██████    | 216/358 [00:37<00:24,  5.81it/s] 61%|██████    | 217/358 [00:37<00:24,  5.83it/s] 61%|██████    | 218/358 [00:37<00:24,  5.82it/s] 61%|██████    | 219/358 [00:37<00:23,  5.82it/s] 61%|██████▏   | 220/358 [00:37<00:23,  5.83it/s] 62%|██████▏   | 221/358 [00:38<00:23,  5.84it/s] 62%|██████▏   | 222/358 [00:38<00:23,  5.80it/s] 62%|██████▏   | 223/358 [00:38<00:23,  5.80it/s] 63%|██████▎   | 224/358 [00:38<00:23,  5.79it/s] 63%|██████▎   | 225/358 [00:38<00:22,  5.81it/s] 63%|██████▎   | 226/358 [00:38<00:22,  5.81it/s] 63%|██████▎   | 227/358 [00:39<00:22,  5.82it/s] 64%|██████▎   | 228/358 [00:39<00:22,  5.81it/s] 64%|██████▍   | 229/358 [00:39<00:22,  5.82it/s] 64%|██████▍   | 230/358 [00:39<00:22,  5.81it/s] 65%|██████▍   | 231/358 [00:39<00:21,  5.83it/s] 65%|██████▍   | 232/358 [00:39<00:21,  5.81it/s] 65%|██████▌   | 233/358 [00:40<00:21,  5.83it/s] 65%|██████▌   | 234/358 [00:40<00:21,  5.85it/s] 66%|██████▌   | 235/358 [00:40<00:21,  5.86it/s] 66%|██████▌   | 236/358 [00:40<00:20,  5.84it/s] 66%|██████▌   | 237/358 [00:40<00:20,  5.84it/s] 66%|██████▋   | 238/358 [00:40<00:20,  5.85it/s] 67%|██████▋   | 239/358 [00:41<00:20,  5.85it/s] 67%|██████▋   | 240/358 [00:41<00:20,  5.83it/s] 67%|██████▋   | 241/358 [00:41<00:20,  5.85it/s] 68%|██████▊   | 242/358 [00:41<00:19,  5.83it/s] 68%|██████▊   | 243/358 [00:41<00:19,  5.83it/s] 68%|██████▊   | 244/358 [00:42<00:19,  5.84it/s] 68%|██████▊   | 245/358 [00:42<00:19,  5.85it/s] 69%|██████▊   | 246/358 [00:42<00:19,  5.83it/s] 69%|██████▉   | 247/358 [00:42<00:19,  5.80it/s] 69%|██████▉   | 248/358 [00:42<00:18,  5.81it/s] 70%|██████▉   | 249/358 [00:42<00:18,  5.83it/s] 70%|██████▉   | 250/358 [00:43<00:18,  5.82it/s] 70%|███████   | 251/358 [00:43<00:18,  5.81it/s] 70%|███████   | 252/358 [00:43<00:18,  5.80it/s] 71%|███████   | 253/358 [00:43<00:18,  5.80it/s] 71%|███████   | 254/358 [00:43<00:17,  5.79it/s] 71%|███████   | 255/358 [00:43<00:17,  5.81it/s] 72%|███████▏  | 256/358 [00:44<00:17,  5.83it/s] 72%|███████▏  | 257/358 [00:44<00:17,  5.83it/s] 72%|███████▏  | 258/358 [00:44<00:17,  5.77it/s] 72%|███████▏  | 259/358 [00:44<00:17,  5.79it/s] 73%|███████▎  | 260/358 [00:44<00:16,  5.77it/s] 73%|███████▎  | 261/358 [00:44<00:16,  5.79it/s] 73%|███████▎  | 262/358 [00:45<00:16,  5.77it/s] 73%|███████▎  | 263/358 [00:45<00:16,  5.80it/s] 74%|███████▎  | 264/358 [00:45<00:16,  5.78it/s] 74%|███████▍  | 265/358 [00:45<00:16,  5.81it/s] 74%|███████▍  | 266/358 [00:45<00:15,  5.80it/s] 75%|███████▍  | 267/358 [00:45<00:15,  5.81it/s] 75%|███████▍  | 268/358 [00:46<00:15,  5.82it/s] 75%|███████▌  | 269/358 [00:46<00:15,  5.82it/s] 75%|███████▌  | 270/358 [00:46<00:15,  5.78it/s] 76%|███████▌  | 271/358 [00:46<00:15,  5.78it/s] 76%|███████▌  | 272/358 [00:46<00:14,  5.79it/s] 76%|███████▋  | 273/358 [00:47<00:14,  5.73it/s] 77%|███████▋  | 274/358 [00:47<00:14,  5.76it/s] 77%|███████▋  | 275/358 [00:47<00:14,  5.79it/s] 77%|███████▋  | 276/358 [00:47<00:14,  5.79it/s] 77%|███████▋  | 277/358 [00:47<00:13,  5.80it/s] 78%|███████▊  | 278/358 [00:47<00:13,  5.80it/s] 78%|███████▊  | 279/358 [00:48<00:13,  5.82it/s] 78%|███████▊  | 280/358 [00:48<00:13,  5.80it/s] 78%|███████▊  | 281/358 [00:48<00:13,  5.82it/s] 79%|███████▉  | 282/358 [00:48<00:13,  5.81it/s] 79%|███████▉  | 283/358 [00:48<00:12,  5.80it/s] 79%|███████▉  | 284/358 [00:48<00:12,  5.79it/s] 80%|███████▉  | 285/358 [00:49<00:12,  5.81it/s] 80%|███████▉  | 286/358 [00:49<00:12,  5.81it/s] 80%|████████  | 287/358 [00:49<00:12,  5.81it/s] 80%|████████  | 288/358 [00:49<00:12,  5.80it/s] 81%|████████  | 289/358 [00:49<00:11,  5.83it/s] 81%|████████  | 290/358 [00:49<00:11,  5.83it/s] 81%|████████▏ | 291/358 [00:50<00:11,  5.83it/s] 82%|████████▏ | 292/358 [00:50<00:11,  5.83it/s] 82%|████████▏ | 293/358 [00:50<00:11,  5.80it/s] 82%|████████▏ | 294/358 [00:50<00:10,  5.82it/s] 82%|████████▏ | 295/358 [00:50<00:10,  5.82it/s] 83%|████████▎ | 296/358 [00:50<00:10,  5.82it/s] 83%|████████▎ | 297/358 [00:51<00:10,  5.78it/s] 83%|████████▎ | 298/358 [00:51<00:10,  5.80it/s] 84%|████████▎ | 299/358 [00:51<00:10,  5.82it/s] 84%|████████▍ | 300/358 [00:51<00:09,  5.83it/s] 84%|████████▍ | 301/358 [00:51<00:09,  5.83it/s] 84%|████████▍ | 302/358 [00:52<00:09,  5.83it/s] 85%|████████▍ | 303/358 [00:52<00:09,  5.83it/s] 85%|████████▍ | 304/358 [00:52<00:09,  5.84it/s] 85%|████████▌ | 305/358 [00:52<00:09,  5.84it/s] 85%|████████▌ | 306/358 [00:52<00:08,  5.82it/s] 86%|████████▌ | 307/358 [00:52<00:08,  5.84it/s] 86%|████████▌ | 308/358 [00:53<00:08,  5.83it/s] 86%|████████▋ | 309/358 [00:53<00:08,  5.80it/s] 87%|████████▋ | 310/358 [00:53<00:08,  5.79it/s] 87%|████████▋ | 311/358 [00:53<00:08,  5.77it/s] 87%|████████▋ | 312/358 [00:53<00:07,  5.78it/s] 87%|████████▋ | 313/358 [00:53<00:07,  5.80it/s] 88%|████████▊ | 314/358 [00:54<00:07,  5.81it/s] 88%|████████▊ | 315/358 [00:54<00:07,  5.82it/s] 88%|████████▊ | 316/358 [00:54<00:07,  5.83it/s] 89%|████████▊ | 317/358 [00:54<00:07,  5.82it/s] 89%|████████▉ | 318/358 [00:54<00:06,  5.83it/s] 89%|████████▉ | 319/358 [00:54<00:06,  5.83it/s] 89%|████████▉ | 320/358 [00:55<00:06,  5.84it/s] 90%|████████▉ | 321/358 [00:55<00:06,  5.83it/s] 90%|████████▉ | 322/358 [00:55<00:06,  5.84it/s] 90%|█████████ | 323/358 [00:55<00:06,  5.81it/s] 91%|█████████ | 324/358 [00:55<00:05,  5.81it/s] 91%|█████████ | 325/358 [00:55<00:05,  5.79it/s] 91%|█████████ | 326/358 [00:56<00:05,  5.80it/s] 91%|█████████▏| 327/358 [00:56<00:05,  5.82it/s] 92%|█████████▏| 328/358 [00:56<00:05,  5.84it/s] 92%|█████████▏| 329/358 [00:56<00:04,  5.85it/s] 92%|█████████▏| 330/358 [00:56<00:04,  5.84it/s] 92%|█████████▏| 331/358 [00:56<00:04,  5.86it/s] 93%|█████████▎| 332/358 [00:57<00:04,  5.86it/s] 93%|█████████▎| 333/358 [00:57<00:04,  5.85it/s] 93%|█████████▎| 334/358 [00:57<00:04,  5.82it/s] 94%|█████████▎| 335/358 [00:57<00:04,  5.75it/s] 94%|█████████▍| 336/358 [00:57<00:03,  5.78it/s] 94%|█████████▍| 337/358 [00:58<00:03,  5.80it/s] 94%|█████████▍| 338/358 [00:58<00:03,  5.83it/s] 95%|█████████▍| 339/358 [00:58<00:03,  5.84it/s] 95%|█████████▍| 340/358 [00:58<00:03,  5.84it/s] 95%|█████████▌| 341/358 [00:58<00:02,  5.83it/s] 96%|█████████▌| 342/358 [00:58<00:02,  5.83it/s] 96%|█████████▌| 343/358 [00:59<00:02,  5.80it/s] 96%|█████████▌| 344/358 [00:59<00:02,  5.81it/s] 96%|█████████▋| 345/358 [00:59<00:02,  5.83it/s] 97%|█████████▋| 346/358 [00:59<00:02,  5.84it/s] 97%|█████████▋| 347/358 [00:59<00:01,  5.86it/s] 97%|█████████▋| 348/358 [00:59<00:01,  5.85it/s] 97%|█████████▋| 349/358 [01:00<00:01,  5.83it/s] 98%|█████████▊| 350/358 [01:00<00:01,  5.82it/s] 98%|█████████▊| 351/358 [01:00<00:01,  5.82it/s] 98%|█████████▊| 352/358 [01:00<00:01,  5.83it/s] 99%|█████████▊| 353/358 [01:00<00:00,  5.84it/s] 99%|█████████▉| 354/358 [01:00<00:00,  5.84it/s] 99%|█████████▉| 355/358 [01:01<00:00,  5.84it/s] 99%|█████████▉| 356/358 [01:01<00:00,  5.85it/s]100%|█████████▉| 357/358 [01:01<00:00,  5.79it/s]100%|██████████| 358/358 [01:01<00:00,  5.88it/s]100%|██████████| 358/358 [01:01<00:00,  5.81it/s]
[32m2025-02-05 05:02:22.323[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    grad norm  info_loss
        1.502      .4559[0m
[32m2025-02-05 05:02:22.324[0m | [1mINFO    [0m | [36mcrslab.system.base[0m:[36mbuild_optimizer[0m:[36m142[0m - [1m[Build optimizer: Adam][0m
[32m2025-02-05 05:02:22.325[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_recommender[0m:[36m130[0m - [1m[Recommendation epoch 0][0m
[32m2025-02-05 05:02:22.325[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_recommender[0m:[36m131[0m - [1m[Train][0m
  0%|          | 0/92414 [00:00<?, ?it/s]  5%|▌         | 4759/92414 [00:00<00:01, 47564.98it/s] 10%|█         | 9558/92414 [00:00<00:01, 47765.94it/s] 16%|█▌        | 14450/92414 [00:00<00:01, 48291.26it/s] 21%|██        | 19302/92414 [00:00<00:01, 48372.44it/s] 26%|██▌       | 24140/92414 [00:00<00:03, 18259.34it/s] 32%|███▏      | 29178/92414 [00:01<00:02, 23481.24it/s] 37%|███▋      | 34241/92414 [00:01<00:02, 28598.33it/s] 43%|████▎     | 39380/92414 [00:01<00:01, 33433.62it/s] 48%|████▊     | 44607/92414 [00:01<00:01, 37809.10it/s] 54%|█████▍    | 49938/92414 [00:01<00:01, 41658.15it/s] 59%|█████▉    | 54918/92414 [00:01<00:00, 43771.66it/s] 65%|██████▍   | 59954/92414 [00:01<00:00, 45560.38it/s] 70%|███████   | 65059/92414 [00:01<00:00, 47098.97it/s] 76%|███████▌  | 70076/92414 [00:01<00:00, 47515.39it/s] 81%|████████▏ | 75097/92414 [00:01<00:00, 48286.77it/s] 87%|████████▋ | 80088/92414 [00:02<00:00, 48740.25it/s] 92%|█████████▏| 85268/92414 [00:02<00:00, 49625.28it/s] 98%|█████████▊| 90354/92414 [00:02<00:00, 49967.46it/s]100%|██████████| 92414/92414 [00:02<00:00, 40125.56it/s]
[32m2025-02-05 05:02:24.628[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/209 [00:00<?, ?it/s]  0%|          | 1/209 [00:00<00:46,  4.45it/s]  1%|          | 2/209 [00:00<00:40,  5.07it/s]  1%|▏         | 3/209 [00:00<00:38,  5.36it/s]  2%|▏         | 4/209 [00:00<00:37,  5.48it/s]  2%|▏         | 5/209 [00:00<00:36,  5.53it/s]  3%|▎         | 6/209 [00:01<00:36,  5.57it/s]  3%|▎         | 7/209 [00:01<00:35,  5.62it/s]  4%|▍         | 8/209 [00:01<00:35,  5.65it/s]  4%|▍         | 9/209 [00:01<00:35,  5.60it/s]  5%|▍         | 10/209 [00:01<00:35,  5.63it/s]  5%|▌         | 11/209 [00:01<00:35,  5.63it/s]  6%|▌         | 12/209 [00:02<00:35,  5.60it/s]  6%|▌         | 13/209 [00:02<00:34,  5.62it/s]  7%|▋         | 14/209 [00:02<00:35,  5.55it/s]  7%|▋         | 15/209 [00:02<00:35,  5.53it/s]  8%|▊         | 16/209 [00:02<00:34,  5.58it/s]  8%|▊         | 17/209 [00:03<00:34,  5.59it/s]  9%|▊         | 18/209 [00:03<00:33,  5.63it/s]  9%|▉         | 19/209 [00:03<00:33,  5.66it/s] 10%|▉         | 20/209 [00:03<00:33,  5.65it/s] 10%|█         | 21/209 [00:03<00:33,  5.64it/s] 11%|█         | 22/209 [00:03<00:33,  5.64it/s] 11%|█         | 23/209 [00:04<00:33,  5.63it/s] 11%|█▏        | 24/209 [00:04<00:32,  5.64it/s] 12%|█▏        | 25/209 [00:04<00:32,  5.63it/s] 12%|█▏        | 26/209 [00:04<00:32,  5.66it/s] 13%|█▎        | 27/209 [00:04<00:32,  5.68it/s] 13%|█▎        | 28/209 [00:05<00:31,  5.67it/s] 14%|█▍        | 29/209 [00:05<00:31,  5.64it/s] 14%|█▍        | 30/209 [00:05<00:31,  5.61it/s] 15%|█▍        | 31/209 [00:05<00:31,  5.59it/s] 15%|█▌        | 32/209 [00:05<00:31,  5.60it/s] 16%|█▌        | 33/209 [00:05<00:31,  5.59it/s] 16%|█▋        | 34/209 [00:06<00:31,  5.60it/s] 17%|█▋        | 35/209 [00:06<00:31,  5.61it/s] 17%|█▋        | 36/209 [00:06<00:30,  5.60it/s] 18%|█▊        | 37/209 [00:06<00:30,  5.59it/s] 18%|█▊        | 38/209 [00:06<00:30,  5.59it/s] 19%|█▊        | 39/209 [00:06<00:30,  5.58it/s] 19%|█▉        | 40/209 [00:07<00:30,  5.59it/s] 20%|█▉        | 41/209 [00:07<00:30,  5.56it/s] 20%|██        | 42/209 [00:07<00:30,  5.56it/s] 21%|██        | 43/209 [00:07<00:29,  5.55it/s] 21%|██        | 44/209 [00:07<00:29,  5.58it/s] 22%|██▏       | 45/209 [00:08<00:29,  5.58it/s] 22%|██▏       | 46/209 [00:08<00:29,  5.56it/s] 22%|██▏       | 47/209 [00:08<00:29,  5.57it/s] 23%|██▎       | 48/209 [00:08<00:28,  5.57it/s] 23%|██▎       | 49/209 [00:08<00:28,  5.60it/s] 24%|██▍       | 50/209 [00:08<00:28,  5.60it/s] 24%|██▍       | 51/209 [00:09<00:28,  5.62it/s] 25%|██▍       | 52/209 [00:09<00:27,  5.65it/s] 25%|██▌       | 53/209 [00:09<00:27,  5.63it/s] 26%|██▌       | 54/209 [00:09<00:27,  5.61it/s] 26%|██▋       | 55/209 [00:09<00:27,  5.64it/s] 27%|██▋       | 56/209 [00:10<00:27,  5.64it/s] 27%|██▋       | 57/209 [00:10<00:27,  5.61it/s] 28%|██▊       | 58/209 [00:10<00:26,  5.64it/s] 28%|██▊       | 59/209 [00:10<00:26,  5.63it/s] 29%|██▊       | 60/209 [00:10<00:26,  5.59it/s] 29%|██▉       | 61/209 [00:10<00:26,  5.62it/s] 30%|██▉       | 62/209 [00:11<00:26,  5.62it/s] 30%|███       | 63/209 [00:11<00:26,  5.61it/s] 31%|███       | 64/209 [00:11<00:25,  5.62it/s] 31%|███       | 65/209 [00:11<00:25,  5.66it/s] 32%|███▏      | 66/209 [00:11<00:25,  5.68it/s] 32%|███▏      | 67/209 [00:11<00:25,  5.64it/s] 33%|███▎      | 68/209 [00:12<00:24,  5.67it/s] 33%|███▎      | 69/209 [00:12<00:24,  5.65it/s] 33%|███▎      | 70/209 [00:12<00:24,  5.68it/s] 34%|███▍      | 71/209 [00:12<00:24,  5.64it/s] 34%|███▍      | 72/209 [00:12<00:24,  5.64it/s] 35%|███▍      | 73/209 [00:13<00:24,  5.65it/s] 35%|███▌      | 74/209 [00:13<00:23,  5.64it/s] 36%|███▌      | 75/209 [00:13<00:23,  5.66it/s] 36%|███▋      | 76/209 [00:13<00:23,  5.67it/s] 37%|███▋      | 77/209 [00:13<00:23,  5.69it/s] 37%|███▋      | 78/209 [00:13<00:23,  5.62it/s] 38%|███▊      | 79/209 [00:14<00:23,  5.61it/s] 38%|███▊      | 80/209 [00:14<00:23,  5.59it/s] 39%|███▉      | 81/209 [00:14<00:22,  5.61it/s] 39%|███▉      | 82/209 [00:14<00:22,  5.62it/s] 40%|███▉      | 83/209 [00:14<00:22,  5.61it/s] 40%|████      | 84/209 [00:14<00:22,  5.61it/s] 41%|████      | 85/209 [00:15<00:22,  5.57it/s] 41%|████      | 86/209 [00:15<00:22,  5.59it/s] 42%|████▏     | 87/209 [00:15<00:22,  5.51it/s] 42%|████▏     | 88/209 [00:15<00:21,  5.57it/s] 43%|████▎     | 89/209 [00:15<00:21,  5.58it/s] 43%|████▎     | 90/209 [00:16<00:21,  5.59it/s] 44%|████▎     | 91/209 [00:16<00:21,  5.56it/s] 44%|████▍     | 92/209 [00:16<00:20,  5.57it/s] 44%|████▍     | 93/209 [00:16<00:20,  5.57it/s] 45%|████▍     | 94/209 [00:16<00:20,  5.60it/s] 45%|████▌     | 95/209 [00:16<00:20,  5.60it/s] 46%|████▌     | 96/209 [00:17<00:20,  5.60it/s] 46%|████▋     | 97/209 [00:17<00:19,  5.64it/s] 47%|████▋     | 98/209 [00:17<00:19,  5.64it/s] 47%|████▋     | 99/209 [00:17<00:19,  5.65it/s] 48%|████▊     | 100/209 [00:17<00:19,  5.65it/s] 48%|████▊     | 101/209 [00:18<00:19,  5.62it/s] 49%|████▉     | 102/209 [00:18<00:19,  5.62it/s] 49%|████▉     | 103/209 [00:18<00:18,  5.65it/s] 50%|████▉     | 104/209 [00:18<00:18,  5.63it/s] 50%|█████     | 105/209 [00:18<00:18,  5.64it/s] 51%|█████     | 106/209 [00:18<00:18,  5.60it/s] 51%|█████     | 107/209 [00:19<00:18,  5.64it/s] 52%|█████▏    | 108/209 [00:19<00:17,  5.67it/s] 52%|█████▏    | 109/209 [00:19<00:17,  5.66it/s] 53%|█████▎    | 110/209 [00:19<00:17,  5.58it/s] 53%|█████▎    | 111/209 [00:19<00:17,  5.57it/s] 54%|█████▎    | 112/209 [00:19<00:17,  5.61it/s] 54%|█████▍    | 113/209 [00:20<00:16,  5.66it/s] 55%|█████▍    | 114/209 [00:20<00:16,  5.66it/s] 55%|█████▌    | 115/209 [00:20<00:16,  5.69it/s] 56%|█████▌    | 116/209 [00:20<00:16,  5.66it/s] 56%|█████▌    | 117/209 [00:20<00:16,  5.65it/s] 56%|█████▋    | 118/209 [00:21<00:16,  5.58it/s] 57%|█████▋    | 119/209 [00:21<00:16,  5.60it/s] 57%|█████▋    | 120/209 [00:21<00:15,  5.63it/s] 58%|█████▊    | 121/209 [00:21<00:15,  5.62it/s] 58%|█████▊    | 122/209 [00:21<00:15,  5.63it/s] 59%|█████▉    | 123/209 [00:21<00:15,  5.63it/s] 59%|█████▉    | 124/209 [00:22<00:15,  5.62it/s] 60%|█████▉    | 125/209 [00:22<00:15,  5.60it/s] 60%|██████    | 126/209 [00:22<00:14,  5.60it/s] 61%|██████    | 127/209 [00:22<00:14,  5.63it/s] 61%|██████    | 128/209 [00:22<00:14,  5.61it/s] 62%|██████▏   | 129/209 [00:23<00:14,  5.65it/s] 62%|██████▏   | 130/209 [00:23<00:13,  5.68it/s] 63%|██████▎   | 131/209 [00:23<00:13,  5.67it/s] 63%|██████▎   | 132/209 [00:23<00:13,  5.66it/s] 64%|██████▎   | 133/209 [00:23<00:13,  5.65it/s] 64%|██████▍   | 134/209 [00:23<00:13,  5.60it/s] 65%|██████▍   | 135/209 [00:24<00:13,  5.64it/s] 65%|██████▌   | 136/209 [00:24<00:12,  5.64it/s] 66%|██████▌   | 137/209 [00:24<00:12,  5.64it/s] 66%|██████▌   | 138/209 [00:24<00:12,  5.66it/s] 67%|██████▋   | 139/209 [00:24<00:12,  5.61it/s] 67%|██████▋   | 140/209 [00:24<00:12,  5.63it/s] 67%|██████▋   | 141/209 [00:25<00:12,  5.65it/s] 68%|██████▊   | 142/209 [00:25<00:11,  5.61it/s] 68%|██████▊   | 143/209 [00:25<00:11,  5.60it/s] 69%|██████▉   | 144/209 [00:25<00:11,  5.60it/s] 69%|██████▉   | 145/209 [00:25<00:11,  5.59it/s] 70%|██████▉   | 146/209 [00:26<00:11,  5.60it/s] 70%|███████   | 147/209 [00:26<00:11,  5.60it/s] 71%|███████   | 148/209 [00:26<00:10,  5.60it/s] 71%|███████▏  | 149/209 [00:26<00:10,  5.61it/s] 72%|███████▏  | 150/209 [00:26<00:10,  5.57it/s] 72%|███████▏  | 151/209 [00:26<00:10,  5.58it/s] 73%|███████▎  | 152/209 [00:27<00:10,  5.63it/s] 73%|███████▎  | 153/209 [00:27<00:09,  5.63it/s] 74%|███████▎  | 154/209 [00:27<00:09,  5.64it/s] 74%|███████▍  | 155/209 [00:27<00:09,  5.63it/s] 75%|███████▍  | 156/209 [00:27<00:09,  5.66it/s] 75%|███████▌  | 157/209 [00:27<00:09,  5.67it/s] 76%|███████▌  | 158/209 [00:28<00:09,  5.62it/s] 76%|███████▌  | 159/209 [00:28<00:08,  5.58it/s] 77%|███████▋  | 160/209 [00:28<00:08,  5.61it/s] 77%|███████▋  | 161/209 [00:28<00:08,  5.60it/s] 78%|███████▊  | 162/209 [00:28<00:08,  5.62it/s] 78%|███████▊  | 163/209 [00:29<00:08,  5.63it/s] 78%|███████▊  | 164/209 [00:29<00:08,  5.61it/s] 79%|███████▉  | 165/209 [00:29<00:07,  5.64it/s] 79%|███████▉  | 166/209 [00:29<00:07,  5.63it/s] 80%|███████▉  | 167/209 [00:29<00:07,  5.65it/s] 80%|████████  | 168/209 [00:29<00:07,  5.69it/s] 81%|████████  | 169/209 [00:30<00:07,  5.67it/s] 81%|████████▏ | 170/209 [00:30<00:06,  5.70it/s] 82%|████████▏ | 171/209 [00:30<00:06,  5.66it/s] 82%|████████▏ | 172/209 [00:30<00:06,  5.67it/s] 83%|████████▎ | 173/209 [00:30<00:06,  5.59it/s] 83%|████████▎ | 174/209 [00:30<00:06,  5.60it/s] 84%|████████▎ | 175/209 [00:31<00:06,  5.61it/s] 84%|████████▍ | 176/209 [00:31<00:05,  5.61it/s] 85%|████████▍ | 177/209 [00:31<00:05,  5.63it/s] 85%|████████▌ | 178/209 [00:31<00:05,  5.63it/s] 86%|████████▌ | 179/209 [00:31<00:05,  5.63it/s] 86%|████████▌ | 180/209 [00:32<00:05,  5.65it/s] 87%|████████▋ | 181/209 [00:32<00:05,  5.60it/s] 87%|████████▋ | 182/209 [00:32<00:04,  5.64it/s] 88%|████████▊ | 183/209 [00:32<00:04,  5.61it/s] 88%|████████▊ | 184/209 [00:32<00:04,  5.62it/s] 89%|████████▊ | 185/209 [00:32<00:04,  5.64it/s] 89%|████████▉ | 186/209 [00:33<00:04,  5.62it/s] 89%|████████▉ | 187/209 [00:33<00:03,  5.60it/s] 90%|████████▉ | 188/209 [00:33<00:03,  5.62it/s] 90%|█████████ | 189/209 [00:33<00:03,  5.63it/s] 91%|█████████ | 190/209 [00:33<00:03,  5.65it/s] 91%|█████████▏| 191/209 [00:34<00:03,  5.68it/s] 92%|█████████▏| 192/209 [00:34<00:03,  5.65it/s] 92%|█████████▏| 193/209 [00:34<00:02,  5.64it/s] 93%|█████████▎| 194/209 [00:34<00:02,  5.61it/s] 93%|█████████▎| 195/209 [00:34<00:02,  5.59it/s] 94%|█████████▍| 196/209 [00:34<00:02,  5.63it/s] 94%|█████████▍| 197/209 [00:35<00:02,  5.67it/s] 95%|█████████▍| 198/209 [00:35<00:01,  5.65it/s] 95%|█████████▌| 199/209 [00:35<00:01,  5.67it/s] 96%|█████████▌| 200/209 [00:35<00:01,  5.64it/s] 96%|█████████▌| 201/209 [00:35<00:01,  5.67it/s] 97%|█████████▋| 202/209 [00:35<00:01,  5.69it/s] 97%|█████████▋| 203/209 [00:36<00:01,  5.65it/s] 98%|█████████▊| 204/209 [00:36<00:00,  5.67it/s] 98%|█████████▊| 205/209 [00:36<00:00,  5.70it/s] 99%|█████████▊| 206/209 [00:36<00:00,  5.70it/s] 99%|█████████▉| 207/209 [00:36<00:00,  5.69it/s]100%|█████████▉| 208/209 [00:37<00:00,  5.61it/s]100%|██████████| 209/209 [00:37<00:00,  5.75it/s]100%|██████████| 209/209 [00:37<00:00,  5.62it/s]
[32m2025-02-05 05:03:01.877[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    grad norm  info_loss  rec_loss
        25.53      1.147     8.275[0m
[32m2025-02-05 05:03:01.877[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_recommender[0m:[36m136[0m - [1m[Valid][0m
  0%|          | 0/10256 [00:00<?, ?it/s] 49%|████▊     | 4978/10256 [00:00<00:00, 49762.61it/s] 97%|█████████▋| 9955/10256 [00:00<00:00, 47711.75it/s]100%|██████████| 10256/10256 [00:00<00:00, 47512.62it/s]
[32m2025-02-05 05:03:02.094[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/24 [00:00<?, ?it/s]  8%|▊         | 2/24 [00:00<00:01, 18.50it/s] 17%|█▋        | 4/24 [00:00<00:01, 18.88it/s] 29%|██▉       | 7/24 [00:00<00:00, 19.60it/s] 42%|████▏     | 10/24 [00:00<00:00, 20.09it/s] 54%|█████▍    | 13/24 [00:00<00:00, 20.32it/s] 67%|██████▋   | 16/24 [00:00<00:00, 20.17it/s] 79%|███████▉  | 19/24 [00:00<00:00, 20.49it/s] 92%|█████████▏| 22/24 [00:01<00:00, 20.29it/s]100%|██████████| 24/24 [00:01<00:00, 20.44it/s]
[32m2025-02-05 05:03:03.281[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    hit@1  hit@10  hit@50  info_loss  mrr@1  mrr@10  mrr@50  ndcg@1  ndcg@10  ndcg@50  \
   .02724   .1621   .3455      .6787 .02724  .06102  .06976  .02724   .08457    .1251   
    rec_loss  
       7.225[0m
[32m2025-02-05 05:03:03.281[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_recommender[0m:[36m130[0m - [1m[Recommendation epoch 1][0m
[32m2025-02-05 05:03:03.281[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_recommender[0m:[36m131[0m - [1m[Train][0m
  0%|          | 0/92414 [00:00<?, ?it/s]  5%|▌         | 4786/92414 [00:00<00:01, 47800.67it/s] 10%|█         | 9698/92414 [00:00<00:01, 48565.69it/s] 16%|█▌        | 14624/92414 [00:00<00:01, 48881.93it/s] 21%|██        | 19513/92414 [00:00<00:01, 48869.59it/s] 26%|██▋       | 24400/92414 [00:00<00:03, 18952.15it/s] 32%|███▏      | 29374/92414 [00:01<00:02, 24076.63it/s] 37%|███▋      | 34529/92414 [00:01<00:01, 29349.29it/s] 43%|████▎     | 39585/92414 [00:01<00:01, 33911.17it/s] 48%|████▊     | 44811/92414 [00:01<00:01, 38203.09it/s] 54%|█████▍    | 49859/92414 [00:01<00:01, 41287.75it/s] 59%|█████▉    | 54719/92414 [00:01<00:00, 43184.56it/s] 65%|██████▍   | 59693/92414 [00:01<00:00, 44973.16it/s] 70%|██████▉   | 64628/92414 [00:01<00:00, 46194.64it/s] 75%|███████▌  | 69531/92414 [00:01<00:00, 46482.91it/s] 80%|████████  | 74379/92414 [00:01<00:00, 47056.26it/s] 86%|████████▌ | 79307/92414 [00:02<00:00, 47690.57it/s] 91%|█████████ | 84242/92414 [00:02<00:00, 48175.69it/s] 97%|█████████▋| 89267/92414 [00:02<00:00, 48761.33it/s]100%|██████████| 92414/92414 [00:02<00:00, 40037.77it/s]
[32m2025-02-05 05:03:05.590[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/209 [00:00<?, ?it/s]  0%|          | 1/209 [00:00<00:36,  5.71it/s]  1%|          | 2/209 [00:00<00:36,  5.73it/s]  1%|▏         | 3/209 [00:00<00:35,  5.74it/s]  2%|▏         | 4/209 [00:00<00:35,  5.72it/s]  2%|▏         | 5/209 [00:00<00:35,  5.68it/s]  3%|▎         | 6/209 [00:01<00:35,  5.67it/s]  3%|▎         | 7/209 [00:01<00:35,  5.68it/s]  4%|▍         | 8/209 [00:01<00:35,  5.69it/s]  4%|▍         | 9/209 [00:01<00:35,  5.67it/s]  5%|▍         | 10/209 [00:01<00:35,  5.68it/s]  5%|▌         | 11/209 [00:01<00:34,  5.69it/s]  6%|▌         | 12/209 [00:02<00:34,  5.67it/s]  6%|▌         | 13/209 [00:02<00:34,  5.68it/s]  7%|▋         | 14/209 [00:02<00:34,  5.62it/s]  7%|▋         | 15/209 [00:02<00:34,  5.61it/s]  8%|▊         | 16/209 [00:02<00:34,  5.64it/s]  8%|▊         | 17/209 [00:02<00:33,  5.66it/s]  9%|▊         | 18/209 [00:03<00:33,  5.68it/s]  9%|▉         | 19/209 [00:03<00:33,  5.69it/s] 10%|▉         | 20/209 [00:03<00:33,  5.70it/s] 10%|█         | 21/209 [00:03<00:33,  5.69it/s] 11%|█         | 22/209 [00:03<00:32,  5.70it/s] 11%|█         | 23/209 [00:04<00:32,  5.70it/s] 11%|█▏        | 24/209 [00:04<00:32,  5.70it/s] 12%|█▏        | 25/209 [00:04<00:32,  5.70it/s] 12%|█▏        | 26/209 [00:04<00:32,  5.71it/s] 13%|█▎        | 27/209 [00:04<00:31,  5.71it/s] 13%|█▎        | 28/209 [00:04<00:31,  5.72it/s] 14%|█▍        | 29/209 [00:05<00:31,  5.67it/s] 14%|█▍        | 30/209 [00:05<00:31,  5.66it/s] 15%|█▍        | 31/209 [00:05<00:31,  5.66it/s] 15%|█▌        | 32/209 [00:05<00:31,  5.66it/s] 16%|█▌        | 33/209 [00:05<00:31,  5.66it/s] 16%|█▋        | 34/209 [00:05<00:30,  5.68it/s] 17%|█▋        | 35/209 [00:06<00:30,  5.67it/s] 17%|█▋        | 36/209 [00:06<00:30,  5.67it/s] 18%|█▊        | 37/209 [00:06<00:30,  5.64it/s] 18%|█▊        | 38/209 [00:06<00:30,  5.63it/s] 19%|█▊        | 39/209 [00:06<00:30,  5.64it/s] 19%|█▉        | 40/209 [00:07<00:30,  5.63it/s] 20%|█▉        | 41/209 [00:07<00:29,  5.62it/s] 20%|██        | 42/209 [00:07<00:29,  5.64it/s] 21%|██        | 43/209 [00:07<00:29,  5.64it/s] 21%|██        | 44/209 [00:07<00:29,  5.67it/s] 22%|██▏       | 45/209 [00:07<00:28,  5.68it/s] 22%|██▏       | 46/209 [00:08<00:28,  5.63it/s] 22%|██▏       | 47/209 [00:08<00:28,  5.64it/s] 23%|██▎       | 48/209 [00:08<00:28,  5.64it/s] 23%|██▎       | 49/209 [00:08<00:28,  5.64it/s] 24%|██▍       | 50/209 [00:08<00:28,  5.65it/s] 24%|██▍       | 51/209 [00:08<00:27,  5.69it/s] 25%|██▍       | 52/209 [00:09<00:27,  5.71it/s] 25%|██▌       | 53/209 [00:09<00:27,  5.71it/s] 26%|██▌       | 54/209 [00:09<00:27,  5.69it/s] 26%|██▋       | 55/209 [00:09<00:26,  5.71it/s] 27%|██▋       | 56/209 [00:09<00:26,  5.71it/s] 27%|██▋       | 57/209 [00:10<00:26,  5.69it/s] 28%|██▊       | 58/209 [00:10<00:26,  5.70it/s] 28%|██▊       | 59/209 [00:10<00:26,  5.70it/s] 29%|██▊       | 60/209 [00:10<00:26,  5.68it/s] 29%|██▉       | 61/209 [00:10<00:26,  5.68it/s] 30%|██▉       | 62/209 [00:10<00:25,  5.69it/s] 30%|███       | 63/209 [00:11<00:25,  5.66it/s] 31%|███       | 64/209 [00:11<00:25,  5.66it/s] 31%|███       | 65/209 [00:11<00:25,  5.69it/s] 32%|███▏      | 66/209 [00:11<00:25,  5.70it/s] 32%|███▏      | 67/209 [00:11<00:25,  5.65it/s] 33%|███▎      | 68/209 [00:11<00:24,  5.68it/s] 33%|███▎      | 69/209 [00:12<00:24,  5.69it/s] 33%|███▎      | 70/209 [00:12<00:24,  5.71it/s] 34%|███▍      | 71/209 [00:12<00:24,  5.69it/s] 34%|███▍      | 72/209 [00:12<00:24,  5.71it/s] 35%|███▍      | 73/209 [00:12<00:23,  5.70it/s] 35%|███▌      | 74/209 [00:13<00:23,  5.71it/s] 36%|███▌      | 75/209 [00:13<00:23,  5.71it/s] 36%|███▋      | 76/209 [00:13<00:23,  5.70it/s] 37%|███▋      | 77/209 [00:13<00:23,  5.72it/s] 37%|███▋      | 78/209 [00:13<00:23,  5.63it/s] 38%|███▊      | 79/209 [00:13<00:23,  5.65it/s] 38%|███▊      | 80/209 [00:14<00:22,  5.62it/s] 39%|███▉      | 81/209 [00:14<00:22,  5.66it/s] 39%|███▉      | 82/209 [00:14<00:22,  5.69it/s] 40%|███▉      | 83/209 [00:14<00:22,  5.66it/s] 40%|████      | 84/209 [00:14<00:22,  5.68it/s] 41%|████      | 85/209 [00:14<00:21,  5.67it/s] 41%|████      | 86/209 [00:15<00:21,  5.67it/s] 42%|████▏     | 87/209 [00:15<00:21,  5.59it/s] 42%|████▏     | 88/209 [00:15<00:21,  5.63it/s] 43%|████▎     | 89/209 [00:15<00:21,  5.61it/s] 43%|████▎     | 90/209 [00:15<00:21,  5.65it/s] 44%|████▎     | 91/209 [00:16<00:20,  5.63it/s] 44%|████▍     | 92/209 [00:16<00:20,  5.63it/s] 44%|████▍     | 93/209 [00:16<00:20,  5.64it/s] 45%|████▍     | 94/209 [00:16<00:20,  5.66it/s] 45%|████▌     | 95/209 [00:16<00:20,  5.67it/s] 46%|████▌     | 96/209 [00:16<00:19,  5.68it/s] 46%|████▋     | 97/209 [00:17<00:19,  5.70it/s] 47%|████▋     | 98/209 [00:17<00:19,  5.72it/s] 47%|████▋     | 99/209 [00:17<00:19,  5.73it/s] 48%|████▊     | 100/209 [00:17<00:19,  5.71it/s] 48%|████▊     | 101/209 [00:17<00:18,  5.69it/s] 49%|████▉     | 102/209 [00:17<00:18,  5.70it/s] 49%|████▉     | 103/209 [00:18<00:18,  5.72it/s] 50%|████▉     | 104/209 [00:18<00:18,  5.70it/s] 50%|█████     | 105/209 [00:18<00:18,  5.70it/s] 51%|█████     | 106/209 [00:18<00:18,  5.63it/s] 51%|█████     | 107/209 [00:18<00:18,  5.66it/s] 52%|█████▏    | 108/209 [00:19<00:17,  5.69it/s] 52%|█████▏    | 109/209 [00:19<00:17,  5.70it/s] 53%|█████▎    | 110/209 [00:19<00:17,  5.60it/s] 53%|█████▎    | 111/209 [00:19<00:17,  5.61it/s] 54%|█████▎    | 112/209 [00:19<00:17,  5.64it/s] 54%|█████▍    | 113/209 [00:19<00:16,  5.68it/s] 55%|█████▍    | 114/209 [00:20<00:16,  5.67it/s] 55%|█████▌    | 115/209 [00:20<00:16,  5.69it/s] 56%|█████▌    | 116/209 [00:20<00:16,  5.69it/s] 56%|█████▌    | 117/209 [00:20<00:16,  5.68it/s] 56%|█████▋    | 118/209 [00:20<00:16,  5.63it/s] 57%|█████▋    | 119/209 [00:20<00:15,  5.63it/s] 57%|█████▋    | 120/209 [00:21<00:15,  5.64it/s] 58%|█████▊    | 121/209 [00:21<00:15,  5.66it/s] 58%|█████▊    | 122/209 [00:21<00:15,  5.65it/s] 59%|█████▉    | 123/209 [00:21<00:15,  5.67it/s] 59%|█████▉    | 124/209 [00:21<00:14,  5.68it/s] 60%|█████▉    | 125/209 [00:22<00:14,  5.65it/s] 60%|██████    | 126/209 [00:22<00:14,  5.67it/s] 61%|██████    | 127/209 [00:22<00:14,  5.68it/s] 61%|██████    | 128/209 [00:22<00:14,  5.65it/s] 62%|██████▏   | 129/209 [00:22<00:14,  5.67it/s] 62%|██████▏   | 130/209 [00:22<00:13,  5.69it/s] 63%|██████▎   | 131/209 [00:23<00:13,  5.70it/s] 63%|██████▎   | 132/209 [00:23<00:13,  5.69it/s] 64%|██████▎   | 133/209 [00:23<00:13,  5.70it/s] 64%|██████▍   | 134/209 [00:23<00:13,  5.66it/s] 65%|██████▍   | 135/209 [00:23<00:13,  5.69it/s] 65%|██████▌   | 136/209 [00:23<00:12,  5.70it/s] 66%|██████▌   | 137/209 [00:24<00:12,  5.71it/s] 66%|██████▌   | 138/209 [00:24<00:12,  5.72it/s] 67%|██████▋   | 139/209 [00:24<00:12,  5.68it/s] 67%|██████▋   | 140/209 [00:24<00:12,  5.67it/s] 67%|██████▋   | 141/209 [00:24<00:12,  5.65it/s] 68%|██████▊   | 142/209 [00:25<00:11,  5.64it/s] 68%|██████▊   | 143/209 [00:25<00:11,  5.63it/s] 69%|██████▉   | 144/209 [00:25<00:11,  5.65it/s] 69%|██████▉   | 145/209 [00:25<00:11,  5.66it/s] 70%|██████▉   | 146/209 [00:25<00:11,  5.66it/s] 70%|███████   | 147/209 [00:25<00:10,  5.67it/s] 71%|███████   | 148/209 [00:26<00:10,  5.68it/s] 71%|███████▏  | 149/209 [00:26<00:10,  5.67it/s] 72%|███████▏  | 150/209 [00:26<00:10,  5.64it/s] 72%|███████▏  | 151/209 [00:26<00:10,  5.66it/s] 73%|███████▎  | 152/209 [00:26<00:10,  5.69it/s] 73%|███████▎  | 153/209 [00:26<00:09,  5.67it/s] 74%|███████▎  | 154/209 [00:27<00:09,  5.67it/s] 74%|███████▍  | 155/209 [00:27<00:09,  5.68it/s] 75%|███████▍  | 156/209 [00:27<00:09,  5.69it/s] 75%|███████▌  | 157/209 [00:27<00:09,  5.69it/s] 76%|███████▌  | 158/209 [00:27<00:09,  5.66it/s] 76%|███████▌  | 159/209 [00:28<00:08,  5.62it/s] 77%|███████▋  | 160/209 [00:28<00:08,  5.66it/s] 77%|███████▋  | 161/209 [00:28<00:08,  5.66it/s] 78%|███████▊  | 162/209 [00:28<00:08,  5.67it/s] 78%|███████▊  | 163/209 [00:28<00:08,  5.69it/s] 78%|███████▊  | 164/209 [00:28<00:07,  5.68it/s] 79%|███████▉  | 165/209 [00:29<00:07,  5.69it/s] 79%|███████▉  | 166/209 [00:29<00:07,  5.71it/s] 80%|███████▉  | 167/209 [00:29<00:07,  5.70it/s] 80%|████████  | 168/209 [00:29<00:07,  5.72it/s] 81%|████████  | 169/209 [00:29<00:07,  5.69it/s] 81%|████████▏ | 170/209 [00:29<00:06,  5.72it/s] 82%|████████▏ | 171/209 [00:30<00:06,  5.70it/s] 82%|████████▏ | 172/209 [00:30<00:06,  5.70it/s] 83%|████████▎ | 173/209 [00:30<00:06,  5.64it/s] 83%|████████▎ | 174/209 [00:30<00:06,  5.67it/s] 84%|████████▎ | 175/209 [00:30<00:06,  5.66it/s] 84%|████████▍ | 176/209 [00:31<00:05,  5.67it/s] 85%|████████▍ | 177/209 [00:31<00:05,  5.68it/s] 85%|████████▌ | 178/209 [00:31<00:05,  5.69it/s] 86%|████████▌ | 179/209 [00:31<00:05,  5.68it/s] 86%|████████▌ | 180/209 [00:31<00:05,  5.69it/s] 87%|████████▋ | 181/209 [00:31<00:04,  5.65it/s] 87%|████████▋ | 182/209 [00:32<00:04,  5.68it/s] 88%|████████▊ | 183/209 [00:32<00:04,  5.67it/s] 88%|████████▊ | 184/209 [00:32<00:04,  5.69it/s] 89%|████████▊ | 185/209 [00:32<00:04,  5.69it/s] 89%|████████▉ | 186/209 [00:32<00:04,  5.69it/s] 89%|████████▉ | 187/209 [00:32<00:03,  5.68it/s] 90%|████████▉ | 188/209 [00:33<00:03,  5.68it/s] 90%|█████████ | 189/209 [00:33<00:03,  5.67it/s] 91%|█████████ | 190/209 [00:33<00:03,  5.67it/s] 91%|█████████▏| 191/209 [00:33<00:03,  5.70it/s] 92%|█████████▏| 192/209 [00:33<00:02,  5.69it/s] 92%|█████████▏| 193/209 [00:34<00:02,  5.70it/s] 93%|█████████▎| 194/209 [00:34<00:02,  5.71it/s] 93%|█████████▎| 195/209 [00:34<00:02,  5.68it/s] 94%|█████████▍| 196/209 [00:34<00:02,  5.70it/s] 94%|█████████▍| 197/209 [00:34<00:02,  5.72it/s] 95%|█████████▍| 198/209 [00:34<00:01,  5.71it/s] 95%|█████████▌| 199/209 [00:35<00:01,  5.72it/s] 96%|█████████▌| 200/209 [00:35<00:01,  5.70it/s] 96%|█████████▌| 201/209 [00:35<00:01,  5.70it/s] 97%|█████████▋| 202/209 [00:35<00:01,  5.71it/s] 97%|█████████▋| 203/209 [00:35<00:01,  5.69it/s] 98%|█████████▊| 204/209 [00:35<00:00,  5.70it/s] 98%|█████████▊| 205/209 [00:36<00:00,  5.72it/s] 99%|█████████▊| 206/209 [00:36<00:00,  5.71it/s] 99%|█████████▉| 207/209 [00:36<00:00,  5.70it/s]100%|█████████▉| 208/209 [00:36<00:00,  5.65it/s]100%|██████████| 209/209 [00:36<00:00,  5.83it/s]100%|██████████| 209/209 [00:36<00:00,  5.68it/s]
[32m2025-02-05 05:03:42.461[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    grad norm  info_loss  rec_loss
        33.38      .9071     6.735[0m
[32m2025-02-05 05:03:42.462[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_recommender[0m:[36m136[0m - [1m[Valid][0m
  0%|          | 0/10256 [00:00<?, ?it/s] 48%|████▊     | 4931/10256 [00:00<00:00, 49293.24it/s] 96%|█████████▌| 9861/10256 [00:00<00:00, 47307.13it/s]100%|██████████| 10256/10256 [00:00<00:00, 47332.04it/s]
[32m2025-02-05 05:03:42.679[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/24 [00:00<?, ?it/s] 12%|█▎        | 3/24 [00:00<00:00, 21.14it/s] 25%|██▌       | 6/24 [00:00<00:00, 21.42it/s] 38%|███▊      | 9/24 [00:00<00:00, 21.32it/s] 50%|█████     | 12/24 [00:00<00:00, 21.32it/s] 62%|██████▎   | 15/24 [00:00<00:00, 21.19it/s] 75%|███████▌  | 18/24 [00:00<00:00, 20.88it/s] 88%|████████▊ | 21/24 [00:01<00:00, 20.60it/s]100%|██████████| 24/24 [00:01<00:00, 21.48it/s]100%|██████████| 24/24 [00:01<00:00, 21.23it/s]
[32m2025-02-05 05:03:43.818[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    hit@1  hit@10  hit@50  info_loss  mrr@1  mrr@10  mrr@50  ndcg@1  ndcg@10  ndcg@50  \
   .03588   .1983   .3963      1.879 .03588  .07623   .0858  .03588    .1046    .1486   
    rec_loss  
       6.961[0m
[32m2025-02-05 05:03:43.819[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_recommender[0m:[36m130[0m - [1m[Recommendation epoch 2][0m
[32m2025-02-05 05:03:43.819[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_recommender[0m:[36m131[0m - [1m[Train][0m
  0%|          | 0/92414 [00:00<?, ?it/s]  5%|▌         | 4806/92414 [00:00<00:01, 48018.72it/s] 11%|█         | 9746/92414 [00:00<00:01, 48830.15it/s] 16%|█▌        | 14676/92414 [00:00<00:01, 49036.72it/s] 21%|██        | 19616/92414 [00:00<00:01, 49170.09it/s] 27%|██▋       | 24827/92414 [00:00<00:01, 50229.45it/s] 32%|███▏      | 29850/92414 [00:01<00:03, 19954.89it/s] 38%|███▊      | 35035/92414 [00:01<00:02, 25111.19it/s] 44%|████▎     | 40211/92414 [00:01<00:01, 30110.41it/s] 49%|████▉     | 45311/92414 [00:01<00:01, 34526.10it/s] 55%|█████▍    | 50516/92414 [00:01<00:01, 38586.79it/s] 60%|██████    | 55509/92414 [00:01<00:00, 41394.98it/s] 66%|██████▌   | 60637/92414 [00:01<00:00, 43984.11it/s] 71%|███████   | 65696/92414 [00:01<00:00, 45727.10it/s] 76%|███████▋  | 70675/92414 [00:01<00:00, 46392.13it/s] 82%|████████▏ | 75608/92414 [00:01<00:00, 47221.06it/s] 87%|████████▋ | 80637/92414 [00:02<00:00, 48104.92it/s] 93%|█████████▎| 85772/92414 [00:02<00:00, 49049.83it/s] 98%|█████████▊| 90843/92414 [00:02<00:00, 49531.72it/s]100%|██████████| 92414/92414 [00:02<00:00, 40491.68it/s]
[32m2025-02-05 05:03:46.101[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/209 [00:00<?, ?it/s]  0%|          | 1/209 [00:00<00:36,  5.69it/s]  1%|          | 2/209 [00:00<00:36,  5.68it/s]  1%|▏         | 3/209 [00:00<00:36,  5.70it/s]  2%|▏         | 4/209 [00:00<00:36,  5.69it/s]  2%|▏         | 5/209 [00:00<00:35,  5.67it/s]  3%|▎         | 6/209 [00:01<00:35,  5.67it/s]  3%|▎         | 7/209 [00:01<00:35,  5.68it/s]  4%|▍         | 8/209 [00:01<00:35,  5.69it/s]  4%|▍         | 9/209 [00:01<00:35,  5.66it/s]  5%|▍         | 10/209 [00:01<00:35,  5.68it/s]  5%|▌         | 11/209 [00:01<00:34,  5.69it/s]  6%|▌         | 12/209 [00:02<00:34,  5.67it/s]  6%|▌         | 13/209 [00:02<00:34,  5.67it/s]  7%|▋         | 14/209 [00:02<00:34,  5.61it/s]  7%|▋         | 15/209 [00:02<00:34,  5.60it/s]  8%|▊         | 16/209 [00:02<00:34,  5.64it/s]  8%|▊         | 17/209 [00:03<00:33,  5.65it/s]  9%|▊         | 18/209 [00:03<00:33,  5.68it/s]  9%|▉         | 19/209 [00:03<00:33,  5.69it/s] 10%|▉         | 20/209 [00:03<00:33,  5.70it/s] 10%|█         | 21/209 [00:03<00:33,  5.68it/s] 11%|█         | 22/209 [00:03<00:32,  5.70it/s] 11%|█         | 23/209 [00:04<00:32,  5.70it/s] 11%|█▏        | 24/209 [00:04<00:32,  5.70it/s] 12%|█▏        | 25/209 [00:04<00:32,  5.70it/s] 12%|█▏        | 26/209 [00:04<00:32,  5.71it/s] 13%|█▎        | 27/209 [00:04<00:31,  5.72it/s] 13%|█▎        | 28/209 [00:04<00:31,  5.72it/s] 14%|█▍        | 29/209 [00:05<00:31,  5.68it/s] 14%|█▍        | 30/209 [00:05<00:31,  5.67it/s] 15%|█▍        | 31/209 [00:05<00:31,  5.66it/s] 15%|█▌        | 32/209 [00:05<00:31,  5.66it/s] 16%|█▌        | 33/209 [00:05<00:31,  5.66it/s] 16%|█▋        | 34/209 [00:05<00:30,  5.68it/s] 17%|█▋        | 35/209 [00:06<00:30,  5.67it/s] 17%|█▋        | 36/209 [00:06<00:30,  5.67it/s] 18%|█▊        | 37/209 [00:06<00:30,  5.64it/s] 18%|█▊        | 38/209 [00:06<00:30,  5.63it/s] 19%|█▊        | 39/209 [00:06<00:30,  5.64it/s] 19%|█▉        | 40/209 [00:07<00:30,  5.63it/s] 20%|█▉        | 41/209 [00:07<00:29,  5.62it/s] 20%|██        | 42/209 [00:07<00:29,  5.64it/s] 21%|██        | 43/209 [00:07<00:29,  5.64it/s] 21%|██        | 44/209 [00:07<00:29,  5.67it/s] 22%|██▏       | 45/209 [00:07<00:28,  5.67it/s] 22%|██▏       | 46/209 [00:08<00:28,  5.63it/s] 22%|██▏       | 47/209 [00:08<00:28,  5.64it/s] 23%|██▎       | 48/209 [00:08<00:28,  5.65it/s] 23%|██▎       | 49/209 [00:08<00:28,  5.66it/s] 24%|██▍       | 50/209 [00:08<00:28,  5.67it/s] 24%|██▍       | 51/209 [00:08<00:27,  5.70it/s] 25%|██▍       | 52/209 [00:09<00:27,  5.72it/s] 25%|██▌       | 53/209 [00:09<00:27,  5.71it/s] 26%|██▌       | 54/209 [00:09<00:27,  5.69it/s] 26%|██▋       | 55/209 [00:09<00:26,  5.71it/s] 27%|██▋       | 56/209 [00:09<00:26,  5.71it/s] 27%|██▋       | 57/209 [00:10<00:26,  5.69it/s] 28%|██▊       | 58/209 [00:10<00:26,  5.70it/s] 28%|██▊       | 59/209 [00:10<00:26,  5.70it/s] 29%|██▊       | 60/209 [00:10<00:26,  5.67it/s] 29%|██▉       | 61/209 [00:10<00:26,  5.68it/s] 30%|██▉       | 62/209 [00:10<00:25,  5.69it/s] 30%|███       | 63/209 [00:11<00:25,  5.66it/s] 31%|███       | 64/209 [00:11<00:25,  5.61it/s] 31%|███       | 65/209 [00:11<00:25,  5.66it/s] 32%|███▏      | 66/209 [00:11<00:25,  5.67it/s] 32%|███▏      | 67/209 [00:11<00:25,  5.63it/s] 33%|███▎      | 68/209 [00:11<00:24,  5.66it/s] 33%|███▎      | 69/209 [00:12<00:24,  5.68it/s] 33%|███▎      | 70/209 [00:12<00:24,  5.70it/s] 34%|███▍      | 71/209 [00:12<00:24,  5.69it/s] 34%|███▍      | 72/209 [00:12<00:24,  5.70it/s] 35%|███▍      | 73/209 [00:12<00:23,  5.70it/s] 35%|███▌      | 74/209 [00:13<00:23,  5.71it/s] 36%|███▌      | 75/209 [00:13<00:23,  5.72it/s] 36%|███▋      | 76/209 [00:13<00:23,  5.71it/s] 37%|███▋      | 77/209 [00:13<00:23,  5.72it/s] 37%|███▋      | 78/209 [00:13<00:23,  5.63it/s] 38%|███▊      | 79/209 [00:13<00:23,  5.65it/s] 38%|███▊      | 80/209 [00:14<00:22,  5.62it/s] 39%|███▉      | 81/209 [00:14<00:22,  5.66it/s] 39%|███▉      | 82/209 [00:14<00:22,  5.69it/s] 40%|███▉      | 83/209 [00:14<00:22,  5.66it/s] 40%|████      | 84/209 [00:14<00:22,  5.68it/s] 41%|████      | 85/209 [00:14<00:21,  5.65it/s] 41%|████      | 86/209 [00:15<00:21,  5.66it/s] 42%|████▏     | 87/209 [00:15<00:21,  5.59it/s] 42%|████▏     | 88/209 [00:15<00:21,  5.63it/s] 43%|████▎     | 89/209 [00:15<00:21,  5.62it/s] 43%|████▎     | 90/209 [00:15<00:21,  5.65it/s] 44%|████▎     | 91/209 [00:16<00:20,  5.63it/s] 44%|████▍     | 92/209 [00:16<00:20,  5.63it/s] 44%|████▍     | 93/209 [00:16<00:20,  5.64it/s] 45%|████▍     | 94/209 [00:16<00:20,  5.66it/s] 45%|████▌     | 95/209 [00:16<00:20,  5.67it/s] 46%|████▌     | 96/209 [00:16<00:19,  5.68it/s] 46%|████▋     | 97/209 [00:17<00:19,  5.70it/s] 47%|████▋     | 98/209 [00:17<00:19,  5.71it/s] 47%|████▋     | 99/209 [00:17<00:19,  5.73it/s] 48%|████▊     | 100/209 [00:17<00:19,  5.71it/s] 48%|████▊     | 101/209 [00:17<00:18,  5.70it/s] 49%|████▉     | 102/209 [00:17<00:18,  5.70it/s] 49%|████▉     | 103/209 [00:18<00:18,  5.71it/s] 50%|████▉     | 104/209 [00:18<00:18,  5.70it/s] 50%|█████     | 105/209 [00:18<00:18,  5.69it/s] 51%|█████     | 106/209 [00:18<00:18,  5.60it/s] 51%|█████     | 107/209 [00:18<00:18,  5.64it/s] 52%|█████▏    | 108/209 [00:19<00:17,  5.67it/s] 52%|█████▏    | 109/209 [00:19<00:17,  5.68it/s] 53%|█████▎    | 110/209 [00:19<00:17,  5.61it/s] 53%|█████▎    | 111/209 [00:19<00:17,  5.61it/s] 54%|█████▎    | 112/209 [00:19<00:17,  5.64it/s] 54%|█████▍    | 113/209 [00:19<00:16,  5.68it/s] 55%|█████▍    | 114/209 [00:20<00:16,  5.67it/s] 55%|█████▌    | 115/209 [00:20<00:16,  5.69it/s] 56%|█████▌    | 116/209 [00:20<00:16,  5.69it/s] 56%|█████▌    | 117/209 [00:20<00:16,  5.68it/s] 56%|█████▋    | 118/209 [00:20<00:16,  5.63it/s] 57%|█████▋    | 119/209 [00:20<00:15,  5.63it/s] 57%|█████▋    | 120/209 [00:21<00:15,  5.65it/s] 58%|█████▊    | 121/209 [00:21<00:15,  5.66it/s] 58%|█████▊    | 122/209 [00:21<00:15,  5.66it/s] 59%|█████▉    | 123/209 [00:21<00:15,  5.68it/s] 59%|█████▉    | 124/209 [00:21<00:14,  5.68it/s] 60%|█████▉    | 125/209 [00:22<00:14,  5.65it/s] 60%|██████    | 126/209 [00:22<00:14,  5.67it/s] 61%|██████    | 127/209 [00:22<00:14,  5.68it/s] 61%|██████    | 128/209 [00:22<00:14,  5.65it/s] 62%|██████▏   | 129/209 [00:22<00:14,  5.67it/s] 62%|██████▏   | 130/209 [00:22<00:13,  5.69it/s] 63%|██████▎   | 131/209 [00:23<00:13,  5.71it/s] 63%|██████▎   | 132/209 [00:23<00:13,  5.70it/s] 64%|██████▎   | 133/209 [00:23<00:13,  5.70it/s] 64%|██████▍   | 134/209 [00:23<00:13,  5.67it/s] 65%|██████▍   | 135/209 [00:23<00:12,  5.69it/s] 65%|██████▌   | 136/209 [00:23<00:12,  5.70it/s] 66%|██████▌   | 137/209 [00:24<00:12,  5.71it/s] 66%|██████▌   | 138/209 [00:24<00:12,  5.72it/s] 67%|██████▋   | 139/209 [00:24<00:12,  5.68it/s] 67%|██████▋   | 140/209 [00:24<00:12,  5.68it/s] 67%|██████▋   | 141/209 [00:24<00:11,  5.68it/s] 68%|██████▊   | 142/209 [00:25<00:11,  5.66it/s] 68%|██████▊   | 143/209 [00:25<00:11,  5.64it/s] 69%|██████▉   | 144/209 [00:25<00:11,  5.66it/s] 69%|██████▉   | 145/209 [00:25<00:11,  5.66it/s] 70%|██████▉   | 146/209 [00:25<00:11,  5.67it/s] 70%|███████   | 147/209 [00:25<00:10,  5.67it/s] 71%|███████   | 148/209 [00:26<00:10,  5.68it/s] 71%|███████▏  | 149/209 [00:26<00:10,  5.67it/s] 72%|███████▏  | 150/209 [00:26<00:10,  5.63it/s] 72%|███████▏  | 151/209 [00:26<00:10,  5.66it/s] 73%|███████▎  | 152/209 [00:26<00:10,  5.69it/s] 73%|███████▎  | 153/209 [00:26<00:09,  5.67it/s] 74%|███████▎  | 154/209 [00:27<00:09,  5.67it/s] 74%|███████▍  | 155/209 [00:27<00:09,  5.69it/s] 75%|███████▍  | 156/209 [00:27<00:09,  5.70it/s] 75%|███████▌  | 157/209 [00:27<00:09,  5.70it/s] 76%|███████▌  | 158/209 [00:27<00:09,  5.66it/s] 76%|███████▌  | 159/209 [00:28<00:08,  5.59it/s] 77%|███████▋  | 160/209 [00:28<00:08,  5.63it/s] 77%|███████▋  | 161/209 [00:28<00:08,  5.64it/s] 78%|███████▊  | 162/209 [00:28<00:08,  5.66it/s] 78%|███████▊  | 163/209 [00:28<00:08,  5.68it/s] 78%|███████▊  | 164/209 [00:28<00:07,  5.65it/s] 79%|███████▉  | 165/209 [00:29<00:07,  5.67it/s] 79%|███████▉  | 166/209 [00:29<00:07,  5.68it/s] 80%|███████▉  | 167/209 [00:29<00:07,  5.68it/s] 80%|████████  | 168/209 [00:29<00:07,  5.71it/s] 81%|████████  | 169/209 [00:29<00:07,  5.68it/s] 81%|████████▏ | 170/209 [00:29<00:06,  5.71it/s] 82%|████████▏ | 171/209 [00:30<00:06,  5.70it/s] 82%|████████▏ | 172/209 [00:30<00:06,  5.70it/s] 83%|████████▎ | 173/209 [00:30<00:06,  5.64it/s] 83%|████████▎ | 174/209 [00:30<00:06,  5.67it/s] 84%|████████▎ | 175/209 [00:30<00:06,  5.66it/s] 84%|████████▍ | 176/209 [00:31<00:05,  5.66it/s] 85%|████████▍ | 177/209 [00:31<00:05,  5.67it/s] 85%|████████▌ | 178/209 [00:31<00:05,  5.69it/s] 86%|████████▌ | 179/209 [00:31<00:05,  5.68it/s] 86%|████████▌ | 180/209 [00:31<00:05,  5.69it/s] 87%|████████▋ | 181/209 [00:31<00:04,  5.65it/s] 87%|████████▋ | 182/209 [00:32<00:04,  5.68it/s] 88%|████████▊ | 183/209 [00:32<00:04,  5.67it/s] 88%|████████▊ | 184/209 [00:32<00:04,  5.69it/s] 89%|████████▊ | 185/209 [00:32<00:04,  5.69it/s] 89%|████████▉ | 186/209 [00:32<00:04,  5.69it/s] 89%|████████▉ | 187/209 [00:32<00:03,  5.68it/s] 90%|████████▉ | 188/209 [00:33<00:03,  5.67it/s] 90%|█████████ | 189/209 [00:33<00:03,  5.67it/s] 91%|█████████ | 190/209 [00:33<00:03,  5.67it/s] 91%|█████████▏| 191/209 [00:33<00:03,  5.70it/s] 92%|█████████▏| 192/209 [00:33<00:02,  5.69it/s] 92%|█████████▏| 193/209 [00:34<00:02,  5.70it/s] 93%|█████████▎| 194/209 [00:34<00:02,  5.71it/s] 93%|█████████▎| 195/209 [00:34<00:02,  5.68it/s] 94%|█████████▍| 196/209 [00:34<00:02,  5.70it/s] 94%|█████████▍| 197/209 [00:34<00:02,  5.72it/s] 95%|█████████▍| 198/209 [00:34<00:01,  5.69it/s] 95%|█████████▌| 199/209 [00:35<00:01,  5.70it/s] 96%|█████████▌| 200/209 [00:35<00:01,  5.69it/s] 96%|█████████▌| 201/209 [00:35<00:01,  5.70it/s] 97%|█████████▋| 202/209 [00:35<00:01,  5.71it/s] 97%|█████████▋| 203/209 [00:35<00:01,  5.69it/s] 98%|█████████▊| 204/209 [00:35<00:00,  5.70it/s] 98%|█████████▊| 205/209 [00:36<00:00,  5.72it/s] 99%|█████████▊| 206/209 [00:36<00:00,  5.71it/s] 99%|█████████▉| 207/209 [00:36<00:00,  5.71it/s]100%|█████████▉| 208/209 [00:36<00:00,  5.65it/s]100%|██████████| 209/209 [00:36<00:00,  5.83it/s]100%|██████████| 209/209 [00:36<00:00,  5.68it/s]
[32m2025-02-05 05:04:22.981[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    grad norm  info_loss  rec_loss
        33.98      .8063     6.236[0m
[32m2025-02-05 05:04:22.981[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_recommender[0m:[36m136[0m - [1m[Valid][0m
  0%|          | 0/10256 [00:00<?, ?it/s] 49%|████▊     | 4982/10256 [00:00<00:00, 49818.62it/s] 97%|█████████▋| 9964/10256 [00:00<00:00, 47330.34it/s]100%|██████████| 10256/10256 [00:00<00:00, 47382.88it/s]
[32m2025-02-05 05:04:23.198[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/24 [00:00<?, ?it/s] 12%|█▎        | 3/24 [00:00<00:00, 21.21it/s] 25%|██▌       | 6/24 [00:00<00:00, 21.13it/s] 38%|███▊      | 9/24 [00:00<00:00, 21.12it/s] 50%|█████     | 12/24 [00:00<00:00, 20.66it/s] 62%|██████▎   | 15/24 [00:00<00:00, 20.26it/s] 75%|███████▌  | 18/24 [00:00<00:00, 20.50it/s] 88%|████████▊ | 21/24 [00:01<00:00, 20.58it/s]100%|██████████| 24/24 [00:01<00:00, 21.10it/s]100%|██████████| 24/24 [00:01<00:00, 20.84it/s]
[32m2025-02-05 05:04:24.359[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    hit@1  hit@10  hit@50  info_loss  mrr@1  mrr@10  mrr@50  ndcg@1  ndcg@10  ndcg@50  \
   .03953   .2086   .4206      1.039 .03953  .08082  .09119  .03953    .1105    .1578   
    rec_loss  
       6.935[0m
[32m2025-02-05 05:04:24.359[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_recommender[0m:[36m130[0m - [1m[Recommendation epoch 3][0m
[32m2025-02-05 05:04:24.359[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_recommender[0m:[36m131[0m - [1m[Train][0m
  0%|          | 0/92414 [00:00<?, ?it/s]  5%|▌         | 4831/92414 [00:00<00:01, 48271.26it/s] 11%|█         | 9784/92414 [00:00<00:01, 49001.38it/s] 16%|█▌        | 14780/92414 [00:00<00:01, 49432.60it/s] 21%|██▏       | 19801/92414 [00:00<00:01, 49733.55it/s] 27%|██▋       | 24993/92414 [00:00<00:01, 50517.62it/s] 33%|███▎      | 30045/92414 [00:01<00:03, 19958.41it/s] 38%|███▊      | 35264/92414 [00:01<00:02, 25144.42it/s] 44%|████▍     | 40488/92414 [00:01<00:01, 30203.09it/s] 49%|████▉     | 45672/92414 [00:01<00:01, 34752.51it/s] 55%|█████▌    | 50875/92414 [00:01<00:01, 38745.84it/s] 60%|██████    | 55897/92414 [00:01<00:00, 41581.92it/s] 66%|██████▌   | 61039/92414 [00:01<00:00, 44154.23it/s] 72%|███████▏  | 66144/92414 [00:01<00:00, 46022.06it/s] 77%|███████▋  | 71160/92414 [00:01<00:00, 46808.14it/s] 82%|████████▏ | 76148/92414 [00:01<00:00, 47677.91it/s] 88%|████████▊ | 81208/92414 [00:02<00:00, 48519.69it/s] 93%|█████████▎| 86321/92414 [00:02<00:00, 49278.92it/s] 99%|█████████▉| 91524/92414 [00:02<00:00, 50075.96it/s]100%|██████████| 92414/92414 [00:02<00:00, 40656.92it/s]
[32m2025-02-05 05:04:26.633[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/209 [00:00<?, ?it/s]  0%|          | 1/209 [00:00<00:36,  5.62it/s]  1%|          | 2/209 [00:00<00:36,  5.69it/s]  1%|▏         | 3/209 [00:00<00:36,  5.72it/s]  2%|▏         | 4/209 [00:00<00:36,  5.66it/s]  2%|▏         | 5/209 [00:00<00:36,  5.65it/s]  3%|▎         | 6/209 [00:01<00:35,  5.65it/s]  3%|▎         | 7/209 [00:01<00:35,  5.64it/s]  4%|▍         | 8/209 [00:01<00:35,  5.66it/s]  4%|▍         | 9/209 [00:01<00:35,  5.64it/s]  5%|▍         | 10/209 [00:01<00:35,  5.67it/s]  5%|▌         | 11/209 [00:01<00:34,  5.68it/s]  6%|▌         | 12/209 [00:02<00:34,  5.66it/s]  6%|▌         | 13/209 [00:02<00:34,  5.68it/s]  7%|▋         | 14/209 [00:02<00:34,  5.61it/s]  7%|▋         | 15/209 [00:02<00:34,  5.61it/s]  8%|▊         | 16/209 [00:02<00:34,  5.64it/s]  8%|▊         | 17/209 [00:03<00:33,  5.66it/s]  9%|▊         | 18/209 [00:03<00:33,  5.65it/s]  9%|▉         | 19/209 [00:03<00:33,  5.67it/s] 10%|▉         | 20/209 [00:03<00:33,  5.68it/s] 10%|█         | 21/209 [00:03<00:33,  5.67it/s] 11%|█         | 22/209 [00:03<00:32,  5.69it/s] 11%|█         | 23/209 [00:04<00:32,  5.70it/s] 11%|█▏        | 24/209 [00:04<00:32,  5.70it/s] 12%|█▏        | 25/209 [00:04<00:32,  5.70it/s] 12%|█▏        | 26/209 [00:04<00:32,  5.71it/s] 13%|█▎        | 27/209 [00:04<00:31,  5.71it/s] 13%|█▎        | 28/209 [00:04<00:31,  5.72it/s] 14%|█▍        | 29/209 [00:05<00:31,  5.67it/s] 14%|█▍        | 30/209 [00:05<00:31,  5.66it/s] 15%|█▍        | 31/209 [00:05<00:31,  5.66it/s] 15%|█▌        | 32/209 [00:05<00:31,  5.65it/s] 16%|█▌        | 33/209 [00:05<00:31,  5.66it/s] 16%|█▋        | 34/209 [00:05<00:30,  5.68it/s] 17%|█▋        | 35/209 [00:06<00:30,  5.67it/s] 17%|█▋        | 36/209 [00:06<00:30,  5.67it/s] 18%|█▊        | 37/209 [00:06<00:30,  5.64it/s] 18%|█▊        | 38/209 [00:06<00:30,  5.63it/s] 19%|█▊        | 39/209 [00:06<00:30,  5.64it/s] 19%|█▉        | 40/209 [00:07<00:30,  5.63it/s] 20%|█▉        | 41/209 [00:07<00:29,  5.62it/s] 20%|██        | 42/209 [00:07<00:29,  5.64it/s] 21%|██        | 43/209 [00:07<00:29,  5.64it/s] 21%|██        | 44/209 [00:07<00:29,  5.67it/s] 22%|██▏       | 45/209 [00:07<00:28,  5.68it/s] 22%|██▏       | 46/209 [00:08<00:28,  5.63it/s] 22%|██▏       | 47/209 [00:08<00:28,  5.64it/s] 23%|██▎       | 48/209 [00:08<00:28,  5.65it/s] 23%|██▎       | 49/209 [00:08<00:28,  5.66it/s] 24%|██▍       | 50/209 [00:08<00:28,  5.67it/s] 24%|██▍       | 51/209 [00:09<00:27,  5.70it/s] 25%|██▍       | 52/209 [00:09<00:27,  5.71it/s] 25%|██▌       | 53/209 [00:09<00:27,  5.71it/s] 26%|██▌       | 54/209 [00:09<00:27,  5.69it/s] 26%|██▋       | 55/209 [00:09<00:26,  5.71it/s] 27%|██▋       | 56/209 [00:09<00:26,  5.72it/s] 27%|██▋       | 57/209 [00:10<00:26,  5.69it/s] 28%|██▊       | 58/209 [00:10<00:26,  5.71it/s] 28%|██▊       | 59/209 [00:10<00:26,  5.70it/s] 29%|██▊       | 60/209 [00:10<00:26,  5.67it/s] 29%|██▉       | 61/209 [00:10<00:26,  5.68it/s] 30%|██▉       | 62/209 [00:10<00:25,  5.69it/s] 30%|███       | 63/209 [00:11<00:25,  5.66it/s] 31%|███       | 64/209 [00:11<00:25,  5.65it/s] 31%|███       | 65/209 [00:11<00:25,  5.69it/s] 32%|███▏      | 66/209 [00:11<00:25,  5.69it/s] 32%|███▏      | 67/209 [00:11<00:25,  5.64it/s] 33%|███▎      | 68/209 [00:11<00:24,  5.67it/s] 33%|███▎      | 69/209 [00:12<00:24,  5.69it/s] 33%|███▎      | 70/209 [00:12<00:24,  5.70it/s] 34%|███▍      | 71/209 [00:12<00:24,  5.67it/s] 34%|███▍      | 72/209 [00:12<00:24,  5.68it/s] 35%|███▍      | 73/209 [00:12<00:23,  5.69it/s] 35%|███▌      | 74/209 [00:13<00:23,  5.70it/s] 36%|███▌      | 75/209 [00:13<00:23,  5.71it/s] 36%|███▋      | 76/209 [00:13<00:23,  5.70it/s] 37%|███▋      | 77/209 [00:13<00:23,  5.71it/s] 37%|███▋      | 78/209 [00:13<00:23,  5.63it/s] 38%|███▊      | 79/209 [00:13<00:23,  5.65it/s] 38%|███▊      | 80/209 [00:14<00:22,  5.62it/s] 39%|███▉      | 81/209 [00:14<00:22,  5.66it/s] 39%|███▉      | 82/209 [00:14<00:22,  5.68it/s] 40%|███▉      | 83/209 [00:14<00:22,  5.66it/s] 40%|████      | 84/209 [00:14<00:22,  5.67it/s] 41%|████      | 85/209 [00:14<00:21,  5.66it/s] 41%|████      | 86/209 [00:15<00:21,  5.66it/s] 42%|████▏     | 87/209 [00:15<00:21,  5.59it/s] 42%|████▏     | 88/209 [00:15<00:21,  5.62it/s] 43%|████▎     | 89/209 [00:15<00:21,  5.61it/s] 43%|████▎     | 90/209 [00:15<00:21,  5.64it/s] 44%|████▎     | 91/209 [00:16<00:20,  5.62it/s] 44%|████▍     | 92/209 [00:16<00:20,  5.62it/s] 44%|████▍     | 93/209 [00:16<00:20,  5.63it/s] 45%|████▍     | 94/209 [00:16<00:20,  5.65it/s] 45%|████▌     | 95/209 [00:16<00:20,  5.67it/s] 46%|████▌     | 96/209 [00:16<00:19,  5.68it/s] 46%|████▋     | 97/209 [00:17<00:19,  5.70it/s] 47%|████▋     | 98/209 [00:17<00:19,  5.72it/s] 47%|████▋     | 99/209 [00:17<00:19,  5.73it/s] 48%|████▊     | 100/209 [00:17<00:19,  5.71it/s] 48%|████▊     | 101/209 [00:17<00:18,  5.69it/s] 49%|████▉     | 102/209 [00:17<00:18,  5.70it/s] 49%|████▉     | 103/209 [00:18<00:18,  5.72it/s] 50%|████▉     | 104/209 [00:18<00:18,  5.71it/s] 50%|█████     | 105/209 [00:18<00:18,  5.70it/s] 51%|█████     | 106/209 [00:18<00:18,  5.63it/s] 51%|█████     | 107/209 [00:18<00:18,  5.66it/s] 52%|█████▏    | 108/209 [00:19<00:17,  5.69it/s] 52%|█████▏    | 109/209 [00:19<00:17,  5.70it/s] 53%|█████▎    | 110/209 [00:19<00:17,  5.61it/s] 53%|█████▎    | 111/209 [00:19<00:17,  5.61it/s] 54%|█████▎    | 112/209 [00:19<00:17,  5.63it/s] 54%|█████▍    | 113/209 [00:19<00:16,  5.68it/s] 55%|█████▍    | 114/209 [00:20<00:16,  5.67it/s] 55%|█████▌    | 115/209 [00:20<00:16,  5.69it/s] 56%|█████▌    | 116/209 [00:20<00:16,  5.69it/s] 56%|█████▌    | 117/209 [00:20<00:16,  5.68it/s] 56%|█████▋    | 118/209 [00:20<00:16,  5.63it/s] 57%|█████▋    | 119/209 [00:20<00:15,  5.63it/s] 57%|█████▋    | 120/209 [00:21<00:15,  5.65it/s] 58%|█████▊    | 121/209 [00:21<00:15,  5.66it/s] 58%|█████▊    | 122/209 [00:21<00:15,  5.66it/s] 59%|█████▉    | 123/209 [00:21<00:15,  5.68it/s] 59%|█████▉    | 124/209 [00:21<00:14,  5.68it/s] 60%|█████▉    | 125/209 [00:22<00:14,  5.65it/s] 60%|██████    | 126/209 [00:22<00:14,  5.68it/s] 61%|██████    | 127/209 [00:22<00:14,  5.68it/s] 61%|██████    | 128/209 [00:22<00:14,  5.65it/s] 62%|██████▏   | 129/209 [00:22<00:14,  5.67it/s] 62%|██████▏   | 130/209 [00:22<00:13,  5.69it/s] 63%|██████▎   | 131/209 [00:23<00:13,  5.70it/s] 63%|██████▎   | 132/209 [00:23<00:13,  5.69it/s] 64%|██████▎   | 133/209 [00:23<00:13,  5.69it/s] 64%|██████▍   | 134/209 [00:23<00:13,  5.66it/s] 65%|██████▍   | 135/209 [00:23<00:13,  5.69it/s] 65%|██████▌   | 136/209 [00:23<00:12,  5.70it/s] 66%|██████▌   | 137/209 [00:24<00:12,  5.71it/s] 66%|██████▌   | 138/209 [00:24<00:12,  5.72it/s] 67%|██████▋   | 139/209 [00:24<00:12,  5.68it/s] 67%|██████▋   | 140/209 [00:24<00:12,  5.68it/s] 67%|██████▋   | 141/209 [00:24<00:11,  5.68it/s] 68%|██████▊   | 142/209 [00:25<00:11,  5.66it/s] 68%|██████▊   | 143/209 [00:25<00:11,  5.64it/s] 69%|██████▉   | 144/209 [00:25<00:11,  5.66it/s] 69%|██████▉   | 145/209 [00:25<00:11,  5.66it/s] 70%|██████▉   | 146/209 [00:25<00:11,  5.66it/s] 70%|███████   | 147/209 [00:25<00:10,  5.67it/s] 71%|███████   | 148/209 [00:26<00:10,  5.68it/s] 71%|███████▏  | 149/209 [00:26<00:10,  5.67it/s] 72%|███████▏  | 150/209 [00:26<00:10,  5.64it/s] 72%|███████▏  | 151/209 [00:26<00:10,  5.66it/s] 73%|███████▎  | 152/209 [00:26<00:10,  5.68it/s] 73%|███████▎  | 153/209 [00:26<00:09,  5.67it/s] 74%|███████▎  | 154/209 [00:27<00:09,  5.67it/s] 74%|███████▍  | 155/209 [00:27<00:09,  5.68it/s] 75%|███████▍  | 156/209 [00:27<00:09,  5.70it/s] 75%|███████▌  | 157/209 [00:27<00:09,  5.70it/s] 76%|███████▌  | 158/209 [00:27<00:08,  5.67it/s] 76%|███████▌  | 159/209 [00:28<00:08,  5.62it/s] 77%|███████▋  | 160/209 [00:28<00:08,  5.66it/s] 77%|███████▋  | 161/209 [00:28<00:08,  5.67it/s] 78%|███████▊  | 162/209 [00:28<00:08,  5.67it/s] 78%|███████▊  | 163/209 [00:28<00:08,  5.67it/s] 78%|███████▊  | 164/209 [00:28<00:07,  5.66it/s] 79%|███████▉  | 165/209 [00:29<00:07,  5.68it/s] 79%|███████▉  | 166/209 [00:29<00:07,  5.70it/s] 80%|███████▉  | 167/209 [00:29<00:07,  5.70it/s] 80%|████████  | 168/209 [00:29<00:07,  5.72it/s] 81%|████████  | 169/209 [00:29<00:07,  5.69it/s] 81%|████████▏ | 170/209 [00:29<00:06,  5.71it/s] 82%|████████▏ | 171/209 [00:30<00:06,  5.70it/s] 82%|████████▏ | 172/209 [00:30<00:06,  5.70it/s] 83%|████████▎ | 173/209 [00:30<00:06,  5.64it/s] 83%|████████▎ | 174/209 [00:30<00:06,  5.67it/s] 84%|████████▎ | 175/209 [00:30<00:06,  5.66it/s] 84%|████████▍ | 176/209 [00:31<00:05,  5.66it/s] 85%|████████▍ | 177/209 [00:31<00:05,  5.67it/s] 85%|████████▌ | 178/209 [00:31<00:05,  5.69it/s] 86%|████████▌ | 179/209 [00:31<00:05,  5.68it/s] 86%|████████▌ | 180/209 [00:31<00:05,  5.69it/s] 87%|████████▋ | 181/209 [00:31<00:04,  5.65it/s] 87%|████████▋ | 182/209 [00:32<00:04,  5.68it/s] 88%|████████▊ | 183/209 [00:32<00:04,  5.67it/s] 88%|████████▊ | 184/209 [00:32<00:04,  5.70it/s] 89%|████████▊ | 185/209 [00:32<00:04,  5.70it/s] 89%|████████▉ | 186/209 [00:32<00:04,  5.69it/s] 89%|████████▉ | 187/209 [00:32<00:03,  5.69it/s] 90%|████████▉ | 188/209 [00:33<00:03,  5.68it/s] 90%|█████████ | 189/209 [00:33<00:03,  5.68it/s] 91%|█████████ | 190/209 [00:33<00:03,  5.68it/s] 91%|█████████▏| 191/209 [00:33<00:03,  5.70it/s] 92%|█████████▏| 192/209 [00:33<00:02,  5.70it/s] 92%|█████████▏| 193/209 [00:34<00:02,  5.70it/s] 93%|█████████▎| 194/209 [00:34<00:02,  5.66it/s] 93%|█████████▎| 195/209 [00:34<00:02,  5.65it/s] 94%|█████████▍| 196/209 [00:34<00:02,  5.67it/s] 94%|█████████▍| 197/209 [00:34<00:02,  5.71it/s] 95%|█████████▍| 198/209 [00:34<00:01,  5.70it/s] 95%|█████████▌| 199/209 [00:35<00:01,  5.71it/s] 96%|█████████▌| 200/209 [00:35<00:01,  5.70it/s] 96%|█████████▌| 201/209 [00:35<00:01,  5.71it/s] 97%|█████████▋| 202/209 [00:35<00:01,  5.72it/s] 97%|█████████▋| 203/209 [00:35<00:01,  5.69it/s] 98%|█████████▊| 204/209 [00:35<00:00,  5.69it/s] 98%|█████████▊| 205/209 [00:36<00:00,  5.72it/s] 99%|█████████▊| 206/209 [00:36<00:00,  5.71it/s] 99%|█████████▉| 207/209 [00:36<00:00,  5.70it/s]100%|█████████▉| 208/209 [00:36<00:00,  5.65it/s]100%|██████████| 209/209 [00:36<00:00,  5.83it/s]100%|██████████| 209/209 [00:36<00:00,  5.68it/s]
[32m2025-02-05 05:05:03.518[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    grad norm  info_loss  rec_loss
        46.66       1.43     5.862[0m
[32m2025-02-05 05:05:03.518[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_recommender[0m:[36m136[0m - [1m[Valid][0m
  0%|          | 0/10256 [00:00<?, ?it/s] 49%|████▊     | 4980/10256 [00:00<00:00, 49760.78it/s] 97%|█████████▋| 9957/10256 [00:00<00:00, 47646.83it/s]100%|██████████| 10256/10256 [00:00<00:00, 47445.12it/s]
[32m2025-02-05 05:05:03.735[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/24 [00:00<?, ?it/s] 12%|█▎        | 3/24 [00:00<00:00, 21.19it/s] 25%|██▌       | 6/24 [00:00<00:00, 21.49it/s] 38%|███▊      | 9/24 [00:00<00:00, 21.19it/s] 50%|█████     | 12/24 [00:00<00:00, 21.22it/s] 62%|██████▎   | 15/24 [00:00<00:00, 21.24it/s] 75%|███████▌  | 18/24 [00:00<00:00, 21.30it/s] 88%|████████▊ | 21/24 [00:00<00:00, 21.14it/s]100%|██████████| 24/24 [00:01<00:00, 21.51it/s]100%|██████████| 24/24 [00:01<00:00, 21.35it/s]
[32m2025-02-05 05:05:04.871[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    hit@1  hit@10  hit@50  info_loss  mrr@1  mrr@10  mrr@50  ndcg@1  ndcg@10  ndcg@50  \
    .0392   .2073   .4349      .6889  .0392  .07997  .09098   .0392    .1095    .1601   
    rec_loss  
       6.997[0m
[32m2025-02-05 05:05:04.872[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_recommender[0m:[36m130[0m - [1m[Recommendation epoch 4][0m
[32m2025-02-05 05:05:04.872[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_recommender[0m:[36m131[0m - [1m[Train][0m
  0%|          | 0/92414 [00:00<?, ?it/s]  5%|▌         | 4806/92414 [00:00<00:01, 48035.19it/s] 11%|█         | 9778/92414 [00:00<00:01, 49007.04it/s] 16%|█▌        | 14704/92414 [00:00<00:01, 49082.47it/s] 21%|██        | 19613/92414 [00:00<00:01, 48996.93it/s] 27%|██▋       | 24763/92414 [00:00<00:01, 49884.43it/s] 32%|███▏      | 29752/92414 [00:00<00:01, 49179.66it/s] 38%|███▊      | 34672/92414 [00:01<00:03, 19082.11it/s] 43%|████▎     | 39759/92414 [00:01<00:02, 23912.37it/s] 49%|████▊     | 44960/92414 [00:01<00:01, 28917.78it/s] 54%|█████▍    | 50266/92414 [00:01<00:01, 33810.81it/s] 60%|█████▉    | 55285/92414 [00:01<00:00, 37487.42it/s] 65%|██████▌   | 60335/92414 [00:01<00:00, 40643.06it/s] 71%|███████   | 65454/92414 [00:01<00:00, 43358.73it/s] 76%|███████▌  | 70397/92414 [00:01<00:00, 44735.90it/s] 82%|████████▏ | 75388/92414 [00:01<00:00, 46161.56it/s] 87%|████████▋ | 80392/92414 [00:02<00:00, 47255.81it/s] 93%|█████████▎| 85546/92414 [00:02<00:00, 48474.85it/s] 98%|█████████▊| 90658/92414 [00:02<00:00, 49241.24it/s]100%|██████████| 92414/92414 [00:02<00:00, 39633.54it/s]
[32m2025-02-05 05:05:07.204[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/209 [00:00<?, ?it/s]  0%|          | 1/209 [00:00<00:36,  5.71it/s]  1%|          | 2/209 [00:00<00:36,  5.67it/s]  1%|▏         | 3/209 [00:00<00:36,  5.70it/s]  2%|▏         | 4/209 [00:00<00:36,  5.68it/s]  2%|▏         | 5/209 [00:00<00:36,  5.66it/s]  3%|▎         | 6/209 [00:01<00:35,  5.66it/s]  3%|▎         | 7/209 [00:01<00:35,  5.68it/s]  4%|▍         | 8/209 [00:01<00:35,  5.69it/s]  4%|▍         | 9/209 [00:01<00:35,  5.67it/s]  5%|▍         | 10/209 [00:01<00:35,  5.68it/s]  5%|▌         | 11/209 [00:01<00:34,  5.69it/s]  6%|▌         | 12/209 [00:02<00:34,  5.67it/s]  6%|▌         | 13/209 [00:02<00:34,  5.68it/s]  7%|▋         | 14/209 [00:02<00:34,  5.61it/s]  7%|▋         | 15/209 [00:02<00:34,  5.60it/s]  8%|▊         | 16/209 [00:02<00:34,  5.64it/s]  8%|▊         | 17/209 [00:03<00:33,  5.65it/s]  9%|▊         | 18/209 [00:03<00:33,  5.68it/s]  9%|▉         | 19/209 [00:03<00:33,  5.69it/s] 10%|▉         | 20/209 [00:03<00:33,  5.70it/s] 10%|█         | 21/209 [00:03<00:33,  5.68it/s] 11%|█         | 22/209 [00:03<00:32,  5.70it/s] 11%|█         | 23/209 [00:04<00:32,  5.70it/s] 11%|█▏        | 24/209 [00:04<00:32,  5.67it/s] 12%|█▏        | 25/209 [00:04<00:32,  5.68it/s] 12%|█▏        | 26/209 [00:04<00:32,  5.69it/s] 13%|█▎        | 27/209 [00:04<00:31,  5.70it/s] 13%|█▎        | 28/209 [00:04<00:31,  5.71it/s] 14%|█▍        | 29/209 [00:05<00:31,  5.67it/s] 14%|█▍        | 30/209 [00:05<00:31,  5.66it/s] 15%|█▍        | 31/209 [00:05<00:31,  5.66it/s] 15%|█▌        | 32/209 [00:05<00:31,  5.65it/s] 16%|█▌        | 33/209 [00:05<00:31,  5.66it/s] 16%|█▋        | 34/209 [00:05<00:30,  5.68it/s] 17%|█▋        | 35/209 [00:06<00:30,  5.67it/s] 17%|█▋        | 36/209 [00:06<00:30,  5.67it/s] 18%|█▊        | 37/209 [00:06<00:30,  5.64it/s] 18%|█▊        | 38/209 [00:06<00:30,  5.63it/s] 19%|█▊        | 39/209 [00:06<00:30,  5.64it/s] 19%|█▉        | 40/209 [00:07<00:30,  5.63it/s] 20%|█▉        | 41/209 [00:07<00:29,  5.62it/s] 20%|██        | 42/209 [00:07<00:29,  5.64it/s] 21%|██        | 43/209 [00:07<00:29,  5.64it/s] 21%|██        | 44/209 [00:07<00:29,  5.67it/s] 22%|██▏       | 45/209 [00:07<00:28,  5.68it/s] 22%|██▏       | 46/209 [00:08<00:28,  5.63it/s] 22%|██▏       | 47/209 [00:08<00:28,  5.64it/s] 23%|██▎       | 48/209 [00:08<00:28,  5.65it/s] 23%|██▎       | 49/209 [00:08<00:28,  5.66it/s] 24%|██▍       | 50/209 [00:08<00:28,  5.67it/s] 24%|██▍       | 51/209 [00:08<00:27,  5.70it/s] 25%|██▍       | 52/209 [00:09<00:27,  5.71it/s] 25%|██▌       | 53/209 [00:09<00:27,  5.71it/s] 26%|██▌       | 54/209 [00:09<00:27,  5.70it/s] 26%|██▋       | 55/209 [00:09<00:26,  5.71it/s] 27%|██▋       | 56/209 [00:09<00:26,  5.72it/s] 27%|██▋       | 57/209 [00:10<00:26,  5.69it/s] 28%|██▊       | 58/209 [00:10<00:26,  5.71it/s] 28%|██▊       | 59/209 [00:10<00:26,  5.70it/s] 29%|██▊       | 60/209 [00:10<00:26,  5.68it/s] 29%|██▉       | 61/209 [00:10<00:26,  5.68it/s] 30%|██▉       | 62/209 [00:10<00:25,  5.70it/s] 30%|███       | 63/209 [00:11<00:25,  5.66it/s] 31%|███       | 64/209 [00:11<00:25,  5.66it/s] 31%|███       | 65/209 [00:11<00:25,  5.69it/s] 32%|███▏      | 66/209 [00:11<00:25,  5.70it/s] 32%|███▏      | 67/209 [00:11<00:25,  5.65it/s] 33%|███▎      | 68/209 [00:11<00:24,  5.67it/s] 33%|███▎      | 69/209 [00:12<00:24,  5.69it/s] 33%|███▎      | 70/209 [00:12<00:24,  5.71it/s] 34%|███▍      | 71/209 [00:12<00:24,  5.69it/s] 34%|███▍      | 72/209 [00:12<00:24,  5.70it/s] 35%|███▍      | 73/209 [00:12<00:23,  5.71it/s] 35%|███▌      | 74/209 [00:13<00:23,  5.71it/s] 36%|███▌      | 75/209 [00:13<00:23,  5.71it/s] 36%|███▋      | 76/209 [00:13<00:23,  5.70it/s] 37%|███▋      | 77/209 [00:13<00:23,  5.71it/s] 37%|███▋      | 78/209 [00:13<00:23,  5.63it/s] 38%|███▊      | 79/209 [00:13<00:23,  5.65it/s] 38%|███▊      | 80/209 [00:14<00:22,  5.62it/s] 39%|███▉      | 81/209 [00:14<00:22,  5.66it/s] 39%|███▉      | 82/209 [00:14<00:22,  5.69it/s] 40%|███▉      | 83/209 [00:14<00:22,  5.66it/s] 40%|████      | 84/209 [00:14<00:22,  5.68it/s] 41%|████      | 85/209 [00:14<00:21,  5.66it/s] 41%|████      | 86/209 [00:15<00:21,  5.66it/s] 42%|████▏     | 87/209 [00:15<00:21,  5.58it/s] 42%|████▏     | 88/209 [00:15<00:21,  5.62it/s] 43%|████▎     | 89/209 [00:15<00:21,  5.62it/s] 43%|████▎     | 90/209 [00:15<00:21,  5.65it/s] 44%|████▎     | 91/209 [00:16<00:20,  5.63it/s] 44%|████▍     | 92/209 [00:16<00:20,  5.63it/s] 44%|████▍     | 93/209 [00:16<00:20,  5.64it/s] 45%|████▍     | 94/209 [00:16<00:20,  5.65it/s] 45%|████▌     | 95/209 [00:16<00:20,  5.67it/s] 46%|████▌     | 96/209 [00:16<00:19,  5.68it/s] 46%|████▋     | 97/209 [00:17<00:19,  5.70it/s] 47%|████▋     | 98/209 [00:17<00:19,  5.72it/s] 47%|████▋     | 99/209 [00:17<00:19,  5.73it/s] 48%|████▊     | 100/209 [00:17<00:19,  5.71it/s] 48%|████▊     | 101/209 [00:17<00:18,  5.69it/s] 49%|████▉     | 102/209 [00:17<00:18,  5.70it/s] 49%|████▉     | 103/209 [00:18<00:18,  5.71it/s] 50%|████▉     | 104/209 [00:18<00:18,  5.70it/s] 50%|█████     | 105/209 [00:18<00:18,  5.69it/s] 51%|█████     | 106/209 [00:18<00:18,  5.63it/s] 51%|█████     | 107/209 [00:18<00:18,  5.65it/s] 52%|█████▏    | 108/209 [00:19<00:17,  5.68it/s] 52%|█████▏    | 109/209 [00:19<00:17,  5.70it/s] 53%|█████▎    | 110/209 [00:19<00:17,  5.61it/s] 53%|█████▎    | 111/209 [00:19<00:17,  5.62it/s] 54%|█████▎    | 112/209 [00:19<00:17,  5.64it/s] 54%|█████▍    | 113/209 [00:19<00:16,  5.68it/s] 55%|█████▍    | 114/209 [00:20<00:16,  5.67it/s] 55%|█████▌    | 115/209 [00:20<00:16,  5.70it/s] 56%|█████▌    | 116/209 [00:20<00:16,  5.69it/s] 56%|█████▌    | 117/209 [00:20<00:16,  5.68it/s] 56%|█████▋    | 118/209 [00:20<00:16,  5.63it/s] 57%|█████▋    | 119/209 [00:20<00:15,  5.63it/s] 57%|█████▋    | 120/209 [00:21<00:15,  5.65it/s] 58%|█████▊    | 121/209 [00:21<00:15,  5.66it/s] 58%|█████▊    | 122/209 [00:21<00:15,  5.66it/s] 59%|█████▉    | 123/209 [00:21<00:15,  5.68it/s] 59%|█████▉    | 124/209 [00:21<00:14,  5.68it/s] 60%|█████▉    | 125/209 [00:22<00:14,  5.65it/s] 60%|██████    | 126/209 [00:22<00:14,  5.67it/s] 61%|██████    | 127/209 [00:22<00:14,  5.67it/s] 61%|██████    | 128/209 [00:22<00:14,  5.62it/s] 62%|██████▏   | 129/209 [00:22<00:14,  5.65it/s] 62%|██████▏   | 130/209 [00:22<00:13,  5.67it/s] 63%|██████▎   | 131/209 [00:23<00:13,  5.69it/s] 63%|██████▎   | 132/209 [00:23<00:13,  5.68it/s] 64%|██████▎   | 133/209 [00:23<00:13,  5.69it/s] 64%|██████▍   | 134/209 [00:23<00:13,  5.66it/s] 65%|██████▍   | 135/209 [00:23<00:13,  5.69it/s] 65%|██████▌   | 136/209 [00:23<00:12,  5.70it/s] 66%|██████▌   | 137/209 [00:24<00:12,  5.71it/s] 66%|██████▌   | 138/209 [00:24<00:12,  5.71it/s] 67%|██████▋   | 139/209 [00:24<00:12,  5.68it/s] 67%|██████▋   | 140/209 [00:24<00:12,  5.67it/s] 67%|██████▋   | 141/209 [00:24<00:11,  5.68it/s] 68%|██████▊   | 142/209 [00:25<00:11,  5.66it/s] 68%|██████▊   | 143/209 [00:25<00:11,  5.65it/s] 69%|██████▉   | 144/209 [00:25<00:11,  5.66it/s] 69%|██████▉   | 145/209 [00:25<00:11,  5.66it/s] 70%|██████▉   | 146/209 [00:25<00:11,  5.66it/s] 70%|███████   | 147/209 [00:25<00:10,  5.67it/s] 71%|███████   | 148/209 [00:26<00:10,  5.68it/s] 71%|███████▏  | 149/209 [00:26<00:10,  5.67it/s] 72%|███████▏  | 150/209 [00:26<00:10,  5.64it/s] 72%|███████▏  | 151/209 [00:26<00:10,  5.66it/s] 73%|███████▎  | 152/209 [00:26<00:10,  5.69it/s] 73%|███████▎  | 153/209 [00:26<00:09,  5.67it/s] 74%|███████▎  | 154/209 [00:27<00:09,  5.66it/s] 74%|███████▍  | 155/209 [00:27<00:09,  5.68it/s] 75%|███████▍  | 156/209 [00:27<00:09,  5.70it/s] 75%|███████▌  | 157/209 [00:27<00:09,  5.69it/s] 76%|███████▌  | 158/209 [00:27<00:09,  5.66it/s] 76%|███████▌  | 159/209 [00:28<00:08,  5.62it/s] 77%|███████▋  | 160/209 [00:28<00:08,  5.66it/s] 77%|███████▋  | 161/209 [00:28<00:08,  5.66it/s] 78%|███████▊  | 162/209 [00:28<00:08,  5.67it/s] 78%|███████▊  | 163/209 [00:28<00:08,  5.69it/s] 78%|███████▊  | 164/209 [00:28<00:07,  5.68it/s] 79%|███████▉  | 165/209 [00:29<00:07,  5.70it/s] 79%|███████▉  | 166/209 [00:29<00:07,  5.71it/s] 80%|███████▉  | 167/209 [00:29<00:07,  5.70it/s] 80%|████████  | 168/209 [00:29<00:07,  5.72it/s] 81%|████████  | 169/209 [00:29<00:07,  5.69it/s] 81%|████████▏ | 170/209 [00:29<00:06,  5.71it/s] 82%|████████▏ | 171/209 [00:30<00:06,  5.70it/s] 82%|████████▏ | 172/209 [00:30<00:06,  5.70it/s] 83%|████████▎ | 173/209 [00:30<00:06,  5.64it/s] 83%|████████▎ | 174/209 [00:30<00:06,  5.67it/s] 84%|████████▎ | 175/209 [00:30<00:06,  5.66it/s] 84%|████████▍ | 176/209 [00:31<00:05,  5.66it/s] 85%|████████▍ | 177/209 [00:31<00:05,  5.67it/s] 85%|████████▌ | 178/209 [00:31<00:05,  5.69it/s] 86%|████████▌ | 179/209 [00:31<00:05,  5.68it/s] 86%|████████▌ | 180/209 [00:31<00:05,  5.69it/s] 87%|████████▋ | 181/209 [00:31<00:04,  5.65it/s] 87%|████████▋ | 182/209 [00:32<00:04,  5.69it/s] 88%|████████▊ | 183/209 [00:32<00:04,  5.67it/s] 88%|████████▊ | 184/209 [00:32<00:04,  5.70it/s] 89%|████████▊ | 185/209 [00:32<00:04,  5.69it/s] 89%|████████▉ | 186/209 [00:32<00:04,  5.69it/s] 89%|████████▉ | 187/209 [00:32<00:03,  5.68it/s] 90%|████████▉ | 188/209 [00:33<00:03,  5.67it/s] 90%|█████████ | 189/209 [00:33<00:03,  5.66it/s] 91%|█████████ | 190/209 [00:33<00:03,  5.67it/s] 91%|█████████▏| 191/209 [00:33<00:03,  5.70it/s] 92%|█████████▏| 192/209 [00:33<00:02,  5.69it/s] 92%|█████████▏| 193/209 [00:34<00:02,  5.70it/s] 93%|█████████▎| 194/209 [00:34<00:02,  5.71it/s] 93%|█████████▎| 195/209 [00:34<00:02,  5.68it/s] 94%|█████████▍| 196/209 [00:34<00:02,  5.70it/s] 94%|█████████▍| 197/209 [00:34<00:02,  5.72it/s] 95%|█████████▍| 198/209 [00:34<00:01,  5.71it/s] 95%|█████████▌| 199/209 [00:35<00:01,  5.71it/s] 96%|█████████▌| 200/209 [00:35<00:01,  5.69it/s] 96%|█████████▌| 201/209 [00:35<00:01,  5.70it/s] 97%|█████████▋| 202/209 [00:35<00:01,  5.71it/s] 97%|█████████▋| 203/209 [00:35<00:01,  5.69it/s] 98%|█████████▊| 204/209 [00:35<00:00,  5.70it/s] 98%|█████████▊| 205/209 [00:36<00:00,  5.72it/s] 99%|█████████▊| 206/209 [00:36<00:00,  5.71it/s] 99%|█████████▉| 207/209 [00:36<00:00,  5.71it/s]100%|█████████▉| 208/209 [00:36<00:00,  5.65it/s]100%|██████████| 209/209 [00:36<00:00,  5.83it/s]100%|██████████| 209/209 [00:36<00:00,  5.68it/s]
[32m2025-02-05 05:05:44.077[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    grad norm  info_loss  rec_loss
        13.46      .6750     5.559[0m
[32m2025-02-05 05:05:44.077[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_recommender[0m:[36m136[0m - [1m[Valid][0m
  0%|          | 0/10256 [00:00<?, ?it/s] 48%|████▊     | 4937/10256 [00:00<00:00, 49355.46it/s] 96%|█████████▋| 9873/10256 [00:00<00:00, 47415.82it/s]100%|██████████| 10256/10256 [00:00<00:00, 47423.26it/s]
[32m2025-02-05 05:05:44.294[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/24 [00:00<?, ?it/s] 12%|█▎        | 3/24 [00:00<00:00, 21.18it/s] 25%|██▌       | 6/24 [00:00<00:00, 20.61it/s] 38%|███▊      | 9/24 [00:00<00:00, 20.82it/s] 50%|█████     | 12/24 [00:00<00:00, 20.67it/s] 62%|██████▎   | 15/24 [00:00<00:00, 20.85it/s] 75%|███████▌  | 18/24 [00:00<00:00, 21.07it/s] 88%|████████▊ | 21/24 [00:01<00:00, 21.16it/s]100%|██████████| 24/24 [00:01<00:00, 21.87it/s]100%|██████████| 24/24 [00:01<00:00, 21.27it/s]
[32m2025-02-05 05:05:45.431[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    hit@1  hit@10  hit@50  info_loss  mrr@1  mrr@10  mrr@50  ndcg@1  ndcg@10  ndcg@50  \
    .0412   .2103   .4352      .7411  .0412  .08249  .09319   .0412    .1122    .1620   
    rec_loss  
       7.075[0m
[32m2025-02-05 05:05:45.432[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_recommender[0m:[36m130[0m - [1m[Recommendation epoch 5][0m
[32m2025-02-05 05:05:45.432[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_recommender[0m:[36m131[0m - [1m[Train][0m
  0%|          | 0/92414 [00:00<?, ?it/s]  5%|▌         | 4804/92414 [00:00<00:01, 48028.37it/s] 11%|█         | 9731/92414 [00:00<00:01, 48739.56it/s] 16%|█▌        | 14605/92414 [00:00<00:01, 48730.13it/s] 21%|██        | 19500/92414 [00:00<00:01, 48806.45it/s] 27%|██▋       | 24675/92414 [00:00<00:01, 49862.46it/s] 32%|███▏      | 29662/92414 [00:00<00:01, 49581.60it/s] 37%|███▋      | 34622/92414 [00:00<00:01, 49563.48it/s] 43%|████▎     | 39579/92414 [00:01<00:02, 20502.41it/s] 48%|████▊     | 44784/92414 [00:01<00:01, 25477.85it/s] 54%|█████▍    | 50021/92414 [00:01<00:01, 30426.63it/s] 59%|█████▉    | 54963/92414 [00:01<00:01, 34380.40it/s] 65%|██████▍   | 60031/92414 [00:01<00:00, 38110.15it/s] 70%|███████   | 65103/92414 [00:01<00:00, 41212.69it/s] 76%|███████▌  | 69955/92414 [00:01<00:00, 42996.22it/s] 81%|████████  | 74867/92414 [00:01<00:00, 44647.43it/s] 86%|████████▋ | 79926/92414 [00:02<00:00, 46293.84it/s] 92%|█████████▏| 85070/92414 [00:02<00:00, 47751.88it/s] 98%|█████████▊| 90183/92414 [00:02<00:00, 48722.36it/s]100%|██████████| 92414/92414 [00:02<00:00, 40252.41it/s]
[32m2025-02-05 05:05:47.728[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/209 [00:00<?, ?it/s]  0%|          | 1/209 [00:00<00:36,  5.63it/s]  1%|          | 2/209 [00:00<00:36,  5.69it/s]  1%|▏         | 3/209 [00:00<00:36,  5.71it/s]  2%|▏         | 4/209 [00:00<00:35,  5.70it/s]  2%|▏         | 5/209 [00:00<00:35,  5.68it/s]  3%|▎         | 6/209 [00:01<00:35,  5.67it/s]  3%|▎         | 7/209 [00:01<00:35,  5.69it/s]  4%|▍         | 8/209 [00:01<00:35,  5.70it/s]  4%|▍         | 9/209 [00:01<00:35,  5.67it/s]  5%|▍         | 10/209 [00:01<00:35,  5.68it/s]  5%|▌         | 11/209 [00:01<00:34,  5.69it/s]  6%|▌         | 12/209 [00:02<00:34,  5.67it/s]  6%|▌         | 13/209 [00:02<00:34,  5.68it/s]  7%|▋         | 14/209 [00:02<00:34,  5.62it/s]  7%|▋         | 15/209 [00:02<00:34,  5.61it/s]  8%|▊         | 16/209 [00:02<00:34,  5.64it/s]  8%|▊         | 17/209 [00:02<00:33,  5.66it/s]  9%|▊         | 18/209 [00:03<00:33,  5.68it/s]  9%|▉         | 19/209 [00:03<00:33,  5.69it/s] 10%|▉         | 20/209 [00:03<00:33,  5.70it/s] 10%|█         | 21/209 [00:03<00:33,  5.68it/s] 11%|█         | 22/209 [00:03<00:32,  5.70it/s] 11%|█         | 23/209 [00:04<00:32,  5.70it/s] 11%|█▏        | 24/209 [00:04<00:32,  5.70it/s] 12%|█▏        | 25/209 [00:04<00:32,  5.70it/s] 12%|█▏        | 26/209 [00:04<00:32,  5.71it/s] 13%|█▎        | 27/209 [00:04<00:31,  5.72it/s] 13%|█▎        | 28/209 [00:04<00:31,  5.72it/s] 14%|█▍        | 29/209 [00:05<00:31,  5.68it/s] 14%|█▍        | 30/209 [00:05<00:31,  5.66it/s] 15%|█▍        | 31/209 [00:05<00:31,  5.66it/s] 15%|█▌        | 32/209 [00:05<00:31,  5.66it/s] 16%|█▌        | 33/209 [00:05<00:31,  5.66it/s] 16%|█▋        | 34/209 [00:05<00:30,  5.68it/s] 17%|█▋        | 35/209 [00:06<00:30,  5.67it/s] 17%|█▋        | 36/209 [00:06<00:30,  5.67it/s] 18%|█▊        | 37/209 [00:06<00:30,  5.65it/s] 18%|█▊        | 38/209 [00:06<00:30,  5.63it/s] 19%|█▊        | 39/209 [00:06<00:30,  5.64it/s] 19%|█▉        | 40/209 [00:07<00:30,  5.63it/s] 20%|█▉        | 41/209 [00:07<00:29,  5.62it/s] 20%|██        | 42/209 [00:07<00:29,  5.64it/s] 21%|██        | 43/209 [00:07<00:29,  5.64it/s] 21%|██        | 44/209 [00:07<00:29,  5.67it/s] 22%|██▏       | 45/209 [00:07<00:28,  5.67it/s] 22%|██▏       | 46/209 [00:08<00:28,  5.62it/s] 22%|██▏       | 47/209 [00:08<00:28,  5.64it/s] 23%|██▎       | 48/209 [00:08<00:28,  5.65it/s] 23%|██▎       | 49/209 [00:08<00:28,  5.66it/s] 24%|██▍       | 50/209 [00:08<00:28,  5.67it/s] 24%|██▍       | 51/209 [00:08<00:27,  5.65it/s] 25%|██▍       | 52/209 [00:09<00:27,  5.68it/s] 25%|██▌       | 53/209 [00:09<00:27,  5.68it/s] 26%|██▌       | 54/209 [00:09<00:27,  5.68it/s] 26%|██▋       | 55/209 [00:09<00:27,  5.70it/s] 27%|██▋       | 56/209 [00:09<00:26,  5.70it/s] 27%|██▋       | 57/209 [00:10<00:26,  5.68it/s] 28%|██▊       | 58/209 [00:10<00:26,  5.70it/s] 28%|██▊       | 59/209 [00:10<00:26,  5.70it/s] 29%|██▊       | 60/209 [00:10<00:26,  5.67it/s] 29%|██▉       | 61/209 [00:10<00:26,  5.68it/s] 30%|██▉       | 62/209 [00:10<00:25,  5.69it/s] 30%|███       | 63/209 [00:11<00:25,  5.66it/s] 31%|███       | 64/209 [00:11<00:25,  5.65it/s] 31%|███       | 65/209 [00:11<00:25,  5.69it/s] 32%|███▏      | 66/209 [00:11<00:25,  5.69it/s] 32%|███▏      | 67/209 [00:11<00:25,  5.65it/s] 33%|███▎      | 68/209 [00:11<00:24,  5.68it/s] 33%|███▎      | 69/209 [00:12<00:24,  5.69it/s] 33%|███▎      | 70/209 [00:12<00:24,  5.71it/s] 34%|███▍      | 71/209 [00:12<00:24,  5.69it/s] 34%|███▍      | 72/209 [00:12<00:24,  5.69it/s] 35%|███▍      | 73/209 [00:12<00:23,  5.70it/s] 35%|███▌      | 74/209 [00:13<00:23,  5.70it/s] 36%|███▌      | 75/209 [00:13<00:23,  5.71it/s] 36%|███▋      | 76/209 [00:13<00:23,  5.70it/s] 37%|███▋      | 77/209 [00:13<00:23,  5.71it/s] 37%|███▋      | 78/209 [00:13<00:23,  5.63it/s] 38%|███▊      | 79/209 [00:13<00:23,  5.65it/s] 38%|███▊      | 80/209 [00:14<00:22,  5.62it/s] 39%|███▉      | 81/209 [00:14<00:22,  5.66it/s] 39%|███▉      | 82/209 [00:14<00:22,  5.69it/s] 40%|███▉      | 83/209 [00:14<00:22,  5.66it/s] 40%|████      | 84/209 [00:14<00:22,  5.67it/s] 41%|████      | 85/209 [00:14<00:21,  5.66it/s] 41%|████      | 86/209 [00:15<00:21,  5.66it/s] 42%|████▏     | 87/209 [00:15<00:21,  5.59it/s] 42%|████▏     | 88/209 [00:15<00:21,  5.62it/s] 43%|████▎     | 89/209 [00:15<00:21,  5.61it/s] 43%|████▎     | 90/209 [00:15<00:21,  5.65it/s] 44%|████▎     | 91/209 [00:16<00:20,  5.63it/s] 44%|████▍     | 92/209 [00:16<00:20,  5.62it/s] 44%|████▍     | 93/209 [00:16<00:20,  5.61it/s] 45%|████▍     | 94/209 [00:16<00:20,  5.64it/s] 45%|████▌     | 95/209 [00:16<00:20,  5.65it/s] 46%|████▌     | 96/209 [00:16<00:19,  5.67it/s] 46%|████▋     | 97/209 [00:17<00:19,  5.69it/s] 47%|████▋     | 98/209 [00:17<00:19,  5.71it/s] 47%|████▋     | 99/209 [00:17<00:19,  5.72it/s] 48%|████▊     | 100/209 [00:17<00:19,  5.71it/s] 48%|████▊     | 101/209 [00:17<00:18,  5.69it/s] 49%|████▉     | 102/209 [00:17<00:18,  5.70it/s] 49%|████▉     | 103/209 [00:18<00:18,  5.71it/s] 50%|████▉     | 104/209 [00:18<00:18,  5.70it/s] 50%|█████     | 105/209 [00:18<00:18,  5.69it/s] 51%|█████     | 106/209 [00:18<00:18,  5.63it/s] 51%|█████     | 107/209 [00:18<00:18,  5.66it/s] 52%|█████▏    | 108/209 [00:19<00:17,  5.68it/s] 52%|█████▏    | 109/209 [00:19<00:17,  5.69it/s] 53%|█████▎    | 110/209 [00:19<00:17,  5.61it/s] 53%|█████▎    | 111/209 [00:19<00:17,  5.61it/s] 54%|█████▎    | 112/209 [00:19<00:17,  5.64it/s] 54%|█████▍    | 113/209 [00:19<00:16,  5.68it/s] 55%|█████▍    | 114/209 [00:20<00:16,  5.67it/s] 55%|█████▌    | 115/209 [00:20<00:16,  5.69it/s] 56%|█████▌    | 116/209 [00:20<00:16,  5.69it/s] 56%|█████▌    | 117/209 [00:20<00:16,  5.68it/s] 56%|█████▋    | 118/209 [00:20<00:16,  5.63it/s] 57%|█████▋    | 119/209 [00:20<00:15,  5.63it/s] 57%|█████▋    | 120/209 [00:21<00:15,  5.65it/s] 58%|█████▊    | 121/209 [00:21<00:15,  5.66it/s] 58%|█████▊    | 122/209 [00:21<00:15,  5.66it/s] 59%|█████▉    | 123/209 [00:21<00:15,  5.68it/s] 59%|█████▉    | 124/209 [00:21<00:14,  5.68it/s] 60%|█████▉    | 125/209 [00:22<00:14,  5.65it/s] 60%|██████    | 126/209 [00:22<00:14,  5.68it/s] 61%|██████    | 127/209 [00:22<00:14,  5.68it/s] 61%|██████    | 128/209 [00:22<00:14,  5.65it/s] 62%|██████▏   | 129/209 [00:22<00:14,  5.67it/s] 62%|██████▏   | 130/209 [00:22<00:13,  5.69it/s] 63%|██████▎   | 131/209 [00:23<00:13,  5.71it/s] 63%|██████▎   | 132/209 [00:23<00:13,  5.69it/s] 64%|██████▎   | 133/209 [00:23<00:13,  5.70it/s] 64%|██████▍   | 134/209 [00:23<00:13,  5.66it/s] 65%|██████▍   | 135/209 [00:23<00:13,  5.69it/s] 65%|██████▌   | 136/209 [00:23<00:12,  5.70it/s] 66%|██████▌   | 137/209 [00:24<00:12,  5.71it/s] 66%|██████▌   | 138/209 [00:24<00:12,  5.72it/s] 67%|██████▋   | 139/209 [00:24<00:12,  5.68it/s] 67%|██████▋   | 140/209 [00:24<00:12,  5.67it/s] 67%|██████▋   | 141/209 [00:24<00:11,  5.68it/s] 68%|██████▊   | 142/209 [00:25<00:11,  5.66it/s] 68%|██████▊   | 143/209 [00:25<00:11,  5.63it/s] 69%|██████▉   | 144/209 [00:25<00:11,  5.65it/s] 69%|██████▉   | 145/209 [00:25<00:11,  5.66it/s] 70%|██████▉   | 146/209 [00:25<00:11,  5.66it/s] 70%|███████   | 147/209 [00:25<00:10,  5.67it/s] 71%|███████   | 148/209 [00:26<00:10,  5.68it/s] 71%|███████▏  | 149/209 [00:26<00:10,  5.67it/s] 72%|███████▏  | 150/209 [00:26<00:10,  5.64it/s] 72%|███████▏  | 151/209 [00:26<00:10,  5.66it/s] 73%|███████▎  | 152/209 [00:26<00:10,  5.69it/s] 73%|███████▎  | 153/209 [00:26<00:09,  5.66it/s] 74%|███████▎  | 154/209 [00:27<00:09,  5.66it/s] 74%|███████▍  | 155/209 [00:27<00:09,  5.68it/s] 75%|███████▍  | 156/209 [00:27<00:09,  5.69it/s] 75%|███████▌  | 157/209 [00:27<00:09,  5.69it/s] 76%|███████▌  | 158/209 [00:27<00:09,  5.66it/s] 76%|███████▌  | 159/209 [00:28<00:08,  5.62it/s] 77%|███████▋  | 160/209 [00:28<00:08,  5.66it/s] 77%|███████▋  | 161/209 [00:28<00:08,  5.66it/s] 78%|███████▊  | 162/209 [00:28<00:08,  5.67it/s] 78%|███████▊  | 163/209 [00:28<00:08,  5.69it/s] 78%|███████▊  | 164/209 [00:28<00:07,  5.68it/s] 79%|███████▉  | 165/209 [00:29<00:07,  5.69it/s] 79%|███████▉  | 166/209 [00:29<00:07,  5.70it/s] 80%|███████▉  | 167/209 [00:29<00:07,  5.70it/s] 80%|████████  | 168/209 [00:29<00:07,  5.73it/s] 81%|████████  | 169/209 [00:29<00:07,  5.69it/s] 81%|████████▏ | 170/209 [00:29<00:06,  5.72it/s] 82%|████████▏ | 171/209 [00:30<00:06,  5.70it/s] 82%|████████▏ | 172/209 [00:30<00:06,  5.70it/s] 83%|████████▎ | 173/209 [00:30<00:06,  5.64it/s] 83%|████████▎ | 174/209 [00:30<00:06,  5.67it/s] 84%|████████▎ | 175/209 [00:30<00:06,  5.66it/s] 84%|████████▍ | 176/209 [00:31<00:05,  5.66it/s] 85%|████████▍ | 177/209 [00:31<00:05,  5.67it/s] 85%|████████▌ | 178/209 [00:31<00:05,  5.68it/s] 86%|████████▌ | 179/209 [00:31<00:05,  5.67it/s] 86%|████████▌ | 180/209 [00:31<00:05,  5.69it/s] 87%|████████▋ | 181/209 [00:31<00:04,  5.65it/s] 87%|████████▋ | 182/209 [00:32<00:04,  5.68it/s] 88%|████████▊ | 183/209 [00:32<00:04,  5.67it/s] 88%|████████▊ | 184/209 [00:32<00:04,  5.69it/s] 89%|████████▊ | 185/209 [00:32<00:04,  5.67it/s] 89%|████████▉ | 186/209 [00:32<00:04,  5.67it/s] 89%|████████▉ | 187/209 [00:32<00:03,  5.67it/s] 90%|████████▉ | 188/209 [00:33<00:03,  5.67it/s] 90%|█████████ | 189/209 [00:33<00:03,  5.66it/s] 91%|█████████ | 190/209 [00:33<00:03,  5.67it/s] 91%|█████████▏| 191/209 [00:33<00:03,  5.70it/s] 92%|█████████▏| 192/209 [00:33<00:02,  5.69it/s] 92%|█████████▏| 193/209 [00:34<00:02,  5.70it/s] 93%|█████████▎| 194/209 [00:34<00:02,  5.71it/s] 93%|█████████▎| 195/209 [00:34<00:02,  5.68it/s] 94%|█████████▍| 196/209 [00:34<00:02,  5.69it/s] 94%|█████████▍| 197/209 [00:34<00:02,  5.72it/s] 95%|█████████▍| 198/209 [00:34<00:01,  5.71it/s] 95%|█████████▌| 199/209 [00:35<00:01,  5.72it/s] 96%|█████████▌| 200/209 [00:35<00:01,  5.70it/s] 96%|█████████▌| 201/209 [00:35<00:01,  5.71it/s] 97%|█████████▋| 202/209 [00:35<00:01,  5.72it/s] 97%|█████████▋| 203/209 [00:35<00:01,  5.70it/s] 98%|█████████▊| 204/209 [00:35<00:00,  5.70it/s] 98%|█████████▊| 205/209 [00:36<00:00,  5.72it/s] 99%|█████████▊| 206/209 [00:36<00:00,  5.71it/s] 99%|█████████▉| 207/209 [00:36<00:00,  5.70it/s]100%|█████████▉| 208/209 [00:36<00:00,  5.65it/s]100%|██████████| 209/209 [00:36<00:00,  5.83it/s]100%|██████████| 209/209 [00:36<00:00,  5.68it/s]
[32m2025-02-05 05:06:24.604[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    grad norm  info_loss  rec_loss
        18.37      .6359     5.329[0m
[32m2025-02-05 05:06:24.604[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_recommender[0m:[36m136[0m - [1m[Valid][0m
  0%|          | 0/10256 [00:00<?, ?it/s] 49%|████▊     | 4980/10256 [00:00<00:00, 49767.54it/s] 97%|█████████▋| 9957/10256 [00:00<00:00, 47262.75it/s]100%|██████████| 10256/10256 [00:00<00:00, 47321.32it/s]
[32m2025-02-05 05:06:24.821[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/24 [00:00<?, ?it/s] 12%|█▎        | 3/24 [00:00<00:00, 21.26it/s] 25%|██▌       | 6/24 [00:00<00:00, 21.47it/s] 38%|███▊      | 9/24 [00:00<00:00, 21.35it/s] 50%|█████     | 12/24 [00:00<00:00, 21.35it/s] 62%|██████▎   | 15/24 [00:00<00:00, 20.96it/s] 75%|███████▌  | 18/24 [00:00<00:00, 20.62it/s] 88%|████████▊ | 21/24 [00:01<00:00, 20.83it/s]100%|██████████| 24/24 [00:01<00:00, 21.46it/s]100%|██████████| 24/24 [00:01<00:00, 21.21it/s]
[32m2025-02-05 05:06:25.962[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    hit@1  hit@10  hit@50  info_loss  mrr@1  mrr@10  mrr@50  ndcg@1  ndcg@10  ndcg@50  \
   .04485   .2103   .4336      .5839 .04485  .08446  .09517  .04485    .1136    .1631   
    rec_loss  
       7.131[0m
[32m2025-02-05 05:06:25.962[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_recommender[0m:[36m130[0m - [1m[Recommendation epoch 6][0m
[32m2025-02-05 05:06:25.962[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_recommender[0m:[36m131[0m - [1m[Train][0m
  0%|          | 0/92414 [00:00<?, ?it/s]  5%|▌         | 4806/92414 [00:00<00:01, 47959.42it/s] 11%|█         | 9741/92414 [00:00<00:01, 48771.74it/s] 16%|█▌        | 14713/92414 [00:00<00:01, 49177.51it/s] 21%|██▏       | 19705/92414 [00:00<00:01, 49468.97it/s] 27%|██▋       | 24848/92414 [00:00<00:01, 50173.47it/s] 32%|███▏      | 29866/92414 [00:00<00:01, 49373.69it/s] 38%|███▊      | 34913/92414 [00:00<00:01, 49724.21it/s] 43%|████▎     | 39923/92414 [00:00<00:01, 49835.56it/s] 49%|████▊     | 44909/92414 [00:01<00:02, 19606.77it/s] 54%|█████▍    | 50170/92414 [00:01<00:01, 24515.69it/s] 60%|█████▉    | 55097/92414 [00:01<00:01, 28850.42it/s] 65%|██████▌   | 60187/92414 [00:01<00:00, 33262.44it/s] 71%|███████   | 65287/92414 [00:01<00:00, 37206.04it/s] 76%|███████▌  | 70071/92414 [00:01<00:00, 39761.42it/s] 81%|████████  | 75041/92414 [00:02<00:00, 42306.89it/s] 87%|████████▋ | 79981/92414 [00:02<00:00, 44206.31it/s] 92%|█████████▏| 85128/92414 [00:02<00:00, 46206.23it/s] 98%|█████████▊| 90199/92414 [00:02<00:00, 47470.89it/s]100%|██████████| 92414/92414 [00:02<00:00, 39389.89it/s]
[32m2025-02-05 05:06:28.309[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/209 [00:00<?, ?it/s]  0%|          | 1/209 [00:00<00:36,  5.72it/s]  1%|          | 2/209 [00:00<00:36,  5.67it/s]  1%|▏         | 3/209 [00:00<00:36,  5.70it/s]  2%|▏         | 4/209 [00:00<00:36,  5.69it/s]  2%|▏         | 5/209 [00:00<00:36,  5.67it/s]  3%|▎         | 6/209 [00:01<00:35,  5.66it/s]  3%|▎         | 7/209 [00:01<00:35,  5.68it/s]  4%|▍         | 8/209 [00:01<00:35,  5.69it/s]  4%|▍         | 9/209 [00:01<00:35,  5.66it/s]  5%|▍         | 10/209 [00:01<00:35,  5.68it/s]  5%|▌         | 11/209 [00:01<00:34,  5.69it/s]  6%|▌         | 12/209 [00:02<00:34,  5.67it/s]  6%|▌         | 13/209 [00:02<00:34,  5.68it/s]  7%|▋         | 14/209 [00:02<00:34,  5.61it/s]  7%|▋         | 15/209 [00:02<00:34,  5.60it/s]  8%|▊         | 16/209 [00:02<00:34,  5.63it/s]  8%|▊         | 17/209 [00:03<00:33,  5.65it/s]  9%|▊         | 18/209 [00:03<00:33,  5.67it/s]  9%|▉         | 19/209 [00:03<00:33,  5.68it/s] 10%|▉         | 20/209 [00:03<00:33,  5.69it/s] 10%|█         | 21/209 [00:03<00:33,  5.68it/s] 11%|█         | 22/209 [00:03<00:32,  5.69it/s] 11%|█         | 23/209 [00:04<00:32,  5.70it/s] 11%|█▏        | 24/209 [00:04<00:32,  5.70it/s] 12%|█▏        | 25/209 [00:04<00:32,  5.70it/s] 12%|█▏        | 26/209 [00:04<00:32,  5.71it/s] 13%|█▎        | 27/209 [00:04<00:31,  5.71it/s] 13%|█▎        | 28/209 [00:04<00:31,  5.72it/s] 14%|█▍        | 29/209 [00:05<00:31,  5.67it/s] 14%|█▍        | 30/209 [00:05<00:31,  5.67it/s] 15%|█▍        | 31/209 [00:05<00:31,  5.66it/s] 15%|█▌        | 32/209 [00:05<00:31,  5.66it/s] 16%|█▌        | 33/209 [00:05<00:31,  5.66it/s] 16%|█▋        | 34/209 [00:05<00:30,  5.68it/s] 17%|█▋        | 35/209 [00:06<00:30,  5.67it/s] 17%|█▋        | 36/209 [00:06<00:30,  5.67it/s] 18%|█▊        | 37/209 [00:06<00:30,  5.64it/s] 18%|█▊        | 38/209 [00:06<00:30,  5.63it/s] 19%|█▊        | 39/209 [00:06<00:30,  5.64it/s] 19%|█▉        | 40/209 [00:07<00:30,  5.63it/s] 20%|█▉        | 41/209 [00:07<00:29,  5.62it/s] 20%|██        | 42/209 [00:07<00:29,  5.63it/s] 21%|██        | 43/209 [00:07<00:29,  5.64it/s] 21%|██        | 44/209 [00:07<00:29,  5.67it/s] 22%|██▏       | 45/209 [00:07<00:28,  5.67it/s] 22%|██▏       | 46/209 [00:08<00:28,  5.62it/s] 22%|██▏       | 47/209 [00:08<00:28,  5.64it/s] 23%|██▎       | 48/209 [00:08<00:28,  5.65it/s] 23%|██▎       | 49/209 [00:08<00:28,  5.66it/s] 24%|██▍       | 50/209 [00:08<00:28,  5.67it/s] 24%|██▍       | 51/209 [00:08<00:27,  5.70it/s] 25%|██▍       | 52/209 [00:09<00:27,  5.71it/s] 25%|██▌       | 53/209 [00:09<00:27,  5.71it/s] 26%|██▌       | 54/209 [00:09<00:27,  5.70it/s] 26%|██▋       | 55/209 [00:09<00:26,  5.71it/s] 27%|██▋       | 56/209 [00:09<00:26,  5.71it/s] 27%|██▋       | 57/209 [00:10<00:26,  5.66it/s] 28%|██▊       | 58/209 [00:10<00:26,  5.68it/s] 28%|██▊       | 59/209 [00:10<00:26,  5.68it/s] 29%|██▊       | 60/209 [00:10<00:26,  5.66it/s] 29%|██▉       | 61/209 [00:10<00:26,  5.67it/s] 30%|██▉       | 62/209 [00:10<00:25,  5.69it/s] 30%|███       | 63/209 [00:11<00:25,  5.66it/s] 31%|███       | 64/209 [00:11<00:25,  5.65it/s] 31%|███       | 65/209 [00:11<00:25,  5.68it/s] 32%|███▏      | 66/209 [00:11<00:25,  5.69it/s] 32%|███▏      | 67/209 [00:11<00:25,  5.64it/s] 33%|███▎      | 68/209 [00:11<00:24,  5.67it/s] 33%|███▎      | 69/209 [00:12<00:24,  5.68it/s] 33%|███▎      | 70/209 [00:12<00:24,  5.70it/s] 34%|███▍      | 71/209 [00:12<00:24,  5.68it/s] 34%|███▍      | 72/209 [00:12<00:24,  5.70it/s] 35%|███▍      | 73/209 [00:12<00:23,  5.70it/s] 35%|███▌      | 74/209 [00:13<00:23,  5.71it/s] 36%|███▌      | 75/209 [00:13<00:23,  5.71it/s] 36%|███▋      | 76/209 [00:13<00:23,  5.70it/s] 37%|███▋      | 77/209 [00:13<00:23,  5.71it/s] 37%|███▋      | 78/209 [00:13<00:23,  5.63it/s] 38%|███▊      | 79/209 [00:13<00:23,  5.64it/s] 38%|███▊      | 80/209 [00:14<00:22,  5.62it/s] 39%|███▉      | 81/209 [00:14<00:22,  5.65it/s] 39%|███▉      | 82/209 [00:14<00:22,  5.68it/s] 40%|███▉      | 83/209 [00:14<00:22,  5.66it/s] 40%|████      | 84/209 [00:14<00:22,  5.68it/s] 41%|████      | 85/209 [00:14<00:21,  5.66it/s] 41%|████      | 86/209 [00:15<00:21,  5.66it/s] 42%|████▏     | 87/209 [00:15<00:21,  5.59it/s] 42%|████▏     | 88/209 [00:15<00:21,  5.63it/s] 43%|████▎     | 89/209 [00:15<00:21,  5.62it/s] 43%|████▎     | 90/209 [00:15<00:21,  5.65it/s] 44%|████▎     | 91/209 [00:16<00:20,  5.63it/s] 44%|████▍     | 92/209 [00:16<00:20,  5.63it/s] 44%|████▍     | 93/209 [00:16<00:20,  5.64it/s] 45%|████▍     | 94/209 [00:16<00:20,  5.65it/s] 45%|████▌     | 95/209 [00:16<00:20,  5.67it/s] 46%|████▌     | 96/209 [00:16<00:19,  5.68it/s] 46%|████▋     | 97/209 [00:17<00:19,  5.70it/s] 47%|████▋     | 98/209 [00:17<00:19,  5.71it/s] 47%|████▋     | 99/209 [00:17<00:19,  5.72it/s] 48%|████▊     | 100/209 [00:17<00:19,  5.70it/s] 48%|████▊     | 101/209 [00:17<00:18,  5.69it/s] 49%|████▉     | 102/209 [00:17<00:18,  5.69it/s] 49%|████▉     | 103/209 [00:18<00:18,  5.71it/s] 50%|████▉     | 104/209 [00:18<00:18,  5.70it/s] 50%|█████     | 105/209 [00:18<00:18,  5.69it/s] 51%|█████     | 106/209 [00:18<00:18,  5.63it/s] 51%|█████     | 107/209 [00:18<00:18,  5.65it/s] 52%|█████▏    | 108/209 [00:19<00:17,  5.67it/s] 52%|█████▏    | 109/209 [00:19<00:17,  5.69it/s] 53%|█████▎    | 110/209 [00:19<00:17,  5.60it/s] 53%|█████▎    | 111/209 [00:19<00:17,  5.61it/s] 54%|█████▎    | 112/209 [00:19<00:17,  5.63it/s] 54%|█████▍    | 113/209 [00:19<00:16,  5.68it/s] 55%|█████▍    | 114/209 [00:20<00:16,  5.67it/s] 55%|█████▌    | 115/209 [00:20<00:16,  5.69it/s] 56%|█████▌    | 116/209 [00:20<00:16,  5.69it/s] 56%|█████▌    | 117/209 [00:20<00:16,  5.68it/s] 56%|█████▋    | 118/209 [00:20<00:16,  5.63it/s] 57%|█████▋    | 119/209 [00:20<00:16,  5.62it/s] 57%|█████▋    | 120/209 [00:21<00:15,  5.64it/s] 58%|█████▊    | 121/209 [00:21<00:15,  5.66it/s] 58%|█████▊    | 122/209 [00:21<00:15,  5.66it/s] 59%|█████▉    | 123/209 [00:21<00:15,  5.68it/s] 59%|█████▉    | 124/209 [00:21<00:14,  5.68it/s] 60%|█████▉    | 125/209 [00:22<00:14,  5.65it/s] 60%|██████    | 126/209 [00:22<00:14,  5.68it/s] 61%|██████    | 127/209 [00:22<00:14,  5.68it/s] 61%|██████    | 128/209 [00:22<00:14,  5.65it/s] 62%|██████▏   | 129/209 [00:22<00:14,  5.67it/s] 62%|██████▏   | 130/209 [00:22<00:13,  5.69it/s] 63%|██████▎   | 131/209 [00:23<00:13,  5.70it/s] 63%|██████▎   | 132/209 [00:23<00:13,  5.69it/s] 64%|██████▎   | 133/209 [00:23<00:13,  5.70it/s] 64%|██████▍   | 134/209 [00:23<00:13,  5.67it/s] 65%|██████▍   | 135/209 [00:23<00:13,  5.69it/s] 65%|██████▌   | 136/209 [00:23<00:12,  5.70it/s] 66%|██████▌   | 137/209 [00:24<00:12,  5.71it/s] 66%|██████▌   | 138/209 [00:24<00:12,  5.72it/s] 67%|██████▋   | 139/209 [00:24<00:12,  5.68it/s] 67%|██████▋   | 140/209 [00:24<00:12,  5.67it/s] 67%|██████▋   | 141/209 [00:24<00:11,  5.67it/s] 68%|██████▊   | 142/209 [00:25<00:11,  5.66it/s] 68%|██████▊   | 143/209 [00:25<00:11,  5.64it/s] 69%|██████▉   | 144/209 [00:25<00:11,  5.66it/s] 69%|██████▉   | 145/209 [00:25<00:11,  5.66it/s] 70%|██████▉   | 146/209 [00:25<00:11,  5.66it/s] 70%|███████   | 147/209 [00:25<00:10,  5.67it/s] 71%|███████   | 148/209 [00:26<00:10,  5.68it/s] 71%|███████▏  | 149/209 [00:26<00:10,  5.66it/s] 72%|███████▏  | 150/209 [00:26<00:10,  5.61it/s] 72%|███████▏  | 151/209 [00:26<00:10,  5.64it/s] 73%|███████▎  | 152/209 [00:26<00:10,  5.67it/s] 73%|███████▎  | 153/209 [00:26<00:09,  5.66it/s] 74%|███████▎  | 154/209 [00:27<00:09,  5.66it/s] 74%|███████▍  | 155/209 [00:27<00:09,  5.67it/s] 75%|███████▍  | 156/209 [00:27<00:09,  5.69it/s] 75%|███████▌  | 157/209 [00:27<00:09,  5.69it/s] 76%|███████▌  | 158/209 [00:27<00:09,  5.66it/s] 76%|███████▌  | 159/209 [00:28<00:08,  5.61it/s] 77%|███████▋  | 160/209 [00:28<00:08,  5.65it/s] 77%|███████▋  | 161/209 [00:28<00:08,  5.65it/s] 78%|███████▊  | 162/209 [00:28<00:08,  5.66it/s] 78%|███████▊  | 163/209 [00:28<00:08,  5.68it/s] 78%|███████▊  | 164/209 [00:28<00:07,  5.68it/s] 79%|███████▉  | 165/209 [00:29<00:07,  5.69it/s] 79%|███████▉  | 166/209 [00:29<00:07,  5.70it/s] 80%|███████▉  | 167/209 [00:29<00:07,  5.70it/s] 80%|████████  | 168/209 [00:29<00:07,  5.72it/s] 81%|████████  | 169/209 [00:29<00:07,  5.69it/s] 81%|████████▏ | 170/209 [00:29<00:06,  5.71it/s] 82%|████████▏ | 171/209 [00:30<00:06,  5.70it/s] 82%|████████▏ | 172/209 [00:30<00:06,  5.70it/s] 83%|████████▎ | 173/209 [00:30<00:06,  5.64it/s] 83%|████████▎ | 174/209 [00:30<00:06,  5.67it/s] 84%|████████▎ | 175/209 [00:30<00:06,  5.61it/s] 84%|████████▍ | 176/209 [00:31<00:05,  5.62it/s] 85%|████████▍ | 177/209 [00:31<00:05,  5.65it/s] 85%|████████▌ | 178/209 [00:31<00:05,  5.67it/s] 86%|████████▌ | 179/209 [00:31<00:05,  5.66it/s] 86%|████████▌ | 180/209 [00:31<00:05,  5.68it/s] 87%|████████▋ | 181/209 [00:31<00:04,  5.65it/s] 87%|████████▋ | 182/209 [00:32<00:04,  5.68it/s] 88%|████████▊ | 183/209 [00:32<00:04,  5.67it/s] 88%|████████▊ | 184/209 [00:32<00:04,  5.70it/s] 89%|████████▊ | 185/209 [00:32<00:04,  5.69it/s] 89%|████████▉ | 186/209 [00:32<00:04,  5.69it/s] 89%|████████▉ | 187/209 [00:32<00:03,  5.68it/s] 90%|████████▉ | 188/209 [00:33<00:03,  5.68it/s] 90%|█████████ | 189/209 [00:33<00:03,  5.67it/s] 91%|█████████ | 190/209 [00:33<00:03,  5.67it/s] 91%|█████████▏| 191/209 [00:33<00:03,  5.69it/s] 92%|█████████▏| 192/209 [00:33<00:02,  5.68it/s] 92%|█████████▏| 193/209 [00:34<00:02,  5.70it/s] 93%|█████████▎| 194/209 [00:34<00:02,  5.71it/s] 93%|█████████▎| 195/209 [00:34<00:02,  5.68it/s] 94%|█████████▍| 196/209 [00:34<00:02,  5.69it/s] 94%|█████████▍| 197/209 [00:34<00:02,  5.72it/s] 95%|█████████▍| 198/209 [00:34<00:01,  5.71it/s] 95%|█████████▌| 199/209 [00:35<00:01,  5.71it/s] 96%|█████████▌| 200/209 [00:35<00:01,  5.70it/s] 96%|█████████▌| 201/209 [00:35<00:01,  5.70it/s] 97%|█████████▋| 202/209 [00:35<00:01,  5.72it/s] 97%|█████████▋| 203/209 [00:35<00:01,  5.70it/s] 98%|█████████▊| 204/209 [00:35<00:00,  5.70it/s] 98%|█████████▊| 205/209 [00:36<00:00,  5.72it/s] 99%|█████████▊| 206/209 [00:36<00:00,  5.71it/s] 99%|█████████▉| 207/209 [00:36<00:00,  5.71it/s]100%|█████████▉| 208/209 [00:36<00:00,  5.65it/s]100%|██████████| 209/209 [00:36<00:00,  5.84it/s]100%|██████████| 209/209 [00:36<00:00,  5.67it/s]
[32m2025-02-05 05:07:05.201[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    grad norm  info_loss  rec_loss
        42.67      1.221     5.164[0m
[32m2025-02-05 05:07:05.202[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_recommender[0m:[36m136[0m - [1m[Valid][0m
  0%|          | 0/10256 [00:00<?, ?it/s] 48%|████▊     | 4885/10256 [00:00<00:00, 48788.05it/s] 95%|█████████▌| 9764/10256 [00:00<00:00, 46853.68it/s]100%|██████████| 10256/10256 [00:00<00:00, 46711.02it/s]
[32m2025-02-05 05:07:05.422[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/24 [00:00<?, ?it/s] 12%|█▎        | 3/24 [00:00<00:00, 21.14it/s] 25%|██▌       | 6/24 [00:00<00:00, 21.42it/s] 38%|███▊      | 9/24 [00:00<00:00, 20.68it/s] 50%|█████     | 12/24 [00:00<00:00, 20.60it/s] 62%|██████▎   | 15/24 [00:00<00:00, 20.84it/s] 75%|███████▌  | 18/24 [00:00<00:00, 21.06it/s] 88%|████████▊ | 21/24 [00:00<00:00, 21.14it/s]100%|██████████| 24/24 [00:01<00:00, 21.86it/s]100%|██████████| 24/24 [00:01<00:00, 21.30it/s]
[32m2025-02-05 05:07:06.559[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    hit@1  hit@10  hit@50  info_loss  mrr@1  mrr@10  mrr@50  ndcg@1  ndcg@10  ndcg@50  \
   .04385   .2090   .4365      .6336 .04385  .08365  .09445  .04385    .1127    .1630   
    rec_loss  
       7.204[0m
[32m2025-02-05 05:07:06.559[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_recommender[0m:[36m130[0m - [1m[Recommendation epoch 7][0m
[32m2025-02-05 05:07:06.559[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_recommender[0m:[36m131[0m - [1m[Train][0m
  0%|          | 0/92414 [00:00<?, ?it/s]  5%|▌         | 4779/92414 [00:00<00:01, 47758.05it/s] 10%|█         | 9657/92414 [00:00<00:01, 48340.08it/s] 16%|█▌        | 14655/92414 [00:00<00:01, 49079.79it/s] 21%|██        | 19616/92414 [00:00<00:01, 49275.80it/s] 27%|██▋       | 24829/92414 [00:00<00:01, 50303.15it/s] 32%|███▏      | 29860/92414 [00:00<00:01, 49571.93it/s] 38%|███▊      | 34865/92414 [00:00<00:01, 49726.32it/s] 43%|████▎     | 39889/92414 [00:00<00:01, 49888.29it/s] 49%|████▊     | 44910/92414 [00:00<00:00, 49984.10it/s] 54%|█████▍    | 49910/92414 [00:01<00:02, 21018.37it/s] 59%|█████▉    | 54868/92414 [00:01<00:01, 25471.89it/s] 65%|██████▍   | 59972/92414 [00:01<00:01, 30125.65it/s] 70%|███████   | 65007/92414 [00:01<00:00, 34300.35it/s] 76%|███████▌  | 69841/92414 [00:01<00:00, 37497.05it/s] 81%|████████  | 74863/92414 [00:01<00:00, 40620.48it/s] 87%|████████▋ | 79941/92414 [00:02<00:00, 43255.73it/s] 92%|█████████▏| 85079/92414 [00:02<00:00, 45453.11it/s] 98%|█████████▊| 90166/92414 [00:02<00:00, 46960.53it/s]100%|██████████| 92414/92414 [00:02<00:00, 40208.71it/s]
[32m2025-02-05 05:07:08.858[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/209 [00:00<?, ?it/s]  0%|          | 1/209 [00:00<00:36,  5.69it/s]  1%|          | 2/209 [00:00<00:36,  5.72it/s]  1%|▏         | 3/209 [00:00<00:35,  5.73it/s]  2%|▏         | 4/209 [00:00<00:35,  5.71it/s]  2%|▏         | 5/209 [00:00<00:35,  5.68it/s]  3%|▎         | 6/209 [00:01<00:35,  5.67it/s]  3%|▎         | 7/209 [00:01<00:35,  5.68it/s]  4%|▍         | 8/209 [00:01<00:35,  5.70it/s]  4%|▍         | 9/209 [00:01<00:35,  5.67it/s]  5%|▍         | 10/209 [00:01<00:35,  5.68it/s]  5%|▌         | 11/209 [00:01<00:34,  5.66it/s]  6%|▌         | 12/209 [00:02<00:34,  5.65it/s]  6%|▌         | 13/209 [00:02<00:34,  5.67it/s]  7%|▋         | 14/209 [00:02<00:34,  5.61it/s]  7%|▋         | 15/209 [00:02<00:34,  5.60it/s]  8%|▊         | 16/209 [00:02<00:34,  5.64it/s]  8%|▊         | 17/209 [00:03<00:33,  5.66it/s]  9%|▊         | 18/209 [00:03<00:33,  5.68it/s]  9%|▉         | 19/209 [00:03<00:33,  5.69it/s] 10%|▉         | 20/209 [00:03<00:33,  5.70it/s] 10%|█         | 21/209 [00:03<00:33,  5.68it/s] 11%|█         | 22/209 [00:03<00:32,  5.70it/s] 11%|█         | 23/209 [00:04<00:32,  5.70it/s] 11%|█▏        | 24/209 [00:04<00:32,  5.70it/s] 12%|█▏        | 25/209 [00:04<00:32,  5.70it/s] 12%|█▏        | 26/209 [00:04<00:32,  5.71it/s] 13%|█▎        | 27/209 [00:04<00:31,  5.72it/s] 13%|█▎        | 28/209 [00:04<00:31,  5.72it/s] 14%|█▍        | 29/209 [00:05<00:31,  5.68it/s] 14%|█▍        | 30/209 [00:05<00:31,  5.67it/s] 15%|█▍        | 31/209 [00:05<00:31,  5.66it/s] 15%|█▌        | 32/209 [00:05<00:31,  5.66it/s] 16%|█▌        | 33/209 [00:05<00:31,  5.66it/s] 16%|█▋        | 34/209 [00:05<00:30,  5.69it/s] 17%|█▋        | 35/209 [00:06<00:30,  5.67it/s] 17%|█▋        | 36/209 [00:06<00:30,  5.68it/s] 18%|█▊        | 37/209 [00:06<00:30,  5.65it/s] 18%|█▊        | 38/209 [00:06<00:30,  5.64it/s] 19%|█▊        | 39/209 [00:06<00:30,  5.65it/s] 19%|█▉        | 40/209 [00:07<00:29,  5.63it/s] 20%|█▉        | 41/209 [00:07<00:29,  5.62it/s] 20%|██        | 42/209 [00:07<00:29,  5.64it/s] 21%|██        | 43/209 [00:07<00:29,  5.65it/s] 21%|██        | 44/209 [00:07<00:29,  5.68it/s] 22%|██▏       | 45/209 [00:07<00:28,  5.68it/s] 22%|██▏       | 46/209 [00:08<00:28,  5.63it/s] 22%|██▏       | 47/209 [00:08<00:28,  5.65it/s] 23%|██▎       | 48/209 [00:08<00:28,  5.66it/s] 23%|██▎       | 49/209 [00:08<00:28,  5.67it/s] 24%|██▍       | 50/209 [00:08<00:28,  5.67it/s] 24%|██▍       | 51/209 [00:08<00:27,  5.67it/s] 25%|██▍       | 52/209 [00:09<00:27,  5.69it/s] 25%|██▌       | 53/209 [00:09<00:27,  5.69it/s] 26%|██▌       | 54/209 [00:09<00:27,  5.68it/s] 26%|██▋       | 55/209 [00:09<00:26,  5.71it/s] 27%|██▋       | 56/209 [00:09<00:26,  5.71it/s] 27%|██▋       | 57/209 [00:10<00:26,  5.69it/s] 28%|██▊       | 58/209 [00:10<00:26,  5.71it/s] 28%|██▊       | 59/209 [00:10<00:26,  5.70it/s] 29%|██▊       | 60/209 [00:10<00:26,  5.68it/s] 29%|██▉       | 61/209 [00:10<00:26,  5.66it/s] 30%|██▉       | 62/209 [00:10<00:25,  5.68it/s] 30%|███       | 63/209 [00:11<00:25,  5.65it/s] 31%|███       | 64/209 [00:11<00:25,  5.65it/s] 31%|███       | 65/209 [00:11<00:25,  5.69it/s] 32%|███▏      | 66/209 [00:11<00:25,  5.69it/s] 32%|███▏      | 67/209 [00:11<00:25,  5.65it/s] 33%|███▎      | 68/209 [00:11<00:24,  5.68it/s] 33%|███▎      | 69/209 [00:12<00:24,  5.69it/s] 33%|███▎      | 70/209 [00:12<00:24,  5.71it/s] 34%|███▍      | 71/209 [00:12<00:24,  5.69it/s] 34%|███▍      | 72/209 [00:12<00:24,  5.70it/s] 35%|███▍      | 73/209 [00:12<00:23,  5.70it/s] 35%|███▌      | 74/209 [00:13<00:23,  5.70it/s] 36%|███▌      | 75/209 [00:13<00:23,  5.71it/s] 36%|███▋      | 76/209 [00:13<00:23,  5.70it/s] 37%|███▋      | 77/209 [00:13<00:23,  5.72it/s] 37%|███▋      | 78/209 [00:13<00:23,  5.63it/s] 38%|███▊      | 79/209 [00:13<00:23,  5.65it/s] 38%|███▊      | 80/209 [00:14<00:22,  5.63it/s] 39%|███▉      | 81/209 [00:14<00:22,  5.66it/s] 39%|███▉      | 82/209 [00:14<00:22,  5.69it/s] 40%|███▉      | 83/209 [00:14<00:22,  5.67it/s] 40%|████      | 84/209 [00:14<00:22,  5.68it/s] 41%|████      | 85/209 [00:14<00:21,  5.67it/s] 41%|████      | 86/209 [00:15<00:21,  5.67it/s] 42%|████▏     | 87/209 [00:15<00:21,  5.60it/s] 42%|████▏     | 88/209 [00:15<00:21,  5.63it/s] 43%|████▎     | 89/209 [00:15<00:21,  5.62it/s] 43%|████▎     | 90/209 [00:15<00:21,  5.65it/s] 44%|████▎     | 91/209 [00:16<00:20,  5.63it/s] 44%|████▍     | 92/209 [00:16<00:20,  5.63it/s] 44%|████▍     | 93/209 [00:16<00:20,  5.64it/s] 45%|████▍     | 94/209 [00:16<00:20,  5.65it/s] 45%|████▌     | 95/209 [00:16<00:20,  5.67it/s] 46%|████▌     | 96/209 [00:16<00:19,  5.68it/s] 46%|████▋     | 97/209 [00:17<00:19,  5.70it/s] 47%|████▋     | 98/209 [00:17<00:19,  5.72it/s] 47%|████▋     | 99/209 [00:17<00:19,  5.73it/s] 48%|████▊     | 100/209 [00:17<00:19,  5.71it/s] 48%|████▊     | 101/209 [00:17<00:18,  5.70it/s] 49%|████▉     | 102/209 [00:17<00:18,  5.70it/s] 49%|████▉     | 103/209 [00:18<00:18,  5.72it/s] 50%|████▉     | 104/209 [00:18<00:18,  5.70it/s] 50%|█████     | 105/209 [00:18<00:18,  5.70it/s] 51%|█████     | 106/209 [00:18<00:18,  5.64it/s] 51%|█████     | 107/209 [00:18<00:18,  5.66it/s] 52%|█████▏    | 108/209 [00:19<00:17,  5.69it/s] 52%|█████▏    | 109/209 [00:19<00:17,  5.70it/s] 53%|█████▎    | 110/209 [00:19<00:17,  5.62it/s] 53%|█████▎    | 111/209 [00:19<00:17,  5.62it/s] 54%|█████▎    | 112/209 [00:19<00:17,  5.64it/s] 54%|█████▍    | 113/209 [00:19<00:16,  5.69it/s] 55%|█████▍    | 114/209 [00:20<00:16,  5.67it/s] 55%|█████▌    | 115/209 [00:20<00:16,  5.67it/s] 56%|█████▌    | 116/209 [00:20<00:16,  5.68it/s] 56%|█████▌    | 117/209 [00:20<00:16,  5.67it/s] 56%|█████▋    | 118/209 [00:20<00:16,  5.62it/s] 57%|█████▋    | 119/209 [00:20<00:15,  5.63it/s] 57%|█████▋    | 120/209 [00:21<00:15,  5.65it/s] 58%|█████▊    | 121/209 [00:21<00:15,  5.66it/s] 58%|█████▊    | 122/209 [00:21<00:15,  5.66it/s] 59%|█████▉    | 123/209 [00:21<00:15,  5.68it/s] 59%|█████▉    | 124/209 [00:21<00:14,  5.68it/s] 60%|█████▉    | 125/209 [00:22<00:14,  5.66it/s] 60%|██████    | 126/209 [00:22<00:14,  5.68it/s] 61%|██████    | 127/209 [00:22<00:14,  5.68it/s] 61%|██████    | 128/209 [00:22<00:14,  5.65it/s] 62%|██████▏   | 129/209 [00:22<00:14,  5.67it/s] 62%|██████▏   | 130/209 [00:22<00:13,  5.69it/s] 63%|██████▎   | 131/209 [00:23<00:13,  5.71it/s] 63%|██████▎   | 132/209 [00:23<00:13,  5.69it/s] 64%|██████▎   | 133/209 [00:23<00:13,  5.70it/s] 64%|██████▍   | 134/209 [00:23<00:13,  5.67it/s] 65%|██████▍   | 135/209 [00:23<00:12,  5.69it/s] 65%|██████▌   | 136/209 [00:23<00:12,  5.70it/s] 66%|██████▌   | 137/209 [00:24<00:12,  5.71it/s] 66%|██████▌   | 138/209 [00:24<00:12,  5.72it/s] 67%|██████▋   | 139/209 [00:24<00:12,  5.69it/s] 67%|██████▋   | 140/209 [00:24<00:12,  5.68it/s] 67%|██████▋   | 141/209 [00:24<00:11,  5.69it/s] 68%|██████▊   | 142/209 [00:25<00:11,  5.67it/s] 68%|██████▊   | 143/209 [00:25<00:11,  5.65it/s] 69%|██████▉   | 144/209 [00:25<00:11,  5.66it/s] 69%|██████▉   | 145/209 [00:25<00:11,  5.67it/s] 70%|██████▉   | 146/209 [00:25<00:11,  5.67it/s] 70%|███████   | 147/209 [00:25<00:10,  5.68it/s] 71%|███████   | 148/209 [00:26<00:10,  5.68it/s] 71%|███████▏  | 149/209 [00:26<00:10,  5.67it/s] 72%|███████▏  | 150/209 [00:26<00:10,  5.64it/s] 72%|███████▏  | 151/209 [00:26<00:10,  5.67it/s] 73%|███████▎  | 152/209 [00:26<00:10,  5.69it/s] 73%|███████▎  | 153/209 [00:26<00:09,  5.67it/s] 74%|███████▎  | 154/209 [00:27<00:09,  5.67it/s] 74%|███████▍  | 155/209 [00:27<00:09,  5.69it/s] 75%|███████▍  | 156/209 [00:27<00:09,  5.70it/s] 75%|███████▌  | 157/209 [00:27<00:09,  5.70it/s] 76%|███████▌  | 158/209 [00:27<00:08,  5.67it/s] 76%|███████▌  | 159/209 [00:28<00:08,  5.62it/s] 77%|███████▋  | 160/209 [00:28<00:08,  5.66it/s] 77%|███████▋  | 161/209 [00:28<00:08,  5.66it/s] 78%|███████▊  | 162/209 [00:28<00:08,  5.67it/s] 78%|███████▊  | 163/209 [00:28<00:08,  5.69it/s] 78%|███████▊  | 164/209 [00:28<00:07,  5.69it/s] 79%|███████▉  | 165/209 [00:29<00:07,  5.70it/s] 79%|███████▉  | 166/209 [00:29<00:07,  5.71it/s] 80%|███████▉  | 167/209 [00:29<00:07,  5.70it/s] 80%|████████  | 168/209 [00:29<00:07,  5.73it/s] 81%|████████  | 169/209 [00:29<00:07,  5.69it/s] 81%|████████▏ | 170/209 [00:29<00:06,  5.72it/s] 82%|████████▏ | 171/209 [00:30<00:06,  5.71it/s] 82%|████████▏ | 172/209 [00:30<00:06,  5.71it/s] 83%|████████▎ | 173/209 [00:30<00:06,  5.64it/s] 83%|████████▎ | 174/209 [00:30<00:06,  5.68it/s] 84%|████████▎ | 175/209 [00:30<00:06,  5.66it/s] 84%|████████▍ | 176/209 [00:31<00:05,  5.66it/s] 85%|████████▍ | 177/209 [00:31<00:05,  5.67it/s] 85%|████████▌ | 178/209 [00:31<00:05,  5.69it/s] 86%|████████▌ | 179/209 [00:31<00:05,  5.68it/s] 86%|████████▌ | 180/209 [00:31<00:05,  5.69it/s] 87%|████████▋ | 181/209 [00:31<00:04,  5.65it/s] 87%|████████▋ | 182/209 [00:32<00:04,  5.69it/s] 88%|████████▊ | 183/209 [00:32<00:04,  5.68it/s] 88%|████████▊ | 184/209 [00:32<00:04,  5.70it/s] 89%|████████▊ | 185/209 [00:32<00:04,  5.69it/s] 89%|████████▉ | 186/209 [00:32<00:04,  5.69it/s] 89%|████████▉ | 187/209 [00:32<00:03,  5.68it/s] 90%|████████▉ | 188/209 [00:33<00:03,  5.68it/s] 90%|█████████ | 189/209 [00:33<00:03,  5.67it/s] 91%|█████████ | 190/209 [00:33<00:03,  5.67it/s] 91%|█████████▏| 191/209 [00:33<00:03,  5.70it/s] 92%|█████████▏| 192/209 [00:33<00:02,  5.68it/s] 92%|█████████▏| 193/209 [00:34<00:02,  5.70it/s] 93%|█████████▎| 194/209 [00:34<00:02,  5.71it/s] 93%|█████████▎| 195/209 [00:34<00:02,  5.68it/s] 94%|█████████▍| 196/209 [00:34<00:02,  5.69it/s] 94%|█████████▍| 197/209 [00:34<00:02,  5.72it/s] 95%|█████████▍| 198/209 [00:34<00:01,  5.71it/s] 95%|█████████▌| 199/209 [00:35<00:01,  5.72it/s] 96%|█████████▌| 200/209 [00:35<00:01,  5.71it/s] 96%|█████████▌| 201/209 [00:35<00:01,  5.71it/s] 97%|█████████▋| 202/209 [00:35<00:01,  5.72it/s] 97%|█████████▋| 203/209 [00:35<00:01,  5.70it/s] 98%|█████████▊| 204/209 [00:35<00:00,  5.70it/s] 98%|█████████▊| 205/209 [00:36<00:00,  5.73it/s] 99%|█████████▊| 206/209 [00:36<00:00,  5.71it/s] 99%|█████████▉| 207/209 [00:36<00:00,  5.68it/s]100%|█████████▉| 208/209 [00:36<00:00,  5.63it/s]100%|██████████| 209/209 [00:36<00:00,  5.82it/s]100%|██████████| 209/209 [00:36<00:00,  5.68it/s]
[32m2025-02-05 05:07:45.716[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    grad norm  info_loss  rec_loss
         15.7      .7027     5.048[0m
[32m2025-02-05 05:07:45.716[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_recommender[0m:[36m136[0m - [1m[Valid][0m
  0%|          | 0/10256 [00:00<?, ?it/s] 48%|████▊     | 4937/10256 [00:00<00:00, 49329.24it/s] 96%|█████████▌| 9870/10256 [00:00<00:00, 47314.92it/s]100%|██████████| 10256/10256 [00:00<00:00, 47344.70it/s]
[32m2025-02-05 05:07:45.933[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/24 [00:00<?, ?it/s] 12%|█▎        | 3/24 [00:00<00:00, 21.17it/s] 25%|██▌       | 6/24 [00:00<00:00, 21.45it/s] 38%|███▊      | 9/24 [00:00<00:00, 20.72it/s] 50%|█████     | 12/24 [00:00<00:00, 20.76it/s] 62%|██████▎   | 15/24 [00:00<00:00, 20.60it/s] 75%|███████▌  | 18/24 [00:00<00:00, 20.28it/s] 88%|████████▊ | 21/24 [00:01<00:00, 20.15it/s]100%|██████████| 24/24 [00:01<00:00, 21.11it/s]100%|██████████| 24/24 [00:01<00:00, 20.80it/s]
[32m2025-02-05 05:07:47.096[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    hit@1  hit@10  hit@50  info_loss  mrr@1  mrr@10  mrr@50  ndcg@1  ndcg@10  ndcg@50  \
   .04452   .2053   .4339      .5941 .04452  .08327  .09437  .04452    .1116    .1625   
    rec_loss  
        7.28[0m
[32m2025-02-05 05:07:47.096[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_recommender[0m:[36m130[0m - [1m[Recommendation epoch 8][0m
[32m2025-02-05 05:07:47.096[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_recommender[0m:[36m131[0m - [1m[Train][0m
  0%|          | 0/92414 [00:00<?, ?it/s]  5%|▌         | 4831/92414 [00:00<00:01, 48284.03it/s] 11%|█         | 9768/92414 [00:00<00:01, 48905.78it/s] 16%|█▌        | 14688/92414 [00:00<00:01, 49036.80it/s] 21%|██▏       | 19643/92414 [00:00<00:01, 49236.41it/s] 27%|██▋       | 24860/92414 [00:00<00:01, 50287.41it/s] 32%|███▏      | 29889/92414 [00:00<00:01, 49467.60it/s] 38%|███▊      | 34972/92414 [00:00<00:01, 49901.19it/s] 43%|████▎     | 39984/92414 [00:00<00:01, 49960.61it/s] 49%|████▊     | 44982/92414 [00:00<00:00, 49771.12it/s] 54%|█████▍    | 50133/92414 [00:01<00:00, 50272.02it/s] 60%|█████▉    | 55162/92414 [00:01<00:00, 49705.46it/s] 65%|██████▌   | 60135/92414 [00:01<00:01, 21077.26it/s] 71%|███████   | 65203/92414 [00:01<00:01, 25638.41it/s] 76%|███████▌  | 70016/92414 [00:01<00:00, 29695.63it/s] 81%|████████  | 74949/92414 [00:01<00:00, 33715.49it/s] 87%|████████▋ | 80000/92414 [00:02<00:00, 37515.86it/s] 92%|█████████▏| 85174/92414 [00:02<00:00, 40989.38it/s] 98%|█████████▊| 90238/92414 [00:02<00:00, 43483.66it/s]100%|██████████| 92414/92414 [00:02<00:00, 40077.96it/s]
[32m2025-02-05 05:07:49.403[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/209 [00:00<?, ?it/s]  0%|          | 1/209 [00:00<00:36,  5.72it/s]  1%|          | 2/209 [00:00<00:36,  5.72it/s]  1%|▏         | 3/209 [00:00<00:36,  5.69it/s]  2%|▏         | 4/209 [00:00<00:36,  5.68it/s]  2%|▏         | 5/209 [00:00<00:36,  5.66it/s]  3%|▎         | 6/209 [00:01<00:35,  5.67it/s]  3%|▎         | 7/209 [00:01<00:35,  5.68it/s]  4%|▍         | 8/209 [00:01<00:35,  5.70it/s]  4%|▍         | 9/209 [00:01<00:35,  5.67it/s]  5%|▍         | 10/209 [00:01<00:35,  5.68it/s]  5%|▌         | 11/209 [00:01<00:34,  5.69it/s]  6%|▌         | 12/209 [00:02<00:34,  5.67it/s]  6%|▌         | 13/209 [00:02<00:34,  5.68it/s]  7%|▋         | 14/209 [00:02<00:34,  5.62it/s]  7%|▋         | 15/209 [00:02<00:34,  5.61it/s]  8%|▊         | 16/209 [00:02<00:34,  5.64it/s]  8%|▊         | 17/209 [00:03<00:33,  5.66it/s]  9%|▊         | 18/209 [00:03<00:33,  5.68it/s]  9%|▉         | 19/209 [00:03<00:33,  5.69it/s] 10%|▉         | 20/209 [00:03<00:33,  5.70it/s] 10%|█         | 21/209 [00:03<00:33,  5.69it/s] 11%|█         | 22/209 [00:03<00:32,  5.70it/s] 11%|█         | 23/209 [00:04<00:32,  5.71it/s] 11%|█▏        | 24/209 [00:04<00:32,  5.70it/s] 12%|█▏        | 25/209 [00:04<00:32,  5.70it/s] 12%|█▏        | 26/209 [00:04<00:32,  5.71it/s] 13%|█▎        | 27/209 [00:04<00:31,  5.72it/s] 13%|█▎        | 28/209 [00:04<00:31,  5.72it/s] 14%|█▍        | 29/209 [00:05<00:31,  5.68it/s] 14%|█▍        | 30/209 [00:05<00:31,  5.67it/s] 15%|█▍        | 31/209 [00:05<00:31,  5.66it/s] 15%|█▌        | 32/209 [00:05<00:31,  5.66it/s] 16%|█▌        | 33/209 [00:05<00:31,  5.66it/s] 16%|█▋        | 34/209 [00:05<00:30,  5.68it/s] 17%|█▋        | 35/209 [00:06<00:30,  5.67it/s] 17%|█▋        | 36/209 [00:06<00:30,  5.67it/s] 18%|█▊        | 37/209 [00:06<00:30,  5.64it/s] 18%|█▊        | 38/209 [00:06<00:30,  5.62it/s] 19%|█▊        | 39/209 [00:06<00:32,  5.27it/s] 19%|█▉        | 40/209 [00:07<00:31,  5.37it/s] 20%|█▉        | 41/209 [00:07<00:31,  5.42it/s] 20%|██        | 42/209 [00:07<00:30,  5.49it/s] 21%|██        | 43/209 [00:07<00:29,  5.54it/s] 21%|██        | 44/209 [00:07<00:29,  5.60it/s] 22%|██▏       | 45/209 [00:07<00:29,  5.62it/s] 22%|██▏       | 46/209 [00:08<00:29,  5.59it/s] 22%|██▏       | 47/209 [00:08<00:28,  5.62it/s] 23%|██▎       | 48/209 [00:08<00:28,  5.64it/s] 23%|██▎       | 49/209 [00:08<00:28,  5.65it/s] 24%|██▍       | 50/209 [00:08<00:28,  5.66it/s] 24%|██▍       | 51/209 [00:09<00:27,  5.70it/s] 25%|██▍       | 52/209 [00:09<00:27,  5.71it/s] 25%|██▌       | 53/209 [00:09<00:27,  5.71it/s] 26%|██▌       | 54/209 [00:09<00:27,  5.69it/s] 26%|██▋       | 55/209 [00:09<00:26,  5.71it/s] 27%|██▋       | 56/209 [00:09<00:26,  5.72it/s] 27%|██▋       | 57/209 [00:10<00:26,  5.69it/s] 28%|██▊       | 58/209 [00:10<00:26,  5.70it/s] 28%|██▊       | 59/209 [00:10<00:26,  5.70it/s] 29%|██▊       | 60/209 [00:10<00:26,  5.68it/s] 29%|██▉       | 61/209 [00:10<00:26,  5.68it/s] 30%|██▉       | 62/209 [00:10<00:25,  5.69it/s] 30%|███       | 63/209 [00:11<00:25,  5.66it/s] 31%|███       | 64/209 [00:11<00:25,  5.66it/s] 31%|███       | 65/209 [00:11<00:25,  5.69it/s] 32%|███▏      | 66/209 [00:11<00:25,  5.70it/s] 32%|███▏      | 67/209 [00:11<00:25,  5.65it/s] 33%|███▎      | 68/209 [00:12<00:24,  5.67it/s] 33%|███▎      | 69/209 [00:12<00:24,  5.69it/s] 33%|███▎      | 70/209 [00:12<00:24,  5.71it/s] 34%|███▍      | 71/209 [00:12<00:24,  5.69it/s] 34%|███▍      | 72/209 [00:12<00:24,  5.70it/s] 35%|███▍      | 73/209 [00:12<00:23,  5.70it/s] 35%|███▌      | 74/209 [00:13<00:23,  5.71it/s] 36%|███▌      | 75/209 [00:13<00:23,  5.71it/s] 36%|███▋      | 76/209 [00:13<00:23,  5.70it/s] 37%|███▋      | 77/209 [00:13<00:23,  5.72it/s] 37%|███▋      | 78/209 [00:13<00:23,  5.63it/s] 38%|███▊      | 79/209 [00:13<00:23,  5.63it/s] 38%|███▊      | 80/209 [00:14<00:23,  5.60it/s] 39%|███▉      | 81/209 [00:14<00:22,  5.65it/s] 39%|███▉      | 82/209 [00:14<00:22,  5.68it/s] 40%|███▉      | 83/209 [00:14<00:22,  5.66it/s] 40%|████      | 84/209 [00:14<00:22,  5.67it/s] 41%|████      | 85/209 [00:15<00:21,  5.66it/s] 41%|████      | 86/209 [00:15<00:21,  5.66it/s] 42%|████▏     | 87/209 [00:15<00:21,  5.59it/s] 42%|████▏     | 88/209 [00:15<00:21,  5.62it/s] 43%|████▎     | 89/209 [00:15<00:21,  5.61it/s] 43%|████▎     | 90/209 [00:15<00:21,  5.65it/s] 44%|████▎     | 91/209 [00:16<00:20,  5.63it/s] 44%|████▍     | 92/209 [00:16<00:20,  5.62it/s] 44%|████▍     | 93/209 [00:16<00:20,  5.63it/s] 45%|████▍     | 94/209 [00:16<00:20,  5.65it/s] 45%|████▌     | 95/209 [00:16<00:20,  5.67it/s] 46%|████▌     | 96/209 [00:16<00:19,  5.68it/s] 46%|████▋     | 97/209 [00:17<00:19,  5.70it/s] 47%|████▋     | 98/209 [00:17<00:19,  5.72it/s] 47%|████▋     | 99/209 [00:17<00:19,  5.73it/s] 48%|████▊     | 100/209 [00:17<00:19,  5.71it/s] 48%|████▊     | 101/209 [00:17<00:18,  5.69it/s] 49%|████▉     | 102/209 [00:18<00:18,  5.70it/s] 49%|████▉     | 103/209 [00:18<00:18,  5.71it/s] 50%|████▉     | 104/209 [00:18<00:18,  5.70it/s] 50%|█████     | 105/209 [00:18<00:18,  5.70it/s] 51%|█████     | 106/209 [00:18<00:18,  5.63it/s] 51%|█████     | 107/209 [00:18<00:18,  5.66it/s] 52%|█████▏    | 108/209 [00:19<00:17,  5.69it/s] 52%|█████▏    | 109/209 [00:19<00:17,  5.70it/s] 53%|█████▎    | 110/209 [00:19<00:17,  5.61it/s] 53%|█████▎    | 111/209 [00:19<00:17,  5.61it/s] 54%|█████▎    | 112/209 [00:19<00:17,  5.64it/s] 54%|█████▍    | 113/209 [00:19<00:16,  5.68it/s] 55%|█████▍    | 114/209 [00:20<00:16,  5.67it/s] 55%|█████▌    | 115/209 [00:20<00:16,  5.69it/s] 56%|█████▌    | 116/209 [00:20<00:16,  5.69it/s] 56%|█████▌    | 117/209 [00:20<00:16,  5.68it/s] 56%|█████▋    | 118/209 [00:20<00:16,  5.63it/s] 57%|█████▋    | 119/209 [00:21<00:15,  5.63it/s] 57%|█████▋    | 120/209 [00:21<00:15,  5.65it/s] 58%|█████▊    | 121/209 [00:21<00:15,  5.66it/s] 58%|█████▊    | 122/209 [00:21<00:15,  5.66it/s] 59%|█████▉    | 123/209 [00:21<00:15,  5.67it/s] 59%|█████▉    | 124/209 [00:21<00:14,  5.68it/s] 60%|█████▉    | 125/209 [00:22<00:14,  5.65it/s] 60%|██████    | 126/209 [00:22<00:14,  5.67it/s] 61%|██████    | 127/209 [00:22<00:14,  5.68it/s] 61%|██████    | 128/209 [00:22<00:14,  5.65it/s] 62%|██████▏   | 129/209 [00:22<00:14,  5.67it/s] 62%|██████▏   | 130/209 [00:22<00:13,  5.69it/s] 63%|██████▎   | 131/209 [00:23<00:13,  5.70it/s] 63%|██████▎   | 132/209 [00:23<00:13,  5.69it/s] 64%|██████▎   | 133/209 [00:23<00:13,  5.70it/s] 64%|██████▍   | 134/209 [00:23<00:13,  5.67it/s] 65%|██████▍   | 135/209 [00:23<00:12,  5.69it/s] 65%|██████▌   | 136/209 [00:24<00:12,  5.70it/s] 66%|██████▌   | 137/209 [00:24<00:12,  5.71it/s] 66%|██████▌   | 138/209 [00:24<00:12,  5.72it/s] 67%|██████▋   | 139/209 [00:24<00:12,  5.68it/s] 67%|██████▋   | 140/209 [00:24<00:12,  5.67it/s] 67%|██████▋   | 141/209 [00:24<00:11,  5.68it/s] 68%|██████▊   | 142/209 [00:25<00:11,  5.66it/s] 68%|██████▊   | 143/209 [00:25<00:11,  5.64it/s] 69%|██████▉   | 144/209 [00:25<00:11,  5.66it/s] 69%|██████▉   | 145/209 [00:25<00:11,  5.66it/s] 70%|██████▉   | 146/209 [00:25<00:11,  5.67it/s] 70%|███████   | 147/209 [00:25<00:10,  5.67it/s] 71%|███████   | 148/209 [00:26<00:10,  5.68it/s] 71%|███████▏  | 149/209 [00:26<00:10,  5.67it/s] 72%|███████▏  | 150/209 [00:26<00:10,  5.63it/s] 72%|███████▏  | 151/209 [00:26<00:10,  5.66it/s] 73%|███████▎  | 152/209 [00:26<00:10,  5.68it/s] 73%|███████▎  | 153/209 [00:27<00:09,  5.67it/s] 74%|███████▎  | 154/209 [00:27<00:09,  5.66it/s] 74%|███████▍  | 155/209 [00:27<00:09,  5.68it/s] 75%|███████▍  | 156/209 [00:27<00:09,  5.70it/s] 75%|███████▌  | 157/209 [00:27<00:09,  5.69it/s] 76%|███████▌  | 158/209 [00:27<00:09,  5.67it/s] 76%|███████▌  | 159/209 [00:28<00:08,  5.62it/s] 77%|███████▋  | 160/209 [00:28<00:08,  5.66it/s] 77%|███████▋  | 161/209 [00:28<00:08,  5.66it/s] 78%|███████▊  | 162/209 [00:28<00:08,  5.67it/s] 78%|███████▊  | 163/209 [00:28<00:08,  5.69it/s] 78%|███████▊  | 164/209 [00:28<00:07,  5.68it/s] 79%|███████▉  | 165/209 [00:29<00:07,  5.69it/s] 79%|███████▉  | 166/209 [00:29<00:07,  5.70it/s] 80%|███████▉  | 167/209 [00:29<00:07,  5.70it/s] 80%|████████  | 168/209 [00:29<00:07,  5.72it/s] 81%|████████  | 169/209 [00:29<00:07,  5.69it/s] 81%|████████▏ | 170/209 [00:30<00:06,  5.71it/s] 82%|████████▏ | 171/209 [00:30<00:06,  5.68it/s] 82%|████████▏ | 172/209 [00:30<00:06,  5.68it/s] 83%|████████▎ | 173/209 [00:30<00:06,  5.63it/s] 83%|████████▎ | 174/209 [00:30<00:06,  5.66it/s] 84%|████████▎ | 175/209 [00:30<00:06,  5.65it/s] 84%|████████▍ | 176/209 [00:31<00:05,  5.66it/s] 85%|████████▍ | 177/209 [00:31<00:05,  5.67it/s] 85%|████████▌ | 178/209 [00:31<00:05,  5.69it/s] 86%|████████▌ | 179/209 [00:31<00:05,  5.68it/s] 86%|████████▌ | 180/209 [00:31<00:05,  5.69it/s] 87%|████████▋ | 181/209 [00:31<00:04,  5.65it/s] 87%|████████▋ | 182/209 [00:32<00:04,  5.68it/s] 88%|████████▊ | 183/209 [00:32<00:04,  5.67it/s] 88%|████████▊ | 184/209 [00:32<00:04,  5.70it/s] 89%|████████▊ | 185/209 [00:32<00:04,  5.69it/s] 89%|████████▉ | 186/209 [00:32<00:04,  5.69it/s] 89%|████████▉ | 187/209 [00:33<00:03,  5.68it/s] 90%|████████▉ | 188/209 [00:33<00:03,  5.68it/s] 90%|█████████ | 189/209 [00:33<00:03,  5.67it/s] 91%|█████████ | 190/209 [00:33<00:03,  5.68it/s] 91%|█████████▏| 191/209 [00:33<00:03,  5.70it/s] 92%|█████████▏| 192/209 [00:33<00:02,  5.70it/s] 92%|█████████▏| 193/209 [00:34<00:02,  5.71it/s] 93%|█████████▎| 194/209 [00:34<00:02,  5.71it/s] 93%|█████████▎| 195/209 [00:34<00:02,  5.69it/s] 94%|█████████▍| 196/209 [00:34<00:02,  5.70it/s] 94%|█████████▍| 197/209 [00:34<00:02,  5.72it/s] 95%|█████████▍| 198/209 [00:34<00:01,  5.71it/s] 95%|█████████▌| 199/209 [00:35<00:01,  5.72it/s] 96%|█████████▌| 200/209 [00:35<00:01,  5.70it/s] 96%|█████████▌| 201/209 [00:35<00:01,  5.71it/s] 97%|█████████▋| 202/209 [00:35<00:01,  5.72it/s] 97%|█████████▋| 203/209 [00:35<00:01,  5.70it/s] 98%|█████████▊| 204/209 [00:35<00:00,  5.70it/s] 98%|█████████▊| 205/209 [00:36<00:00,  5.73it/s] 99%|█████████▊| 206/209 [00:36<00:00,  5.71it/s] 99%|█████████▉| 207/209 [00:36<00:00,  5.71it/s]100%|█████████▉| 208/209 [00:36<00:00,  5.65it/s]100%|██████████| 209/209 [00:36<00:00,  5.84it/s]100%|██████████| 209/209 [00:36<00:00,  5.67it/s]
[32m2025-02-05 05:08:26.310[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    grad norm  info_loss  rec_loss
        25.94      1.192     4.953[0m
[32m2025-02-05 05:08:26.310[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_recommender[0m:[36m136[0m - [1m[Valid][0m
  0%|          | 0/10256 [00:00<?, ?it/s] 49%|████▊     | 4992/10256 [00:00<00:00, 49861.92it/s] 97%|█████████▋| 9979/10256 [00:00<00:00, 47080.50it/s]100%|██████████| 10256/10256 [00:00<00:00, 47128.25it/s]
[32m2025-02-05 05:08:26.528[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/24 [00:00<?, ?it/s] 12%|█▎        | 3/24 [00:00<00:00, 21.19it/s] 25%|██▌       | 6/24 [00:00<00:00, 21.42it/s] 38%|███▊      | 9/24 [00:00<00:00, 20.93it/s] 50%|█████     | 12/24 [00:00<00:00, 20.75it/s] 62%|██████▎   | 15/24 [00:00<00:00, 20.94it/s] 75%|███████▌  | 18/24 [00:00<00:00, 20.62it/s] 88%|████████▊ | 21/24 [00:01<00:00, 20.85it/s]100%|██████████| 24/24 [00:01<00:00, 21.47it/s]100%|██████████| 24/24 [00:01<00:00, 21.11it/s]
[32m2025-02-05 05:08:27.675[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    hit@1  hit@10  hit@50  info_loss  mrr@1  mrr@10  mrr@50  ndcg@1  ndcg@10  ndcg@50  \
   .04319   .2056   .4355      .8837 .04319   .0828  .09383  .04319    .1114    .1623   
    rec_loss  
        7.35[0m
[32m2025-02-05 05:08:27.675[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_recommender[0m:[36m147[0m - [1m[Test][0m
  0%|          | 0/14362 [00:00<?, ?it/s] 38%|███▊      | 5414/14362 [00:00<00:00, 54097.10it/s] 75%|███████▌  | 10824/14362 [00:00<00:00, 53570.24it/s]100%|██████████| 14362/14362 [00:00<00:00, 50356.02it/s]
[32m2025-02-05 05:08:27.961[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/32 [00:00<?, ?it/s]  9%|▉         | 3/32 [00:00<00:01, 20.39it/s] 19%|█▉        | 6/32 [00:00<00:01, 20.93it/s] 28%|██▊       | 9/32 [00:00<00:01, 20.99it/s] 38%|███▊      | 12/32 [00:00<00:00, 20.82it/s] 47%|████▋     | 15/32 [00:00<00:00, 20.60it/s] 56%|█████▋    | 18/32 [00:00<00:00, 20.86it/s] 66%|██████▌   | 21/32 [00:01<00:00, 20.85it/s] 75%|███████▌  | 24/32 [00:01<00:00, 20.84it/s] 84%|████████▍ | 27/32 [00:01<00:00, 20.96it/s] 94%|█████████▍| 30/32 [00:01<00:00, 21.16it/s]100%|██████████| 32/32 [00:01<00:00, 21.27it/s]
[32m2025-02-05 05:08:29.478[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    hit@1  hit@10  hit@50  info_loss  mrr@1  mrr@10  mrr@50  ndcg@1  ndcg@10  ndcg@50  \
   .03248   .1794   .3637      .9491 .03248  .06999  .07881  .03248   .09551    .1364   
    rec_loss  
       8.069[0m
[32m2025-02-05 05:08:29.479[0m | [1mINFO    [0m | [36mcrslab.system.base[0m:[36mbuild_optimizer[0m:[36m142[0m - [1m[Build optimizer: Adam][0m
[32m2025-02-05 05:08:29.479[0m | [1mINFO    [0m | [36mcrslab.system.base[0m:[36mbuild_lr_scheduler[0m:[36m159[0m - [1m[Build scheduler ReduceLROnPlateau][0m
[32m2025-02-05 05:08:29.479[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m163[0m - [1m[Conversation epoch 0][0m
[32m2025-02-05 05:08:29.479[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m164[0m - [1m[Train][0m
  0%|          | 0/92414 [00:00<?, ?it/s]100%|██████████| 92414/92414 [00:00<00:00, 1004947.86it/s]
[32m2025-02-05 05:08:29.572[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/358 [00:00<?, ?it/s]  0%|          | 1/358 [00:00<01:01,  5.81it/s]  1%|          | 3/358 [00:00<00:42,  8.41it/s]  1%|          | 4/358 [00:00<00:39,  8.86it/s]  2%|▏         | 6/358 [00:00<00:37,  9.32it/s]  2%|▏         | 7/358 [00:00<00:37,  9.40it/s]  2%|▏         | 8/358 [00:00<00:36,  9.55it/s]  3%|▎         | 9/358 [00:00<00:36,  9.54it/s]  3%|▎         | 10/358 [00:01<00:36,  9.59it/s]  3%|▎         | 11/358 [00:01<00:36,  9.58it/s]  4%|▎         | 13/358 [00:01<00:35,  9.81it/s]  4%|▍         | 14/358 [00:01<00:35,  9.76it/s]  4%|▍         | 15/358 [00:01<00:35,  9.71it/s]  4%|▍         | 16/358 [00:01<00:35,  9.66it/s]  5%|▍         | 17/358 [00:01<00:35,  9.69it/s]  5%|▌         | 18/358 [00:01<00:34,  9.77it/s]  5%|▌         | 19/358 [00:02<00:34,  9.71it/s]  6%|▌         | 20/358 [00:02<00:35,  9.66it/s]  6%|▌         | 21/358 [00:02<00:35,  9.59it/s]  6%|▌         | 22/358 [00:02<00:34,  9.66it/s]  7%|▋         | 24/358 [00:02<00:34,  9.77it/s]  7%|▋         | 25/358 [00:02<00:34,  9.72it/s]  7%|▋         | 26/358 [00:02<00:34,  9.67it/s]  8%|▊         | 27/358 [00:02<00:34,  9.72it/s]  8%|▊         | 28/358 [00:02<00:34,  9.68it/s]  8%|▊         | 29/358 [00:03<00:34,  9.64it/s]  9%|▊         | 31/358 [00:03<00:33,  9.74it/s]  9%|▉         | 32/358 [00:03<00:33,  9.74it/s]  9%|▉         | 34/358 [00:03<00:32,  9.84it/s] 10%|█         | 36/358 [00:03<00:32,  9.84it/s] 10%|█         | 37/358 [00:03<00:32,  9.83it/s] 11%|█         | 38/358 [00:03<00:32,  9.78it/s] 11%|█         | 40/358 [00:04<00:31,  9.94it/s] 11%|█▏        | 41/358 [00:04<00:32,  9.86it/s] 12%|█▏        | 43/358 [00:04<00:31,  9.88it/s] 13%|█▎        | 45/358 [00:04<00:31,  9.98it/s] 13%|█▎        | 47/358 [00:04<00:31,  9.95it/s] 13%|█▎        | 48/358 [00:04<00:31,  9.94it/s] 14%|█▍        | 50/358 [00:05<00:31,  9.91it/s] 14%|█▍        | 51/358 [00:05<00:31,  9.84it/s] 15%|█▍        | 52/358 [00:05<00:31,  9.74it/s] 15%|█▍        | 53/358 [00:05<00:31,  9.69it/s] 15%|█▌        | 54/358 [00:05<00:31,  9.73it/s] 15%|█▌        | 55/358 [00:05<00:31,  9.68it/s] 16%|█▌        | 56/358 [00:05<00:31,  9.72it/s] 16%|█▌        | 57/358 [00:05<00:31,  9.68it/s] 16%|█▌        | 58/358 [00:05<00:31,  9.66it/s] 16%|█▋        | 59/358 [00:06<00:31,  9.63it/s] 17%|█▋        | 61/358 [00:06<00:30,  9.72it/s] 17%|█▋        | 62/358 [00:06<00:30,  9.64it/s] 18%|█▊        | 63/358 [00:06<00:30,  9.71it/s] 18%|█▊        | 64/358 [00:06<00:30,  9.65it/s] 18%|█▊        | 66/358 [00:06<00:30,  9.72it/s] 19%|█▊        | 67/358 [00:06<00:29,  9.71it/s] 19%|█▉        | 69/358 [00:07<00:29,  9.77it/s] 20%|█▉        | 70/358 [00:07<00:29,  9.71it/s] 20%|█▉        | 71/358 [00:07<00:29,  9.76it/s] 20%|██        | 72/358 [00:07<00:29,  9.71it/s] 20%|██        | 73/358 [00:07<00:29,  9.68it/s] 21%|██        | 74/358 [00:07<00:29,  9.64it/s] 21%|██        | 75/358 [00:07<00:29,  9.61it/s] 21%|██        | 76/358 [00:07<00:29,  9.71it/s] 22%|██▏       | 77/358 [00:07<00:29,  9.68it/s] 22%|██▏       | 79/358 [00:08<00:28,  9.69it/s] 23%|██▎       | 81/358 [00:08<00:28,  9.75it/s] 23%|██▎       | 83/358 [00:08<00:28,  9.77it/s] 23%|██▎       | 84/358 [00:08<00:28,  9.72it/s] 24%|██▎       | 85/358 [00:08<00:28,  9.67it/s] 24%|██▍       | 86/358 [00:08<00:28,  9.66it/s] 24%|██▍       | 87/358 [00:08<00:28,  9.64it/s] 25%|██▍       | 88/358 [00:09<00:27,  9.66it/s] 25%|██▌       | 90/358 [00:09<00:27,  9.89it/s] 26%|██▌       | 92/358 [00:09<00:26, 10.00it/s] 26%|██▌       | 93/358 [00:09<00:26,  9.96it/s] 26%|██▋       | 94/358 [00:09<00:26,  9.87it/s] 27%|██▋       | 96/358 [00:09<00:25, 10.15it/s] 27%|██▋       | 98/358 [00:10<00:25, 10.04it/s] 28%|██▊       | 99/358 [00:10<00:26,  9.95it/s] 28%|██▊       | 101/358 [00:10<00:25,  9.92it/s] 29%|██▉       | 103/358 [00:10<00:25,  9.90it/s] 29%|██▉       | 104/358 [00:10<00:25,  9.86it/s] 29%|██▉       | 105/358 [00:10<00:25,  9.78it/s] 30%|██▉       | 106/358 [00:10<00:25,  9.77it/s] 30%|███       | 108/358 [00:11<00:25,  9.79it/s] 30%|███       | 109/358 [00:11<00:25,  9.71it/s] 31%|███       | 110/358 [00:11<00:25,  9.69it/s] 31%|███       | 111/358 [00:11<00:25,  9.64it/s] 32%|███▏      | 113/358 [00:11<00:24,  9.91it/s] 32%|███▏      | 114/358 [00:11<00:24,  9.87it/s] 32%|███▏      | 115/358 [00:11<00:24,  9.77it/s] 32%|███▏      | 116/358 [00:11<00:24,  9.69it/s] 33%|███▎      | 117/358 [00:12<00:24,  9.66it/s] 33%|███▎      | 119/358 [00:12<00:24,  9.78it/s] 34%|███▍      | 121/358 [00:12<00:23,  9.98it/s] 34%|███▍      | 123/358 [00:12<00:23, 10.08it/s] 35%|███▍      | 125/358 [00:12<00:23, 10.05it/s] 35%|███▌      | 127/358 [00:13<00:23,  9.98it/s] 36%|███▌      | 128/358 [00:13<00:23,  9.94it/s] 36%|███▋      | 130/358 [00:13<00:22,  9.98it/s] 37%|███▋      | 131/358 [00:13<00:22,  9.89it/s] 37%|███▋      | 132/358 [00:13<00:22,  9.91it/s] 37%|███▋      | 134/358 [00:13<00:22,  9.93it/s] 38%|███▊      | 135/358 [00:13<00:22,  9.87it/s] 38%|███▊      | 137/358 [00:14<00:22,  9.96it/s] 39%|███▊      | 138/358 [00:14<00:22,  9.94it/s] 39%|███▉      | 139/358 [00:14<00:22,  9.86it/s] 39%|███▉      | 141/358 [00:14<00:21,  9.98it/s] 40%|███▉      | 142/358 [00:14<00:21,  9.90it/s] 40%|███▉      | 143/358 [00:14<00:21,  9.87it/s] 40%|████      | 144/358 [00:14<00:21,  9.78it/s] 41%|████      | 145/358 [00:14<00:21,  9.80it/s] 41%|████      | 146/358 [00:14<00:21,  9.74it/s] 41%|████      | 147/358 [00:15<00:21,  9.68it/s] 41%|████▏     | 148/358 [00:15<00:21,  9.71it/s] 42%|████▏     | 149/358 [00:15<00:21,  9.69it/s] 42%|████▏     | 150/358 [00:15<00:21,  9.65it/s] 42%|████▏     | 151/358 [00:15<00:22,  9.39it/s] 42%|████▏     | 152/358 [00:15<00:21,  9.44it/s] 43%|████▎     | 153/358 [00:15<00:21,  9.45it/s] 43%|████▎     | 154/358 [00:15<00:21,  9.54it/s] 43%|████▎     | 155/358 [00:15<00:21,  9.56it/s] 44%|████▎     | 156/358 [00:16<00:20,  9.68it/s] 44%|████▍     | 157/358 [00:16<00:20,  9.62it/s] 44%|████▍     | 158/358 [00:16<00:20,  9.71it/s] 44%|████▍     | 159/358 [00:16<00:20,  9.70it/s] 45%|████▍     | 160/358 [00:16<00:20,  9.71it/s] 45%|████▌     | 162/358 [00:16<00:19, 10.01it/s] 46%|████▌     | 164/358 [00:16<00:19, 10.00it/s] 46%|████▌     | 165/358 [00:16<00:19,  9.96it/s] 47%|████▋     | 167/358 [00:17<00:19,  9.91it/s] 47%|████▋     | 169/358 [00:17<00:18,  9.95it/s] 48%|████▊     | 171/358 [00:17<00:18,  9.93it/s] 48%|████▊     | 172/358 [00:17<00:18,  9.88it/s] 48%|████▊     | 173/358 [00:17<00:18,  9.81it/s] 49%|████▉     | 175/358 [00:17<00:18,  9.84it/s] 49%|████▉     | 176/358 [00:18<00:18,  9.85it/s] 49%|████▉     | 177/358 [00:18<00:18,  9.84it/s] 50%|█████     | 179/358 [00:18<00:18,  9.86it/s] 50%|█████     | 180/358 [00:18<00:18,  9.79it/s] 51%|█████     | 182/358 [00:18<00:17,  9.94it/s] 51%|█████     | 183/358 [00:18<00:17,  9.90it/s] 51%|█████▏    | 184/358 [00:18<00:17,  9.78it/s] 52%|█████▏    | 185/358 [00:18<00:17,  9.73it/s] 52%|█████▏    | 187/358 [00:19<00:17,  9.94it/s] 53%|█████▎    | 188/358 [00:19<00:17,  9.89it/s] 53%|█████▎    | 189/358 [00:19<00:17,  9.83it/s] 53%|█████▎    | 190/358 [00:19<00:17,  9.87it/s] 53%|█████▎    | 191/358 [00:19<00:17,  9.71it/s] 54%|█████▎    | 192/358 [00:19<00:17,  9.65it/s] 54%|█████▍    | 193/358 [00:19<00:17,  9.66it/s] 54%|█████▍    | 194/358 [00:19<00:17,  9.65it/s] 54%|█████▍    | 195/358 [00:19<00:16,  9.73it/s] 55%|█████▌    | 197/358 [00:20<00:16,  9.92it/s] 55%|█████▌    | 198/358 [00:20<00:16,  9.84it/s] 56%|█████▌    | 199/358 [00:20<00:16,  9.87it/s] 56%|█████▌    | 200/358 [00:20<00:16,  9.80it/s] 56%|█████▌    | 201/358 [00:20<00:16,  9.76it/s] 57%|█████▋    | 203/358 [00:20<00:15,  9.85it/s] 57%|█████▋    | 204/358 [00:20<00:15,  9.75it/s] 57%|█████▋    | 205/358 [00:20<00:15,  9.70it/s] 58%|█████▊    | 207/358 [00:21<00:15,  9.82it/s] 58%|█████▊    | 208/358 [00:21<00:15,  9.75it/s] 59%|█████▊    | 210/358 [00:21<00:15,  9.78it/s] 59%|█████▉    | 212/358 [00:21<00:14,  9.79it/s] 60%|█████▉    | 214/358 [00:21<00:14,  9.87it/s] 60%|██████    | 215/358 [00:22<00:14,  9.81it/s] 60%|██████    | 216/358 [00:22<00:14,  9.75it/s] 61%|██████    | 217/358 [00:22<00:14,  9.78it/s] 61%|██████    | 218/358 [00:22<00:14,  9.76it/s] 61%|██████    | 219/358 [00:22<00:14,  9.76it/s] 62%|██████▏   | 221/358 [00:22<00:13,  9.89it/s] 62%|██████▏   | 222/358 [00:22<00:13,  9.79it/s] 62%|██████▏   | 223/358 [00:22<00:13,  9.74it/s] 63%|██████▎   | 224/358 [00:22<00:13,  9.68it/s] 63%|██████▎   | 226/358 [00:23<00:13,  9.73it/s] 64%|██████▎   | 228/358 [00:23<00:13,  9.75it/s] 64%|██████▍   | 229/358 [00:23<00:13,  9.73it/s] 64%|██████▍   | 230/358 [00:23<00:13,  9.68it/s] 65%|██████▍   | 232/358 [00:23<00:12,  9.73it/s] 65%|██████▌   | 234/358 [00:23<00:12, 10.01it/s] 66%|██████▌   | 236/358 [00:24<00:12,  9.97it/s] 66%|██████▋   | 238/358 [00:24<00:11, 10.02it/s] 67%|██████▋   | 240/358 [00:24<00:11,  9.99it/s] 68%|██████▊   | 242/358 [00:24<00:11,  9.97it/s] 68%|██████▊   | 243/358 [00:24<00:11,  9.90it/s] 68%|██████▊   | 244/358 [00:24<00:11,  9.84it/s] 69%|██████▊   | 246/358 [00:25<00:11,  9.86it/s] 69%|██████▉   | 247/358 [00:25<00:11,  9.79it/s] 69%|██████▉   | 248/358 [00:25<00:11,  9.75it/s] 70%|██████▉   | 250/358 [00:25<00:10,  9.84it/s] 70%|███████   | 251/358 [00:25<00:10,  9.78it/s] 70%|███████   | 252/358 [00:25<00:10,  9.72it/s] 71%|███████   | 253/358 [00:25<00:10,  9.68it/s] 71%|███████   | 254/358 [00:25<00:10,  9.65it/s] 72%|███████▏  | 256/358 [00:26<00:10,  9.82it/s] 72%|███████▏  | 257/358 [00:26<00:10,  9.81it/s] 72%|███████▏  | 258/358 [00:26<00:10,  9.68it/s] 72%|███████▏  | 259/358 [00:26<00:10,  9.66it/s] 73%|███████▎  | 260/358 [00:26<00:10,  9.70it/s] 73%|███████▎  | 262/358 [00:26<00:09,  9.88it/s] 74%|███████▎  | 264/358 [00:26<00:09,  9.90it/s] 74%|███████▍  | 266/358 [00:27<00:09,  9.89it/s] 75%|███████▍  | 267/358 [00:27<00:09,  9.83it/s] 75%|███████▌  | 269/358 [00:27<00:09,  9.89it/s] 75%|███████▌  | 270/358 [00:27<00:08,  9.82it/s] 76%|███████▌  | 271/358 [00:27<00:08,  9.75it/s] 76%|███████▌  | 272/358 [00:27<00:08,  9.72it/s] 76%|███████▋  | 273/358 [00:27<00:08,  9.62it/s] 77%|███████▋  | 274/358 [00:28<00:08,  9.62it/s] 77%|███████▋  | 275/358 [00:28<00:08,  9.67it/s] 77%|███████▋  | 276/358 [00:28<00:08,  9.67it/s] 77%|███████▋  | 277/358 [00:28<00:08,  9.64it/s] 78%|███████▊  | 278/358 [00:28<00:08,  9.62it/s] 78%|███████▊  | 280/358 [00:28<00:07,  9.81it/s] 78%|███████▊  | 281/358 [00:28<00:07,  9.82it/s] 79%|███████▉  | 282/358 [00:28<00:07,  9.77it/s] 79%|███████▉  | 283/358 [00:28<00:07,  9.70it/s] 79%|███████▉  | 284/358 [00:29<00:07,  9.66it/s] 80%|███████▉  | 285/358 [00:29<00:07,  9.72it/s] 80%|███████▉  | 286/358 [00:29<00:07,  9.68it/s] 80%|████████  | 287/358 [00:29<00:07,  9.66it/s] 80%|████████  | 288/358 [00:29<00:07,  9.62it/s] 81%|████████  | 290/358 [00:29<00:06,  9.83it/s] 81%|████████▏ | 291/358 [00:29<00:06,  9.82it/s] 82%|████████▏ | 293/358 [00:29<00:06,  9.83it/s] 82%|████████▏ | 295/358 [00:30<00:06,  9.90it/s] 83%|████████▎ | 296/358 [00:30<00:06,  9.84it/s] 83%|████████▎ | 297/358 [00:30<00:06,  9.73it/s] 84%|████████▎ | 299/358 [00:30<00:05,  9.89it/s] 84%|████████▍ | 301/358 [00:30<00:05,  9.92it/s] 84%|████████▍ | 302/358 [00:30<00:05,  9.86it/s] 85%|████████▍ | 303/358 [00:30<00:05,  9.87it/s] 85%|████████▌ | 305/358 [00:31<00:05,  9.89it/s] 85%|████████▌ | 306/358 [00:31<00:05,  9.81it/s] 86%|████████▌ | 308/358 [00:31<00:05,  9.91it/s] 86%|████████▋ | 309/358 [00:31<00:04,  9.81it/s] 87%|████████▋ | 310/358 [00:31<00:04,  9.76it/s] 87%|████████▋ | 311/358 [00:31<00:04,  9.68it/s] 87%|████████▋ | 312/358 [00:31<00:04,  9.70it/s] 87%|████████▋ | 313/358 [00:32<00:04,  9.72it/s] 88%|████████▊ | 315/358 [00:32<00:04,  9.98it/s] 88%|████████▊ | 316/358 [00:32<00:04,  9.93it/s] 89%|████████▊ | 317/358 [00:32<00:04,  9.85it/s] 89%|████████▉ | 318/358 [00:32<00:04,  9.80it/s] 89%|████████▉ | 319/358 [00:32<00:04,  9.75it/s] 89%|████████▉ | 320/358 [00:32<00:03,  9.81it/s] 90%|████████▉ | 321/358 [00:32<00:03,  9.74it/s] 90%|████████▉ | 322/358 [00:32<00:03,  9.70it/s] 90%|█████████ | 323/358 [00:33<00:03,  9.65it/s] 91%|█████████ | 324/358 [00:33<00:03,  9.62it/s] 91%|█████████ | 325/358 [00:33<00:03,  9.60it/s] 91%|█████████▏| 327/358 [00:33<00:03,  9.96it/s] 92%|█████████▏| 329/358 [00:33<00:02, 10.06it/s] 92%|█████████▏| 330/358 [00:33<00:02,  9.95it/s] 93%|█████████▎| 332/358 [00:33<00:02, 10.05it/s] 93%|█████████▎| 334/358 [00:34<00:02,  9.95it/s] 94%|█████████▎| 335/358 [00:34<00:02,  9.83it/s] 94%|█████████▍| 337/358 [00:34<00:02,  9.90it/s] 95%|█████████▍| 339/358 [00:34<00:01, 10.10it/s] 95%|█████████▌| 341/358 [00:34<00:01, 10.05it/s] 96%|█████████▌| 343/358 [00:35<00:01,  9.89it/s] 96%|█████████▌| 344/358 [00:35<00:01,  9.83it/s] 96%|█████████▋| 345/358 [00:35<00:01,  9.85it/s] 97%|█████████▋| 347/358 [00:35<00:01, 10.03it/s] 97%|█████████▋| 348/358 [00:35<00:01,  9.93it/s] 97%|█████████▋| 349/358 [00:35<00:00,  9.85it/s] 98%|█████████▊| 350/358 [00:35<00:00,  9.78it/s] 98%|█████████▊| 351/358 [00:35<00:00,  9.74it/s] 99%|█████████▊| 353/358 [00:36<00:00,  9.92it/s] 99%|█████████▉| 354/358 [00:36<00:00,  9.90it/s] 99%|█████████▉| 355/358 [00:36<00:00,  9.81it/s]100%|█████████▉| 357/358 [00:36<00:00,  9.87it/s]100%|██████████| 358/358 [00:36<00:00,  9.80it/s]
[32m2025-02-05 05:09:06.114[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    gen_loss  grad clip ratio  grad norm   ppl
       5.946                1      98.28 382.3[0m
[32m2025-02-05 05:09:06.114[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m169[0m - [1m[Valid][0m
  0%|          | 0/10256 [00:00<?, ?it/s]100%|██████████| 10256/10256 [00:00<00:00, 920735.91it/s]
[32m2025-02-05 05:09:06.126[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:26,  1.47it/s]  5%|▌         | 2/40 [00:01<00:25,  1.48it/s]  8%|▊         | 3/40 [00:02<00:24,  1.49it/s] 10%|█         | 4/40 [00:02<00:24,  1.50it/s] 12%|█▎        | 5/40 [00:03<00:23,  1.49it/s] 15%|█▌        | 6/40 [00:04<00:22,  1.49it/s] 18%|█▊        | 7/40 [00:04<00:22,  1.49it/s] 20%|██        | 8/40 [00:05<00:21,  1.49it/s] 22%|██▎       | 9/40 [00:06<00:20,  1.50it/s] 25%|██▌       | 10/40 [00:06<00:20,  1.50it/s] 28%|██▊       | 11/40 [00:07<00:19,  1.50it/s] 30%|███       | 12/40 [00:08<00:18,  1.50it/s] 32%|███▎      | 13/40 [00:08<00:18,  1.50it/s] 35%|███▌      | 14/40 [00:09<00:17,  1.49it/s] 38%|███▊      | 15/40 [00:10<00:16,  1.49it/s] 40%|████      | 16/40 [00:10<00:16,  1.49it/s] 42%|████▎     | 17/40 [00:11<00:15,  1.49it/s] 45%|████▌     | 18/40 [00:12<00:14,  1.49it/s] 48%|████▊     | 19/40 [00:12<00:14,  1.49it/s] 50%|█████     | 20/40 [00:13<00:13,  1.49it/s] 52%|█████▎    | 21/40 [00:14<00:12,  1.49it/s] 55%|█████▌    | 22/40 [00:14<00:12,  1.49it/s] 57%|█████▊    | 23/40 [00:15<00:11,  1.49it/s] 60%|██████    | 24/40 [00:16<00:10,  1.48it/s] 62%|██████▎   | 25/40 [00:16<00:10,  1.48it/s] 65%|██████▌   | 26/40 [00:17<00:09,  1.50it/s] 68%|██████▊   | 27/40 [00:18<00:08,  1.49it/s] 70%|███████   | 28/40 [00:18<00:08,  1.49it/s] 72%|███████▎  | 29/40 [00:19<00:07,  1.49it/s] 75%|███████▌  | 30/40 [00:20<00:06,  1.50it/s] 78%|███████▊  | 31/40 [00:20<00:06,  1.49it/s] 80%|████████  | 32/40 [00:21<00:05,  1.49it/s] 82%|████████▎ | 33/40 [00:22<00:04,  1.49it/s] 85%|████████▌ | 34/40 [00:22<00:04,  1.49it/s] 88%|████████▊ | 35/40 [00:23<00:03,  1.49it/s] 90%|█████████ | 36/40 [00:24<00:02,  1.48it/s] 92%|█████████▎| 37/40 [00:24<00:02,  1.48it/s] 95%|█████████▌| 38/40 [00:25<00:01,  1.47it/s] 98%|█████████▊| 39/40 [00:26<00:00,  1.47it/s]100%|██████████| 40/40 [00:26<00:00,  1.63it/s]100%|██████████| 40/40 [00:26<00:00,  1.50it/s]
[32m2025-02-05 05:09:32.796[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    average  bleu@1  bleu@2  bleu@3  bleu@4  dist@1  dist@2  dist@3  dist@4  extreme  \
      .7560   .2674  .07951  .03146  .01507 .005157   .1089   .4373   .7265    .5532   
      f1  gen_loss  greedy  intra_dist@1  intra_dist@2  intra_dist@3  intra_dist@4  \
   .3183     4.263   .6526         .8824         .9788         .9734         .9197   
     ppl  rouge1  rouge2  rougeL  
   71.06   .3615  .06879   .3485[0m
[32m2025-02-05 05:09:32.799[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m163[0m - [1m[Conversation epoch 1][0m
[32m2025-02-05 05:09:32.799[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m164[0m - [1m[Train][0m
  0%|          | 0/92414 [00:00<?, ?it/s]100%|██████████| 92414/92414 [00:00<00:00, 1108718.46it/s]
[32m2025-02-05 05:09:32.883[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/358 [00:00<?, ?it/s]  0%|          | 1/358 [00:00<00:36,  9.77it/s]  1%|          | 3/358 [00:00<00:35,  9.94it/s]  1%|          | 4/358 [00:00<00:35,  9.92it/s]  2%|▏         | 6/358 [00:00<00:35,  9.88it/s]  2%|▏         | 7/358 [00:00<00:35,  9.82it/s]  2%|▏         | 8/358 [00:00<00:35,  9.86it/s]  3%|▎         | 9/358 [00:00<00:35,  9.76it/s]  3%|▎         | 10/358 [00:01<00:35,  9.75it/s]  3%|▎         | 11/358 [00:01<00:35,  9.71it/s]  4%|▎         | 13/358 [00:01<00:34,  9.92it/s]  4%|▍         | 14/358 [00:01<00:34,  9.85it/s]  4%|▍         | 15/358 [00:01<00:35,  9.77it/s]  4%|▍         | 16/358 [00:01<00:35,  9.70it/s]  5%|▍         | 17/358 [00:01<00:35,  9.72it/s]  5%|▌         | 19/358 [00:01<00:34,  9.74it/s]  6%|▌         | 20/358 [00:02<00:34,  9.69it/s]  6%|▌         | 21/358 [00:02<00:35,  9.62it/s]  6%|▌         | 22/358 [00:02<00:34,  9.68it/s]  7%|▋         | 24/358 [00:02<00:34,  9.77it/s]  7%|▋         | 25/358 [00:02<00:34,  9.72it/s]  7%|▋         | 26/358 [00:02<00:34,  9.67it/s]  8%|▊         | 27/358 [00:02<00:34,  9.72it/s]  8%|▊         | 28/358 [00:02<00:34,  9.68it/s]  8%|▊         | 29/358 [00:02<00:34,  9.65it/s]  9%|▊         | 31/358 [00:03<00:33,  9.75it/s]  9%|▉         | 32/358 [00:03<00:33,  9.75it/s]  9%|▉         | 34/358 [00:03<00:32,  9.85it/s] 10%|█         | 36/358 [00:03<00:32,  9.84it/s] 10%|█         | 37/358 [00:03<00:32,  9.82it/s] 11%|█         | 38/358 [00:03<00:32,  9.78it/s] 11%|█         | 40/358 [00:04<00:31,  9.94it/s] 11%|█▏        | 41/358 [00:04<00:32,  9.85it/s] 12%|█▏        | 43/358 [00:04<00:31,  9.88it/s] 13%|█▎        | 45/358 [00:04<00:31,  9.98it/s] 13%|█▎        | 47/358 [00:04<00:31,  9.95it/s] 13%|█▎        | 48/358 [00:04<00:31,  9.94it/s] 14%|█▍        | 50/358 [00:05<00:31,  9.91it/s] 14%|█▍        | 51/358 [00:05<00:31,  9.84it/s] 15%|█▍        | 52/358 [00:05<00:31,  9.75it/s] 15%|█▍        | 53/358 [00:05<00:31,  9.70it/s] 15%|█▌        | 54/358 [00:05<00:31,  9.74it/s] 15%|█▌        | 55/358 [00:05<00:31,  9.69it/s] 16%|█▌        | 56/358 [00:05<00:31,  9.73it/s] 16%|█▌        | 57/358 [00:05<00:31,  9.69it/s] 16%|█▌        | 58/358 [00:05<00:31,  9.67it/s] 16%|█▋        | 59/358 [00:06<00:31,  9.64it/s] 17%|█▋        | 61/358 [00:06<00:30,  9.72it/s] 17%|█▋        | 62/358 [00:06<00:30,  9.64it/s] 18%|█▊        | 63/358 [00:06<00:30,  9.70it/s] 18%|█▊        | 64/358 [00:06<00:30,  9.66it/s] 18%|█▊        | 66/358 [00:06<00:30,  9.73it/s] 19%|█▊        | 67/358 [00:06<00:29,  9.71it/s] 19%|█▉        | 69/358 [00:07<00:29,  9.77it/s] 20%|█▉        | 70/358 [00:07<00:29,  9.72it/s] 20%|█▉        | 71/358 [00:07<00:29,  9.77it/s] 20%|██        | 72/358 [00:07<00:29,  9.71it/s] 20%|██        | 73/358 [00:07<00:29,  9.68it/s] 21%|██        | 74/358 [00:07<00:29,  9.65it/s] 21%|██        | 75/358 [00:07<00:29,  9.62it/s] 21%|██        | 76/358 [00:07<00:29,  9.72it/s] 22%|██▏       | 77/358 [00:07<00:29,  9.68it/s] 22%|██▏       | 79/358 [00:08<00:28,  9.70it/s] 23%|██▎       | 81/358 [00:08<00:28,  9.76it/s] 23%|██▎       | 83/358 [00:08<00:28,  9.78it/s] 23%|██▎       | 84/358 [00:08<00:28,  9.73it/s] 24%|██▎       | 85/358 [00:08<00:28,  9.68it/s] 24%|██▍       | 86/358 [00:08<00:28,  9.67it/s] 24%|██▍       | 87/358 [00:08<00:28,  9.65it/s] 25%|██▍       | 88/358 [00:09<00:27,  9.67it/s] 25%|██▌       | 90/358 [00:09<00:27,  9.91it/s] 26%|██▌       | 92/358 [00:09<00:26, 10.00it/s] 26%|██▌       | 93/358 [00:09<00:26,  9.97it/s] 26%|██▋       | 94/358 [00:09<00:26,  9.88it/s] 27%|██▋       | 96/358 [00:09<00:25, 10.16it/s] 27%|██▋       | 98/358 [00:10<00:25, 10.05it/s] 28%|██▊       | 99/358 [00:10<00:26,  9.96it/s] 28%|██▊       | 101/358 [00:10<00:25,  9.92it/s] 29%|██▉       | 103/358 [00:10<00:25,  9.91it/s] 29%|██▉       | 104/358 [00:10<00:25,  9.86it/s] 29%|██▉       | 105/358 [00:10<00:25,  9.78it/s] 30%|██▉       | 106/358 [00:10<00:25,  9.77it/s] 30%|███       | 108/358 [00:11<00:25,  9.80it/s] 30%|███       | 109/358 [00:11<00:25,  9.71it/s] 31%|███       | 110/358 [00:11<00:25,  9.69it/s] 31%|███       | 111/358 [00:11<00:25,  9.65it/s] 32%|███▏      | 113/358 [00:11<00:24,  9.91it/s] 32%|███▏      | 114/358 [00:11<00:24,  9.87it/s] 32%|███▏      | 115/358 [00:11<00:24,  9.78it/s] 32%|███▏      | 116/358 [00:11<00:24,  9.69it/s] 33%|███▎      | 117/358 [00:11<00:24,  9.66it/s] 33%|███▎      | 119/358 [00:12<00:24,  9.78it/s] 34%|███▍      | 121/358 [00:12<00:23,  9.98it/s] 34%|███▍      | 123/358 [00:12<00:23, 10.08it/s] 35%|███▍      | 125/358 [00:12<00:23, 10.05it/s] 35%|███▌      | 127/358 [00:12<00:23,  9.99it/s] 36%|███▌      | 128/358 [00:13<00:23,  9.95it/s] 36%|███▋      | 130/358 [00:13<00:22,  9.99it/s] 37%|███▋      | 131/358 [00:13<00:22,  9.90it/s] 37%|███▋      | 132/358 [00:13<00:22,  9.92it/s] 37%|███▋      | 134/358 [00:13<00:22,  9.94it/s] 38%|███▊      | 135/358 [00:13<00:22,  9.87it/s] 38%|███▊      | 137/358 [00:13<00:22,  9.96it/s] 39%|███▊      | 138/358 [00:14<00:22,  9.94it/s] 39%|███▉      | 139/358 [00:14<00:22,  9.85it/s] 39%|███▉      | 141/358 [00:14<00:21,  9.97it/s] 40%|███▉      | 142/358 [00:14<00:21,  9.90it/s] 40%|███▉      | 143/358 [00:14<00:21,  9.86it/s] 40%|████      | 144/358 [00:14<00:21,  9.78it/s] 41%|████      | 145/358 [00:14<00:21,  9.80it/s] 41%|████      | 146/358 [00:14<00:21,  9.74it/s] 41%|████      | 147/358 [00:14<00:21,  9.68it/s] 41%|████▏     | 148/358 [00:15<00:21,  9.70it/s] 42%|████▏     | 149/358 [00:15<00:21,  9.69it/s] 42%|████▏     | 150/358 [00:15<00:21,  9.64it/s] 42%|████▏     | 151/358 [00:15<00:22,  9.37it/s] 42%|████▏     | 152/358 [00:15<00:21,  9.42it/s] 43%|████▎     | 153/358 [00:15<00:21,  9.44it/s] 43%|████▎     | 154/358 [00:15<00:21,  9.54it/s] 43%|████▎     | 155/358 [00:15<00:21,  9.55it/s] 44%|████▎     | 156/358 [00:15<00:20,  9.67it/s] 44%|████▍     | 157/358 [00:16<00:20,  9.61it/s] 44%|████▍     | 158/358 [00:16<00:20,  9.70it/s] 44%|████▍     | 159/358 [00:16<00:20,  9.70it/s] 45%|████▍     | 160/358 [00:16<00:20,  9.71it/s] 45%|████▌     | 162/358 [00:16<00:19,  9.98it/s] 46%|████▌     | 164/358 [00:16<00:19,  9.99it/s] 46%|████▌     | 165/358 [00:16<00:19,  9.94it/s] 47%|████▋     | 167/358 [00:17<00:19,  9.89it/s] 47%|████▋     | 169/358 [00:17<00:19,  9.93it/s] 48%|████▊     | 171/358 [00:17<00:18,  9.92it/s] 48%|████▊     | 172/358 [00:17<00:18,  9.87it/s] 48%|████▊     | 173/358 [00:17<00:18,  9.80it/s] 49%|████▉     | 175/358 [00:17<00:18,  9.83it/s] 49%|████▉     | 176/358 [00:17<00:18,  9.84it/s] 49%|████▉     | 177/358 [00:18<00:18,  9.82it/s] 50%|█████     | 179/358 [00:18<00:18,  9.85it/s] 50%|█████     | 180/358 [00:18<00:18,  9.78it/s] 51%|█████     | 182/358 [00:18<00:17,  9.93it/s] 51%|█████     | 183/358 [00:18<00:17,  9.89it/s] 51%|█████▏    | 184/358 [00:18<00:17,  9.77it/s] 52%|█████▏    | 185/358 [00:18<00:17,  9.72it/s] 52%|█████▏    | 187/358 [00:19<00:17,  9.93it/s] 53%|█████▎    | 188/358 [00:19<00:17,  9.88it/s] 53%|█████▎    | 189/358 [00:19<00:17,  9.82it/s] 53%|█████▎    | 190/358 [00:19<00:17,  9.87it/s] 53%|█████▎    | 191/358 [00:19<00:17,  9.70it/s] 54%|█████▎    | 192/358 [00:19<00:17,  9.65it/s] 54%|█████▍    | 193/358 [00:19<00:17,  9.65it/s] 54%|█████▍    | 194/358 [00:19<00:17,  9.64it/s] 54%|█████▍    | 195/358 [00:19<00:16,  9.72it/s] 55%|█████▌    | 197/358 [00:20<00:16,  9.91it/s] 55%|█████▌    | 198/358 [00:20<00:16,  9.83it/s] 56%|█████▌    | 199/358 [00:20<00:16,  9.86it/s] 56%|█████▌    | 200/358 [00:20<00:16,  9.79it/s] 56%|█████▌    | 201/358 [00:20<00:16,  9.75it/s] 57%|█████▋    | 203/358 [00:20<00:15,  9.84it/s] 57%|█████▋    | 204/358 [00:20<00:15,  9.74it/s] 57%|█████▋    | 205/358 [00:20<00:15,  9.70it/s] 58%|█████▊    | 207/358 [00:21<00:15,  9.86it/s] 58%|█████▊    | 208/358 [00:21<00:15,  9.80it/s] 59%|█████▊    | 210/358 [00:21<00:15,  9.81it/s] 59%|█████▉    | 212/358 [00:21<00:14,  9.80it/s] 60%|█████▉    | 214/358 [00:21<00:14,  9.87it/s] 60%|██████    | 215/358 [00:21<00:14,  9.81it/s] 60%|██████    | 216/358 [00:22<00:14,  9.75it/s] 61%|██████    | 217/358 [00:22<00:14,  9.78it/s] 61%|██████    | 218/358 [00:22<00:14,  9.76it/s] 61%|██████    | 219/358 [00:22<00:14,  9.76it/s] 62%|██████▏   | 221/358 [00:22<00:13,  9.89it/s] 62%|██████▏   | 222/358 [00:22<00:13,  9.78it/s] 62%|██████▏   | 223/358 [00:22<00:13,  9.73it/s] 63%|██████▎   | 224/358 [00:22<00:13,  9.67it/s] 63%|██████▎   | 225/358 [00:22<00:13,  9.76it/s] 63%|██████▎   | 226/358 [00:23<00:13,  9.70it/s] 64%|██████▎   | 228/358 [00:23<00:13,  9.74it/s] 64%|██████▍   | 229/358 [00:23<00:13,  9.72it/s] 64%|██████▍   | 230/358 [00:23<00:13,  9.66it/s] 65%|██████▍   | 232/358 [00:23<00:12,  9.71it/s] 65%|██████▌   | 234/358 [00:23<00:12, 10.01it/s] 66%|██████▌   | 236/358 [00:24<00:12,  9.97it/s] 66%|██████▋   | 238/358 [00:24<00:11, 10.03it/s] 67%|██████▋   | 240/358 [00:24<00:11,  9.99it/s] 68%|██████▊   | 242/358 [00:24<00:11,  9.96it/s] 68%|██████▊   | 243/358 [00:24<00:11,  9.90it/s] 68%|██████▊   | 244/358 [00:24<00:11,  9.83it/s] 69%|██████▊   | 246/358 [00:25<00:11,  9.86it/s] 69%|██████▉   | 247/358 [00:25<00:11,  9.79it/s] 69%|██████▉   | 248/358 [00:25<00:11,  9.74it/s] 70%|██████▉   | 250/358 [00:25<00:10,  9.84it/s] 70%|███████   | 251/358 [00:25<00:10,  9.77it/s] 70%|███████   | 252/358 [00:25<00:10,  9.71it/s] 71%|███████   | 253/358 [00:25<00:10,  9.67it/s] 71%|███████   | 254/358 [00:25<00:10,  9.65it/s] 72%|███████▏  | 256/358 [00:26<00:10,  9.82it/s] 72%|███████▏  | 257/358 [00:26<00:10,  9.83it/s] 72%|███████▏  | 258/358 [00:26<00:10,  9.70it/s] 72%|███████▏  | 259/358 [00:26<00:10,  9.67it/s] 73%|███████▎  | 260/358 [00:26<00:10,  9.70it/s] 73%|███████▎  | 262/358 [00:26<00:09,  9.88it/s] 74%|███████▎  | 264/358 [00:26<00:09,  9.90it/s] 74%|███████▍  | 266/358 [00:27<00:09,  9.88it/s] 75%|███████▍  | 267/358 [00:27<00:09,  9.83it/s] 75%|███████▌  | 269/358 [00:27<00:09,  9.89it/s] 75%|███████▌  | 270/358 [00:27<00:08,  9.82it/s] 76%|███████▌  | 271/358 [00:27<00:08,  9.74it/s] 76%|███████▌  | 272/358 [00:27<00:08,  9.72it/s] 76%|███████▋  | 273/358 [00:27<00:08,  9.62it/s] 77%|███████▋  | 274/358 [00:27<00:08,  9.62it/s] 77%|███████▋  | 275/358 [00:28<00:08,  9.67it/s] 77%|███████▋  | 276/358 [00:28<00:08,  9.67it/s] 77%|███████▋  | 277/358 [00:28<00:08,  9.64it/s] 78%|███████▊  | 278/358 [00:28<00:08,  9.61it/s] 78%|███████▊  | 280/358 [00:28<00:07,  9.81it/s] 78%|███████▊  | 281/358 [00:28<00:07,  9.82it/s] 79%|███████▉  | 282/358 [00:28<00:07,  9.76it/s] 79%|███████▉  | 283/358 [00:28<00:07,  9.70it/s] 79%|███████▉  | 284/358 [00:28<00:07,  9.66it/s] 80%|███████▉  | 285/358 [00:29<00:07,  9.73it/s] 80%|███████▉  | 286/358 [00:29<00:07,  9.68it/s] 80%|████████  | 287/358 [00:29<00:07,  9.66it/s] 80%|████████  | 288/358 [00:29<00:07,  9.62it/s] 81%|████████  | 290/358 [00:29<00:06,  9.83it/s] 81%|████████▏ | 291/358 [00:29<00:06,  9.81it/s] 82%|████████▏ | 293/358 [00:29<00:06,  9.82it/s] 82%|████████▏ | 295/358 [00:30<00:06,  9.90it/s] 83%|████████▎ | 296/358 [00:30<00:06,  9.83it/s] 83%|████████▎ | 297/358 [00:30<00:06,  9.72it/s] 84%|████████▎ | 299/358 [00:30<00:05,  9.89it/s] 84%|████████▍ | 301/358 [00:30<00:05,  9.92it/s] 84%|████████▍ | 302/358 [00:30<00:05,  9.86it/s] 85%|████████▍ | 303/358 [00:30<00:05,  9.87it/s] 85%|████████▌ | 305/358 [00:31<00:05,  9.90it/s] 85%|████████▌ | 306/358 [00:31<00:05,  9.82it/s] 86%|████████▌ | 308/358 [00:31<00:05,  9.92it/s] 86%|████████▋ | 309/358 [00:31<00:04,  9.82it/s] 87%|████████▋ | 310/358 [00:31<00:04,  9.76it/s] 87%|████████▋ | 311/358 [00:31<00:04,  9.68it/s] 87%|████████▋ | 312/358 [00:31<00:04,  9.70it/s] 87%|████████▋ | 313/358 [00:31<00:04,  9.72it/s] 88%|████████▊ | 315/358 [00:32<00:04,  9.98it/s] 88%|████████▊ | 316/358 [00:32<00:04,  9.93it/s] 89%|████████▊ | 317/358 [00:32<00:04,  9.84it/s] 89%|████████▉ | 318/358 [00:32<00:04,  9.79it/s] 89%|████████▉ | 319/358 [00:32<00:04,  9.75it/s] 89%|████████▉ | 320/358 [00:32<00:03,  9.80it/s] 90%|████████▉ | 321/358 [00:32<00:03,  9.73it/s] 90%|████████▉ | 322/358 [00:32<00:03,  9.69it/s] 90%|█████████ | 323/358 [00:32<00:03,  9.65it/s] 91%|█████████ | 324/358 [00:33<00:03,  9.62it/s] 91%|█████████ | 325/358 [00:33<00:03,  9.60it/s] 91%|█████████▏| 327/358 [00:33<00:03,  9.96it/s] 92%|█████████▏| 329/358 [00:33<00:02, 10.06it/s] 92%|█████████▏| 330/358 [00:33<00:02,  9.95it/s] 93%|█████████▎| 332/358 [00:33<00:02, 10.05it/s] 93%|█████████▎| 334/358 [00:34<00:02,  9.95it/s] 94%|█████████▎| 335/358 [00:34<00:02,  9.83it/s] 94%|█████████▍| 337/358 [00:34<00:02,  9.91it/s] 95%|█████████▍| 339/358 [00:34<00:01, 10.11it/s] 95%|█████████▌| 341/358 [00:34<00:01, 10.05it/s] 96%|█████████▌| 343/358 [00:34<00:01,  9.89it/s] 96%|█████████▌| 344/358 [00:35<00:01,  9.83it/s] 96%|█████████▋| 345/358 [00:35<00:01,  9.85it/s] 97%|█████████▋| 347/358 [00:35<00:01, 10.03it/s] 97%|█████████▋| 348/358 [00:35<00:01,  9.93it/s] 97%|█████████▋| 349/358 [00:35<00:00,  9.85it/s] 98%|█████████▊| 350/358 [00:35<00:00,  9.78it/s] 98%|█████████▊| 351/358 [00:35<00:00,  9.73it/s] 99%|█████████▊| 353/358 [00:35<00:00,  9.91it/s] 99%|█████████▉| 354/358 [00:36<00:00,  9.90it/s] 99%|█████████▉| 355/358 [00:36<00:00,  9.81it/s]100%|█████████▉| 357/358 [00:36<00:00,  9.86it/s]100%|██████████| 358/358 [00:36<00:00,  9.82it/s]
[32m2025-02-05 05:10:09.355[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    gen_loss  grad clip ratio  grad norm   ppl
       3.977                1      12.28 53.35[0m
[32m2025-02-05 05:10:09.355[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m169[0m - [1m[Valid][0m
  0%|          | 0/10256 [00:00<?, ?it/s]100%|██████████| 10256/10256 [00:00<00:00, 912029.47it/s]
[32m2025-02-05 05:10:09.366[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:26,  1.49it/s]  5%|▌         | 2/40 [00:01<00:25,  1.50it/s]  8%|▊         | 3/40 [00:01<00:24,  1.51it/s] 10%|█         | 4/40 [00:02<00:23,  1.51it/s] 12%|█▎        | 5/40 [00:03<00:23,  1.50it/s] 15%|█▌        | 6/40 [00:03<00:22,  1.50it/s] 18%|█▊        | 7/40 [00:04<00:22,  1.49it/s] 20%|██        | 8/40 [00:05<00:21,  1.50it/s] 22%|██▎       | 9/40 [00:05<00:20,  1.50it/s] 25%|██▌       | 10/40 [00:06<00:19,  1.50it/s] 28%|██▊       | 11/40 [00:07<00:19,  1.50it/s] 30%|███       | 12/40 [00:07<00:18,  1.50it/s] 32%|███▎      | 13/40 [00:08<00:17,  1.50it/s] 35%|███▌      | 14/40 [00:09<00:17,  1.50it/s] 38%|███▊      | 15/40 [00:10<00:16,  1.49it/s] 40%|████      | 16/40 [00:10<00:16,  1.49it/s] 42%|████▎     | 17/40 [00:11<00:15,  1.50it/s] 45%|████▌     | 18/40 [00:11<00:14,  1.50it/s] 48%|████▊     | 19/40 [00:12<00:14,  1.49it/s] 50%|█████     | 20/40 [00:13<00:13,  1.50it/s] 52%|█████▎    | 21/40 [00:13<00:12,  1.50it/s] 55%|█████▌    | 22/40 [00:14<00:12,  1.50it/s] 57%|█████▊    | 23/40 [00:15<00:11,  1.50it/s] 60%|██████    | 24/40 [00:16<00:10,  1.49it/s] 62%|██████▎   | 25/40 [00:16<00:10,  1.49it/s] 65%|██████▌   | 26/40 [00:17<00:09,  1.51it/s] 68%|██████▊   | 27/40 [00:18<00:08,  1.50it/s] 70%|███████   | 28/40 [00:18<00:07,  1.50it/s] 72%|███████▎  | 29/40 [00:19<00:07,  1.50it/s] 75%|███████▌  | 30/40 [00:19<00:06,  1.50it/s] 78%|███████▊  | 31/40 [00:20<00:05,  1.50it/s] 80%|████████  | 32/40 [00:21<00:05,  1.50it/s] 82%|████████▎ | 33/40 [00:22<00:04,  1.50it/s] 85%|████████▌ | 34/40 [00:22<00:04,  1.50it/s] 88%|████████▊ | 35/40 [00:23<00:03,  1.49it/s] 90%|█████████ | 36/40 [00:24<00:02,  1.49it/s] 92%|█████████▎| 37/40 [00:24<00:02,  1.49it/s] 95%|█████████▌| 38/40 [00:25<00:01,  1.49it/s] 98%|█████████▊| 39/40 [00:26<00:00,  1.49it/s]100%|██████████| 40/40 [00:26<00:00,  1.65it/s]100%|██████████| 40/40 [00:26<00:00,  1.51it/s]
[32m2025-02-05 05:10:35.871[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    average  bleu@1  bleu@2  bleu@3  bleu@4  dist@1  dist@2  dist@3  dist@4  extreme  \
      .7772   .2780  .08867  .02682  .01232 .008164   .1219   .4166   .6696    .5916   
      f1  gen_loss  greedy  intra_dist@1  intra_dist@2  intra_dist@3  intra_dist@4  \
   .3439      3.92   .6713         .8830         .9832         .9646         .9120   
     ppl  rouge1  rouge2  rougeL  
   50.41   .3795  .07555   .3661[0m
[32m2025-02-05 05:10:35.873[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m163[0m - [1m[Conversation epoch 2][0m
[32m2025-02-05 05:10:35.873[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m164[0m - [1m[Train][0m
  0%|          | 0/92414 [00:00<?, ?it/s]100%|██████████| 92414/92414 [00:00<00:00, 1119739.57it/s]
[32m2025-02-05 05:10:35.956[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/358 [00:00<?, ?it/s]  0%|          | 1/358 [00:00<00:36,  9.78it/s]  1%|          | 3/358 [00:00<00:35,  9.94it/s]  1%|          | 4/358 [00:00<00:35,  9.91it/s]  2%|▏         | 6/358 [00:00<00:35,  9.88it/s]  2%|▏         | 7/358 [00:00<00:35,  9.81it/s]  2%|▏         | 8/358 [00:00<00:35,  9.85it/s]  3%|▎         | 9/358 [00:00<00:35,  9.75it/s]  3%|▎         | 10/358 [00:01<00:35,  9.74it/s]  3%|▎         | 11/358 [00:01<00:35,  9.69it/s]  4%|▎         | 13/358 [00:01<00:34,  9.91it/s]  4%|▍         | 14/358 [00:01<00:34,  9.84it/s]  4%|▍         | 15/358 [00:01<00:35,  9.76it/s]  4%|▍         | 16/358 [00:01<00:35,  9.69it/s]  5%|▍         | 17/358 [00:01<00:35,  9.71it/s]  5%|▌         | 18/358 [00:01<00:34,  9.79it/s]  5%|▌         | 19/358 [00:01<00:34,  9.72it/s]  6%|▌         | 20/358 [00:02<00:34,  9.66it/s]  6%|▌         | 21/358 [00:02<00:35,  9.60it/s]  6%|▌         | 22/358 [00:02<00:34,  9.66it/s]  7%|▋         | 24/358 [00:02<00:34,  9.76it/s]  7%|▋         | 25/358 [00:02<00:34,  9.71it/s]  7%|▋         | 26/358 [00:02<00:34,  9.66it/s]  8%|▊         | 27/358 [00:02<00:34,  9.72it/s]  8%|▊         | 28/358 [00:02<00:34,  9.67it/s]  8%|▊         | 29/358 [00:02<00:34,  9.64it/s]  9%|▊         | 31/358 [00:03<00:33,  9.74it/s]  9%|▉         | 32/358 [00:03<00:33,  9.74it/s]  9%|▉         | 34/358 [00:03<00:32,  9.84it/s] 10%|█         | 36/358 [00:03<00:32,  9.83it/s] 10%|█         | 37/358 [00:03<00:32,  9.82it/s] 11%|█         | 38/358 [00:03<00:32,  9.77it/s] 11%|█         | 40/358 [00:04<00:32,  9.93it/s] 11%|█▏        | 41/358 [00:04<00:32,  9.84it/s] 12%|█▏        | 43/358 [00:04<00:31,  9.87it/s] 13%|█▎        | 45/358 [00:04<00:31,  9.97it/s] 13%|█▎        | 47/358 [00:04<00:31,  9.94it/s] 13%|█▎        | 48/358 [00:04<00:31,  9.93it/s] 14%|█▍        | 50/358 [00:05<00:31,  9.90it/s] 14%|█▍        | 51/358 [00:05<00:31,  9.83it/s] 15%|█▍        | 52/358 [00:05<00:31,  9.75it/s] 15%|█▍        | 53/358 [00:05<00:31,  9.69it/s] 15%|█▌        | 54/358 [00:05<00:31,  9.74it/s] 15%|█▌        | 55/358 [00:05<00:31,  9.68it/s] 16%|█▌        | 56/358 [00:05<00:31,  9.72it/s] 16%|█▌        | 57/358 [00:05<00:31,  9.69it/s] 16%|█▌        | 58/358 [00:05<00:31,  9.66it/s] 16%|█▋        | 59/358 [00:06<00:31,  9.63it/s] 17%|█▋        | 61/358 [00:06<00:30,  9.72it/s] 17%|█▋        | 62/358 [00:06<00:30,  9.64it/s] 18%|█▊        | 63/358 [00:06<00:30,  9.70it/s] 18%|█▊        | 64/358 [00:06<00:30,  9.66it/s] 18%|█▊        | 66/358 [00:06<00:30,  9.72it/s] 19%|█▊        | 67/358 [00:06<00:29,  9.71it/s] 19%|█▉        | 69/358 [00:07<00:29,  9.77it/s] 20%|█▉        | 70/358 [00:07<00:29,  9.72it/s] 20%|█▉        | 71/358 [00:07<00:29,  9.76it/s] 20%|██        | 72/358 [00:07<00:29,  9.71it/s] 20%|██        | 73/358 [00:07<00:29,  9.68it/s] 21%|██        | 74/358 [00:07<00:29,  9.64it/s] 21%|██        | 75/358 [00:07<00:29,  9.61it/s] 21%|██        | 76/358 [00:07<00:29,  9.71it/s] 22%|██▏       | 77/358 [00:07<00:29,  9.68it/s] 22%|██▏       | 79/358 [00:08<00:28,  9.68it/s] 23%|██▎       | 81/358 [00:08<00:28,  9.75it/s] 23%|██▎       | 83/358 [00:08<00:28,  9.77it/s] 23%|██▎       | 84/358 [00:08<00:28,  9.72it/s] 24%|██▎       | 85/358 [00:08<00:28,  9.68it/s] 24%|██▍       | 86/358 [00:08<00:28,  9.67it/s] 24%|██▍       | 87/358 [00:08<00:28,  9.64it/s] 25%|██▍       | 88/358 [00:09<00:27,  9.66it/s] 25%|██▌       | 90/358 [00:09<00:27,  9.90it/s] 26%|██▌       | 92/358 [00:09<00:26,  9.98it/s] 26%|██▌       | 93/358 [00:09<00:26,  9.95it/s] 26%|██▋       | 94/358 [00:09<00:26,  9.86it/s] 27%|██▋       | 96/358 [00:09<00:25, 10.14it/s] 27%|██▋       | 98/358 [00:10<00:25, 10.03it/s] 28%|██▊       | 99/358 [00:10<00:26,  9.94it/s] 28%|██▊       | 101/358 [00:10<00:25,  9.91it/s] 29%|██▉       | 103/358 [00:10<00:25,  9.90it/s] 29%|██▉       | 104/358 [00:10<00:25,  9.85it/s] 29%|██▉       | 105/358 [00:10<00:25,  9.77it/s] 30%|██▉       | 106/358 [00:10<00:25,  9.76it/s] 30%|███       | 108/358 [00:11<00:25,  9.79it/s] 30%|███       | 109/358 [00:11<00:25,  9.70it/s] 31%|███       | 110/358 [00:11<00:25,  9.68it/s] 31%|███       | 111/358 [00:11<00:25,  9.63it/s] 32%|███▏      | 113/358 [00:11<00:24,  9.90it/s] 32%|███▏      | 114/358 [00:11<00:24,  9.86it/s] 32%|███▏      | 115/358 [00:11<00:24,  9.76it/s] 32%|███▏      | 116/358 [00:11<00:25,  9.68it/s] 33%|███▎      | 117/358 [00:11<00:24,  9.65it/s] 33%|███▎      | 119/358 [00:12<00:24,  9.77it/s] 34%|███▍      | 121/358 [00:12<00:23,  9.96it/s] 34%|███▍      | 123/358 [00:12<00:23, 10.07it/s] 35%|███▍      | 125/358 [00:12<00:23, 10.04it/s] 35%|███▌      | 126/358 [00:12<00:23, 10.00it/s] 35%|███▌      | 127/358 [00:12<00:23,  9.95it/s] 36%|███▌      | 128/358 [00:13<00:23,  9.91it/s] 36%|███▋      | 130/358 [00:13<00:22,  9.98it/s] 37%|███▋      | 131/358 [00:13<00:22,  9.87it/s] 37%|███▋      | 132/358 [00:13<00:22,  9.90it/s] 37%|███▋      | 134/358 [00:13<00:22,  9.92it/s] 38%|███▊      | 135/358 [00:13<00:22,  9.86it/s] 38%|███▊      | 137/358 [00:13<00:22,  9.95it/s] 39%|███▊      | 138/358 [00:14<00:22,  9.93it/s] 39%|███▉      | 139/358 [00:14<00:22,  9.84it/s] 39%|███▉      | 141/358 [00:14<00:21,  9.97it/s] 40%|███▉      | 142/358 [00:14<00:21,  9.89it/s] 40%|███▉      | 143/358 [00:14<00:21,  9.85it/s] 40%|████      | 144/358 [00:14<00:21,  9.77it/s] 41%|████      | 145/358 [00:14<00:21,  9.77it/s] 41%|████      | 146/358 [00:14<00:21,  9.71it/s] 41%|████      | 147/358 [00:14<00:21,  9.65it/s] 41%|████▏     | 148/358 [00:15<00:21,  9.69it/s] 42%|████▏     | 149/358 [00:15<00:21,  9.67it/s] 42%|████▏     | 150/358 [00:15<00:21,  9.63it/s] 42%|████▏     | 151/358 [00:15<00:22,  9.37it/s] 42%|████▏     | 152/358 [00:15<00:21,  9.42it/s] 43%|████▎     | 153/358 [00:15<00:21,  9.44it/s] 43%|████▎     | 154/358 [00:15<00:21,  9.53it/s] 43%|████▎     | 155/358 [00:15<00:21,  9.54it/s] 44%|████▎     | 156/358 [00:15<00:20,  9.66it/s] 44%|████▍     | 157/358 [00:16<00:20,  9.60it/s] 44%|████▍     | 158/358 [00:16<00:20,  9.69it/s] 44%|████▍     | 159/358 [00:16<00:20,  9.68it/s] 45%|████▍     | 160/358 [00:16<00:20,  9.69it/s] 45%|████▌     | 162/358 [00:16<00:19,  9.98it/s] 46%|████▌     | 164/358 [00:16<00:19,  9.98it/s] 46%|████▌     | 165/358 [00:16<00:19,  9.94it/s] 47%|████▋     | 167/358 [00:17<00:19,  9.89it/s] 47%|████▋     | 169/358 [00:17<00:19,  9.93it/s] 48%|████▊     | 171/358 [00:17<00:18,  9.91it/s] 48%|████▊     | 172/358 [00:17<00:18,  9.86it/s] 48%|████▊     | 173/358 [00:17<00:18,  9.80it/s] 49%|████▉     | 175/358 [00:17<00:18,  9.82it/s] 49%|████▉     | 176/358 [00:17<00:18,  9.84it/s] 49%|████▉     | 177/358 [00:18<00:18,  9.82it/s] 50%|█████     | 179/358 [00:18<00:18,  9.85it/s] 50%|█████     | 180/358 [00:18<00:18,  9.78it/s] 51%|█████     | 182/358 [00:18<00:17,  9.92it/s] 51%|█████     | 183/358 [00:18<00:17,  9.88it/s] 51%|█████▏    | 184/358 [00:18<00:17,  9.77it/s] 52%|█████▏    | 185/358 [00:18<00:17,  9.71it/s] 52%|█████▏    | 187/358 [00:19<00:17,  9.93it/s] 53%|█████▎    | 188/358 [00:19<00:17,  9.87it/s] 53%|█████▎    | 189/358 [00:19<00:17,  9.82it/s] 53%|█████▎    | 190/358 [00:19<00:17,  9.86it/s] 53%|█████▎    | 191/358 [00:19<00:17,  9.69it/s] 54%|█████▎    | 192/358 [00:19<00:17,  9.64it/s] 54%|█████▍    | 193/358 [00:19<00:17,  9.65it/s] 54%|█████▍    | 194/358 [00:19<00:17,  9.63it/s] 54%|█████▍    | 195/358 [00:19<00:16,  9.71it/s] 55%|█████▌    | 197/358 [00:20<00:16,  9.90it/s] 55%|█████▌    | 198/358 [00:20<00:16,  9.82it/s] 56%|█████▌    | 199/358 [00:20<00:16,  9.86it/s] 56%|█████▌    | 200/358 [00:20<00:16,  9.79it/s] 56%|█████▌    | 201/358 [00:20<00:16,  9.75it/s] 57%|█████▋    | 203/358 [00:20<00:15,  9.84it/s] 57%|█████▋    | 204/358 [00:20<00:15,  9.73it/s] 57%|█████▋    | 205/358 [00:20<00:15,  9.69it/s] 58%|█████▊    | 207/358 [00:21<00:15,  9.86it/s] 58%|█████▊    | 208/358 [00:21<00:15,  9.79it/s] 59%|█████▊    | 210/358 [00:21<00:15,  9.80it/s] 59%|█████▉    | 212/358 [00:21<00:14,  9.80it/s] 60%|█████▉    | 214/358 [00:21<00:14,  9.88it/s] 60%|██████    | 215/358 [00:21<00:14,  9.81it/s] 60%|██████    | 216/358 [00:22<00:14,  9.75it/s] 61%|██████    | 217/358 [00:22<00:14,  9.79it/s] 61%|██████    | 218/358 [00:22<00:14,  9.76it/s] 61%|██████    | 219/358 [00:22<00:14,  9.76it/s] 62%|██████▏   | 221/358 [00:22<00:13,  9.89it/s] 62%|██████▏   | 222/358 [00:22<00:13,  9.78it/s] 62%|██████▏   | 223/358 [00:22<00:13,  9.73it/s] 63%|██████▎   | 224/358 [00:22<00:13,  9.67it/s] 63%|██████▎   | 225/358 [00:22<00:13,  9.76it/s] 63%|██████▎   | 226/358 [00:23<00:13,  9.70it/s] 63%|██████▎   | 227/358 [00:23<00:13,  9.78it/s] 64%|██████▎   | 228/358 [00:23<00:13,  9.72it/s] 64%|██████▍   | 229/358 [00:23<00:13,  9.70it/s] 64%|██████▍   | 230/358 [00:23<00:13,  9.64it/s] 65%|██████▍   | 232/358 [00:23<00:12,  9.71it/s] 65%|██████▌   | 234/358 [00:23<00:12, 10.02it/s] 66%|██████▌   | 236/358 [00:24<00:12,  9.98it/s] 66%|██████▋   | 238/358 [00:24<00:11, 10.03it/s] 67%|██████▋   | 240/358 [00:24<00:11,  9.98it/s] 68%|██████▊   | 242/358 [00:24<00:11,  9.96it/s] 68%|██████▊   | 243/358 [00:24<00:11,  9.90it/s] 68%|██████▊   | 244/358 [00:24<00:11,  9.83it/s] 69%|██████▊   | 246/358 [00:25<00:11,  9.86it/s] 69%|██████▉   | 247/358 [00:25<00:11,  9.78it/s] 69%|██████▉   | 248/358 [00:25<00:11,  9.74it/s] 70%|██████▉   | 250/358 [00:25<00:10,  9.83it/s] 70%|███████   | 251/358 [00:25<00:10,  9.77it/s] 70%|███████   | 252/358 [00:25<00:10,  9.71it/s] 71%|███████   | 253/358 [00:25<00:10,  9.67it/s] 71%|███████   | 254/358 [00:25<00:10,  9.64it/s] 72%|███████▏  | 256/358 [00:26<00:10,  9.82it/s] 72%|███████▏  | 257/358 [00:26<00:10,  9.82it/s] 72%|███████▏  | 258/358 [00:26<00:10,  9.70it/s] 72%|███████▏  | 259/358 [00:26<00:10,  9.67it/s] 73%|███████▎  | 260/358 [00:26<00:10,  9.70it/s] 73%|███████▎  | 262/358 [00:26<00:09,  9.88it/s] 74%|███████▎  | 264/358 [00:26<00:09,  9.90it/s] 74%|███████▍  | 266/358 [00:27<00:09,  9.89it/s] 75%|███████▍  | 267/358 [00:27<00:09,  9.83it/s] 75%|███████▌  | 269/358 [00:27<00:09,  9.89it/s] 75%|███████▌  | 270/358 [00:27<00:08,  9.81it/s] 76%|███████▌  | 271/358 [00:27<00:08,  9.74it/s] 76%|███████▌  | 272/358 [00:27<00:08,  9.72it/s] 76%|███████▋  | 273/358 [00:27<00:08,  9.62it/s] 77%|███████▋  | 274/358 [00:27<00:08,  9.62it/s] 77%|███████▋  | 275/358 [00:28<00:08,  9.67it/s] 77%|███████▋  | 276/358 [00:28<00:08,  9.67it/s] 77%|███████▋  | 277/358 [00:28<00:08,  9.64it/s] 78%|███████▊  | 278/358 [00:28<00:08,  9.61it/s] 78%|███████▊  | 280/358 [00:28<00:07,  9.81it/s] 78%|███████▊  | 281/358 [00:28<00:07,  9.81it/s] 79%|███████▉  | 282/358 [00:28<00:07,  9.76it/s] 79%|███████▉  | 283/358 [00:28<00:07,  9.69it/s] 79%|███████▉  | 284/358 [00:29<00:07,  9.65it/s] 80%|███████▉  | 285/358 [00:29<00:07,  9.72it/s] 80%|███████▉  | 286/358 [00:29<00:07,  9.68it/s] 80%|████████  | 287/358 [00:29<00:07,  9.66it/s] 80%|████████  | 288/358 [00:29<00:07,  9.62it/s] 81%|████████  | 290/358 [00:29<00:06,  9.83it/s] 81%|████████▏ | 291/358 [00:29<00:06,  9.81it/s] 82%|████████▏ | 293/358 [00:29<00:06,  9.82it/s] 82%|████████▏ | 295/358 [00:30<00:06,  9.89it/s] 83%|████████▎ | 296/358 [00:30<00:06,  9.82it/s] 83%|████████▎ | 297/358 [00:30<00:06,  9.72it/s] 84%|████████▎ | 299/358 [00:30<00:05,  9.88it/s] 84%|████████▍ | 301/358 [00:30<00:05,  9.92it/s] 84%|████████▍ | 302/358 [00:30<00:05,  9.85it/s] 85%|████████▍ | 303/358 [00:30<00:05,  9.86it/s] 85%|████████▌ | 305/358 [00:31<00:05,  9.89it/s] 85%|████████▌ | 306/358 [00:31<00:05,  9.82it/s] 86%|████████▌ | 308/358 [00:31<00:05,  9.91it/s] 86%|████████▋ | 309/358 [00:31<00:04,  9.81it/s] 87%|████████▋ | 310/358 [00:31<00:04,  9.75it/s] 87%|████████▋ | 311/358 [00:31<00:04,  9.67it/s] 87%|████████▋ | 312/358 [00:31<00:04,  9.69it/s] 87%|████████▋ | 313/358 [00:31<00:04,  9.71it/s] 88%|████████▊ | 315/358 [00:32<00:04,  9.97it/s] 88%|████████▊ | 316/358 [00:32<00:04,  9.92it/s] 89%|████████▊ | 317/358 [00:32<00:04,  9.84it/s] 89%|████████▉ | 318/358 [00:32<00:04,  9.79it/s] 89%|████████▉ | 319/358 [00:32<00:04,  9.74it/s] 89%|████████▉ | 320/358 [00:32<00:03,  9.80it/s] 90%|████████▉ | 321/358 [00:32<00:03,  9.73it/s] 90%|████████▉ | 322/358 [00:32<00:03,  9.69it/s] 90%|█████████ | 323/358 [00:32<00:03,  9.64it/s] 91%|█████████ | 324/358 [00:33<00:03,  9.61it/s] 91%|█████████ | 325/358 [00:33<00:03,  9.60it/s] 91%|█████████▏| 327/358 [00:33<00:03,  9.95it/s] 92%|█████████▏| 329/358 [00:33<00:02, 10.05it/s] 92%|█████████▏| 330/358 [00:33<00:02,  9.94it/s] 93%|█████████▎| 332/358 [00:33<00:02, 10.04it/s] 93%|█████████▎| 334/358 [00:34<00:02,  9.95it/s] 94%|█████████▎| 335/358 [00:34<00:02,  9.83it/s] 94%|█████████▍| 337/358 [00:34<00:02,  9.91it/s] 95%|█████████▍| 339/358 [00:34<00:01, 10.10it/s] 95%|█████████▌| 341/358 [00:34<00:01, 10.05it/s] 96%|█████████▌| 343/358 [00:34<00:01,  9.89it/s] 96%|█████████▌| 344/358 [00:35<00:01,  9.83it/s] 96%|█████████▋| 345/358 [00:35<00:01,  9.85it/s] 97%|█████████▋| 346/358 [00:35<00:01,  9.88it/s] 97%|█████████▋| 348/358 [00:35<00:01,  9.97it/s] 97%|█████████▋| 349/358 [00:35<00:00,  9.88it/s] 98%|█████████▊| 350/358 [00:35<00:00,  9.80it/s] 98%|█████████▊| 351/358 [00:35<00:00,  9.75it/s] 99%|█████████▊| 353/358 [00:36<00:00,  9.92it/s] 99%|█████████▉| 354/358 [00:36<00:00,  9.90it/s] 99%|█████████▉| 355/358 [00:36<00:00,  9.81it/s]100%|█████████▉| 357/358 [00:36<00:00,  9.86it/s]100%|██████████| 358/358 [00:36<00:00,  9.81it/s]
[32m2025-02-05 05:11:12.448[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    gen_loss  grad clip ratio  grad norm  ppl
       3.648                1      8.131 38.4[0m
[32m2025-02-05 05:11:12.448[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m169[0m - [1m[Valid][0m
  0%|          | 0/10256 [00:00<?, ?it/s]100%|██████████| 10256/10256 [00:00<00:00, 976743.98it/s]
[32m2025-02-05 05:11:12.459[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:26,  1.48it/s]  5%|▌         | 2/40 [00:01<00:25,  1.49it/s]  8%|▊         | 3/40 [00:02<00:24,  1.50it/s] 10%|█         | 4/40 [00:02<00:24,  1.50it/s] 12%|█▎        | 5/40 [00:03<00:23,  1.49it/s] 15%|█▌        | 6/40 [00:04<00:22,  1.49it/s] 18%|█▊        | 7/40 [00:04<00:22,  1.49it/s] 20%|██        | 8/40 [00:05<00:21,  1.49it/s] 22%|██▎       | 9/40 [00:06<00:20,  1.49it/s] 25%|██▌       | 10/40 [00:06<00:20,  1.49it/s] 28%|██▊       | 11/40 [00:07<00:19,  1.49it/s] 30%|███       | 12/40 [00:08<00:18,  1.49it/s] 32%|███▎      | 13/40 [00:08<00:18,  1.50it/s] 35%|███▌      | 14/40 [00:09<00:17,  1.48it/s] 38%|███▊      | 15/40 [00:10<00:16,  1.48it/s] 40%|████      | 16/40 [00:10<00:16,  1.48it/s] 42%|████▎     | 17/40 [00:11<00:15,  1.49it/s] 45%|████▌     | 18/40 [00:12<00:14,  1.49it/s] 48%|████▊     | 19/40 [00:12<00:14,  1.49it/s] 50%|█████     | 20/40 [00:13<00:13,  1.49it/s] 52%|█████▎    | 21/40 [00:14<00:12,  1.49it/s] 55%|█████▌    | 22/40 [00:14<00:12,  1.49it/s] 57%|█████▊    | 23/40 [00:15<00:11,  1.49it/s] 60%|██████    | 24/40 [00:16<00:10,  1.48it/s] 62%|██████▎   | 25/40 [00:16<00:10,  1.49it/s] 65%|██████▌   | 26/40 [00:17<00:09,  1.50it/s] 68%|██████▊   | 27/40 [00:18<00:08,  1.50it/s] 70%|███████   | 28/40 [00:18<00:08,  1.50it/s] 72%|███████▎  | 29/40 [00:19<00:07,  1.50it/s] 75%|███████▌  | 30/40 [00:20<00:06,  1.50it/s] 78%|███████▊  | 31/40 [00:20<00:06,  1.50it/s] 80%|████████  | 32/40 [00:21<00:05,  1.50it/s] 82%|████████▎ | 33/40 [00:22<00:04,  1.49it/s] 85%|████████▌ | 34/40 [00:22<00:04,  1.49it/s] 88%|████████▊ | 35/40 [00:23<00:03,  1.49it/s] 90%|█████████ | 36/40 [00:24<00:02,  1.48it/s] 92%|█████████▎| 37/40 [00:24<00:02,  1.48it/s] 95%|█████████▌| 38/40 [00:25<00:01,  1.47it/s] 98%|█████████▊| 39/40 [00:26<00:00,  1.48it/s]100%|██████████| 40/40 [00:26<00:00,  1.63it/s]100%|██████████| 40/40 [00:26<00:00,  1.50it/s]
[32m2025-02-05 05:11:39.103[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    average  bleu@1  bleu@2  bleu@3  bleu@4  dist@1  dist@2  dist@3  dist@4  extreme  \
      .7842   .2919  .09727  .03331  .01899  .01303   .1451   .4379   .6847    .6001   
      f1  gen_loss  greedy  intra_dist@1  intra_dist@2  intra_dist@3  intra_dist@4  \
   .3606     3.799   .6781         .8834         .9857         .9739         .9235   
     ppl  rouge1  rouge2  rougeL  
   44.65   .3902  .08203   .3762[0m
[32m2025-02-05 05:11:39.105[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m163[0m - [1m[Conversation epoch 3][0m
[32m2025-02-05 05:11:39.105[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m164[0m - [1m[Train][0m
  0%|          | 0/92414 [00:00<?, ?it/s]100%|██████████| 92414/92414 [00:00<00:00, 1130840.11it/s]
[32m2025-02-05 05:11:39.187[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/358 [00:00<?, ?it/s]  0%|          | 1/358 [00:00<00:36,  9.77it/s]  1%|          | 3/358 [00:00<00:35,  9.92it/s]  1%|          | 4/358 [00:00<00:35,  9.90it/s]  2%|▏         | 6/358 [00:00<00:35,  9.87it/s]  2%|▏         | 7/358 [00:00<00:35,  9.80it/s]  2%|▏         | 8/358 [00:00<00:35,  9.85it/s]  3%|▎         | 9/358 [00:00<00:35,  9.75it/s]  3%|▎         | 10/358 [00:01<00:35,  9.74it/s]  3%|▎         | 11/358 [00:01<00:35,  9.69it/s]  4%|▎         | 13/358 [00:01<00:34,  9.91it/s]  4%|▍         | 14/358 [00:01<00:34,  9.83it/s]  4%|▍         | 15/358 [00:01<00:35,  9.76it/s]  4%|▍         | 16/358 [00:01<00:35,  9.70it/s]  5%|▍         | 17/358 [00:01<00:35,  9.71it/s]  5%|▌         | 18/358 [00:01<00:34,  9.79it/s]  5%|▌         | 19/358 [00:01<00:34,  9.72it/s]  6%|▌         | 20/358 [00:02<00:34,  9.66it/s]  6%|▌         | 21/358 [00:02<00:35,  9.57it/s]  6%|▌         | 22/358 [00:02<00:34,  9.64it/s]  7%|▋         | 24/358 [00:02<00:34,  9.74it/s]  7%|▋         | 25/358 [00:02<00:34,  9.69it/s]  7%|▋         | 26/358 [00:02<00:34,  9.64it/s]  8%|▊         | 27/358 [00:02<00:34,  9.70it/s]  8%|▊         | 28/358 [00:02<00:34,  9.66it/s]  8%|▊         | 29/358 [00:02<00:34,  9.62it/s]  9%|▊         | 31/358 [00:03<00:33,  9.73it/s]  9%|▉         | 32/358 [00:03<00:33,  9.73it/s]  9%|▉         | 34/358 [00:03<00:32,  9.82it/s] 10%|█         | 36/358 [00:03<00:32,  9.82it/s] 10%|█         | 37/358 [00:03<00:32,  9.81it/s] 11%|█         | 38/358 [00:03<00:32,  9.76it/s] 11%|█         | 40/358 [00:04<00:32,  9.92it/s] 11%|█▏        | 41/358 [00:04<00:32,  9.84it/s] 12%|█▏        | 43/358 [00:04<00:31,  9.86it/s] 13%|█▎        | 45/358 [00:04<00:31,  9.96it/s] 13%|█▎        | 47/358 [00:04<00:31,  9.92it/s] 13%|█▎        | 48/358 [00:04<00:31,  9.91it/s] 14%|█▍        | 50/358 [00:05<00:31,  9.89it/s] 14%|█▍        | 51/358 [00:05<00:31,  9.82it/s] 15%|█▍        | 52/358 [00:05<00:31,  9.73it/s] 15%|█▍        | 53/358 [00:05<00:31,  9.68it/s] 15%|█▌        | 54/358 [00:05<00:31,  9.72it/s] 15%|█▌        | 55/358 [00:05<00:31,  9.67it/s] 16%|█▌        | 56/358 [00:05<00:31,  9.71it/s] 16%|█▌        | 57/358 [00:05<00:31,  9.67it/s] 16%|█▌        | 58/358 [00:05<00:31,  9.65it/s] 16%|█▋        | 59/358 [00:06<00:31,  9.62it/s] 17%|█▋        | 61/358 [00:06<00:30,  9.70it/s] 17%|█▋        | 62/358 [00:06<00:30,  9.63it/s] 18%|█▊        | 63/358 [00:06<00:30,  9.69it/s] 18%|█▊        | 64/358 [00:06<00:30,  9.65it/s] 18%|█▊        | 66/358 [00:06<00:30,  9.71it/s] 19%|█▊        | 67/358 [00:06<00:30,  9.70it/s] 19%|█▉        | 69/358 [00:07<00:29,  9.76it/s] 20%|█▉        | 70/358 [00:07<00:29,  9.71it/s] 20%|█▉        | 71/358 [00:07<00:29,  9.75it/s] 20%|██        | 72/358 [00:07<00:29,  9.70it/s] 20%|██        | 73/358 [00:07<00:29,  9.67it/s] 21%|██        | 74/358 [00:07<00:29,  9.62it/s] 21%|██        | 75/358 [00:07<00:29,  9.58it/s] 21%|██        | 76/358 [00:07<00:29,  9.69it/s] 22%|██▏       | 77/358 [00:07<00:29,  9.66it/s] 22%|██▏       | 79/358 [00:08<00:28,  9.67it/s] 23%|██▎       | 81/358 [00:08<00:28,  9.73it/s] 23%|██▎       | 83/358 [00:08<00:28,  9.76it/s] 23%|██▎       | 84/358 [00:08<00:28,  9.71it/s] 24%|██▎       | 85/358 [00:08<00:28,  9.66it/s] 24%|██▍       | 86/358 [00:08<00:28,  9.65it/s] 24%|██▍       | 87/358 [00:08<00:28,  9.63it/s] 25%|██▍       | 88/358 [00:09<00:27,  9.65it/s] 25%|██▌       | 90/358 [00:09<00:27,  9.89it/s] 26%|██▌       | 92/358 [00:09<00:26,  9.98it/s] 26%|██▌       | 93/358 [00:09<00:26,  9.95it/s] 26%|██▋       | 94/358 [00:09<00:26,  9.86it/s] 27%|██▋       | 96/358 [00:09<00:25, 10.14it/s] 27%|██▋       | 98/358 [00:10<00:25, 10.03it/s] 28%|██▊       | 99/358 [00:10<00:26,  9.94it/s] 28%|██▊       | 101/358 [00:10<00:25,  9.90it/s] 29%|██▉       | 103/358 [00:10<00:25,  9.89it/s] 29%|██▉       | 104/358 [00:10<00:25,  9.85it/s] 29%|██▉       | 105/358 [00:10<00:25,  9.77it/s] 30%|██▉       | 106/358 [00:10<00:25,  9.75it/s] 30%|███       | 108/358 [00:11<00:25,  9.78it/s] 30%|███       | 109/358 [00:11<00:25,  9.70it/s] 31%|███       | 110/358 [00:11<00:25,  9.68it/s] 31%|███       | 111/358 [00:11<00:25,  9.63it/s] 32%|███▏      | 113/358 [00:11<00:24,  9.90it/s] 32%|███▏      | 114/358 [00:11<00:24,  9.85it/s] 32%|███▏      | 115/358 [00:11<00:24,  9.76it/s] 32%|███▏      | 116/358 [00:11<00:25,  9.68it/s] 33%|███▎      | 117/358 [00:11<00:24,  9.65it/s] 33%|███▎      | 119/358 [00:12<00:24,  9.77it/s] 34%|███▍      | 121/358 [00:12<00:23,  9.96it/s] 34%|███▍      | 123/358 [00:12<00:23, 10.06it/s] 35%|███▍      | 125/358 [00:12<00:23, 10.04it/s] 35%|███▌      | 126/358 [00:12<00:23, 10.00it/s] 35%|███▌      | 127/358 [00:12<00:23,  9.95it/s] 36%|███▌      | 128/358 [00:13<00:23,  9.90it/s] 36%|███▋      | 130/358 [00:13<00:22,  9.97it/s] 37%|███▋      | 131/358 [00:13<00:23,  9.87it/s] 37%|███▋      | 132/358 [00:13<00:22,  9.89it/s] 37%|███▋      | 134/358 [00:13<00:22,  9.91it/s] 38%|███▊      | 135/358 [00:13<00:22,  9.85it/s] 38%|███▊      | 137/358 [00:13<00:22,  9.94it/s] 39%|███▊      | 138/358 [00:14<00:22,  9.92it/s] 39%|███▉      | 139/358 [00:14<00:22,  9.83it/s] 39%|███▉      | 141/358 [00:14<00:21,  9.96it/s] 40%|███▉      | 142/358 [00:14<00:21,  9.88it/s] 40%|███▉      | 143/358 [00:14<00:21,  9.85it/s] 40%|████      | 144/358 [00:14<00:21,  9.77it/s] 41%|████      | 145/358 [00:14<00:21,  9.79it/s] 41%|████      | 146/358 [00:14<00:21,  9.72it/s] 41%|████      | 147/358 [00:15<00:21,  9.67it/s] 41%|████▏     | 148/358 [00:15<00:21,  9.69it/s] 42%|████▏     | 149/358 [00:15<00:21,  9.68it/s] 42%|████▏     | 150/358 [00:15<00:21,  9.64it/s] 42%|████▏     | 151/358 [00:15<00:22,  9.37it/s] 42%|████▏     | 152/358 [00:15<00:21,  9.41it/s] 43%|████▎     | 153/358 [00:15<00:21,  9.43it/s] 43%|████▎     | 154/358 [00:15<00:21,  9.53it/s] 43%|████▎     | 155/358 [00:15<00:21,  9.54it/s] 44%|████▎     | 156/358 [00:15<00:20,  9.66it/s] 44%|████▍     | 157/358 [00:16<00:20,  9.60it/s] 44%|████▍     | 158/358 [00:16<00:20,  9.69it/s] 44%|████▍     | 159/358 [00:16<00:20,  9.68it/s] 45%|████▍     | 160/358 [00:16<00:20,  9.68it/s] 45%|████▌     | 162/358 [00:16<00:19,  9.97it/s] 46%|████▌     | 164/358 [00:16<00:19,  9.98it/s] 46%|████▌     | 165/358 [00:16<00:19,  9.94it/s] 47%|████▋     | 167/358 [00:17<00:19,  9.89it/s] 47%|████▋     | 169/358 [00:17<00:19,  9.92it/s] 48%|████▊     | 171/358 [00:17<00:18,  9.91it/s] 48%|████▊     | 172/358 [00:17<00:18,  9.85it/s] 48%|████▊     | 173/358 [00:17<00:18,  9.79it/s] 49%|████▉     | 175/358 [00:17<00:18,  9.81it/s] 49%|████▉     | 176/358 [00:17<00:18,  9.83it/s] 49%|████▉     | 177/358 [00:18<00:18,  9.81it/s] 50%|████▉     | 178/358 [00:18<00:18,  9.86it/s] 50%|█████     | 179/358 [00:18<00:18,  9.83it/s] 50%|█████     | 180/358 [00:18<00:18,  9.75it/s] 51%|█████     | 182/358 [00:18<00:17,  9.93it/s] 51%|█████     | 183/358 [00:18<00:17,  9.88it/s] 51%|█████▏    | 184/358 [00:18<00:17,  9.76it/s] 52%|█████▏    | 185/358 [00:18<00:17,  9.71it/s] 52%|█████▏    | 187/358 [00:19<00:17,  9.93it/s] 53%|█████▎    | 188/358 [00:19<00:17,  9.87it/s] 53%|█████▎    | 189/358 [00:19<00:17,  9.82it/s] 53%|█████▎    | 190/358 [00:19<00:17,  9.86it/s] 53%|█████▎    | 191/358 [00:19<00:17,  9.69it/s] 54%|█████▎    | 192/358 [00:19<00:17,  9.64it/s] 54%|█████▍    | 193/358 [00:19<00:17,  9.65it/s] 54%|█████▍    | 194/358 [00:19<00:17,  9.63it/s] 54%|█████▍    | 195/358 [00:19<00:16,  9.71it/s] 55%|█████▌    | 197/358 [00:20<00:16,  9.90it/s] 55%|█████▌    | 198/358 [00:20<00:16,  9.82it/s] 56%|█████▌    | 199/358 [00:20<00:16,  9.86it/s] 56%|█████▌    | 200/358 [00:20<00:16,  9.79it/s] 56%|█████▌    | 201/358 [00:20<00:16,  9.75it/s] 57%|█████▋    | 203/358 [00:20<00:15,  9.84it/s] 57%|█████▋    | 204/358 [00:20<00:15,  9.73it/s] 57%|█████▋    | 205/358 [00:20<00:15,  9.69it/s] 58%|█████▊    | 207/358 [00:21<00:15,  9.86it/s] 58%|█████▊    | 208/358 [00:21<00:15,  9.79it/s] 59%|█████▊    | 210/358 [00:21<00:15,  9.81it/s] 59%|█████▉    | 212/358 [00:21<00:14,  9.80it/s] 60%|█████▉    | 214/358 [00:21<00:14,  9.88it/s] 60%|██████    | 215/358 [00:21<00:14,  9.82it/s] 60%|██████    | 216/358 [00:22<00:14,  9.75it/s] 61%|██████    | 217/358 [00:22<00:14,  9.79it/s] 61%|██████    | 218/358 [00:22<00:14,  9.76it/s] 61%|██████    | 219/358 [00:22<00:14,  9.76it/s] 62%|██████▏   | 221/358 [00:22<00:13,  9.89it/s] 62%|██████▏   | 222/358 [00:22<00:13,  9.79it/s] 62%|██████▏   | 223/358 [00:22<00:13,  9.73it/s] 63%|██████▎   | 224/358 [00:22<00:13,  9.68it/s] 63%|██████▎   | 225/358 [00:22<00:13,  9.76it/s] 63%|██████▎   | 226/358 [00:23<00:13,  9.71it/s] 64%|██████▎   | 228/358 [00:23<00:13,  9.74it/s] 64%|██████▍   | 229/358 [00:23<00:13,  9.72it/s] 64%|██████▍   | 230/358 [00:23<00:13,  9.66it/s] 65%|██████▍   | 232/358 [00:23<00:12,  9.72it/s] 65%|██████▌   | 234/358 [00:23<00:12, 10.01it/s] 66%|██████▌   | 236/358 [00:24<00:12,  9.96it/s] 66%|██████▋   | 238/358 [00:24<00:11, 10.02it/s] 67%|██████▋   | 240/358 [00:24<00:11,  9.98it/s] 68%|██████▊   | 242/358 [00:24<00:11,  9.96it/s] 68%|██████▊   | 243/358 [00:24<00:11,  9.90it/s] 68%|██████▊   | 244/358 [00:24<00:11,  9.83it/s] 69%|██████▊   | 246/358 [00:25<00:11,  9.86it/s] 69%|██████▉   | 247/358 [00:25<00:11,  9.79it/s] 69%|██████▉   | 248/358 [00:25<00:11,  9.74it/s] 70%|██████▉   | 250/358 [00:25<00:10,  9.84it/s] 70%|███████   | 251/358 [00:25<00:10,  9.78it/s] 70%|███████   | 252/358 [00:25<00:10,  9.71it/s] 71%|███████   | 253/358 [00:25<00:10,  9.67it/s] 71%|███████   | 254/358 [00:25<00:10,  9.64it/s] 72%|███████▏  | 256/358 [00:26<00:10,  9.82it/s] 72%|███████▏  | 257/358 [00:26<00:10,  9.83it/s] 72%|███████▏  | 258/358 [00:26<00:10,  9.70it/s] 72%|███████▏  | 259/358 [00:26<00:10,  9.66it/s] 73%|███████▎  | 260/358 [00:26<00:10,  9.70it/s] 73%|███████▎  | 262/358 [00:26<00:09,  9.88it/s] 74%|███████▎  | 264/358 [00:26<00:09,  9.90it/s] 74%|███████▍  | 266/358 [00:27<00:09,  9.89it/s] 75%|███████▍  | 267/358 [00:27<00:09,  9.83it/s] 75%|███████▌  | 269/358 [00:27<00:09,  9.89it/s] 75%|███████▌  | 270/358 [00:27<00:08,  9.82it/s] 76%|███████▌  | 271/358 [00:27<00:08,  9.75it/s] 76%|███████▌  | 272/358 [00:27<00:08,  9.72it/s] 76%|███████▋  | 273/358 [00:27<00:08,  9.63it/s] 77%|███████▋  | 274/358 [00:27<00:08,  9.62it/s] 77%|███████▋  | 275/358 [00:28<00:08,  9.67it/s] 77%|███████▋  | 276/358 [00:28<00:08,  9.67it/s] 77%|███████▋  | 277/358 [00:28<00:08,  9.64it/s] 78%|███████▊  | 278/358 [00:28<00:08,  9.62it/s] 78%|███████▊  | 280/358 [00:28<00:07,  9.81it/s] 78%|███████▊  | 281/358 [00:28<00:07,  9.82it/s] 79%|███████▉  | 282/358 [00:28<00:07,  9.75it/s] 79%|███████▉  | 283/358 [00:28<00:07,  9.69it/s] 79%|███████▉  | 284/358 [00:29<00:07,  9.66it/s] 80%|███████▉  | 285/358 [00:29<00:07,  9.72it/s] 80%|███████▉  | 286/358 [00:29<00:07,  9.68it/s] 80%|████████  | 287/358 [00:29<00:07,  9.66it/s] 80%|████████  | 288/358 [00:29<00:07,  9.62it/s] 81%|████████  | 290/358 [00:29<00:06,  9.83it/s] 81%|████████▏ | 291/358 [00:29<00:06,  9.82it/s] 82%|████████▏ | 293/358 [00:29<00:06,  9.82it/s] 82%|████████▏ | 295/358 [00:30<00:06,  9.89it/s] 83%|████████▎ | 296/358 [00:30<00:06,  9.83it/s] 83%|████████▎ | 297/358 [00:30<00:06,  9.72it/s] 84%|████████▎ | 299/358 [00:30<00:05,  9.88it/s] 84%|████████▍ | 301/358 [00:30<00:05,  9.92it/s] 84%|████████▍ | 302/358 [00:30<00:05,  9.85it/s] 85%|████████▍ | 303/358 [00:30<00:05,  9.86it/s] 85%|████████▌ | 305/358 [00:31<00:05,  9.89it/s] 85%|████████▌ | 306/358 [00:31<00:05,  9.81it/s] 86%|████████▌ | 308/358 [00:31<00:05,  9.91it/s] 86%|████████▋ | 309/358 [00:31<00:04,  9.81it/s] 87%|████████▋ | 310/358 [00:31<00:04,  9.76it/s] 87%|████████▋ | 311/358 [00:31<00:04,  9.68it/s] 87%|████████▋ | 312/358 [00:31<00:04,  9.70it/s] 87%|████████▋ | 313/358 [00:31<00:04,  9.72it/s] 88%|████████▊ | 315/358 [00:32<00:04,  9.98it/s] 88%|████████▊ | 316/358 [00:32<00:04,  9.92it/s] 89%|████████▊ | 317/358 [00:32<00:04,  9.84it/s] 89%|████████▉ | 318/358 [00:32<00:04,  9.79it/s] 89%|████████▉ | 319/358 [00:32<00:04,  9.75it/s] 89%|████████▉ | 320/358 [00:32<00:03,  9.80it/s] 90%|████████▉ | 321/358 [00:32<00:03,  9.73it/s] 90%|████████▉ | 322/358 [00:32<00:03,  9.69it/s] 90%|█████████ | 323/358 [00:32<00:03,  9.65it/s] 91%|█████████ | 324/358 [00:33<00:03,  9.62it/s] 91%|█████████ | 325/358 [00:33<00:03,  9.59it/s] 91%|█████████▏| 327/358 [00:33<00:03,  9.95it/s] 92%|█████████▏| 329/358 [00:33<00:02, 10.06it/s] 92%|█████████▏| 330/358 [00:33<00:02,  9.94it/s] 93%|█████████▎| 332/358 [00:33<00:02, 10.05it/s] 93%|█████████▎| 334/358 [00:34<00:02,  9.95it/s] 94%|█████████▎| 335/358 [00:34<00:02,  9.83it/s] 94%|█████████▍| 337/358 [00:34<00:02,  9.90it/s] 95%|█████████▍| 339/358 [00:34<00:01, 10.10it/s] 95%|█████████▌| 341/358 [00:34<00:01, 10.05it/s] 96%|█████████▌| 343/358 [00:35<00:01,  9.89it/s] 96%|█████████▌| 344/358 [00:35<00:01,  9.83it/s] 96%|█████████▋| 345/358 [00:35<00:01,  9.85it/s] 97%|█████████▋| 346/358 [00:35<00:01,  9.88it/s] 97%|█████████▋| 348/358 [00:35<00:01,  9.97it/s] 97%|█████████▋| 349/358 [00:35<00:00,  9.89it/s] 98%|█████████▊| 350/358 [00:35<00:00,  9.81it/s] 98%|█████████▊| 351/358 [00:35<00:00,  9.76it/s] 99%|█████████▊| 353/358 [00:36<00:00,  9.92it/s] 99%|█████████▉| 354/358 [00:36<00:00,  9.90it/s] 99%|█████████▉| 355/358 [00:36<00:00,  9.81it/s]100%|█████████▉| 357/358 [00:36<00:00,  9.87it/s]100%|██████████| 358/358 [00:36<00:00,  9.81it/s]
[32m2025-02-05 05:12:15.689[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    gen_loss  grad clip ratio  grad norm   ppl
       3.427                1      6.243 30.78[0m
[32m2025-02-05 05:12:15.689[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m169[0m - [1m[Valid][0m
  0%|          | 0/10256 [00:00<?, ?it/s]100%|██████████| 10256/10256 [00:00<00:00, 1022359.11it/s]
[32m2025-02-05 05:12:15.700[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:26,  1.50it/s]  5%|▌         | 2/40 [00:01<00:25,  1.51it/s]  8%|▊         | 3/40 [00:01<00:24,  1.52it/s] 10%|█         | 4/40 [00:02<00:23,  1.52it/s] 12%|█▎        | 5/40 [00:03<00:23,  1.51it/s] 15%|█▌        | 6/40 [00:03<00:22,  1.51it/s] 18%|█▊        | 7/40 [00:04<00:21,  1.50it/s] 20%|██        | 8/40 [00:05<00:21,  1.51it/s] 22%|██▎       | 9/40 [00:05<00:20,  1.50it/s] 25%|██▌       | 10/40 [00:06<00:19,  1.51it/s] 28%|██▊       | 11/40 [00:07<00:19,  1.51it/s] 30%|███       | 12/40 [00:07<00:18,  1.51it/s] 32%|███▎      | 13/40 [00:08<00:17,  1.51it/s] 35%|███▌      | 14/40 [00:09<00:17,  1.50it/s] 38%|███▊      | 15/40 [00:09<00:16,  1.50it/s] 40%|████      | 16/40 [00:10<00:16,  1.50it/s] 42%|████▎     | 17/40 [00:11<00:15,  1.50it/s] 45%|████▌     | 18/40 [00:11<00:14,  1.51it/s] 48%|████▊     | 19/40 [00:12<00:13,  1.51it/s] 50%|█████     | 20/40 [00:13<00:13,  1.51it/s] 52%|█████▎    | 21/40 [00:13<00:12,  1.51it/s] 55%|█████▌    | 22/40 [00:14<00:11,  1.51it/s] 57%|█████▊    | 23/40 [00:15<00:11,  1.51it/s] 60%|██████    | 24/40 [00:15<00:10,  1.50it/s] 62%|██████▎   | 25/40 [00:16<00:09,  1.51it/s] 65%|██████▌   | 26/40 [00:17<00:09,  1.52it/s] 68%|██████▊   | 27/40 [00:17<00:08,  1.51it/s] 70%|███████   | 28/40 [00:18<00:07,  1.51it/s] 72%|███████▎  | 29/40 [00:19<00:07,  1.51it/s] 75%|███████▌  | 30/40 [00:19<00:06,  1.51it/s] 78%|███████▊  | 31/40 [00:20<00:05,  1.51it/s] 80%|████████  | 32/40 [00:21<00:05,  1.51it/s] 82%|████████▎ | 33/40 [00:21<00:04,  1.50it/s] 85%|████████▌ | 34/40 [00:22<00:03,  1.51it/s] 88%|████████▊ | 35/40 [00:23<00:03,  1.50it/s] 90%|█████████ | 36/40 [00:23<00:02,  1.50it/s] 92%|█████████▎| 37/40 [00:24<00:01,  1.50it/s] 95%|█████████▌| 38/40 [00:25<00:01,  1.49it/s] 98%|█████████▊| 39/40 [00:25<00:00,  1.49it/s]100%|██████████| 40/40 [00:26<00:00,  1.65it/s]100%|██████████| 40/40 [00:26<00:00,  1.52it/s]
[32m2025-02-05 05:12:42.065[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    average  bleu@1  bleu@2  bleu@3  bleu@4  dist@1  dist@2  dist@3  dist@4  extreme  \
      .7744   .2829  .09652  .03567  .01923  .01875   .1724   .4657   .7004    .5889   
      f1  gen_loss  greedy  intra_dist@1  intra_dist@2  intra_dist@3  intra_dist@4  \
   .3566     3.787   .6733         .9154         .9914         .9669         .8963   
     ppl  rouge1  rouge2  rougeL  
   44.13   .3872  .08448   .3739[0m
[32m2025-02-05 05:12:42.068[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m163[0m - [1m[Conversation epoch 4][0m
[32m2025-02-05 05:12:42.068[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m164[0m - [1m[Train][0m
  0%|          | 0/92414 [00:00<?, ?it/s]100%|██████████| 92414/92414 [00:00<00:00, 978485.64it/s]
[32m2025-02-05 05:12:42.163[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/358 [00:00<?, ?it/s]  0%|          | 1/358 [00:00<00:36,  9.72it/s]  1%|          | 3/358 [00:00<00:35,  9.92it/s]  1%|          | 4/358 [00:00<00:35,  9.89it/s]  2%|▏         | 6/358 [00:00<00:35,  9.86it/s]  2%|▏         | 7/358 [00:00<00:35,  9.80it/s]  2%|▏         | 8/358 [00:00<00:35,  9.85it/s]  3%|▎         | 9/358 [00:00<00:35,  9.75it/s]  3%|▎         | 10/358 [00:01<00:35,  9.74it/s]  3%|▎         | 11/358 [00:01<00:35,  9.69it/s]  4%|▎         | 13/358 [00:01<00:34,  9.91it/s]  4%|▍         | 14/358 [00:01<00:34,  9.84it/s]  4%|▍         | 15/358 [00:01<00:35,  9.76it/s]  4%|▍         | 16/358 [00:01<00:35,  9.70it/s]  5%|▍         | 17/358 [00:01<00:35,  9.71it/s]  5%|▌         | 18/358 [00:01<00:34,  9.79it/s]  5%|▌         | 19/358 [00:01<00:34,  9.71it/s]  6%|▌         | 20/358 [00:02<00:34,  9.66it/s]  6%|▌         | 21/358 [00:02<00:35,  9.59it/s]  6%|▌         | 22/358 [00:02<00:34,  9.66it/s]  7%|▋         | 24/358 [00:02<00:34,  9.76it/s]  7%|▋         | 25/358 [00:02<00:34,  9.71it/s]  7%|▋         | 26/358 [00:02<00:34,  9.66it/s]  8%|▊         | 27/358 [00:02<00:34,  9.71it/s]  8%|▊         | 28/358 [00:02<00:34,  9.67it/s]  8%|▊         | 29/358 [00:02<00:34,  9.63it/s]  9%|▊         | 31/358 [00:03<00:33,  9.74it/s]  9%|▉         | 32/358 [00:03<00:33,  9.74it/s]  9%|▉         | 34/358 [00:03<00:32,  9.84it/s] 10%|█         | 36/358 [00:03<00:32,  9.83it/s] 10%|█         | 37/358 [00:03<00:32,  9.82it/s] 11%|█         | 38/358 [00:03<00:32,  9.77it/s] 11%|█         | 40/358 [00:04<00:32,  9.94it/s] 11%|█▏        | 41/358 [00:04<00:32,  9.85it/s] 12%|█▏        | 43/358 [00:04<00:31,  9.87it/s] 13%|█▎        | 45/358 [00:04<00:31,  9.97it/s] 13%|█▎        | 47/358 [00:04<00:31,  9.94it/s] 13%|█▎        | 48/358 [00:04<00:31,  9.93it/s] 14%|█▍        | 50/358 [00:05<00:31,  9.90it/s] 14%|█▍        | 51/358 [00:05<00:31,  9.83it/s] 15%|█▍        | 52/358 [00:05<00:31,  9.74it/s] 15%|█▍        | 53/358 [00:05<00:31,  9.69it/s] 15%|█▌        | 54/358 [00:05<00:31,  9.73it/s] 15%|█▌        | 55/358 [00:05<00:31,  9.68it/s] 16%|█▌        | 56/358 [00:05<00:31,  9.72it/s] 16%|█▌        | 57/358 [00:05<00:31,  9.68it/s] 16%|█▌        | 58/358 [00:05<00:31,  9.66it/s] 16%|█▋        | 59/358 [00:06<00:31,  9.63it/s] 17%|█▋        | 61/358 [00:06<00:30,  9.72it/s] 17%|█▋        | 62/358 [00:06<00:30,  9.64it/s] 18%|█▊        | 63/358 [00:06<00:30,  9.70it/s] 18%|█▊        | 64/358 [00:06<00:30,  9.65it/s] 18%|█▊        | 66/358 [00:06<00:30,  9.72it/s] 19%|█▊        | 67/358 [00:06<00:29,  9.71it/s] 19%|█▉        | 69/358 [00:07<00:29,  9.77it/s] 20%|█▉        | 70/358 [00:07<00:29,  9.72it/s] 20%|█▉        | 71/358 [00:07<00:29,  9.76it/s] 20%|██        | 72/358 [00:07<00:29,  9.71it/s] 20%|██        | 73/358 [00:07<00:29,  9.68it/s] 21%|██        | 74/358 [00:07<00:29,  9.65it/s] 21%|██        | 75/358 [00:07<00:29,  9.61it/s] 21%|██        | 76/358 [00:07<00:29,  9.71it/s] 22%|██▏       | 77/358 [00:07<00:29,  9.68it/s] 22%|██▏       | 79/358 [00:08<00:28,  9.69it/s] 23%|██▎       | 81/358 [00:08<00:28,  9.75it/s] 23%|██▎       | 83/358 [00:08<00:28,  9.77it/s] 23%|██▎       | 84/358 [00:08<00:28,  9.72it/s] 24%|██▎       | 85/358 [00:08<00:28,  9.67it/s] 24%|██▍       | 86/358 [00:08<00:28,  9.66it/s] 24%|██▍       | 87/358 [00:08<00:28,  9.64it/s] 25%|██▍       | 88/358 [00:09<00:27,  9.66it/s] 25%|██▌       | 90/358 [00:09<00:27,  9.90it/s] 26%|██▌       | 92/358 [00:09<00:26, 10.00it/s] 26%|██▌       | 93/358 [00:09<00:26,  9.96it/s] 26%|██▋       | 94/358 [00:09<00:26,  9.87it/s] 27%|██▋       | 96/358 [00:09<00:25, 10.15it/s] 27%|██▋       | 98/358 [00:10<00:25, 10.04it/s] 28%|██▊       | 99/358 [00:10<00:26,  9.95it/s] 28%|██▊       | 101/358 [00:10<00:25,  9.92it/s] 29%|██▉       | 103/358 [00:10<00:25,  9.91it/s] 29%|██▉       | 104/358 [00:10<00:25,  9.86it/s] 29%|██▉       | 105/358 [00:10<00:25,  9.78it/s] 30%|██▉       | 106/358 [00:10<00:25,  9.77it/s] 30%|███       | 108/358 [00:11<00:25,  9.80it/s] 30%|███       | 109/358 [00:11<00:25,  9.71it/s] 31%|███       | 110/358 [00:11<00:25,  9.69it/s] 31%|███       | 111/358 [00:11<00:25,  9.64it/s] 32%|███▏      | 113/358 [00:11<00:24,  9.91it/s] 32%|███▏      | 114/358 [00:11<00:24,  9.87it/s] 32%|███▏      | 115/358 [00:11<00:24,  9.77it/s] 32%|███▏      | 116/358 [00:11<00:24,  9.69it/s] 33%|███▎      | 117/358 [00:11<00:24,  9.66it/s] 33%|███▎      | 119/358 [00:12<00:24,  9.78it/s] 34%|███▍      | 121/358 [00:12<00:23,  9.97it/s] 34%|███▍      | 123/358 [00:12<00:23, 10.08it/s] 35%|███▍      | 125/358 [00:12<00:23, 10.05it/s] 35%|███▌      | 127/358 [00:12<00:23,  9.98it/s] 36%|███▌      | 128/358 [00:13<00:23,  9.94it/s] 36%|███▋      | 130/358 [00:13<00:22,  9.98it/s] 37%|███▋      | 131/358 [00:13<00:22,  9.89it/s] 37%|███▋      | 132/358 [00:13<00:22,  9.91it/s] 37%|███▋      | 134/358 [00:13<00:22,  9.93it/s] 38%|███▊      | 135/358 [00:13<00:22,  9.87it/s] 38%|███▊      | 137/358 [00:13<00:22,  9.95it/s] 39%|███▊      | 138/358 [00:14<00:22,  9.93it/s] 39%|███▉      | 139/358 [00:14<00:22,  9.84it/s] 39%|███▉      | 141/358 [00:14<00:21,  9.97it/s] 40%|███▉      | 142/358 [00:14<00:21,  9.89it/s] 40%|███▉      | 143/358 [00:14<00:21,  9.86it/s] 40%|████      | 144/358 [00:14<00:21,  9.77it/s] 41%|████      | 145/358 [00:14<00:21,  9.79it/s] 41%|████      | 146/358 [00:14<00:21,  9.72it/s] 41%|████      | 147/358 [00:14<00:21,  9.67it/s] 41%|████▏     | 148/358 [00:15<00:21,  9.70it/s] 42%|████▏     | 149/358 [00:15<00:21,  9.68it/s] 42%|████▏     | 150/358 [00:15<00:21,  9.64it/s] 42%|████▏     | 151/358 [00:15<00:22,  9.38it/s] 42%|████▏     | 152/358 [00:15<00:21,  9.43it/s] 43%|████▎     | 153/358 [00:15<00:21,  9.44it/s] 43%|████▎     | 154/358 [00:15<00:21,  9.54it/s] 43%|████▎     | 155/358 [00:15<00:21,  9.55it/s] 44%|████▎     | 156/358 [00:15<00:20,  9.67it/s] 44%|████▍     | 157/358 [00:16<00:20,  9.61it/s] 44%|████▍     | 158/358 [00:16<00:20,  9.70it/s] 44%|████▍     | 159/358 [00:16<00:20,  9.69it/s] 45%|████▍     | 160/358 [00:16<00:20,  9.70it/s] 45%|████▌     | 162/358 [00:16<00:19,  9.99it/s] 46%|████▌     | 164/358 [00:16<00:19, 10.00it/s] 46%|████▌     | 165/358 [00:16<00:19,  9.95it/s] 47%|████▋     | 167/358 [00:17<00:19,  9.89it/s] 47%|████▋     | 169/358 [00:17<00:19,  9.94it/s] 48%|████▊     | 171/358 [00:17<00:18,  9.92it/s] 48%|████▊     | 172/358 [00:17<00:18,  9.87it/s] 48%|████▊     | 173/358 [00:17<00:18,  9.80it/s] 49%|████▉     | 175/358 [00:17<00:18,  9.83it/s] 49%|████▉     | 176/358 [00:17<00:18,  9.84it/s] 49%|████▉     | 177/358 [00:18<00:18,  9.83it/s] 50%|█████     | 179/358 [00:18<00:18,  9.85it/s] 50%|█████     | 180/358 [00:18<00:18,  9.78it/s] 51%|█████     | 182/358 [00:18<00:17,  9.93it/s] 51%|█████     | 183/358 [00:18<00:17,  9.88it/s] 51%|█████▏    | 184/358 [00:18<00:17,  9.77it/s] 52%|█████▏    | 185/358 [00:18<00:17,  9.72it/s] 52%|█████▏    | 187/358 [00:19<00:17,  9.94it/s] 53%|█████▎    | 188/358 [00:19<00:17,  9.88it/s] 53%|█████▎    | 189/358 [00:19<00:17,  9.82it/s] 53%|█████▎    | 191/358 [00:19<00:17,  9.75it/s] 54%|█████▎    | 192/358 [00:19<00:17,  9.69it/s] 54%|█████▍    | 193/358 [00:19<00:17,  9.69it/s] 54%|█████▍    | 194/358 [00:19<00:16,  9.66it/s] 54%|█████▍    | 195/358 [00:19<00:16,  9.73it/s] 55%|█████▌    | 197/358 [00:20<00:16,  9.91it/s] 55%|█████▌    | 198/358 [00:20<00:16,  9.83it/s] 56%|█████▌    | 199/358 [00:20<00:16,  9.86it/s] 56%|█████▌    | 200/358 [00:20<00:16,  9.80it/s] 56%|█████▌    | 201/358 [00:20<00:16,  9.76it/s] 57%|█████▋    | 203/358 [00:20<00:15,  9.84it/s] 57%|█████▋    | 204/358 [00:20<00:15,  9.74it/s] 57%|█████▋    | 205/358 [00:20<00:15,  9.70it/s] 58%|█████▊    | 207/358 [00:21<00:15,  9.87it/s] 58%|█████▊    | 208/358 [00:21<00:15,  9.79it/s] 59%|█████▊    | 210/358 [00:21<00:15,  9.81it/s] 59%|█████▉    | 212/358 [00:21<00:14,  9.81it/s] 60%|█████▉    | 214/358 [00:21<00:14,  9.88it/s] 60%|██████    | 215/358 [00:21<00:14,  9.82it/s] 60%|██████    | 216/358 [00:22<00:14,  9.76it/s] 61%|██████    | 217/358 [00:22<00:14,  9.79it/s] 61%|██████    | 218/358 [00:22<00:14,  9.76it/s] 61%|██████    | 219/358 [00:22<00:14,  9.77it/s] 62%|██████▏   | 221/358 [00:22<00:13,  9.90it/s] 62%|██████▏   | 222/358 [00:22<00:13,  9.80it/s] 62%|██████▏   | 223/358 [00:22<00:13,  9.74it/s] 63%|██████▎   | 224/358 [00:22<00:13,  9.69it/s] 63%|██████▎   | 225/358 [00:22<00:13,  9.77it/s] 63%|██████▎   | 226/358 [00:23<00:13,  9.72it/s] 64%|██████▎   | 228/358 [00:23<00:13,  9.76it/s] 64%|██████▍   | 229/358 [00:23<00:13,  9.73it/s] 64%|██████▍   | 230/358 [00:23<00:13,  9.67it/s] 65%|██████▍   | 232/358 [00:23<00:12,  9.72it/s] 65%|██████▌   | 234/358 [00:23<00:12, 10.02it/s] 66%|██████▌   | 236/358 [00:24<00:12,  9.98it/s] 66%|██████▋   | 238/358 [00:24<00:11, 10.03it/s] 67%|██████▋   | 240/358 [00:24<00:11,  9.99it/s] 68%|██████▊   | 242/358 [00:24<00:11,  9.97it/s] 68%|██████▊   | 243/358 [00:24<00:11,  9.91it/s] 68%|██████▊   | 244/358 [00:24<00:11,  9.84it/s] 69%|██████▊   | 246/358 [00:25<00:11,  9.86it/s] 69%|██████▉   | 247/358 [00:25<00:11,  9.79it/s] 69%|██████▉   | 248/358 [00:25<00:11,  9.74it/s] 70%|██████▉   | 250/358 [00:25<00:10,  9.84it/s] 70%|███████   | 251/358 [00:25<00:10,  9.78it/s] 70%|███████   | 252/358 [00:25<00:10,  9.72it/s] 71%|███████   | 253/358 [00:25<00:10,  9.68it/s] 71%|███████   | 254/358 [00:25<00:10,  9.65it/s] 72%|███████▏  | 256/358 [00:26<00:10,  9.83it/s] 72%|███████▏  | 257/358 [00:26<00:10,  9.83it/s] 72%|███████▏  | 258/358 [00:26<00:10,  9.70it/s] 72%|███████▏  | 259/358 [00:26<00:10,  9.67it/s] 73%|███████▎  | 260/358 [00:26<00:10,  9.71it/s] 73%|███████▎  | 262/358 [00:26<00:09,  9.89it/s] 74%|███████▎  | 264/358 [00:26<00:09,  9.90it/s] 74%|███████▍  | 266/358 [00:27<00:09,  9.90it/s] 75%|███████▍  | 267/358 [00:27<00:09,  9.84it/s] 75%|███████▌  | 269/358 [00:27<00:08,  9.89it/s] 75%|███████▌  | 270/358 [00:27<00:08,  9.81it/s] 76%|███████▌  | 271/358 [00:27<00:08,  9.75it/s] 76%|███████▌  | 272/358 [00:27<00:08,  9.72it/s] 76%|███████▋  | 273/358 [00:27<00:08,  9.63it/s] 77%|███████▋  | 274/358 [00:27<00:08,  9.62it/s] 77%|███████▋  | 275/358 [00:28<00:08,  9.67it/s] 77%|███████▋  | 276/358 [00:28<00:08,  9.68it/s] 77%|███████▋  | 277/358 [00:28<00:08,  9.65it/s] 78%|███████▊  | 278/358 [00:28<00:08,  9.62it/s] 78%|███████▊  | 280/358 [00:28<00:07,  9.81it/s] 78%|███████▊  | 281/358 [00:28<00:07,  9.82it/s] 79%|███████▉  | 282/358 [00:28<00:07,  9.76it/s] 79%|███████▉  | 283/358 [00:28<00:07,  9.70it/s] 79%|███████▉  | 284/358 [00:28<00:07,  9.66it/s] 80%|███████▉  | 285/358 [00:29<00:07,  9.73it/s] 80%|███████▉  | 286/358 [00:29<00:07,  9.68it/s] 80%|████████  | 287/358 [00:29<00:07,  9.66it/s] 80%|████████  | 288/358 [00:29<00:07,  9.62it/s] 81%|████████  | 290/358 [00:29<00:06,  9.84it/s] 81%|████████▏ | 291/358 [00:29<00:06,  9.82it/s] 82%|████████▏ | 293/358 [00:29<00:06,  9.83it/s] 82%|████████▏ | 295/358 [00:30<00:06,  9.90it/s] 83%|████████▎ | 296/358 [00:30<00:06,  9.84it/s] 83%|████████▎ | 297/358 [00:30<00:06,  9.73it/s] 84%|████████▎ | 299/358 [00:30<00:05,  9.89it/s] 84%|████████▍ | 301/358 [00:30<00:05,  9.93it/s] 84%|████████▍ | 302/358 [00:30<00:05,  9.86it/s] 85%|████████▍ | 303/358 [00:30<00:05,  9.87it/s] 85%|████████▌ | 305/358 [00:31<00:05,  9.90it/s] 85%|████████▌ | 306/358 [00:31<00:05,  9.82it/s] 86%|████████▌ | 308/358 [00:31<00:05,  9.92it/s] 86%|████████▋ | 309/358 [00:31<00:04,  9.82it/s] 87%|████████▋ | 310/358 [00:31<00:04,  9.76it/s] 87%|████████▋ | 311/358 [00:31<00:04,  9.68it/s] 87%|████████▋ | 312/358 [00:31<00:04,  9.70it/s] 87%|████████▋ | 313/358 [00:31<00:04,  9.72it/s] 88%|████████▊ | 315/358 [00:32<00:04,  9.98it/s] 88%|████████▊ | 316/358 [00:32<00:04,  9.92it/s] 89%|████████▊ | 317/358 [00:32<00:04,  9.84it/s] 89%|████████▉ | 318/358 [00:32<00:04,  9.79it/s] 89%|████████▉ | 319/358 [00:32<00:04,  9.75it/s] 89%|████████▉ | 320/358 [00:32<00:03,  9.81it/s] 90%|████████▉ | 321/358 [00:32<00:03,  9.74it/s] 90%|████████▉ | 322/358 [00:32<00:03,  9.70it/s] 90%|█████████ | 323/358 [00:32<00:03,  9.65it/s] 91%|█████████ | 324/358 [00:33<00:03,  9.62it/s] 91%|█████████ | 325/358 [00:33<00:03,  9.60it/s] 91%|█████████▏| 327/358 [00:33<00:03,  9.96it/s] 92%|█████████▏| 329/358 [00:33<00:02, 10.06it/s] 92%|█████████▏| 330/358 [00:33<00:02,  9.95it/s] 93%|█████████▎| 332/358 [00:33<00:02, 10.05it/s] 93%|█████████▎| 334/358 [00:34<00:02,  9.95it/s] 94%|█████████▎| 335/358 [00:34<00:02,  9.83it/s] 94%|█████████▍| 337/358 [00:34<00:02,  9.91it/s] 95%|█████████▍| 339/358 [00:34<00:01, 10.11it/s] 95%|█████████▌| 341/358 [00:34<00:01, 10.05it/s] 96%|█████████▌| 343/358 [00:34<00:01,  9.90it/s] 96%|█████████▌| 344/358 [00:35<00:01,  9.84it/s] 96%|█████████▋| 345/358 [00:35<00:01,  9.86it/s] 97%|█████████▋| 347/358 [00:35<00:01, 10.03it/s] 97%|█████████▋| 348/358 [00:35<00:01,  9.94it/s] 97%|█████████▋| 349/358 [00:35<00:00,  9.85it/s] 98%|█████████▊| 350/358 [00:35<00:00,  9.78it/s] 98%|█████████▊| 351/358 [00:35<00:00,  9.73it/s] 99%|█████████▊| 353/358 [00:35<00:00,  9.91it/s] 99%|█████████▉| 354/358 [00:36<00:00,  9.90it/s] 99%|█████████▉| 355/358 [00:36<00:00,  9.82it/s]100%|█████████▉| 357/358 [00:36<00:00,  9.87it/s]100%|██████████| 358/358 [00:36<00:00,  9.82it/s]
[32m2025-02-05 05:13:18.632[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    gen_loss  grad clip ratio  grad norm   ppl
       3.265                1      5.663 26.18[0m
[32m2025-02-05 05:13:18.632[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m169[0m - [1m[Valid][0m
  0%|          | 0/10256 [00:00<?, ?it/s]100%|██████████| 10256/10256 [00:00<00:00, 1041644.23it/s]
[32m2025-02-05 05:13:18.642[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:26,  1.49it/s]  5%|▌         | 2/40 [00:01<00:25,  1.50it/s]  8%|▊         | 3/40 [00:01<00:24,  1.50it/s] 10%|█         | 4/40 [00:02<00:23,  1.50it/s] 12%|█▎        | 5/40 [00:03<00:23,  1.50it/s] 15%|█▌        | 6/40 [00:04<00:22,  1.49it/s] 18%|█▊        | 7/40 [00:04<00:22,  1.49it/s] 20%|██        | 8/40 [00:05<00:21,  1.50it/s] 22%|██▎       | 9/40 [00:06<00:20,  1.50it/s] 25%|██▌       | 10/40 [00:06<00:19,  1.50it/s] 28%|██▊       | 11/40 [00:07<00:19,  1.50it/s] 30%|███       | 12/40 [00:08<00:18,  1.50it/s] 32%|███▎      | 13/40 [00:08<00:18,  1.50it/s] 35%|███▌      | 14/40 [00:09<00:17,  1.49it/s] 38%|███▊      | 15/40 [00:10<00:16,  1.49it/s] 40%|████      | 16/40 [00:10<00:16,  1.49it/s] 42%|████▎     | 17/40 [00:11<00:15,  1.50it/s] 45%|████▌     | 18/40 [00:12<00:14,  1.50it/s] 48%|████▊     | 19/40 [00:12<00:14,  1.49it/s] 50%|█████     | 20/40 [00:13<00:13,  1.50it/s] 52%|█████▎    | 21/40 [00:14<00:12,  1.51it/s] 55%|█████▌    | 22/40 [00:14<00:12,  1.50it/s] 57%|█████▊    | 23/40 [00:15<00:11,  1.50it/s] 60%|██████    | 24/40 [00:16<00:10,  1.49it/s] 62%|██████▎   | 25/40 [00:16<00:10,  1.49it/s] 65%|██████▌   | 26/40 [00:17<00:09,  1.50it/s] 68%|██████▊   | 27/40 [00:18<00:08,  1.50it/s] 70%|███████   | 28/40 [00:18<00:08,  1.50it/s] 72%|███████▎  | 29/40 [00:19<00:07,  1.50it/s] 75%|███████▌  | 30/40 [00:20<00:06,  1.51it/s] 78%|███████▊  | 31/40 [00:20<00:05,  1.50it/s] 80%|████████  | 32/40 [00:21<00:05,  1.50it/s] 82%|████████▎ | 33/40 [00:22<00:04,  1.50it/s] 85%|████████▌ | 34/40 [00:22<00:04,  1.50it/s] 88%|████████▊ | 35/40 [00:23<00:03,  1.49it/s] 90%|█████████ | 36/40 [00:24<00:02,  1.49it/s] 92%|█████████▎| 37/40 [00:24<00:02,  1.49it/s] 95%|█████████▌| 38/40 [00:25<00:01,  1.48it/s] 98%|█████████▊| 39/40 [00:26<00:00,  1.48it/s]100%|██████████| 40/40 [00:26<00:00,  1.64it/s]100%|██████████| 40/40 [00:26<00:00,  1.51it/s]
[32m2025-02-05 05:13:45.188[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    average  bleu@1  bleu@2  bleu@3  bleu@4  dist@1  dist@2  dist@3  dist@4  extreme  \
      .7802   .2881  .09794  .03358  .01838  .02124   .1739   .4694   .7086    .5943   
      f1  gen_loss  greedy  intra_dist@1  intra_dist@2  intra_dist@3  intra_dist@4  \
   .3607     3.794   .6769         .8940         .9879         .9715         .9180   
     ppl  rouge1  rouge2  rougeL  
   44.42   .3906  .08444   .3770[0m
[32m2025-02-05 05:13:45.192[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m163[0m - [1m[Conversation epoch 5][0m
[32m2025-02-05 05:13:45.192[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m164[0m - [1m[Train][0m
  0%|          | 0/92414 [00:00<?, ?it/s]100%|██████████| 92414/92414 [00:00<00:00, 982630.63it/s]
[32m2025-02-05 05:13:45.286[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/358 [00:00<?, ?it/s]  0%|          | 1/358 [00:00<00:36,  9.73it/s]  1%|          | 3/358 [00:00<00:35,  9.92it/s]  1%|          | 4/358 [00:00<00:35,  9.90it/s]  2%|▏         | 6/358 [00:00<00:35,  9.86it/s]  2%|▏         | 7/358 [00:00<00:35,  9.80it/s]  2%|▏         | 8/358 [00:00<00:35,  9.85it/s]  3%|▎         | 9/358 [00:00<00:35,  9.75it/s]  3%|▎         | 10/358 [00:01<00:35,  9.74it/s]  3%|▎         | 11/358 [00:01<00:35,  9.69it/s]  4%|▎         | 13/358 [00:01<00:34,  9.91it/s]  4%|▍         | 14/358 [00:01<00:34,  9.83it/s]  4%|▍         | 15/358 [00:01<00:35,  9.76it/s]  4%|▍         | 16/358 [00:01<00:35,  9.69it/s]  5%|▍         | 17/358 [00:01<00:35,  9.71it/s]  5%|▌         | 18/358 [00:01<00:34,  9.79it/s]  5%|▌         | 19/358 [00:01<00:34,  9.72it/s]  6%|▌         | 20/358 [00:02<00:34,  9.66it/s]  6%|▌         | 21/358 [00:02<00:35,  9.59it/s]  6%|▌         | 22/358 [00:02<00:34,  9.66it/s]  7%|▋         | 24/358 [00:02<00:34,  9.76it/s]  7%|▋         | 25/358 [00:02<00:34,  9.71it/s]  7%|▋         | 26/358 [00:02<00:34,  9.66it/s]  8%|▊         | 27/358 [00:02<00:34,  9.72it/s]  8%|▊         | 28/358 [00:02<00:34,  9.67it/s]  8%|▊         | 29/358 [00:02<00:34,  9.64it/s]  9%|▊         | 31/358 [00:03<00:33,  9.74it/s]  9%|▉         | 32/358 [00:03<00:33,  9.74it/s]  9%|▉         | 34/358 [00:03<00:32,  9.84it/s] 10%|█         | 36/358 [00:03<00:32,  9.84it/s] 10%|█         | 37/358 [00:03<00:32,  9.82it/s] 11%|█         | 38/358 [00:03<00:32,  9.77it/s] 11%|█         | 40/358 [00:04<00:32,  9.93it/s] 11%|█▏        | 41/358 [00:04<00:32,  9.85it/s] 12%|█▏        | 43/358 [00:04<00:31,  9.87it/s] 13%|█▎        | 45/358 [00:04<00:31,  9.97it/s] 13%|█▎        | 47/358 [00:04<00:31,  9.94it/s] 13%|█▎        | 48/358 [00:04<00:31,  9.93it/s] 14%|█▍        | 50/358 [00:05<00:31,  9.90it/s] 14%|█▍        | 51/358 [00:05<00:31,  9.83it/s] 15%|█▍        | 52/358 [00:05<00:31,  9.75it/s] 15%|█▍        | 53/358 [00:05<00:31,  9.69it/s] 15%|█▌        | 54/358 [00:05<00:31,  9.73it/s] 15%|█▌        | 55/358 [00:05<00:31,  9.69it/s] 16%|█▌        | 56/358 [00:05<00:31,  9.73it/s] 16%|█▌        | 57/358 [00:05<00:31,  9.68it/s] 16%|█▌        | 58/358 [00:05<00:31,  9.66it/s] 16%|█▋        | 59/358 [00:06<00:31,  9.63it/s] 17%|█▋        | 61/358 [00:06<00:30,  9.71it/s] 17%|█▋        | 62/358 [00:06<00:30,  9.64it/s] 18%|█▊        | 63/358 [00:06<00:30,  9.70it/s] 18%|█▊        | 64/358 [00:06<00:30,  9.65it/s] 18%|█▊        | 66/358 [00:06<00:30,  9.72it/s] 19%|█▊        | 67/358 [00:06<00:29,  9.71it/s] 19%|█▉        | 69/358 [00:07<00:29,  9.77it/s] 20%|█▉        | 70/358 [00:07<00:29,  9.72it/s] 20%|█▉        | 71/358 [00:07<00:29,  9.76it/s] 20%|██        | 72/358 [00:07<00:29,  9.71it/s] 20%|██        | 73/358 [00:07<00:29,  9.68it/s] 21%|██        | 74/358 [00:07<00:29,  9.65it/s] 21%|██        | 75/358 [00:07<00:29,  9.61it/s] 21%|██        | 76/358 [00:07<00:29,  9.72it/s] 22%|██▏       | 77/358 [00:07<00:29,  9.68it/s] 22%|██▏       | 79/358 [00:08<00:28,  9.69it/s] 23%|██▎       | 81/358 [00:08<00:28,  9.75it/s] 23%|██▎       | 83/358 [00:08<00:28,  9.77it/s] 23%|██▎       | 84/358 [00:08<00:28,  9.72it/s] 24%|██▎       | 85/358 [00:08<00:28,  9.68it/s] 24%|██▍       | 86/358 [00:08<00:28,  9.66it/s] 24%|██▍       | 87/358 [00:08<00:28,  9.64it/s] 25%|██▍       | 88/358 [00:09<00:27,  9.66it/s] 25%|██▌       | 90/358 [00:09<00:27,  9.90it/s] 26%|██▌       | 92/358 [00:09<00:26, 10.00it/s] 26%|██▌       | 93/358 [00:09<00:26,  9.96it/s] 26%|██▋       | 94/358 [00:09<00:26,  9.88it/s] 27%|██▋       | 96/358 [00:09<00:25, 10.16it/s] 27%|██▋       | 98/358 [00:10<00:25, 10.05it/s] 28%|██▊       | 99/358 [00:10<00:26,  9.96it/s] 28%|██▊       | 101/358 [00:10<00:25,  9.92it/s] 29%|██▉       | 103/358 [00:10<00:25,  9.91it/s] 29%|██▉       | 104/358 [00:10<00:25,  9.86it/s] 29%|██▉       | 105/358 [00:10<00:25,  9.79it/s] 30%|██▉       | 106/358 [00:10<00:25,  9.77it/s] 30%|███       | 108/358 [00:11<00:25,  9.79it/s] 30%|███       | 109/358 [00:11<00:25,  9.70it/s] 31%|███       | 110/358 [00:11<00:25,  9.69it/s] 31%|███       | 111/358 [00:11<00:25,  9.64it/s] 32%|███▏      | 113/358 [00:11<00:24,  9.90it/s] 32%|███▏      | 114/358 [00:11<00:24,  9.86it/s] 32%|███▏      | 115/358 [00:11<00:24,  9.77it/s] 32%|███▏      | 116/358 [00:11<00:24,  9.68it/s] 33%|███▎      | 117/358 [00:11<00:24,  9.66it/s] 33%|███▎      | 119/358 [00:12<00:24,  9.78it/s] 34%|███▍      | 121/358 [00:12<00:23,  9.98it/s] 34%|███▍      | 123/358 [00:12<00:23, 10.07it/s] 35%|███▍      | 125/358 [00:12<00:23, 10.05it/s] 35%|███▌      | 127/358 [00:12<00:23,  9.98it/s] 36%|███▌      | 128/358 [00:13<00:23,  9.94it/s] 36%|███▋      | 130/358 [00:13<00:22,  9.99it/s] 37%|███▋      | 131/358 [00:13<00:22,  9.90it/s] 37%|███▋      | 132/358 [00:13<00:22,  9.91it/s] 37%|███▋      | 134/358 [00:13<00:22,  9.93it/s] 38%|███▊      | 135/358 [00:13<00:22,  9.87it/s] 38%|███▊      | 137/358 [00:13<00:22,  9.96it/s] 39%|███▊      | 138/358 [00:14<00:22,  9.94it/s] 39%|███▉      | 139/358 [00:14<00:22,  9.85it/s] 39%|███▉      | 141/358 [00:14<00:21,  9.97it/s] 40%|███▉      | 142/358 [00:14<00:21,  9.90it/s] 40%|███▉      | 143/358 [00:14<00:21,  9.86it/s] 40%|████      | 144/358 [00:14<00:21,  9.78it/s] 41%|████      | 145/358 [00:14<00:21,  9.80it/s] 41%|████      | 146/358 [00:14<00:21,  9.74it/s] 41%|████      | 147/358 [00:14<00:21,  9.68it/s] 41%|████▏     | 148/358 [00:15<00:21,  9.70it/s] 42%|████▏     | 149/358 [00:15<00:21,  9.69it/s] 42%|████▏     | 150/358 [00:15<00:21,  9.65it/s] 42%|████▏     | 151/358 [00:15<00:22,  9.38it/s] 42%|████▏     | 152/358 [00:15<00:21,  9.43it/s] 43%|████▎     | 153/358 [00:15<00:21,  9.45it/s] 43%|████▎     | 154/358 [00:15<00:21,  9.54it/s] 43%|████▎     | 155/358 [00:15<00:21,  9.55it/s] 44%|████▎     | 156/358 [00:15<00:20,  9.67it/s] 44%|████▍     | 157/358 [00:16<00:20,  9.62it/s] 44%|████▍     | 158/358 [00:16<00:20,  9.70it/s] 44%|████▍     | 159/358 [00:16<00:20,  9.70it/s] 45%|████▍     | 160/358 [00:16<00:20,  9.71it/s] 45%|████▌     | 162/358 [00:16<00:19, 10.00it/s] 46%|████▌     | 164/358 [00:16<00:19, 10.00it/s] 46%|████▌     | 165/358 [00:16<00:19,  9.95it/s] 47%|████▋     | 167/358 [00:17<00:19,  9.90it/s] 47%|████▋     | 169/358 [00:17<00:19,  9.94it/s] 48%|████▊     | 171/358 [00:17<00:18,  9.92it/s] 48%|████▊     | 172/358 [00:17<00:18,  9.87it/s] 48%|████▊     | 173/358 [00:17<00:18,  9.80it/s] 49%|████▉     | 175/358 [00:17<00:18,  9.83it/s] 49%|████▉     | 176/358 [00:17<00:18,  9.84it/s] 49%|████▉     | 177/358 [00:18<00:18,  9.83it/s] 50%|█████     | 179/358 [00:18<00:18,  9.85it/s] 50%|█████     | 180/358 [00:18<00:18,  9.78it/s] 51%|█████     | 182/358 [00:18<00:17,  9.93it/s] 51%|█████     | 183/358 [00:18<00:17,  9.89it/s] 51%|█████▏    | 184/358 [00:18<00:17,  9.77it/s] 52%|█████▏    | 185/358 [00:18<00:17,  9.72it/s] 52%|█████▏    | 187/358 [00:19<00:17,  9.93it/s] 53%|█████▎    | 188/358 [00:19<00:17,  9.88it/s] 53%|█████▎    | 189/358 [00:19<00:17,  9.82it/s] 53%|█████▎    | 191/358 [00:19<00:17,  9.74it/s] 54%|█████▎    | 192/358 [00:19<00:17,  9.68it/s] 54%|█████▍    | 193/358 [00:19<00:17,  9.68it/s] 54%|█████▍    | 194/358 [00:19<00:16,  9.66it/s] 54%|█████▍    | 195/358 [00:19<00:16,  9.73it/s] 55%|█████▌    | 197/358 [00:20<00:16,  9.90it/s] 55%|█████▌    | 198/358 [00:20<00:16,  9.83it/s] 56%|█████▌    | 199/358 [00:20<00:16,  9.86it/s] 56%|█████▌    | 200/358 [00:20<00:16,  9.80it/s] 56%|█████▌    | 201/358 [00:20<00:16,  9.75it/s] 57%|█████▋    | 203/358 [00:20<00:15,  9.85it/s] 57%|█████▋    | 204/358 [00:20<00:15,  9.74it/s] 57%|█████▋    | 205/358 [00:20<00:15,  9.70it/s] 58%|█████▊    | 207/358 [00:21<00:15,  9.86it/s] 58%|█████▊    | 208/358 [00:21<00:15,  9.79it/s] 59%|█████▊    | 210/358 [00:21<00:15,  9.81it/s] 59%|█████▉    | 212/358 [00:21<00:14,  9.80it/s] 60%|█████▉    | 214/358 [00:21<00:14,  9.88it/s] 60%|██████    | 215/358 [00:21<00:14,  9.82it/s] 60%|██████    | 216/358 [00:22<00:14,  9.75it/s] 61%|██████    | 217/358 [00:22<00:14,  9.79it/s] 61%|██████    | 218/358 [00:22<00:14,  9.76it/s] 61%|██████    | 219/358 [00:22<00:14,  9.76it/s] 62%|██████▏   | 221/358 [00:22<00:13,  9.90it/s] 62%|██████▏   | 222/358 [00:22<00:13,  9.80it/s] 62%|██████▏   | 223/358 [00:22<00:13,  9.74it/s] 63%|██████▎   | 224/358 [00:22<00:13,  9.69it/s] 63%|██████▎   | 225/358 [00:22<00:13,  9.77it/s] 63%|██████▎   | 226/358 [00:23<00:13,  9.71it/s] 64%|██████▎   | 228/358 [00:23<00:13,  9.75it/s] 64%|██████▍   | 229/358 [00:23<00:13,  9.72it/s] 64%|██████▍   | 230/358 [00:23<00:13,  9.67it/s] 65%|██████▍   | 232/358 [00:23<00:12,  9.72it/s] 65%|██████▌   | 234/358 [00:23<00:12, 10.02it/s] 66%|██████▌   | 236/358 [00:24<00:12,  9.98it/s] 66%|██████▋   | 238/358 [00:24<00:11, 10.02it/s] 67%|██████▋   | 240/358 [00:24<00:11,  9.99it/s] 68%|██████▊   | 242/358 [00:24<00:11,  9.97it/s] 68%|██████▊   | 243/358 [00:24<00:11,  9.91it/s] 68%|██████▊   | 244/358 [00:24<00:11,  9.84it/s] 69%|██████▊   | 246/358 [00:25<00:11,  9.86it/s] 69%|██████▉   | 247/358 [00:25<00:11,  9.79it/s] 69%|██████▉   | 248/358 [00:25<00:11,  9.75it/s] 70%|██████▉   | 250/358 [00:25<00:10,  9.84it/s] 70%|███████   | 251/358 [00:25<00:10,  9.78it/s] 70%|███████   | 252/358 [00:25<00:10,  9.72it/s] 71%|███████   | 253/358 [00:25<00:10,  9.68it/s] 71%|███████   | 254/358 [00:25<00:10,  9.65it/s] 72%|███████▏  | 256/358 [00:26<00:10,  9.83it/s] 72%|███████▏  | 257/358 [00:26<00:10,  9.83it/s] 72%|███████▏  | 258/358 [00:26<00:10,  9.71it/s] 72%|███████▏  | 259/358 [00:26<00:10,  9.67it/s] 73%|███████▎  | 260/358 [00:26<00:10,  9.71it/s] 73%|███████▎  | 262/358 [00:26<00:09,  9.88it/s] 74%|███████▎  | 264/358 [00:26<00:09,  9.90it/s] 74%|███████▍  | 266/358 [00:27<00:09,  9.89it/s] 75%|███████▍  | 267/358 [00:27<00:09,  9.83it/s] 75%|███████▌  | 269/358 [00:27<00:08,  9.89it/s] 75%|███████▌  | 270/358 [00:27<00:08,  9.82it/s] 76%|███████▌  | 271/358 [00:27<00:08,  9.75it/s] 76%|███████▌  | 272/358 [00:27<00:08,  9.73it/s] 76%|███████▋  | 273/358 [00:27<00:08,  9.63it/s] 77%|███████▋  | 274/358 [00:27<00:08,  9.62it/s] 77%|███████▋  | 275/358 [00:28<00:08,  9.67it/s] 77%|███████▋  | 276/358 [00:28<00:08,  9.67it/s] 77%|███████▋  | 277/358 [00:28<00:08,  9.65it/s] 78%|███████▊  | 278/358 [00:28<00:08,  9.63it/s] 78%|███████▊  | 280/358 [00:28<00:07,  9.82it/s] 78%|███████▊  | 281/358 [00:28<00:07,  9.83it/s] 79%|███████▉  | 282/358 [00:28<00:07,  9.76it/s] 79%|███████▉  | 283/358 [00:28<00:07,  9.70it/s] 79%|███████▉  | 284/358 [00:28<00:07,  9.67it/s] 80%|███████▉  | 285/358 [00:29<00:07,  9.73it/s] 80%|███████▉  | 286/358 [00:29<00:07,  9.68it/s] 80%|████████  | 287/358 [00:29<00:07,  9.66it/s] 80%|████████  | 288/358 [00:29<00:07,  9.62it/s] 81%|████████  | 290/358 [00:29<00:06,  9.84it/s] 81%|████████▏ | 291/358 [00:29<00:06,  9.81it/s] 82%|████████▏ | 293/358 [00:29<00:06,  9.83it/s] 82%|████████▏ | 295/358 [00:30<00:06,  9.90it/s] 83%|████████▎ | 296/358 [00:30<00:06,  9.84it/s] 83%|████████▎ | 297/358 [00:30<00:06,  9.73it/s] 84%|████████▎ | 299/358 [00:30<00:05,  9.88it/s] 84%|████████▍ | 301/358 [00:30<00:05,  9.92it/s] 84%|████████▍ | 302/358 [00:30<00:05,  9.86it/s] 85%|████████▍ | 303/358 [00:30<00:05,  9.87it/s] 85%|████████▌ | 305/358 [00:31<00:05,  9.90it/s] 85%|████████▌ | 306/358 [00:31<00:05,  9.82it/s] 86%|████████▌ | 308/358 [00:31<00:05,  9.92it/s] 86%|████████▋ | 309/358 [00:31<00:04,  9.82it/s] 87%|████████▋ | 310/358 [00:31<00:04,  9.76it/s] 87%|████████▋ | 311/358 [00:31<00:04,  9.69it/s] 87%|████████▋ | 312/358 [00:31<00:04,  9.70it/s] 87%|████████▋ | 313/358 [00:31<00:04,  9.72it/s] 88%|████████▊ | 315/358 [00:32<00:04,  9.98it/s] 88%|████████▊ | 316/358 [00:32<00:04,  9.93it/s] 89%|████████▊ | 317/358 [00:32<00:04,  9.84it/s] 89%|████████▉ | 318/358 [00:32<00:04,  9.80it/s] 89%|████████▉ | 319/358 [00:32<00:03,  9.75it/s] 89%|████████▉ | 320/358 [00:32<00:03,  9.81it/s] 90%|████████▉ | 321/358 [00:32<00:03,  9.74it/s] 90%|████████▉ | 322/358 [00:32<00:03,  9.70it/s] 90%|█████████ | 323/358 [00:32<00:03,  9.65it/s] 91%|█████████ | 324/358 [00:33<00:03,  9.62it/s] 91%|█████████ | 325/358 [00:33<00:03,  9.60it/s] 91%|█████████▏| 327/358 [00:33<00:03,  9.96it/s] 92%|█████████▏| 329/358 [00:33<00:02, 10.06it/s] 92%|█████████▏| 330/358 [00:33<00:02,  9.95it/s] 93%|█████████▎| 332/358 [00:33<00:02, 10.05it/s] 93%|█████████▎| 334/358 [00:34<00:02,  9.95it/s] 94%|█████████▎| 335/358 [00:34<00:02,  9.83it/s] 94%|█████████▍| 337/358 [00:34<00:02,  9.91it/s] 95%|█████████▍| 339/358 [00:34<00:01, 10.11it/s] 95%|█████████▌| 341/358 [00:34<00:01, 10.05it/s] 96%|█████████▌| 343/358 [00:34<00:01,  9.89it/s] 96%|█████████▌| 344/358 [00:35<00:01,  9.83it/s] 96%|█████████▋| 345/358 [00:35<00:01,  9.85it/s] 97%|█████████▋| 347/358 [00:35<00:01, 10.03it/s] 97%|█████████▋| 348/358 [00:35<00:01,  9.93it/s] 97%|█████████▋| 349/358 [00:35<00:00,  9.85it/s] 98%|█████████▊| 350/358 [00:35<00:00,  9.78it/s] 98%|█████████▊| 351/358 [00:35<00:00,  9.74it/s] 99%|█████████▊| 353/358 [00:35<00:00,  9.91it/s] 99%|█████████▉| 354/358 [00:36<00:00,  9.90it/s] 99%|█████████▉| 355/358 [00:36<00:00,  9.81it/s]100%|█████████▉| 357/358 [00:36<00:00,  9.86it/s]100%|██████████| 358/358 [00:36<00:00,  9.82it/s]
[32m2025-02-05 05:14:21.754[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    gen_loss  grad clip ratio  grad norm  ppl
       3.131                1       5.08 22.9[0m
[32m2025-02-05 05:14:21.754[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m169[0m - [1m[Valid][0m
  0%|          | 0/10256 [00:00<?, ?it/s]100%|██████████| 10256/10256 [00:00<00:00, 1052887.75it/s]
[32m2025-02-05 05:14:21.764[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:26,  1.49it/s]  5%|▌         | 2/40 [00:01<00:25,  1.50it/s]  8%|▊         | 3/40 [00:01<00:24,  1.50it/s] 10%|█         | 4/40 [00:02<00:23,  1.50it/s] 12%|█▎        | 5/40 [00:03<00:23,  1.50it/s] 15%|█▌        | 6/40 [00:04<00:22,  1.50it/s] 18%|█▊        | 7/40 [00:04<00:22,  1.50it/s] 20%|██        | 8/40 [00:05<00:21,  1.50it/s] 22%|██▎       | 9/40 [00:06<00:20,  1.50it/s] 25%|██▌       | 10/40 [00:06<00:19,  1.50it/s] 28%|██▊       | 11/40 [00:07<00:19,  1.50it/s] 30%|███       | 12/40 [00:08<00:18,  1.50it/s] 32%|███▎      | 13/40 [00:08<00:17,  1.50it/s] 35%|███▌      | 14/40 [00:09<00:17,  1.50it/s] 38%|███▊      | 15/40 [00:10<00:16,  1.49it/s] 40%|████      | 16/40 [00:10<00:16,  1.49it/s] 42%|████▎     | 17/40 [00:11<00:15,  1.50it/s] 45%|████▌     | 18/40 [00:12<00:14,  1.50it/s] 48%|████▊     | 19/40 [00:12<00:14,  1.49it/s] 50%|█████     | 20/40 [00:13<00:13,  1.50it/s] 52%|█████▎    | 21/40 [00:14<00:12,  1.50it/s] 55%|█████▌    | 22/40 [00:14<00:12,  1.49it/s] 57%|█████▊    | 23/40 [00:15<00:11,  1.49it/s] 60%|██████    | 24/40 [00:16<00:10,  1.49it/s] 62%|██████▎   | 25/40 [00:16<00:10,  1.49it/s] 65%|██████▌   | 26/40 [00:17<00:09,  1.50it/s] 68%|██████▊   | 27/40 [00:18<00:08,  1.50it/s] 70%|███████   | 28/40 [00:18<00:08,  1.50it/s] 72%|███████▎  | 29/40 [00:19<00:07,  1.50it/s] 75%|███████▌  | 30/40 [00:20<00:06,  1.50it/s] 78%|███████▊  | 31/40 [00:20<00:05,  1.50it/s] 80%|████████  | 32/40 [00:21<00:05,  1.50it/s] 82%|████████▎ | 33/40 [00:22<00:04,  1.50it/s] 85%|████████▌ | 34/40 [00:22<00:04,  1.50it/s] 88%|████████▊ | 35/40 [00:23<00:03,  1.49it/s] 90%|█████████ | 36/40 [00:24<00:02,  1.49it/s] 92%|█████████▎| 37/40 [00:24<00:02,  1.49it/s] 95%|█████████▌| 38/40 [00:25<00:01,  1.48it/s] 98%|█████████▊| 39/40 [00:26<00:00,  1.48it/s]100%|██████████| 40/40 [00:26<00:00,  1.64it/s]100%|██████████| 40/40 [00:26<00:00,  1.51it/s]
[32m2025-02-05 05:14:48.314[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    average  bleu@1  bleu@2  bleu@3  bleu@4  dist@1  dist@2  dist@3  dist@4  extreme  \
      .7694   .2767  .09651  .03375   .0171  .02122   .1678   .4330   .6381    .5912   
      f1  gen_loss  greedy  intra_dist@1  intra_dist@2  intra_dist@3  intra_dist@4  \
   .3513     3.791   .6724         .8862         .9714         .9473         .8899   
     ppl  rouge1  rouge2  rougeL  
   44.29   .3855  .08507   .3742[0m
[32m2025-02-05 05:14:48.317[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m163[0m - [1m[Conversation epoch 6][0m
[32m2025-02-05 05:14:48.317[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m164[0m - [1m[Train][0m
  0%|          | 0/92414 [00:00<?, ?it/s]100%|██████████| 92414/92414 [00:00<00:00, 987731.25it/s]
[32m2025-02-05 05:14:48.411[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/358 [00:00<?, ?it/s]  0%|          | 1/358 [00:00<00:36,  9.74it/s]  1%|          | 3/358 [00:00<00:35,  9.92it/s]  1%|          | 4/358 [00:00<00:35,  9.90it/s]  2%|▏         | 6/358 [00:00<00:35,  9.86it/s]  2%|▏         | 7/358 [00:00<00:35,  9.80it/s]  2%|▏         | 8/358 [00:00<00:35,  9.84it/s]  3%|▎         | 9/358 [00:00<00:35,  9.75it/s]  3%|▎         | 10/358 [00:01<00:35,  9.74it/s]  3%|▎         | 11/358 [00:01<00:35,  9.69it/s]  4%|▎         | 13/358 [00:01<00:34,  9.91it/s]  4%|▍         | 14/358 [00:01<00:34,  9.83it/s]  4%|▍         | 15/358 [00:01<00:35,  9.76it/s]  4%|▍         | 16/358 [00:01<00:35,  9.70it/s]  5%|▍         | 17/358 [00:01<00:35,  9.71it/s]  5%|▌         | 18/358 [00:01<00:34,  9.79it/s]  5%|▌         | 19/358 [00:01<00:34,  9.72it/s]  6%|▌         | 20/358 [00:02<00:34,  9.66it/s]  6%|▌         | 21/358 [00:02<00:35,  9.59it/s]  6%|▌         | 22/358 [00:02<00:34,  9.66it/s]  7%|▋         | 24/358 [00:02<00:34,  9.76it/s]  7%|▋         | 25/358 [00:02<00:34,  9.71it/s]  7%|▋         | 26/358 [00:02<00:34,  9.66it/s]  8%|▊         | 27/358 [00:02<00:34,  9.71it/s]  8%|▊         | 28/358 [00:02<00:34,  9.66it/s]  8%|▊         | 29/358 [00:02<00:34,  9.63it/s]  9%|▊         | 31/358 [00:03<00:33,  9.73it/s]  9%|▉         | 32/358 [00:03<00:33,  9.73it/s]  9%|▉         | 34/358 [00:03<00:32,  9.83it/s] 10%|█         | 36/358 [00:03<00:32,  9.83it/s] 10%|█         | 37/358 [00:03<00:32,  9.82it/s] 11%|█         | 38/358 [00:03<00:32,  9.77it/s] 11%|█         | 40/358 [00:04<00:32,  9.93it/s] 11%|█▏        | 41/358 [00:04<00:32,  9.85it/s] 12%|█▏        | 43/358 [00:04<00:31,  9.87it/s] 13%|█▎        | 45/358 [00:04<00:31,  9.97it/s] 13%|█▎        | 47/358 [00:04<00:31,  9.94it/s] 13%|█▎        | 48/358 [00:04<00:31,  9.93it/s] 14%|█▍        | 50/358 [00:05<00:31,  9.90it/s] 14%|█▍        | 51/358 [00:05<00:31,  9.84it/s] 15%|█▍        | 52/358 [00:05<00:31,  9.75it/s] 15%|█▍        | 53/358 [00:05<00:31,  9.69it/s] 15%|█▌        | 54/358 [00:05<00:31,  9.74it/s] 15%|█▌        | 55/358 [00:05<00:31,  9.69it/s] 16%|█▌        | 56/358 [00:05<00:31,  9.73it/s] 16%|█▌        | 57/358 [00:05<00:31,  9.69it/s] 16%|█▌        | 58/358 [00:05<00:31,  9.66it/s] 16%|█▋        | 59/358 [00:06<00:31,  9.63it/s] 17%|█▋        | 61/358 [00:06<00:30,  9.72it/s] 17%|█▋        | 62/358 [00:06<00:30,  9.64it/s] 18%|█▊        | 63/358 [00:06<00:30,  9.70it/s] 18%|█▊        | 64/358 [00:06<00:30,  9.66it/s] 18%|█▊        | 66/358 [00:06<00:30,  9.73it/s] 19%|█▊        | 67/358 [00:06<00:29,  9.71it/s] 19%|█▉        | 69/358 [00:07<00:29,  9.78it/s] 20%|█▉        | 70/358 [00:07<00:29,  9.72it/s] 20%|█▉        | 71/358 [00:07<00:29,  9.76it/s] 20%|██        | 72/358 [00:07<00:29,  9.71it/s] 20%|██        | 73/358 [00:07<00:29,  9.68it/s] 21%|██        | 74/358 [00:07<00:29,  9.65it/s] 21%|██        | 75/358 [00:07<00:29,  9.61it/s] 21%|██        | 76/358 [00:07<00:29,  9.71it/s] 22%|██▏       | 77/358 [00:07<00:29,  9.68it/s] 22%|██▏       | 79/358 [00:08<00:28,  9.68it/s] 23%|██▎       | 81/358 [00:08<00:28,  9.75it/s] 23%|██▎       | 83/358 [00:08<00:28,  9.77it/s] 23%|██▎       | 84/358 [00:08<00:28,  9.72it/s] 24%|██▎       | 85/358 [00:08<00:28,  9.68it/s] 24%|██▍       | 86/358 [00:08<00:28,  9.67it/s] 24%|██▍       | 87/358 [00:08<00:28,  9.65it/s] 25%|██▍       | 88/358 [00:09<00:27,  9.66it/s] 25%|██▌       | 90/358 [00:09<00:27,  9.90it/s] 26%|██▌       | 92/358 [00:09<00:26, 10.00it/s] 26%|██▌       | 93/358 [00:09<00:26,  9.96it/s] 26%|██▋       | 94/358 [00:09<00:26,  9.87it/s] 27%|██▋       | 96/358 [00:09<00:25, 10.16it/s] 27%|██▋       | 98/358 [00:10<00:25, 10.04it/s] 28%|██▊       | 99/358 [00:10<00:26,  9.95it/s] 28%|██▊       | 101/358 [00:10<00:25,  9.92it/s] 29%|██▉       | 103/358 [00:10<00:25,  9.91it/s] 29%|██▉       | 104/358 [00:10<00:25,  9.86it/s] 29%|██▉       | 105/358 [00:10<00:25,  9.78it/s] 30%|██▉       | 106/358 [00:10<00:25,  9.77it/s] 30%|███       | 108/358 [00:11<00:25,  9.79it/s] 30%|███       | 109/358 [00:11<00:25,  9.70it/s] 31%|███       | 110/358 [00:11<00:25,  9.69it/s] 31%|███       | 111/358 [00:11<00:25,  9.64it/s] 32%|███▏      | 113/358 [00:11<00:24,  9.91it/s] 32%|███▏      | 114/358 [00:11<00:24,  9.87it/s] 32%|███▏      | 115/358 [00:11<00:24,  9.77it/s] 32%|███▏      | 116/358 [00:11<00:24,  9.69it/s] 33%|███▎      | 117/358 [00:11<00:24,  9.66it/s] 33%|███▎      | 119/358 [00:12<00:24,  9.78it/s] 34%|███▍      | 121/358 [00:12<00:23,  9.97it/s] 34%|███▍      | 123/358 [00:12<00:23, 10.07it/s] 35%|███▍      | 125/358 [00:12<00:23, 10.05it/s] 35%|███▌      | 127/358 [00:12<00:23,  9.98it/s] 36%|███▌      | 128/358 [00:13<00:23,  9.94it/s] 36%|███▋      | 130/358 [00:13<00:22,  9.98it/s] 37%|███▋      | 131/358 [00:13<00:22,  9.89it/s] 37%|███▋      | 132/358 [00:13<00:22,  9.91it/s] 37%|███▋      | 134/358 [00:13<00:22,  9.93it/s] 38%|███▊      | 135/358 [00:13<00:22,  9.87it/s] 38%|███▊      | 137/358 [00:13<00:22,  9.95it/s] 39%|███▊      | 138/358 [00:14<00:22,  9.93it/s] 39%|███▉      | 139/358 [00:14<00:22,  9.85it/s] 39%|███▉      | 141/358 [00:14<00:21,  9.97it/s] 40%|███▉      | 142/358 [00:14<00:21,  9.90it/s] 40%|███▉      | 143/358 [00:14<00:21,  9.86it/s] 40%|████      | 144/358 [00:14<00:21,  9.78it/s] 41%|████      | 145/358 [00:14<00:21,  9.80it/s] 41%|████      | 146/358 [00:14<00:21,  9.73it/s] 41%|████      | 147/358 [00:14<00:21,  9.67it/s] 41%|████▏     | 148/358 [00:15<00:21,  9.70it/s] 42%|████▏     | 149/358 [00:15<00:21,  9.69it/s] 42%|████▏     | 150/358 [00:15<00:21,  9.65it/s] 42%|████▏     | 151/358 [00:15<00:22,  9.38it/s] 42%|████▏     | 152/358 [00:15<00:21,  9.42it/s] 43%|████▎     | 153/358 [00:15<00:21,  9.44it/s] 43%|████▎     | 154/358 [00:15<00:21,  9.53it/s] 43%|████▎     | 155/358 [00:15<00:21,  9.55it/s] 44%|████▎     | 156/358 [00:15<00:20,  9.67it/s] 44%|████▍     | 157/358 [00:16<00:20,  9.61it/s] 44%|████▍     | 158/358 [00:16<00:20,  9.70it/s] 44%|████▍     | 159/358 [00:16<00:20,  9.70it/s] 45%|████▍     | 160/358 [00:16<00:20,  9.70it/s] 45%|████▌     | 162/358 [00:16<00:19, 10.00it/s] 46%|████▌     | 164/358 [00:16<00:19, 10.00it/s] 46%|████▌     | 165/358 [00:16<00:19,  9.96it/s] 47%|████▋     | 167/358 [00:17<00:19,  9.90it/s] 47%|████▋     | 169/358 [00:17<00:19,  9.94it/s] 48%|████▊     | 171/358 [00:17<00:18,  9.92it/s] 48%|████▊     | 172/358 [00:17<00:18,  9.87it/s] 48%|████▊     | 173/358 [00:17<00:18,  9.80it/s] 49%|████▉     | 175/358 [00:17<00:18,  9.83it/s] 49%|████▉     | 176/358 [00:17<00:18,  9.84it/s] 49%|████▉     | 177/358 [00:18<00:18,  9.82it/s] 50%|█████     | 179/358 [00:18<00:18,  9.85it/s] 50%|█████     | 180/358 [00:18<00:18,  9.78it/s] 51%|█████     | 182/358 [00:18<00:17,  9.93it/s] 51%|█████     | 183/358 [00:18<00:17,  9.88it/s] 51%|█████▏    | 184/358 [00:18<00:17,  9.77it/s] 52%|█████▏    | 185/358 [00:18<00:17,  9.72it/s] 52%|█████▏    | 187/358 [00:19<00:17,  9.94it/s] 53%|█████▎    | 188/358 [00:19<00:17,  9.88it/s] 53%|█████▎    | 189/358 [00:19<00:17,  9.82it/s] 53%|█████▎    | 191/358 [00:19<00:17,  9.74it/s] 54%|█████▎    | 192/358 [00:19<00:17,  9.69it/s] 54%|█████▍    | 193/358 [00:19<00:17,  9.68it/s] 54%|█████▍    | 194/358 [00:19<00:16,  9.66it/s] 54%|█████▍    | 195/358 [00:19<00:16,  9.73it/s] 55%|█████▌    | 197/358 [00:20<00:16,  9.90it/s] 55%|█████▌    | 198/358 [00:20<00:16,  9.83it/s] 56%|█████▌    | 199/358 [00:20<00:16,  9.86it/s] 56%|█████▌    | 200/358 [00:20<00:16,  9.80it/s] 56%|█████▌    | 201/358 [00:20<00:16,  9.76it/s] 57%|█████▋    | 203/358 [00:20<00:15,  9.85it/s] 57%|█████▋    | 204/358 [00:20<00:15,  9.74it/s] 57%|█████▋    | 205/358 [00:20<00:15,  9.70it/s] 58%|█████▊    | 207/358 [00:21<00:15,  9.87it/s] 58%|█████▊    | 208/358 [00:21<00:15,  9.80it/s] 59%|█████▊    | 210/358 [00:21<00:15,  9.81it/s] 59%|█████▉    | 212/358 [00:21<00:14,  9.81it/s] 60%|█████▉    | 214/358 [00:21<00:14,  9.89it/s] 60%|██████    | 215/358 [00:21<00:14,  9.82it/s] 60%|██████    | 216/358 [00:22<00:14,  9.76it/s] 61%|██████    | 217/358 [00:22<00:14,  9.79it/s] 61%|██████    | 218/358 [00:22<00:14,  9.76it/s] 61%|██████    | 219/358 [00:22<00:14,  9.76it/s] 62%|██████▏   | 221/358 [00:22<00:13,  9.90it/s] 62%|██████▏   | 222/358 [00:22<00:13,  9.79it/s] 62%|██████▏   | 223/358 [00:22<00:13,  9.74it/s] 63%|██████▎   | 224/358 [00:22<00:13,  9.68it/s] 63%|██████▎   | 225/358 [00:22<00:13,  9.77it/s] 63%|██████▎   | 226/358 [00:23<00:13,  9.71it/s] 64%|██████▎   | 228/358 [00:23<00:13,  9.75it/s] 64%|██████▍   | 229/358 [00:23<00:13,  9.72it/s] 64%|██████▍   | 230/358 [00:23<00:13,  9.67it/s] 65%|██████▍   | 232/358 [00:23<00:12,  9.72it/s] 65%|██████▌   | 234/358 [00:23<00:12, 10.02it/s] 66%|██████▌   | 236/358 [00:24<00:12,  9.97it/s] 66%|██████▋   | 238/358 [00:24<00:11, 10.03it/s] 67%|██████▋   | 240/358 [00:24<00:11,  9.99it/s] 68%|██████▊   | 242/358 [00:24<00:11,  9.97it/s] 68%|██████▊   | 243/358 [00:24<00:11,  9.91it/s] 68%|██████▊   | 244/358 [00:24<00:11,  9.84it/s] 69%|██████▊   | 246/358 [00:25<00:11,  9.86it/s] 69%|██████▉   | 247/358 [00:25<00:11,  9.79it/s] 69%|██████▉   | 248/358 [00:25<00:11,  9.75it/s] 70%|██████▉   | 250/358 [00:25<00:10,  9.84it/s] 70%|███████   | 251/358 [00:25<00:10,  9.78it/s] 70%|███████   | 252/358 [00:25<00:10,  9.72it/s] 71%|███████   | 253/358 [00:25<00:10,  9.68it/s] 71%|███████   | 254/358 [00:25<00:10,  9.65it/s] 72%|███████▏  | 256/358 [00:26<00:10,  9.83it/s] 72%|███████▏  | 257/358 [00:26<00:10,  9.83it/s] 72%|███████▏  | 258/358 [00:26<00:10,  9.70it/s] 72%|███████▏  | 259/358 [00:26<00:10,  9.67it/s] 73%|███████▎  | 260/358 [00:26<00:10,  9.70it/s] 73%|███████▎  | 262/358 [00:26<00:09,  9.88it/s] 74%|███████▎  | 264/358 [00:26<00:09,  9.91it/s] 74%|███████▍  | 266/358 [00:27<00:09,  9.90it/s] 75%|███████▍  | 267/358 [00:27<00:09,  9.84it/s] 75%|███████▌  | 269/358 [00:27<00:08,  9.89it/s] 75%|███████▌  | 270/358 [00:27<00:08,  9.82it/s] 76%|███████▌  | 271/358 [00:27<00:08,  9.75it/s] 76%|███████▌  | 272/358 [00:27<00:08,  9.72it/s] 76%|███████▋  | 273/358 [00:27<00:08,  9.62it/s] 77%|███████▋  | 274/358 [00:27<00:08,  9.62it/s] 77%|███████▋  | 275/358 [00:28<00:08,  9.67it/s] 77%|███████▋  | 276/358 [00:28<00:08,  9.67it/s] 77%|███████▋  | 277/358 [00:28<00:08,  9.64it/s] 78%|███████▊  | 278/358 [00:28<00:08,  9.62it/s] 78%|███████▊  | 280/358 [00:28<00:07,  9.82it/s] 78%|███████▊  | 281/358 [00:28<00:07,  9.83it/s] 79%|███████▉  | 282/358 [00:28<00:07,  9.77it/s] 79%|███████▉  | 283/358 [00:28<00:07,  9.71it/s] 79%|███████▉  | 284/358 [00:28<00:07,  9.67it/s] 80%|███████▉  | 285/358 [00:29<00:07,  9.73it/s] 80%|███████▉  | 286/358 [00:29<00:07,  9.69it/s] 80%|████████  | 287/358 [00:29<00:07,  9.66it/s] 80%|████████  | 288/358 [00:29<00:07,  9.62it/s] 81%|████████  | 290/358 [00:29<00:06,  9.83it/s] 81%|████████▏ | 291/358 [00:29<00:06,  9.82it/s] 82%|████████▏ | 293/358 [00:29<00:06,  9.83it/s] 82%|████████▏ | 295/358 [00:30<00:06,  9.90it/s] 83%|████████▎ | 296/358 [00:30<00:06,  9.84it/s] 83%|████████▎ | 297/358 [00:30<00:06,  9.73it/s] 84%|████████▎ | 299/358 [00:30<00:05,  9.89it/s] 84%|████████▍ | 301/358 [00:30<00:05,  9.92it/s] 84%|████████▍ | 302/358 [00:30<00:05,  9.86it/s] 85%|████████▍ | 303/358 [00:30<00:05,  9.87it/s] 85%|████████▌ | 305/358 [00:31<00:05,  9.90it/s] 85%|████████▌ | 306/358 [00:31<00:05,  9.82it/s] 86%|████████▌ | 308/358 [00:31<00:05,  9.92it/s] 86%|████████▋ | 309/358 [00:31<00:04,  9.82it/s] 87%|████████▋ | 310/358 [00:31<00:04,  9.76it/s] 87%|████████▋ | 311/358 [00:31<00:04,  9.69it/s] 87%|████████▋ | 312/358 [00:31<00:04,  9.70it/s] 87%|████████▋ | 313/358 [00:31<00:04,  9.72it/s] 88%|████████▊ | 315/358 [00:32<00:04,  9.98it/s] 88%|████████▊ | 316/358 [00:32<00:04,  9.92it/s] 89%|████████▊ | 317/358 [00:32<00:04,  9.84it/s] 89%|████████▉ | 318/358 [00:32<00:04,  9.80it/s] 89%|████████▉ | 319/358 [00:32<00:04,  9.75it/s] 89%|████████▉ | 320/358 [00:32<00:03,  9.81it/s] 90%|████████▉ | 321/358 [00:32<00:03,  9.73it/s] 90%|████████▉ | 322/358 [00:32<00:03,  9.70it/s] 90%|█████████ | 323/358 [00:32<00:03,  9.65it/s] 91%|█████████ | 324/358 [00:33<00:03,  9.62it/s] 91%|█████████ | 325/358 [00:33<00:03,  9.60it/s] 91%|█████████▏| 327/358 [00:33<00:03,  9.96it/s] 92%|█████████▏| 329/358 [00:33<00:02, 10.06it/s] 92%|█████████▏| 330/358 [00:33<00:02,  9.95it/s] 93%|█████████▎| 332/358 [00:33<00:02, 10.05it/s] 93%|█████████▎| 334/358 [00:34<00:02,  9.95it/s] 94%|█████████▎| 335/358 [00:34<00:02,  9.83it/s] 94%|█████████▍| 337/358 [00:34<00:02,  9.91it/s] 95%|█████████▍| 339/358 [00:34<00:01, 10.11it/s] 95%|█████████▌| 341/358 [00:34<00:01, 10.05it/s] 96%|█████████▌| 343/358 [00:34<00:01,  9.89it/s] 96%|█████████▌| 344/358 [00:35<00:01,  9.83it/s] 96%|█████████▋| 345/358 [00:35<00:01,  9.85it/s] 97%|█████████▋| 347/358 [00:35<00:01, 10.03it/s] 97%|█████████▋| 348/358 [00:35<00:01,  9.93it/s] 97%|█████████▋| 349/358 [00:35<00:00,  9.85it/s] 98%|█████████▊| 350/358 [00:35<00:00,  9.78it/s] 98%|█████████▊| 351/358 [00:35<00:00,  9.73it/s] 99%|█████████▊| 353/358 [00:35<00:00,  9.91it/s] 99%|█████████▉| 354/358 [00:36<00:00,  9.90it/s] 99%|█████████▉| 355/358 [00:36<00:00,  9.81it/s]100%|█████████▉| 357/358 [00:36<00:00,  9.86it/s]100%|██████████| 358/358 [00:36<00:00,  9.82it/s]
[32m2025-02-05 05:15:24.878[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    gen_loss  grad clip ratio  grad norm   ppl
       3.023                1       4.75 20.56[0m
[32m2025-02-05 05:15:24.878[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m169[0m - [1m[Valid][0m
  0%|          | 0/10256 [00:00<?, ?it/s]100%|██████████| 10256/10256 [00:00<00:00, 1078682.56it/s]
[32m2025-02-05 05:15:24.888[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:26,  1.48it/s]  5%|▌         | 2/40 [00:01<00:25,  1.48it/s]  8%|▊         | 3/40 [00:02<00:24,  1.49it/s] 10%|█         | 4/40 [00:02<00:24,  1.48it/s] 12%|█▎        | 5/40 [00:03<00:23,  1.48it/s] 15%|█▌        | 6/40 [00:04<00:22,  1.48it/s] 18%|█▊        | 7/40 [00:04<00:22,  1.48it/s] 20%|██        | 8/40 [00:05<00:21,  1.48it/s] 22%|██▎       | 9/40 [00:06<00:20,  1.49it/s] 25%|██▌       | 10/40 [00:06<00:20,  1.49it/s] 28%|██▊       | 11/40 [00:07<00:19,  1.48it/s] 30%|███       | 12/40 [00:08<00:18,  1.48it/s] 32%|███▎      | 13/40 [00:08<00:18,  1.49it/s] 35%|███▌      | 14/40 [00:09<00:17,  1.48it/s] 38%|███▊      | 15/40 [00:10<00:16,  1.47it/s] 40%|████      | 16/40 [00:10<00:16,  1.47it/s] 42%|████▎     | 17/40 [00:11<00:15,  1.48it/s] 45%|████▌     | 18/40 [00:12<00:14,  1.48it/s] 48%|████▊     | 19/40 [00:12<00:14,  1.48it/s] 50%|█████     | 20/40 [00:13<00:13,  1.48it/s] 52%|█████▎    | 21/40 [00:14<00:12,  1.49it/s] 55%|█████▌    | 22/40 [00:14<00:12,  1.48it/s] 57%|█████▊    | 23/40 [00:15<00:11,  1.48it/s] 60%|██████    | 24/40 [00:16<00:10,  1.47it/s] 62%|██████▎   | 25/40 [00:16<00:10,  1.47it/s] 65%|██████▌   | 26/40 [00:17<00:09,  1.48it/s] 68%|██████▊   | 27/40 [00:18<00:08,  1.48it/s] 70%|███████   | 28/40 [00:18<00:08,  1.48it/s] 72%|███████▎  | 29/40 [00:19<00:07,  1.48it/s] 75%|███████▌  | 30/40 [00:20<00:06,  1.49it/s] 78%|███████▊  | 31/40 [00:20<00:06,  1.49it/s] 80%|████████  | 32/40 [00:21<00:05,  1.49it/s] 82%|████████▎ | 33/40 [00:22<00:04,  1.49it/s] 85%|████████▌ | 34/40 [00:22<00:04,  1.49it/s] 88%|████████▊ | 35/40 [00:23<00:03,  1.48it/s] 90%|█████████ | 36/40 [00:24<00:02,  1.48it/s] 92%|█████████▎| 37/40 [00:24<00:02,  1.48it/s] 95%|█████████▌| 38/40 [00:25<00:01,  1.47it/s] 98%|█████████▊| 39/40 [00:26<00:00,  1.47it/s]100%|██████████| 40/40 [00:26<00:00,  1.63it/s]100%|██████████| 40/40 [00:26<00:00,  1.49it/s]
[32m2025-02-05 05:15:51.694[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    average  bleu@1  bleu@2  bleu@3  bleu@4  dist@1  dist@2  dist@3  dist@4  extreme  \
      .7770   .2813  .09932  .03657  .01803  .02656   .1943   .4837   .7122    .5927   
      f1  gen_loss  greedy  intra_dist@1  intra_dist@2  intra_dist@3  intra_dist@4  \
   .3544     3.858   .6736         .8835         .9802         .9629         .9122   
     ppl  rouge1  rouge2  rougeL  
   47.35   .3833  .08613   .3709[0m
[32m2025-02-05 05:15:51.698[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m163[0m - [1m[Conversation epoch 7][0m
[32m2025-02-05 05:15:51.698[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m164[0m - [1m[Train][0m
  0%|          | 0/92414 [00:00<?, ?it/s]100%|██████████| 92414/92414 [00:00<00:00, 997384.16it/s]
[32m2025-02-05 05:15:51.791[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/358 [00:00<?, ?it/s]  0%|          | 1/358 [00:00<00:36,  9.74it/s]  1%|          | 3/358 [00:00<00:35,  9.92it/s]  1%|          | 4/358 [00:00<00:35,  9.90it/s]  2%|▏         | 6/358 [00:00<00:35,  9.86it/s]  2%|▏         | 7/358 [00:00<00:35,  9.80it/s]  2%|▏         | 8/358 [00:00<00:35,  9.84it/s]  3%|▎         | 9/358 [00:00<00:35,  9.75it/s]  3%|▎         | 10/358 [00:01<00:35,  9.74it/s]  3%|▎         | 11/358 [00:01<00:35,  9.69it/s]  4%|▎         | 13/358 [00:01<00:34,  9.91it/s]  4%|▍         | 14/358 [00:01<00:34,  9.83it/s]  4%|▍         | 15/358 [00:01<00:35,  9.76it/s]  4%|▍         | 16/358 [00:01<00:35,  9.69it/s]  5%|▍         | 17/358 [00:01<00:35,  9.71it/s]  5%|▌         | 18/358 [00:01<00:34,  9.78it/s]  5%|▌         | 19/358 [00:01<00:34,  9.72it/s]  6%|▌         | 20/358 [00:02<00:34,  9.66it/s]  6%|▌         | 21/358 [00:02<00:35,  9.60it/s]  6%|▌         | 22/358 [00:02<00:34,  9.66it/s]  7%|▋         | 24/358 [00:02<00:34,  9.76it/s]  7%|▋         | 25/358 [00:02<00:34,  9.71it/s]  7%|▋         | 26/358 [00:02<00:34,  9.66it/s]  8%|▊         | 27/358 [00:02<00:34,  9.72it/s]  8%|▊         | 28/358 [00:02<00:34,  9.67it/s]  8%|▊         | 29/358 [00:02<00:34,  9.64it/s]  9%|▊         | 31/358 [00:03<00:33,  9.74it/s]  9%|▉         | 32/358 [00:03<00:33,  9.74it/s]  9%|▉         | 34/358 [00:03<00:32,  9.84it/s] 10%|█         | 36/358 [00:03<00:32,  9.84it/s] 10%|█         | 37/358 [00:03<00:32,  9.82it/s] 11%|█         | 38/358 [00:03<00:32,  9.78it/s] 11%|█         | 40/358 [00:04<00:32,  9.93it/s] 11%|█▏        | 41/358 [00:04<00:32,  9.85it/s] 12%|█▏        | 43/358 [00:04<00:31,  9.87it/s] 13%|█▎        | 45/358 [00:04<00:31,  9.97it/s] 13%|█▎        | 47/358 [00:04<00:31,  9.94it/s] 13%|█▎        | 48/358 [00:04<00:31,  9.93it/s] 14%|█▍        | 50/358 [00:05<00:31,  9.90it/s] 14%|█▍        | 51/358 [00:05<00:31,  9.83it/s] 15%|█▍        | 52/358 [00:05<00:31,  9.74it/s] 15%|█▍        | 53/358 [00:05<00:31,  9.69it/s] 15%|█▌        | 54/358 [00:05<00:31,  9.74it/s] 15%|█▌        | 55/358 [00:05<00:31,  9.69it/s] 16%|█▌        | 56/358 [00:05<00:31,  9.73it/s] 16%|█▌        | 57/358 [00:05<00:31,  9.69it/s] 16%|█▌        | 58/358 [00:05<00:31,  9.66it/s] 16%|█▋        | 59/358 [00:06<00:31,  9.63it/s] 17%|█▋        | 61/358 [00:06<00:30,  9.72it/s] 17%|█▋        | 62/358 [00:06<00:30,  9.64it/s] 18%|█▊        | 63/358 [00:06<00:30,  9.70it/s] 18%|█▊        | 64/358 [00:06<00:30,  9.66it/s] 18%|█▊        | 66/358 [00:06<00:30,  9.72it/s] 19%|█▊        | 67/358 [00:06<00:29,  9.71it/s] 19%|█▉        | 69/358 [00:07<00:29,  9.77it/s] 20%|█▉        | 70/358 [00:07<00:29,  9.72it/s] 20%|█▉        | 71/358 [00:07<00:29,  9.76it/s] 20%|██        | 72/358 [00:07<00:29,  9.71it/s] 20%|██        | 73/358 [00:07<00:29,  9.67it/s] 21%|██        | 74/358 [00:07<00:29,  9.64it/s] 21%|██        | 75/358 [00:07<00:29,  9.61it/s] 21%|██        | 76/358 [00:07<00:29,  9.71it/s] 22%|██▏       | 77/358 [00:07<00:29,  9.68it/s] 22%|██▏       | 79/358 [00:08<00:28,  9.69it/s] 23%|██▎       | 81/358 [00:08<00:28,  9.75it/s] 23%|██▎       | 83/358 [00:08<00:28,  9.77it/s] 23%|██▎       | 84/358 [00:08<00:28,  9.72it/s] 24%|██▎       | 85/358 [00:08<00:28,  9.68it/s] 24%|██▍       | 86/358 [00:08<00:28,  9.67it/s] 24%|██▍       | 87/358 [00:08<00:28,  9.64it/s] 25%|██▍       | 88/358 [00:09<00:27,  9.66it/s] 25%|██▌       | 90/358 [00:09<00:27,  9.90it/s] 26%|██▌       | 92/358 [00:09<00:26, 10.00it/s] 26%|██▌       | 93/358 [00:09<00:26,  9.96it/s] 26%|██▋       | 94/358 [00:09<00:26,  9.88it/s] 27%|██▋       | 96/358 [00:09<00:25, 10.16it/s] 27%|██▋       | 98/358 [00:10<00:25, 10.04it/s] 28%|██▊       | 99/358 [00:10<00:26,  9.95it/s] 28%|██▊       | 101/358 [00:10<00:25,  9.92it/s] 29%|██▉       | 103/358 [00:10<00:25,  9.91it/s] 29%|██▉       | 104/358 [00:10<00:25,  9.86it/s] 29%|██▉       | 105/358 [00:10<00:25,  9.79it/s] 30%|██▉       | 106/358 [00:10<00:25,  9.77it/s] 30%|███       | 108/358 [00:11<00:25,  9.80it/s] 30%|███       | 109/358 [00:11<00:25,  9.71it/s] 31%|███       | 110/358 [00:11<00:25,  9.69it/s] 31%|███       | 111/358 [00:11<00:25,  9.64it/s] 32%|███▏      | 113/358 [00:11<00:24,  9.91it/s] 32%|███▏      | 114/358 [00:11<00:24,  9.87it/s] 32%|███▏      | 115/358 [00:11<00:24,  9.77it/s] 32%|███▏      | 116/358 [00:11<00:24,  9.69it/s] 33%|███▎      | 117/358 [00:11<00:24,  9.66it/s] 33%|███▎      | 119/358 [00:12<00:24,  9.78it/s] 34%|███▍      | 121/358 [00:12<00:23,  9.97it/s] 34%|███▍      | 123/358 [00:12<00:23, 10.07it/s] 35%|███▍      | 125/358 [00:12<00:23, 10.05it/s] 35%|███▌      | 127/358 [00:12<00:23,  9.98it/s] 36%|███▌      | 128/358 [00:13<00:23,  9.94it/s] 36%|███▋      | 130/358 [00:13<00:22,  9.99it/s] 37%|███▋      | 131/358 [00:13<00:22,  9.89it/s] 37%|███▋      | 132/358 [00:13<00:22,  9.91it/s] 37%|███▋      | 134/358 [00:13<00:22,  9.93it/s] 38%|███▊      | 135/358 [00:13<00:22,  9.87it/s] 38%|███▊      | 137/358 [00:13<00:22,  9.96it/s] 39%|███▊      | 138/358 [00:14<00:22,  9.94it/s] 39%|███▉      | 139/358 [00:14<00:22,  9.85it/s] 39%|███▉      | 141/358 [00:14<00:21,  9.97it/s] 40%|███▉      | 142/358 [00:14<00:21,  9.89it/s] 40%|███▉      | 143/358 [00:14<00:21,  9.86it/s] 40%|████      | 144/358 [00:14<00:21,  9.78it/s] 41%|████      | 145/358 [00:14<00:21,  9.80it/s] 41%|████      | 146/358 [00:14<00:21,  9.73it/s] 41%|████      | 147/358 [00:14<00:21,  9.67it/s] 41%|████▏     | 148/358 [00:15<00:21,  9.70it/s] 42%|████▏     | 149/358 [00:15<00:21,  9.68it/s] 42%|████▏     | 150/358 [00:15<00:21,  9.64it/s] 42%|████▏     | 151/358 [00:15<00:22,  9.38it/s] 42%|████▏     | 152/358 [00:15<00:21,  9.42it/s] 43%|████▎     | 153/358 [00:15<00:21,  9.44it/s] 43%|████▎     | 154/358 [00:15<00:21,  9.54it/s] 43%|████▎     | 155/358 [00:15<00:21,  9.55it/s] 44%|████▎     | 156/358 [00:15<00:20,  9.67it/s] 44%|████▍     | 157/358 [00:16<00:20,  9.61it/s] 44%|████▍     | 158/358 [00:16<00:20,  9.70it/s] 44%|████▍     | 159/358 [00:16<00:20,  9.69it/s] 45%|████▍     | 160/358 [00:16<00:20,  9.70it/s] 45%|████▌     | 162/358 [00:16<00:19,  9.99it/s] 46%|████▌     | 164/358 [00:16<00:19,  9.99it/s] 46%|████▌     | 165/358 [00:16<00:19,  9.95it/s] 47%|████▋     | 167/358 [00:17<00:19,  9.90it/s] 47%|████▋     | 169/358 [00:17<00:19,  9.93it/s] 48%|████▊     | 171/358 [00:17<00:18,  9.92it/s] 48%|████▊     | 172/358 [00:17<00:18,  9.87it/s] 48%|████▊     | 173/358 [00:17<00:18,  9.80it/s] 49%|████▉     | 175/358 [00:17<00:18,  9.83it/s] 49%|████▉     | 176/358 [00:17<00:18,  9.84it/s] 49%|████▉     | 177/358 [00:18<00:18,  9.83it/s] 50%|█████     | 179/358 [00:18<00:18,  9.85it/s] 50%|█████     | 180/358 [00:18<00:18,  9.78it/s] 51%|█████     | 182/358 [00:18<00:17,  9.93it/s] 51%|█████     | 183/358 [00:18<00:17,  9.88it/s] 51%|█████▏    | 184/358 [00:18<00:17,  9.77it/s] 52%|█████▏    | 185/358 [00:18<00:17,  9.72it/s] 52%|█████▏    | 187/358 [00:19<00:17,  9.94it/s] 53%|█████▎    | 188/358 [00:19<00:17,  9.88it/s] 53%|█████▎    | 189/358 [00:19<00:17,  9.83it/s] 53%|█████▎    | 191/358 [00:19<00:17,  9.74it/s] 54%|█████▎    | 192/358 [00:19<00:17,  9.69it/s] 54%|█████▍    | 193/358 [00:19<00:17,  9.68it/s] 54%|█████▍    | 194/358 [00:19<00:16,  9.66it/s] 54%|█████▍    | 195/358 [00:19<00:16,  9.73it/s] 55%|█████▌    | 197/358 [00:20<00:16,  9.91it/s] 55%|█████▌    | 198/358 [00:20<00:16,  9.83it/s] 56%|█████▌    | 199/358 [00:20<00:16,  9.86it/s] 56%|█████▌    | 200/358 [00:20<00:16,  9.80it/s] 56%|█████▌    | 201/358 [00:20<00:16,  9.76it/s] 57%|█████▋    | 203/358 [00:20<00:15,  9.85it/s] 57%|█████▋    | 204/358 [00:20<00:15,  9.74it/s] 57%|█████▋    | 205/358 [00:20<00:15,  9.69it/s] 58%|█████▊    | 207/358 [00:21<00:15,  9.86it/s] 58%|█████▊    | 208/358 [00:21<00:15,  9.79it/s] 59%|█████▊    | 210/358 [00:21<00:15,  9.81it/s] 59%|█████▉    | 212/358 [00:21<00:14,  9.80it/s] 60%|█████▉    | 214/358 [00:21<00:14,  9.88it/s] 60%|██████    | 215/358 [00:21<00:14,  9.83it/s] 60%|██████    | 216/358 [00:22<00:14,  9.76it/s] 61%|██████    | 217/358 [00:22<00:14,  9.79it/s] 61%|██████    | 218/358 [00:22<00:14,  9.76it/s] 61%|██████    | 219/358 [00:22<00:14,  9.76it/s] 62%|██████▏   | 221/358 [00:22<00:13,  9.90it/s] 62%|██████▏   | 222/358 [00:22<00:13,  9.79it/s] 62%|██████▏   | 223/358 [00:22<00:13,  9.74it/s] 63%|██████▎   | 224/358 [00:22<00:13,  9.68it/s] 63%|██████▎   | 225/358 [00:22<00:13,  9.76it/s] 63%|██████▎   | 226/358 [00:23<00:13,  9.71it/s] 64%|██████▎   | 228/358 [00:23<00:13,  9.75it/s] 64%|██████▍   | 229/358 [00:23<00:13,  9.73it/s] 64%|██████▍   | 230/358 [00:23<00:13,  9.67it/s] 65%|██████▍   | 232/358 [00:23<00:12,  9.73it/s] 65%|██████▌   | 234/358 [00:23<00:12, 10.02it/s] 66%|██████▌   | 236/358 [00:24<00:12,  9.98it/s] 66%|██████▋   | 238/358 [00:24<00:11, 10.03it/s] 67%|██████▋   | 240/358 [00:24<00:11,  9.99it/s] 68%|██████▊   | 242/358 [00:24<00:11,  9.97it/s] 68%|██████▊   | 243/358 [00:24<00:11,  9.91it/s] 68%|██████▊   | 244/358 [00:24<00:11,  9.84it/s] 69%|██████▊   | 246/358 [00:25<00:11,  9.86it/s] 69%|██████▉   | 247/358 [00:25<00:11,  9.79it/s] 69%|██████▉   | 248/358 [00:25<00:11,  9.74it/s] 70%|██████▉   | 250/358 [00:25<00:10,  9.84it/s] 70%|███████   | 251/358 [00:25<00:10,  9.78it/s] 70%|███████   | 252/358 [00:25<00:10,  9.71it/s] 71%|███████   | 253/358 [00:25<00:10,  9.67it/s] 71%|███████   | 254/358 [00:25<00:10,  9.65it/s] 72%|███████▏  | 256/358 [00:26<00:10,  9.82it/s] 72%|███████▏  | 257/358 [00:26<00:10,  9.83it/s] 72%|███████▏  | 258/358 [00:26<00:10,  9.70it/s] 72%|███████▏  | 259/358 [00:26<00:10,  9.66it/s] 73%|███████▎  | 260/358 [00:26<00:10,  9.70it/s] 73%|███████▎  | 262/358 [00:26<00:09,  9.88it/s] 74%|███████▎  | 264/358 [00:26<00:09,  9.90it/s] 74%|███████▍  | 266/358 [00:27<00:09,  9.89it/s] 75%|███████▍  | 267/358 [00:27<00:09,  9.83it/s] 75%|███████▌  | 269/358 [00:27<00:08,  9.89it/s] 75%|███████▌  | 270/358 [00:27<00:08,  9.82it/s] 76%|███████▌  | 271/358 [00:27<00:08,  9.74it/s] 76%|███████▌  | 272/358 [00:27<00:08,  9.72it/s] 76%|███████▋  | 273/358 [00:27<00:08,  9.62it/s] 77%|███████▋  | 274/358 [00:27<00:08,  9.62it/s] 77%|███████▋  | 275/358 [00:28<00:08,  9.67it/s] 77%|███████▋  | 276/358 [00:28<00:08,  9.67it/s] 77%|███████▋  | 277/358 [00:28<00:08,  9.64it/s] 78%|███████▊  | 278/358 [00:28<00:08,  9.62it/s] 78%|███████▊  | 280/358 [00:28<00:07,  9.81it/s] 78%|███████▊  | 281/358 [00:28<00:07,  9.82it/s] 79%|███████▉  | 282/358 [00:28<00:07,  9.76it/s] 79%|███████▉  | 283/358 [00:28<00:07,  9.70it/s] 79%|███████▉  | 284/358 [00:28<00:07,  9.66it/s] 80%|███████▉  | 285/358 [00:29<00:07,  9.73it/s] 80%|███████▉  | 286/358 [00:29<00:07,  9.69it/s] 80%|████████  | 287/358 [00:29<00:07,  9.66it/s] 80%|████████  | 288/358 [00:29<00:07,  9.62it/s] 81%|████████  | 290/358 [00:29<00:06,  9.84it/s] 81%|████████▏ | 291/358 [00:29<00:06,  9.82it/s] 82%|████████▏ | 293/358 [00:29<00:06,  9.83it/s] 82%|████████▏ | 295/358 [00:30<00:06,  9.90it/s] 83%|████████▎ | 296/358 [00:30<00:06,  9.84it/s] 83%|████████▎ | 297/358 [00:30<00:06,  9.73it/s] 84%|████████▎ | 299/358 [00:30<00:05,  9.89it/s] 84%|████████▍ | 301/358 [00:30<00:05,  9.93it/s] 84%|████████▍ | 302/358 [00:30<00:05,  9.86it/s] 85%|████████▍ | 303/358 [00:30<00:05,  9.87it/s] 85%|████████▌ | 305/358 [00:31<00:05,  9.89it/s] 85%|████████▌ | 306/358 [00:31<00:05,  9.82it/s] 86%|████████▌ | 308/358 [00:31<00:05,  9.92it/s] 86%|████████▋ | 309/358 [00:31<00:04,  9.82it/s] 87%|████████▋ | 310/358 [00:31<00:04,  9.76it/s] 87%|████████▋ | 311/358 [00:31<00:04,  9.69it/s] 87%|████████▋ | 312/358 [00:31<00:04,  9.70it/s] 87%|████████▋ | 313/358 [00:31<00:04,  9.72it/s] 88%|████████▊ | 315/358 [00:32<00:04,  9.98it/s] 88%|████████▊ | 316/358 [00:32<00:04,  9.93it/s] 89%|████████▊ | 317/358 [00:32<00:04,  9.85it/s] 89%|████████▉ | 318/358 [00:32<00:04,  9.79it/s] 89%|████████▉ | 319/358 [00:32<00:04,  9.75it/s] 89%|████████▉ | 320/358 [00:32<00:03,  9.81it/s] 90%|████████▉ | 321/358 [00:32<00:03,  9.73it/s] 90%|████████▉ | 322/358 [00:32<00:03,  9.70it/s] 90%|█████████ | 323/358 [00:32<00:03,  9.65it/s] 91%|█████████ | 324/358 [00:33<00:03,  9.62it/s] 91%|█████████ | 325/358 [00:33<00:03,  9.60it/s] 91%|█████████▏| 327/358 [00:33<00:03,  9.95it/s] 92%|█████████▏| 329/358 [00:33<00:02, 10.06it/s] 92%|█████████▏| 330/358 [00:33<00:02,  9.95it/s] 93%|█████████▎| 332/358 [00:33<00:02, 10.04it/s] 93%|█████████▎| 334/358 [00:34<00:02,  9.95it/s] 94%|█████████▎| 335/358 [00:34<00:02,  9.83it/s] 94%|█████████▍| 337/358 [00:34<00:02,  9.90it/s] 95%|█████████▍| 339/358 [00:34<00:01, 10.10it/s] 95%|█████████▌| 341/358 [00:34<00:01, 10.05it/s] 96%|█████████▌| 343/358 [00:34<00:01,  9.89it/s] 96%|█████████▌| 344/358 [00:35<00:01,  9.83it/s] 96%|█████████▋| 345/358 [00:35<00:01,  9.85it/s] 97%|█████████▋| 347/358 [00:35<00:01, 10.03it/s] 97%|█████████▋| 348/358 [00:35<00:01,  9.93it/s] 97%|█████████▋| 349/358 [00:35<00:00,  9.85it/s] 98%|█████████▊| 350/358 [00:35<00:00,  9.78it/s] 98%|█████████▊| 351/358 [00:35<00:00,  9.74it/s] 99%|█████████▊| 353/358 [00:35<00:00,  9.92it/s] 99%|█████████▉| 354/358 [00:36<00:00,  9.90it/s] 99%|█████████▉| 355/358 [00:36<00:00,  9.81it/s]100%|█████████▉| 357/358 [00:36<00:00,  9.87it/s]100%|██████████| 358/358 [00:36<00:00,  9.82it/s]
[32m2025-02-05 05:16:28.260[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    gen_loss  grad clip ratio  grad norm   ppl
       2.929                1      4.635 18.71[0m
[32m2025-02-05 05:16:28.260[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m169[0m - [1m[Valid][0m
  0%|          | 0/10256 [00:00<?, ?it/s]100%|██████████| 10256/10256 [00:00<00:00, 1094546.75it/s]
[32m2025-02-05 05:16:28.269[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:26,  1.48it/s]  5%|▌         | 2/40 [00:01<00:25,  1.49it/s]  8%|▊         | 3/40 [00:02<00:24,  1.50it/s] 10%|█         | 4/40 [00:02<00:24,  1.49it/s] 12%|█▎        | 5/40 [00:03<00:23,  1.48it/s] 15%|█▌        | 6/40 [00:04<00:22,  1.48it/s] 18%|█▊        | 7/40 [00:04<00:22,  1.48it/s] 20%|██        | 8/40 [00:05<00:21,  1.48it/s] 22%|██▎       | 9/40 [00:06<00:20,  1.48it/s] 25%|██▌       | 10/40 [00:06<00:20,  1.49it/s] 28%|██▊       | 11/40 [00:07<00:19,  1.48it/s] 30%|███       | 12/40 [00:08<00:18,  1.48it/s] 32%|███▎      | 13/40 [00:08<00:18,  1.49it/s] 35%|███▌      | 14/40 [00:09<00:17,  1.48it/s] 38%|███▊      | 15/40 [00:10<00:16,  1.48it/s] 40%|████      | 16/40 [00:10<00:16,  1.47it/s] 42%|████▎     | 17/40 [00:11<00:15,  1.47it/s] 45%|████▌     | 18/40 [00:12<00:14,  1.47it/s] 48%|████▊     | 19/40 [00:12<00:14,  1.47it/s] 50%|█████     | 20/40 [00:13<00:13,  1.48it/s] 52%|█████▎    | 21/40 [00:14<00:12,  1.48it/s] 55%|█████▌    | 22/40 [00:14<00:12,  1.47it/s] 57%|█████▊    | 23/40 [00:15<00:11,  1.47it/s] 60%|██████    | 24/40 [00:16<00:10,  1.47it/s] 62%|██████▎   | 25/40 [00:16<00:10,  1.47it/s] 65%|██████▌   | 26/40 [00:17<00:09,  1.48it/s] 68%|██████▊   | 27/40 [00:18<00:08,  1.48it/s] 70%|███████   | 28/40 [00:18<00:08,  1.48it/s] 72%|███████▎  | 29/40 [00:19<00:07,  1.48it/s] 75%|███████▌  | 30/40 [00:20<00:06,  1.49it/s] 78%|███████▊  | 31/40 [00:20<00:06,  1.49it/s] 80%|████████  | 32/40 [00:21<00:05,  1.49it/s] 82%|████████▎ | 33/40 [00:22<00:04,  1.48it/s] 85%|████████▌ | 34/40 [00:22<00:04,  1.48it/s] 88%|████████▊ | 35/40 [00:23<00:03,  1.48it/s] 90%|█████████ | 36/40 [00:24<00:02,  1.48it/s] 92%|█████████▎| 37/40 [00:25<00:02,  1.48it/s] 95%|█████████▌| 38/40 [00:25<00:01,  1.47it/s] 98%|█████████▊| 39/40 [00:26<00:00,  1.47it/s]100%|██████████| 40/40 [00:26<00:00,  1.63it/s]100%|██████████| 40/40 [00:26<00:00,  1.49it/s]
[32m2025-02-05 05:16:55.119[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    average  bleu@1  bleu@2  bleu@3  bleu@4  dist@1  dist@2  dist@3  dist@4  extreme  \
      .7705   .2807   .0998  .03791  .01928   .0325   .2322   .5281   .7344    .5879   
      f1  gen_loss  greedy  intra_dist@1  intra_dist@2  intra_dist@3  intra_dist@4  \
   .3509     3.871   .6684         .8952         .9791         .9609         .9024   
     ppl  rouge1  rouge2  rougeL  
   47.97   .3835  .08713   .3702[0m
[32m2025-02-05 05:16:55.123[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m163[0m - [1m[Conversation epoch 8][0m
[32m2025-02-05 05:16:55.123[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m164[0m - [1m[Train][0m
  0%|          | 0/92414 [00:00<?, ?it/s]100%|██████████| 92414/92414 [00:00<00:00, 997101.94it/s]
[32m2025-02-05 05:16:55.216[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/358 [00:00<?, ?it/s]  0%|          | 1/358 [00:00<00:36,  9.74it/s]  1%|          | 3/358 [00:00<00:35,  9.91it/s]  1%|          | 4/358 [00:00<00:35,  9.89it/s]  2%|▏         | 6/358 [00:00<00:35,  9.85it/s]  2%|▏         | 7/358 [00:00<00:35,  9.79it/s]  2%|▏         | 8/358 [00:00<00:35,  9.83it/s]  3%|▎         | 9/358 [00:00<00:35,  9.74it/s]  3%|▎         | 10/358 [00:01<00:35,  9.73it/s]  3%|▎         | 11/358 [00:01<00:35,  9.67it/s]  4%|▎         | 13/358 [00:01<00:34,  9.90it/s]  4%|▍         | 14/358 [00:01<00:35,  9.82it/s]  4%|▍         | 15/358 [00:01<00:35,  9.75it/s]  4%|▍         | 16/358 [00:01<00:35,  9.69it/s]  5%|▍         | 17/358 [00:01<00:35,  9.71it/s]  5%|▌         | 18/358 [00:01<00:34,  9.79it/s]  5%|▌         | 19/358 [00:01<00:34,  9.72it/s]  6%|▌         | 20/358 [00:02<00:34,  9.66it/s]  6%|▌         | 21/358 [00:02<00:35,  9.59it/s]  6%|▌         | 22/358 [00:02<00:34,  9.66it/s]  7%|▋         | 24/358 [00:02<00:34,  9.77it/s]  7%|▋         | 25/358 [00:02<00:34,  9.71it/s]  7%|▋         | 26/358 [00:02<00:34,  9.66it/s]  8%|▊         | 27/358 [00:02<00:34,  9.72it/s]  8%|▊         | 28/358 [00:02<00:34,  9.67it/s]  8%|▊         | 29/358 [00:02<00:34,  9.64it/s]  9%|▊         | 31/358 [00:03<00:33,  9.74it/s]  9%|▉         | 32/358 [00:03<00:33,  9.74it/s]  9%|▉         | 34/358 [00:03<00:32,  9.84it/s] 10%|█         | 36/358 [00:03<00:32,  9.84it/s] 10%|█         | 37/358 [00:03<00:32,  9.82it/s] 11%|█         | 38/358 [00:03<00:32,  9.77it/s] 11%|█         | 40/358 [00:04<00:32,  9.94it/s] 11%|█▏        | 41/358 [00:04<00:32,  9.85it/s] 12%|█▏        | 43/358 [00:04<00:31,  9.88it/s] 13%|█▎        | 45/358 [00:04<00:31,  9.98it/s] 13%|█▎        | 47/358 [00:04<00:31,  9.95it/s] 13%|█▎        | 48/358 [00:04<00:31,  9.94it/s] 14%|█▍        | 50/358 [00:05<00:31,  9.91it/s] 14%|█▍        | 51/358 [00:05<00:31,  9.84it/s] 15%|█▍        | 52/358 [00:05<00:31,  9.75it/s] 15%|█▍        | 53/358 [00:05<00:31,  9.70it/s] 15%|█▌        | 54/358 [00:05<00:31,  9.74it/s] 15%|█▌        | 55/358 [00:05<00:31,  9.69it/s] 16%|█▌        | 56/358 [00:05<00:31,  9.73it/s] 16%|█▌        | 57/358 [00:05<00:31,  9.69it/s] 16%|█▌        | 58/358 [00:05<00:31,  9.66it/s] 16%|█▋        | 59/358 [00:06<00:31,  9.63it/s] 17%|█▋        | 61/358 [00:06<00:30,  9.71it/s] 17%|█▋        | 62/358 [00:06<00:30,  9.64it/s] 18%|█▊        | 63/358 [00:06<00:30,  9.70it/s] 18%|█▊        | 64/358 [00:06<00:30,  9.65it/s] 18%|█▊        | 66/358 [00:06<00:30,  9.72it/s] 19%|█▊        | 67/358 [00:06<00:29,  9.70it/s] 19%|█▉        | 69/358 [00:07<00:29,  9.77it/s] 20%|█▉        | 70/358 [00:07<00:29,  9.72it/s] 20%|█▉        | 71/358 [00:07<00:29,  9.76it/s] 20%|██        | 72/358 [00:07<00:29,  9.71it/s] 20%|██        | 73/358 [00:07<00:29,  9.68it/s] 21%|██        | 74/358 [00:07<00:29,  9.64it/s] 21%|██        | 75/358 [00:07<00:29,  9.61it/s] 21%|██        | 76/358 [00:07<00:29,  9.72it/s] 22%|██▏       | 77/358 [00:07<00:29,  9.68it/s] 22%|██▏       | 79/358 [00:08<00:28,  9.69it/s] 23%|██▎       | 81/358 [00:08<00:28,  9.75it/s] 23%|██▎       | 83/358 [00:08<00:28,  9.77it/s] 23%|██▎       | 84/358 [00:08<00:28,  9.72it/s] 24%|██▎       | 85/358 [00:08<00:28,  9.67it/s] 24%|██▍       | 86/358 [00:08<00:28,  9.66it/s] 24%|██▍       | 87/358 [00:08<00:28,  9.64it/s] 25%|██▍       | 88/358 [00:09<00:27,  9.66it/s] 25%|██▌       | 90/358 [00:09<00:27,  9.90it/s] 26%|██▌       | 92/358 [00:09<00:26, 10.00it/s] 26%|██▌       | 93/358 [00:09<00:26,  9.96it/s] 26%|██▋       | 94/358 [00:09<00:26,  9.87it/s] 27%|██▋       | 96/358 [00:09<00:25, 10.15it/s] 27%|██▋       | 98/358 [00:10<00:25, 10.04it/s] 28%|██▊       | 99/358 [00:10<00:26,  9.95it/s] 28%|██▊       | 101/358 [00:10<00:25,  9.92it/s] 29%|██▉       | 103/358 [00:10<00:25,  9.91it/s] 29%|██▉       | 104/358 [00:10<00:25,  9.86it/s] 29%|██▉       | 105/358 [00:10<00:25,  9.78it/s] 30%|██▉       | 106/358 [00:10<00:25,  9.76it/s] 30%|███       | 108/358 [00:11<00:25,  9.79it/s] 30%|███       | 109/358 [00:11<00:25,  9.71it/s] 31%|███       | 110/358 [00:11<00:25,  9.69it/s] 31%|███       | 111/358 [00:11<00:25,  9.64it/s] 32%|███▏      | 113/358 [00:11<00:24,  9.91it/s] 32%|███▏      | 114/358 [00:11<00:24,  9.86it/s] 32%|███▏      | 115/358 [00:11<00:24,  9.77it/s] 32%|███▏      | 116/358 [00:11<00:24,  9.68it/s] 33%|███▎      | 117/358 [00:11<00:24,  9.66it/s] 33%|███▎      | 119/358 [00:12<00:24,  9.77it/s] 34%|███▍      | 121/358 [00:12<00:23,  9.97it/s] 34%|███▍      | 123/358 [00:12<00:23, 10.07it/s] 35%|███▍      | 125/358 [00:12<00:23, 10.05it/s] 35%|███▌      | 127/358 [00:12<00:23,  9.98it/s] 36%|███▌      | 128/358 [00:13<00:23,  9.94it/s] 36%|███▋      | 130/358 [00:13<00:22,  9.98it/s] 37%|███▋      | 131/358 [00:13<00:22,  9.89it/s] 37%|███▋      | 132/358 [00:13<00:22,  9.91it/s] 37%|███▋      | 134/358 [00:13<00:22,  9.93it/s] 38%|███▊      | 135/358 [00:13<00:22,  9.87it/s] 38%|███▊      | 137/358 [00:13<00:22,  9.95it/s] 39%|███▊      | 138/358 [00:14<00:22,  9.93it/s] 39%|███▉      | 139/358 [00:14<00:22,  9.85it/s] 39%|███▉      | 141/358 [00:14<00:21,  9.97it/s] 40%|███▉      | 142/358 [00:14<00:21,  9.89it/s] 40%|███▉      | 143/358 [00:14<00:21,  9.86it/s] 40%|████      | 144/358 [00:14<00:21,  9.77it/s] 41%|████      | 145/358 [00:14<00:21,  9.80it/s] 41%|████      | 146/358 [00:14<00:21,  9.73it/s] 41%|████      | 147/358 [00:14<00:21,  9.68it/s] 41%|████▏     | 148/358 [00:15<00:21,  9.70it/s] 42%|████▏     | 149/358 [00:15<00:21,  9.69it/s] 42%|████▏     | 150/358 [00:15<00:21,  9.64it/s] 42%|████▏     | 151/358 [00:15<00:22,  9.38it/s] 42%|████▏     | 152/358 [00:15<00:21,  9.42it/s] 43%|████▎     | 153/358 [00:15<00:21,  9.45it/s] 43%|████▎     | 154/358 [00:15<00:21,  9.54it/s] 43%|████▎     | 155/358 [00:15<00:21,  9.55it/s] 44%|████▎     | 156/358 [00:15<00:20,  9.67it/s] 44%|████▍     | 157/358 [00:16<00:20,  9.61it/s] 44%|████▍     | 158/358 [00:16<00:20,  9.70it/s] 44%|████▍     | 159/358 [00:16<00:20,  9.69it/s] 45%|████▍     | 160/358 [00:16<00:20,  9.70it/s] 45%|████▌     | 162/358 [00:16<00:19, 10.00it/s] 46%|████▌     | 164/358 [00:16<00:19, 10.00it/s] 46%|████▌     | 165/358 [00:16<00:19,  9.96it/s] 47%|████▋     | 167/358 [00:17<00:19,  9.90it/s] 47%|████▋     | 169/358 [00:17<00:19,  9.94it/s] 48%|████▊     | 171/358 [00:17<00:18,  9.92it/s] 48%|████▊     | 172/358 [00:17<00:18,  9.86it/s] 48%|████▊     | 173/358 [00:17<00:18,  9.80it/s] 49%|████▉     | 175/358 [00:17<00:18,  9.83it/s] 49%|████▉     | 176/358 [00:17<00:18,  9.84it/s] 49%|████▉     | 177/358 [00:18<00:18,  9.83it/s] 50%|█████     | 179/358 [00:18<00:18,  9.85it/s] 50%|█████     | 180/358 [00:18<00:18,  9.78it/s] 51%|█████     | 182/358 [00:18<00:17,  9.93it/s] 51%|█████     | 183/358 [00:18<00:17,  9.89it/s] 51%|█████▏    | 184/358 [00:18<00:17,  9.78it/s] 52%|█████▏    | 185/358 [00:18<00:17,  9.72it/s] 52%|█████▏    | 187/358 [00:19<00:17,  9.94it/s] 53%|█████▎    | 188/358 [00:19<00:17,  9.88it/s] 53%|█████▎    | 189/358 [00:19<00:17,  9.83it/s] 53%|█████▎    | 190/358 [00:19<00:17,  9.87it/s] 53%|█████▎    | 191/358 [00:19<00:17,  9.70it/s] 54%|█████▎    | 192/358 [00:19<00:17,  9.65it/s] 54%|█████▍    | 193/358 [00:19<00:17,  9.65it/s] 54%|█████▍    | 194/358 [00:19<00:17,  9.64it/s] 54%|█████▍    | 195/358 [00:19<00:16,  9.72it/s] 55%|█████▌    | 197/358 [00:20<00:16,  9.91it/s] 55%|█████▌    | 198/358 [00:20<00:16,  9.82it/s] 56%|█████▌    | 199/358 [00:20<00:16,  9.86it/s] 56%|█████▌    | 200/358 [00:20<00:16,  9.79it/s] 56%|█████▌    | 201/358 [00:20<00:16,  9.75it/s] 57%|█████▋    | 203/358 [00:20<00:15,  9.84it/s] 57%|█████▋    | 204/358 [00:20<00:15,  9.74it/s] 57%|█████▋    | 205/358 [00:20<00:15,  9.70it/s] 58%|█████▊    | 207/358 [00:21<00:15,  9.87it/s] 58%|█████▊    | 208/358 [00:21<00:15,  9.79it/s] 59%|█████▊    | 210/358 [00:21<00:15,  9.81it/s] 59%|█████▉    | 212/358 [00:21<00:14,  9.81it/s] 60%|█████▉    | 214/358 [00:21<00:14,  9.89it/s] 60%|██████    | 215/358 [00:21<00:14,  9.83it/s] 60%|██████    | 216/358 [00:22<00:14,  9.76it/s] 61%|██████    | 217/358 [00:22<00:14,  9.79it/s] 61%|██████    | 218/358 [00:22<00:14,  9.76it/s] 61%|██████    | 219/358 [00:22<00:14,  9.76it/s] 62%|██████▏   | 221/358 [00:22<00:13,  9.90it/s] 62%|██████▏   | 222/358 [00:22<00:13,  9.79it/s] 62%|██████▏   | 223/358 [00:22<00:13,  9.74it/s] 63%|██████▎   | 224/358 [00:22<00:13,  9.68it/s] 63%|██████▎   | 225/358 [00:22<00:13,  9.76it/s] 63%|██████▎   | 226/358 [00:23<00:13,  9.71it/s] 64%|██████▎   | 228/358 [00:23<00:13,  9.75it/s] 64%|██████▍   | 229/358 [00:23<00:13,  9.72it/s] 64%|██████▍   | 230/358 [00:23<00:13,  9.67it/s] 65%|██████▍   | 232/358 [00:23<00:12,  9.72it/s] 65%|██████▌   | 234/358 [00:23<00:12, 10.02it/s] 66%|██████▌   | 236/358 [00:24<00:12,  9.97it/s] 66%|██████▋   | 238/358 [00:24<00:11, 10.03it/s] 67%|██████▋   | 240/358 [00:24<00:11,  9.99it/s] 68%|██████▊   | 242/358 [00:24<00:11,  9.97it/s] 68%|██████▊   | 243/358 [00:24<00:11,  9.90it/s] 68%|██████▊   | 244/358 [00:24<00:11,  9.84it/s] 69%|██████▊   | 246/358 [00:25<00:11,  9.86it/s] 69%|██████▉   | 247/358 [00:25<00:11,  9.79it/s] 69%|██████▉   | 248/358 [00:25<00:11,  9.75it/s] 70%|██████▉   | 250/358 [00:25<00:10,  9.84it/s] 70%|███████   | 251/358 [00:25<00:10,  9.78it/s] 70%|███████   | 252/358 [00:25<00:10,  9.72it/s] 71%|███████   | 253/358 [00:25<00:10,  9.68it/s] 71%|███████   | 254/358 [00:25<00:10,  9.65it/s] 72%|███████▏  | 256/358 [00:26<00:10,  9.83it/s] 72%|███████▏  | 257/358 [00:26<00:10,  9.83it/s] 72%|███████▏  | 258/358 [00:26<00:10,  9.70it/s] 72%|███████▏  | 259/358 [00:26<00:10,  9.67it/s] 73%|███████▎  | 260/358 [00:26<00:10,  9.70it/s] 73%|███████▎  | 262/358 [00:26<00:09,  9.89it/s] 74%|███████▎  | 264/358 [00:26<00:09,  9.91it/s] 74%|███████▍  | 266/358 [00:27<00:09,  9.89it/s] 75%|███████▍  | 267/358 [00:27<00:09,  9.83it/s] 75%|███████▌  | 269/358 [00:27<00:09,  9.89it/s] 75%|███████▌  | 270/358 [00:27<00:08,  9.82it/s] 76%|███████▌  | 271/358 [00:27<00:08,  9.75it/s] 76%|███████▌  | 272/358 [00:27<00:08,  9.72it/s] 76%|███████▋  | 273/358 [00:27<00:08,  9.62it/s] 77%|███████▋  | 274/358 [00:27<00:08,  9.62it/s] 77%|███████▋  | 275/358 [00:28<00:08,  9.67it/s] 77%|███████▋  | 276/358 [00:28<00:08,  9.68it/s] 77%|███████▋  | 277/358 [00:28<00:08,  9.64it/s] 78%|███████▊  | 278/358 [00:28<00:08,  9.62it/s] 78%|███████▊  | 280/358 [00:28<00:07,  9.81it/s] 78%|███████▊  | 281/358 [00:28<00:07,  9.82it/s] 79%|███████▉  | 282/358 [00:28<00:07,  9.76it/s] 79%|███████▉  | 283/358 [00:28<00:07,  9.70it/s] 79%|███████▉  | 284/358 [00:28<00:07,  9.67it/s] 80%|███████▉  | 285/358 [00:29<00:07,  9.73it/s] 80%|███████▉  | 286/358 [00:29<00:07,  9.69it/s] 80%|████████  | 287/358 [00:29<00:07,  9.67it/s] 80%|████████  | 288/358 [00:29<00:07,  9.62it/s] 81%|████████  | 290/358 [00:29<00:06,  9.84it/s] 81%|████████▏ | 291/358 [00:29<00:06,  9.82it/s] 82%|████████▏ | 293/358 [00:29<00:06,  9.83it/s] 82%|████████▏ | 295/358 [00:30<00:06,  9.90it/s] 83%|████████▎ | 296/358 [00:30<00:06,  9.84it/s] 83%|████████▎ | 297/358 [00:30<00:06,  9.73it/s] 84%|████████▎ | 299/358 [00:30<00:05,  9.89it/s] 84%|████████▍ | 301/358 [00:30<00:05,  9.93it/s] 84%|████████▍ | 302/358 [00:30<00:05,  9.86it/s] 85%|████████▍ | 303/358 [00:30<00:05,  9.87it/s] 85%|████████▌ | 305/358 [00:31<00:05,  9.89it/s] 85%|████████▌ | 306/358 [00:31<00:05,  9.80it/s] 86%|████████▌ | 308/358 [00:31<00:05,  9.90it/s] 86%|████████▋ | 309/358 [00:31<00:04,  9.80it/s] 87%|████████▋ | 310/358 [00:31<00:04,  9.75it/s] 87%|████████▋ | 311/358 [00:31<00:04,  9.68it/s] 87%|████████▋ | 312/358 [00:31<00:04,  9.69it/s] 87%|████████▋ | 313/358 [00:31<00:04,  9.71it/s] 88%|████████▊ | 315/358 [00:32<00:04,  9.97it/s] 88%|████████▊ | 316/358 [00:32<00:04,  9.92it/s] 89%|████████▊ | 317/358 [00:32<00:04,  9.84it/s] 89%|████████▉ | 318/358 [00:32<00:04,  9.79it/s] 89%|████████▉ | 319/358 [00:32<00:04,  9.75it/s] 89%|████████▉ | 320/358 [00:32<00:03,  9.81it/s] 90%|████████▉ | 321/358 [00:32<00:03,  9.73it/s] 90%|████████▉ | 322/358 [00:32<00:03,  9.70it/s] 90%|█████████ | 323/358 [00:32<00:03,  9.65it/s] 91%|█████████ | 324/358 [00:33<00:03,  9.61it/s] 91%|█████████ | 325/358 [00:33<00:03,  9.59it/s] 91%|█████████▏| 327/358 [00:33<00:03,  9.96it/s] 92%|█████████▏| 329/358 [00:33<00:02, 10.05it/s] 92%|█████████▏| 330/358 [00:33<00:02,  9.94it/s] 93%|█████████▎| 332/358 [00:33<00:02, 10.04it/s] 93%|█████████▎| 334/358 [00:34<00:02,  9.95it/s] 94%|█████████▎| 335/358 [00:34<00:02,  9.83it/s] 94%|█████████▍| 337/358 [00:34<00:02,  9.91it/s] 95%|█████████▍| 339/358 [00:34<00:01, 10.11it/s] 95%|█████████▌| 341/358 [00:34<00:01, 10.05it/s] 96%|█████████▌| 343/358 [00:34<00:01,  9.89it/s] 96%|█████████▌| 344/358 [00:35<00:01,  9.83it/s] 96%|█████████▋| 345/358 [00:35<00:01,  9.85it/s] 97%|█████████▋| 346/358 [00:35<00:01,  9.88it/s] 97%|█████████▋| 348/358 [00:35<00:01,  9.97it/s] 97%|█████████▋| 349/358 [00:35<00:00,  9.88it/s] 98%|█████████▊| 350/358 [00:35<00:00,  9.80it/s] 98%|█████████▊| 351/358 [00:35<00:00,  9.75it/s] 99%|█████████▊| 353/358 [00:35<00:00,  9.92it/s] 99%|█████████▉| 354/358 [00:36<00:00,  9.90it/s] 99%|█████████▉| 355/358 [00:36<00:00,  9.81it/s]100%|█████████▉| 357/358 [00:36<00:00,  9.87it/s]100%|██████████| 358/358 [00:36<00:00,  9.82it/s]
[32m2025-02-05 05:17:31.696[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    gen_loss  grad clip ratio  grad norm   ppl
       2.849                1      4.087 17.28[0m
[32m2025-02-05 05:17:31.696[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m169[0m - [1m[Valid][0m
  0%|          | 0/10256 [00:00<?, ?it/s]100%|██████████| 10256/10256 [00:00<00:00, 928326.25it/s]
[32m2025-02-05 05:17:31.708[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:26,  1.45it/s]  5%|▌         | 2/40 [00:01<00:25,  1.47it/s]  8%|▊         | 3/40 [00:02<00:25,  1.48it/s] 10%|█         | 4/40 [00:02<00:24,  1.47it/s] 12%|█▎        | 5/40 [00:03<00:23,  1.47it/s] 15%|█▌        | 6/40 [00:04<00:23,  1.47it/s] 18%|█▊        | 7/40 [00:04<00:22,  1.47it/s] 20%|██        | 8/40 [00:05<00:21,  1.47it/s] 22%|██▎       | 9/40 [00:06<00:21,  1.47it/s] 25%|██▌       | 10/40 [00:06<00:20,  1.48it/s] 28%|██▊       | 11/40 [00:07<00:19,  1.47it/s] 30%|███       | 12/40 [00:08<00:18,  1.48it/s] 32%|███▎      | 13/40 [00:08<00:18,  1.48it/s] 35%|███▌      | 14/40 [00:09<00:17,  1.47it/s] 38%|███▊      | 15/40 [00:10<00:17,  1.47it/s] 40%|████      | 16/40 [00:10<00:16,  1.46it/s] 42%|████▎     | 17/40 [00:11<00:15,  1.47it/s] 45%|████▌     | 18/40 [00:12<00:14,  1.47it/s] 48%|████▊     | 19/40 [00:12<00:14,  1.47it/s] 50%|█████     | 20/40 [00:13<00:13,  1.48it/s] 52%|█████▎    | 21/40 [00:14<00:12,  1.48it/s] 55%|█████▌    | 22/40 [00:14<00:12,  1.47it/s] 57%|█████▊    | 23/40 [00:15<00:11,  1.47it/s] 60%|██████    | 24/40 [00:16<00:10,  1.46it/s] 62%|██████▎   | 25/40 [00:17<00:10,  1.46it/s] 65%|██████▌   | 26/40 [00:17<00:09,  1.47it/s] 68%|██████▊   | 27/40 [00:18<00:08,  1.48it/s] 70%|███████   | 28/40 [00:19<00:08,  1.48it/s] 72%|███████▎  | 29/40 [00:19<00:07,  1.48it/s] 75%|███████▌  | 30/40 [00:20<00:06,  1.48it/s] 78%|███████▊  | 31/40 [00:21<00:06,  1.48it/s] 80%|████████  | 32/40 [00:21<00:05,  1.48it/s] 82%|████████▎ | 33/40 [00:22<00:04,  1.48it/s] 85%|████████▌ | 34/40 [00:23<00:04,  1.48it/s] 88%|████████▊ | 35/40 [00:23<00:03,  1.47it/s] 90%|█████████ | 36/40 [00:24<00:02,  1.47it/s] 92%|█████████▎| 37/40 [00:25<00:02,  1.47it/s] 95%|█████████▌| 38/40 [00:25<00:01,  1.47it/s] 98%|█████████▊| 39/40 [00:26<00:00,  1.47it/s]100%|██████████| 40/40 [00:26<00:00,  1.62it/s]100%|██████████| 40/40 [00:26<00:00,  1.48it/s]
[32m2025-02-05 05:17:58.665[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    average  bleu@1  bleu@2  bleu@3  bleu@4  dist@1  dist@2  dist@3  dist@4  extreme  \
      .7736   .2769  .09898  .03868  .01977  .03142   .2292   .5284   .7521    .5881   
      f1  gen_loss  greedy  intra_dist@1  intra_dist@2  intra_dist@3  intra_dist@4  \
   .3465     3.922   .6662         .8872         .9787         .9580         .9124   
     ppl  rouge1  rouge2  rougeL  
   50.52   .3785  .08598   .3656[0m
[32m2025-02-05 05:17:58.671[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m163[0m - [1m[Conversation epoch 9][0m
[32m2025-02-05 05:17:58.671[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m164[0m - [1m[Train][0m
  0%|          | 0/92414 [00:00<?, ?it/s]100%|██████████| 92414/92414 [00:00<00:00, 1077473.33it/s]
[32m2025-02-05 05:17:58.757[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/358 [00:00<?, ?it/s]  0%|          | 1/358 [00:00<00:36,  9.74it/s]  1%|          | 3/358 [00:00<00:35,  9.93it/s]  1%|          | 4/358 [00:00<00:35,  9.91it/s]  2%|▏         | 6/358 [00:00<00:35,  9.87it/s]  2%|▏         | 7/358 [00:00<00:35,  9.81it/s]  2%|▏         | 8/358 [00:00<00:35,  9.85it/s]  3%|▎         | 9/358 [00:00<00:35,  9.75it/s]  3%|▎         | 10/358 [00:01<00:35,  9.74it/s]  3%|▎         | 11/358 [00:01<00:35,  9.69it/s]  4%|▎         | 13/358 [00:01<00:34,  9.91it/s]  4%|▍         | 14/358 [00:01<00:34,  9.84it/s]  4%|▍         | 15/358 [00:01<00:35,  9.76it/s]  4%|▍         | 16/358 [00:01<00:35,  9.69it/s]  5%|▍         | 17/358 [00:01<00:35,  9.71it/s]  5%|▌         | 19/358 [00:01<00:34,  9.74it/s]  6%|▌         | 20/358 [00:02<00:34,  9.69it/s]  6%|▌         | 21/358 [00:02<00:35,  9.62it/s]  6%|▌         | 22/358 [00:02<00:34,  9.68it/s]  7%|▋         | 24/358 [00:02<00:34,  9.77it/s]  7%|▋         | 25/358 [00:02<00:34,  9.72it/s]  7%|▋         | 26/358 [00:02<00:34,  9.67it/s]  8%|▊         | 27/358 [00:02<00:34,  9.72it/s]  8%|▊         | 28/358 [00:02<00:34,  9.67it/s]  8%|▊         | 29/358 [00:02<00:34,  9.64it/s]  9%|▊         | 31/358 [00:03<00:33,  9.74it/s]  9%|▉         | 32/358 [00:03<00:33,  9.74it/s]  9%|▉         | 34/358 [00:03<00:32,  9.84it/s] 10%|█         | 36/358 [00:03<00:32,  9.83it/s] 10%|█         | 37/358 [00:03<00:32,  9.82it/s] 11%|█         | 38/358 [00:03<00:32,  9.77it/s] 11%|█         | 40/358 [00:04<00:32,  9.93it/s] 11%|█▏        | 41/358 [00:04<00:32,  9.85it/s] 12%|█▏        | 43/358 [00:04<00:31,  9.88it/s] 13%|█▎        | 45/358 [00:04<00:31,  9.97it/s] 13%|█▎        | 47/358 [00:04<00:31,  9.94it/s] 13%|█▎        | 48/358 [00:04<00:31,  9.93it/s] 14%|█▍        | 50/358 [00:05<00:31,  9.91it/s] 14%|█▍        | 51/358 [00:05<00:31,  9.84it/s] 15%|█▍        | 52/358 [00:05<00:31,  9.75it/s] 15%|█▍        | 53/358 [00:05<00:31,  9.70it/s] 15%|█▌        | 54/358 [00:05<00:31,  9.74it/s] 15%|█▌        | 55/358 [00:05<00:31,  9.69it/s] 16%|█▌        | 56/358 [00:05<00:31,  9.73it/s] 16%|█▌        | 57/358 [00:05<00:31,  9.68it/s] 16%|█▌        | 58/358 [00:05<00:31,  9.66it/s] 16%|█▋        | 59/358 [00:06<00:31,  9.63it/s] 17%|█▋        | 61/358 [00:06<00:30,  9.71it/s] 17%|█▋        | 62/358 [00:06<00:30,  9.63it/s] 18%|█▊        | 63/358 [00:06<00:30,  9.70it/s] 18%|█▊        | 64/358 [00:06<00:30,  9.65it/s] 18%|█▊        | 66/358 [00:06<00:30,  9.72it/s] 19%|█▊        | 67/358 [00:06<00:29,  9.70it/s] 19%|█▉        | 69/358 [00:07<00:29,  9.77it/s] 20%|█▉        | 70/358 [00:07<00:29,  9.71it/s] 20%|█▉        | 71/358 [00:07<00:29,  9.76it/s] 20%|██        | 72/358 [00:07<00:29,  9.71it/s] 20%|██        | 73/358 [00:07<00:29,  9.68it/s] 21%|██        | 74/358 [00:07<00:29,  9.64it/s] 21%|██        | 75/358 [00:07<00:29,  9.61it/s] 21%|██        | 76/358 [00:07<00:29,  9.71it/s] 22%|██▏       | 77/358 [00:07<00:29,  9.68it/s] 22%|██▏       | 79/358 [00:08<00:28,  9.69it/s] 23%|██▎       | 81/358 [00:08<00:28,  9.75it/s] 23%|██▎       | 83/358 [00:08<00:28,  9.77it/s] 23%|██▎       | 84/358 [00:08<00:28,  9.72it/s] 24%|██▎       | 85/358 [00:08<00:28,  9.68it/s] 24%|██▍       | 86/358 [00:08<00:28,  9.66it/s] 24%|██▍       | 87/358 [00:08<00:28,  9.64it/s] 25%|██▍       | 88/358 [00:09<00:27,  9.66it/s] 25%|██▌       | 90/358 [00:09<00:27,  9.90it/s] 26%|██▌       | 92/358 [00:09<00:26, 10.00it/s] 26%|██▌       | 93/358 [00:09<00:26,  9.96it/s] 26%|██▋       | 94/358 [00:09<00:26,  9.87it/s] 27%|██▋       | 96/358 [00:09<00:25, 10.15it/s] 27%|██▋       | 98/358 [00:10<00:25, 10.04it/s] 28%|██▊       | 99/358 [00:10<00:26,  9.95it/s] 28%|██▊       | 101/358 [00:10<00:25,  9.92it/s] 29%|██▉       | 103/358 [00:10<00:25,  9.91it/s] 29%|██▉       | 104/358 [00:10<00:25,  9.86it/s] 29%|██▉       | 105/358 [00:10<00:25,  9.78it/s] 30%|██▉       | 106/358 [00:10<00:25,  9.77it/s] 30%|███       | 108/358 [00:11<00:25,  9.79it/s] 30%|███       | 109/358 [00:11<00:25,  9.71it/s] 31%|███       | 110/358 [00:11<00:25,  9.69it/s] 31%|███       | 111/358 [00:11<00:25,  9.64it/s] 32%|███▏      | 113/358 [00:11<00:24,  9.91it/s] 32%|███▏      | 114/358 [00:11<00:24,  9.87it/s] 32%|███▏      | 115/358 [00:11<00:24,  9.78it/s] 32%|███▏      | 116/358 [00:11<00:24,  9.69it/s] 33%|███▎      | 117/358 [00:11<00:24,  9.66it/s] 33%|███▎      | 119/358 [00:12<00:24,  9.78it/s] 34%|███▍      | 121/358 [00:12<00:23,  9.97it/s] 34%|███▍      | 123/358 [00:12<00:23, 10.07it/s] 35%|███▍      | 125/358 [00:12<00:23, 10.05it/s] 35%|███▌      | 127/358 [00:12<00:23,  9.98it/s] 36%|███▌      | 128/358 [00:13<00:23,  9.94it/s] 36%|███▋      | 130/358 [00:13<00:22,  9.98it/s] 37%|███▋      | 131/358 [00:13<00:22,  9.89it/s] 37%|███▋      | 132/358 [00:13<00:22,  9.91it/s] 37%|███▋      | 134/358 [00:13<00:22,  9.93it/s] 38%|███▊      | 135/358 [00:13<00:22,  9.87it/s] 38%|███▊      | 137/358 [00:13<00:22,  9.96it/s] 39%|███▊      | 138/358 [00:14<00:22,  9.94it/s] 39%|███▉      | 139/358 [00:14<00:22,  9.85it/s] 39%|███▉      | 141/358 [00:14<00:21,  9.98it/s] 40%|███▉      | 142/358 [00:14<00:21,  9.90it/s] 40%|███▉      | 143/358 [00:14<00:21,  9.87it/s] 40%|████      | 144/358 [00:14<00:21,  9.77it/s] 41%|████      | 145/358 [00:14<00:21,  9.79it/s] 41%|████      | 146/358 [00:14<00:21,  9.73it/s] 41%|████      | 147/358 [00:14<00:21,  9.67it/s] 41%|████▏     | 148/358 [00:15<00:21,  9.70it/s] 42%|████▏     | 149/358 [00:15<00:21,  9.69it/s] 42%|████▏     | 150/358 [00:15<00:21,  9.64it/s] 42%|████▏     | 151/358 [00:15<00:22,  9.38it/s] 42%|████▏     | 152/358 [00:15<00:21,  9.43it/s] 43%|████▎     | 153/358 [00:15<00:21,  9.45it/s] 43%|████▎     | 154/358 [00:15<00:21,  9.54it/s] 43%|████▎     | 155/358 [00:15<00:21,  9.55it/s] 44%|████▎     | 156/358 [00:15<00:20,  9.67it/s] 44%|████▍     | 157/358 [00:16<00:20,  9.61it/s] 44%|████▍     | 158/358 [00:16<00:20,  9.70it/s] 44%|████▍     | 159/358 [00:16<00:20,  9.69it/s] 45%|████▍     | 160/358 [00:16<00:20,  9.70it/s] 45%|████▌     | 162/358 [00:16<00:19, 10.00it/s] 46%|████▌     | 164/358 [00:16<00:19, 10.00it/s] 46%|████▌     | 165/358 [00:16<00:19,  9.95it/s] 47%|████▋     | 167/358 [00:17<00:19,  9.90it/s] 47%|████▋     | 169/358 [00:17<00:19,  9.94it/s] 48%|████▊     | 171/358 [00:17<00:18,  9.92it/s] 48%|████▊     | 172/358 [00:17<00:18,  9.87it/s] 48%|████▊     | 173/358 [00:17<00:18,  9.80it/s] 49%|████▉     | 175/358 [00:17<00:18,  9.83it/s] 49%|████▉     | 176/358 [00:17<00:18,  9.84it/s] 49%|████▉     | 177/358 [00:18<00:18,  9.83it/s] 50%|█████     | 179/358 [00:18<00:18,  9.85it/s] 50%|█████     | 180/358 [00:18<00:18,  9.77it/s] 51%|█████     | 182/358 [00:18<00:17,  9.93it/s] 51%|█████     | 183/358 [00:18<00:17,  9.88it/s] 51%|█████▏    | 184/358 [00:18<00:17,  9.77it/s] 52%|█████▏    | 185/358 [00:18<00:17,  9.72it/s] 52%|█████▏    | 187/358 [00:19<00:17,  9.93it/s] 53%|█████▎    | 188/358 [00:19<00:17,  9.88it/s] 53%|█████▎    | 189/358 [00:19<00:17,  9.83it/s] 53%|█████▎    | 191/358 [00:19<00:17,  9.75it/s] 54%|█████▎    | 192/358 [00:19<00:17,  9.70it/s] 54%|█████▍    | 193/358 [00:19<00:17,  9.69it/s] 54%|█████▍    | 194/358 [00:19<00:16,  9.67it/s] 54%|█████▍    | 195/358 [00:19<00:16,  9.73it/s] 55%|█████▌    | 197/358 [00:20<00:16,  9.91it/s] 55%|█████▌    | 198/358 [00:20<00:16,  9.83it/s] 56%|█████▌    | 199/358 [00:20<00:16,  9.87it/s] 56%|█████▌    | 200/358 [00:20<00:16,  9.80it/s] 56%|█████▌    | 201/358 [00:20<00:16,  9.76it/s] 57%|█████▋    | 203/358 [00:20<00:15,  9.85it/s] 57%|█████▋    | 204/358 [00:20<00:15,  9.74it/s] 57%|█████▋    | 205/358 [00:20<00:15,  9.70it/s] 58%|█████▊    | 207/358 [00:21<00:15,  9.87it/s] 58%|█████▊    | 208/358 [00:21<00:15,  9.80it/s] 59%|█████▊    | 210/358 [00:21<00:15,  9.82it/s] 59%|█████▉    | 212/358 [00:21<00:14,  9.81it/s] 60%|█████▉    | 214/358 [00:21<00:14,  9.88it/s] 60%|██████    | 215/358 [00:21<00:14,  9.82it/s] 60%|██████    | 216/358 [00:22<00:14,  9.76it/s] 61%|██████    | 217/358 [00:22<00:14,  9.79it/s] 61%|██████    | 218/358 [00:22<00:14,  9.76it/s] 61%|██████    | 219/358 [00:22<00:14,  9.77it/s] 62%|██████▏   | 221/358 [00:22<00:13,  9.90it/s] 62%|██████▏   | 222/358 [00:22<00:13,  9.79it/s] 62%|██████▏   | 223/358 [00:22<00:13,  9.74it/s] 63%|██████▎   | 224/358 [00:22<00:13,  9.68it/s] 63%|██████▎   | 225/358 [00:22<00:13,  9.76it/s] 63%|██████▎   | 226/358 [00:23<00:13,  9.71it/s] 64%|██████▎   | 228/358 [00:23<00:13,  9.74it/s] 64%|██████▍   | 229/358 [00:23<00:13,  9.71it/s] 64%|██████▍   | 230/358 [00:23<00:13,  9.66it/s] 65%|██████▍   | 232/358 [00:23<00:12,  9.72it/s] 65%|██████▌   | 234/358 [00:23<00:12,  9.97it/s] 66%|██████▌   | 236/358 [00:24<00:12,  9.93it/s] 66%|██████▋   | 238/358 [00:24<00:12, 10.00it/s] 67%|██████▋   | 240/358 [00:24<00:11,  9.97it/s] 68%|██████▊   | 242/358 [00:24<00:11,  9.95it/s] 68%|██████▊   | 243/358 [00:24<00:11,  9.89it/s] 68%|██████▊   | 244/358 [00:24<00:11,  9.83it/s] 69%|██████▊   | 246/358 [00:25<00:11,  9.85it/s] 69%|██████▉   | 247/358 [00:25<00:11,  9.78it/s] 69%|██████▉   | 248/358 [00:25<00:11,  9.74it/s] 70%|██████▉   | 250/358 [00:25<00:10,  9.83it/s] 70%|███████   | 251/358 [00:25<00:10,  9.78it/s] 70%|███████   | 252/358 [00:25<00:10,  9.71it/s] 71%|███████   | 253/358 [00:25<00:10,  9.67it/s] 71%|███████   | 254/358 [00:25<00:10,  9.65it/s] 72%|███████▏  | 256/358 [00:26<00:10,  9.82it/s] 72%|███████▏  | 257/358 [00:26<00:10,  9.83it/s] 72%|███████▏  | 258/358 [00:26<00:10,  9.70it/s] 72%|███████▏  | 259/358 [00:26<00:10,  9.66it/s] 73%|███████▎  | 260/358 [00:26<00:10,  9.70it/s] 73%|███████▎  | 262/358 [00:26<00:09,  9.87it/s] 74%|███████▎  | 264/358 [00:26<00:09,  9.89it/s] 74%|███████▍  | 266/358 [00:27<00:09,  9.89it/s] 75%|███████▍  | 267/358 [00:27<00:09,  9.83it/s] 75%|███████▌  | 269/358 [00:27<00:09,  9.89it/s] 75%|███████▌  | 270/358 [00:27<00:08,  9.82it/s] 76%|███████▌  | 271/358 [00:27<00:08,  9.74it/s] 76%|███████▌  | 272/358 [00:27<00:08,  9.72it/s] 76%|███████▋  | 273/358 [00:27<00:08,  9.62it/s] 77%|███████▋  | 274/358 [00:27<00:08,  9.62it/s] 77%|███████▋  | 275/358 [00:28<00:08,  9.67it/s] 77%|███████▋  | 276/358 [00:28<00:08,  9.67it/s] 77%|███████▋  | 277/358 [00:28<00:08,  9.64it/s] 78%|███████▊  | 278/358 [00:28<00:08,  9.62it/s] 78%|███████▊  | 280/358 [00:28<00:07,  9.81it/s] 78%|███████▊  | 281/358 [00:28<00:07,  9.82it/s] 79%|███████▉  | 282/358 [00:28<00:07,  9.76it/s] 79%|███████▉  | 283/358 [00:28<00:07,  9.70it/s] 79%|███████▉  | 284/358 [00:28<00:07,  9.66it/s] 80%|███████▉  | 285/358 [00:29<00:07,  9.73it/s] 80%|███████▉  | 286/358 [00:29<00:07,  9.69it/s] 80%|████████  | 287/358 [00:29<00:07,  9.66it/s] 80%|████████  | 288/358 [00:29<00:07,  9.61it/s] 81%|████████  | 289/358 [00:29<00:07,  9.71it/s] 81%|████████▏ | 291/358 [00:29<00:06,  9.83it/s] 82%|████████▏ | 293/358 [00:29<00:06,  9.83it/s] 82%|████████▏ | 295/358 [00:30<00:06,  9.90it/s] 83%|████████▎ | 296/358 [00:30<00:06,  9.84it/s] 83%|████████▎ | 297/358 [00:30<00:06,  9.73it/s] 84%|████████▎ | 299/358 [00:30<00:05,  9.89it/s] 84%|████████▍ | 301/358 [00:30<00:05,  9.92it/s] 84%|████████▍ | 302/358 [00:30<00:05,  9.86it/s] 85%|████████▍ | 303/358 [00:30<00:05,  9.87it/s] 85%|████████▌ | 305/358 [00:31<00:05,  9.89it/s] 85%|████████▌ | 306/358 [00:31<00:05,  9.82it/s] 86%|████████▌ | 308/358 [00:31<00:05,  9.92it/s] 86%|████████▋ | 309/358 [00:31<00:04,  9.82it/s] 87%|████████▋ | 310/358 [00:31<00:04,  9.76it/s] 87%|████████▋ | 311/358 [00:31<00:04,  9.67it/s] 87%|████████▋ | 312/358 [00:31<00:04,  9.69it/s] 87%|████████▋ | 313/358 [00:31<00:04,  9.71it/s] 88%|████████▊ | 315/358 [00:32<00:04,  9.96it/s] 88%|████████▊ | 316/358 [00:32<00:04,  9.91it/s] 89%|████████▊ | 317/358 [00:32<00:04,  9.83it/s] 89%|████████▉ | 318/358 [00:32<00:04,  9.79it/s] 89%|████████▉ | 319/358 [00:32<00:04,  9.74it/s] 89%|████████▉ | 320/358 [00:32<00:03,  9.80it/s] 90%|████████▉ | 321/358 [00:32<00:03,  9.73it/s] 90%|████████▉ | 322/358 [00:32<00:03,  9.69it/s] 90%|█████████ | 323/358 [00:32<00:03,  9.64it/s] 91%|█████████ | 324/358 [00:33<00:03,  9.62it/s] 91%|█████████ | 325/358 [00:33<00:03,  9.59it/s] 91%|█████████▏| 327/358 [00:33<00:03,  9.96it/s] 92%|█████████▏| 329/358 [00:33<00:02, 10.06it/s] 92%|█████████▏| 330/358 [00:33<00:02,  9.95it/s] 93%|█████████▎| 332/358 [00:33<00:02, 10.05it/s] 93%|█████████▎| 334/358 [00:34<00:02,  9.95it/s] 94%|█████████▎| 335/358 [00:34<00:02,  9.83it/s] 94%|█████████▍| 337/358 [00:34<00:02,  9.90it/s] 95%|█████████▍| 339/358 [00:34<00:01, 10.10it/s] 95%|█████████▌| 341/358 [00:34<00:01, 10.05it/s] 96%|█████████▌| 343/358 [00:34<00:01,  9.89it/s] 96%|█████████▌| 344/358 [00:35<00:01,  9.83it/s] 96%|█████████▋| 345/358 [00:35<00:01,  9.85it/s] 97%|█████████▋| 346/358 [00:35<00:01,  9.88it/s] 97%|█████████▋| 348/358 [00:35<00:01,  9.97it/s] 97%|█████████▋| 349/358 [00:35<00:00,  9.89it/s] 98%|█████████▊| 350/358 [00:35<00:00,  9.80it/s] 98%|█████████▊| 351/358 [00:35<00:00,  9.75it/s] 99%|█████████▊| 353/358 [00:35<00:00,  9.92it/s] 99%|█████████▉| 354/358 [00:36<00:00,  9.90it/s] 99%|█████████▉| 355/358 [00:36<00:00,  9.82it/s]100%|█████████▉| 357/358 [00:36<00:00,  9.87it/s]100%|██████████| 358/358 [00:36<00:00,  9.82it/s]
[32m2025-02-05 05:18:35.241[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    gen_loss  grad clip ratio  grad norm   ppl
       2.777                1       4.19 16.08[0m
[32m2025-02-05 05:18:35.241[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m169[0m - [1m[Valid][0m
  0%|          | 0/10256 [00:00<?, ?it/s]100%|██████████| 10256/10256 [00:00<00:00, 920164.75it/s]
[32m2025-02-05 05:18:35.253[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:27,  1.44it/s]  5%|▌         | 2/40 [00:01<00:25,  1.46it/s]  8%|▊         | 3/40 [00:02<00:25,  1.47it/s] 10%|█         | 4/40 [00:02<00:24,  1.47it/s] 12%|█▎        | 5/40 [00:03<00:23,  1.46it/s] 15%|█▌        | 6/40 [00:04<00:23,  1.46it/s] 18%|█▊        | 7/40 [00:04<00:22,  1.46it/s] 20%|██        | 8/40 [00:05<00:21,  1.47it/s] 22%|██▎       | 9/40 [00:06<00:21,  1.47it/s] 25%|██▌       | 10/40 [00:06<00:20,  1.47it/s] 28%|██▊       | 11/40 [00:07<00:19,  1.47it/s] 30%|███       | 12/40 [00:08<00:19,  1.47it/s] 32%|███▎      | 13/40 [00:08<00:18,  1.48it/s] 35%|███▌      | 14/40 [00:09<00:17,  1.47it/s] 38%|███▊      | 15/40 [00:10<00:17,  1.47it/s] 40%|████      | 16/40 [00:10<00:16,  1.47it/s] 42%|████▎     | 17/40 [00:11<00:15,  1.47it/s] 45%|████▌     | 18/40 [00:12<00:14,  1.47it/s] 48%|████▊     | 19/40 [00:12<00:14,  1.47it/s] 50%|█████     | 20/40 [00:13<00:13,  1.47it/s] 52%|█████▎    | 21/40 [00:14<00:12,  1.48it/s] 55%|█████▌    | 22/40 [00:14<00:12,  1.47it/s] 57%|█████▊    | 23/40 [00:15<00:11,  1.47it/s] 60%|██████    | 24/40 [00:16<00:10,  1.46it/s] 62%|██████▎   | 25/40 [00:17<00:10,  1.46it/s] 65%|██████▌   | 26/40 [00:17<00:09,  1.47it/s] 68%|██████▊   | 27/40 [00:18<00:08,  1.47it/s] 70%|███████   | 28/40 [00:19<00:08,  1.47it/s] 72%|███████▎  | 29/40 [00:19<00:07,  1.47it/s] 75%|███████▌  | 30/40 [00:20<00:06,  1.48it/s] 78%|███████▊  | 31/40 [00:21<00:06,  1.47it/s] 80%|████████  | 32/40 [00:21<00:05,  1.48it/s] 82%|████████▎ | 33/40 [00:22<00:04,  1.47it/s] 85%|████████▌ | 34/40 [00:23<00:04,  1.47it/s] 88%|████████▊ | 35/40 [00:23<00:03,  1.47it/s] 90%|█████████ | 36/40 [00:24<00:02,  1.47it/s] 92%|█████████▎| 37/40 [00:25<00:02,  1.47it/s] 95%|█████████▌| 38/40 [00:25<00:01,  1.47it/s] 98%|█████████▊| 39/40 [00:26<00:00,  1.46it/s]100%|██████████| 40/40 [00:27<00:00,  1.62it/s]100%|██████████| 40/40 [00:27<00:00,  1.48it/s]
[32m2025-02-05 05:19:02.274[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    average  bleu@1  bleu@2  bleu@3  bleu@4  dist@1  dist@2  dist@3  dist@4  extreme  \
      .7566   .2764  .09779  .04415  .02428  .03171   .2176   .4935   .6811    .5785   
      f1  gen_loss  greedy  intra_dist@1  intra_dist@2  intra_dist@3  intra_dist@4  \
   .3430     3.996   .6621         .8794         .9608         .9391         .8834   
     ppl  rouge1  rouge2  rougeL  
   54.38   .3828  .08662   .3683[0m
[32m2025-02-05 05:19:02.278[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m163[0m - [1m[Conversation epoch 10][0m
[32m2025-02-05 05:19:02.279[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m164[0m - [1m[Train][0m
  0%|          | 0/92414 [00:00<?, ?it/s]100%|██████████| 92414/92414 [00:00<00:00, 1088860.08it/s]
[32m2025-02-05 05:19:02.364[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/358 [00:00<?, ?it/s]  0%|          | 1/358 [00:00<00:36,  9.76it/s]  1%|          | 3/358 [00:00<00:35,  9.93it/s]  1%|          | 4/358 [00:00<00:35,  9.90it/s]  2%|▏         | 6/358 [00:00<00:35,  9.87it/s]  2%|▏         | 7/358 [00:00<00:35,  9.80it/s]  2%|▏         | 8/358 [00:00<00:35,  9.84it/s]  3%|▎         | 9/358 [00:00<00:35,  9.74it/s]  3%|▎         | 10/358 [00:01<00:35,  9.74it/s]  3%|▎         | 11/358 [00:01<00:35,  9.69it/s]  4%|▎         | 13/358 [00:01<00:34,  9.90it/s]  4%|▍         | 14/358 [00:01<00:34,  9.83it/s]  4%|▍         | 15/358 [00:01<00:35,  9.75it/s]  4%|▍         | 16/358 [00:01<00:35,  9.69it/s]  5%|▍         | 17/358 [00:01<00:35,  9.71it/s]  5%|▌         | 18/358 [00:01<00:34,  9.79it/s]  5%|▌         | 19/358 [00:01<00:34,  9.72it/s]  6%|▌         | 20/358 [00:02<00:34,  9.66it/s]  6%|▌         | 21/358 [00:02<00:35,  9.59it/s]  6%|▌         | 22/358 [00:02<00:34,  9.65it/s]  7%|▋         | 24/358 [00:02<00:34,  9.75it/s]  7%|▋         | 25/358 [00:02<00:34,  9.70it/s]  7%|▋         | 26/358 [00:02<00:34,  9.65it/s]  8%|▊         | 27/358 [00:02<00:34,  9.71it/s]  8%|▊         | 28/358 [00:02<00:34,  9.67it/s]  8%|▊         | 29/358 [00:02<00:34,  9.64it/s]  9%|▊         | 31/358 [00:03<00:33,  9.74it/s]  9%|▉         | 32/358 [00:03<00:33,  9.74it/s]  9%|▉         | 34/358 [00:03<00:32,  9.84it/s] 10%|█         | 36/358 [00:03<00:32,  9.83it/s] 10%|█         | 37/358 [00:03<00:32,  9.82it/s] 11%|█         | 38/358 [00:03<00:32,  9.77it/s] 11%|█         | 40/358 [00:04<00:32,  9.93it/s] 11%|█▏        | 41/358 [00:04<00:32,  9.84it/s] 12%|█▏        | 43/358 [00:04<00:31,  9.87it/s] 13%|█▎        | 45/358 [00:04<00:31,  9.97it/s] 13%|█▎        | 47/358 [00:04<00:31,  9.94it/s] 13%|█▎        | 48/358 [00:04<00:31,  9.93it/s] 14%|█▍        | 50/358 [00:05<00:31,  9.90it/s] 14%|█▍        | 51/358 [00:05<00:31,  9.83it/s] 15%|█▍        | 52/358 [00:05<00:31,  9.74it/s] 15%|█▍        | 53/358 [00:05<00:31,  9.69it/s] 15%|█▌        | 54/358 [00:05<00:31,  9.74it/s] 15%|█▌        | 55/358 [00:05<00:31,  9.68it/s] 16%|█▌        | 56/358 [00:05<00:31,  9.73it/s] 16%|█▌        | 57/358 [00:05<00:31,  9.69it/s] 16%|█▌        | 58/358 [00:05<00:31,  9.66it/s] 16%|█▋        | 59/358 [00:06<00:31,  9.63it/s] 17%|█▋        | 61/358 [00:06<00:30,  9.71it/s] 17%|█▋        | 62/358 [00:06<00:30,  9.63it/s] 18%|█▊        | 63/358 [00:06<00:30,  9.70it/s] 18%|█▊        | 64/358 [00:06<00:30,  9.65it/s] 18%|█▊        | 66/358 [00:06<00:30,  9.72it/s] 19%|█▊        | 67/358 [00:06<00:29,  9.71it/s] 19%|█▉        | 69/358 [00:07<00:29,  9.77it/s] 20%|█▉        | 70/358 [00:07<00:29,  9.71it/s] 20%|█▉        | 71/358 [00:07<00:29,  9.76it/s] 20%|██        | 72/358 [00:07<00:29,  9.71it/s] 20%|██        | 73/358 [00:07<00:29,  9.68it/s] 21%|██        | 74/358 [00:07<00:29,  9.65it/s] 21%|██        | 75/358 [00:07<00:29,  9.61it/s] 21%|██        | 76/358 [00:07<00:29,  9.71it/s] 22%|██▏       | 77/358 [00:07<00:29,  9.68it/s] 22%|██▏       | 79/358 [00:08<00:28,  9.68it/s] 23%|██▎       | 81/358 [00:08<00:28,  9.74it/s] 23%|██▎       | 83/358 [00:08<00:28,  9.77it/s] 23%|██▎       | 84/358 [00:08<00:28,  9.72it/s] 24%|██▎       | 85/358 [00:08<00:28,  9.68it/s] 24%|██▍       | 86/358 [00:08<00:28,  9.66it/s] 24%|██▍       | 87/358 [00:08<00:28,  9.64it/s] 25%|██▍       | 88/358 [00:09<00:27,  9.65it/s] 25%|██▌       | 90/358 [00:09<00:27,  9.89it/s] 26%|██▌       | 92/358 [00:09<00:26,  9.99it/s] 26%|██▌       | 93/358 [00:09<00:26,  9.95it/s] 26%|██▋       | 94/358 [00:09<00:26,  9.87it/s] 27%|██▋       | 96/358 [00:09<00:25, 10.15it/s] 27%|██▋       | 98/358 [00:10<00:25, 10.04it/s] 28%|██▊       | 99/358 [00:10<00:26,  9.95it/s] 28%|██▊       | 101/358 [00:10<00:25,  9.92it/s] 29%|██▉       | 103/358 [00:10<00:25,  9.91it/s] 29%|██▉       | 104/358 [00:10<00:25,  9.86it/s] 29%|██▉       | 105/358 [00:10<00:25,  9.78it/s] 30%|██▉       | 106/358 [00:10<00:25,  9.76it/s] 30%|███       | 108/358 [00:11<00:25,  9.79it/s] 30%|███       | 109/358 [00:11<00:25,  9.71it/s] 31%|███       | 110/358 [00:11<00:25,  9.69it/s] 31%|███       | 111/358 [00:11<00:25,  9.64it/s] 32%|███▏      | 113/358 [00:11<00:24,  9.90it/s] 32%|███▏      | 114/358 [00:11<00:24,  9.86it/s] 32%|███▏      | 115/358 [00:11<00:24,  9.77it/s] 32%|███▏      | 116/358 [00:11<00:24,  9.68it/s] 33%|███▎      | 117/358 [00:11<00:24,  9.66it/s] 33%|███▎      | 119/358 [00:12<00:24,  9.78it/s] 34%|███▍      | 121/358 [00:12<00:23,  9.97it/s] 34%|███▍      | 123/358 [00:12<00:23, 10.07it/s] 35%|███▍      | 125/358 [00:12<00:23, 10.05it/s] 35%|███▌      | 126/358 [00:12<00:23, 10.01it/s] 35%|███▌      | 127/358 [00:12<00:23,  9.96it/s] 36%|███▌      | 128/358 [00:13<00:23,  9.91it/s] 36%|███▋      | 130/358 [00:13<00:22,  9.98it/s] 37%|███▋      | 131/358 [00:13<00:22,  9.87it/s] 37%|███▋      | 132/358 [00:13<00:22,  9.90it/s] 37%|███▋      | 134/358 [00:13<00:22,  9.92it/s] 38%|███▊      | 135/358 [00:13<00:22,  9.86it/s] 38%|███▊      | 137/358 [00:13<00:22,  9.95it/s] 39%|███▊      | 138/358 [00:14<00:22,  9.93it/s] 39%|███▉      | 139/358 [00:14<00:22,  9.83it/s] 39%|███▉      | 141/358 [00:14<00:21,  9.96it/s] 40%|███▉      | 142/358 [00:14<00:21,  9.88it/s] 40%|███▉      | 143/358 [00:14<00:21,  9.84it/s] 40%|████      | 144/358 [00:14<00:21,  9.76it/s] 41%|████      | 145/358 [00:14<00:21,  9.78it/s] 41%|████      | 146/358 [00:14<00:21,  9.72it/s] 41%|████      | 147/358 [00:14<00:21,  9.66it/s] 41%|████▏     | 148/358 [00:15<00:21,  9.69it/s] 42%|████▏     | 149/358 [00:15<00:21,  9.68it/s] 42%|████▏     | 150/358 [00:15<00:21,  9.63it/s] 42%|████▏     | 151/358 [00:15<00:22,  9.37it/s] 42%|████▏     | 152/358 [00:15<00:21,  9.41it/s] 43%|████▎     | 153/358 [00:15<00:21,  9.43it/s] 43%|████▎     | 154/358 [00:15<00:21,  9.52it/s] 43%|████▎     | 155/358 [00:15<00:21,  9.54it/s] 44%|████▎     | 156/358 [00:15<00:20,  9.66it/s] 44%|████▍     | 157/358 [00:16<00:20,  9.60it/s] 44%|████▍     | 158/358 [00:16<00:20,  9.69it/s] 44%|████▍     | 159/358 [00:16<00:20,  9.68it/s] 45%|████▍     | 160/358 [00:16<00:20,  9.69it/s] 45%|████▌     | 162/358 [00:16<00:19,  9.98it/s] 46%|████▌     | 164/358 [00:16<00:19,  9.98it/s] 46%|████▌     | 165/358 [00:16<00:19,  9.94it/s] 47%|████▋     | 167/358 [00:17<00:19,  9.88it/s] 47%|████▋     | 169/358 [00:17<00:19,  9.93it/s] 48%|████▊     | 171/358 [00:17<00:18,  9.91it/s] 48%|████▊     | 172/358 [00:17<00:18,  9.86it/s] 48%|████▊     | 173/358 [00:17<00:18,  9.80it/s] 49%|████▉     | 175/358 [00:17<00:18,  9.82it/s] 49%|████▉     | 176/358 [00:17<00:18,  9.83it/s] 49%|████▉     | 177/358 [00:18<00:18,  9.82it/s] 50%|█████     | 179/358 [00:18<00:18,  9.84it/s] 50%|█████     | 180/358 [00:18<00:18,  9.77it/s] 51%|█████     | 182/358 [00:18<00:17,  9.92it/s] 51%|█████     | 183/358 [00:18<00:17,  9.88it/s] 51%|█████▏    | 184/358 [00:18<00:17,  9.77it/s] 52%|█████▏    | 185/358 [00:18<00:17,  9.71it/s] 52%|█████▏    | 187/358 [00:19<00:17,  9.93it/s] 53%|█████▎    | 188/358 [00:19<00:17,  9.87it/s] 53%|█████▎    | 189/358 [00:19<00:17,  9.81it/s] 53%|█████▎    | 190/358 [00:19<00:17,  9.86it/s] 53%|█████▎    | 191/358 [00:19<00:17,  9.69it/s] 54%|█████▎    | 192/358 [00:19<00:17,  9.63it/s] 54%|█████▍    | 193/358 [00:19<00:17,  9.62it/s] 54%|█████▍    | 194/358 [00:19<00:17,  9.61it/s] 54%|█████▍    | 195/358 [00:19<00:16,  9.70it/s] 55%|█████▌    | 197/358 [00:20<00:16,  9.90it/s] 55%|█████▌    | 198/358 [00:20<00:16,  9.82it/s] 56%|█████▌    | 199/358 [00:20<00:16,  9.85it/s] 56%|█████▌    | 200/358 [00:20<00:16,  9.79it/s] 56%|█████▌    | 201/358 [00:20<00:16,  9.75it/s] 57%|█████▋    | 203/358 [00:20<00:15,  9.84it/s] 57%|█████▋    | 204/358 [00:20<00:15,  9.73it/s] 57%|█████▋    | 205/358 [00:20<00:15,  9.69it/s] 58%|█████▊    | 207/358 [00:21<00:15,  9.86it/s] 58%|█████▊    | 208/358 [00:21<00:15,  9.79it/s] 59%|█████▊    | 210/358 [00:21<00:15,  9.81it/s] 59%|█████▉    | 212/358 [00:21<00:14,  9.80it/s] 60%|█████▉    | 214/358 [00:21<00:14,  9.88it/s] 60%|██████    | 215/358 [00:21<00:14,  9.81it/s] 60%|██████    | 216/358 [00:22<00:14,  9.74it/s] 61%|██████    | 217/358 [00:22<00:14,  9.78it/s] 61%|██████    | 218/358 [00:22<00:14,  9.75it/s] 61%|██████    | 219/358 [00:22<00:14,  9.76it/s] 62%|██████▏   | 221/358 [00:22<00:13,  9.89it/s] 62%|██████▏   | 222/358 [00:22<00:13,  9.79it/s] 62%|██████▏   | 223/358 [00:22<00:13,  9.73it/s] 63%|██████▎   | 224/358 [00:22<00:13,  9.68it/s] 63%|██████▎   | 225/358 [00:22<00:13,  9.76it/s] 63%|██████▎   | 226/358 [00:23<00:13,  9.70it/s] 64%|██████▎   | 228/358 [00:23<00:13,  9.74it/s] 64%|██████▍   | 229/358 [00:23<00:13,  9.71it/s] 64%|██████▍   | 230/358 [00:23<00:13,  9.66it/s] 65%|██████▍   | 232/358 [00:23<00:12,  9.72it/s] 65%|██████▌   | 234/358 [00:23<00:12, 10.01it/s] 66%|██████▌   | 236/358 [00:24<00:12,  9.97it/s] 66%|██████▋   | 238/358 [00:24<00:11, 10.02it/s] 67%|██████▋   | 240/358 [00:24<00:11,  9.98it/s] 68%|██████▊   | 242/358 [00:24<00:11,  9.96it/s] 68%|██████▊   | 243/358 [00:24<00:11,  9.90it/s] 68%|██████▊   | 244/358 [00:24<00:11,  9.83it/s] 69%|██████▊   | 246/358 [00:25<00:11,  9.85it/s] 69%|██████▉   | 247/358 [00:25<00:11,  9.78it/s] 69%|██████▉   | 248/358 [00:25<00:11,  9.74it/s] 70%|██████▉   | 250/358 [00:25<00:10,  9.84it/s] 70%|███████   | 251/358 [00:25<00:10,  9.77it/s] 70%|███████   | 252/358 [00:25<00:10,  9.71it/s] 71%|███████   | 253/358 [00:25<00:10,  9.67it/s] 71%|███████   | 254/358 [00:25<00:10,  9.64it/s] 72%|███████▏  | 256/358 [00:26<00:10,  9.82it/s] 72%|███████▏  | 257/358 [00:26<00:10,  9.82it/s] 72%|███████▏  | 258/358 [00:26<00:10,  9.69it/s] 72%|███████▏  | 259/358 [00:26<00:10,  9.66it/s] 73%|███████▎  | 260/358 [00:26<00:10,  9.70it/s] 73%|███████▎  | 262/358 [00:26<00:09,  9.88it/s] 74%|███████▎  | 264/358 [00:26<00:09,  9.89it/s] 74%|███████▍  | 266/358 [00:27<00:09,  9.88it/s] 75%|███████▍  | 267/358 [00:27<00:09,  9.82it/s] 75%|███████▌  | 269/358 [00:27<00:09,  9.88it/s] 75%|███████▌  | 270/358 [00:27<00:08,  9.81it/s] 76%|███████▌  | 271/358 [00:27<00:08,  9.74it/s] 76%|███████▌  | 272/358 [00:27<00:08,  9.72it/s] 76%|███████▋  | 273/358 [00:27<00:08,  9.62it/s] 77%|███████▋  | 274/358 [00:27<00:08,  9.62it/s] 77%|███████▋  | 275/358 [00:28<00:08,  9.66it/s] 77%|███████▋  | 276/358 [00:28<00:08,  9.67it/s] 77%|███████▋  | 277/358 [00:28<00:08,  9.64it/s] 78%|███████▊  | 278/358 [00:28<00:08,  9.61it/s] 78%|███████▊  | 280/358 [00:28<00:07,  9.80it/s] 78%|███████▊  | 281/358 [00:28<00:07,  9.82it/s] 79%|███████▉  | 282/358 [00:28<00:07,  9.75it/s] 79%|███████▉  | 283/358 [00:28<00:07,  9.69it/s] 79%|███████▉  | 284/358 [00:29<00:07,  9.66it/s] 80%|███████▉  | 285/358 [00:29<00:07,  9.72it/s] 80%|███████▉  | 286/358 [00:29<00:07,  9.68it/s] 80%|████████  | 287/358 [00:29<00:07,  9.66it/s] 80%|████████  | 288/358 [00:29<00:07,  9.62it/s] 81%|████████  | 290/358 [00:29<00:06,  9.83it/s] 81%|████████▏ | 291/358 [00:29<00:06,  9.81it/s] 82%|████████▏ | 293/358 [00:29<00:06,  9.82it/s] 82%|████████▏ | 295/358 [00:30<00:06,  9.90it/s] 83%|████████▎ | 296/358 [00:30<00:06,  9.83it/s] 83%|████████▎ | 297/358 [00:30<00:06,  9.72it/s] 84%|████████▎ | 299/358 [00:30<00:05,  9.89it/s] 84%|████████▍ | 301/358 [00:30<00:05,  9.92it/s] 84%|████████▍ | 302/358 [00:30<00:05,  9.86it/s] 85%|████████▍ | 303/358 [00:30<00:05,  9.86it/s] 85%|████████▌ | 305/358 [00:31<00:05,  9.89it/s] 85%|████████▌ | 306/358 [00:31<00:05,  9.81it/s] 86%|████████▌ | 308/358 [00:31<00:05,  9.91it/s] 86%|████████▋ | 309/358 [00:31<00:04,  9.81it/s] 87%|████████▋ | 310/358 [00:31<00:04,  9.75it/s] 87%|████████▋ | 311/358 [00:31<00:04,  9.67it/s] 87%|████████▋ | 312/358 [00:31<00:04,  9.69it/s] 87%|████████▋ | 313/358 [00:31<00:04,  9.71it/s] 88%|████████▊ | 315/358 [00:32<00:04,  9.97it/s] 88%|████████▊ | 316/358 [00:32<00:04,  9.92it/s] 89%|████████▊ | 317/358 [00:32<00:04,  9.84it/s] 89%|████████▉ | 318/358 [00:32<00:04,  9.79it/s] 89%|████████▉ | 319/358 [00:32<00:04,  9.74it/s] 89%|████████▉ | 320/358 [00:32<00:03,  9.80it/s] 90%|████████▉ | 321/358 [00:32<00:03,  9.73it/s] 90%|████████▉ | 322/358 [00:32<00:03,  9.69it/s] 90%|█████████ | 323/358 [00:32<00:03,  9.64it/s] 91%|█████████ | 324/358 [00:33<00:03,  9.62it/s] 91%|█████████ | 325/358 [00:33<00:03,  9.60it/s] 91%|█████████▏| 327/358 [00:33<00:03,  9.96it/s] 92%|█████████▏| 329/358 [00:33<00:02, 10.05it/s] 92%|█████████▏| 330/358 [00:33<00:02,  9.94it/s] 93%|█████████▎| 332/358 [00:33<00:02, 10.05it/s] 93%|█████████▎| 334/358 [00:34<00:02,  9.95it/s] 94%|█████████▎| 335/358 [00:34<00:02,  9.83it/s] 94%|█████████▍| 337/358 [00:34<00:02,  9.91it/s] 95%|█████████▍| 339/358 [00:34<00:01, 10.10it/s] 95%|█████████▌| 341/358 [00:34<00:01, 10.05it/s] 96%|█████████▌| 343/358 [00:34<00:01,  9.88it/s] 96%|█████████▌| 344/358 [00:35<00:01,  9.83it/s] 96%|█████████▋| 345/358 [00:35<00:01,  9.85it/s] 97%|█████████▋| 346/358 [00:35<00:01,  9.88it/s] 97%|█████████▋| 348/358 [00:35<00:01,  9.96it/s] 97%|█████████▋| 349/358 [00:35<00:00,  9.88it/s] 98%|█████████▊| 350/358 [00:35<00:00,  9.80it/s] 98%|█████████▊| 351/358 [00:35<00:00,  9.75it/s] 99%|█████████▊| 353/358 [00:36<00:00,  9.92it/s] 99%|█████████▉| 354/358 [00:36<00:00,  9.90it/s] 99%|█████████▉| 355/358 [00:36<00:00,  9.81it/s]100%|█████████▉| 357/358 [00:36<00:00,  9.86it/s]100%|██████████| 358/358 [00:36<00:00,  9.81it/s]
[32m2025-02-05 05:19:38.859[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    gen_loss  grad clip ratio  grad norm   ppl
       2.711                1       4.35 15.05[0m
[32m2025-02-05 05:19:38.860[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m169[0m - [1m[Valid][0m
  0%|          | 0/10256 [00:00<?, ?it/s]100%|██████████| 10256/10256 [00:00<00:00, 923205.96it/s]
[32m2025-02-05 05:19:38.871[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:27,  1.43it/s]  5%|▌         | 2/40 [00:01<00:26,  1.45it/s]  8%|▊         | 3/40 [00:02<00:25,  1.46it/s] 10%|█         | 4/40 [00:02<00:24,  1.46it/s] 12%|█▎        | 5/40 [00:03<00:24,  1.45it/s] 15%|█▌        | 6/40 [00:04<00:23,  1.45it/s] 18%|█▊        | 7/40 [00:04<00:22,  1.45it/s] 20%|██        | 8/40 [00:05<00:22,  1.45it/s] 22%|██▎       | 9/40 [00:06<00:21,  1.46it/s] 25%|██▌       | 10/40 [00:06<00:20,  1.46it/s] 28%|██▊       | 11/40 [00:07<00:19,  1.46it/s] 30%|███       | 12/40 [00:08<00:19,  1.47it/s] 32%|███▎      | 13/40 [00:08<00:18,  1.47it/s] 35%|███▌      | 14/40 [00:09<00:17,  1.46it/s] 38%|███▊      | 15/40 [00:10<00:17,  1.45it/s] 40%|████      | 16/40 [00:10<00:16,  1.45it/s] 42%|████▎     | 17/40 [00:11<00:15,  1.45it/s] 45%|████▌     | 18/40 [00:12<00:15,  1.45it/s] 48%|████▊     | 19/40 [00:13<00:14,  1.45it/s] 50%|█████     | 20/40 [00:13<00:13,  1.45it/s] 52%|█████▎    | 21/40 [00:14<00:13,  1.46it/s] 55%|█████▌    | 22/40 [00:15<00:12,  1.46it/s] 57%|█████▊    | 23/40 [00:15<00:11,  1.46it/s] 60%|██████    | 24/40 [00:16<00:11,  1.45it/s] 62%|██████▎   | 25/40 [00:17<00:10,  1.45it/s] 65%|██████▌   | 26/40 [00:17<00:09,  1.46it/s] 68%|██████▊   | 27/40 [00:18<00:08,  1.45it/s] 70%|███████   | 28/40 [00:19<00:08,  1.45it/s] 72%|███████▎  | 29/40 [00:19<00:07,  1.45it/s] 75%|███████▌  | 30/40 [00:20<00:06,  1.46it/s] 78%|███████▊  | 31/40 [00:21<00:06,  1.46it/s] 80%|████████  | 32/40 [00:21<00:05,  1.46it/s] 82%|████████▎ | 33/40 [00:22<00:04,  1.46it/s] 85%|████████▌ | 34/40 [00:23<00:04,  1.46it/s] 88%|████████▊ | 35/40 [00:24<00:03,  1.46it/s] 90%|█████████ | 36/40 [00:24<00:02,  1.45it/s] 92%|█████████▎| 37/40 [00:25<00:02,  1.45it/s] 95%|█████████▌| 38/40 [00:26<00:01,  1.45it/s] 98%|█████████▊| 39/40 [00:26<00:00,  1.45it/s]100%|██████████| 40/40 [00:27<00:00,  1.60it/s]100%|██████████| 40/40 [00:27<00:00,  1.47it/s]
[32m2025-02-05 05:20:06.172[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    average  bleu@1  bleu@2  bleu@3  bleu@4  dist@1  dist@2  dist@3  dist@4  extreme  \
      .7670   .2790   .1015  .04173  .02281  .03454   .2655   .5888   .7904    .5835   
      f1  gen_loss  greedy  intra_dist@1  intra_dist@2  intra_dist@3  intra_dist@4  \
   .3437     4.045   .6634         .8757         .9751         .9494         .9066   
     ppl  rouge1  rouge2  rougeL  
   57.12   .3793  .08761   .3652[0m
[32m2025-02-05 05:20:06.179[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m163[0m - [1m[Conversation epoch 11][0m
[32m2025-02-05 05:20:06.179[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m164[0m - [1m[Train][0m
  0%|          | 0/92414 [00:00<?, ?it/s]100%|██████████| 92414/92414 [00:00<00:00, 1118550.46it/s]
[32m2025-02-05 05:20:06.262[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/358 [00:00<?, ?it/s]  0%|          | 1/358 [00:00<00:36,  9.76it/s]  1%|          | 3/358 [00:00<00:35,  9.93it/s]  1%|          | 4/358 [00:00<00:35,  9.90it/s]  2%|▏         | 6/358 [00:00<00:35,  9.87it/s]  2%|▏         | 7/358 [00:00<00:35,  9.80it/s]  2%|▏         | 8/358 [00:00<00:35,  9.85it/s]  3%|▎         | 9/358 [00:00<00:35,  9.75it/s]  3%|▎         | 10/358 [00:01<00:35,  9.74it/s]  3%|▎         | 11/358 [00:01<00:35,  9.69it/s]  4%|▎         | 13/358 [00:01<00:34,  9.91it/s]  4%|▍         | 14/358 [00:01<00:34,  9.83it/s]  4%|▍         | 15/358 [00:01<00:35,  9.76it/s]  4%|▍         | 16/358 [00:01<00:35,  9.69it/s]  5%|▍         | 17/358 [00:01<00:35,  9.71it/s]  5%|▌         | 18/358 [00:01<00:34,  9.79it/s]  5%|▌         | 19/358 [00:01<00:34,  9.72it/s]  6%|▌         | 20/358 [00:02<00:34,  9.66it/s]  6%|▌         | 21/358 [00:02<00:35,  9.59it/s]  6%|▌         | 22/358 [00:02<00:34,  9.66it/s]  7%|▋         | 24/358 [00:02<00:34,  9.76it/s]  7%|▋         | 25/358 [00:02<00:34,  9.71it/s]  7%|▋         | 26/358 [00:02<00:34,  9.66it/s]  8%|▊         | 27/358 [00:02<00:34,  9.71it/s]  8%|▊         | 28/358 [00:02<00:34,  9.66it/s]  8%|▊         | 29/358 [00:02<00:34,  9.63it/s]  9%|▊         | 31/358 [00:03<00:33,  9.73it/s]  9%|▉         | 32/358 [00:03<00:33,  9.73it/s]  9%|▉         | 34/358 [00:03<00:32,  9.83it/s] 10%|█         | 36/358 [00:03<00:32,  9.83it/s] 10%|█         | 37/358 [00:03<00:32,  9.81it/s] 11%|█         | 38/358 [00:03<00:32,  9.77it/s] 11%|█         | 40/358 [00:04<00:32,  9.92it/s] 11%|█▏        | 41/358 [00:04<00:32,  9.84it/s] 12%|█▏        | 43/358 [00:04<00:31,  9.86it/s] 13%|█▎        | 45/358 [00:04<00:31,  9.96it/s] 13%|█▎        | 47/358 [00:04<00:31,  9.93it/s] 13%|█▎        | 48/358 [00:04<00:31,  9.92it/s] 14%|█▍        | 50/358 [00:05<00:31,  9.89it/s] 14%|█▍        | 51/358 [00:05<00:31,  9.83it/s] 15%|█▍        | 52/358 [00:05<00:31,  9.74it/s] 15%|█▍        | 53/358 [00:05<00:31,  9.69it/s] 15%|█▌        | 54/358 [00:05<00:31,  9.72it/s] 15%|█▌        | 55/358 [00:05<00:31,  9.67it/s] 16%|█▌        | 56/358 [00:05<00:31,  9.72it/s] 16%|█▌        | 57/358 [00:05<00:31,  9.68it/s] 16%|█▌        | 58/358 [00:05<00:31,  9.66it/s] 16%|█▋        | 59/358 [00:06<00:31,  9.62it/s] 17%|█▋        | 61/358 [00:06<00:30,  9.71it/s] 17%|█▋        | 62/358 [00:06<00:30,  9.63it/s] 18%|█▊        | 63/358 [00:06<00:30,  9.70it/s] 18%|█▊        | 64/358 [00:06<00:30,  9.65it/s] 18%|█▊        | 66/358 [00:06<00:30,  9.72it/s] 19%|█▊        | 67/358 [00:06<00:30,  9.70it/s] 19%|█▉        | 69/358 [00:07<00:29,  9.75it/s] 20%|█▉        | 70/358 [00:07<00:29,  9.69it/s] 20%|█▉        | 71/358 [00:07<00:29,  9.74it/s] 20%|██        | 72/358 [00:07<00:29,  9.69it/s] 20%|██        | 73/358 [00:07<00:29,  9.66it/s] 21%|██        | 74/358 [00:07<00:29,  9.63it/s] 21%|██        | 75/358 [00:07<00:29,  9.60it/s] 21%|██        | 76/358 [00:07<00:29,  9.70it/s] 22%|██▏       | 77/358 [00:07<00:29,  9.67it/s] 22%|██▏       | 79/358 [00:08<00:28,  9.68it/s] 23%|██▎       | 81/358 [00:08<00:28,  9.74it/s] 23%|██▎       | 83/358 [00:08<00:28,  9.76it/s] 23%|██▎       | 84/358 [00:08<00:28,  9.71it/s] 24%|██▎       | 85/358 [00:08<00:28,  9.67it/s] 24%|██▍       | 86/358 [00:08<00:28,  9.65it/s] 24%|██▍       | 87/358 [00:08<00:28,  9.63it/s] 25%|██▍       | 88/358 [00:09<00:27,  9.65it/s] 25%|██▌       | 90/358 [00:09<00:27,  9.89it/s] 26%|██▌       | 92/358 [00:09<00:26,  9.99it/s] 26%|██▌       | 93/358 [00:09<00:26,  9.95it/s] 26%|██▋       | 94/358 [00:09<00:26,  9.87it/s] 27%|██▋       | 96/358 [00:09<00:25, 10.14it/s] 27%|██▋       | 98/358 [00:10<00:25, 10.03it/s] 28%|██▊       | 99/358 [00:10<00:26,  9.94it/s] 28%|██▊       | 101/358 [00:10<00:25,  9.91it/s] 29%|██▉       | 103/358 [00:10<00:25,  9.90it/s] 29%|██▉       | 104/358 [00:10<00:25,  9.85it/s] 29%|██▉       | 105/358 [00:10<00:25,  9.77it/s] 30%|██▉       | 106/358 [00:10<00:25,  9.76it/s] 30%|███       | 108/358 [00:11<00:25,  9.78it/s] 30%|███       | 109/358 [00:11<00:25,  9.70it/s] 31%|███       | 110/358 [00:11<00:25,  9.68it/s] 31%|███       | 111/358 [00:11<00:25,  9.63it/s] 32%|███▏      | 113/358 [00:11<00:24,  9.90it/s] 32%|███▏      | 114/358 [00:11<00:24,  9.86it/s] 32%|███▏      | 115/358 [00:11<00:24,  9.76it/s] 32%|███▏      | 116/358 [00:11<00:25,  9.68it/s] 33%|███▎      | 117/358 [00:11<00:24,  9.65it/s] 33%|███▎      | 119/358 [00:12<00:24,  9.77it/s] 34%|███▍      | 121/358 [00:12<00:23,  9.96it/s] 34%|███▍      | 123/358 [00:12<00:23, 10.05it/s] 35%|███▍      | 125/358 [00:12<00:23, 10.03it/s] 35%|███▌      | 126/358 [00:12<00:23,  9.99it/s] 35%|███▌      | 127/358 [00:12<00:23,  9.95it/s] 36%|███▌      | 128/358 [00:13<00:23,  9.90it/s] 36%|███▋      | 130/358 [00:13<00:22,  9.97it/s] 37%|███▋      | 131/358 [00:13<00:23,  9.87it/s] 37%|███▋      | 132/358 [00:13<00:22,  9.89it/s] 37%|███▋      | 134/358 [00:13<00:22,  9.91it/s] 38%|███▊      | 135/358 [00:13<00:22,  9.85it/s] 38%|███▊      | 137/358 [00:13<00:22,  9.94it/s] 39%|███▊      | 138/358 [00:14<00:22,  9.93it/s] 39%|███▉      | 139/358 [00:14<00:22,  9.84it/s] 39%|███▉      | 141/358 [00:14<00:21,  9.96it/s] 40%|███▉      | 142/358 [00:14<00:21,  9.89it/s] 40%|███▉      | 143/358 [00:14<00:21,  9.85it/s] 40%|████      | 144/358 [00:14<00:21,  9.76it/s] 41%|████      | 145/358 [00:14<00:21,  9.78it/s] 41%|████      | 146/358 [00:14<00:21,  9.72it/s] 41%|████      | 147/358 [00:15<00:21,  9.66it/s] 41%|████▏     | 148/358 [00:15<00:21,  9.68it/s] 42%|████▏     | 149/358 [00:15<00:21,  9.67it/s] 42%|████▏     | 150/358 [00:15<00:21,  9.63it/s] 42%|████▏     | 151/358 [00:15<00:22,  9.37it/s] 42%|████▏     | 152/358 [00:15<00:21,  9.41it/s] 43%|████▎     | 153/358 [00:15<00:21,  9.43it/s] 43%|████▎     | 154/358 [00:15<00:21,  9.53it/s] 43%|████▎     | 155/358 [00:15<00:21,  9.54it/s] 44%|████▎     | 156/358 [00:15<00:20,  9.66it/s] 44%|████▍     | 157/358 [00:16<00:20,  9.60it/s] 44%|████▍     | 158/358 [00:16<00:20,  9.69it/s] 44%|████▍     | 159/358 [00:16<00:20,  9.69it/s] 45%|████▍     | 160/358 [00:16<00:20,  9.70it/s] 45%|████▌     | 162/358 [00:16<00:19,  9.99it/s] 46%|████▌     | 164/358 [00:16<00:19,  9.98it/s] 46%|████▌     | 165/358 [00:16<00:19,  9.93it/s] 47%|████▋     | 167/358 [00:17<00:19,  9.88it/s] 47%|████▋     | 169/358 [00:17<00:19,  9.92it/s] 48%|████▊     | 171/358 [00:17<00:18,  9.91it/s] 48%|████▊     | 172/358 [00:17<00:18,  9.86it/s] 48%|████▊     | 173/358 [00:17<00:18,  9.79it/s] 49%|████▉     | 175/358 [00:17<00:18,  9.82it/s] 49%|████▉     | 176/358 [00:17<00:18,  9.83it/s] 49%|████▉     | 177/358 [00:18<00:18,  9.82it/s] 50%|████▉     | 178/358 [00:18<00:18,  9.86it/s] 50%|█████     | 179/358 [00:18<00:18,  9.83it/s] 50%|█████     | 180/358 [00:18<00:18,  9.75it/s] 51%|█████     | 182/358 [00:18<00:17,  9.93it/s] 51%|█████     | 183/358 [00:18<00:17,  9.87it/s] 51%|█████▏    | 184/358 [00:18<00:17,  9.76it/s] 52%|█████▏    | 185/358 [00:18<00:17,  9.70it/s] 52%|█████▏    | 187/358 [00:19<00:17,  9.93it/s] 53%|█████▎    | 188/358 [00:19<00:17,  9.87it/s] 53%|█████▎    | 189/358 [00:19<00:17,  9.81it/s] 53%|█████▎    | 190/358 [00:19<00:17,  9.86it/s] 53%|█████▎    | 191/358 [00:19<00:17,  9.69it/s] 54%|█████▎    | 192/358 [00:19<00:17,  9.64it/s] 54%|█████▍    | 193/358 [00:19<00:17,  9.64it/s] 54%|█████▍    | 194/358 [00:19<00:17,  9.63it/s] 54%|█████▍    | 195/358 [00:19<00:16,  9.71it/s] 55%|█████▌    | 197/358 [00:20<00:16,  9.90it/s] 55%|█████▌    | 198/358 [00:20<00:16,  9.82it/s] 56%|█████▌    | 199/358 [00:20<00:16,  9.86it/s] 56%|█████▌    | 200/358 [00:20<00:16,  9.79it/s] 56%|█████▌    | 201/358 [00:20<00:16,  9.75it/s] 57%|█████▋    | 203/358 [00:20<00:15,  9.84it/s] 57%|█████▋    | 204/358 [00:20<00:15,  9.73it/s] 57%|█████▋    | 205/358 [00:20<00:15,  9.69it/s] 58%|█████▊    | 207/358 [00:21<00:15,  9.86it/s] 58%|█████▊    | 208/358 [00:21<00:15,  9.79it/s] 59%|█████▊    | 210/358 [00:21<00:15,  9.81it/s] 59%|█████▉    | 212/358 [00:21<00:14,  9.80it/s] 60%|█████▉    | 214/358 [00:21<00:14,  9.87it/s] 60%|██████    | 215/358 [00:21<00:14,  9.81it/s] 60%|██████    | 216/358 [00:22<00:14,  9.74it/s] 61%|██████    | 217/358 [00:22<00:14,  9.78it/s] 61%|██████    | 218/358 [00:22<00:14,  9.75it/s] 61%|██████    | 219/358 [00:22<00:14,  9.75it/s] 62%|██████▏   | 221/358 [00:22<00:13,  9.89it/s] 62%|██████▏   | 222/358 [00:22<00:13,  9.79it/s] 62%|██████▏   | 223/358 [00:22<00:13,  9.73it/s] 63%|██████▎   | 224/358 [00:22<00:13,  9.67it/s] 63%|██████▎   | 225/358 [00:22<00:13,  9.76it/s] 63%|██████▎   | 226/358 [00:23<00:13,  9.70it/s] 64%|██████▎   | 228/358 [00:23<00:13,  9.75it/s] 64%|██████▍   | 229/358 [00:23<00:13,  9.72it/s] 64%|██████▍   | 230/358 [00:23<00:13,  9.67it/s] 65%|██████▍   | 232/358 [00:23<00:12,  9.72it/s] 65%|██████▌   | 234/358 [00:23<00:12, 10.01it/s] 66%|██████▌   | 236/358 [00:24<00:12,  9.97it/s] 66%|██████▋   | 238/358 [00:24<00:11, 10.02it/s] 67%|██████▋   | 240/358 [00:24<00:11,  9.98it/s] 68%|██████▊   | 242/358 [00:24<00:11,  9.96it/s] 68%|██████▊   | 243/358 [00:24<00:11,  9.90it/s] 68%|██████▊   | 244/358 [00:24<00:11,  9.83it/s] 69%|██████▊   | 246/358 [00:25<00:11,  9.86it/s] 69%|██████▉   | 247/358 [00:25<00:11,  9.78it/s] 69%|██████▉   | 248/358 [00:25<00:11,  9.74it/s] 70%|██████▉   | 250/358 [00:25<00:10,  9.83it/s] 70%|███████   | 251/358 [00:25<00:10,  9.77it/s] 70%|███████   | 252/358 [00:25<00:10,  9.71it/s] 71%|███████   | 253/358 [00:25<00:10,  9.67it/s] 71%|███████   | 254/358 [00:25<00:10,  9.64it/s] 72%|███████▏  | 256/358 [00:26<00:10,  9.82it/s] 72%|███████▏  | 257/358 [00:26<00:10,  9.82it/s] 72%|███████▏  | 258/358 [00:26<00:10,  9.70it/s] 72%|███████▏  | 259/358 [00:26<00:10,  9.66it/s] 73%|███████▎  | 260/358 [00:26<00:10,  9.70it/s] 73%|███████▎  | 262/358 [00:26<00:09,  9.88it/s] 74%|███████▎  | 264/358 [00:26<00:09,  9.90it/s] 74%|███████▍  | 266/358 [00:27<00:09,  9.89it/s] 75%|███████▍  | 267/358 [00:27<00:09,  9.83it/s] 75%|███████▌  | 269/358 [00:27<00:09,  9.89it/s] 75%|███████▌  | 270/358 [00:27<00:08,  9.81it/s] 76%|███████▌  | 271/358 [00:27<00:08,  9.74it/s] 76%|███████▌  | 272/358 [00:27<00:08,  9.72it/s] 76%|███████▋  | 273/358 [00:27<00:08,  9.62it/s] 77%|███████▋  | 274/358 [00:27<00:08,  9.61it/s] 77%|███████▋  | 275/358 [00:28<00:08,  9.66it/s] 77%|███████▋  | 276/358 [00:28<00:08,  9.67it/s] 77%|███████▋  | 277/358 [00:28<00:08,  9.64it/s] 78%|███████▊  | 278/358 [00:28<00:08,  9.62it/s] 78%|███████▊  | 280/358 [00:28<00:07,  9.81it/s] 78%|███████▊  | 281/358 [00:28<00:07,  9.82it/s] 79%|███████▉  | 282/358 [00:28<00:07,  9.76it/s] 79%|███████▉  | 283/358 [00:28<00:07,  9.69it/s] 79%|███████▉  | 284/358 [00:29<00:07,  9.66it/s] 80%|███████▉  | 285/358 [00:29<00:07,  9.72it/s] 80%|███████▉  | 286/358 [00:29<00:07,  9.68it/s] 80%|████████  | 287/358 [00:29<00:07,  9.66it/s] 80%|████████  | 288/358 [00:29<00:07,  9.62it/s] 81%|████████  | 290/358 [00:29<00:06,  9.83it/s] 81%|████████▏ | 291/358 [00:29<00:06,  9.81it/s] 82%|████████▏ | 293/358 [00:29<00:06,  9.83it/s] 82%|████████▏ | 295/358 [00:30<00:06,  9.90it/s] 83%|████████▎ | 296/358 [00:30<00:06,  9.83it/s] 83%|████████▎ | 297/358 [00:30<00:06,  9.73it/s] 84%|████████▎ | 299/358 [00:30<00:05,  9.88it/s] 84%|████████▍ | 301/358 [00:30<00:05,  9.92it/s] 84%|████████▍ | 302/358 [00:30<00:05,  9.85it/s] 85%|████████▍ | 303/358 [00:30<00:05,  9.86it/s] 85%|████████▌ | 305/358 [00:31<00:05,  9.89it/s] 85%|████████▌ | 306/358 [00:31<00:05,  9.81it/s] 86%|████████▌ | 308/358 [00:31<00:05,  9.91it/s] 86%|████████▋ | 309/358 [00:31<00:04,  9.81it/s] 87%|████████▋ | 310/358 [00:31<00:04,  9.75it/s] 87%|████████▋ | 311/358 [00:31<00:04,  9.67it/s] 87%|████████▋ | 312/358 [00:31<00:04,  9.69it/s] 87%|████████▋ | 313/358 [00:31<00:04,  9.71it/s] 88%|████████▊ | 315/358 [00:32<00:04,  9.97it/s] 88%|████████▊ | 316/358 [00:32<00:04,  9.92it/s] 89%|████████▊ | 317/358 [00:32<00:04,  9.84it/s] 89%|████████▉ | 318/358 [00:32<00:04,  9.79it/s] 89%|████████▉ | 319/358 [00:32<00:04,  9.74it/s] 89%|████████▉ | 320/358 [00:32<00:03,  9.80it/s] 90%|████████▉ | 321/358 [00:32<00:03,  9.73it/s] 90%|████████▉ | 322/358 [00:32<00:03,  9.69it/s] 90%|█████████ | 323/358 [00:32<00:03,  9.65it/s] 91%|█████████ | 324/358 [00:33<00:03,  9.62it/s] 91%|█████████ | 325/358 [00:33<00:03,  9.59it/s] 91%|█████████▏| 327/358 [00:33<00:03,  9.95it/s] 92%|█████████▏| 329/358 [00:33<00:02, 10.05it/s] 92%|█████████▏| 330/358 [00:33<00:02,  9.94it/s] 93%|█████████▎| 332/358 [00:33<00:02, 10.04it/s] 93%|█████████▎| 334/358 [00:34<00:02,  9.94it/s] 94%|█████████▎| 335/358 [00:34<00:02,  9.82it/s] 94%|█████████▍| 337/358 [00:34<00:02,  9.90it/s] 95%|█████████▍| 339/358 [00:34<00:01, 10.10it/s] 95%|█████████▌| 341/358 [00:34<00:01, 10.04it/s] 96%|█████████▌| 342/358 [00:34<00:01,  9.96it/s] 96%|█████████▌| 343/358 [00:35<00:01,  9.85it/s] 96%|█████████▌| 344/358 [00:35<00:01,  9.79it/s] 96%|█████████▋| 345/358 [00:35<00:01,  9.82it/s] 97%|█████████▋| 346/358 [00:35<00:01,  9.86it/s] 97%|█████████▋| 348/358 [00:35<00:01,  9.96it/s] 97%|█████████▋| 349/358 [00:35<00:00,  9.87it/s] 98%|█████████▊| 350/358 [00:35<00:00,  9.79it/s] 98%|█████████▊| 351/358 [00:35<00:00,  9.74it/s] 99%|█████████▊| 353/358 [00:36<00:00,  9.91it/s] 99%|█████████▉| 354/358 [00:36<00:00,  9.89it/s] 99%|█████████▉| 355/358 [00:36<00:00,  9.80it/s]100%|█████████▉| 357/358 [00:36<00:00,  9.85it/s]100%|██████████| 358/358 [00:36<00:00,  9.81it/s]
[32m2025-02-05 05:20:42.765[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    gen_loss  grad clip ratio  grad norm   ppl
       2.659                1      3.784 14.28[0m
[32m2025-02-05 05:20:42.765[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m169[0m - [1m[Valid][0m
  0%|          | 0/10256 [00:00<?, ?it/s]100%|██████████| 10256/10256 [00:00<00:00, 1024550.61it/s]
[32m2025-02-05 05:20:42.776[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:26,  1.49it/s]  5%|▌         | 2/40 [00:01<00:25,  1.49it/s]  8%|▊         | 3/40 [00:02<00:24,  1.50it/s] 10%|█         | 4/40 [00:02<00:24,  1.50it/s] 12%|█▎        | 5/40 [00:03<00:23,  1.49it/s] 15%|█▌        | 6/40 [00:04<00:22,  1.48it/s] 18%|█▊        | 7/40 [00:04<00:22,  1.48it/s] 20%|██        | 8/40 [00:05<00:21,  1.49it/s] 22%|██▎       | 9/40 [00:06<00:20,  1.49it/s] 25%|██▌       | 10/40 [00:06<00:20,  1.49it/s] 28%|██▊       | 11/40 [00:07<00:19,  1.49it/s] 30%|███       | 12/40 [00:08<00:18,  1.49it/s] 32%|███▎      | 13/40 [00:08<00:18,  1.49it/s] 35%|███▌      | 14/40 [00:09<00:17,  1.48it/s] 38%|███▊      | 15/40 [00:10<00:16,  1.48it/s] 40%|████      | 16/40 [00:10<00:16,  1.48it/s] 42%|████▎     | 17/40 [00:11<00:15,  1.48it/s] 45%|████▌     | 18/40 [00:12<00:14,  1.48it/s] 48%|████▊     | 19/40 [00:12<00:14,  1.48it/s] 50%|█████     | 20/40 [00:13<00:13,  1.48it/s] 52%|█████▎    | 21/40 [00:14<00:12,  1.49it/s] 55%|█████▌    | 22/40 [00:14<00:12,  1.48it/s] 57%|█████▊    | 23/40 [00:15<00:11,  1.48it/s] 60%|██████    | 24/40 [00:16<00:10,  1.47it/s] 62%|██████▎   | 25/40 [00:16<00:10,  1.47it/s] 65%|██████▌   | 26/40 [00:17<00:09,  1.48it/s] 68%|██████▊   | 27/40 [00:18<00:08,  1.48it/s] 70%|███████   | 28/40 [00:18<00:08,  1.48it/s] 72%|███████▎  | 29/40 [00:19<00:07,  1.48it/s] 75%|███████▌  | 30/40 [00:20<00:06,  1.49it/s] 78%|███████▊  | 31/40 [00:20<00:06,  1.49it/s] 80%|████████  | 32/40 [00:21<00:05,  1.49it/s] 82%|████████▎ | 33/40 [00:22<00:04,  1.48it/s] 85%|████████▌ | 34/40 [00:22<00:04,  1.49it/s] 88%|████████▊ | 35/40 [00:23<00:03,  1.48it/s] 90%|█████████ | 36/40 [00:24<00:02,  1.48it/s] 92%|█████████▎| 37/40 [00:24<00:02,  1.48it/s] 95%|█████████▌| 38/40 [00:25<00:01,  1.47it/s] 98%|█████████▊| 39/40 [00:26<00:00,  1.47it/s]100%|██████████| 40/40 [00:26<00:00,  1.63it/s]100%|██████████| 40/40 [00:26<00:00,  1.49it/s]
[32m2025-02-05 05:21:09.543[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    average  bleu@1  bleu@2  bleu@3  bleu@4  dist@1  dist@2  dist@3  dist@4  extreme  \
      .7533   .2790  .09697  .04416  .02471  .03985   .2805   .5922   .7927    .5604   
      f1  gen_loss  greedy  intra_dist@1  intra_dist@2  intra_dist@3  intra_dist@4  \
   .3419     4.133   .6575         .9165         .9859         .9446         .8764   
     ppl  rouge1  rouge2  rougeL  
   62.34   .3789  .08565   .3651[0m
[32m2025-02-05 05:21:09.548[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m163[0m - [1m[Conversation epoch 12][0m
[32m2025-02-05 05:21:09.548[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m164[0m - [1m[Train][0m
  0%|          | 0/92414 [00:00<?, ?it/s]100%|██████████| 92414/92414 [00:00<00:00, 1120454.90it/s]
[32m2025-02-05 05:21:09.631[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/358 [00:00<?, ?it/s]  0%|          | 1/358 [00:00<00:36,  9.75it/s]  1%|          | 3/358 [00:00<00:35,  9.92it/s]  1%|          | 4/358 [00:00<00:35,  9.90it/s]  2%|▏         | 6/358 [00:00<00:35,  9.87it/s]  2%|▏         | 7/358 [00:00<00:35,  9.80it/s]  2%|▏         | 8/358 [00:00<00:35,  9.77it/s]  3%|▎         | 9/358 [00:00<00:36,  9.68it/s]  3%|▎         | 10/358 [00:01<00:35,  9.68it/s]  3%|▎         | 11/358 [00:01<00:35,  9.65it/s]  4%|▎         | 13/358 [00:01<00:34,  9.88it/s]  4%|▍         | 14/358 [00:01<00:35,  9.81it/s]  4%|▍         | 15/358 [00:01<00:35,  9.74it/s]  4%|▍         | 16/358 [00:01<00:35,  9.68it/s]  5%|▍         | 17/358 [00:01<00:35,  9.70it/s]  5%|▌         | 18/358 [00:01<00:34,  9.77it/s]  5%|▌         | 19/358 [00:01<00:34,  9.70it/s]  6%|▌         | 20/358 [00:02<00:35,  9.65it/s]  6%|▌         | 21/358 [00:02<00:35,  9.59it/s]  6%|▌         | 22/358 [00:02<00:34,  9.65it/s]  7%|▋         | 24/358 [00:02<00:34,  9.75it/s]  7%|▋         | 25/358 [00:02<00:34,  9.70it/s]  7%|▋         | 26/358 [00:02<00:34,  9.65it/s]  8%|▊         | 27/358 [00:02<00:34,  9.71it/s]  8%|▊         | 28/358 [00:02<00:34,  9.66it/s]  8%|▊         | 29/358 [00:02<00:34,  9.62it/s]  9%|▊         | 31/358 [00:03<00:33,  9.73it/s]  9%|▉         | 32/358 [00:03<00:33,  9.73it/s]  9%|▉         | 34/358 [00:03<00:32,  9.83it/s] 10%|█         | 36/358 [00:03<00:32,  9.83it/s] 10%|█         | 37/358 [00:03<00:32,  9.81it/s] 11%|█         | 38/358 [00:03<00:32,  9.77it/s] 11%|█         | 40/358 [00:04<00:32,  9.93it/s] 11%|█▏        | 41/358 [00:04<00:32,  9.84it/s] 12%|█▏        | 43/358 [00:04<00:31,  9.86it/s] 13%|█▎        | 45/358 [00:04<00:31,  9.96it/s] 13%|█▎        | 46/358 [00:04<00:31,  9.97it/s] 13%|█▎        | 47/358 [00:04<00:31,  9.92it/s] 13%|█▎        | 48/358 [00:04<00:31,  9.91it/s] 14%|█▍        | 50/358 [00:05<00:31,  9.88it/s] 14%|█▍        | 51/358 [00:05<00:31,  9.80it/s] 15%|█▍        | 52/358 [00:05<00:31,  9.71it/s] 15%|█▍        | 53/358 [00:05<00:31,  9.66it/s] 15%|█▌        | 54/358 [00:05<00:31,  9.71it/s] 15%|█▌        | 55/358 [00:05<00:31,  9.66it/s] 16%|█▌        | 56/358 [00:05<00:31,  9.70it/s] 16%|█▌        | 57/358 [00:05<00:31,  9.67it/s] 16%|█▌        | 58/358 [00:05<00:31,  9.65it/s] 16%|█▋        | 59/358 [00:06<00:31,  9.61it/s] 17%|█▋        | 61/358 [00:06<00:30,  9.70it/s] 17%|█▋        | 62/358 [00:06<00:30,  9.62it/s] 18%|█▊        | 63/358 [00:06<00:30,  9.69it/s] 18%|█▊        | 64/358 [00:06<00:30,  9.65it/s] 18%|█▊        | 66/358 [00:06<00:30,  9.72it/s] 19%|█▊        | 67/358 [00:06<00:29,  9.70it/s] 19%|█▉        | 69/358 [00:07<00:29,  9.76it/s] 20%|█▉        | 70/358 [00:07<00:29,  9.71it/s] 20%|█▉        | 71/358 [00:07<00:29,  9.75it/s] 20%|██        | 72/358 [00:07<00:29,  9.70it/s] 20%|██        | 73/358 [00:07<00:29,  9.67it/s] 21%|██        | 74/358 [00:07<00:29,  9.64it/s] 21%|██        | 75/358 [00:07<00:29,  9.61it/s] 21%|██        | 76/358 [00:07<00:29,  9.69it/s] 22%|██▏       | 77/358 [00:07<00:29,  9.65it/s] 22%|██▏       | 79/358 [00:08<00:28,  9.67it/s] 23%|██▎       | 81/358 [00:08<00:28,  9.73it/s] 23%|██▎       | 83/358 [00:08<00:28,  9.76it/s] 23%|██▎       | 84/358 [00:08<00:28,  9.71it/s] 24%|██▎       | 85/358 [00:08<00:28,  9.66it/s] 24%|██▍       | 86/358 [00:08<00:28,  9.65it/s] 24%|██▍       | 87/358 [00:08<00:28,  9.63it/s] 25%|██▍       | 88/358 [00:09<00:27,  9.65it/s] 25%|██▌       | 90/358 [00:09<00:27,  9.89it/s] 26%|██▌       | 92/358 [00:09<00:26,  9.99it/s] 26%|██▌       | 93/358 [00:09<00:26,  9.95it/s] 26%|██▋       | 94/358 [00:09<00:26,  9.86it/s] 27%|██▋       | 96/358 [00:09<00:25, 10.14it/s] 27%|██▋       | 98/358 [00:10<00:25, 10.03it/s] 28%|██▊       | 99/358 [00:10<00:26,  9.94it/s] 28%|██▊       | 101/358 [00:10<00:25,  9.90it/s] 29%|██▉       | 103/358 [00:10<00:25,  9.89it/s] 29%|██▉       | 104/358 [00:10<00:25,  9.84it/s] 29%|██▉       | 105/358 [00:10<00:25,  9.76it/s] 30%|██▉       | 106/358 [00:10<00:25,  9.75it/s] 30%|███       | 108/358 [00:11<00:25,  9.78it/s] 30%|███       | 109/358 [00:11<00:25,  9.69it/s] 31%|███       | 110/358 [00:11<00:25,  9.68it/s] 31%|███       | 111/358 [00:11<00:25,  9.63it/s] 32%|███▏      | 113/358 [00:11<00:24,  9.89it/s] 32%|███▏      | 114/358 [00:11<00:24,  9.85it/s] 32%|███▏      | 115/358 [00:11<00:24,  9.76it/s] 32%|███▏      | 116/358 [00:11<00:25,  9.68it/s] 33%|███▎      | 117/358 [00:11<00:24,  9.65it/s] 33%|███▎      | 119/358 [00:12<00:24,  9.77it/s] 34%|███▍      | 121/358 [00:12<00:23,  9.96it/s] 34%|███▍      | 123/358 [00:12<00:23, 10.07it/s] 35%|███▍      | 125/358 [00:12<00:23, 10.04it/s] 35%|███▌      | 126/358 [00:12<00:23, 10.00it/s] 35%|███▌      | 127/358 [00:12<00:23,  9.95it/s] 36%|███▌      | 128/358 [00:13<00:23,  9.90it/s] 36%|███▋      | 130/358 [00:13<00:22,  9.97it/s] 37%|███▋      | 131/358 [00:13<00:22,  9.87it/s] 37%|███▋      | 132/358 [00:13<00:22,  9.89it/s] 37%|███▋      | 134/358 [00:13<00:22,  9.92it/s] 38%|███▊      | 135/358 [00:13<00:22,  9.86it/s] 38%|███▊      | 137/358 [00:13<00:22,  9.95it/s] 39%|███▊      | 138/358 [00:14<00:22,  9.93it/s] 39%|███▉      | 139/358 [00:14<00:22,  9.84it/s] 39%|███▉      | 141/358 [00:14<00:21,  9.96it/s] 40%|███▉      | 142/358 [00:14<00:21,  9.89it/s] 40%|███▉      | 143/358 [00:14<00:21,  9.85it/s] 40%|████      | 144/358 [00:14<00:21,  9.77it/s] 41%|████      | 145/358 [00:14<00:21,  9.79it/s] 41%|████      | 146/358 [00:14<00:21,  9.73it/s] 41%|████      | 147/358 [00:15<00:21,  9.67it/s] 41%|████▏     | 148/358 [00:15<00:21,  9.69it/s] 42%|████▏     | 149/358 [00:15<00:21,  9.68it/s] 42%|████▏     | 150/358 [00:15<00:21,  9.64it/s] 42%|████▏     | 151/358 [00:15<00:22,  9.38it/s] 42%|████▏     | 152/358 [00:15<00:21,  9.42it/s] 43%|████▎     | 153/358 [00:15<00:21,  9.44it/s] 43%|████▎     | 154/358 [00:15<00:21,  9.52it/s] 43%|████▎     | 155/358 [00:15<00:21,  9.53it/s] 44%|████▎     | 156/358 [00:15<00:20,  9.66it/s] 44%|████▍     | 157/358 [00:16<00:20,  9.60it/s] 44%|████▍     | 158/358 [00:16<00:20,  9.69it/s] 44%|████▍     | 159/358 [00:16<00:20,  9.68it/s] 45%|████▍     | 160/358 [00:16<00:20,  9.69it/s] 45%|████▌     | 162/358 [00:16<00:19,  9.99it/s] 46%|████▌     | 164/358 [00:16<00:19,  9.99it/s] 46%|████▌     | 165/358 [00:16<00:19,  9.95it/s] 47%|████▋     | 167/358 [00:17<00:19,  9.89it/s] 47%|████▋     | 169/358 [00:17<00:19,  9.93it/s] 48%|████▊     | 171/358 [00:17<00:18,  9.91it/s] 48%|████▊     | 172/358 [00:17<00:18,  9.86it/s] 48%|████▊     | 173/358 [00:17<00:18,  9.80it/s] 49%|████▉     | 175/358 [00:17<00:18,  9.82it/s] 49%|████▉     | 176/358 [00:17<00:18,  9.84it/s] 49%|████▉     | 177/358 [00:18<00:18,  9.82it/s] 50%|█████     | 179/358 [00:18<00:18,  9.84it/s] 50%|█████     | 180/358 [00:18<00:18,  9.77it/s] 51%|█████     | 182/358 [00:18<00:17,  9.92it/s] 51%|█████     | 183/358 [00:18<00:17,  9.88it/s] 51%|█████▏    | 184/358 [00:18<00:17,  9.77it/s] 52%|█████▏    | 185/358 [00:18<00:17,  9.71it/s] 52%|█████▏    | 187/358 [00:19<00:17,  9.93it/s] 53%|█████▎    | 188/358 [00:19<00:17,  9.87it/s] 53%|█████▎    | 189/358 [00:19<00:17,  9.82it/s] 53%|█████▎    | 190/358 [00:19<00:17,  9.86it/s] 53%|█████▎    | 191/358 [00:19<00:17,  9.69it/s] 54%|█████▎    | 192/358 [00:19<00:17,  9.64it/s] 54%|█████▍    | 193/358 [00:19<00:17,  9.65it/s] 54%|█████▍    | 194/358 [00:19<00:17,  9.63it/s] 54%|█████▍    | 195/358 [00:19<00:16,  9.71it/s] 55%|█████▌    | 197/358 [00:20<00:16,  9.90it/s] 55%|█████▌    | 198/358 [00:20<00:16,  9.82it/s] 56%|█████▌    | 199/358 [00:20<00:16,  9.86it/s] 56%|█████▌    | 200/358 [00:20<00:16,  9.79it/s] 56%|█████▌    | 201/358 [00:20<00:16,  9.75it/s] 57%|█████▋    | 203/358 [00:20<00:15,  9.84it/s] 57%|█████▋    | 204/358 [00:20<00:15,  9.73it/s] 57%|█████▋    | 205/358 [00:20<00:15,  9.69it/s] 58%|█████▊    | 207/358 [00:21<00:15,  9.86it/s] 58%|█████▊    | 208/358 [00:21<00:15,  9.79it/s] 59%|█████▊    | 210/358 [00:21<00:15,  9.81it/s] 59%|█████▉    | 212/358 [00:21<00:14,  9.80it/s] 60%|█████▉    | 214/358 [00:21<00:14,  9.88it/s] 60%|██████    | 215/358 [00:21<00:14,  9.81it/s] 60%|██████    | 216/358 [00:22<00:14,  9.75it/s] 61%|██████    | 217/358 [00:22<00:14,  9.78it/s] 61%|██████    | 218/358 [00:22<00:14,  9.75it/s] 61%|██████    | 219/358 [00:22<00:14,  9.76it/s] 62%|██████▏   | 221/358 [00:22<00:13,  9.89it/s] 62%|██████▏   | 222/358 [00:22<00:13,  9.79it/s] 62%|██████▏   | 223/358 [00:22<00:13,  9.73it/s] 63%|██████▎   | 224/358 [00:22<00:13,  9.67it/s] 63%|██████▎   | 225/358 [00:22<00:13,  9.76it/s] 63%|██████▎   | 226/358 [00:23<00:13,  9.71it/s] 64%|██████▎   | 228/358 [00:23<00:13,  9.74it/s] 64%|██████▍   | 229/358 [00:23<00:13,  9.72it/s] 64%|██████▍   | 230/358 [00:23<00:13,  9.67it/s] 65%|██████▍   | 232/358 [00:23<00:12,  9.72it/s] 65%|██████▌   | 234/358 [00:23<00:12, 10.01it/s] 66%|██████▌   | 236/358 [00:24<00:12,  9.97it/s] 66%|██████▋   | 238/358 [00:24<00:11, 10.02it/s] 67%|██████▋   | 240/358 [00:24<00:11,  9.98it/s] 68%|██████▊   | 242/358 [00:24<00:11,  9.96it/s] 68%|██████▊   | 243/358 [00:24<00:11,  9.90it/s] 68%|██████▊   | 244/358 [00:24<00:11,  9.83it/s] 69%|██████▊   | 246/358 [00:25<00:11,  9.85it/s] 69%|██████▉   | 247/358 [00:25<00:11,  9.78it/s] 69%|██████▉   | 248/358 [00:25<00:11,  9.74it/s] 70%|██████▉   | 250/358 [00:25<00:10,  9.84it/s] 70%|███████   | 251/358 [00:25<00:10,  9.77it/s] 70%|███████   | 252/358 [00:25<00:10,  9.71it/s] 71%|███████   | 253/358 [00:25<00:10,  9.67it/s] 71%|███████   | 254/358 [00:25<00:10,  9.64it/s] 72%|███████▏  | 256/358 [00:26<00:10,  9.82it/s] 72%|███████▏  | 257/358 [00:26<00:10,  9.82it/s] 72%|███████▏  | 258/358 [00:26<00:10,  9.70it/s] 72%|███████▏  | 259/358 [00:26<00:10,  9.67it/s] 73%|███████▎  | 260/358 [00:26<00:10,  9.71it/s] 73%|███████▎  | 262/358 [00:26<00:09,  9.87it/s] 74%|███████▎  | 264/358 [00:26<00:09,  9.89it/s] 74%|███████▍  | 266/358 [00:27<00:09,  9.89it/s] 75%|███████▍  | 267/358 [00:27<00:09,  9.83it/s] 75%|███████▌  | 269/358 [00:27<00:09,  9.89it/s] 75%|███████▌  | 270/358 [00:27<00:08,  9.81it/s] 76%|███████▌  | 271/358 [00:27<00:08,  9.74it/s] 76%|███████▌  | 272/358 [00:27<00:08,  9.72it/s] 76%|███████▋  | 273/358 [00:27<00:08,  9.62it/s] 77%|███████▋  | 274/358 [00:27<00:08,  9.62it/s] 77%|███████▋  | 275/358 [00:28<00:08,  9.67it/s] 77%|███████▋  | 276/358 [00:28<00:08,  9.67it/s] 77%|███████▋  | 277/358 [00:28<00:08,  9.64it/s] 78%|███████▊  | 278/358 [00:28<00:08,  9.61it/s] 78%|███████▊  | 280/358 [00:28<00:07,  9.81it/s] 78%|███████▊  | 281/358 [00:28<00:07,  9.82it/s] 79%|███████▉  | 282/358 [00:28<00:07,  9.76it/s] 79%|███████▉  | 283/358 [00:28<00:07,  9.69it/s] 79%|███████▉  | 284/358 [00:29<00:07,  9.66it/s] 80%|███████▉  | 285/358 [00:29<00:07,  9.73it/s] 80%|███████▉  | 286/358 [00:29<00:07,  9.68it/s] 80%|████████  | 287/358 [00:29<00:07,  9.66it/s] 80%|████████  | 288/358 [00:29<00:07,  9.62it/s] 81%|████████  | 290/358 [00:29<00:06,  9.83it/s] 81%|████████▏ | 291/358 [00:29<00:06,  9.81it/s] 82%|████████▏ | 293/358 [00:29<00:06,  9.82it/s] 82%|████████▏ | 295/358 [00:30<00:06,  9.89it/s] 83%|████████▎ | 296/358 [00:30<00:06,  9.83it/s] 83%|████████▎ | 297/358 [00:30<00:06,  9.72it/s] 84%|████████▎ | 299/358 [00:30<00:05,  9.88it/s] 84%|████████▍ | 301/358 [00:30<00:05,  9.92it/s] 84%|████████▍ | 302/358 [00:30<00:05,  9.85it/s] 85%|████████▍ | 303/358 [00:30<00:05,  9.86it/s] 85%|████████▌ | 305/358 [00:31<00:05,  9.89it/s] 85%|████████▌ | 306/358 [00:31<00:05,  9.81it/s] 86%|████████▌ | 308/358 [00:31<00:05,  9.91it/s] 86%|████████▋ | 309/358 [00:31<00:04,  9.81it/s] 87%|████████▋ | 310/358 [00:31<00:04,  9.75it/s] 87%|████████▋ | 311/358 [00:31<00:04,  9.68it/s] 87%|████████▋ | 312/358 [00:31<00:04,  9.70it/s] 87%|████████▋ | 313/358 [00:31<00:04,  9.72it/s] 88%|████████▊ | 315/358 [00:32<00:04,  9.97it/s] 88%|████████▊ | 316/358 [00:32<00:04,  9.92it/s] 89%|████████▊ | 317/358 [00:32<00:04,  9.84it/s] 89%|████████▉ | 318/358 [00:32<00:04,  9.79it/s] 89%|████████▉ | 319/358 [00:32<00:04,  9.74it/s] 89%|████████▉ | 320/358 [00:32<00:03,  9.80it/s] 90%|████████▉ | 321/358 [00:32<00:03,  9.73it/s] 90%|████████▉ | 322/358 [00:32<00:03,  9.69it/s] 90%|█████████ | 323/358 [00:32<00:03,  9.64it/s] 91%|█████████ | 324/358 [00:33<00:03,  9.61it/s] 91%|█████████ | 325/358 [00:33<00:03,  9.59it/s] 91%|█████████▏| 327/358 [00:33<00:03,  9.95it/s] 92%|█████████▏| 329/358 [00:33<00:02, 10.05it/s] 92%|█████████▏| 330/358 [00:33<00:02,  9.94it/s] 93%|█████████▎| 332/358 [00:33<00:02, 10.04it/s] 93%|█████████▎| 334/358 [00:34<00:02,  9.94it/s] 94%|█████████▎| 335/358 [00:34<00:02,  9.82it/s] 94%|█████████▍| 337/358 [00:34<00:02,  9.90it/s] 95%|█████████▍| 339/358 [00:34<00:01, 10.10it/s] 95%|█████████▌| 341/358 [00:34<00:01, 10.05it/s] 96%|█████████▌| 343/358 [00:35<00:01,  9.89it/s] 96%|█████████▌| 344/358 [00:35<00:01,  9.83it/s] 96%|█████████▋| 345/358 [00:35<00:01,  9.85it/s] 97%|█████████▋| 346/358 [00:35<00:01,  9.88it/s] 97%|█████████▋| 348/358 [00:35<00:01,  9.97it/s] 97%|█████████▋| 349/358 [00:35<00:00,  9.88it/s] 98%|█████████▊| 350/358 [00:35<00:00,  9.80it/s] 98%|█████████▊| 351/358 [00:35<00:00,  9.75it/s] 99%|█████████▊| 353/358 [00:36<00:00,  9.92it/s] 99%|█████████▉| 354/358 [00:36<00:00,  9.90it/s] 99%|█████████▉| 355/358 [00:36<00:00,  9.81it/s]100%|█████████▉| 357/358 [00:36<00:00,  9.86it/s]100%|██████████| 358/358 [00:36<00:00,  9.81it/s]
[32m2025-02-05 05:21:46.134[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    gen_loss  grad clip ratio  grad norm   ppl
       2.609                1      3.776 13.59[0m
[32m2025-02-05 05:21:46.134[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m169[0m - [1m[Valid][0m
  0%|          | 0/10256 [00:00<?, ?it/s]100%|██████████| 10256/10256 [00:00<00:00, 1027241.90it/s]
[32m2025-02-05 05:21:46.144[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:26,  1.47it/s]  5%|▌         | 2/40 [00:01<00:25,  1.48it/s]  8%|▊         | 3/40 [00:02<00:24,  1.48it/s] 10%|█         | 4/40 [00:02<00:24,  1.48it/s] 12%|█▎        | 5/40 [00:03<00:23,  1.47it/s] 15%|█▌        | 6/40 [00:04<00:23,  1.48it/s] 18%|█▊        | 7/40 [00:04<00:22,  1.47it/s] 20%|██        | 8/40 [00:05<00:21,  1.48it/s] 22%|██▎       | 9/40 [00:06<00:21,  1.47it/s] 25%|██▌       | 10/40 [00:06<00:20,  1.48it/s] 28%|██▊       | 11/40 [00:07<00:19,  1.48it/s] 30%|███       | 12/40 [00:08<00:18,  1.48it/s] 32%|███▎      | 13/40 [00:08<00:18,  1.48it/s] 35%|███▌      | 14/40 [00:09<00:17,  1.47it/s] 38%|███▊      | 15/40 [00:10<00:16,  1.47it/s] 40%|████      | 16/40 [00:10<00:16,  1.47it/s] 42%|████▎     | 17/40 [00:11<00:15,  1.48it/s] 45%|████▌     | 18/40 [00:12<00:14,  1.48it/s] 48%|████▊     | 19/40 [00:12<00:14,  1.47it/s] 50%|█████     | 20/40 [00:13<00:13,  1.48it/s] 52%|█████▎    | 21/40 [00:14<00:12,  1.48it/s] 55%|█████▌    | 22/40 [00:14<00:12,  1.47it/s] 57%|█████▊    | 23/40 [00:15<00:11,  1.47it/s] 60%|██████    | 24/40 [00:16<00:10,  1.47it/s] 62%|██████▎   | 25/40 [00:16<00:10,  1.47it/s] 65%|██████▌   | 26/40 [00:17<00:09,  1.48it/s] 68%|██████▊   | 27/40 [00:18<00:08,  1.48it/s] 70%|███████   | 28/40 [00:18<00:08,  1.48it/s] 72%|███████▎  | 29/40 [00:19<00:07,  1.48it/s] 75%|███████▌  | 30/40 [00:20<00:06,  1.49it/s] 78%|███████▊  | 31/40 [00:20<00:06,  1.48it/s] 80%|████████  | 32/40 [00:21<00:05,  1.49it/s] 82%|████████▎ | 33/40 [00:22<00:04,  1.48it/s] 85%|████████▌ | 34/40 [00:23<00:04,  1.48it/s] 88%|████████▊ | 35/40 [00:23<00:03,  1.48it/s] 90%|█████████ | 36/40 [00:24<00:02,  1.47it/s] 92%|█████████▎| 37/40 [00:25<00:02,  1.48it/s] 95%|█████████▌| 38/40 [00:25<00:01,  1.46it/s] 98%|█████████▊| 39/40 [00:26<00:00,  1.46it/s]100%|██████████| 40/40 [00:26<00:00,  1.62it/s]100%|██████████| 40/40 [00:26<00:00,  1.49it/s]
[32m2025-02-05 05:22:13.055[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    average  bleu@1  bleu@2  bleu@3  bleu@4  dist@1  dist@2  dist@3  dist@4  extreme  \
      .7679   .2864   .1040  .04236  .02281   .0359   .2527   .5650   .7742    .5786   
      f1  gen_loss  greedy  intra_dist@1  intra_dist@2  intra_dist@3  intra_dist@4  \
   .3520     4.067   .6669         .8992         .9824         .9554         .9006   
    ppl  rouge1  rouge2  rougeL  
   58.4   .3852  .08918   .3706[0m
[32m2025-02-05 05:22:13.061[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m163[0m - [1m[Conversation epoch 13][0m
[32m2025-02-05 05:22:13.061[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m164[0m - [1m[Train][0m
  0%|          | 0/92414 [00:00<?, ?it/s]100%|██████████| 92414/92414 [00:00<00:00, 993126.76it/s]
[32m2025-02-05 05:22:13.154[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/358 [00:00<?, ?it/s]  0%|          | 1/358 [00:00<00:36,  9.75it/s]  1%|          | 3/358 [00:00<00:35,  9.92it/s]  1%|          | 4/358 [00:00<00:35,  9.88it/s]  2%|▏         | 6/358 [00:00<00:35,  9.84it/s]  2%|▏         | 7/358 [00:00<00:35,  9.79it/s]  2%|▏         | 8/358 [00:00<00:35,  9.83it/s]  3%|▎         | 9/358 [00:00<00:35,  9.74it/s]  3%|▎         | 10/358 [00:01<00:35,  9.73it/s]  3%|▎         | 11/358 [00:01<00:35,  9.68it/s]  4%|▎         | 13/358 [00:01<00:34,  9.90it/s]  4%|▍         | 14/358 [00:01<00:34,  9.83it/s]  4%|▍         | 15/358 [00:01<00:35,  9.75it/s]  4%|▍         | 16/358 [00:01<00:35,  9.69it/s]  5%|▍         | 17/358 [00:01<00:35,  9.71it/s]  5%|▌         | 18/358 [00:01<00:34,  9.78it/s]  5%|▌         | 19/358 [00:01<00:34,  9.72it/s]  6%|▌         | 20/358 [00:02<00:34,  9.66it/s]  6%|▌         | 21/358 [00:02<00:35,  9.58it/s]  6%|▌         | 22/358 [00:02<00:34,  9.65it/s]  7%|▋         | 24/358 [00:02<00:34,  9.75it/s]  7%|▋         | 25/358 [00:02<00:34,  9.70it/s]  7%|▋         | 26/358 [00:02<00:34,  9.65it/s]  8%|▊         | 27/358 [00:02<00:34,  9.71it/s]  8%|▊         | 28/358 [00:02<00:34,  9.66it/s]  8%|▊         | 29/358 [00:02<00:34,  9.62it/s]  9%|▊         | 31/358 [00:03<00:33,  9.72it/s]  9%|▉         | 32/358 [00:03<00:33,  9.72it/s]  9%|▉         | 34/358 [00:03<00:32,  9.83it/s] 10%|█         | 36/358 [00:03<00:32,  9.83it/s] 10%|█         | 37/358 [00:03<00:32,  9.81it/s] 11%|█         | 38/358 [00:03<00:32,  9.77it/s] 11%|█         | 40/358 [00:04<00:32,  9.93it/s] 11%|█▏        | 41/358 [00:04<00:32,  9.84it/s] 12%|█▏        | 43/358 [00:04<00:31,  9.87it/s] 13%|█▎        | 45/358 [00:04<00:31,  9.97it/s] 13%|█▎        | 47/358 [00:04<00:31,  9.94it/s] 13%|█▎        | 48/358 [00:04<00:31,  9.93it/s] 14%|█▍        | 50/358 [00:05<00:31,  9.90it/s] 14%|█▍        | 51/358 [00:05<00:31,  9.83it/s] 15%|█▍        | 52/358 [00:05<00:31,  9.74it/s] 15%|█▍        | 53/358 [00:05<00:31,  9.69it/s] 15%|█▌        | 54/358 [00:05<00:31,  9.73it/s] 15%|█▌        | 55/358 [00:05<00:31,  9.68it/s] 16%|█▌        | 56/358 [00:05<00:31,  9.72it/s] 16%|█▌        | 57/358 [00:05<00:31,  9.68it/s] 16%|█▌        | 58/358 [00:05<00:31,  9.65it/s] 16%|█▋        | 59/358 [00:06<00:31,  9.62it/s] 17%|█▋        | 61/358 [00:06<00:30,  9.71it/s] 17%|█▋        | 62/358 [00:06<00:30,  9.63it/s] 18%|█▊        | 63/358 [00:06<00:30,  9.70it/s] 18%|█▊        | 64/358 [00:06<00:30,  9.65it/s] 18%|█▊        | 66/358 [00:06<00:30,  9.72it/s] 19%|█▊        | 67/358 [00:06<00:29,  9.70it/s] 19%|█▉        | 69/358 [00:07<00:29,  9.77it/s] 20%|█▉        | 70/358 [00:07<00:29,  9.72it/s] 20%|█▉        | 71/358 [00:07<00:29,  9.76it/s] 20%|██        | 72/358 [00:07<00:29,  9.71it/s] 20%|██        | 73/358 [00:07<00:29,  9.68it/s] 21%|██        | 74/358 [00:07<00:29,  9.64it/s] 21%|██        | 75/358 [00:07<00:29,  9.61it/s] 21%|██        | 76/358 [00:07<00:29,  9.71it/s] 22%|██▏       | 77/358 [00:07<00:29,  9.68it/s] 22%|██▏       | 79/358 [00:08<00:28,  9.68it/s] 23%|██▎       | 81/358 [00:08<00:28,  9.74it/s] 23%|██▎       | 83/358 [00:08<00:28,  9.77it/s] 23%|██▎       | 84/358 [00:08<00:28,  9.72it/s] 24%|██▎       | 85/358 [00:08<00:28,  9.67it/s] 24%|██▍       | 86/358 [00:08<00:28,  9.66it/s] 24%|██▍       | 87/358 [00:08<00:28,  9.64it/s] 25%|██▍       | 88/358 [00:09<00:27,  9.66it/s] 25%|██▌       | 90/358 [00:09<00:27,  9.90it/s] 26%|██▌       | 92/358 [00:09<00:26, 10.00it/s] 26%|██▌       | 93/358 [00:09<00:26,  9.96it/s] 26%|██▋       | 94/358 [00:09<00:26,  9.87it/s] 27%|██▋       | 96/358 [00:09<00:25, 10.15it/s] 27%|██▋       | 98/358 [00:10<00:25, 10.04it/s] 28%|██▊       | 99/358 [00:10<00:26,  9.95it/s] 28%|██▊       | 101/358 [00:10<00:25,  9.92it/s] 29%|██▉       | 103/358 [00:10<00:25,  9.90it/s] 29%|██▉       | 104/358 [00:10<00:25,  9.86it/s] 29%|██▉       | 105/358 [00:10<00:25,  9.78it/s] 30%|██▉       | 106/358 [00:10<00:25,  9.76it/s] 30%|███       | 108/358 [00:11<00:25,  9.79it/s] 30%|███       | 109/358 [00:11<00:25,  9.70it/s] 31%|███       | 110/358 [00:11<00:25,  9.69it/s] 31%|███       | 111/358 [00:11<00:25,  9.64it/s] 32%|███▏      | 113/358 [00:11<00:24,  9.90it/s] 32%|███▏      | 114/358 [00:11<00:24,  9.86it/s] 32%|███▏      | 115/358 [00:11<00:24,  9.77it/s] 32%|███▏      | 116/358 [00:11<00:24,  9.68it/s] 33%|███▎      | 117/358 [00:11<00:24,  9.65it/s] 33%|███▎      | 119/358 [00:12<00:24,  9.77it/s] 34%|███▍      | 121/358 [00:12<00:23,  9.97it/s] 34%|███▍      | 123/358 [00:12<00:23, 10.07it/s] 35%|███▍      | 125/358 [00:12<00:23, 10.05it/s] 35%|███▌      | 126/358 [00:12<00:23, 10.01it/s] 35%|███▌      | 127/358 [00:12<00:23,  9.96it/s] 36%|███▌      | 128/358 [00:13<00:23,  9.91it/s] 36%|███▋      | 130/358 [00:13<00:22,  9.98it/s] 37%|███▋      | 131/358 [00:13<00:22,  9.88it/s] 37%|███▋      | 132/358 [00:13<00:22,  9.90it/s] 37%|███▋      | 134/358 [00:13<00:22,  9.92it/s] 38%|███▊      | 135/358 [00:13<00:22,  9.86it/s] 38%|███▊      | 137/358 [00:13<00:22,  9.95it/s] 39%|███▊      | 138/358 [00:14<00:22,  9.93it/s] 39%|███▉      | 139/358 [00:14<00:22,  9.85it/s] 39%|███▉      | 141/358 [00:14<00:21,  9.98it/s] 40%|███▉      | 142/358 [00:14<00:21,  9.90it/s] 40%|███▉      | 143/358 [00:14<00:21,  9.86it/s] 40%|████      | 144/358 [00:14<00:21,  9.77it/s] 41%|████      | 145/358 [00:14<00:21,  9.79it/s] 41%|████      | 146/358 [00:14<00:21,  9.73it/s] 41%|████      | 147/358 [00:15<00:21,  9.67it/s] 41%|████▏     | 148/358 [00:15<00:21,  9.70it/s] 42%|████▏     | 149/358 [00:15<00:21,  9.68it/s] 42%|████▏     | 150/358 [00:15<00:21,  9.64it/s] 42%|████▏     | 151/358 [00:15<00:22,  9.38it/s] 42%|████▏     | 152/358 [00:15<00:21,  9.43it/s] 43%|████▎     | 153/358 [00:15<00:21,  9.44it/s] 43%|████▎     | 154/358 [00:15<00:21,  9.54it/s] 43%|████▎     | 155/358 [00:15<00:21,  9.55it/s] 44%|████▎     | 156/358 [00:15<00:20,  9.67it/s] 44%|████▍     | 157/358 [00:16<00:20,  9.61it/s] 44%|████▍     | 158/358 [00:16<00:20,  9.70it/s] 44%|████▍     | 159/358 [00:16<00:20,  9.69it/s] 45%|████▍     | 160/358 [00:16<00:20,  9.70it/s] 45%|████▌     | 162/358 [00:16<00:19,  9.99it/s] 46%|████▌     | 164/358 [00:16<00:19,  9.99it/s] 46%|████▌     | 165/358 [00:16<00:19,  9.94it/s] 47%|████▋     | 167/358 [00:17<00:19,  9.89it/s] 47%|████▋     | 169/358 [00:17<00:19,  9.93it/s] 48%|████▊     | 171/358 [00:17<00:18,  9.92it/s] 48%|████▊     | 172/358 [00:17<00:18,  9.87it/s] 48%|████▊     | 173/358 [00:17<00:18,  9.80it/s] 49%|████▉     | 175/358 [00:17<00:18,  9.83it/s] 49%|████▉     | 176/358 [00:17<00:18,  9.84it/s] 49%|████▉     | 177/358 [00:18<00:18,  9.83it/s] 50%|█████     | 179/358 [00:18<00:18,  9.85it/s] 50%|█████     | 180/358 [00:18<00:18,  9.78it/s] 51%|█████     | 182/358 [00:18<00:17,  9.93it/s] 51%|█████     | 183/358 [00:18<00:17,  9.88it/s] 51%|█████▏    | 184/358 [00:18<00:17,  9.77it/s] 52%|█████▏    | 185/358 [00:18<00:17,  9.72it/s] 52%|█████▏    | 187/358 [00:19<00:17,  9.93it/s] 53%|█████▎    | 188/358 [00:19<00:17,  9.88it/s] 53%|█████▎    | 189/358 [00:19<00:17,  9.82it/s] 53%|█████▎    | 191/358 [00:19<00:17,  9.74it/s] 54%|█████▎    | 192/358 [00:19<00:17,  9.69it/s] 54%|█████▍    | 193/358 [00:19<00:17,  9.68it/s] 54%|█████▍    | 194/358 [00:19<00:16,  9.66it/s] 54%|█████▍    | 195/358 [00:19<00:16,  9.73it/s] 55%|█████▌    | 197/358 [00:20<00:16,  9.90it/s] 55%|█████▌    | 198/358 [00:20<00:16,  9.83it/s] 56%|█████▌    | 199/358 [00:20<00:16,  9.86it/s] 56%|█████▌    | 200/358 [00:20<00:16,  9.80it/s] 56%|█████▌    | 201/358 [00:20<00:16,  9.75it/s] 57%|█████▋    | 203/358 [00:20<00:15,  9.84it/s] 57%|█████▋    | 204/358 [00:20<00:15,  9.73it/s] 57%|█████▋    | 205/358 [00:20<00:15,  9.69it/s] 58%|█████▊    | 207/358 [00:21<00:15,  9.86it/s] 58%|█████▊    | 208/358 [00:21<00:15,  9.79it/s] 59%|█████▊    | 210/358 [00:21<00:15,  9.81it/s] 59%|█████▉    | 212/358 [00:21<00:14,  9.80it/s] 60%|█████▉    | 214/358 [00:21<00:14,  9.88it/s] 60%|██████    | 215/358 [00:21<00:14,  9.81it/s] 60%|██████    | 216/358 [00:22<00:14,  9.75it/s] 61%|██████    | 217/358 [00:22<00:14,  9.79it/s] 61%|██████    | 218/358 [00:22<00:14,  9.76it/s] 61%|██████    | 219/358 [00:22<00:14,  9.76it/s] 62%|██████▏   | 221/358 [00:22<00:13,  9.90it/s] 62%|██████▏   | 222/358 [00:22<00:13,  9.79it/s] 62%|██████▏   | 223/358 [00:22<00:13,  9.74it/s] 63%|██████▎   | 224/358 [00:22<00:13,  9.68it/s] 63%|██████▎   | 225/358 [00:22<00:13,  9.76it/s] 63%|██████▎   | 226/358 [00:23<00:13,  9.71it/s] 64%|██████▎   | 228/358 [00:23<00:13,  9.75it/s] 64%|██████▍   | 229/358 [00:23<00:13,  9.72it/s] 64%|██████▍   | 230/358 [00:23<00:13,  9.67it/s] 65%|██████▍   | 232/358 [00:23<00:12,  9.72it/s] 65%|██████▌   | 234/358 [00:23<00:12, 10.02it/s] 66%|██████▌   | 236/358 [00:24<00:12,  9.97it/s] 66%|██████▋   | 238/358 [00:24<00:11, 10.03it/s] 67%|██████▋   | 240/358 [00:24<00:11,  9.99it/s] 68%|██████▊   | 242/358 [00:24<00:11,  9.97it/s] 68%|██████▊   | 243/358 [00:24<00:11,  9.90it/s] 68%|██████▊   | 244/358 [00:24<00:11,  9.83it/s] 69%|██████▊   | 246/358 [00:25<00:11,  9.85it/s] 69%|██████▉   | 247/358 [00:25<00:11,  9.78it/s] 69%|██████▉   | 248/358 [00:25<00:11,  9.74it/s] 70%|██████▉   | 250/358 [00:25<00:10,  9.84it/s] 70%|███████   | 251/358 [00:25<00:10,  9.78it/s] 70%|███████   | 252/358 [00:25<00:10,  9.71it/s] 71%|███████   | 253/358 [00:25<00:10,  9.67it/s] 71%|███████   | 254/358 [00:25<00:10,  9.65it/s] 72%|███████▏  | 256/358 [00:26<00:10,  9.82it/s] 72%|███████▏  | 257/358 [00:26<00:10,  9.83it/s] 72%|███████▏  | 258/358 [00:26<00:10,  9.70it/s] 72%|███████▏  | 259/358 [00:26<00:10,  9.67it/s] 73%|███████▎  | 260/358 [00:26<00:10,  9.71it/s] 73%|███████▎  | 262/358 [00:26<00:09,  9.88it/s] 74%|███████▎  | 264/358 [00:26<00:09,  9.90it/s] 74%|███████▍  | 266/358 [00:27<00:09,  9.89it/s] 75%|███████▍  | 267/358 [00:27<00:09,  9.83it/s] 75%|███████▌  | 269/358 [00:27<00:09,  9.89it/s] 75%|███████▌  | 270/358 [00:27<00:08,  9.82it/s] 76%|███████▌  | 271/358 [00:27<00:08,  9.74it/s] 76%|███████▌  | 272/358 [00:27<00:08,  9.72it/s] 76%|███████▋  | 273/358 [00:27<00:08,  9.62it/s] 77%|███████▋  | 274/358 [00:27<00:08,  9.62it/s] 77%|███████▋  | 275/358 [00:28<00:08,  9.67it/s] 77%|███████▋  | 276/358 [00:28<00:08,  9.67it/s] 77%|███████▋  | 277/358 [00:28<00:08,  9.64it/s] 78%|███████▊  | 278/358 [00:28<00:08,  9.62it/s] 78%|███████▊  | 280/358 [00:28<00:07,  9.81it/s] 78%|███████▊  | 281/358 [00:28<00:07,  9.82it/s] 79%|███████▉  | 282/358 [00:28<00:07,  9.76it/s] 79%|███████▉  | 283/358 [00:28<00:07,  9.70it/s] 79%|███████▉  | 284/358 [00:28<00:07,  9.66it/s] 80%|███████▉  | 285/358 [00:29<00:07,  9.73it/s] 80%|███████▉  | 286/358 [00:29<00:07,  9.68it/s] 80%|████████  | 287/358 [00:29<00:07,  9.66it/s] 80%|████████  | 288/358 [00:29<00:07,  9.62it/s] 81%|████████  | 290/358 [00:29<00:06,  9.83it/s] 81%|████████▏ | 291/358 [00:29<00:06,  9.81it/s] 82%|████████▏ | 293/358 [00:29<00:06,  9.83it/s] 82%|████████▏ | 295/358 [00:30<00:06,  9.90it/s] 83%|████████▎ | 296/358 [00:30<00:06,  9.83it/s] 83%|████████▎ | 297/358 [00:30<00:06,  9.72it/s] 84%|████████▎ | 299/358 [00:30<00:05,  9.88it/s] 84%|████████▍ | 301/358 [00:30<00:05,  9.92it/s] 84%|████████▍ | 302/358 [00:30<00:05,  9.85it/s] 85%|████████▍ | 303/358 [00:30<00:05,  9.86it/s] 85%|████████▌ | 305/358 [00:31<00:05,  9.89it/s] 85%|████████▌ | 306/358 [00:31<00:05,  9.81it/s] 86%|████████▌ | 308/358 [00:31<00:05,  9.91it/s] 86%|████████▋ | 309/358 [00:31<00:04,  9.81it/s] 87%|████████▋ | 310/358 [00:31<00:04,  9.76it/s] 87%|████████▋ | 311/358 [00:31<00:04,  9.68it/s] 87%|████████▋ | 312/358 [00:31<00:04,  9.70it/s] 87%|████████▋ | 313/358 [00:31<00:04,  9.72it/s] 88%|████████▊ | 315/358 [00:32<00:04,  9.97it/s] 88%|████████▊ | 316/358 [00:32<00:04,  9.92it/s] 89%|████████▊ | 317/358 [00:32<00:04,  9.84it/s] 89%|████████▉ | 318/358 [00:32<00:04,  9.79it/s] 89%|████████▉ | 319/358 [00:32<00:04,  9.75it/s] 89%|████████▉ | 320/358 [00:32<00:03,  9.80it/s] 90%|████████▉ | 321/358 [00:32<00:03,  9.73it/s] 90%|████████▉ | 322/358 [00:32<00:03,  9.69it/s] 90%|█████████ | 323/358 [00:32<00:03,  9.64it/s] 91%|█████████ | 324/358 [00:33<00:03,  9.62it/s] 91%|█████████ | 325/358 [00:33<00:03,  9.60it/s] 91%|█████████▏| 327/358 [00:33<00:03,  9.95it/s] 92%|█████████▏| 329/358 [00:33<00:02, 10.06it/s] 92%|█████████▏| 330/358 [00:33<00:02,  9.95it/s] 93%|█████████▎| 332/358 [00:33<00:02, 10.04it/s] 93%|█████████▎| 334/358 [00:34<00:02,  9.95it/s] 94%|█████████▎| 335/358 [00:34<00:02,  9.83it/s] 94%|█████████▍| 337/358 [00:34<00:02,  9.90it/s] 95%|█████████▍| 339/358 [00:34<00:01, 10.10it/s] 95%|█████████▌| 341/358 [00:34<00:01, 10.05it/s] 96%|█████████▌| 343/358 [00:34<00:01,  9.89it/s] 96%|█████████▌| 344/358 [00:35<00:01,  9.83it/s] 96%|█████████▋| 345/358 [00:35<00:01,  9.85it/s] 97%|█████████▋| 346/358 [00:35<00:01,  9.88it/s] 97%|█████████▋| 348/358 [00:35<00:01,  9.97it/s] 97%|█████████▋| 349/358 [00:35<00:00,  9.88it/s] 98%|█████████▊| 350/358 [00:35<00:00,  9.81it/s] 98%|█████████▊| 351/358 [00:35<00:00,  9.76it/s] 99%|█████████▊| 353/358 [00:35<00:00,  9.93it/s] 99%|█████████▉| 354/358 [00:36<00:00,  9.91it/s] 99%|█████████▉| 355/358 [00:36<00:00,  9.81it/s]100%|█████████▉| 357/358 [00:36<00:00,  9.86it/s]100%|██████████| 358/358 [00:36<00:00,  9.81it/s]
[32m2025-02-05 05:22:49.638[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    gen_loss  grad clip ratio  grad norm   ppl
       2.564                1      3.785 12.99[0m
[32m2025-02-05 05:22:49.638[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m169[0m - [1m[Valid][0m
  0%|          | 0/10256 [00:00<?, ?it/s]100%|██████████| 10256/10256 [00:00<00:00, 1039931.87it/s]
[32m2025-02-05 05:22:49.649[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:26,  1.46it/s]  5%|▌         | 2/40 [00:01<00:25,  1.47it/s]  8%|▊         | 3/40 [00:02<00:25,  1.48it/s] 10%|█         | 4/40 [00:02<00:24,  1.47it/s] 12%|█▎        | 5/40 [00:03<00:23,  1.46it/s] 15%|█▌        | 6/40 [00:04<00:23,  1.46it/s] 18%|█▊        | 7/40 [00:04<00:22,  1.46it/s] 20%|██        | 8/40 [00:05<00:21,  1.47it/s] 22%|██▎       | 9/40 [00:06<00:21,  1.47it/s] 25%|██▌       | 10/40 [00:06<00:20,  1.47it/s] 28%|██▊       | 11/40 [00:07<00:19,  1.47it/s] 30%|███       | 12/40 [00:08<00:19,  1.47it/s] 32%|███▎      | 13/40 [00:08<00:18,  1.46it/s] 35%|███▌      | 14/40 [00:09<00:17,  1.46it/s] 38%|███▊      | 15/40 [00:10<00:17,  1.46it/s] 40%|████      | 16/40 [00:10<00:16,  1.45it/s] 42%|████▎     | 17/40 [00:11<00:15,  1.46it/s] 45%|████▌     | 18/40 [00:12<00:15,  1.46it/s] 48%|████▊     | 19/40 [00:12<00:14,  1.46it/s] 50%|█████     | 20/40 [00:13<00:13,  1.46it/s] 52%|█████▎    | 21/40 [00:14<00:12,  1.47it/s] 55%|█████▌    | 22/40 [00:15<00:12,  1.46it/s] 57%|█████▊    | 23/40 [00:15<00:11,  1.47it/s] 60%|██████    | 24/40 [00:16<00:10,  1.46it/s] 62%|██████▎   | 25/40 [00:17<00:10,  1.46it/s] 65%|██████▌   | 26/40 [00:17<00:09,  1.47it/s] 68%|██████▊   | 27/40 [00:18<00:08,  1.47it/s] 70%|███████   | 28/40 [00:19<00:08,  1.46it/s] 72%|███████▎  | 29/40 [00:19<00:07,  1.46it/s] 75%|███████▌  | 30/40 [00:20<00:06,  1.47it/s] 78%|███████▊  | 31/40 [00:21<00:06,  1.47it/s] 80%|████████  | 32/40 [00:22<00:06,  1.21it/s] 82%|████████▎ | 33/40 [00:23<00:05,  1.28it/s] 85%|████████▌ | 34/40 [00:23<00:04,  1.34it/s] 88%|████████▊ | 35/40 [00:24<00:03,  1.37it/s] 90%|█████████ | 36/40 [00:25<00:02,  1.40it/s] 92%|█████████▎| 37/40 [00:25<00:02,  1.42it/s] 95%|█████████▌| 38/40 [00:26<00:01,  1.43it/s] 98%|█████████▊| 39/40 [00:27<00:00,  1.44it/s]100%|██████████| 40/40 [00:27<00:00,  1.59it/s]100%|██████████| 40/40 [00:27<00:00,  1.45it/s]
[32m2025-02-05 05:23:17.225[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    average  bleu@1  bleu@2  bleu@3  bleu@4  dist@1  dist@2  dist@3  dist@4  extreme  \
      .7707   .2847   .1019  .04324  .02358  .03785   .2793   .6006   .7997    .5797   
      f1  gen_loss  greedy  intra_dist@1  intra_dist@2  intra_dist@3  intra_dist@4  \
   .3480     4.124   .6643         .8929         .9804         .9566         .9002   
     ppl  rouge1  rouge2  rougeL  
   61.78   .3817  .08839   .3682[0m
[32m2025-02-05 05:23:17.231[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m163[0m - [1m[Conversation epoch 14][0m
[32m2025-02-05 05:23:17.231[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m164[0m - [1m[Train][0m
  0%|          | 0/92414 [00:00<?, ?it/s]100%|██████████| 92414/92414 [00:00<00:00, 2174397.29it/s]
[32m2025-02-05 05:23:17.274[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/358 [00:00<?, ?it/s]  0%|          | 1/358 [00:00<00:36,  9.73it/s]  1%|          | 3/358 [00:00<00:35,  9.92it/s]  1%|          | 4/358 [00:00<00:35,  9.90it/s]  2%|▏         | 6/358 [00:00<00:35,  9.87it/s]  2%|▏         | 7/358 [00:00<00:35,  9.81it/s]  2%|▏         | 8/358 [00:00<00:35,  9.85it/s]  3%|▎         | 9/358 [00:00<00:35,  9.74it/s]  3%|▎         | 10/358 [00:01<00:35,  9.74it/s]  3%|▎         | 11/358 [00:01<00:35,  9.69it/s]  4%|▎         | 13/358 [00:01<00:34,  9.91it/s]  4%|▍         | 14/358 [00:01<00:34,  9.84it/s]  4%|▍         | 15/358 [00:01<00:35,  9.76it/s]  4%|▍         | 16/358 [00:01<00:35,  9.70it/s]  5%|▍         | 17/358 [00:01<00:35,  9.71it/s]  5%|▌         | 18/358 [00:01<00:34,  9.79it/s]  5%|▌         | 19/358 [00:01<00:34,  9.72it/s]  6%|▌         | 20/358 [00:02<00:34,  9.66it/s]  6%|▌         | 21/358 [00:02<00:35,  9.60it/s]  6%|▌         | 22/358 [00:02<00:34,  9.67it/s]  7%|▋         | 24/358 [00:02<00:34,  9.76it/s]  7%|▋         | 25/358 [00:02<00:34,  9.71it/s]  7%|▋         | 26/358 [00:02<00:34,  9.66it/s]  8%|▊         | 27/358 [00:02<00:34,  9.71it/s]  8%|▊         | 28/358 [00:02<00:34,  9.67it/s]  8%|▊         | 29/358 [00:02<00:34,  9.64it/s]  9%|▊         | 31/358 [00:03<00:33,  9.74it/s]  9%|▉         | 32/358 [00:03<00:33,  9.74it/s]  9%|▉         | 34/358 [00:03<00:32,  9.84it/s] 10%|█         | 36/358 [00:03<00:32,  9.84it/s] 10%|█         | 37/358 [00:03<00:32,  9.82it/s] 11%|█         | 38/358 [00:03<00:32,  9.78it/s] 11%|█         | 40/358 [00:04<00:32,  9.94it/s] 11%|█▏        | 41/358 [00:04<00:32,  9.85it/s] 12%|█▏        | 43/358 [00:04<00:31,  9.88it/s] 13%|█▎        | 45/358 [00:04<00:31,  9.98it/s] 13%|█▎        | 47/358 [00:04<00:31,  9.95it/s] 13%|█▎        | 48/358 [00:04<00:31,  9.94it/s] 14%|█▍        | 50/358 [00:05<00:31,  9.91it/s] 14%|█▍        | 51/358 [00:05<00:31,  9.84it/s] 15%|█▍        | 52/358 [00:05<00:31,  9.75it/s] 15%|█▍        | 53/358 [00:05<00:31,  9.69it/s] 15%|█▌        | 54/358 [00:05<00:31,  9.74it/s] 15%|█▌        | 55/358 [00:05<00:31,  9.69it/s] 16%|█▌        | 56/358 [00:05<00:31,  9.73it/s] 16%|█▌        | 57/358 [00:05<00:31,  9.69it/s] 16%|█▌        | 58/358 [00:05<00:31,  9.67it/s] 16%|█▋        | 59/358 [00:06<00:31,  9.63it/s] 17%|█▋        | 61/358 [00:06<00:30,  9.72it/s] 17%|█▋        | 62/358 [00:06<00:30,  9.64it/s] 18%|█▊        | 63/358 [00:06<00:30,  9.70it/s] 18%|█▊        | 64/358 [00:06<00:30,  9.66it/s] 18%|█▊        | 66/358 [00:06<00:30,  9.73it/s] 19%|█▊        | 67/358 [00:06<00:29,  9.71it/s] 19%|█▉        | 69/358 [00:07<00:29,  9.77it/s] 20%|█▉        | 70/358 [00:07<00:29,  9.72it/s] 20%|█▉        | 71/358 [00:07<00:29,  9.76it/s] 20%|██        | 72/358 [00:07<00:29,  9.71it/s] 20%|██        | 73/358 [00:07<00:29,  9.68it/s] 21%|██        | 74/358 [00:07<00:29,  9.65it/s] 21%|██        | 75/358 [00:07<00:29,  9.61it/s] 21%|██        | 76/358 [00:07<00:29,  9.72it/s] 22%|██▏       | 77/358 [00:07<00:29,  9.68it/s] 22%|██▏       | 79/358 [00:08<00:28,  9.69it/s] 23%|██▎       | 81/358 [00:08<00:28,  9.75it/s] 23%|██▎       | 83/358 [00:08<00:28,  9.77it/s] 23%|██▎       | 84/358 [00:08<00:28,  9.73it/s] 24%|██▎       | 85/358 [00:08<00:28,  9.68it/s] 24%|██▍       | 86/358 [00:08<00:28,  9.66it/s] 24%|██▍       | 87/358 [00:08<00:28,  9.65it/s] 25%|██▍       | 88/358 [00:09<00:27,  9.67it/s] 25%|██▌       | 90/358 [00:09<00:27,  9.90it/s] 26%|██▌       | 92/358 [00:09<00:26, 10.00it/s] 26%|██▌       | 93/358 [00:09<00:26,  9.97it/s] 26%|██▋       | 94/358 [00:09<00:26,  9.88it/s] 27%|██▋       | 96/358 [00:09<00:25, 10.16it/s] 27%|██▋       | 98/358 [00:10<00:25, 10.05it/s] 28%|██▊       | 99/358 [00:10<00:26,  9.96it/s] 28%|██▊       | 101/358 [00:10<00:25,  9.92it/s] 29%|██▉       | 103/358 [00:10<00:25,  9.91it/s] 29%|██▉       | 104/358 [00:10<00:25,  9.86it/s] 29%|██▉       | 105/358 [00:10<00:25,  9.78it/s] 30%|██▉       | 106/358 [00:10<00:25,  9.77it/s] 30%|███       | 108/358 [00:11<00:25,  9.80it/s] 30%|███       | 109/358 [00:11<00:25,  9.71it/s] 31%|███       | 110/358 [00:11<00:25,  9.69it/s] 31%|███       | 111/358 [00:11<00:25,  9.64it/s] 32%|███▏      | 113/358 [00:11<00:24,  9.91it/s] 32%|███▏      | 114/358 [00:11<00:24,  9.87it/s] 32%|███▏      | 115/358 [00:11<00:24,  9.78it/s] 32%|███▏      | 116/358 [00:11<00:24,  9.69it/s] 33%|███▎      | 117/358 [00:11<00:24,  9.66it/s] 33%|███▎      | 119/358 [00:12<00:24,  9.78it/s] 34%|███▍      | 121/358 [00:12<00:23,  9.98it/s] 34%|███▍      | 123/358 [00:12<00:23, 10.08it/s] 35%|███▍      | 125/358 [00:12<00:23, 10.06it/s] 35%|███▌      | 127/358 [00:12<00:23,  9.98it/s] 36%|███▌      | 128/358 [00:13<00:23,  9.94it/s] 36%|███▋      | 130/358 [00:13<00:22,  9.99it/s] 37%|███▋      | 131/358 [00:13<00:22,  9.90it/s] 37%|███▋      | 132/358 [00:13<00:22,  9.92it/s] 37%|███▋      | 134/358 [00:13<00:22,  9.94it/s] 38%|███▊      | 135/358 [00:13<00:22,  9.88it/s] 38%|███▊      | 137/358 [00:13<00:22,  9.96it/s] 39%|███▊      | 138/358 [00:14<00:22,  9.94it/s] 39%|███▉      | 139/358 [00:14<00:22,  9.85it/s] 39%|███▉      | 141/358 [00:14<00:21,  9.98it/s] 40%|███▉      | 142/358 [00:14<00:21,  9.90it/s] 40%|███▉      | 143/358 [00:14<00:21,  9.87it/s] 40%|████      | 144/358 [00:14<00:21,  9.79it/s] 41%|████      | 145/358 [00:14<00:21,  9.80it/s] 41%|████      | 146/358 [00:14<00:21,  9.74it/s] 41%|████      | 147/358 [00:14<00:21,  9.68it/s] 41%|████▏     | 148/358 [00:15<00:21,  9.71it/s] 42%|████▏     | 149/358 [00:15<00:21,  9.69it/s] 42%|████▏     | 150/358 [00:15<00:21,  9.65it/s] 42%|████▏     | 151/358 [00:15<00:22,  9.38it/s] 42%|████▏     | 152/358 [00:15<00:21,  9.43it/s] 43%|████▎     | 153/358 [00:15<00:21,  9.45it/s] 43%|████▎     | 154/358 [00:15<00:21,  9.54it/s] 43%|████▎     | 155/358 [00:15<00:21,  9.55it/s] 44%|████▎     | 156/358 [00:15<00:20,  9.68it/s] 44%|████▍     | 157/358 [00:16<00:20,  9.62it/s] 44%|████▍     | 158/358 [00:16<00:20,  9.70it/s] 44%|████▍     | 159/358 [00:16<00:20,  9.70it/s] 45%|████▍     | 160/358 [00:16<00:20,  9.71it/s] 45%|████▌     | 162/358 [00:16<00:19, 10.00it/s] 46%|████▌     | 164/358 [00:16<00:19, 10.00it/s] 46%|████▌     | 165/358 [00:16<00:19,  9.96it/s] 47%|████▋     | 167/358 [00:17<00:19,  9.91it/s] 47%|████▋     | 169/358 [00:17<00:18,  9.95it/s] 48%|████▊     | 171/358 [00:17<00:18,  9.93it/s] 48%|████▊     | 172/358 [00:17<00:18,  9.88it/s] 48%|████▊     | 173/358 [00:17<00:18,  9.81it/s] 49%|████▉     | 175/358 [00:17<00:18,  9.83it/s] 49%|████▉     | 176/358 [00:17<00:18,  9.85it/s] 49%|████▉     | 177/358 [00:18<00:18,  9.83it/s] 50%|█████     | 179/358 [00:18<00:18,  9.86it/s] 50%|█████     | 180/358 [00:18<00:18,  9.79it/s] 51%|█████     | 182/358 [00:18<00:17,  9.94it/s] 51%|█████     | 183/358 [00:18<00:17,  9.89it/s] 51%|█████▏    | 184/358 [00:18<00:17,  9.78it/s] 52%|█████▏    | 185/358 [00:18<00:17,  9.73it/s] 52%|█████▏    | 187/358 [00:19<00:17,  9.94it/s] 53%|█████▎    | 188/358 [00:19<00:17,  9.89it/s] 53%|█████▎    | 189/358 [00:19<00:17,  9.83it/s] 53%|█████▎    | 191/358 [00:19<00:17,  9.75it/s] 54%|█████▎    | 192/358 [00:19<00:17,  9.70it/s] 54%|█████▍    | 193/358 [00:19<00:17,  9.69it/s] 54%|█████▍    | 194/358 [00:19<00:16,  9.67it/s] 54%|█████▍    | 195/358 [00:19<00:16,  9.74it/s] 55%|█████▌    | 197/358 [00:20<00:16,  9.91it/s] 55%|█████▌    | 198/358 [00:20<00:16,  9.84it/s] 56%|█████▌    | 199/358 [00:20<00:16,  9.87it/s] 56%|█████▌    | 200/358 [00:20<00:16,  9.80it/s] 56%|█████▌    | 201/358 [00:20<00:16,  9.77it/s] 57%|█████▋    | 203/358 [00:20<00:15,  9.85it/s] 57%|█████▋    | 204/358 [00:20<00:15,  9.75it/s] 57%|█████▋    | 205/358 [00:20<00:15,  9.71it/s] 58%|█████▊    | 207/358 [00:21<00:15,  9.88it/s] 58%|█████▊    | 208/358 [00:21<00:15,  9.80it/s] 59%|█████▊    | 210/358 [00:21<00:15,  9.82it/s] 59%|█████▉    | 212/358 [00:21<00:14,  9.81it/s] 60%|█████▉    | 214/358 [00:21<00:14,  9.89it/s] 60%|██████    | 215/358 [00:21<00:14,  9.82it/s] 60%|██████    | 216/358 [00:22<00:14,  9.76it/s] 61%|██████    | 217/358 [00:22<00:14,  9.80it/s] 61%|██████    | 218/358 [00:22<00:14,  9.77it/s] 61%|██████    | 219/358 [00:22<00:14,  9.77it/s] 62%|██████▏   | 221/358 [00:22<00:13,  9.90it/s] 62%|██████▏   | 222/358 [00:22<00:13,  9.80it/s] 62%|██████▏   | 223/358 [00:22<00:13,  9.74it/s] 63%|██████▎   | 224/358 [00:22<00:13,  9.69it/s] 63%|██████▎   | 226/358 [00:23<00:13,  9.73it/s] 64%|██████▎   | 228/358 [00:23<00:13,  9.76it/s] 64%|██████▍   | 229/358 [00:23<00:13,  9.74it/s] 64%|██████▍   | 230/358 [00:23<00:13,  9.69it/s] 65%|██████▍   | 232/358 [00:23<00:12,  9.73it/s] 65%|██████▌   | 234/358 [00:23<00:12, 10.02it/s] 66%|██████▌   | 236/358 [00:24<00:12,  9.98it/s] 66%|██████▋   | 238/358 [00:24<00:11, 10.03it/s] 67%|██████▋   | 240/358 [00:24<00:11,  9.99it/s] 68%|██████▊   | 242/358 [00:24<00:11,  9.97it/s] 68%|██████▊   | 243/358 [00:24<00:11,  9.91it/s] 68%|██████▊   | 244/358 [00:24<00:11,  9.84it/s] 69%|██████▊   | 246/358 [00:25<00:11,  9.87it/s] 69%|██████▉   | 247/358 [00:25<00:11,  9.79it/s] 69%|██████▉   | 248/358 [00:25<00:11,  9.75it/s] 70%|██████▉   | 250/358 [00:25<00:10,  9.84it/s] 70%|███████   | 251/358 [00:25<00:10,  9.78it/s] 70%|███████   | 252/358 [00:25<00:10,  9.72it/s] 71%|███████   | 253/358 [00:25<00:10,  9.68it/s] 71%|███████   | 254/358 [00:25<00:10,  9.65it/s] 72%|███████▏  | 256/358 [00:26<00:10,  9.83it/s] 72%|███████▏  | 257/358 [00:26<00:10,  9.84it/s] 72%|███████▏  | 258/358 [00:26<00:10,  9.71it/s] 72%|███████▏  | 259/358 [00:26<00:10,  9.68it/s] 73%|███████▎  | 260/358 [00:26<00:10,  9.71it/s] 73%|███████▎  | 262/358 [00:26<00:09,  9.89it/s] 74%|███████▎  | 264/358 [00:26<00:09,  9.91it/s] 74%|███████▍  | 266/358 [00:27<00:09,  9.90it/s] 75%|███████▍  | 267/358 [00:27<00:09,  9.84it/s] 75%|███████▌  | 269/358 [00:27<00:08,  9.90it/s] 75%|███████▌  | 270/358 [00:27<00:08,  9.83it/s] 76%|███████▌  | 271/358 [00:27<00:08,  9.75it/s] 76%|███████▌  | 272/358 [00:27<00:08,  9.73it/s] 76%|███████▋  | 273/358 [00:27<00:08,  9.63it/s] 77%|███████▋  | 274/358 [00:27<00:08,  9.63it/s] 77%|███████▋  | 275/358 [00:28<00:08,  9.68it/s] 77%|███████▋  | 276/358 [00:28<00:08,  9.68it/s] 77%|███████▋  | 277/358 [00:28<00:08,  9.65it/s] 78%|███████▊  | 278/358 [00:28<00:08,  9.62it/s] 78%|███████▊  | 280/358 [00:28<00:07,  9.82it/s] 78%|███████▊  | 281/358 [00:28<00:07,  9.83it/s] 79%|███████▉  | 282/358 [00:28<00:07,  9.77it/s] 79%|███████▉  | 283/358 [00:28<00:07,  9.71it/s] 79%|███████▉  | 284/358 [00:28<00:07,  9.67it/s] 80%|███████▉  | 285/358 [00:29<00:07,  9.74it/s] 80%|███████▉  | 286/358 [00:29<00:07,  9.70it/s] 80%|████████  | 287/358 [00:29<00:07,  9.67it/s] 80%|████████  | 288/358 [00:29<00:07,  9.63it/s] 81%|████████  | 290/358 [00:29<00:06,  9.84it/s] 81%|████████▏ | 291/358 [00:29<00:06,  9.82it/s] 82%|████████▏ | 293/358 [00:29<00:06,  9.84it/s] 82%|████████▏ | 295/358 [00:30<00:06,  9.91it/s] 83%|████████▎ | 296/358 [00:30<00:06,  9.84it/s] 83%|████████▎ | 297/358 [00:30<00:06,  9.73it/s] 84%|████████▎ | 299/358 [00:30<00:05,  9.90it/s] 84%|████████▍ | 301/358 [00:30<00:05,  9.94it/s] 84%|████████▍ | 302/358 [00:30<00:05,  9.87it/s] 85%|████████▍ | 303/358 [00:30<00:05,  9.88it/s] 85%|████████▌ | 305/358 [00:31<00:05,  9.90it/s] 85%|████████▌ | 306/358 [00:31<00:05,  9.83it/s] 86%|████████▌ | 308/358 [00:31<00:05,  9.93it/s] 86%|████████▋ | 309/358 [00:31<00:04,  9.82it/s] 87%|████████▋ | 310/358 [00:31<00:04,  9.77it/s] 87%|████████▋ | 311/358 [00:31<00:04,  9.69it/s] 87%|████████▋ | 312/358 [00:31<00:04,  9.71it/s] 87%|████████▋ | 313/358 [00:31<00:04,  9.73it/s] 88%|████████▊ | 315/358 [00:32<00:04,  9.98it/s] 88%|████████▊ | 316/358 [00:32<00:04,  9.93it/s] 89%|████████▊ | 317/358 [00:32<00:04,  9.84it/s] 89%|████████▉ | 318/358 [00:32<00:04,  9.80it/s] 89%|████████▉ | 319/358 [00:32<00:04,  9.75it/s] 89%|████████▉ | 320/358 [00:32<00:03,  9.81it/s] 90%|████████▉ | 321/358 [00:32<00:03,  9.74it/s] 90%|████████▉ | 322/358 [00:32<00:03,  9.70it/s] 90%|█████████ | 323/358 [00:32<00:03,  9.66it/s] 91%|█████████ | 324/358 [00:33<00:03,  9.63it/s] 91%|█████████ | 325/358 [00:33<00:03,  9.60it/s] 91%|█████████▏| 327/358 [00:33<00:03,  9.97it/s] 92%|█████████▏| 329/358 [00:33<00:02, 10.07it/s] 92%|█████████▏| 330/358 [00:33<00:02,  9.96it/s] 93%|█████████▎| 332/358 [00:33<00:02, 10.06it/s] 93%|█████████▎| 334/358 [00:34<00:02,  9.96it/s] 94%|█████████▎| 335/358 [00:34<00:02,  9.84it/s] 94%|█████████▍| 337/358 [00:34<00:02,  9.92it/s] 95%|█████████▍| 339/358 [00:34<00:01, 10.12it/s] 95%|█████████▌| 341/358 [00:34<00:01, 10.06it/s] 96%|█████████▌| 343/358 [00:34<00:01,  9.90it/s] 96%|█████████▌| 344/358 [00:35<00:01,  9.84it/s] 96%|█████████▋| 345/358 [00:35<00:01,  9.86it/s] 97%|█████████▋| 347/358 [00:35<00:01, 10.04it/s] 97%|█████████▋| 348/358 [00:35<00:01,  9.94it/s] 97%|█████████▋| 349/358 [00:35<00:00,  9.86it/s] 98%|█████████▊| 350/358 [00:35<00:00,  9.79it/s] 98%|█████████▊| 351/358 [00:35<00:00,  9.74it/s] 99%|█████████▊| 353/358 [00:35<00:00,  9.92it/s] 99%|█████████▉| 354/358 [00:36<00:00,  9.90it/s] 99%|█████████▉| 355/358 [00:36<00:00,  9.82it/s]100%|█████████▉| 357/358 [00:36<00:00,  9.87it/s]100%|██████████| 358/358 [00:36<00:00,  9.82it/s]
[32m2025-02-05 05:23:53.722[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    gen_loss  grad clip ratio  grad norm   ppl
       2.521                1      4.143 12.44[0m
[32m2025-02-05 05:23:53.722[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m169[0m - [1m[Valid][0m
  0%|          | 0/10256 [00:00<?, ?it/s]100%|██████████| 10256/10256 [00:00<00:00, 2003296.32it/s]
[32m2025-02-05 05:23:53.728[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:26,  1.48it/s]  5%|▌         | 2/40 [00:01<00:25,  1.49it/s]  8%|▊         | 3/40 [00:02<00:24,  1.49it/s] 10%|█         | 4/40 [00:02<00:24,  1.49it/s] 12%|█▎        | 5/40 [00:03<00:23,  1.48it/s] 15%|█▌        | 6/40 [00:04<00:22,  1.48it/s] 18%|█▊        | 7/40 [00:04<00:22,  1.48it/s] 20%|██        | 8/40 [00:05<00:21,  1.48it/s] 22%|██▎       | 9/40 [00:06<00:20,  1.48it/s] 25%|██▌       | 10/40 [00:06<00:20,  1.48it/s] 28%|██▊       | 11/40 [00:07<00:19,  1.49it/s] 30%|███       | 12/40 [00:08<00:18,  1.49it/s] 32%|███▎      | 13/40 [00:08<00:18,  1.49it/s] 35%|███▌      | 14/40 [00:09<00:17,  1.48it/s] 38%|███▊      | 15/40 [00:10<00:16,  1.48it/s] 40%|████      | 16/40 [00:10<00:16,  1.47it/s] 42%|████▎     | 17/40 [00:11<00:15,  1.48it/s] 45%|████▌     | 18/40 [00:12<00:14,  1.48it/s] 48%|████▊     | 19/40 [00:12<00:14,  1.47it/s] 50%|█████     | 20/40 [00:13<00:13,  1.48it/s] 52%|█████▎    | 21/40 [00:14<00:12,  1.48it/s] 55%|█████▌    | 22/40 [00:14<00:12,  1.48it/s] 57%|█████▊    | 23/40 [00:15<00:11,  1.48it/s] 60%|██████    | 24/40 [00:16<00:10,  1.47it/s] 62%|██████▎   | 25/40 [00:16<00:10,  1.47it/s] 65%|██████▌   | 26/40 [00:17<00:09,  1.48it/s] 68%|██████▊   | 27/40 [00:18<00:08,  1.48it/s] 70%|███████   | 28/40 [00:18<00:08,  1.48it/s] 72%|███████▎  | 29/40 [00:19<00:07,  1.48it/s] 75%|███████▌  | 30/40 [00:20<00:06,  1.49it/s] 78%|███████▊  | 31/40 [00:20<00:06,  1.49it/s] 80%|████████  | 32/40 [00:21<00:05,  1.49it/s] 82%|████████▎ | 33/40 [00:22<00:04,  1.48it/s] 85%|████████▌ | 34/40 [00:22<00:04,  1.48it/s] 88%|████████▊ | 35/40 [00:23<00:03,  1.48it/s] 90%|█████████ | 36/40 [00:24<00:02,  1.48it/s] 92%|█████████▎| 37/40 [00:24<00:02,  1.48it/s] 95%|█████████▌| 38/40 [00:25<00:01,  1.47it/s] 98%|█████████▊| 39/40 [00:26<00:00,  1.47it/s]100%|██████████| 40/40 [00:26<00:00,  1.63it/s]100%|██████████| 40/40 [00:26<00:00,  1.49it/s]
[32m2025-02-05 05:24:20.552[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    average  bleu@1  bleu@2  bleu@3  bleu@4  dist@1  dist@2  dist@3  dist@4  extreme  \
      .7586   .2823  .09484  .04258  .02332   .0446   .3089   .6202   .8080    .5672   
      f1  gen_loss  greedy  intra_dist@1  intra_dist@2  intra_dist@3  intra_dist@4  \
   .3464     4.192   .6595         .9077         .9858         .9497         .8851   
     ppl  rouge1  rouge2  rougeL  
   66.14   .3794  .08191   .3657[0m
[32m2025-02-05 05:24:20.558[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m163[0m - [1m[Conversation epoch 15][0m
[32m2025-02-05 05:24:20.558[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m164[0m - [1m[Train][0m
  0%|          | 0/92414 [00:00<?, ?it/s]100%|██████████| 92414/92414 [00:00<00:00, 989390.20it/s]
[32m2025-02-05 05:24:20.652[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/358 [00:00<?, ?it/s]  0%|          | 1/358 [00:00<00:36,  9.74it/s]  1%|          | 3/358 [00:00<00:35,  9.92it/s]  1%|          | 4/358 [00:00<00:35,  9.89it/s]  2%|▏         | 6/358 [00:00<00:35,  9.86it/s]  2%|▏         | 7/358 [00:00<00:35,  9.80it/s]  2%|▏         | 8/358 [00:00<00:35,  9.84it/s]  3%|▎         | 9/358 [00:00<00:35,  9.74it/s]  3%|▎         | 10/358 [00:01<00:35,  9.73it/s]  3%|▎         | 11/358 [00:01<00:35,  9.68it/s]  4%|▎         | 13/358 [00:01<00:34,  9.90it/s]  4%|▍         | 14/358 [00:01<00:34,  9.83it/s]  4%|▍         | 15/358 [00:01<00:35,  9.76it/s]  4%|▍         | 16/358 [00:01<00:35,  9.69it/s]  5%|▍         | 17/358 [00:01<00:35,  9.71it/s]  5%|▌         | 18/358 [00:01<00:34,  9.79it/s]  5%|▌         | 19/358 [00:01<00:34,  9.72it/s]  6%|▌         | 20/358 [00:02<00:34,  9.66it/s]  6%|▌         | 21/358 [00:02<00:35,  9.59it/s]  6%|▌         | 22/358 [00:02<00:34,  9.66it/s]  7%|▋         | 24/358 [00:02<00:34,  9.75it/s]  7%|▋         | 25/358 [00:02<00:34,  9.70it/s]  7%|▋         | 26/358 [00:02<00:34,  9.65it/s]  8%|▊         | 27/358 [00:02<00:34,  9.71it/s]  8%|▊         | 28/358 [00:02<00:34,  9.67it/s]  8%|▊         | 29/358 [00:02<00:34,  9.63it/s]  9%|▊         | 31/358 [00:03<00:33,  9.73it/s]  9%|▉         | 32/358 [00:03<00:33,  9.74it/s]  9%|▉         | 34/358 [00:03<00:32,  9.84it/s] 10%|█         | 36/358 [00:03<00:32,  9.84it/s] 10%|█         | 37/358 [00:03<00:32,  9.82it/s] 11%|█         | 38/358 [00:03<00:32,  9.77it/s] 11%|█         | 40/358 [00:04<00:32,  9.93it/s] 11%|█▏        | 41/358 [00:04<00:32,  9.85it/s] 12%|█▏        | 43/358 [00:04<00:31,  9.87it/s] 13%|█▎        | 45/358 [00:04<00:31,  9.97it/s] 13%|█▎        | 47/358 [00:04<00:31,  9.94it/s] 13%|█▎        | 48/358 [00:04<00:31,  9.93it/s] 14%|█▍        | 50/358 [00:05<00:31,  9.90it/s] 14%|█▍        | 51/358 [00:05<00:31,  9.82it/s] 15%|█▍        | 52/358 [00:05<00:31,  9.74it/s] 15%|█▍        | 53/358 [00:05<00:31,  9.69it/s] 15%|█▌        | 54/358 [00:05<00:31,  9.73it/s] 15%|█▌        | 55/358 [00:05<00:31,  9.68it/s] 16%|█▌        | 56/358 [00:05<00:31,  9.72it/s] 16%|█▌        | 57/358 [00:05<00:31,  9.68it/s] 16%|█▌        | 58/358 [00:05<00:31,  9.66it/s] 16%|█▋        | 59/358 [00:06<00:31,  9.63it/s] 17%|█▋        | 61/358 [00:06<00:30,  9.71it/s] 17%|█▋        | 62/358 [00:06<00:30,  9.64it/s] 18%|█▊        | 63/358 [00:06<00:30,  9.70it/s] 18%|█▊        | 64/358 [00:06<00:30,  9.65it/s] 18%|█▊        | 66/358 [00:06<00:30,  9.72it/s] 19%|█▊        | 67/358 [00:06<00:29,  9.71it/s] 19%|█▉        | 69/358 [00:07<00:29,  9.77it/s] 20%|█▉        | 70/358 [00:07<00:29,  9.72it/s] 20%|█▉        | 71/358 [00:07<00:29,  9.75it/s] 20%|██        | 72/358 [00:07<00:29,  9.70it/s] 20%|██        | 73/358 [00:07<00:29,  9.67it/s] 21%|██        | 74/358 [00:07<00:29,  9.64it/s] 21%|██        | 75/358 [00:07<00:29,  9.61it/s] 21%|██        | 76/358 [00:07<00:29,  9.71it/s] 22%|██▏       | 77/358 [00:07<00:29,  9.68it/s] 22%|██▏       | 79/358 [00:08<00:28,  9.69it/s] 23%|██▎       | 81/358 [00:08<00:28,  9.75it/s] 23%|██▎       | 83/358 [00:08<00:28,  9.77it/s] 23%|██▎       | 84/358 [00:08<00:28,  9.72it/s] 24%|██▎       | 85/358 [00:08<00:28,  9.67it/s] 24%|██▍       | 86/358 [00:08<00:28,  9.66it/s] 24%|██▍       | 87/358 [00:08<00:28,  9.64it/s] 25%|██▍       | 88/358 [00:09<00:27,  9.66it/s] 25%|██▌       | 90/358 [00:09<00:27,  9.90it/s] 26%|██▌       | 92/358 [00:09<00:26, 10.00it/s] 26%|██▌       | 93/358 [00:09<00:26,  9.96it/s] 26%|██▋       | 94/358 [00:09<00:26,  9.88it/s] 27%|██▋       | 96/358 [00:09<00:25, 10.16it/s] 27%|██▋       | 98/358 [00:10<00:25, 10.04it/s] 28%|██▊       | 99/358 [00:10<00:26,  9.95it/s] 28%|██▊       | 101/358 [00:10<00:25,  9.92it/s] 29%|██▉       | 103/358 [00:10<00:25,  9.91it/s] 29%|██▉       | 104/358 [00:10<00:25,  9.86it/s] 29%|██▉       | 105/358 [00:10<00:25,  9.78it/s] 30%|██▉       | 106/358 [00:10<00:25,  9.76it/s] 30%|███       | 108/358 [00:11<00:25,  9.79it/s] 30%|███       | 109/358 [00:11<00:25,  9.70it/s] 31%|███       | 110/358 [00:11<00:25,  9.69it/s] 31%|███       | 111/358 [00:11<00:25,  9.64it/s] 32%|███▏      | 113/358 [00:11<00:24,  9.90it/s] 32%|███▏      | 114/358 [00:11<00:24,  9.86it/s] 32%|███▏      | 115/358 [00:11<00:24,  9.77it/s] 32%|███▏      | 116/358 [00:11<00:24,  9.68it/s] 33%|███▎      | 117/358 [00:11<00:24,  9.66it/s] 33%|███▎      | 119/358 [00:12<00:24,  9.78it/s] 34%|███▍      | 121/358 [00:12<00:23,  9.97it/s] 34%|███▍      | 123/358 [00:12<00:23, 10.07it/s] 35%|███▍      | 125/358 [00:12<00:23, 10.05it/s] 35%|███▌      | 127/358 [00:12<00:23,  9.98it/s] 36%|███▌      | 128/358 [00:13<00:23,  9.94it/s] 36%|███▋      | 130/358 [00:13<00:22,  9.99it/s] 37%|███▋      | 131/358 [00:13<00:22,  9.90it/s] 37%|███▋      | 132/358 [00:13<00:22,  9.91it/s] 37%|███▋      | 134/358 [00:13<00:22,  9.93it/s] 38%|███▊      | 135/358 [00:13<00:22,  9.87it/s] 38%|███▊      | 137/358 [00:13<00:22,  9.96it/s] 39%|███▊      | 138/358 [00:14<00:22,  9.94it/s] 39%|███▉      | 139/358 [00:14<00:22,  9.85it/s] 39%|███▉      | 141/358 [00:14<00:21,  9.98it/s] 40%|███▉      | 142/358 [00:14<00:21,  9.90it/s] 40%|███▉      | 143/358 [00:14<00:21,  9.87it/s] 40%|████      | 144/358 [00:14<00:21,  9.78it/s] 41%|████      | 145/358 [00:14<00:21,  9.80it/s] 41%|████      | 146/358 [00:14<00:21,  9.74it/s] 41%|████      | 147/358 [00:14<00:21,  9.68it/s] 41%|████▏     | 148/358 [00:15<00:21,  9.70it/s] 42%|████▏     | 149/358 [00:15<00:21,  9.69it/s] 42%|████▏     | 150/358 [00:15<00:21,  9.65it/s] 42%|████▏     | 151/358 [00:15<00:22,  9.38it/s] 42%|████▏     | 152/358 [00:15<00:21,  9.43it/s] 43%|████▎     | 153/358 [00:15<00:21,  9.45it/s] 43%|████▎     | 154/358 [00:15<00:21,  9.54it/s] 43%|████▎     | 155/358 [00:15<00:21,  9.55it/s] 44%|████▎     | 156/358 [00:15<00:20,  9.68it/s] 44%|████▍     | 157/358 [00:16<00:20,  9.62it/s] 44%|████▍     | 158/358 [00:16<00:20,  9.70it/s] 44%|████▍     | 159/358 [00:16<00:20,  9.70it/s] 45%|████▍     | 160/358 [00:16<00:20,  9.70it/s] 45%|████▌     | 162/358 [00:16<00:19,  9.99it/s] 46%|████▌     | 164/358 [00:16<00:19,  9.99it/s] 46%|████▌     | 165/358 [00:16<00:19,  9.95it/s] 47%|████▋     | 167/358 [00:17<00:19,  9.90it/s] 47%|████▋     | 169/358 [00:17<00:19,  9.94it/s] 48%|████▊     | 171/358 [00:17<00:18,  9.92it/s] 48%|████▊     | 172/358 [00:17<00:18,  9.87it/s] 48%|████▊     | 173/358 [00:17<00:18,  9.80it/s] 49%|████▉     | 175/358 [00:17<00:18,  9.83it/s] 49%|████▉     | 176/358 [00:17<00:18,  9.84it/s] 49%|████▉     | 177/358 [00:18<00:18,  9.82it/s] 50%|█████     | 179/358 [00:18<00:18,  9.85it/s] 50%|█████     | 180/358 [00:18<00:18,  9.78it/s] 51%|█████     | 182/358 [00:18<00:17,  9.93it/s] 51%|█████     | 183/358 [00:18<00:17,  9.88it/s] 51%|█████▏    | 184/358 [00:18<00:17,  9.77it/s] 52%|█████▏    | 185/358 [00:18<00:17,  9.71it/s] 52%|█████▏    | 187/358 [00:19<00:17,  9.93it/s] 53%|█████▎    | 188/358 [00:19<00:17,  9.88it/s] 53%|█████▎    | 189/358 [00:19<00:17,  9.82it/s] 53%|█████▎    | 191/358 [00:19<00:17,  9.74it/s] 54%|█████▎    | 192/358 [00:19<00:17,  9.69it/s] 54%|█████▍    | 193/358 [00:19<00:17,  9.69it/s] 54%|█████▍    | 194/358 [00:19<00:16,  9.67it/s] 54%|█████▍    | 195/358 [00:19<00:16,  9.74it/s] 55%|█████▌    | 197/358 [00:20<00:16,  9.90it/s] 55%|█████▌    | 198/358 [00:20<00:16,  9.83it/s] 56%|█████▌    | 199/358 [00:20<00:16,  9.86it/s] 56%|█████▌    | 200/358 [00:20<00:16,  9.80it/s] 56%|█████▌    | 201/358 [00:20<00:16,  9.76it/s] 57%|█████▋    | 203/358 [00:20<00:15,  9.85it/s] 57%|█████▋    | 204/358 [00:20<00:15,  9.74it/s] 57%|█████▋    | 205/358 [00:20<00:15,  9.70it/s] 58%|█████▊    | 207/358 [00:21<00:15,  9.87it/s] 58%|█████▊    | 208/358 [00:21<00:15,  9.80it/s] 59%|█████▊    | 210/358 [00:21<00:15,  9.82it/s] 59%|█████▉    | 212/358 [00:21<00:14,  9.81it/s] 60%|█████▉    | 214/358 [00:21<00:14,  9.89it/s] 60%|██████    | 215/358 [00:21<00:14,  9.82it/s] 60%|██████    | 216/358 [00:22<00:14,  9.76it/s] 61%|██████    | 217/358 [00:22<00:14,  9.79it/s] 61%|██████    | 218/358 [00:22<00:14,  9.76it/s] 61%|██████    | 219/358 [00:22<00:14,  9.77it/s] 62%|██████▏   | 221/358 [00:22<00:13,  9.90it/s] 62%|██████▏   | 222/358 [00:22<00:13,  9.79it/s] 62%|██████▏   | 223/358 [00:22<00:13,  9.74it/s] 63%|██████▎   | 224/358 [00:22<00:13,  9.69it/s] 63%|██████▎   | 225/358 [00:22<00:13,  9.77it/s] 63%|██████▎   | 226/358 [00:23<00:13,  9.72it/s] 64%|██████▎   | 228/358 [00:23<00:13,  9.75it/s] 64%|██████▍   | 229/358 [00:23<00:13,  9.73it/s] 64%|██████▍   | 230/358 [00:23<00:13,  9.67it/s] 65%|██████▍   | 232/358 [00:23<00:12,  9.73it/s] 65%|██████▌   | 234/358 [00:23<00:12, 10.02it/s] 66%|██████▌   | 236/358 [00:24<00:12,  9.98it/s] 66%|██████▋   | 238/358 [00:24<00:11, 10.03it/s] 67%|██████▋   | 240/358 [00:24<00:11,  9.99it/s] 68%|██████▊   | 242/358 [00:24<00:11,  9.97it/s] 68%|██████▊   | 243/358 [00:24<00:11,  9.90it/s] 68%|██████▊   | 244/358 [00:24<00:11,  9.84it/s] 69%|██████▊   | 246/358 [00:25<00:11,  9.86it/s] 69%|██████▉   | 247/358 [00:25<00:11,  9.79it/s] 69%|██████▉   | 248/358 [00:25<00:11,  9.74it/s] 70%|██████▉   | 250/358 [00:25<00:10,  9.84it/s] 70%|███████   | 251/358 [00:25<00:10,  9.78it/s] 70%|███████   | 252/358 [00:25<00:10,  9.71it/s] 71%|███████   | 253/358 [00:25<00:10,  9.68it/s] 71%|███████   | 254/358 [00:25<00:10,  9.65it/s] 72%|███████▏  | 256/358 [00:26<00:10,  9.83it/s] 72%|███████▏  | 257/358 [00:26<00:10,  9.83it/s] 72%|███████▏  | 258/358 [00:26<00:10,  9.71it/s] 72%|███████▏  | 259/358 [00:26<00:10,  9.67it/s] 73%|███████▎  | 260/358 [00:26<00:10,  9.71it/s] 73%|███████▎  | 262/358 [00:26<00:09,  9.89it/s] 74%|███████▎  | 264/358 [00:26<00:09,  9.90it/s] 74%|███████▍  | 266/358 [00:27<00:09,  9.90it/s] 75%|███████▍  | 267/358 [00:27<00:09,  9.84it/s] 75%|███████▌  | 269/358 [00:27<00:08,  9.89it/s] 75%|███████▌  | 270/358 [00:27<00:08,  9.82it/s] 76%|███████▌  | 271/358 [00:27<00:08,  9.75it/s] 76%|███████▌  | 272/358 [00:27<00:08,  9.73it/s] 76%|███████▋  | 273/358 [00:27<00:08,  9.63it/s] 77%|███████▋  | 274/358 [00:27<00:08,  9.62it/s] 77%|███████▋  | 275/358 [00:28<00:08,  9.67it/s] 77%|███████▋  | 276/358 [00:28<00:08,  9.67it/s] 77%|███████▋  | 277/358 [00:28<00:08,  9.64it/s] 78%|███████▊  | 278/358 [00:28<00:08,  9.62it/s] 78%|███████▊  | 280/358 [00:28<00:07,  9.81it/s] 78%|███████▊  | 281/358 [00:28<00:07,  9.82it/s] 79%|███████▉  | 282/358 [00:28<00:07,  9.76it/s] 79%|███████▉  | 283/358 [00:28<00:07,  9.70it/s] 79%|███████▉  | 284/358 [00:28<00:07,  9.66it/s] 80%|███████▉  | 285/358 [00:29<00:07,  9.73it/s] 80%|███████▉  | 286/358 [00:29<00:07,  9.69it/s] 80%|████████  | 287/358 [00:29<00:07,  9.67it/s] 80%|████████  | 288/358 [00:29<00:07,  9.62it/s] 81%|████████  | 290/358 [00:29<00:06,  9.84it/s] 81%|████████▏ | 291/358 [00:29<00:06,  9.82it/s] 82%|████████▏ | 293/358 [00:29<00:06,  9.83it/s] 82%|████████▏ | 295/358 [00:30<00:06,  9.90it/s] 83%|████████▎ | 296/358 [00:30<00:06,  9.84it/s] 83%|████████▎ | 297/358 [00:30<00:06,  9.73it/s] 84%|████████▎ | 299/358 [00:30<00:05,  9.89it/s] 84%|████████▍ | 301/358 [00:30<00:05,  9.93it/s] 84%|████████▍ | 302/358 [00:30<00:05,  9.86it/s] 85%|████████▍ | 303/358 [00:30<00:05,  9.87it/s] 85%|████████▌ | 305/358 [00:31<00:05,  9.90it/s] 85%|████████▌ | 306/358 [00:31<00:05,  9.82it/s] 86%|████████▌ | 308/358 [00:31<00:05,  9.92it/s] 86%|████████▋ | 309/358 [00:31<00:04,  9.82it/s] 87%|████████▋ | 310/358 [00:31<00:04,  9.76it/s] 87%|████████▋ | 311/358 [00:31<00:04,  9.68it/s] 87%|████████▋ | 312/358 [00:31<00:04,  9.70it/s] 87%|████████▋ | 313/358 [00:31<00:04,  9.72it/s] 88%|████████▊ | 315/358 [00:32<00:04,  9.98it/s] 88%|████████▊ | 316/358 [00:32<00:04,  9.93it/s] 89%|████████▊ | 317/358 [00:32<00:04,  9.84it/s] 89%|████████▉ | 318/358 [00:32<00:04,  9.80it/s] 89%|████████▉ | 319/358 [00:32<00:04,  9.74it/s] 89%|████████▉ | 320/358 [00:32<00:03,  9.80it/s] 90%|████████▉ | 321/358 [00:32<00:03,  9.73it/s] 90%|████████▉ | 322/358 [00:32<00:03,  9.70it/s] 90%|█████████ | 323/358 [00:32<00:03,  9.65it/s] 91%|█████████ | 324/358 [00:33<00:03,  9.62it/s] 91%|█████████ | 325/358 [00:33<00:03,  9.60it/s] 91%|█████████▏| 327/358 [00:33<00:03,  9.96it/s] 92%|█████████▏| 329/358 [00:33<00:02, 10.06it/s] 92%|█████████▏| 330/358 [00:33<00:02,  9.95it/s] 93%|█████████▎| 332/358 [00:33<00:02, 10.05it/s] 93%|█████████▎| 334/358 [00:34<00:02,  9.96it/s] 94%|█████████▎| 335/358 [00:34<00:02,  9.83it/s] 94%|█████████▍| 337/358 [00:34<00:02,  9.91it/s] 95%|█████████▍| 339/358 [00:34<00:01, 10.11it/s] 95%|█████████▌| 341/358 [00:34<00:01, 10.05it/s] 96%|█████████▌| 343/358 [00:34<00:01,  9.89it/s] 96%|█████████▌| 344/358 [00:35<00:01,  9.83it/s] 96%|█████████▋| 345/358 [00:35<00:01,  9.85it/s] 97%|█████████▋| 346/358 [00:35<00:01,  9.88it/s] 97%|█████████▋| 348/358 [00:35<00:01,  9.96it/s] 97%|█████████▋| 349/358 [00:35<00:00,  9.88it/s] 98%|█████████▊| 350/358 [00:35<00:00,  9.80it/s] 98%|█████████▊| 351/358 [00:35<00:00,  9.75it/s] 99%|█████████▊| 353/358 [00:35<00:00,  9.92it/s] 99%|█████████▉| 354/358 [00:36<00:00,  9.90it/s] 99%|█████████▉| 355/358 [00:36<00:00,  9.81it/s]100%|█████████▉| 357/358 [00:36<00:00,  9.87it/s]100%|██████████| 358/358 [00:36<00:00,  9.82it/s]
[32m2025-02-05 05:24:57.123[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    gen_loss  grad clip ratio  grad norm   ppl
       2.487                1      3.544 12.03[0m
[32m2025-02-05 05:24:57.123[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m169[0m - [1m[Valid][0m
  0%|          | 0/10256 [00:00<?, ?it/s]100%|██████████| 10256/10256 [00:00<00:00, 1059239.66it/s]
[32m2025-02-05 05:24:57.133[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:26,  1.47it/s]  5%|▌         | 2/40 [00:01<00:25,  1.48it/s]  8%|▊         | 3/40 [00:02<00:24,  1.49it/s] 10%|█         | 4/40 [00:02<00:24,  1.48it/s] 12%|█▎        | 5/40 [00:03<00:23,  1.47it/s] 15%|█▌        | 6/40 [00:04<00:23,  1.47it/s] 18%|█▊        | 7/40 [00:04<00:22,  1.47it/s] 20%|██        | 8/40 [00:05<00:21,  1.48it/s] 22%|██▎       | 9/40 [00:06<00:21,  1.47it/s] 25%|██▌       | 10/40 [00:06<00:20,  1.47it/s] 28%|██▊       | 11/40 [00:07<00:19,  1.47it/s] 30%|███       | 12/40 [00:08<00:19,  1.47it/s] 32%|███▎      | 13/40 [00:08<00:18,  1.48it/s] 35%|███▌      | 14/40 [00:09<00:17,  1.47it/s] 38%|███▊      | 15/40 [00:10<00:17,  1.47it/s] 40%|████      | 16/40 [00:10<00:16,  1.46it/s] 42%|████▎     | 17/40 [00:11<00:15,  1.47it/s] 45%|████▌     | 18/40 [00:12<00:14,  1.47it/s] 48%|████▊     | 19/40 [00:12<00:14,  1.47it/s] 50%|█████     | 20/40 [00:13<00:13,  1.47it/s] 52%|█████▎    | 21/40 [00:14<00:12,  1.48it/s] 55%|█████▌    | 22/40 [00:14<00:12,  1.47it/s] 57%|█████▊    | 23/40 [00:15<00:11,  1.47it/s] 60%|██████    | 24/40 [00:16<00:10,  1.46it/s] 62%|██████▎   | 25/40 [00:16<00:10,  1.47it/s] 65%|██████▌   | 26/40 [00:17<00:09,  1.47it/s] 68%|██████▊   | 27/40 [00:18<00:08,  1.48it/s] 70%|███████   | 28/40 [00:19<00:08,  1.48it/s] 72%|███████▎  | 29/40 [00:19<00:07,  1.47it/s] 75%|███████▌  | 30/40 [00:20<00:06,  1.48it/s] 78%|███████▊  | 31/40 [00:21<00:06,  1.48it/s] 80%|████████  | 32/40 [00:21<00:05,  1.48it/s] 82%|████████▎ | 33/40 [00:22<00:04,  1.47it/s] 85%|████████▌ | 34/40 [00:23<00:04,  1.47it/s] 88%|████████▊ | 35/40 [00:23<00:03,  1.47it/s] 90%|█████████ | 36/40 [00:24<00:02,  1.46it/s] 92%|█████████▎| 37/40 [00:25<00:02,  1.47it/s] 95%|█████████▌| 38/40 [00:25<00:01,  1.46it/s] 98%|█████████▊| 39/40 [00:26<00:00,  1.46it/s]100%|██████████| 40/40 [00:26<00:00,  1.62it/s]100%|██████████| 40/40 [00:26<00:00,  1.48it/s]
[32m2025-02-05 05:25:24.116[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    average  bleu@1  bleu@2  bleu@3  bleu@4  dist@1  dist@2  dist@3  dist@4  extreme  \
      .7627   .2858   .1009  .04175  .02178  .03773   .2693   .5771   .7713    .5750   
      f1  gen_loss  greedy  intra_dist@1  intra_dist@2  intra_dist@3  intra_dist@4  \
   .3467     4.229   .6646         .8889         .9746         .9470         .8934   
     ppl  rouge1  rouge2  rougeL  
   68.63   .3831  .08632   .3694[0m
[32m2025-02-05 05:25:24.121[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m163[0m - [1m[Conversation epoch 16][0m
[32m2025-02-05 05:25:24.121[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m164[0m - [1m[Train][0m
  0%|          | 0/92414 [00:00<?, ?it/s]100%|██████████| 92414/92414 [00:00<00:00, 995741.80it/s]
[32m2025-02-05 05:25:24.215[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/358 [00:00<?, ?it/s]  0%|          | 1/358 [00:00<00:36,  9.73it/s]  1%|          | 3/358 [00:00<00:35,  9.91it/s]  1%|          | 4/358 [00:00<00:35,  9.89it/s]  2%|▏         | 6/358 [00:00<00:35,  9.86it/s]  2%|▏         | 7/358 [00:00<00:35,  9.79it/s]  2%|▏         | 8/358 [00:00<00:35,  9.84it/s]  3%|▎         | 9/358 [00:00<00:35,  9.74it/s]  3%|▎         | 10/358 [00:01<00:35,  9.73it/s]  3%|▎         | 11/358 [00:01<00:35,  9.69it/s]  4%|▎         | 13/358 [00:01<00:34,  9.90it/s]  4%|▍         | 14/358 [00:01<00:34,  9.83it/s]  4%|▍         | 15/358 [00:01<00:35,  9.75it/s]  4%|▍         | 16/358 [00:01<00:35,  9.69it/s]  5%|▍         | 17/358 [00:01<00:35,  9.71it/s]  5%|▌         | 18/358 [00:01<00:34,  9.79it/s]  5%|▌         | 19/358 [00:01<00:34,  9.71it/s]  6%|▌         | 20/358 [00:02<00:34,  9.66it/s]  6%|▌         | 21/358 [00:02<00:35,  9.59it/s]  6%|▌         | 22/358 [00:02<00:34,  9.66it/s]  7%|▋         | 24/358 [00:02<00:34,  9.76it/s]  7%|▋         | 25/358 [00:02<00:34,  9.71it/s]  7%|▋         | 26/358 [00:02<00:34,  9.66it/s]  8%|▊         | 27/358 [00:02<00:34,  9.71it/s]  8%|▊         | 28/358 [00:02<00:34,  9.67it/s]  8%|▊         | 29/358 [00:02<00:34,  9.64it/s]  9%|▊         | 31/358 [00:03<00:33,  9.74it/s]  9%|▉         | 32/358 [00:03<00:33,  9.74it/s]  9%|▉         | 34/358 [00:03<00:32,  9.83it/s] 10%|█         | 36/358 [00:03<00:32,  9.83it/s] 10%|█         | 37/358 [00:03<00:32,  9.82it/s] 11%|█         | 38/358 [00:03<00:32,  9.77it/s] 11%|█         | 40/358 [00:04<00:32,  9.93it/s] 11%|█▏        | 41/358 [00:04<00:32,  9.85it/s] 12%|█▏        | 43/358 [00:04<00:31,  9.87it/s] 13%|█▎        | 45/358 [00:04<00:31,  9.97it/s] 13%|█▎        | 47/358 [00:04<00:31,  9.94it/s] 13%|█▎        | 48/358 [00:04<00:31,  9.93it/s] 14%|█▍        | 50/358 [00:05<00:31,  9.90it/s] 14%|█▍        | 51/358 [00:05<00:31,  9.83it/s] 15%|█▍        | 52/358 [00:05<00:31,  9.74it/s] 15%|█▍        | 53/358 [00:05<00:31,  9.69it/s] 15%|█▌        | 54/358 [00:05<00:31,  9.73it/s] 15%|█▌        | 55/358 [00:05<00:31,  9.68it/s] 16%|█▌        | 56/358 [00:05<00:31,  9.72it/s] 16%|█▌        | 57/358 [00:05<00:31,  9.68it/s] 16%|█▌        | 58/358 [00:05<00:31,  9.66it/s] 16%|█▋        | 59/358 [00:06<00:31,  9.63it/s] 17%|█▋        | 61/358 [00:06<00:30,  9.71it/s] 17%|█▋        | 62/358 [00:06<00:30,  9.63it/s] 18%|█▊        | 63/358 [00:06<00:30,  9.69it/s] 18%|█▊        | 64/358 [00:06<00:30,  9.65it/s] 18%|█▊        | 66/358 [00:06<00:30,  9.72it/s] 19%|█▊        | 67/358 [00:06<00:29,  9.70it/s] 19%|█▉        | 69/358 [00:07<00:29,  9.77it/s] 20%|█▉        | 70/358 [00:07<00:29,  9.72it/s] 20%|█▉        | 71/358 [00:07<00:29,  9.76it/s] 20%|██        | 72/358 [00:07<00:29,  9.71it/s] 20%|██        | 73/358 [00:07<00:29,  9.68it/s] 21%|██        | 74/358 [00:07<00:29,  9.64it/s] 21%|██        | 75/358 [00:07<00:29,  9.61it/s] 21%|██        | 76/358 [00:07<00:29,  9.71it/s] 22%|██▏       | 77/358 [00:07<00:29,  9.68it/s] 22%|██▏       | 79/358 [00:08<00:28,  9.69it/s] 23%|██▎       | 81/358 [00:08<00:28,  9.75it/s] 23%|██▎       | 83/358 [00:08<00:28,  9.77it/s] 23%|██▎       | 84/358 [00:08<00:28,  9.72it/s] 24%|██▎       | 85/358 [00:08<00:28,  9.68it/s] 24%|██▍       | 86/358 [00:08<00:28,  9.66it/s] 24%|██▍       | 87/358 [00:08<00:28,  9.64it/s] 25%|██▍       | 88/358 [00:09<00:27,  9.66it/s] 25%|██▌       | 90/358 [00:09<00:27,  9.90it/s] 26%|██▌       | 92/358 [00:09<00:26, 10.00it/s] 26%|██▌       | 93/358 [00:09<00:26,  9.96it/s] 26%|██▋       | 94/358 [00:09<00:26,  9.87it/s] 27%|██▋       | 96/358 [00:09<00:25, 10.15it/s] 27%|██▋       | 98/358 [00:10<00:25, 10.04it/s] 28%|██▊       | 99/358 [00:10<00:26,  9.95it/s] 28%|██▊       | 101/358 [00:10<00:25,  9.92it/s] 29%|██▉       | 103/358 [00:10<00:25,  9.90it/s] 29%|██▉       | 104/358 [00:10<00:25,  9.85it/s] 29%|██▉       | 105/358 [00:10<00:25,  9.77it/s] 30%|██▉       | 106/358 [00:10<00:25,  9.76it/s] 30%|███       | 108/358 [00:11<00:25,  9.79it/s] 30%|███       | 109/358 [00:11<00:25,  9.70it/s] 31%|███       | 110/358 [00:11<00:25,  9.68it/s] 31%|███       | 111/358 [00:11<00:25,  9.64it/s] 32%|███▏      | 113/358 [00:11<00:24,  9.91it/s] 32%|███▏      | 114/358 [00:11<00:24,  9.87it/s] 32%|███▏      | 115/358 [00:11<00:24,  9.77it/s] 32%|███▏      | 116/358 [00:11<00:24,  9.68it/s] 33%|███▎      | 117/358 [00:11<00:24,  9.65it/s] 33%|███▎      | 119/358 [00:12<00:24,  9.77it/s] 34%|███▍      | 121/358 [00:12<00:23,  9.97it/s] 34%|███▍      | 123/358 [00:12<00:23, 10.07it/s] 35%|███▍      | 125/358 [00:12<00:23, 10.05it/s] 35%|███▌      | 126/358 [00:12<00:23, 10.00it/s] 35%|███▌      | 127/358 [00:12<00:23,  9.96it/s] 36%|███▌      | 128/358 [00:13<00:23,  9.91it/s] 36%|███▋      | 130/358 [00:13<00:22,  9.97it/s] 37%|███▋      | 131/358 [00:13<00:22,  9.87it/s] 37%|███▋      | 132/358 [00:13<00:22,  9.89it/s] 37%|███▋      | 134/358 [00:13<00:22,  9.92it/s] 38%|███▊      | 135/358 [00:13<00:22,  9.86it/s] 38%|███▊      | 137/358 [00:13<00:22,  9.95it/s] 39%|███▊      | 138/358 [00:14<00:22,  9.93it/s] 39%|███▉      | 139/358 [00:14<00:22,  9.85it/s] 39%|███▉      | 141/358 [00:14<00:21,  9.97it/s] 40%|███▉      | 142/358 [00:14<00:21,  9.89it/s] 40%|███▉      | 143/358 [00:14<00:21,  9.86it/s] 40%|████      | 144/358 [00:14<00:21,  9.77it/s] 41%|████      | 145/358 [00:14<00:21,  9.79it/s] 41%|████      | 146/358 [00:14<00:21,  9.73it/s] 41%|████      | 147/358 [00:14<00:21,  9.67it/s] 41%|████▏     | 148/358 [00:15<00:21,  9.70it/s] 42%|████▏     | 149/358 [00:15<00:21,  9.68it/s] 42%|████▏     | 150/358 [00:15<00:21,  9.64it/s] 42%|████▏     | 151/358 [00:15<00:22,  9.38it/s] 42%|████▏     | 152/358 [00:15<00:21,  9.42it/s] 43%|████▎     | 153/358 [00:15<00:21,  9.44it/s] 43%|████▎     | 154/358 [00:15<00:21,  9.52it/s] 43%|████▎     | 155/358 [00:15<00:21,  9.54it/s] 44%|████▎     | 156/358 [00:15<00:20,  9.67it/s] 44%|████▍     | 157/358 [00:16<00:20,  9.61it/s] 44%|████▍     | 158/358 [00:16<00:20,  9.69it/s] 44%|████▍     | 159/358 [00:16<00:20,  9.69it/s] 45%|████▍     | 160/358 [00:16<00:20,  9.70it/s] 45%|████▌     | 162/358 [00:16<00:19, 10.00it/s] 46%|████▌     | 164/358 [00:16<00:19,  9.99it/s] 46%|████▌     | 165/358 [00:16<00:19,  9.95it/s] 47%|████▋     | 167/358 [00:17<00:19,  9.90it/s] 47%|████▋     | 169/358 [00:17<00:19,  9.94it/s] 48%|████▊     | 171/358 [00:17<00:18,  9.92it/s] 48%|████▊     | 172/358 [00:17<00:18,  9.86it/s] 48%|████▊     | 173/358 [00:17<00:18,  9.80it/s] 49%|████▉     | 175/358 [00:17<00:18,  9.82it/s] 49%|████▉     | 176/358 [00:17<00:18,  9.84it/s] 49%|████▉     | 177/358 [00:18<00:18,  9.82it/s] 50%|█████     | 179/358 [00:18<00:18,  9.85it/s] 50%|█████     | 180/358 [00:18<00:18,  9.78it/s] 51%|█████     | 182/358 [00:18<00:17,  9.92it/s] 51%|█████     | 183/358 [00:18<00:17,  9.88it/s] 51%|█████▏    | 184/358 [00:18<00:17,  9.77it/s] 52%|█████▏    | 185/358 [00:18<00:17,  9.71it/s] 52%|█████▏    | 187/358 [00:19<00:17,  9.93it/s] 53%|█████▎    | 188/358 [00:19<00:17,  9.88it/s] 53%|█████▎    | 189/358 [00:19<00:17,  9.82it/s] 53%|█████▎    | 191/358 [00:19<00:17,  9.74it/s] 54%|█████▎    | 192/358 [00:19<00:17,  9.69it/s] 54%|█████▍    | 193/358 [00:19<00:17,  9.69it/s] 54%|█████▍    | 194/358 [00:19<00:16,  9.66it/s] 54%|█████▍    | 195/358 [00:19<00:16,  9.73it/s] 55%|█████▌    | 197/358 [00:20<00:16,  9.90it/s] 55%|█████▌    | 198/358 [00:20<00:16,  9.83it/s] 56%|█████▌    | 199/358 [00:20<00:16,  9.86it/s] 56%|█████▌    | 200/358 [00:20<00:16,  9.79it/s] 56%|█████▌    | 201/358 [00:20<00:16,  9.75it/s] 57%|█████▋    | 203/358 [00:20<00:15,  9.84it/s] 57%|█████▋    | 204/358 [00:20<00:15,  9.74it/s] 57%|█████▋    | 205/358 [00:20<00:15,  9.70it/s] 58%|█████▊    | 207/358 [00:21<00:15,  9.87it/s] 58%|█████▊    | 208/358 [00:21<00:15,  9.80it/s] 59%|█████▊    | 210/358 [00:21<00:15,  9.81it/s] 59%|█████▉    | 212/358 [00:21<00:14,  9.81it/s] 60%|█████▉    | 214/358 [00:21<00:14,  9.88it/s] 60%|██████    | 215/358 [00:21<00:14,  9.82it/s] 60%|██████    | 216/358 [00:22<00:14,  9.76it/s] 61%|██████    | 217/358 [00:22<00:14,  9.79it/s] 61%|██████    | 218/358 [00:22<00:14,  9.76it/s] 61%|██████    | 219/358 [00:22<00:14,  9.76it/s] 62%|██████▏   | 221/358 [00:22<00:13,  9.90it/s] 62%|██████▏   | 222/358 [00:22<00:13,  9.79it/s] 62%|██████▏   | 223/358 [00:22<00:13,  9.74it/s] 63%|██████▎   | 224/358 [00:22<00:13,  9.68it/s] 63%|██████▎   | 225/358 [00:22<00:13,  9.76it/s] 63%|██████▎   | 226/358 [00:23<00:13,  9.71it/s] 64%|██████▎   | 228/358 [00:23<00:13,  9.74it/s] 64%|██████▍   | 229/358 [00:23<00:13,  9.72it/s] 64%|██████▍   | 230/358 [00:23<00:13,  9.66it/s] 65%|██████▍   | 232/358 [00:23<00:12,  9.72it/s] 65%|██████▌   | 234/358 [00:23<00:12, 10.01it/s] 66%|██████▌   | 236/358 [00:24<00:12,  9.97it/s] 66%|██████▋   | 238/358 [00:24<00:11, 10.02it/s] 67%|██████▋   | 240/358 [00:24<00:11,  9.98it/s] 68%|██████▊   | 242/358 [00:24<00:11,  9.96it/s] 68%|██████▊   | 243/358 [00:24<00:11,  9.90it/s] 68%|██████▊   | 244/358 [00:24<00:11,  9.84it/s] 69%|██████▊   | 246/358 [00:25<00:11,  9.86it/s] 69%|██████▉   | 247/358 [00:25<00:11,  9.79it/s] 69%|██████▉   | 248/358 [00:25<00:11,  9.74it/s] 70%|██████▉   | 250/358 [00:25<00:10,  9.84it/s] 70%|███████   | 251/358 [00:25<00:10,  9.78it/s] 70%|███████   | 252/358 [00:25<00:10,  9.72it/s] 71%|███████   | 253/358 [00:25<00:10,  9.67it/s] 71%|███████   | 254/358 [00:25<00:10,  9.65it/s] 72%|███████▏  | 256/358 [00:26<00:10,  9.82it/s] 72%|███████▏  | 257/358 [00:26<00:10,  9.83it/s] 72%|███████▏  | 258/358 [00:26<00:10,  9.70it/s] 72%|███████▏  | 259/358 [00:26<00:10,  9.67it/s] 73%|███████▎  | 260/358 [00:26<00:10,  9.71it/s] 73%|███████▎  | 262/358 [00:26<00:09,  9.88it/s] 74%|███████▎  | 264/358 [00:26<00:09,  9.90it/s] 74%|███████▍  | 266/358 [00:27<00:09,  9.89it/s] 75%|███████▍  | 267/358 [00:27<00:09,  9.83it/s] 75%|███████▌  | 269/358 [00:27<00:09,  9.89it/s] 75%|███████▌  | 270/358 [00:27<00:08,  9.82it/s] 76%|███████▌  | 271/358 [00:27<00:08,  9.74it/s] 76%|███████▌  | 272/358 [00:27<00:08,  9.72it/s] 76%|███████▋  | 273/358 [00:27<00:08,  9.62it/s] 77%|███████▋  | 274/358 [00:27<00:08,  9.62it/s] 77%|███████▋  | 275/358 [00:28<00:08,  9.67it/s] 77%|███████▋  | 276/358 [00:28<00:08,  9.67it/s] 77%|███████▋  | 277/358 [00:28<00:08,  9.64it/s] 78%|███████▊  | 278/358 [00:28<00:08,  9.62it/s] 78%|███████▊  | 280/358 [00:28<00:07,  9.81it/s] 78%|███████▊  | 281/358 [00:28<00:07,  9.82it/s] 79%|███████▉  | 282/358 [00:28<00:07,  9.76it/s] 79%|███████▉  | 283/358 [00:28<00:07,  9.70it/s] 79%|███████▉  | 284/358 [00:28<00:07,  9.66it/s] 80%|███████▉  | 285/358 [00:29<00:07,  9.73it/s] 80%|███████▉  | 286/358 [00:29<00:07,  9.69it/s] 80%|████████  | 287/358 [00:29<00:07,  9.66it/s] 80%|████████  | 288/358 [00:29<00:07,  9.62it/s] 81%|████████  | 290/358 [00:29<00:06,  9.83it/s] 81%|████████▏ | 291/358 [00:29<00:06,  9.82it/s] 82%|████████▏ | 293/358 [00:29<00:06,  9.83it/s] 82%|████████▏ | 295/358 [00:30<00:06,  9.90it/s] 83%|████████▎ | 296/358 [00:30<00:06,  9.84it/s] 83%|████████▎ | 297/358 [00:30<00:06,  9.73it/s] 84%|████████▎ | 299/358 [00:30<00:05,  9.89it/s] 84%|████████▍ | 301/358 [00:30<00:05,  9.92it/s] 84%|████████▍ | 302/358 [00:30<00:05,  9.86it/s] 85%|████████▍ | 303/358 [00:30<00:05,  9.86it/s] 85%|████████▌ | 305/358 [00:31<00:05,  9.89it/s] 85%|████████▌ | 306/358 [00:31<00:05,  9.81it/s] 86%|████████▌ | 308/358 [00:31<00:05,  9.91it/s] 86%|████████▋ | 309/358 [00:31<00:04,  9.81it/s] 87%|████████▋ | 310/358 [00:31<00:04,  9.76it/s] 87%|████████▋ | 311/358 [00:31<00:04,  9.68it/s] 87%|████████▋ | 312/358 [00:31<00:04,  9.70it/s] 87%|████████▋ | 313/358 [00:31<00:04,  9.72it/s] 88%|████████▊ | 315/358 [00:32<00:04,  9.97it/s] 88%|████████▊ | 316/358 [00:32<00:04,  9.91it/s] 89%|████████▊ | 317/358 [00:32<00:04,  9.83it/s] 89%|████████▉ | 318/358 [00:32<00:04,  9.79it/s] 89%|████████▉ | 319/358 [00:32<00:04,  9.74it/s] 89%|████████▉ | 320/358 [00:32<00:03,  9.80it/s] 90%|████████▉ | 321/358 [00:32<00:03,  9.72it/s] 90%|████████▉ | 322/358 [00:32<00:03,  9.69it/s] 90%|█████████ | 323/358 [00:32<00:03,  9.64it/s] 91%|█████████ | 324/358 [00:33<00:03,  9.61it/s] 91%|█████████ | 325/358 [00:33<00:03,  9.59it/s] 91%|█████████▏| 327/358 [00:33<00:03,  9.96it/s] 92%|█████████▏| 329/358 [00:33<00:02, 10.06it/s] 92%|█████████▏| 330/358 [00:33<00:02,  9.95it/s] 93%|█████████▎| 332/358 [00:33<00:02, 10.05it/s] 93%|█████████▎| 334/358 [00:34<00:02,  9.95it/s] 94%|█████████▎| 335/358 [00:34<00:02,  9.83it/s] 94%|█████████▍| 337/358 [00:34<00:02,  9.90it/s] 95%|█████████▍| 339/358 [00:34<00:01, 10.11it/s] 95%|█████████▌| 341/358 [00:34<00:01, 10.05it/s] 96%|█████████▌| 343/358 [00:34<00:01,  9.89it/s] 96%|█████████▌| 344/358 [00:35<00:01,  9.83it/s] 96%|█████████▋| 345/358 [00:35<00:01,  9.85it/s] 97%|█████████▋| 346/358 [00:35<00:01,  9.89it/s] 97%|█████████▋| 348/358 [00:35<00:01,  9.97it/s] 97%|█████████▋| 349/358 [00:35<00:00,  9.89it/s] 98%|█████████▊| 350/358 [00:35<00:00,  9.81it/s] 98%|█████████▊| 351/358 [00:35<00:00,  9.75it/s] 99%|█████████▊| 353/358 [00:35<00:00,  9.92it/s] 99%|█████████▉| 354/358 [00:36<00:00,  9.90it/s] 99%|█████████▉| 355/358 [00:36<00:00,  9.81it/s]100%|█████████▉| 357/358 [00:36<00:00,  9.86it/s]100%|██████████| 358/358 [00:36<00:00,  9.82it/s]
[32m2025-02-05 05:26:00.694[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    gen_loss  grad clip ratio  grad norm  ppl
       2.451                1      4.106 11.6[0m
[32m2025-02-05 05:26:00.694[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m169[0m - [1m[Valid][0m
  0%|          | 0/10256 [00:00<?, ?it/s]100%|██████████| 10256/10256 [00:00<00:00, 1100623.83it/s]
[32m2025-02-05 05:26:00.704[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:26,  1.47it/s]  5%|▌         | 2/40 [00:01<00:25,  1.48it/s]  8%|▊         | 3/40 [00:02<00:24,  1.50it/s] 10%|█         | 4/40 [00:02<00:24,  1.49it/s] 12%|█▎        | 5/40 [00:03<00:23,  1.48it/s] 15%|█▌        | 6/40 [00:04<00:22,  1.48it/s] 18%|█▊        | 7/40 [00:04<00:22,  1.48it/s] 20%|██        | 8/40 [00:05<00:21,  1.48it/s] 22%|██▎       | 9/40 [00:06<00:20,  1.48it/s] 25%|██▌       | 10/40 [00:06<00:20,  1.48it/s] 28%|██▊       | 11/40 [00:07<00:19,  1.48it/s] 30%|███       | 12/40 [00:08<00:18,  1.48it/s] 32%|███▎      | 13/40 [00:08<00:18,  1.48it/s] 35%|███▌      | 14/40 [00:09<00:17,  1.48it/s] 38%|███▊      | 15/40 [00:10<00:16,  1.48it/s] 40%|████      | 16/40 [00:10<00:16,  1.48it/s] 42%|████▎     | 17/40 [00:11<00:15,  1.48it/s] 45%|████▌     | 18/40 [00:12<00:14,  1.48it/s] 48%|████▊     | 19/40 [00:12<00:14,  1.48it/s] 50%|█████     | 20/40 [00:13<00:13,  1.48it/s] 52%|█████▎    | 21/40 [00:14<00:12,  1.48it/s] 55%|█████▌    | 22/40 [00:14<00:12,  1.48it/s] 57%|█████▊    | 23/40 [00:15<00:11,  1.48it/s] 60%|██████    | 24/40 [00:16<00:10,  1.47it/s] 62%|██████▎   | 25/40 [00:16<00:10,  1.48it/s] 65%|██████▌   | 26/40 [00:17<00:09,  1.49it/s] 68%|██████▊   | 27/40 [00:18<00:08,  1.48it/s] 70%|███████   | 28/40 [00:18<00:08,  1.48it/s] 72%|███████▎  | 29/40 [00:19<00:07,  1.49it/s] 75%|███████▌  | 30/40 [00:20<00:06,  1.49it/s] 78%|███████▊  | 31/40 [00:20<00:06,  1.49it/s] 80%|████████  | 32/40 [00:21<00:05,  1.48it/s] 82%|████████▎ | 33/40 [00:22<00:04,  1.48it/s] 85%|████████▌ | 34/40 [00:22<00:04,  1.49it/s] 88%|████████▊ | 35/40 [00:23<00:03,  1.48it/s] 90%|█████████ | 36/40 [00:24<00:02,  1.47it/s] 92%|█████████▎| 37/40 [00:24<00:02,  1.48it/s] 95%|█████████▌| 38/40 [00:25<00:01,  1.47it/s] 98%|█████████▊| 39/40 [00:26<00:00,  1.47it/s]100%|██████████| 40/40 [00:26<00:00,  1.63it/s]100%|██████████| 40/40 [00:26<00:00,  1.49it/s]
[32m2025-02-05 05:26:27.519[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    average  bleu@1  bleu@2  bleu@3  bleu@4  dist@1  dist@2  dist@3  dist@4  extreme  \
      .7652   .2841  .09687  .04175  .02235  .04254   .2930   .5957   .7865    .5788   
      f1  gen_loss  greedy  intra_dist@1  intra_dist@2  intra_dist@3  intra_dist@4  \
   .3496     4.241   .6638         .9085         .9822         .9504         .8844   
     ppl  rouge1  rouge2  rougeL  
   69.51   .3796   .0838   .3676[0m
[32m2025-02-05 05:26:27.524[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m163[0m - [1m[Conversation epoch 17][0m
[32m2025-02-05 05:26:27.524[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m164[0m - [1m[Train][0m
  0%|          | 0/92414 [00:00<?, ?it/s]100%|██████████| 92414/92414 [00:00<00:00, 990636.81it/s]
[32m2025-02-05 05:26:27.618[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/358 [00:00<?, ?it/s]  0%|          | 1/358 [00:00<00:36,  9.74it/s]  1%|          | 3/358 [00:00<00:35,  9.92it/s]  1%|          | 4/358 [00:00<00:35,  9.90it/s]  2%|▏         | 6/358 [00:00<00:35,  9.86it/s]  2%|▏         | 7/358 [00:00<00:35,  9.79it/s]  2%|▏         | 8/358 [00:00<00:35,  9.84it/s]  3%|▎         | 9/358 [00:00<00:35,  9.74it/s]  3%|▎         | 10/358 [00:01<00:35,  9.74it/s]  3%|▎         | 11/358 [00:01<00:35,  9.69it/s]  4%|▎         | 13/358 [00:01<00:34,  9.90it/s]  4%|▍         | 14/358 [00:01<00:34,  9.83it/s]  4%|▍         | 15/358 [00:01<00:35,  9.76it/s]  4%|▍         | 16/358 [00:01<00:35,  9.69it/s]  5%|▍         | 17/358 [00:01<00:35,  9.71it/s]  5%|▌         | 18/358 [00:01<00:34,  9.79it/s]  5%|▌         | 19/358 [00:01<00:34,  9.72it/s]  6%|▌         | 20/358 [00:02<00:34,  9.66it/s]  6%|▌         | 21/358 [00:02<00:35,  9.59it/s]  6%|▌         | 22/358 [00:02<00:34,  9.66it/s]  7%|▋         | 24/358 [00:02<00:34,  9.76it/s]  7%|▋         | 25/358 [00:02<00:34,  9.71it/s]  7%|▋         | 26/358 [00:02<00:34,  9.66it/s]  8%|▊         | 27/358 [00:02<00:34,  9.71it/s]  8%|▊         | 28/358 [00:02<00:34,  9.67it/s]  8%|▊         | 29/358 [00:02<00:34,  9.64it/s]  9%|▊         | 31/358 [00:03<00:33,  9.74it/s]  9%|▉         | 32/358 [00:03<00:33,  9.73it/s]  9%|▉         | 34/358 [00:03<00:32,  9.83it/s] 10%|█         | 36/358 [00:03<00:32,  9.83it/s] 10%|█         | 37/358 [00:03<00:32,  9.82it/s] 11%|█         | 38/358 [00:03<00:32,  9.77it/s] 11%|█         | 40/358 [00:04<00:32,  9.93it/s] 11%|█▏        | 41/358 [00:04<00:32,  9.84it/s] 12%|█▏        | 43/358 [00:04<00:31,  9.87it/s] 13%|█▎        | 45/358 [00:04<00:31,  9.97it/s] 13%|█▎        | 47/358 [00:04<00:31,  9.94it/s] 13%|█▎        | 48/358 [00:04<00:31,  9.93it/s] 14%|█▍        | 50/358 [00:05<00:31,  9.90it/s] 14%|█▍        | 51/358 [00:05<00:31,  9.83it/s] 15%|█▍        | 52/358 [00:05<00:31,  9.74it/s] 15%|█▍        | 53/358 [00:05<00:31,  9.69it/s] 15%|█▌        | 54/358 [00:05<00:31,  9.73it/s] 15%|█▌        | 55/358 [00:05<00:31,  9.68it/s] 16%|█▌        | 56/358 [00:05<00:31,  9.72it/s] 16%|█▌        | 57/358 [00:05<00:31,  9.69it/s] 16%|█▌        | 58/358 [00:05<00:31,  9.66it/s] 16%|█▋        | 59/358 [00:06<00:31,  9.63it/s] 17%|█▋        | 61/358 [00:06<00:30,  9.71it/s] 17%|█▋        | 62/358 [00:06<00:30,  9.63it/s] 18%|█▊        | 63/358 [00:06<00:30,  9.70it/s] 18%|█▊        | 64/358 [00:06<00:30,  9.65it/s] 18%|█▊        | 66/358 [00:06<00:30,  9.72it/s] 19%|█▊        | 67/358 [00:06<00:29,  9.71it/s] 19%|█▉        | 69/358 [00:07<00:29,  9.77it/s] 20%|█▉        | 70/358 [00:07<00:29,  9.71it/s] 20%|█▉        | 71/358 [00:07<00:29,  9.76it/s] 20%|██        | 72/358 [00:07<00:29,  9.71it/s] 20%|██        | 73/358 [00:07<00:29,  9.68it/s] 21%|██        | 74/358 [00:07<00:29,  9.65it/s] 21%|██        | 75/358 [00:07<00:29,  9.61it/s] 21%|██        | 76/358 [00:07<00:29,  9.71it/s] 22%|██▏       | 77/358 [00:07<00:29,  9.68it/s] 22%|██▏       | 79/358 [00:08<00:28,  9.69it/s] 23%|██▎       | 81/358 [00:08<00:28,  9.75it/s] 23%|██▎       | 83/358 [00:08<00:28,  9.77it/s] 23%|██▎       | 84/358 [00:08<00:28,  9.72it/s] 24%|██▎       | 85/358 [00:08<00:28,  9.68it/s] 24%|██▍       | 86/358 [00:08<00:28,  9.66it/s] 24%|██▍       | 87/358 [00:08<00:28,  9.64it/s] 25%|██▍       | 88/358 [00:09<00:27,  9.66it/s] 25%|██▌       | 90/358 [00:09<00:27,  9.90it/s] 26%|██▌       | 92/358 [00:09<00:26,  9.99it/s] 26%|██▌       | 93/358 [00:09<00:26,  9.96it/s] 26%|██▋       | 94/358 [00:09<00:26,  9.87it/s] 27%|██▋       | 96/358 [00:09<00:25, 10.15it/s] 27%|██▋       | 98/358 [00:10<00:25, 10.04it/s] 28%|██▊       | 99/358 [00:10<00:26,  9.95it/s] 28%|██▊       | 101/358 [00:10<00:25,  9.92it/s] 29%|██▉       | 103/358 [00:10<00:25,  9.91it/s] 29%|██▉       | 104/358 [00:10<00:25,  9.86it/s] 29%|██▉       | 105/358 [00:10<00:25,  9.78it/s] 30%|██▉       | 106/358 [00:10<00:25,  9.76it/s] 30%|███       | 108/358 [00:11<00:25,  9.79it/s] 30%|███       | 109/358 [00:11<00:25,  9.71it/s] 31%|███       | 110/358 [00:11<00:25,  9.69it/s] 31%|███       | 111/358 [00:11<00:25,  9.64it/s] 32%|███▏      | 113/358 [00:11<00:24,  9.90it/s] 32%|███▏      | 114/358 [00:11<00:24,  9.86it/s] 32%|███▏      | 115/358 [00:11<00:24,  9.77it/s] 32%|███▏      | 116/358 [00:11<00:24,  9.68it/s] 33%|███▎      | 117/358 [00:11<00:24,  9.66it/s] 33%|███▎      | 119/358 [00:12<00:24,  9.78it/s] 34%|███▍      | 121/358 [00:12<00:23,  9.97it/s] 34%|███▍      | 123/358 [00:12<00:23, 10.07it/s] 35%|███▍      | 125/358 [00:12<00:23, 10.05it/s] 35%|███▌      | 126/358 [00:12<00:23, 10.01it/s] 35%|███▌      | 127/358 [00:12<00:23,  9.96it/s] 36%|███▌      | 128/358 [00:13<00:23,  9.91it/s] 36%|███▋      | 130/358 [00:13<00:22,  9.98it/s] 37%|███▋      | 131/358 [00:13<00:22,  9.88it/s] 37%|███▋      | 132/358 [00:13<00:22,  9.90it/s] 37%|███▋      | 134/358 [00:13<00:22,  9.92it/s] 38%|███▊      | 135/358 [00:13<00:22,  9.86it/s] 38%|███▊      | 137/358 [00:13<00:22,  9.95it/s] 39%|███▊      | 138/358 [00:14<00:22,  9.93it/s] 39%|███▉      | 139/358 [00:14<00:22,  9.85it/s] 39%|███▉      | 141/358 [00:14<00:21,  9.97it/s] 40%|███▉      | 142/358 [00:14<00:21,  9.89it/s] 40%|███▉      | 143/358 [00:14<00:21,  9.86it/s] 40%|████      | 144/358 [00:14<00:21,  9.78it/s] 41%|████      | 145/358 [00:14<00:21,  9.80it/s] 41%|████      | 146/358 [00:14<00:21,  9.73it/s] 41%|████      | 147/358 [00:14<00:21,  9.67it/s] 41%|████▏     | 148/358 [00:15<00:21,  9.70it/s] 42%|████▏     | 149/358 [00:15<00:21,  9.68it/s] 42%|████▏     | 150/358 [00:15<00:21,  9.63it/s] 42%|████▏     | 151/358 [00:15<00:22,  9.37it/s] 42%|████▏     | 152/358 [00:15<00:21,  9.42it/s] 43%|████▎     | 153/358 [00:15<00:21,  9.43it/s] 43%|████▎     | 154/358 [00:15<00:21,  9.53it/s] 43%|████▎     | 155/358 [00:15<00:21,  9.54it/s] 44%|████▎     | 156/358 [00:15<00:20,  9.67it/s] 44%|████▍     | 157/358 [00:16<00:20,  9.61it/s] 44%|████▍     | 158/358 [00:16<00:20,  9.69it/s] 44%|████▍     | 159/358 [00:16<00:20,  9.69it/s] 45%|████▍     | 160/358 [00:16<00:20,  9.70it/s] 45%|████▌     | 162/358 [00:16<00:19,  9.99it/s] 46%|████▌     | 164/358 [00:16<00:19,  9.99it/s] 46%|████▌     | 165/358 [00:16<00:19,  9.95it/s] 47%|████▋     | 167/358 [00:17<00:19,  9.90it/s] 47%|████▋     | 169/358 [00:17<00:19,  9.94it/s] 48%|████▊     | 171/358 [00:17<00:18,  9.92it/s] 48%|████▊     | 172/358 [00:17<00:18,  9.86it/s] 48%|████▊     | 173/358 [00:17<00:18,  9.80it/s] 49%|████▉     | 175/358 [00:17<00:18,  9.82it/s] 49%|████▉     | 176/358 [00:17<00:18,  9.84it/s] 49%|████▉     | 177/358 [00:18<00:18,  9.82it/s] 50%|█████     | 179/358 [00:18<00:18,  9.85it/s] 50%|█████     | 180/358 [00:18<00:18,  9.78it/s] 51%|█████     | 182/358 [00:18<00:17,  9.92it/s] 51%|█████     | 183/358 [00:18<00:17,  9.88it/s] 51%|█████▏    | 184/358 [00:18<00:17,  9.77it/s] 52%|█████▏    | 185/358 [00:18<00:17,  9.71it/s] 52%|█████▏    | 187/358 [00:19<00:17,  9.93it/s] 53%|█████▎    | 188/358 [00:19<00:17,  9.88it/s] 53%|█████▎    | 189/358 [00:19<00:17,  9.82it/s] 53%|█████▎    | 190/358 [00:19<00:17,  9.86it/s] 53%|█████▎    | 191/358 [00:19<00:17,  9.69it/s] 54%|█████▎    | 192/358 [00:19<00:17,  9.64it/s] 54%|█████▍    | 193/358 [00:19<00:17,  9.65it/s] 54%|█████▍    | 194/358 [00:19<00:17,  9.64it/s] 54%|█████▍    | 195/358 [00:19<00:16,  9.72it/s] 55%|█████▌    | 197/358 [00:20<00:16,  9.90it/s] 55%|█████▌    | 198/358 [00:20<00:16,  9.83it/s] 56%|█████▌    | 199/358 [00:20<00:16,  9.86it/s] 56%|█████▌    | 200/358 [00:20<00:16,  9.79it/s] 56%|█████▌    | 201/358 [00:20<00:16,  9.75it/s] 57%|█████▋    | 203/358 [00:20<00:15,  9.84it/s] 57%|█████▋    | 204/358 [00:20<00:15,  9.74it/s] 57%|█████▋    | 205/358 [00:20<00:15,  9.69it/s] 58%|█████▊    | 207/358 [00:21<00:15,  9.86it/s] 58%|█████▊    | 208/358 [00:21<00:15,  9.79it/s] 59%|█████▊    | 210/358 [00:21<00:15,  9.81it/s] 59%|█████▉    | 212/358 [00:21<00:14,  9.80it/s] 60%|█████▉    | 214/358 [00:21<00:14,  9.88it/s] 60%|██████    | 215/358 [00:21<00:14,  9.82it/s] 60%|██████    | 216/358 [00:22<00:14,  9.76it/s] 61%|██████    | 217/358 [00:22<00:14,  9.79it/s] 61%|██████    | 218/358 [00:22<00:14,  9.76it/s] 61%|██████    | 219/358 [00:22<00:14,  9.76it/s] 62%|██████▏   | 221/358 [00:22<00:13,  9.90it/s] 62%|██████▏   | 222/358 [00:22<00:13,  9.79it/s] 62%|██████▏   | 223/358 [00:22<00:13,  9.73it/s] 63%|██████▎   | 224/358 [00:22<00:13,  9.68it/s] 63%|██████▎   | 225/358 [00:22<00:13,  9.76it/s] 63%|██████▎   | 226/358 [00:23<00:13,  9.71it/s] 64%|██████▎   | 228/358 [00:23<00:13,  9.74it/s] 64%|██████▍   | 229/358 [00:23<00:13,  9.72it/s] 64%|██████▍   | 230/358 [00:23<00:13,  9.67it/s] 65%|██████▍   | 232/358 [00:23<00:12,  9.72it/s] 65%|██████▌   | 234/358 [00:23<00:12, 10.01it/s] 66%|██████▌   | 236/358 [00:24<00:12,  9.97it/s] 66%|██████▋   | 238/358 [00:24<00:11, 10.03it/s] 67%|██████▋   | 240/358 [00:24<00:11,  9.99it/s] 68%|██████▊   | 242/358 [00:24<00:11,  9.97it/s] 68%|██████▊   | 243/358 [00:24<00:11,  9.90it/s] 68%|██████▊   | 244/358 [00:24<00:11,  9.84it/s] 69%|██████▊   | 246/358 [00:25<00:11,  9.86it/s] 69%|██████▉   | 247/358 [00:25<00:11,  9.79it/s] 69%|██████▉   | 248/358 [00:25<00:11,  9.74it/s] 70%|██████▉   | 250/358 [00:25<00:10,  9.83it/s] 70%|███████   | 251/358 [00:25<00:10,  9.78it/s] 70%|███████   | 252/358 [00:25<00:10,  9.71it/s] 71%|███████   | 253/358 [00:25<00:10,  9.67it/s] 71%|███████   | 254/358 [00:25<00:10,  9.65it/s] 72%|███████▏  | 256/358 [00:26<00:10,  9.82it/s] 72%|███████▏  | 257/358 [00:26<00:10,  9.82it/s] 72%|███████▏  | 258/358 [00:26<00:10,  9.69it/s] 72%|███████▏  | 259/358 [00:26<00:10,  9.66it/s] 73%|███████▎  | 260/358 [00:26<00:10,  9.70it/s] 73%|███████▎  | 262/358 [00:26<00:09,  9.88it/s] 74%|███████▎  | 264/358 [00:26<00:09,  9.90it/s] 74%|███████▍  | 266/358 [00:27<00:09,  9.89it/s] 75%|███████▍  | 267/358 [00:27<00:09,  9.83it/s] 75%|███████▌  | 269/358 [00:27<00:08,  9.89it/s] 75%|███████▌  | 270/358 [00:27<00:08,  9.82it/s] 76%|███████▌  | 271/358 [00:27<00:08,  9.74it/s] 76%|███████▌  | 272/358 [00:27<00:08,  9.72it/s] 76%|███████▋  | 273/358 [00:27<00:08,  9.62it/s] 77%|███████▋  | 274/358 [00:27<00:08,  9.62it/s] 77%|███████▋  | 275/358 [00:28<00:08,  9.66it/s] 77%|███████▋  | 276/358 [00:28<00:08,  9.67it/s] 77%|███████▋  | 277/358 [00:28<00:08,  9.64it/s] 78%|███████▊  | 278/358 [00:28<00:08,  9.62it/s] 78%|███████▊  | 280/358 [00:28<00:07,  9.81it/s] 78%|███████▊  | 281/358 [00:28<00:07,  9.82it/s] 79%|███████▉  | 282/358 [00:28<00:07,  9.76it/s] 79%|███████▉  | 283/358 [00:28<00:07,  9.70it/s] 79%|███████▉  | 284/358 [00:28<00:07,  9.66it/s] 80%|███████▉  | 285/358 [00:29<00:07,  9.72it/s] 80%|███████▉  | 286/358 [00:29<00:07,  9.68it/s] 80%|████████  | 287/358 [00:29<00:07,  9.66it/s] 80%|████████  | 288/358 [00:29<00:07,  9.62it/s] 81%|████████  | 289/358 [00:29<00:07,  9.73it/s] 81%|████████▏ | 291/358 [00:29<00:06,  9.84it/s] 82%|████████▏ | 293/358 [00:29<00:06,  9.84it/s] 82%|████████▏ | 295/358 [00:30<00:06,  9.91it/s] 83%|████████▎ | 296/358 [00:30<00:06,  9.84it/s] 83%|████████▎ | 297/358 [00:30<00:06,  9.73it/s] 84%|████████▎ | 299/358 [00:30<00:05,  9.89it/s] 84%|████████▍ | 301/358 [00:30<00:05,  9.92it/s] 84%|████████▍ | 302/358 [00:30<00:05,  9.86it/s] 85%|████████▍ | 303/358 [00:30<00:05,  9.87it/s] 85%|████████▌ | 305/358 [00:31<00:05,  9.89it/s] 85%|████████▌ | 306/358 [00:31<00:05,  9.82it/s] 86%|████████▌ | 308/358 [00:31<00:05,  9.90it/s] 86%|████████▋ | 309/358 [00:31<00:04,  9.80it/s] 87%|████████▋ | 310/358 [00:31<00:04,  9.75it/s] 87%|████████▋ | 311/358 [00:31<00:04,  9.67it/s] 87%|████████▋ | 312/358 [00:31<00:04,  9.69it/s] 87%|████████▋ | 313/358 [00:31<00:04,  9.71it/s] 88%|████████▊ | 315/358 [00:32<00:04,  9.97it/s] 88%|████████▊ | 316/358 [00:32<00:04,  9.92it/s] 89%|████████▊ | 317/358 [00:32<00:04,  9.84it/s] 89%|████████▉ | 318/358 [00:32<00:04,  9.79it/s] 89%|████████▉ | 319/358 [00:32<00:04,  9.74it/s] 89%|████████▉ | 320/358 [00:32<00:03,  9.80it/s] 90%|████████▉ | 321/358 [00:32<00:03,  9.73it/s] 90%|████████▉ | 322/358 [00:32<00:03,  9.69it/s] 90%|█████████ | 323/358 [00:32<00:03,  9.65it/s] 91%|█████████ | 324/358 [00:33<00:03,  9.62it/s] 91%|█████████ | 325/358 [00:33<00:03,  9.60it/s] 91%|█████████▏| 327/358 [00:33<00:03,  9.96it/s] 92%|█████████▏| 329/358 [00:33<00:02, 10.06it/s] 92%|█████████▏| 330/358 [00:33<00:02,  9.94it/s] 93%|█████████▎| 332/358 [00:33<00:02, 10.04it/s] 93%|█████████▎| 334/358 [00:34<00:02,  9.94it/s] 94%|█████████▎| 335/358 [00:34<00:02,  9.82it/s] 94%|█████████▍| 337/358 [00:34<00:02,  9.90it/s] 95%|█████████▍| 339/358 [00:34<00:01, 10.10it/s] 95%|█████████▌| 341/358 [00:34<00:01, 10.04it/s] 96%|█████████▌| 342/358 [00:34<00:01,  9.96it/s] 96%|█████████▌| 343/358 [00:34<00:01,  9.86it/s] 96%|█████████▌| 344/358 [00:35<00:01,  9.79it/s] 96%|█████████▋| 345/358 [00:35<00:01,  9.82it/s] 97%|█████████▋| 346/358 [00:35<00:01,  9.87it/s] 97%|█████████▋| 348/358 [00:35<00:01,  9.97it/s] 97%|█████████▋| 349/358 [00:35<00:00,  9.88it/s] 98%|█████████▊| 350/358 [00:35<00:00,  9.80it/s] 98%|█████████▊| 351/358 [00:35<00:00,  9.74it/s] 99%|█████████▊| 353/358 [00:35<00:00,  9.92it/s] 99%|█████████▉| 354/358 [00:36<00:00,  9.90it/s] 99%|█████████▉| 355/358 [00:36<00:00,  9.81it/s]100%|█████████▉| 357/358 [00:36<00:00,  9.86it/s]100%|██████████| 358/358 [00:36<00:00,  9.81it/s]
[32m2025-02-05 05:27:04.108[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    gen_loss  grad clip ratio  grad norm   ppl
       2.421                1       3.37 11.26[0m
[32m2025-02-05 05:27:04.109[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m169[0m - [1m[Valid][0m
  0%|          | 0/10256 [00:00<?, ?it/s]100%|██████████| 10256/10256 [00:00<00:00, 926906.03it/s]
[32m2025-02-05 05:27:04.120[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:26,  1.46it/s]  5%|▌         | 2/40 [00:01<00:25,  1.48it/s]  8%|▊         | 3/40 [00:02<00:24,  1.49it/s] 10%|█         | 4/40 [00:02<00:24,  1.48it/s] 12%|█▎        | 5/40 [00:03<00:23,  1.47it/s] 15%|█▌        | 6/40 [00:04<00:23,  1.47it/s] 18%|█▊        | 7/40 [00:04<00:22,  1.47it/s] 20%|██        | 8/40 [00:05<00:21,  1.48it/s] 22%|██▎       | 9/40 [00:06<00:21,  1.47it/s] 25%|██▌       | 10/40 [00:06<00:20,  1.48it/s] 28%|██▊       | 11/40 [00:07<00:19,  1.48it/s] 30%|███       | 12/40 [00:08<00:18,  1.47it/s] 32%|███▎      | 13/40 [00:08<00:18,  1.48it/s] 35%|███▌      | 14/40 [00:09<00:17,  1.47it/s] 38%|███▊      | 15/40 [00:10<00:17,  1.47it/s] 40%|████      | 16/40 [00:10<00:16,  1.46it/s] 42%|████▎     | 17/40 [00:11<00:15,  1.46it/s] 45%|████▌     | 18/40 [00:12<00:15,  1.47it/s] 48%|████▊     | 19/40 [00:12<00:14,  1.46it/s] 50%|█████     | 20/40 [00:13<00:13,  1.47it/s] 52%|█████▎    | 21/40 [00:14<00:12,  1.48it/s] 55%|█████▌    | 22/40 [00:14<00:12,  1.47it/s] 57%|█████▊    | 23/40 [00:15<00:11,  1.48it/s] 60%|██████    | 24/40 [00:16<00:10,  1.47it/s] 62%|██████▎   | 25/40 [00:16<00:10,  1.47it/s] 65%|██████▌   | 26/40 [00:17<00:09,  1.48it/s] 68%|██████▊   | 27/40 [00:18<00:08,  1.48it/s] 70%|███████   | 28/40 [00:19<00:08,  1.47it/s] 72%|███████▎  | 29/40 [00:19<00:07,  1.47it/s] 75%|███████▌  | 30/40 [00:20<00:06,  1.48it/s] 78%|███████▊  | 31/40 [00:21<00:06,  1.48it/s] 80%|████████  | 32/40 [00:21<00:05,  1.48it/s] 82%|████████▎ | 33/40 [00:22<00:04,  1.47it/s] 85%|████████▌ | 34/40 [00:23<00:04,  1.47it/s] 88%|████████▊ | 35/40 [00:23<00:03,  1.47it/s] 90%|█████████ | 36/40 [00:24<00:02,  1.46it/s] 92%|█████████▎| 37/40 [00:25<00:02,  1.47it/s] 95%|█████████▌| 38/40 [00:25<00:01,  1.46it/s] 98%|█████████▊| 39/40 [00:26<00:00,  1.46it/s]100%|██████████| 40/40 [00:26<00:00,  1.62it/s]100%|██████████| 40/40 [00:26<00:00,  1.48it/s]
[32m2025-02-05 05:27:31.109[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    average  bleu@1  bleu@2  bleu@3  bleu@4  dist@1  dist@2  dist@3  dist@4  extreme  \
      .7645   .2862   .0975  .03705  .01936  .04429   .3268   .6424   .8236    .5759   
      f1  gen_loss  greedy  intra_dist@1  intra_dist@2  intra_dist@3  intra_dist@4  \
   .3462     4.307   .6612         .9055         .9849         .9489         .8901   
     ppl  rouge1  rouge2  rougeL  
   74.18   .3766  .08195   .3644[0m
[32m2025-02-05 05:27:31.114[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m163[0m - [1m[Conversation epoch 18][0m
[32m2025-02-05 05:27:31.115[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m164[0m - [1m[Train][0m
  0%|          | 0/92414 [00:00<?, ?it/s]100%|██████████| 92414/92414 [00:00<00:00, 1086257.18it/s]
[32m2025-02-05 05:27:31.200[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/358 [00:00<?, ?it/s]  0%|          | 1/358 [00:00<00:36,  9.75it/s]  1%|          | 3/358 [00:00<00:35,  9.92it/s]  1%|          | 4/358 [00:00<00:35,  9.90it/s]  2%|▏         | 6/358 [00:00<00:35,  9.87it/s]  2%|▏         | 7/358 [00:00<00:35,  9.80it/s]  2%|▏         | 8/358 [00:00<00:35,  9.84it/s]  3%|▎         | 9/358 [00:00<00:35,  9.75it/s]  3%|▎         | 10/358 [00:01<00:35,  9.74it/s]  3%|▎         | 11/358 [00:01<00:35,  9.69it/s]  4%|▎         | 13/358 [00:01<00:34,  9.91it/s]  4%|▍         | 14/358 [00:01<00:34,  9.83it/s]  4%|▍         | 15/358 [00:01<00:35,  9.76it/s]  4%|▍         | 16/358 [00:01<00:35,  9.69it/s]  5%|▍         | 17/358 [00:01<00:35,  9.71it/s]  5%|▌         | 18/358 [00:01<00:34,  9.79it/s]  5%|▌         | 19/358 [00:01<00:34,  9.72it/s]  6%|▌         | 20/358 [00:02<00:34,  9.66it/s]  6%|▌         | 21/358 [00:02<00:35,  9.59it/s]  6%|▌         | 22/358 [00:02<00:34,  9.66it/s]  7%|▋         | 24/358 [00:02<00:34,  9.76it/s]  7%|▋         | 25/358 [00:02<00:34,  9.71it/s]  7%|▋         | 26/358 [00:02<00:34,  9.66it/s]  8%|▊         | 27/358 [00:02<00:34,  9.72it/s]  8%|▊         | 28/358 [00:02<00:34,  9.67it/s]  8%|▊         | 29/358 [00:02<00:34,  9.64it/s]  9%|▊         | 31/358 [00:03<00:33,  9.74it/s]  9%|▉         | 32/358 [00:03<00:33,  9.74it/s]  9%|▉         | 34/358 [00:03<00:32,  9.83it/s] 10%|█         | 36/358 [00:03<00:32,  9.83it/s] 10%|█         | 37/358 [00:03<00:32,  9.82it/s] 11%|█         | 38/358 [00:03<00:32,  9.78it/s] 11%|█         | 40/358 [00:04<00:32,  9.93it/s] 11%|█▏        | 41/358 [00:04<00:32,  9.85it/s] 12%|█▏        | 43/358 [00:04<00:31,  9.87it/s] 13%|█▎        | 45/358 [00:04<00:31,  9.97it/s] 13%|█▎        | 47/358 [00:04<00:31,  9.94it/s] 13%|█▎        | 48/358 [00:04<00:31,  9.93it/s] 14%|█▍        | 50/358 [00:05<00:31,  9.90it/s] 14%|█▍        | 51/358 [00:05<00:31,  9.83it/s] 15%|█▍        | 52/358 [00:05<00:31,  9.74it/s] 15%|█▍        | 53/358 [00:05<00:31,  9.69it/s] 15%|█▌        | 54/358 [00:05<00:31,  9.73it/s] 15%|█▌        | 55/358 [00:05<00:31,  9.68it/s] 16%|█▌        | 56/358 [00:05<00:31,  9.72it/s] 16%|█▌        | 57/358 [00:05<00:31,  9.68it/s] 16%|█▌        | 58/358 [00:05<00:31,  9.66it/s] 16%|█▋        | 59/358 [00:06<00:31,  9.63it/s] 17%|█▋        | 61/358 [00:06<00:30,  9.71it/s] 17%|█▋        | 62/358 [00:06<00:30,  9.63it/s] 18%|█▊        | 63/358 [00:06<00:30,  9.70it/s] 18%|█▊        | 64/358 [00:06<00:30,  9.65it/s] 18%|█▊        | 66/358 [00:06<00:30,  9.72it/s] 19%|█▊        | 67/358 [00:06<00:29,  9.70it/s] 19%|█▉        | 69/358 [00:07<00:29,  9.77it/s] 20%|█▉        | 70/358 [00:07<00:29,  9.71it/s] 20%|█▉        | 71/358 [00:07<00:29,  9.76it/s] 20%|██        | 72/358 [00:07<00:29,  9.71it/s] 20%|██        | 73/358 [00:07<00:29,  9.67it/s] 21%|██        | 74/358 [00:07<00:29,  9.64it/s] 21%|██        | 75/358 [00:07<00:29,  9.61it/s] 21%|██        | 76/358 [00:07<00:29,  9.71it/s] 22%|██▏       | 77/358 [00:07<00:29,  9.68it/s] 22%|██▏       | 79/358 [00:08<00:28,  9.68it/s] 23%|██▎       | 81/358 [00:08<00:28,  9.75it/s] 23%|██▎       | 83/358 [00:08<00:28,  9.77it/s] 23%|██▎       | 84/358 [00:08<00:28,  9.72it/s] 24%|██▎       | 85/358 [00:08<00:28,  9.67it/s] 24%|██▍       | 86/358 [00:08<00:28,  9.66it/s] 24%|██▍       | 87/358 [00:08<00:28,  9.64it/s] 25%|██▍       | 88/358 [00:09<00:27,  9.66it/s] 25%|██▌       | 90/358 [00:09<00:27,  9.89it/s] 26%|██▌       | 92/358 [00:09<00:26, 10.00it/s] 26%|██▌       | 93/358 [00:09<00:26,  9.96it/s] 26%|██▋       | 94/358 [00:09<00:26,  9.87it/s] 27%|██▋       | 96/358 [00:09<00:25, 10.15it/s] 27%|██▋       | 98/358 [00:10<00:25, 10.04it/s] 28%|██▊       | 99/358 [00:10<00:26,  9.95it/s] 28%|██▊       | 101/358 [00:10<00:25,  9.91it/s] 29%|██▉       | 103/358 [00:10<00:25,  9.90it/s] 29%|██▉       | 104/358 [00:10<00:25,  9.85it/s] 29%|██▉       | 105/358 [00:10<00:25,  9.78it/s] 30%|██▉       | 106/358 [00:10<00:25,  9.76it/s] 30%|███       | 108/358 [00:11<00:25,  9.79it/s] 30%|███       | 109/358 [00:11<00:25,  9.70it/s] 31%|███       | 110/358 [00:11<00:25,  9.69it/s] 31%|███       | 111/358 [00:11<00:25,  9.64it/s] 32%|███▏      | 113/358 [00:11<00:24,  9.91it/s] 32%|███▏      | 114/358 [00:11<00:24,  9.86it/s] 32%|███▏      | 115/358 [00:11<00:24,  9.77it/s] 32%|███▏      | 116/358 [00:11<00:24,  9.68it/s] 33%|███▎      | 117/358 [00:11<00:24,  9.65it/s] 33%|███▎      | 119/358 [00:12<00:24,  9.77it/s] 34%|███▍      | 121/358 [00:12<00:23,  9.97it/s] 34%|███▍      | 123/358 [00:12<00:23, 10.07it/s] 35%|███▍      | 125/358 [00:12<00:23, 10.05it/s] 35%|███▌      | 126/358 [00:12<00:23, 10.01it/s] 35%|███▌      | 127/358 [00:12<00:23,  9.96it/s] 36%|███▌      | 128/358 [00:13<00:23,  9.91it/s] 36%|███▋      | 130/358 [00:13<00:22,  9.98it/s] 37%|███▋      | 131/358 [00:13<00:22,  9.88it/s] 37%|███▋      | 132/358 [00:13<00:22,  9.90it/s] 37%|███▋      | 134/358 [00:13<00:22,  9.92it/s] 38%|███▊      | 135/358 [00:13<00:22,  9.86it/s] 38%|███▊      | 137/358 [00:13<00:22,  9.95it/s] 39%|███▊      | 138/358 [00:14<00:22,  9.93it/s] 39%|███▉      | 139/358 [00:14<00:22,  9.84it/s] 39%|███▉      | 141/358 [00:14<00:21,  9.97it/s] 40%|███▉      | 142/358 [00:14<00:21,  9.89it/s] 40%|███▉      | 143/358 [00:14<00:21,  9.86it/s] 40%|████      | 144/358 [00:14<00:21,  9.77it/s] 41%|████      | 145/358 [00:14<00:21,  9.79it/s] 41%|████      | 146/358 [00:14<00:21,  9.72it/s] 41%|████      | 147/358 [00:14<00:21,  9.66it/s] 41%|████▏     | 148/358 [00:15<00:21,  9.70it/s] 42%|████▏     | 149/358 [00:15<00:21,  9.68it/s] 42%|████▏     | 150/358 [00:15<00:21,  9.64it/s] 42%|████▏     | 151/358 [00:15<00:22,  9.38it/s] 42%|████▏     | 152/358 [00:15<00:21,  9.42it/s] 43%|████▎     | 153/358 [00:15<00:21,  9.44it/s] 43%|████▎     | 154/358 [00:15<00:21,  9.53it/s] 43%|████▎     | 155/358 [00:15<00:21,  9.54it/s] 44%|████▎     | 156/358 [00:15<00:20,  9.67it/s] 44%|████▍     | 157/358 [00:16<00:20,  9.61it/s] 44%|████▍     | 158/358 [00:16<00:20,  9.70it/s] 44%|████▍     | 159/358 [00:16<00:20,  9.69it/s] 45%|████▍     | 160/358 [00:16<00:20,  9.70it/s] 45%|████▌     | 162/358 [00:16<00:19,  9.99it/s] 46%|████▌     | 164/358 [00:16<00:19,  9.99it/s] 46%|████▌     | 165/358 [00:16<00:19,  9.95it/s] 47%|████▋     | 167/358 [00:17<00:19,  9.90it/s] 47%|████▋     | 169/358 [00:17<00:19,  9.93it/s] 48%|████▊     | 171/358 [00:17<00:18,  9.92it/s] 48%|████▊     | 172/358 [00:17<00:18,  9.86it/s] 48%|████▊     | 173/358 [00:17<00:18,  9.80it/s] 49%|████▉     | 175/358 [00:17<00:18,  9.82it/s] 49%|████▉     | 176/358 [00:17<00:18,  9.84it/s] 49%|████▉     | 177/358 [00:18<00:18,  9.83it/s] 50%|█████     | 179/358 [00:18<00:18,  9.85it/s] 50%|█████     | 180/358 [00:18<00:18,  9.78it/s] 51%|█████     | 182/358 [00:18<00:17,  9.93it/s] 51%|█████     | 183/358 [00:18<00:17,  9.88it/s] 51%|█████▏    | 184/358 [00:18<00:17,  9.77it/s] 52%|█████▏    | 185/358 [00:18<00:17,  9.72it/s] 52%|█████▏    | 187/358 [00:19<00:17,  9.93it/s] 53%|█████▎    | 188/358 [00:19<00:17,  9.88it/s] 53%|█████▎    | 189/358 [00:19<00:17,  9.82it/s] 53%|█████▎    | 190/358 [00:19<00:17,  9.86it/s] 53%|█████▎    | 191/358 [00:19<00:17,  9.69it/s] 54%|█████▎    | 192/358 [00:19<00:17,  9.65it/s] 54%|█████▍    | 193/358 [00:19<00:17,  9.65it/s] 54%|█████▍    | 194/358 [00:19<00:17,  9.63it/s] 54%|█████▍    | 195/358 [00:19<00:16,  9.71it/s] 55%|█████▌    | 197/358 [00:20<00:16,  9.90it/s] 55%|█████▌    | 198/358 [00:20<00:16,  9.83it/s] 56%|█████▌    | 199/358 [00:20<00:16,  9.86it/s] 56%|█████▌    | 200/358 [00:20<00:16,  9.79it/s] 56%|█████▌    | 201/358 [00:20<00:16,  9.75it/s] 57%|█████▋    | 203/358 [00:20<00:15,  9.84it/s] 57%|█████▋    | 204/358 [00:20<00:15,  9.73it/s] 57%|█████▋    | 205/358 [00:20<00:15,  9.69it/s] 58%|█████▊    | 207/358 [00:21<00:15,  9.86it/s] 58%|█████▊    | 208/358 [00:21<00:15,  9.80it/s] 59%|█████▊    | 210/358 [00:21<00:15,  9.81it/s] 59%|█████▉    | 212/358 [00:21<00:14,  9.80it/s] 60%|█████▉    | 214/358 [00:21<00:14,  9.88it/s] 60%|██████    | 215/358 [00:21<00:14,  9.82it/s] 60%|██████    | 216/358 [00:22<00:14,  9.75it/s] 61%|██████    | 217/358 [00:22<00:14,  9.79it/s] 61%|██████    | 218/358 [00:22<00:14,  9.75it/s] 61%|██████    | 219/358 [00:22<00:14,  9.76it/s] 62%|██████▏   | 221/358 [00:22<00:13,  9.88it/s] 62%|██████▏   | 222/358 [00:22<00:13,  9.78it/s] 62%|██████▏   | 223/358 [00:22<00:13,  9.73it/s] 63%|██████▎   | 224/358 [00:22<00:13,  9.67it/s] 63%|██████▎   | 225/358 [00:22<00:13,  9.76it/s] 63%|██████▎   | 226/358 [00:23<00:13,  9.71it/s] 64%|██████▎   | 228/358 [00:23<00:13,  9.75it/s] 64%|██████▍   | 229/358 [00:23<00:13,  9.72it/s] 64%|██████▍   | 230/358 [00:23<00:13,  9.67it/s] 65%|██████▍   | 232/358 [00:23<00:12,  9.72it/s] 65%|██████▌   | 234/358 [00:23<00:12, 10.02it/s] 66%|██████▌   | 236/358 [00:24<00:12,  9.98it/s] 66%|██████▋   | 238/358 [00:24<00:11, 10.01it/s] 67%|██████▋   | 240/358 [00:24<00:11,  9.97it/s] 68%|██████▊   | 242/358 [00:24<00:11,  9.95it/s] 68%|██████▊   | 243/358 [00:24<00:11,  9.89it/s] 68%|██████▊   | 244/358 [00:24<00:11,  9.83it/s] 69%|██████▊   | 246/358 [00:25<00:11,  9.85it/s] 69%|██████▉   | 247/358 [00:25<00:11,  9.78it/s] 69%|██████▉   | 248/358 [00:25<00:11,  9.74it/s] 70%|██████▉   | 250/358 [00:25<00:10,  9.84it/s] 70%|███████   | 251/358 [00:25<00:10,  9.77it/s] 70%|███████   | 252/358 [00:25<00:10,  9.71it/s] 71%|███████   | 253/358 [00:25<00:10,  9.67it/s] 71%|███████   | 254/358 [00:25<00:10,  9.64it/s] 72%|███████▏  | 256/358 [00:26<00:10,  9.82it/s] 72%|███████▏  | 257/358 [00:26<00:10,  9.82it/s] 72%|███████▏  | 258/358 [00:26<00:10,  9.70it/s] 72%|███████▏  | 259/358 [00:26<00:10,  9.67it/s] 73%|███████▎  | 260/358 [00:26<00:10,  9.70it/s] 73%|███████▎  | 262/358 [00:26<00:09,  9.88it/s] 74%|███████▎  | 264/358 [00:26<00:09,  9.89it/s] 74%|███████▍  | 266/358 [00:27<00:09,  9.89it/s] 75%|███████▍  | 267/358 [00:27<00:09,  9.83it/s] 75%|███████▌  | 269/358 [00:27<00:09,  9.88it/s] 75%|███████▌  | 270/358 [00:27<00:08,  9.81it/s] 76%|███████▌  | 271/358 [00:27<00:08,  9.73it/s] 76%|███████▌  | 272/358 [00:27<00:08,  9.71it/s] 76%|███████▋  | 273/358 [00:27<00:08,  9.61it/s] 77%|███████▋  | 274/358 [00:27<00:08,  9.61it/s] 77%|███████▋  | 275/358 [00:28<00:08,  9.66it/s] 77%|███████▋  | 276/358 [00:28<00:08,  9.66it/s] 77%|███████▋  | 277/358 [00:28<00:08,  9.64it/s] 78%|███████▊  | 278/358 [00:28<00:08,  9.61it/s] 78%|███████▊  | 280/358 [00:28<00:07,  9.80it/s] 78%|███████▊  | 281/358 [00:28<00:07,  9.81it/s] 79%|███████▉  | 282/358 [00:28<00:07,  9.76it/s] 79%|███████▉  | 283/358 [00:28<00:07,  9.69it/s] 79%|███████▉  | 284/358 [00:28<00:07,  9.66it/s] 80%|███████▉  | 285/358 [00:29<00:07,  9.72it/s] 80%|███████▉  | 286/358 [00:29<00:07,  9.68it/s] 80%|████████  | 287/358 [00:29<00:07,  9.66it/s] 80%|████████  | 288/358 [00:29<00:07,  9.62it/s] 81%|████████  | 289/358 [00:29<00:07,  9.69it/s] 81%|████████▏ | 291/358 [00:29<00:06,  9.81it/s] 82%|████████▏ | 293/358 [00:29<00:06,  9.82it/s] 82%|████████▏ | 295/358 [00:30<00:06,  9.89it/s] 83%|████████▎ | 296/358 [00:30<00:06,  9.83it/s] 83%|████████▎ | 297/358 [00:30<00:06,  9.72it/s] 84%|████████▎ | 299/358 [00:30<00:05,  9.88it/s] 84%|████████▍ | 301/358 [00:30<00:05,  9.92it/s] 84%|████████▍ | 302/358 [00:30<00:05,  9.85it/s] 85%|████████▍ | 303/358 [00:30<00:05,  9.86it/s] 85%|████████▌ | 305/358 [00:31<00:05,  9.89it/s] 85%|████████▌ | 306/358 [00:31<00:05,  9.81it/s] 86%|████████▌ | 308/358 [00:31<00:05,  9.91it/s] 86%|████████▋ | 309/358 [00:31<00:04,  9.81it/s] 87%|████████▋ | 310/358 [00:31<00:04,  9.75it/s] 87%|████████▋ | 311/358 [00:31<00:04,  9.68it/s] 87%|████████▋ | 312/358 [00:31<00:04,  9.69it/s] 87%|████████▋ | 313/358 [00:31<00:04,  9.71it/s] 88%|████████▊ | 315/358 [00:32<00:04,  9.97it/s] 88%|████████▊ | 316/358 [00:32<00:04,  9.92it/s] 89%|████████▊ | 317/358 [00:32<00:04,  9.83it/s] 89%|████████▉ | 318/358 [00:32<00:04,  9.78it/s] 89%|████████▉ | 319/358 [00:32<00:04,  9.74it/s] 89%|████████▉ | 320/358 [00:32<00:03,  9.80it/s] 90%|████████▉ | 321/358 [00:32<00:03,  9.73it/s] 90%|████████▉ | 322/358 [00:32<00:03,  9.69it/s] 90%|█████████ | 323/358 [00:32<00:03,  9.65it/s] 91%|█████████ | 324/358 [00:33<00:03,  9.62it/s] 91%|█████████ | 325/358 [00:33<00:03,  9.60it/s] 91%|█████████▏| 327/358 [00:33<00:03,  9.95it/s] 92%|█████████▏| 329/358 [00:33<00:02, 10.05it/s] 92%|█████████▏| 330/358 [00:33<00:02,  9.95it/s] 93%|█████████▎| 332/358 [00:33<00:02, 10.05it/s] 93%|█████████▎| 334/358 [00:34<00:02,  9.95it/s] 94%|█████████▎| 335/358 [00:34<00:02,  9.82it/s] 94%|█████████▍| 337/358 [00:34<00:02,  9.90it/s] 95%|█████████▍| 339/358 [00:34<00:01, 10.10it/s] 95%|█████████▌| 341/358 [00:34<00:01, 10.05it/s] 96%|█████████▌| 343/358 [00:34<00:01,  9.88it/s] 96%|█████████▌| 344/358 [00:35<00:01,  9.82it/s] 96%|█████████▋| 345/358 [00:35<00:01,  9.85it/s] 97%|█████████▋| 346/358 [00:35<00:01,  9.88it/s] 97%|█████████▋| 348/358 [00:35<00:01,  9.97it/s] 97%|█████████▋| 349/358 [00:35<00:00,  9.88it/s] 98%|█████████▊| 350/358 [00:35<00:00,  9.80it/s] 98%|█████████▊| 351/358 [00:35<00:00,  9.75it/s] 99%|█████████▊| 353/358 [00:36<00:00,  9.92it/s] 99%|█████████▉| 354/358 [00:36<00:00,  9.90it/s] 99%|█████████▉| 355/358 [00:36<00:00,  9.81it/s]100%|█████████▉| 357/358 [00:36<00:00,  9.86it/s]100%|██████████| 358/358 [00:36<00:00,  9.81it/s]
[32m2025-02-05 05:28:07.696[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    gen_loss  grad clip ratio  grad norm   ppl
       2.392                1      3.334 10.94[0m
[32m2025-02-05 05:28:07.696[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m169[0m - [1m[Valid][0m
  0%|          | 0/10256 [00:00<?, ?it/s]100%|██████████| 10256/10256 [00:00<00:00, 924118.28it/s]
[32m2025-02-05 05:28:07.708[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:27,  1.43it/s]  5%|▌         | 2/40 [00:01<00:26,  1.45it/s]  8%|▊         | 3/40 [00:02<00:25,  1.47it/s] 10%|█         | 4/40 [00:02<00:24,  1.46it/s] 12%|█▎        | 5/40 [00:03<00:24,  1.46it/s] 15%|█▌        | 6/40 [00:04<00:23,  1.46it/s] 18%|█▊        | 7/40 [00:04<00:22,  1.46it/s] 20%|██        | 8/40 [00:05<00:21,  1.47it/s] 22%|██▎       | 9/40 [00:06<00:21,  1.47it/s] 25%|██▌       | 10/40 [00:06<00:20,  1.47it/s] 28%|██▊       | 11/40 [00:07<00:19,  1.48it/s] 30%|███       | 12/40 [00:08<00:19,  1.47it/s] 32%|███▎      | 13/40 [00:08<00:18,  1.47it/s] 35%|███▌      | 14/40 [00:09<00:17,  1.46it/s] 38%|███▊      | 15/40 [00:10<00:17,  1.46it/s] 40%|████      | 16/40 [00:10<00:16,  1.46it/s] 42%|████▎     | 17/40 [00:11<00:15,  1.46it/s] 45%|████▌     | 18/40 [00:12<00:15,  1.47it/s] 48%|████▊     | 19/40 [00:12<00:14,  1.47it/s] 50%|█████     | 20/40 [00:13<00:13,  1.47it/s] 52%|█████▎    | 21/40 [00:14<00:12,  1.47it/s] 55%|█████▌    | 22/40 [00:15<00:12,  1.47it/s] 57%|█████▊    | 23/40 [00:15<00:11,  1.47it/s] 60%|██████    | 24/40 [00:16<00:10,  1.46it/s] 62%|██████▎   | 25/40 [00:17<00:10,  1.46it/s] 65%|██████▌   | 26/40 [00:17<00:09,  1.47it/s] 68%|██████▊   | 27/40 [00:18<00:08,  1.47it/s] 70%|███████   | 28/40 [00:19<00:08,  1.47it/s] 72%|███████▎  | 29/40 [00:19<00:07,  1.47it/s] 75%|███████▌  | 30/40 [00:20<00:06,  1.48it/s] 78%|███████▊  | 31/40 [00:21<00:06,  1.48it/s] 80%|████████  | 32/40 [00:21<00:05,  1.48it/s] 82%|████████▎ | 33/40 [00:22<00:04,  1.47it/s] 85%|████████▌ | 34/40 [00:23<00:04,  1.47it/s] 88%|████████▊ | 35/40 [00:23<00:03,  1.47it/s] 90%|█████████ | 36/40 [00:24<00:02,  1.46it/s] 92%|█████████▎| 37/40 [00:25<00:02,  1.47it/s] 95%|█████████▌| 38/40 [00:25<00:01,  1.46it/s] 98%|█████████▊| 39/40 [00:26<00:00,  1.46it/s]100%|██████████| 40/40 [00:27<00:00,  1.62it/s]100%|██████████| 40/40 [00:27<00:00,  1.48it/s]
[32m2025-02-05 05:28:34.766[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    average  bleu@1  bleu@2  bleu@3  bleu@4  dist@1  dist@2  dist@3  dist@4  extreme  \
      .7632   .2856  .09946  .04443  .02399  .04163   .2854   .5835   .7689    .5776   
      f1  gen_loss  greedy  intra_dist@1  intra_dist@2  intra_dist@3  intra_dist@4  \
   .3474      4.33   .6628         .8909         .9731         .9467         .8945   
     ppl  rouge1  rouge2  rougeL  
   75.97   .3810   .0863   .3683[0m
[32m2025-02-05 05:28:34.771[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m163[0m - [1m[Conversation epoch 19][0m
[32m2025-02-05 05:28:34.771[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m164[0m - [1m[Train][0m
  0%|          | 0/92414 [00:00<?, ?it/s]100%|██████████| 92414/92414 [00:00<00:00, 1100899.52it/s]
[32m2025-02-05 05:28:34.856[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/358 [00:00<?, ?it/s]  0%|          | 1/358 [00:00<00:36,  9.75it/s]  1%|          | 3/358 [00:00<00:35,  9.93it/s]  1%|          | 4/358 [00:00<00:35,  9.90it/s]  2%|▏         | 6/358 [00:00<00:35,  9.87it/s]  2%|▏         | 7/358 [00:00<00:35,  9.81it/s]  2%|▏         | 8/358 [00:00<00:35,  9.85it/s]  3%|▎         | 9/358 [00:00<00:35,  9.75it/s]  3%|▎         | 10/358 [00:01<00:35,  9.74it/s]  3%|▎         | 11/358 [00:01<00:35,  9.68it/s]  4%|▎         | 13/358 [00:01<00:34,  9.90it/s]  4%|▍         | 14/358 [00:01<00:34,  9.83it/s]  4%|▍         | 15/358 [00:01<00:35,  9.75it/s]  4%|▍         | 16/358 [00:01<00:35,  9.69it/s]  5%|▍         | 17/358 [00:01<00:35,  9.71it/s]  5%|▌         | 18/358 [00:01<00:34,  9.78it/s]  5%|▌         | 19/358 [00:01<00:34,  9.72it/s]  6%|▌         | 20/358 [00:02<00:34,  9.66it/s]  6%|▌         | 21/358 [00:02<00:35,  9.59it/s]  6%|▌         | 22/358 [00:02<00:34,  9.66it/s]  7%|▋         | 24/358 [00:02<00:34,  9.76it/s]  7%|▋         | 25/358 [00:02<00:34,  9.71it/s]  7%|▋         | 26/358 [00:02<00:34,  9.66it/s]  8%|▊         | 27/358 [00:02<00:34,  9.72it/s]  8%|▊         | 28/358 [00:02<00:34,  9.67it/s]  8%|▊         | 29/358 [00:02<00:34,  9.64it/s]  9%|▊         | 31/358 [00:03<00:33,  9.74it/s]  9%|▉         | 32/358 [00:03<00:33,  9.74it/s]  9%|▉         | 34/358 [00:03<00:32,  9.83it/s] 10%|█         | 36/358 [00:03<00:32,  9.83it/s] 10%|█         | 37/358 [00:03<00:32,  9.81it/s] 11%|█         | 38/358 [00:03<00:32,  9.77it/s] 11%|█         | 40/358 [00:04<00:32,  9.93it/s] 11%|█▏        | 41/358 [00:04<00:32,  9.84it/s] 12%|█▏        | 43/358 [00:04<00:31,  9.87it/s] 13%|█▎        | 45/358 [00:04<00:31,  9.97it/s] 13%|█▎        | 47/358 [00:04<00:31,  9.94it/s] 13%|█▎        | 48/358 [00:04<00:31,  9.93it/s] 14%|█▍        | 50/358 [00:05<00:31,  9.90it/s] 14%|█▍        | 51/358 [00:05<00:31,  9.83it/s] 15%|█▍        | 52/358 [00:05<00:31,  9.74it/s] 15%|█▍        | 53/358 [00:05<00:31,  9.69it/s] 15%|█▌        | 54/358 [00:05<00:31,  9.73it/s] 15%|█▌        | 55/358 [00:05<00:31,  9.68it/s] 16%|█▌        | 56/358 [00:05<00:31,  9.72it/s] 16%|█▌        | 57/358 [00:05<00:31,  9.68it/s] 16%|█▌        | 58/358 [00:05<00:31,  9.66it/s] 16%|█▋        | 59/358 [00:06<00:31,  9.62it/s] 17%|█▋        | 61/358 [00:06<00:30,  9.71it/s] 17%|█▋        | 62/358 [00:06<00:30,  9.63it/s] 18%|█▊        | 63/358 [00:06<00:30,  9.70it/s] 18%|█▊        | 64/358 [00:06<00:30,  9.65it/s] 18%|█▊        | 66/358 [00:06<00:30,  9.72it/s] 19%|█▊        | 67/358 [00:06<00:29,  9.70it/s] 19%|█▉        | 69/358 [00:07<00:29,  9.77it/s] 20%|█▉        | 70/358 [00:07<00:29,  9.71it/s] 20%|█▉        | 71/358 [00:07<00:29,  9.76it/s] 20%|██        | 72/358 [00:07<00:29,  9.71it/s] 20%|██        | 73/358 [00:07<00:29,  9.67it/s] 21%|██        | 74/358 [00:07<00:29,  9.64it/s] 21%|██        | 75/358 [00:07<00:29,  9.61it/s] 21%|██        | 76/358 [00:07<00:29,  9.71it/s] 22%|██▏       | 77/358 [00:07<00:29,  9.67it/s] 22%|██▏       | 79/358 [00:08<00:28,  9.68it/s] 23%|██▎       | 81/358 [00:08<00:28,  9.74it/s] 23%|██▎       | 83/358 [00:08<00:28,  9.77it/s] 23%|██▎       | 84/358 [00:08<00:28,  9.71it/s] 24%|██▎       | 85/358 [00:08<00:28,  9.67it/s] 24%|██▍       | 86/358 [00:08<00:28,  9.66it/s] 24%|██▍       | 87/358 [00:08<00:28,  9.64it/s] 25%|██▍       | 88/358 [00:09<00:27,  9.66it/s] 25%|██▌       | 90/358 [00:09<00:27,  9.90it/s] 26%|██▌       | 92/358 [00:09<00:26, 10.00it/s] 26%|██▌       | 93/358 [00:09<00:26,  9.96it/s] 26%|██▋       | 94/358 [00:09<00:26,  9.87it/s] 27%|██▋       | 96/358 [00:09<00:25, 10.15it/s] 27%|██▋       | 98/358 [00:10<00:25, 10.04it/s] 28%|██▊       | 99/358 [00:10<00:26,  9.94it/s] 28%|██▊       | 101/358 [00:10<00:25,  9.91it/s] 29%|██▉       | 103/358 [00:10<00:25,  9.90it/s] 29%|██▉       | 104/358 [00:10<00:25,  9.86it/s] 29%|██▉       | 105/358 [00:10<00:25,  9.78it/s] 30%|██▉       | 106/358 [00:10<00:25,  9.76it/s] 30%|███       | 108/358 [00:11<00:25,  9.79it/s] 30%|███       | 109/358 [00:11<00:25,  9.70it/s] 31%|███       | 110/358 [00:11<00:25,  9.69it/s] 31%|███       | 111/358 [00:11<00:25,  9.64it/s] 32%|███▏      | 113/358 [00:11<00:24,  9.90it/s] 32%|███▏      | 114/358 [00:11<00:24,  9.86it/s] 32%|███▏      | 115/358 [00:11<00:24,  9.77it/s] 32%|███▏      | 116/358 [00:11<00:24,  9.68it/s] 33%|███▎      | 117/358 [00:11<00:24,  9.65it/s] 33%|███▎      | 119/358 [00:12<00:24,  9.77it/s] 34%|███▍      | 121/358 [00:12<00:23,  9.97it/s] 34%|███▍      | 123/358 [00:12<00:23, 10.07it/s] 35%|███▍      | 125/358 [00:12<00:23, 10.05it/s] 35%|███▌      | 126/358 [00:12<00:23, 10.01it/s] 35%|███▌      | 127/358 [00:12<00:23,  9.96it/s] 36%|███▌      | 128/358 [00:13<00:23,  9.91it/s] 36%|███▋      | 130/358 [00:13<00:22,  9.98it/s] 37%|███▋      | 131/358 [00:13<00:22,  9.88it/s] 37%|███▋      | 132/358 [00:13<00:22,  9.90it/s] 37%|███▋      | 134/358 [00:13<00:22,  9.92it/s] 38%|███▊      | 135/358 [00:13<00:22,  9.86it/s] 38%|███▊      | 137/358 [00:13<00:22,  9.95it/s] 39%|███▊      | 138/358 [00:14<00:22,  9.93it/s] 39%|███▉      | 139/358 [00:14<00:22,  9.84it/s] 39%|███▉      | 141/358 [00:14<00:21,  9.97it/s] 40%|███▉      | 142/358 [00:14<00:21,  9.89it/s] 40%|███▉      | 143/358 [00:14<00:21,  9.85it/s] 40%|████      | 144/358 [00:14<00:21,  9.77it/s] 41%|████      | 145/358 [00:14<00:21,  9.79it/s] 41%|████      | 146/358 [00:14<00:21,  9.73it/s] 41%|████      | 147/358 [00:14<00:21,  9.67it/s] 41%|████▏     | 148/358 [00:15<00:21,  9.69it/s] 42%|████▏     | 149/358 [00:15<00:21,  9.68it/s] 42%|████▏     | 150/358 [00:15<00:21,  9.64it/s] 42%|████▏     | 151/358 [00:15<00:22,  9.38it/s] 42%|████▏     | 152/358 [00:15<00:21,  9.42it/s] 43%|████▎     | 153/358 [00:15<00:21,  9.44it/s] 43%|████▎     | 154/358 [00:15<00:21,  9.53it/s] 43%|████▎     | 155/358 [00:15<00:21,  9.54it/s] 44%|████▎     | 156/358 [00:15<00:20,  9.67it/s] 44%|████▍     | 157/358 [00:16<00:20,  9.60it/s] 44%|████▍     | 158/358 [00:16<00:20,  9.69it/s] 44%|████▍     | 159/358 [00:16<00:20,  9.69it/s] 45%|████▍     | 160/358 [00:16<00:20,  9.70it/s] 45%|████▌     | 162/358 [00:16<00:19,  9.99it/s] 46%|████▌     | 164/358 [00:16<00:19,  9.99it/s] 46%|████▌     | 165/358 [00:16<00:19,  9.95it/s] 47%|████▋     | 167/358 [00:17<00:19,  9.88it/s] 47%|████▋     | 169/358 [00:17<00:19,  9.92it/s] 48%|████▊     | 171/358 [00:17<00:18,  9.90it/s] 48%|████▊     | 172/358 [00:17<00:18,  9.85it/s] 48%|████▊     | 173/358 [00:17<00:18,  9.79it/s] 49%|████▉     | 175/358 [00:17<00:18,  9.81it/s] 49%|████▉     | 176/358 [00:17<00:18,  9.83it/s] 49%|████▉     | 177/358 [00:18<00:18,  9.82it/s] 50%|█████     | 179/358 [00:18<00:18,  9.84it/s] 50%|█████     | 180/358 [00:18<00:18,  9.77it/s] 51%|█████     | 182/358 [00:18<00:17,  9.92it/s] 51%|█████     | 183/358 [00:18<00:17,  9.87it/s] 51%|█████▏    | 184/358 [00:18<00:17,  9.69it/s] 52%|█████▏    | 185/358 [00:18<00:17,  9.66it/s] 52%|█████▏    | 187/358 [00:19<00:17,  9.90it/s] 53%|█████▎    | 188/358 [00:19<00:17,  9.85it/s] 53%|█████▎    | 189/358 [00:19<00:17,  9.80it/s] 53%|█████▎    | 190/358 [00:19<00:17,  9.85it/s] 53%|█████▎    | 191/358 [00:19<00:17,  9.69it/s] 54%|█████▎    | 192/358 [00:19<00:17,  9.64it/s] 54%|█████▍    | 193/358 [00:19<00:17,  9.64it/s] 54%|█████▍    | 194/358 [00:19<00:17,  9.63it/s] 54%|█████▍    | 195/358 [00:19<00:16,  9.71it/s] 55%|█████▌    | 197/358 [00:20<00:16,  9.90it/s] 55%|█████▌    | 198/358 [00:20<00:16,  9.82it/s] 56%|█████▌    | 199/358 [00:20<00:16,  9.86it/s] 56%|█████▌    | 200/358 [00:20<00:16,  9.79it/s] 56%|█████▌    | 201/358 [00:20<00:16,  9.75it/s] 57%|█████▋    | 203/358 [00:20<00:15,  9.83it/s] 57%|█████▋    | 204/358 [00:20<00:15,  9.73it/s] 57%|█████▋    | 205/358 [00:20<00:15,  9.69it/s] 58%|█████▊    | 207/358 [00:21<00:15,  9.86it/s] 58%|█████▊    | 208/358 [00:21<00:15,  9.79it/s] 59%|█████▊    | 210/358 [00:21<00:15,  9.80it/s] 59%|█████▉    | 212/358 [00:21<00:14,  9.79it/s] 60%|█████▉    | 214/358 [00:21<00:14,  9.87it/s] 60%|██████    | 215/358 [00:21<00:14,  9.81it/s] 60%|██████    | 216/358 [00:22<00:14,  9.75it/s] 61%|██████    | 217/358 [00:22<00:14,  9.78it/s] 61%|██████    | 218/358 [00:22<00:14,  9.75it/s] 61%|██████    | 219/358 [00:22<00:14,  9.74it/s] 62%|██████▏   | 221/358 [00:22<00:13,  9.87it/s] 62%|██████▏   | 222/358 [00:22<00:13,  9.77it/s] 62%|██████▏   | 223/358 [00:22<00:13,  9.72it/s] 63%|██████▎   | 224/358 [00:22<00:13,  9.67it/s] 63%|██████▎   | 225/358 [00:22<00:13,  9.75it/s] 63%|██████▎   | 226/358 [00:23<00:13,  9.70it/s] 64%|██████▎   | 228/358 [00:23<00:13,  9.74it/s] 64%|██████▍   | 229/358 [00:23<00:13,  9.71it/s] 64%|██████▍   | 230/358 [00:23<00:13,  9.66it/s] 65%|██████▍   | 232/358 [00:23<00:12,  9.72it/s] 65%|██████▌   | 234/358 [00:23<00:12, 10.01it/s] 66%|██████▌   | 236/358 [00:24<00:12,  9.97it/s] 66%|██████▋   | 238/358 [00:24<00:11, 10.02it/s] 67%|██████▋   | 240/358 [00:24<00:11,  9.98it/s] 68%|██████▊   | 242/358 [00:24<00:11,  9.96it/s] 68%|██████▊   | 243/358 [00:24<00:11,  9.90it/s] 68%|██████▊   | 244/358 [00:24<00:11,  9.83it/s] 69%|██████▊   | 246/358 [00:25<00:11,  9.84it/s] 69%|██████▉   | 247/358 [00:25<00:11,  9.77it/s] 69%|██████▉   | 248/358 [00:25<00:11,  9.73it/s] 70%|██████▉   | 250/358 [00:25<00:10,  9.83it/s] 70%|███████   | 251/358 [00:25<00:10,  9.77it/s] 70%|███████   | 252/358 [00:25<00:10,  9.70it/s] 71%|███████   | 253/358 [00:25<00:10,  9.67it/s] 71%|███████   | 254/358 [00:25<00:10,  9.64it/s] 72%|███████▏  | 256/358 [00:26<00:10,  9.82it/s] 72%|███████▏  | 257/358 [00:26<00:10,  9.82it/s] 72%|███████▏  | 258/358 [00:26<00:10,  9.69it/s] 72%|███████▏  | 259/358 [00:26<00:10,  9.66it/s] 73%|███████▎  | 260/358 [00:26<00:10,  9.70it/s] 73%|███████▎  | 262/358 [00:26<00:09,  9.88it/s] 74%|███████▎  | 264/358 [00:26<00:09,  9.90it/s] 74%|███████▍  | 266/358 [00:27<00:09,  9.89it/s] 75%|███████▍  | 267/358 [00:27<00:09,  9.83it/s] 75%|███████▌  | 269/358 [00:27<00:09,  9.89it/s] 75%|███████▌  | 270/358 [00:27<00:08,  9.81it/s] 76%|███████▌  | 271/358 [00:27<00:08,  9.74it/s] 76%|███████▌  | 272/358 [00:27<00:08,  9.71it/s] 76%|███████▋  | 273/358 [00:27<00:08,  9.62it/s] 77%|███████▋  | 274/358 [00:27<00:08,  9.61it/s] 77%|███████▋  | 275/358 [00:28<00:08,  9.66it/s] 77%|███████▋  | 276/358 [00:28<00:08,  9.67it/s] 77%|███████▋  | 277/358 [00:28<00:08,  9.64it/s] 78%|███████▊  | 278/358 [00:28<00:08,  9.61it/s] 78%|███████▊  | 280/358 [00:28<00:07,  9.80it/s] 78%|███████▊  | 281/358 [00:28<00:07,  9.81it/s] 79%|███████▉  | 282/358 [00:28<00:07,  9.76it/s] 79%|███████▉  | 283/358 [00:28<00:07,  9.70it/s] 79%|███████▉  | 284/358 [00:29<00:07,  9.66it/s] 80%|███████▉  | 285/358 [00:29<00:07,  9.72it/s] 80%|███████▉  | 286/358 [00:29<00:07,  9.68it/s] 80%|████████  | 287/358 [00:29<00:07,  9.66it/s] 80%|████████  | 288/358 [00:29<00:07,  9.62it/s] 81%|████████  | 290/358 [00:29<00:06,  9.83it/s] 81%|████████▏ | 291/358 [00:29<00:06,  9.81it/s] 82%|████████▏ | 293/358 [00:29<00:06,  9.82it/s] 82%|████████▏ | 295/358 [00:30<00:06,  9.89it/s] 83%|████████▎ | 296/358 [00:30<00:06,  9.82it/s] 83%|████████▎ | 297/358 [00:30<00:06,  9.72it/s] 84%|████████▎ | 299/358 [00:30<00:05,  9.88it/s] 84%|████████▍ | 301/358 [00:30<00:05,  9.91it/s] 84%|████████▍ | 302/358 [00:30<00:05,  9.85it/s] 85%|████████▍ | 303/358 [00:30<00:05,  9.86it/s] 85%|████████▌ | 305/358 [00:31<00:05,  9.89it/s] 85%|████████▌ | 306/358 [00:31<00:05,  9.81it/s] 86%|████████▌ | 308/358 [00:31<00:05,  9.91it/s] 86%|████████▋ | 309/358 [00:31<00:04,  9.81it/s] 87%|████████▋ | 310/358 [00:31<00:04,  9.75it/s] 87%|████████▋ | 311/358 [00:31<00:04,  9.67it/s] 87%|████████▋ | 312/358 [00:31<00:04,  9.69it/s] 87%|████████▋ | 313/358 [00:31<00:04,  9.71it/s] 88%|████████▊ | 315/358 [00:32<00:04,  9.97it/s] 88%|████████▊ | 316/358 [00:32<00:04,  9.92it/s] 89%|████████▊ | 317/358 [00:32<00:04,  9.84it/s] 89%|████████▉ | 318/358 [00:32<00:04,  9.79it/s] 89%|████████▉ | 319/358 [00:32<00:04,  9.74it/s] 89%|████████▉ | 320/358 [00:32<00:03,  9.80it/s] 90%|████████▉ | 321/358 [00:32<00:03,  9.73it/s] 90%|████████▉ | 322/358 [00:32<00:03,  9.69it/s] 90%|█████████ | 323/358 [00:32<00:03,  9.64it/s] 91%|█████████ | 324/358 [00:33<00:03,  9.61it/s] 91%|█████████ | 325/358 [00:33<00:03,  9.59it/s] 91%|█████████▏| 327/358 [00:33<00:03,  9.95it/s] 92%|█████████▏| 329/358 [00:33<00:02, 10.05it/s] 92%|█████████▏| 330/358 [00:33<00:02,  9.94it/s] 93%|█████████▎| 332/358 [00:33<00:02, 10.04it/s] 93%|█████████▎| 334/358 [00:34<00:02,  9.95it/s] 94%|█████████▎| 335/358 [00:34<00:02,  9.82it/s] 94%|█████████▍| 337/358 [00:34<00:02,  9.90it/s] 95%|█████████▍| 339/358 [00:34<00:01, 10.10it/s] 95%|█████████▌| 341/358 [00:34<00:01, 10.04it/s] 96%|█████████▌| 342/358 [00:34<00:01,  9.96it/s] 96%|█████████▌| 343/358 [00:34<00:01,  9.85it/s] 96%|█████████▌| 344/358 [00:35<00:01,  9.79it/s] 96%|█████████▋| 345/358 [00:35<00:01,  9.82it/s] 97%|█████████▋| 346/358 [00:35<00:01,  9.87it/s] 97%|█████████▋| 348/358 [00:35<00:01,  9.97it/s] 97%|█████████▋| 349/358 [00:35<00:00,  9.88it/s] 98%|█████████▊| 350/358 [00:35<00:00,  9.79it/s] 98%|█████████▊| 351/358 [00:35<00:00,  9.75it/s] 99%|█████████▊| 353/358 [00:36<00:00,  9.92it/s] 99%|█████████▉| 354/358 [00:36<00:00,  9.89it/s] 99%|█████████▉| 355/358 [00:36<00:00,  9.81it/s]100%|█████████▉| 357/358 [00:36<00:00,  9.86it/s]100%|██████████| 358/358 [00:36<00:00,  9.81it/s]
[32m2025-02-05 05:29:11.358[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    gen_loss  grad clip ratio  grad norm   ppl
       2.365                1       4.02 10.65[0m
[32m2025-02-05 05:29:11.358[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m169[0m - [1m[Valid][0m
  0%|          | 0/10256 [00:00<?, ?it/s]100%|██████████| 10256/10256 [00:00<00:00, 923087.10it/s]
[32m2025-02-05 05:29:11.370[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:26,  1.45it/s]  5%|▌         | 2/40 [00:01<00:25,  1.47it/s]  8%|▊         | 3/40 [00:02<00:25,  1.48it/s] 10%|█         | 4/40 [00:02<00:24,  1.48it/s] 12%|█▎        | 5/40 [00:03<00:23,  1.47it/s] 15%|█▌        | 6/40 [00:04<00:23,  1.47it/s] 18%|█▊        | 7/40 [00:04<00:22,  1.46it/s] 20%|██        | 8/40 [00:05<00:21,  1.47it/s] 22%|██▎       | 9/40 [00:06<00:21,  1.47it/s] 25%|██▌       | 10/40 [00:06<00:20,  1.47it/s] 28%|██▊       | 11/40 [00:07<00:19,  1.48it/s] 30%|███       | 12/40 [00:08<00:18,  1.48it/s] 32%|███▎      | 13/40 [00:08<00:18,  1.48it/s] 35%|███▌      | 14/40 [00:09<00:17,  1.47it/s] 38%|███▊      | 15/40 [00:10<00:17,  1.47it/s] 40%|████      | 16/40 [00:10<00:16,  1.46it/s] 42%|████▎     | 17/40 [00:11<00:15,  1.47it/s] 45%|████▌     | 18/40 [00:12<00:14,  1.47it/s] 48%|████▊     | 19/40 [00:12<00:14,  1.47it/s] 50%|█████     | 20/40 [00:13<00:13,  1.48it/s] 52%|█████▎    | 21/40 [00:14<00:12,  1.48it/s] 55%|█████▌    | 22/40 [00:14<00:12,  1.47it/s] 57%|█████▊    | 23/40 [00:15<00:11,  1.48it/s] 60%|██████    | 24/40 [00:16<00:10,  1.47it/s] 62%|██████▎   | 25/40 [00:16<00:10,  1.46it/s] 65%|██████▌   | 26/40 [00:17<00:09,  1.48it/s] 68%|██████▊   | 27/40 [00:18<00:08,  1.47it/s] 70%|███████   | 28/40 [00:19<00:08,  1.48it/s] 72%|███████▎  | 29/40 [00:19<00:07,  1.47it/s] 75%|███████▌  | 30/40 [00:20<00:06,  1.48it/s] 78%|███████▊  | 31/40 [00:21<00:06,  1.48it/s] 80%|████████  | 32/40 [00:21<00:05,  1.48it/s] 82%|████████▎ | 33/40 [00:22<00:04,  1.47it/s] 85%|████████▌ | 34/40 [00:23<00:04,  1.48it/s] 88%|████████▊ | 35/40 [00:23<00:03,  1.47it/s] 90%|█████████ | 36/40 [00:24<00:02,  1.47it/s] 92%|█████████▎| 37/40 [00:25<00:02,  1.47it/s] 95%|█████████▌| 38/40 [00:25<00:01,  1.46it/s] 98%|█████████▊| 39/40 [00:26<00:00,  1.46it/s]100%|██████████| 40/40 [00:26<00:00,  1.62it/s]100%|██████████| 40/40 [00:26<00:00,  1.48it/s]
[32m2025-02-05 05:29:38.342[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    average  bleu@1  bleu@2  bleu@3  bleu@4  dist@1  dist@2  dist@3  dist@4  extreme  \
      .7721   .2970   .1065  .04747  .02807  .04308   .2945   .5983   .7847    .5870   
      f1  gen_loss  greedy  intra_dist@1  intra_dist@2  intra_dist@3  intra_dist@4  \
   .3545     4.331   .6656         .8913         .9807         .9584         .9179   
     ppl  rouge1  rouge2  rougeL  
   76.04   .3869  .09051   .3747[0m
[32m2025-02-05 05:29:38.347[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m163[0m - [1m[Conversation epoch 20][0m
[32m2025-02-05 05:29:38.347[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m164[0m - [1m[Train][0m
  0%|          | 0/92414 [00:00<?, ?it/s]100%|██████████| 92414/92414 [00:00<00:00, 1115813.50it/s]
[32m2025-02-05 05:29:38.430[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/358 [00:00<?, ?it/s]  0%|          | 1/358 [00:00<00:36,  9.76it/s]  1%|          | 3/358 [00:00<00:35,  9.93it/s]  1%|          | 4/358 [00:00<00:35,  9.90it/s]  2%|▏         | 6/358 [00:00<00:35,  9.86it/s]  2%|▏         | 7/358 [00:00<00:35,  9.80it/s]  2%|▏         | 8/358 [00:00<00:35,  9.84it/s]  3%|▎         | 9/358 [00:00<00:35,  9.74it/s]  3%|▎         | 10/358 [00:01<00:35,  9.74it/s]  3%|▎         | 11/358 [00:01<00:35,  9.69it/s]  4%|▎         | 13/358 [00:01<00:34,  9.90it/s]  4%|▍         | 14/358 [00:01<00:34,  9.83it/s]  4%|▍         | 15/358 [00:01<00:35,  9.75it/s]  4%|▍         | 16/358 [00:01<00:35,  9.69it/s]  5%|▍         | 17/358 [00:01<00:35,  9.71it/s]  5%|▌         | 18/358 [00:01<00:34,  9.78it/s]  5%|▌         | 19/358 [00:01<00:34,  9.72it/s]  6%|▌         | 20/358 [00:02<00:34,  9.66it/s]  6%|▌         | 21/358 [00:02<00:35,  9.59it/s]  6%|▌         | 22/358 [00:02<00:34,  9.66it/s]  7%|▋         | 24/358 [00:02<00:34,  9.76it/s]  7%|▋         | 25/358 [00:02<00:34,  9.71it/s]  7%|▋         | 26/358 [00:02<00:34,  9.66it/s]  8%|▊         | 27/358 [00:02<00:34,  9.72it/s]  8%|▊         | 28/358 [00:02<00:34,  9.67it/s]  8%|▊         | 29/358 [00:02<00:34,  9.64it/s]  9%|▊         | 31/358 [00:03<00:33,  9.73it/s]  9%|▉         | 32/358 [00:03<00:33,  9.73it/s]  9%|▉         | 34/358 [00:03<00:32,  9.83it/s] 10%|█         | 36/358 [00:03<00:32,  9.83it/s] 10%|█         | 37/358 [00:03<00:32,  9.81it/s] 11%|█         | 38/358 [00:03<00:32,  9.77it/s] 11%|█         | 40/358 [00:04<00:32,  9.93it/s] 11%|█▏        | 41/358 [00:04<00:32,  9.84it/s] 12%|█▏        | 43/358 [00:04<00:31,  9.87it/s] 13%|█▎        | 45/358 [00:04<00:31,  9.96it/s] 13%|█▎        | 47/358 [00:04<00:31,  9.94it/s] 13%|█▎        | 48/358 [00:04<00:31,  9.93it/s] 14%|█▍        | 50/358 [00:05<00:31,  9.90it/s] 14%|█▍        | 51/358 [00:05<00:31,  9.83it/s] 15%|█▍        | 52/358 [00:05<00:31,  9.74it/s] 15%|█▍        | 53/358 [00:05<00:31,  9.69it/s] 15%|█▌        | 54/358 [00:05<00:31,  9.73it/s] 15%|█▌        | 55/358 [00:05<00:31,  9.68it/s] 16%|█▌        | 56/358 [00:05<00:31,  9.72it/s] 16%|█▌        | 57/358 [00:05<00:31,  9.68it/s] 16%|█▌        | 58/358 [00:05<00:31,  9.66it/s] 16%|█▋        | 59/358 [00:06<00:31,  9.62it/s] 17%|█▋        | 61/358 [00:06<00:30,  9.71it/s] 17%|█▋        | 62/358 [00:06<00:30,  9.63it/s] 18%|█▊        | 63/358 [00:06<00:30,  9.70it/s] 18%|█▊        | 64/358 [00:06<00:30,  9.65it/s] 18%|█▊        | 66/358 [00:06<00:30,  9.72it/s] 19%|█▊        | 67/358 [00:06<00:29,  9.71it/s] 19%|█▉        | 68/358 [00:06<00:29,  9.76it/s] 19%|█▉        | 69/358 [00:07<00:29,  9.68it/s] 20%|█▉        | 70/358 [00:07<00:29,  9.64it/s] 20%|█▉        | 71/358 [00:07<00:29,  9.71it/s] 20%|██        | 72/358 [00:07<00:29,  9.66it/s] 20%|██        | 73/358 [00:07<00:29,  9.63it/s] 21%|██        | 74/358 [00:07<00:29,  9.61it/s] 21%|██        | 75/358 [00:07<00:29,  9.58it/s] 21%|██        | 76/358 [00:07<00:29,  9.69it/s] 22%|██▏       | 77/358 [00:07<00:29,  9.66it/s] 22%|██▏       | 79/358 [00:08<00:28,  9.67it/s] 23%|██▎       | 81/358 [00:08<00:28,  9.73it/s] 23%|██▎       | 83/358 [00:08<00:28,  9.76it/s] 23%|██▎       | 84/358 [00:08<00:28,  9.71it/s] 24%|██▎       | 85/358 [00:08<00:28,  9.66it/s] 24%|██▍       | 86/358 [00:08<00:28,  9.65it/s] 24%|██▍       | 87/358 [00:08<00:28,  9.63it/s] 25%|██▍       | 88/358 [00:09<00:27,  9.65it/s] 25%|██▌       | 90/358 [00:09<00:27,  9.89it/s] 26%|██▌       | 92/358 [00:09<00:26,  9.99it/s] 26%|██▌       | 93/358 [00:09<00:26,  9.95it/s] 26%|██▋       | 94/358 [00:09<00:26,  9.86it/s] 27%|██▋       | 96/358 [00:09<00:25, 10.14it/s] 27%|██▋       | 98/358 [00:10<00:25, 10.03it/s] 28%|██▊       | 99/358 [00:10<00:26,  9.94it/s] 28%|██▊       | 101/358 [00:10<00:25,  9.91it/s] 29%|██▉       | 103/358 [00:10<00:25,  9.90it/s] 29%|██▉       | 104/358 [00:10<00:25,  9.85it/s] 29%|██▉       | 105/358 [00:10<00:25,  9.77it/s] 30%|██▉       | 106/358 [00:10<00:25,  9.75it/s] 30%|███       | 108/358 [00:11<00:25,  9.78it/s] 30%|███       | 109/358 [00:11<00:25,  9.70it/s] 31%|███       | 110/358 [00:11<00:25,  9.68it/s] 31%|███       | 111/358 [00:11<00:25,  9.63it/s] 32%|███▏      | 113/358 [00:11<00:24,  9.90it/s] 32%|███▏      | 114/358 [00:11<00:24,  9.85it/s] 32%|███▏      | 115/358 [00:11<00:24,  9.76it/s] 32%|███▏      | 116/358 [00:11<00:25,  9.67it/s] 33%|███▎      | 117/358 [00:11<00:24,  9.65it/s] 33%|███▎      | 119/358 [00:12<00:24,  9.77it/s] 34%|███▍      | 121/358 [00:12<00:23,  9.96it/s] 34%|███▍      | 123/358 [00:12<00:23, 10.04it/s] 35%|███▍      | 125/358 [00:12<00:23, 10.03it/s] 35%|███▌      | 126/358 [00:12<00:23,  9.99it/s] 35%|███▌      | 127/358 [00:12<00:23,  9.95it/s] 36%|███▌      | 128/358 [00:13<00:23,  9.90it/s] 36%|███▋      | 130/358 [00:13<00:22,  9.97it/s] 37%|███▋      | 131/358 [00:13<00:22,  9.87it/s] 37%|███▋      | 132/358 [00:13<00:22,  9.90it/s] 37%|███▋      | 134/358 [00:13<00:22,  9.92it/s] 38%|███▊      | 135/358 [00:13<00:22,  9.86it/s] 38%|███▊      | 137/358 [00:13<00:22,  9.95it/s] 39%|███▊      | 138/358 [00:14<00:22,  9.93it/s] 39%|███▉      | 139/358 [00:14<00:22,  9.84it/s] 39%|███▉      | 141/358 [00:14<00:21,  9.96it/s] 40%|███▉      | 142/358 [00:14<00:21,  9.88it/s] 40%|███▉      | 143/358 [00:14<00:21,  9.85it/s] 40%|████      | 144/358 [00:14<00:21,  9.77it/s] 41%|████      | 145/358 [00:14<00:21,  9.79it/s] 41%|████      | 146/358 [00:14<00:21,  9.72it/s] 41%|████      | 147/358 [00:15<00:21,  9.67it/s] 41%|████▏     | 148/358 [00:15<00:21,  9.69it/s] 42%|████▏     | 149/358 [00:15<00:21,  9.67it/s] 42%|████▏     | 150/358 [00:15<00:21,  9.63it/s] 42%|████▏     | 151/358 [00:15<00:22,  9.36it/s] 42%|████▏     | 152/358 [00:15<00:21,  9.41it/s] 43%|████▎     | 153/358 [00:15<00:21,  9.43it/s] 43%|████▎     | 154/358 [00:15<00:21,  9.53it/s] 43%|████▎     | 155/358 [00:15<00:21,  9.54it/s] 44%|████▎     | 156/358 [00:15<00:20,  9.66it/s] 44%|████▍     | 157/358 [00:16<00:20,  9.61it/s] 44%|████▍     | 158/358 [00:16<00:20,  9.69it/s] 44%|████▍     | 159/358 [00:16<00:20,  9.69it/s] 45%|████▍     | 160/358 [00:16<00:20,  9.69it/s] 45%|████▌     | 162/358 [00:16<00:19,  9.99it/s] 46%|████▌     | 164/358 [00:16<00:19,  9.99it/s] 46%|████▌     | 165/358 [00:16<00:19,  9.95it/s] 47%|████▋     | 167/358 [00:17<00:19,  9.89it/s] 47%|████▋     | 169/358 [00:17<00:19,  9.93it/s] 48%|████▊     | 171/358 [00:17<00:18,  9.91it/s] 48%|████▊     | 172/358 [00:17<00:18,  9.86it/s] 48%|████▊     | 173/358 [00:17<00:18,  9.79it/s] 49%|████▉     | 175/358 [00:17<00:18,  9.81it/s] 49%|████▉     | 176/358 [00:17<00:18,  9.83it/s] 49%|████▉     | 177/358 [00:18<00:18,  9.81it/s] 50%|████▉     | 178/358 [00:18<00:18,  9.86it/s] 50%|█████     | 179/358 [00:18<00:18,  9.82it/s] 50%|█████     | 180/358 [00:18<00:18,  9.74it/s] 51%|█████     | 182/358 [00:18<00:17,  9.92it/s] 51%|█████     | 183/358 [00:18<00:17,  9.87it/s] 51%|█████▏    | 184/358 [00:18<00:17,  9.75it/s] 52%|█████▏    | 185/358 [00:18<00:17,  9.70it/s] 52%|█████▏    | 187/358 [00:19<00:17,  9.92it/s] 53%|█████▎    | 188/358 [00:19<00:17,  9.87it/s] 53%|█████▎    | 189/358 [00:19<00:17,  9.81it/s] 53%|█████▎    | 190/358 [00:19<00:17,  9.86it/s] 53%|█████▎    | 191/358 [00:19<00:17,  9.69it/s] 54%|█████▎    | 192/358 [00:19<00:17,  9.64it/s] 54%|█████▍    | 193/358 [00:19<00:17,  9.64it/s] 54%|█████▍    | 194/358 [00:19<00:17,  9.63it/s] 54%|█████▍    | 195/358 [00:19<00:16,  9.71it/s] 55%|█████▌    | 197/358 [00:20<00:16,  9.89it/s] 55%|█████▌    | 198/358 [00:20<00:16,  9.82it/s] 56%|█████▌    | 199/358 [00:20<00:16,  9.85it/s] 56%|█████▌    | 200/358 [00:20<00:16,  9.78it/s] 56%|█████▌    | 201/358 [00:20<00:16,  9.74it/s] 57%|█████▋    | 203/358 [00:20<00:15,  9.83it/s] 57%|█████▋    | 204/358 [00:20<00:15,  9.73it/s] 57%|█████▋    | 205/358 [00:20<00:15,  9.69it/s] 58%|█████▊    | 207/358 [00:21<00:15,  9.86it/s] 58%|█████▊    | 208/358 [00:21<00:15,  9.79it/s] 59%|█████▊    | 210/358 [00:21<00:15,  9.81it/s] 59%|█████▉    | 212/358 [00:21<00:14,  9.80it/s] 60%|█████▉    | 214/358 [00:21<00:14,  9.87it/s] 60%|██████    | 215/358 [00:21<00:14,  9.81it/s] 60%|██████    | 216/358 [00:22<00:14,  9.75it/s] 61%|██████    | 217/358 [00:22<00:14,  9.78it/s] 61%|██████    | 218/358 [00:22<00:14,  9.75it/s] 61%|██████    | 219/358 [00:22<00:14,  9.76it/s] 62%|██████▏   | 221/358 [00:22<00:13,  9.89it/s] 62%|██████▏   | 222/358 [00:22<00:13,  9.79it/s] 62%|██████▏   | 223/358 [00:22<00:13,  9.73it/s] 63%|██████▎   | 224/358 [00:22<00:13,  9.67it/s] 63%|██████▎   | 225/358 [00:22<00:13,  9.75it/s] 63%|██████▎   | 226/358 [00:23<00:13,  9.70it/s] 64%|██████▎   | 228/358 [00:23<00:13,  9.74it/s] 64%|██████▍   | 229/358 [00:23<00:13,  9.71it/s] 64%|██████▍   | 230/358 [00:23<00:13,  9.66it/s] 65%|██████▍   | 232/358 [00:23<00:12,  9.72it/s] 65%|██████▌   | 234/358 [00:23<00:12, 10.01it/s] 66%|██████▌   | 236/358 [00:24<00:12,  9.97it/s] 66%|██████▋   | 238/358 [00:24<00:11, 10.01it/s] 67%|██████▋   | 240/358 [00:24<00:11,  9.98it/s] 68%|██████▊   | 242/358 [00:24<00:11,  9.95it/s] 68%|██████▊   | 243/358 [00:24<00:11,  9.89it/s] 68%|██████▊   | 244/358 [00:24<00:11,  9.83it/s] 69%|██████▊   | 246/358 [00:25<00:11,  9.85it/s] 69%|██████▉   | 247/358 [00:25<00:11,  9.78it/s] 69%|██████▉   | 248/358 [00:25<00:11,  9.74it/s] 70%|██████▉   | 250/358 [00:25<00:10,  9.83it/s] 70%|███████   | 251/358 [00:25<00:10,  9.77it/s] 70%|███████   | 252/358 [00:25<00:10,  9.71it/s] 71%|███████   | 253/358 [00:25<00:10,  9.67it/s] 71%|███████   | 254/358 [00:25<00:10,  9.64it/s] 72%|███████▏  | 256/358 [00:26<00:10,  9.82it/s] 72%|███████▏  | 257/358 [00:26<00:10,  9.82it/s] 72%|███████▏  | 258/358 [00:26<00:10,  9.69it/s] 72%|███████▏  | 259/358 [00:26<00:10,  9.66it/s] 73%|███████▎  | 260/358 [00:26<00:10,  9.70it/s] 73%|███████▎  | 262/358 [00:26<00:09,  9.88it/s] 74%|███████▎  | 264/358 [00:26<00:09,  9.90it/s] 74%|███████▍  | 266/358 [00:27<00:09,  9.89it/s] 75%|███████▍  | 267/358 [00:27<00:09,  9.83it/s] 75%|███████▌  | 269/358 [00:27<00:09,  9.88it/s] 75%|███████▌  | 270/358 [00:27<00:08,  9.81it/s] 76%|███████▌  | 271/358 [00:27<00:08,  9.74it/s] 76%|███████▌  | 272/358 [00:27<00:08,  9.72it/s] 76%|███████▋  | 273/358 [00:27<00:08,  9.62it/s] 77%|███████▋  | 274/358 [00:27<00:08,  9.62it/s] 77%|███████▋  | 275/358 [00:28<00:08,  9.67it/s] 77%|███████▋  | 276/358 [00:28<00:08,  9.67it/s] 77%|███████▋  | 277/358 [00:28<00:08,  9.64it/s] 78%|███████▊  | 278/358 [00:28<00:08,  9.62it/s] 78%|███████▊  | 280/358 [00:28<00:07,  9.80it/s] 78%|███████▊  | 281/358 [00:28<00:07,  9.81it/s] 79%|███████▉  | 282/358 [00:28<00:07,  9.75it/s] 79%|███████▉  | 283/358 [00:28<00:07,  9.69it/s] 79%|███████▉  | 284/358 [00:29<00:07,  9.65it/s] 80%|███████▉  | 285/358 [00:29<00:07,  9.72it/s] 80%|███████▉  | 286/358 [00:29<00:07,  9.68it/s] 80%|████████  | 287/358 [00:29<00:07,  9.65it/s] 80%|████████  | 288/358 [00:29<00:07,  9.61it/s] 81%|████████  | 290/358 [00:29<00:06,  9.83it/s] 81%|████████▏ | 291/358 [00:29<00:06,  9.81it/s] 82%|████████▏ | 293/358 [00:29<00:06,  9.82it/s] 82%|████████▏ | 295/358 [00:30<00:06,  9.89it/s] 83%|████████▎ | 296/358 [00:30<00:06,  9.83it/s] 83%|████████▎ | 297/358 [00:30<00:06,  9.72it/s] 84%|████████▎ | 299/358 [00:30<00:05,  9.88it/s] 84%|████████▍ | 301/358 [00:30<00:05,  9.92it/s] 84%|████████▍ | 302/358 [00:30<00:05,  9.85it/s] 85%|████████▍ | 303/358 [00:30<00:05,  9.86it/s] 85%|████████▌ | 305/358 [00:31<00:05,  9.89it/s] 85%|████████▌ | 306/358 [00:31<00:05,  9.81it/s] 86%|████████▌ | 308/358 [00:31<00:05,  9.91it/s] 86%|████████▋ | 309/358 [00:31<00:04,  9.81it/s] 87%|████████▋ | 310/358 [00:31<00:04,  9.75it/s] 87%|████████▋ | 311/358 [00:31<00:04,  9.68it/s] 87%|████████▋ | 312/358 [00:31<00:04,  9.70it/s] 87%|████████▋ | 313/358 [00:31<00:04,  9.71it/s] 88%|████████▊ | 315/358 [00:32<00:04,  9.97it/s] 88%|████████▊ | 316/358 [00:32<00:04,  9.92it/s] 89%|████████▊ | 317/358 [00:32<00:04,  9.83it/s] 89%|████████▉ | 318/358 [00:32<00:04,  9.79it/s] 89%|████████▉ | 319/358 [00:32<00:04,  9.74it/s] 89%|████████▉ | 320/358 [00:32<00:03,  9.80it/s] 90%|████████▉ | 321/358 [00:32<00:03,  9.73it/s] 90%|████████▉ | 322/358 [00:32<00:03,  9.69it/s] 90%|█████████ | 323/358 [00:32<00:03,  9.64it/s] 91%|█████████ | 324/358 [00:33<00:03,  9.61it/s] 91%|█████████ | 325/358 [00:33<00:03,  9.59it/s] 91%|█████████▏| 327/358 [00:33<00:03,  9.95it/s] 92%|█████████▏| 329/358 [00:33<00:02, 10.05it/s] 92%|█████████▏| 330/358 [00:33<00:02,  9.95it/s] 93%|█████████▎| 332/358 [00:33<00:02, 10.04it/s] 93%|█████████▎| 334/358 [00:34<00:02,  9.94it/s] 94%|█████████▎| 335/358 [00:34<00:02,  9.82it/s] 94%|█████████▍| 337/358 [00:34<00:02,  9.91it/s] 95%|█████████▍| 339/358 [00:34<00:01, 10.10it/s] 95%|█████████▌| 341/358 [00:34<00:01, 10.05it/s] 96%|█████████▌| 343/358 [00:35<00:01,  9.89it/s] 96%|█████████▌| 344/358 [00:35<00:01,  9.83it/s] 96%|█████████▋| 345/358 [00:35<00:01,  9.85it/s] 97%|█████████▋| 346/358 [00:35<00:01,  9.88it/s] 97%|█████████▋| 348/358 [00:35<00:01,  9.97it/s] 97%|█████████▋| 349/358 [00:35<00:00,  9.88it/s] 98%|█████████▊| 350/358 [00:35<00:00,  9.80it/s] 98%|█████████▊| 351/358 [00:35<00:00,  9.75it/s] 99%|█████████▊| 353/358 [00:36<00:00,  9.92it/s] 99%|█████████▉| 354/358 [00:36<00:00,  9.90it/s] 99%|█████████▉| 355/358 [00:36<00:00,  9.81it/s]100%|█████████▉| 357/358 [00:36<00:00,  9.86it/s]100%|██████████| 358/358 [00:36<00:00,  9.81it/s]
[32m2025-02-05 05:30:14.936[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    gen_loss  grad clip ratio  grad norm   ppl
        2.34                1       3.76 10.38[0m
[32m2025-02-05 05:30:14.936[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m169[0m - [1m[Valid][0m
  0%|          | 0/10256 [00:00<?, ?it/s]100%|██████████| 10256/10256 [00:00<00:00, 1029700.83it/s]
[32m2025-02-05 05:30:14.947[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:27,  1.43it/s]  5%|▌         | 2/40 [00:01<00:26,  1.46it/s]  8%|▊         | 3/40 [00:02<00:25,  1.47it/s] 10%|█         | 4/40 [00:02<00:24,  1.47it/s] 12%|█▎        | 5/40 [00:03<00:23,  1.46it/s] 15%|█▌        | 6/40 [00:04<00:23,  1.46it/s] 18%|█▊        | 7/40 [00:04<00:22,  1.46it/s] 20%|██        | 8/40 [00:05<00:21,  1.46it/s] 22%|██▎       | 9/40 [00:06<00:21,  1.46it/s] 25%|██▌       | 10/40 [00:06<00:20,  1.47it/s] 28%|██▊       | 11/40 [00:07<00:19,  1.47it/s] 30%|███       | 12/40 [00:08<00:19,  1.47it/s] 32%|███▎      | 13/40 [00:08<00:18,  1.47it/s] 35%|███▌      | 14/40 [00:09<00:17,  1.46it/s] 38%|███▊      | 15/40 [00:10<00:17,  1.46it/s] 40%|████      | 16/40 [00:10<00:16,  1.46it/s] 42%|████▎     | 17/40 [00:11<00:15,  1.47it/s] 45%|████▌     | 18/40 [00:12<00:15,  1.47it/s] 48%|████▊     | 19/40 [00:12<00:14,  1.46it/s] 50%|█████     | 20/40 [00:13<00:13,  1.46it/s] 52%|█████▎    | 21/40 [00:14<00:12,  1.47it/s] 55%|█████▌    | 22/40 [00:15<00:12,  1.47it/s] 57%|█████▊    | 23/40 [00:15<00:11,  1.46it/s] 60%|██████    | 24/40 [00:16<00:10,  1.46it/s] 62%|██████▎   | 25/40 [00:17<00:10,  1.46it/s] 65%|██████▌   | 26/40 [00:17<00:09,  1.47it/s] 68%|██████▊   | 27/40 [00:18<00:08,  1.47it/s] 70%|███████   | 28/40 [00:19<00:08,  1.46it/s] 72%|███████▎  | 29/40 [00:19<00:07,  1.47it/s] 75%|███████▌  | 30/40 [00:20<00:06,  1.47it/s] 78%|███████▊  | 31/40 [00:21<00:06,  1.47it/s] 80%|████████  | 32/40 [00:21<00:05,  1.47it/s] 82%|████████▎ | 33/40 [00:22<00:04,  1.47it/s] 85%|████████▌ | 34/40 [00:23<00:04,  1.47it/s] 88%|████████▊ | 35/40 [00:23<00:03,  1.47it/s] 90%|█████████ | 36/40 [00:24<00:02,  1.46it/s] 92%|█████████▎| 37/40 [00:25<00:02,  1.47it/s] 95%|█████████▌| 38/40 [00:25<00:01,  1.46it/s] 98%|█████████▊| 39/40 [00:26<00:00,  1.46it/s]100%|██████████| 40/40 [00:27<00:00,  1.61it/s]100%|██████████| 40/40 [00:27<00:00,  1.48it/s]
[32m2025-02-05 05:30:42.069[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    average  bleu@1  bleu@2  bleu@3  bleu@4  dist@1  dist@2  dist@3  dist@4  extreme  \
      .7656   .2887   .1038  .04268  .02129   .0466   .3340   .6524   .8334    .5748   
      f1  gen_loss  greedy  intra_dist@1  intra_dist@2  intra_dist@3  intra_dist@4  \
   .3462     4.428   .6606         .8999         .9839         .9612         .9140   
     ppl  rouge1  rouge2  rougeL  
   83.73   .3793  .08786   .3662[0m
[32m2025-02-05 05:30:42.076[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m163[0m - [1m[Conversation epoch 21][0m
[32m2025-02-05 05:30:42.076[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m164[0m - [1m[Train][0m
  0%|          | 0/92414 [00:00<?, ?it/s]100%|██████████| 92414/92414 [00:00<00:00, 996566.15it/s]
[32m2025-02-05 05:30:42.169[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/358 [00:00<?, ?it/s]  0%|          | 1/358 [00:00<00:36,  9.73it/s]  1%|          | 3/358 [00:00<00:35,  9.91it/s]  1%|          | 4/358 [00:00<00:35,  9.89it/s]  2%|▏         | 6/358 [00:00<00:35,  9.86it/s]  2%|▏         | 7/358 [00:00<00:35,  9.79it/s]  2%|▏         | 8/358 [00:00<00:35,  9.84it/s]  3%|▎         | 9/358 [00:00<00:35,  9.74it/s]  3%|▎         | 10/358 [00:01<00:35,  9.73it/s]  3%|▎         | 11/358 [00:01<00:35,  9.68it/s]  4%|▎         | 13/358 [00:01<00:34,  9.90it/s]  4%|▍         | 14/358 [00:01<00:34,  9.83it/s]  4%|▍         | 15/358 [00:01<00:35,  9.75it/s]  4%|▍         | 16/358 [00:01<00:35,  9.69it/s]  5%|▍         | 17/358 [00:01<00:35,  9.71it/s]  5%|▌         | 18/358 [00:01<00:34,  9.78it/s]  5%|▌         | 19/358 [00:01<00:34,  9.71it/s]  6%|▌         | 20/358 [00:02<00:34,  9.66it/s]  6%|▌         | 21/358 [00:02<00:35,  9.59it/s]  6%|▌         | 22/358 [00:02<00:34,  9.66it/s]  7%|▋         | 24/358 [00:02<00:34,  9.76it/s]  7%|▋         | 25/358 [00:02<00:34,  9.71it/s]  7%|▋         | 26/358 [00:02<00:34,  9.65it/s]  8%|▊         | 27/358 [00:02<00:34,  9.71it/s]  8%|▊         | 28/358 [00:02<00:34,  9.66it/s]  8%|▊         | 29/358 [00:02<00:34,  9.63it/s]  9%|▊         | 31/358 [00:03<00:33,  9.74it/s]  9%|▉         | 32/358 [00:03<00:33,  9.73it/s]  9%|▉         | 34/358 [00:03<00:32,  9.83it/s] 10%|█         | 36/358 [00:03<00:32,  9.83it/s] 10%|█         | 37/358 [00:03<00:32,  9.81it/s] 11%|█         | 38/358 [00:03<00:32,  9.77it/s] 11%|█         | 40/358 [00:04<00:32,  9.93it/s] 11%|█▏        | 41/358 [00:04<00:32,  9.84it/s] 12%|█▏        | 43/358 [00:04<00:31,  9.87it/s] 13%|█▎        | 45/358 [00:04<00:31,  9.96it/s] 13%|█▎        | 47/358 [00:04<00:31,  9.94it/s] 13%|█▎        | 48/358 [00:04<00:31,  9.93it/s] 14%|█▍        | 50/358 [00:05<00:31,  9.90it/s] 14%|█▍        | 51/358 [00:05<00:31,  9.82it/s] 15%|█▍        | 52/358 [00:05<00:31,  9.72it/s] 15%|█▍        | 53/358 [00:05<00:31,  9.67it/s] 15%|█▌        | 54/358 [00:05<00:31,  9.72it/s] 15%|█▌        | 55/358 [00:05<00:31,  9.67it/s] 16%|█▌        | 56/358 [00:05<00:31,  9.71it/s] 16%|█▌        | 57/358 [00:05<00:31,  9.67it/s] 16%|█▌        | 58/358 [00:05<00:31,  9.65it/s] 16%|█▋        | 59/358 [00:06<00:31,  9.62it/s] 17%|█▋        | 61/358 [00:06<00:30,  9.70it/s] 17%|█▋        | 62/358 [00:06<00:30,  9.63it/s] 18%|█▊        | 63/358 [00:06<00:30,  9.69it/s] 18%|█▊        | 64/358 [00:06<00:30,  9.65it/s] 18%|█▊        | 66/358 [00:06<00:30,  9.71it/s] 19%|█▊        | 67/358 [00:06<00:29,  9.70it/s] 19%|█▉        | 69/358 [00:07<00:29,  9.77it/s] 20%|█▉        | 70/358 [00:07<00:29,  9.71it/s] 20%|█▉        | 71/358 [00:07<00:29,  9.76it/s] 20%|██        | 72/358 [00:07<00:29,  9.71it/s] 20%|██        | 73/358 [00:07<00:29,  9.67it/s] 21%|██        | 74/358 [00:07<00:29,  9.64it/s] 21%|██        | 75/358 [00:07<00:29,  9.61it/s] 21%|██        | 76/358 [00:07<00:29,  9.69it/s] 22%|██▏       | 77/358 [00:07<00:29,  9.66it/s] 22%|██▏       | 79/358 [00:08<00:28,  9.68it/s] 23%|██▎       | 81/358 [00:08<00:28,  9.74it/s] 23%|██▎       | 83/358 [00:08<00:28,  9.77it/s] 23%|██▎       | 84/358 [00:08<00:28,  9.71it/s] 24%|██▎       | 85/358 [00:08<00:28,  9.67it/s] 24%|██▍       | 86/358 [00:08<00:28,  9.66it/s] 24%|██▍       | 87/358 [00:08<00:28,  9.64it/s] 25%|██▍       | 88/358 [00:09<00:27,  9.66it/s] 25%|██▌       | 90/358 [00:09<00:27,  9.90it/s] 26%|██▌       | 92/358 [00:09<00:26,  9.99it/s] 26%|██▌       | 93/358 [00:09<00:26,  9.96it/s] 26%|██▋       | 94/358 [00:09<00:26,  9.87it/s] 27%|██▋       | 96/358 [00:09<00:25, 10.15it/s] 27%|██▋       | 98/358 [00:10<00:25, 10.04it/s] 28%|██▊       | 99/358 [00:10<00:26,  9.95it/s] 28%|██▊       | 101/358 [00:10<00:25,  9.92it/s] 29%|██▉       | 103/358 [00:10<00:25,  9.90it/s] 29%|██▉       | 104/358 [00:10<00:25,  9.85it/s] 29%|██▉       | 105/358 [00:10<00:25,  9.78it/s] 30%|██▉       | 106/358 [00:10<00:25,  9.76it/s] 30%|███       | 108/358 [00:11<00:25,  9.79it/s] 30%|███       | 109/358 [00:11<00:25,  9.70it/s] 31%|███       | 110/358 [00:11<00:25,  9.69it/s] 31%|███       | 111/358 [00:11<00:25,  9.64it/s] 32%|███▏      | 113/358 [00:11<00:24,  9.90it/s] 32%|███▏      | 114/358 [00:11<00:24,  9.86it/s] 32%|███▏      | 115/358 [00:11<00:24,  9.77it/s] 32%|███▏      | 116/358 [00:11<00:24,  9.68it/s] 33%|███▎      | 117/358 [00:11<00:24,  9.66it/s] 33%|███▎      | 119/358 [00:12<00:24,  9.78it/s] 34%|███▍      | 121/358 [00:12<00:23,  9.97it/s] 34%|███▍      | 123/358 [00:12<00:23, 10.07it/s] 35%|███▍      | 125/358 [00:12<00:23, 10.04it/s] 35%|███▌      | 126/358 [00:12<00:23, 10.00it/s] 35%|███▌      | 127/358 [00:12<00:23,  9.95it/s] 36%|███▌      | 128/358 [00:13<00:23,  9.91it/s] 36%|███▋      | 130/358 [00:13<00:22,  9.97it/s] 37%|███▋      | 131/358 [00:13<00:23,  9.87it/s] 37%|███▋      | 132/358 [00:13<00:22,  9.89it/s] 37%|███▋      | 134/358 [00:13<00:22,  9.92it/s] 38%|███▊      | 135/358 [00:13<00:22,  9.86it/s] 38%|███▊      | 137/358 [00:13<00:22,  9.94it/s] 39%|███▊      | 138/358 [00:14<00:22,  9.92it/s] 39%|███▉      | 139/358 [00:14<00:22,  9.84it/s] 39%|███▉      | 141/358 [00:14<00:21,  9.96it/s] 40%|███▉      | 142/358 [00:14<00:21,  9.88it/s] 40%|███▉      | 143/358 [00:14<00:21,  9.85it/s] 40%|████      | 144/358 [00:14<00:21,  9.77it/s] 41%|████      | 145/358 [00:14<00:21,  9.79it/s] 41%|████      | 146/358 [00:14<00:21,  9.72it/s] 41%|████      | 147/358 [00:15<00:21,  9.67it/s] 41%|████▏     | 148/358 [00:15<00:21,  9.70it/s] 42%|████▏     | 149/358 [00:15<00:21,  9.68it/s] 42%|████▏     | 150/358 [00:15<00:21,  9.64it/s] 42%|████▏     | 151/358 [00:15<00:22,  9.37it/s] 42%|████▏     | 152/358 [00:15<00:21,  9.42it/s] 43%|████▎     | 153/358 [00:15<00:21,  9.44it/s] 43%|████▎     | 154/358 [00:15<00:21,  9.53it/s] 43%|████▎     | 155/358 [00:15<00:21,  9.54it/s] 44%|████▎     | 156/358 [00:15<00:20,  9.67it/s] 44%|████▍     | 157/358 [00:16<00:20,  9.61it/s] 44%|████▍     | 158/358 [00:16<00:20,  9.69it/s] 44%|████▍     | 159/358 [00:16<00:20,  9.69it/s] 45%|████▍     | 160/358 [00:16<00:20,  9.70it/s] 45%|████▌     | 162/358 [00:16<00:19,  9.99it/s] 46%|████▌     | 164/358 [00:16<00:19,  9.99it/s] 46%|████▌     | 165/358 [00:16<00:19,  9.94it/s] 47%|████▋     | 167/358 [00:17<00:19,  9.89it/s] 47%|████▋     | 169/358 [00:17<00:19,  9.93it/s] 48%|████▊     | 171/358 [00:17<00:18,  9.92it/s] 48%|████▊     | 172/358 [00:17<00:18,  9.86it/s] 48%|████▊     | 173/358 [00:17<00:18,  9.79it/s] 49%|████▉     | 175/358 [00:17<00:18,  9.82it/s] 49%|████▉     | 176/358 [00:17<00:18,  9.83it/s] 49%|████▉     | 177/358 [00:18<00:18,  9.82it/s] 50%|█████     | 179/358 [00:18<00:18,  9.84it/s] 50%|█████     | 180/358 [00:18<00:18,  9.77it/s] 51%|█████     | 182/358 [00:18<00:17,  9.92it/s] 51%|█████     | 183/358 [00:18<00:17,  9.88it/s] 51%|█████▏    | 184/358 [00:18<00:17,  9.77it/s] 52%|█████▏    | 185/358 [00:18<00:17,  9.71it/s] 52%|█████▏    | 187/358 [00:19<00:17,  9.93it/s] 53%|█████▎    | 188/358 [00:19<00:17,  9.88it/s] 53%|█████▎    | 189/358 [00:19<00:17,  9.82it/s] 53%|█████▎    | 190/358 [00:19<00:17,  9.87it/s] 53%|█████▎    | 191/358 [00:19<00:17,  9.69it/s] 54%|█████▎    | 192/358 [00:19<00:17,  9.64it/s] 54%|█████▍    | 193/358 [00:19<00:17,  9.65it/s] 54%|█████▍    | 194/358 [00:19<00:17,  9.63it/s] 54%|█████▍    | 195/358 [00:19<00:16,  9.72it/s] 55%|█████▌    | 197/358 [00:20<00:16,  9.91it/s] 55%|█████▌    | 198/358 [00:20<00:16,  9.83it/s] 56%|█████▌    | 199/358 [00:20<00:16,  9.86it/s] 56%|█████▌    | 200/358 [00:20<00:16,  9.79it/s] 56%|█████▌    | 201/358 [00:20<00:16,  9.75it/s] 57%|█████▋    | 203/358 [00:20<00:15,  9.85it/s] 57%|█████▋    | 204/358 [00:20<00:15,  9.74it/s] 57%|█████▋    | 205/358 [00:20<00:15,  9.70it/s] 58%|█████▊    | 207/358 [00:21<00:15,  9.87it/s] 58%|█████▊    | 208/358 [00:21<00:15,  9.79it/s] 59%|█████▊    | 210/358 [00:21<00:15,  9.81it/s] 59%|█████▉    | 212/358 [00:21<00:14,  9.80it/s] 60%|█████▉    | 214/358 [00:21<00:14,  9.88it/s] 60%|██████    | 215/358 [00:21<00:14,  9.81it/s] 60%|██████    | 216/358 [00:22<00:14,  9.75it/s] 61%|██████    | 217/358 [00:22<00:14,  9.79it/s] 61%|██████    | 218/358 [00:22<00:14,  9.76it/s] 61%|██████    | 219/358 [00:22<00:14,  9.76it/s] 62%|██████▏   | 221/358 [00:22<00:13,  9.89it/s] 62%|██████▏   | 222/358 [00:22<00:13,  9.79it/s] 62%|██████▏   | 223/358 [00:22<00:13,  9.74it/s] 63%|██████▎   | 224/358 [00:22<00:13,  9.68it/s] 63%|██████▎   | 225/358 [00:22<00:13,  9.76it/s] 63%|██████▎   | 226/358 [00:23<00:13,  9.71it/s] 64%|██████▎   | 228/358 [00:23<00:13,  9.75it/s] 64%|██████▍   | 229/358 [00:23<00:13,  9.72it/s] 64%|██████▍   | 230/358 [00:23<00:13,  9.67it/s] 65%|██████▍   | 232/358 [00:23<00:12,  9.72it/s] 65%|██████▌   | 234/358 [00:23<00:12, 10.02it/s] 66%|██████▌   | 236/358 [00:24<00:12,  9.98it/s] 66%|██████▋   | 238/358 [00:24<00:11, 10.03it/s] 67%|██████▋   | 240/358 [00:24<00:11,  9.99it/s] 68%|██████▊   | 242/358 [00:24<00:11,  9.96it/s] 68%|██████▊   | 243/358 [00:24<00:11,  9.90it/s] 68%|██████▊   | 244/358 [00:24<00:11,  9.83it/s] 69%|██████▊   | 246/358 [00:25<00:11,  9.86it/s] 69%|██████▉   | 247/358 [00:25<00:11,  9.79it/s] 69%|██████▉   | 248/358 [00:25<00:11,  9.74it/s] 70%|██████▉   | 250/358 [00:25<00:10,  9.84it/s] 70%|███████   | 251/358 [00:25<00:10,  9.77it/s] 70%|███████   | 252/358 [00:25<00:10,  9.71it/s] 71%|███████   | 253/358 [00:25<00:10,  9.67it/s] 71%|███████   | 254/358 [00:25<00:10,  9.65it/s] 72%|███████▏  | 256/358 [00:26<00:10,  9.82it/s] 72%|███████▏  | 257/358 [00:26<00:10,  9.83it/s] 72%|███████▏  | 258/358 [00:26<00:10,  9.70it/s] 72%|███████▏  | 259/358 [00:26<00:10,  9.67it/s] 73%|███████▎  | 260/358 [00:26<00:10,  9.70it/s] 73%|███████▎  | 262/358 [00:26<00:09,  9.88it/s] 74%|███████▎  | 264/358 [00:26<00:09,  9.90it/s] 74%|███████▍  | 266/358 [00:27<00:09,  9.89it/s] 75%|███████▍  | 267/358 [00:27<00:09,  9.83it/s] 75%|███████▌  | 269/358 [00:27<00:09,  9.89it/s] 75%|███████▌  | 270/358 [00:27<00:08,  9.82it/s] 76%|███████▌  | 271/358 [00:27<00:08,  9.74it/s] 76%|███████▌  | 272/358 [00:27<00:08,  9.72it/s] 76%|███████▋  | 273/358 [00:27<00:08,  9.62it/s] 77%|███████▋  | 274/358 [00:27<00:08,  9.62it/s] 77%|███████▋  | 275/358 [00:28<00:08,  9.67it/s] 77%|███████▋  | 276/358 [00:28<00:08,  9.67it/s] 77%|███████▋  | 277/358 [00:28<00:08,  9.64it/s] 78%|███████▊  | 278/358 [00:28<00:08,  9.62it/s] 78%|███████▊  | 280/358 [00:28<00:07,  9.81it/s] 78%|███████▊  | 281/358 [00:28<00:07,  9.82it/s] 79%|███████▉  | 282/358 [00:28<00:07,  9.76it/s] 79%|███████▉  | 283/358 [00:28<00:07,  9.70it/s] 79%|███████▉  | 284/358 [00:29<00:07,  9.66it/s] 80%|███████▉  | 285/358 [00:29<00:07,  9.72it/s] 80%|███████▉  | 286/358 [00:29<00:07,  9.68it/s] 80%|████████  | 287/358 [00:29<00:07,  9.66it/s] 80%|████████  | 288/358 [00:29<00:07,  9.62it/s] 81%|████████  | 290/358 [00:29<00:06,  9.83it/s] 81%|████████▏ | 291/358 [00:29<00:06,  9.81it/s] 82%|████████▏ | 293/358 [00:29<00:06,  9.83it/s] 82%|████████▏ | 295/358 [00:30<00:06,  9.90it/s] 83%|████████▎ | 296/358 [00:30<00:06,  9.84it/s] 83%|████████▎ | 297/358 [00:30<00:06,  9.73it/s] 84%|████████▎ | 299/358 [00:30<00:05,  9.89it/s] 84%|████████▍ | 301/358 [00:30<00:05,  9.92it/s] 84%|████████▍ | 302/358 [00:30<00:05,  9.86it/s] 85%|████████▍ | 303/358 [00:30<00:05,  9.87it/s] 85%|████████▌ | 305/358 [00:31<00:05,  9.89it/s] 85%|████████▌ | 306/358 [00:31<00:05,  9.82it/s] 86%|████████▌ | 308/358 [00:31<00:05,  9.92it/s] 86%|████████▋ | 309/358 [00:31<00:04,  9.82it/s] 87%|████████▋ | 310/358 [00:31<00:04,  9.76it/s] 87%|████████▋ | 311/358 [00:31<00:04,  9.68it/s] 87%|████████▋ | 312/358 [00:31<00:04,  9.70it/s] 87%|████████▋ | 313/358 [00:31<00:04,  9.72it/s] 88%|████████▊ | 315/358 [00:32<00:04,  9.98it/s] 88%|████████▊ | 316/358 [00:32<00:04,  9.93it/s] 89%|████████▊ | 317/358 [00:32<00:04,  9.84it/s] 89%|████████▉ | 318/358 [00:32<00:04,  9.79it/s] 89%|████████▉ | 319/358 [00:32<00:04,  9.75it/s] 89%|████████▉ | 320/358 [00:32<00:03,  9.81it/s] 90%|████████▉ | 321/358 [00:32<00:03,  9.73it/s] 90%|████████▉ | 322/358 [00:32<00:03,  9.70it/s] 90%|█████████ | 323/358 [00:32<00:03,  9.65it/s] 91%|█████████ | 324/358 [00:33<00:03,  9.62it/s] 91%|█████████ | 325/358 [00:33<00:03,  9.60it/s] 91%|█████████▏| 327/358 [00:33<00:03,  9.96it/s] 92%|█████████▏| 329/358 [00:33<00:02, 10.06it/s] 92%|█████████▏| 330/358 [00:33<00:02,  9.94it/s] 93%|█████████▎| 332/358 [00:33<00:02, 10.05it/s] 93%|█████████▎| 334/358 [00:34<00:02,  9.95it/s] 94%|█████████▎| 335/358 [00:34<00:02,  9.83it/s] 94%|█████████▍| 337/358 [00:34<00:02,  9.91it/s] 95%|█████████▍| 339/358 [00:34<00:01, 10.11it/s] 95%|█████████▌| 341/358 [00:34<00:01, 10.05it/s] 96%|█████████▌| 343/358 [00:34<00:01,  9.89it/s] 96%|█████████▌| 344/358 [00:35<00:01,  9.83it/s] 96%|█████████▋| 345/358 [00:35<00:01,  9.85it/s] 97%|█████████▋| 347/358 [00:35<00:01, 10.03it/s] 97%|█████████▋| 348/358 [00:35<00:01,  9.93it/s] 97%|█████████▋| 349/358 [00:35<00:00,  9.85it/s] 98%|█████████▊| 350/358 [00:35<00:00,  9.78it/s] 98%|█████████▊| 351/358 [00:35<00:00,  9.74it/s] 99%|█████████▊| 353/358 [00:35<00:00,  9.91it/s] 99%|█████████▉| 354/358 [00:36<00:00,  9.90it/s] 99%|█████████▉| 355/358 [00:36<00:00,  9.81it/s]100%|█████████▉| 357/358 [00:36<00:00,  9.86it/s]100%|██████████| 358/358 [00:36<00:00,  9.81it/s]
[32m2025-02-05 05:31:18.655[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    gen_loss  grad clip ratio  grad norm   ppl
       2.313                1      3.676 10.11[0m
[32m2025-02-05 05:31:18.656[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m169[0m - [1m[Valid][0m
  0%|          | 0/10256 [00:00<?, ?it/s]100%|██████████| 10256/10256 [00:00<00:00, 1040611.10it/s]
[32m2025-02-05 05:31:18.666[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:26,  1.45it/s]  5%|▌         | 2/40 [00:01<00:25,  1.47it/s]  8%|▊         | 3/40 [00:02<00:25,  1.47it/s] 10%|█         | 4/40 [00:02<00:24,  1.47it/s] 12%|█▎        | 5/40 [00:03<00:23,  1.46it/s] 15%|█▌        | 6/40 [00:04<00:23,  1.46it/s] 18%|█▊        | 7/40 [00:04<00:22,  1.46it/s] 20%|██        | 8/40 [00:05<00:21,  1.47it/s] 22%|██▎       | 9/40 [00:06<00:21,  1.47it/s] 25%|██▌       | 10/40 [00:06<00:20,  1.47it/s] 28%|██▊       | 11/40 [00:07<00:19,  1.47it/s] 30%|███       | 12/40 [00:08<00:19,  1.47it/s] 32%|███▎      | 13/40 [00:08<00:18,  1.47it/s] 35%|███▌      | 14/40 [00:09<00:17,  1.46it/s] 38%|███▊      | 15/40 [00:10<00:17,  1.46it/s] 40%|████      | 16/40 [00:10<00:16,  1.46it/s] 42%|████▎     | 17/40 [00:11<00:15,  1.47it/s] 45%|████▌     | 18/40 [00:12<00:15,  1.47it/s] 48%|████▊     | 19/40 [00:12<00:14,  1.46it/s] 50%|█████     | 20/40 [00:13<00:13,  1.47it/s] 52%|█████▎    | 21/40 [00:14<00:12,  1.47it/s] 55%|█████▌    | 22/40 [00:14<00:12,  1.47it/s] 57%|█████▊    | 23/40 [00:15<00:11,  1.47it/s] 60%|██████    | 24/40 [00:16<00:10,  1.46it/s] 62%|██████▎   | 25/40 [00:17<00:10,  1.46it/s] 65%|██████▌   | 26/40 [00:17<00:09,  1.47it/s] 68%|██████▊   | 27/40 [00:18<00:08,  1.48it/s] 70%|███████   | 28/40 [00:19<00:08,  1.47it/s] 72%|███████▎  | 29/40 [00:19<00:07,  1.47it/s] 75%|███████▌  | 30/40 [00:20<00:06,  1.48it/s] 78%|███████▊  | 31/40 [00:21<00:06,  1.48it/s] 80%|████████  | 32/40 [00:21<00:05,  1.47it/s] 82%|████████▎ | 33/40 [00:22<00:04,  1.47it/s] 85%|████████▌ | 34/40 [00:23<00:04,  1.47it/s] 88%|████████▊ | 35/40 [00:23<00:03,  1.46it/s] 90%|█████████ | 36/40 [00:24<00:02,  1.46it/s] 92%|█████████▎| 37/40 [00:25<00:02,  1.46it/s] 95%|█████████▌| 38/40 [00:25<00:01,  1.46it/s] 98%|█████████▊| 39/40 [00:26<00:00,  1.46it/s]100%|██████████| 40/40 [00:27<00:00,  1.61it/s]100%|██████████| 40/40 [00:27<00:00,  1.48it/s]
[32m2025-02-05 05:31:45.739[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    average  bleu@1  bleu@2  bleu@3  bleu@4  dist@1  dist@2  dist@3  dist@4  extreme  \
      .7674   .2861   .1022  .04411  .02381   .0398   .2700   .5518   .7223    .5846   
      f1  gen_loss  greedy  intra_dist@1  intra_dist@2  intra_dist@3  intra_dist@4  \
   .3487     4.452   .6635         .8846         .9648         .9429         .8958   
    ppl  rouge1  rouge2  rougeL  
   85.8   .3828  .08769   .3700[0m
[32m2025-02-05 05:31:45.744[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m163[0m - [1m[Conversation epoch 22][0m
[32m2025-02-05 05:31:45.745[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m164[0m - [1m[Train][0m
  0%|          | 0/92414 [00:00<?, ?it/s]100%|██████████| 92414/92414 [00:00<00:00, 988663.41it/s]
[32m2025-02-05 05:31:45.838[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/358 [00:00<?, ?it/s]  0%|          | 1/358 [00:00<00:36,  9.74it/s]  1%|          | 3/358 [00:00<00:35,  9.91it/s]  1%|          | 4/358 [00:00<00:35,  9.89it/s]  2%|▏         | 6/358 [00:00<00:35,  9.86it/s]  2%|▏         | 7/358 [00:00<00:35,  9.80it/s]  2%|▏         | 8/358 [00:00<00:35,  9.84it/s]  3%|▎         | 9/358 [00:00<00:35,  9.74it/s]  3%|▎         | 10/358 [00:01<00:35,  9.73it/s]  3%|▎         | 11/358 [00:01<00:35,  9.68it/s]  4%|▎         | 13/358 [00:01<00:34,  9.90it/s]  4%|▍         | 14/358 [00:01<00:34,  9.83it/s]  4%|▍         | 15/358 [00:01<00:35,  9.75it/s]  4%|▍         | 16/358 [00:01<00:35,  9.69it/s]  5%|▍         | 17/358 [00:01<00:35,  9.71it/s]  5%|▌         | 18/358 [00:01<00:34,  9.78it/s]  5%|▌         | 19/358 [00:01<00:34,  9.71it/s]  6%|▌         | 20/358 [00:02<00:34,  9.66it/s]  6%|▌         | 21/358 [00:02<00:35,  9.59it/s]  6%|▌         | 22/358 [00:02<00:34,  9.65it/s]  7%|▋         | 24/358 [00:02<00:34,  9.75it/s]  7%|▋         | 25/358 [00:02<00:34,  9.70it/s]  7%|▋         | 26/358 [00:02<00:34,  9.65it/s]  8%|▊         | 27/358 [00:02<00:34,  9.71it/s]  8%|▊         | 28/358 [00:02<00:34,  9.66it/s]  8%|▊         | 29/358 [00:02<00:34,  9.63it/s]  9%|▊         | 31/358 [00:03<00:33,  9.73it/s]  9%|▉         | 32/358 [00:03<00:33,  9.73it/s]  9%|▉         | 34/358 [00:03<00:32,  9.83it/s] 10%|█         | 36/358 [00:03<00:32,  9.82it/s] 10%|█         | 37/358 [00:03<00:32,  9.81it/s] 11%|█         | 38/358 [00:03<00:32,  9.76it/s] 11%|█         | 40/358 [00:04<00:32,  9.92it/s] 11%|█▏        | 41/358 [00:04<00:32,  9.83it/s] 12%|█▏        | 43/358 [00:04<00:31,  9.86it/s] 13%|█▎        | 45/358 [00:04<00:31,  9.96it/s] 13%|█▎        | 47/358 [00:04<00:31,  9.93it/s] 13%|█▎        | 48/358 [00:04<00:31,  9.92it/s] 14%|█▍        | 50/358 [00:05<00:31,  9.89it/s] 14%|█▍        | 51/358 [00:05<00:31,  9.83it/s] 15%|█▍        | 52/358 [00:05<00:31,  9.74it/s] 15%|█▍        | 53/358 [00:05<00:31,  9.69it/s] 15%|█▌        | 54/358 [00:05<00:31,  9.73it/s] 15%|█▌        | 55/358 [00:05<00:31,  9.68it/s] 16%|█▌        | 56/358 [00:05<00:31,  9.71it/s] 16%|█▌        | 57/358 [00:05<00:31,  9.68it/s] 16%|█▌        | 58/358 [00:05<00:31,  9.66it/s] 16%|█▋        | 59/358 [00:06<00:31,  9.62it/s] 17%|█▋        | 61/358 [00:06<00:30,  9.71it/s] 17%|█▋        | 62/358 [00:06<00:30,  9.63it/s] 18%|█▊        | 63/358 [00:06<00:30,  9.69it/s] 18%|█▊        | 64/358 [00:06<00:30,  9.65it/s] 18%|█▊        | 66/358 [00:06<00:30,  9.71it/s] 19%|█▊        | 67/358 [00:06<00:30,  9.70it/s] 19%|█▉        | 69/358 [00:07<00:29,  9.76it/s] 20%|█▉        | 70/358 [00:07<00:29,  9.71it/s] 20%|█▉        | 71/358 [00:07<00:29,  9.75it/s] 20%|██        | 72/358 [00:07<00:29,  9.70it/s] 20%|██        | 73/358 [00:07<00:29,  9.67it/s] 21%|██        | 74/358 [00:07<00:29,  9.64it/s] 21%|██        | 75/358 [00:07<00:29,  9.61it/s] 21%|██        | 76/358 [00:07<00:29,  9.71it/s] 22%|██▏       | 77/358 [00:07<00:29,  9.67it/s] 22%|██▏       | 79/358 [00:08<00:28,  9.68it/s] 23%|██▎       | 81/358 [00:08<00:28,  9.74it/s] 23%|██▎       | 83/358 [00:08<00:28,  9.77it/s] 23%|██▎       | 84/358 [00:08<00:28,  9.71it/s] 24%|██▎       | 85/358 [00:08<00:28,  9.67it/s] 24%|██▍       | 86/358 [00:08<00:28,  9.66it/s] 24%|██▍       | 87/358 [00:08<00:28,  9.64it/s] 25%|██▍       | 88/358 [00:09<00:27,  9.66it/s] 25%|██▌       | 90/358 [00:09<00:27,  9.89it/s] 26%|██▌       | 92/358 [00:09<00:26,  9.99it/s] 26%|██▌       | 93/358 [00:09<00:26,  9.96it/s] 26%|██▋       | 94/358 [00:09<00:26,  9.87it/s] 27%|██▋       | 96/358 [00:09<00:25, 10.14it/s] 27%|██▋       | 98/358 [00:10<00:25, 10.03it/s] 28%|██▊       | 99/358 [00:10<00:26,  9.94it/s] 28%|██▊       | 101/358 [00:10<00:25,  9.91it/s] 29%|██▉       | 103/358 [00:10<00:25,  9.90it/s] 29%|██▉       | 104/358 [00:10<00:25,  9.85it/s] 29%|██▉       | 105/358 [00:10<00:25,  9.77it/s] 30%|██▉       | 106/358 [00:10<00:25,  9.76it/s] 30%|███       | 108/358 [00:11<00:25,  9.78it/s] 30%|███       | 109/358 [00:11<00:25,  9.70it/s] 31%|███       | 110/358 [00:11<00:25,  9.68it/s] 31%|███       | 111/358 [00:11<00:25,  9.63it/s] 32%|███▏      | 113/358 [00:11<00:24,  9.90it/s] 32%|███▏      | 114/358 [00:11<00:24,  9.85it/s] 32%|███▏      | 115/358 [00:11<00:24,  9.76it/s] 32%|███▏      | 116/358 [00:11<00:25,  9.68it/s] 33%|███▎      | 117/358 [00:11<00:24,  9.65it/s] 33%|███▎      | 119/358 [00:12<00:24,  9.77it/s] 34%|███▍      | 121/358 [00:12<00:23,  9.97it/s] 34%|███▍      | 123/358 [00:12<00:23, 10.07it/s] 35%|███▍      | 125/358 [00:12<00:23, 10.05it/s] 35%|███▌      | 126/358 [00:12<00:23, 10.01it/s] 35%|███▌      | 127/358 [00:12<00:23,  9.96it/s] 36%|███▌      | 128/358 [00:13<00:23,  9.91it/s] 36%|███▋      | 130/358 [00:13<00:22,  9.97it/s] 37%|███▋      | 131/358 [00:13<00:22,  9.87it/s] 37%|███▋      | 132/358 [00:13<00:22,  9.90it/s] 37%|███▋      | 134/358 [00:13<00:22,  9.92it/s] 38%|███▊      | 135/358 [00:13<00:22,  9.86it/s] 38%|███▊      | 137/358 [00:13<00:22,  9.95it/s] 39%|███▊      | 138/358 [00:14<00:22,  9.93it/s] 39%|███▉      | 139/358 [00:14<00:22,  9.85it/s] 39%|███▉      | 141/358 [00:14<00:21,  9.97it/s] 40%|███▉      | 142/358 [00:14<00:21,  9.89it/s] 40%|███▉      | 143/358 [00:14<00:21,  9.86it/s] 40%|████      | 144/358 [00:14<00:21,  9.77it/s] 41%|████      | 145/358 [00:14<00:21,  9.78it/s] 41%|████      | 146/358 [00:14<00:21,  9.72it/s] 41%|████      | 147/358 [00:15<00:21,  9.67it/s] 41%|████▏     | 148/358 [00:15<00:21,  9.69it/s] 42%|████▏     | 149/358 [00:15<00:21,  9.68it/s] 42%|████▏     | 150/358 [00:15<00:21,  9.63it/s] 42%|████▏     | 151/358 [00:15<00:22,  9.37it/s] 42%|████▏     | 152/358 [00:15<00:21,  9.42it/s] 43%|████▎     | 153/358 [00:15<00:21,  9.44it/s] 43%|████▎     | 154/358 [00:15<00:21,  9.53it/s] 43%|████▎     | 155/358 [00:15<00:21,  9.54it/s] 44%|████▎     | 156/358 [00:15<00:20,  9.66it/s] 44%|████▍     | 157/358 [00:16<00:20,  9.61it/s] 44%|████▍     | 158/358 [00:16<00:20,  9.69it/s] 44%|████▍     | 159/358 [00:16<00:20,  9.69it/s] 45%|████▍     | 160/358 [00:16<00:20,  9.70it/s] 45%|████▌     | 162/358 [00:16<00:19,  9.99it/s] 46%|████▌     | 164/358 [00:16<00:19,  9.99it/s] 46%|████▌     | 165/358 [00:16<00:19,  9.95it/s] 47%|████▋     | 167/358 [00:17<00:19,  9.90it/s] 47%|████▋     | 169/358 [00:17<00:19,  9.93it/s] 48%|████▊     | 171/358 [00:17<00:18,  9.92it/s] 48%|████▊     | 172/358 [00:17<00:18,  9.86it/s] 48%|████▊     | 173/358 [00:17<00:18,  9.80it/s] 49%|████▉     | 175/358 [00:17<00:18,  9.82it/s] 49%|████▉     | 176/358 [00:17<00:18,  9.83it/s] 49%|████▉     | 177/358 [00:18<00:18,  9.82it/s] 50%|█████     | 179/358 [00:18<00:18,  9.84it/s] 50%|█████     | 180/358 [00:18<00:18,  9.77it/s] 51%|█████     | 182/358 [00:18<00:17,  9.92it/s] 51%|█████     | 183/358 [00:18<00:17,  9.88it/s] 51%|█████▏    | 184/358 [00:18<00:17,  9.77it/s] 52%|█████▏    | 185/358 [00:18<00:17,  9.71it/s] 52%|█████▏    | 187/358 [00:19<00:17,  9.93it/s] 53%|█████▎    | 188/358 [00:19<00:17,  9.87it/s] 53%|█████▎    | 189/358 [00:19<00:17,  9.82it/s] 53%|█████▎    | 190/358 [00:19<00:17,  9.87it/s] 53%|█████▎    | 191/358 [00:19<00:17,  9.70it/s] 54%|█████▎    | 192/358 [00:19<00:17,  9.65it/s] 54%|█████▍    | 193/358 [00:19<00:17,  9.65it/s] 54%|█████▍    | 194/358 [00:19<00:17,  9.64it/s] 54%|█████▍    | 195/358 [00:19<00:16,  9.72it/s] 55%|█████▌    | 197/358 [00:20<00:16,  9.90it/s] 55%|█████▌    | 198/358 [00:20<00:16,  9.83it/s] 56%|█████▌    | 199/358 [00:20<00:16,  9.85it/s] 56%|█████▌    | 200/358 [00:20<00:16,  9.79it/s] 56%|█████▌    | 201/358 [00:20<00:16,  9.75it/s] 57%|█████▋    | 203/358 [00:20<00:15,  9.84it/s] 57%|█████▋    | 204/358 [00:20<00:15,  9.74it/s] 57%|█████▋    | 205/358 [00:20<00:15,  9.70it/s] 58%|█████▊    | 207/358 [00:21<00:15,  9.86it/s] 58%|█████▊    | 208/358 [00:21<00:15,  9.79it/s] 59%|█████▊    | 210/358 [00:21<00:15,  9.81it/s] 59%|█████▉    | 212/358 [00:21<00:14,  9.80it/s] 60%|█████▉    | 214/358 [00:21<00:14,  9.88it/s] 60%|██████    | 215/358 [00:21<00:14,  9.82it/s] 60%|██████    | 216/358 [00:22<00:14,  9.75it/s] 61%|██████    | 217/358 [00:22<00:14,  9.79it/s] 61%|██████    | 218/358 [00:22<00:14,  9.76it/s] 61%|██████    | 219/358 [00:22<00:14,  9.76it/s] 62%|██████▏   | 221/358 [00:22<00:13,  9.89it/s] 62%|██████▏   | 222/358 [00:22<00:13,  9.79it/s] 62%|██████▏   | 223/358 [00:22<00:13,  9.74it/s] 63%|██████▎   | 224/358 [00:22<00:13,  9.68it/s] 63%|██████▎   | 225/358 [00:22<00:13,  9.76it/s] 63%|██████▎   | 226/358 [00:23<00:13,  9.71it/s] 64%|██████▎   | 228/358 [00:23<00:13,  9.75it/s] 64%|██████▍   | 229/358 [00:23<00:13,  9.72it/s] 64%|██████▍   | 230/358 [00:23<00:13,  9.67it/s] 65%|██████▍   | 232/358 [00:23<00:12,  9.72it/s] 65%|██████▌   | 234/358 [00:23<00:12, 10.01it/s] 66%|██████▌   | 236/358 [00:24<00:12,  9.97it/s] 66%|██████▋   | 238/358 [00:24<00:11, 10.02it/s] 67%|██████▋   | 240/358 [00:24<00:11,  9.98it/s] 68%|██████▊   | 242/358 [00:24<00:11,  9.96it/s] 68%|██████▊   | 243/358 [00:24<00:11,  9.90it/s] 68%|██████▊   | 244/358 [00:24<00:11,  9.84it/s] 69%|██████▊   | 246/358 [00:25<00:11,  9.86it/s] 69%|██████▉   | 247/358 [00:25<00:11,  9.79it/s] 69%|██████▉   | 248/358 [00:25<00:11,  9.74it/s] 70%|██████▉   | 250/358 [00:25<00:10,  9.84it/s] 70%|███████   | 251/358 [00:25<00:10,  9.78it/s] 70%|███████   | 252/358 [00:25<00:10,  9.71it/s] 71%|███████   | 253/358 [00:25<00:10,  9.68it/s] 71%|███████   | 254/358 [00:25<00:10,  9.65it/s] 72%|███████▏  | 256/358 [00:26<00:10,  9.82it/s] 72%|███████▏  | 257/358 [00:26<00:10,  9.83it/s] 72%|███████▏  | 258/358 [00:26<00:10,  9.70it/s] 72%|███████▏  | 259/358 [00:26<00:10,  9.67it/s] 73%|███████▎  | 260/358 [00:26<00:10,  9.70it/s] 73%|███████▎  | 262/358 [00:26<00:09,  9.88it/s] 74%|███████▎  | 264/358 [00:26<00:09,  9.90it/s] 74%|███████▍  | 266/358 [00:27<00:09,  9.89it/s] 75%|███████▍  | 267/358 [00:27<00:09,  9.83it/s] 75%|███████▌  | 269/358 [00:27<00:09,  9.89it/s] 75%|███████▌  | 270/358 [00:27<00:08,  9.81it/s] 76%|███████▌  | 271/358 [00:27<00:08,  9.74it/s] 76%|███████▌  | 272/358 [00:27<00:08,  9.72it/s] 76%|███████▋  | 273/358 [00:27<00:08,  9.62it/s] 77%|███████▋  | 274/358 [00:27<00:08,  9.62it/s] 77%|███████▋  | 275/358 [00:28<00:08,  9.67it/s] 77%|███████▋  | 276/358 [00:28<00:08,  9.67it/s] 77%|███████▋  | 277/358 [00:28<00:08,  9.64it/s] 78%|███████▊  | 278/358 [00:28<00:08,  9.62it/s] 78%|███████▊  | 280/358 [00:28<00:07,  9.81it/s] 78%|███████▊  | 281/358 [00:28<00:07,  9.82it/s] 79%|███████▉  | 282/358 [00:28<00:07,  9.76it/s] 79%|███████▉  | 283/358 [00:28<00:07,  9.70it/s] 79%|███████▉  | 284/358 [00:29<00:07,  9.66it/s] 80%|███████▉  | 285/358 [00:29<00:07,  9.73it/s] 80%|███████▉  | 286/358 [00:29<00:07,  9.68it/s] 80%|████████  | 287/358 [00:29<00:07,  9.66it/s] 80%|████████  | 288/358 [00:29<00:07,  9.62it/s] 81%|████████  | 290/358 [00:29<00:06,  9.83it/s] 81%|████████▏ | 291/358 [00:29<00:06,  9.82it/s] 82%|████████▏ | 293/358 [00:29<00:06,  9.83it/s] 82%|████████▏ | 295/358 [00:30<00:06,  9.90it/s] 83%|████████▎ | 296/358 [00:30<00:06,  9.84it/s] 83%|████████▎ | 297/358 [00:30<00:06,  9.73it/s] 84%|████████▎ | 299/358 [00:30<00:05,  9.89it/s] 84%|████████▍ | 301/358 [00:30<00:05,  9.92it/s] 84%|████████▍ | 302/358 [00:30<00:05,  9.86it/s] 85%|████████▍ | 303/358 [00:30<00:05,  9.87it/s] 85%|████████▌ | 305/358 [00:31<00:05,  9.89it/s] 85%|████████▌ | 306/358 [00:31<00:05,  9.81it/s] 86%|████████▌ | 308/358 [00:31<00:05,  9.91it/s] 86%|████████▋ | 309/358 [00:31<00:04,  9.81it/s] 87%|████████▋ | 310/358 [00:31<00:04,  9.76it/s] 87%|████████▋ | 311/358 [00:31<00:04,  9.68it/s] 87%|████████▋ | 312/358 [00:31<00:04,  9.70it/s] 87%|████████▋ | 313/358 [00:31<00:04,  9.71it/s] 88%|████████▊ | 315/358 [00:32<00:04,  9.97it/s] 88%|████████▊ | 316/358 [00:32<00:04,  9.92it/s] 89%|████████▊ | 317/358 [00:32<00:04,  9.84it/s] 89%|████████▉ | 318/358 [00:32<00:04,  9.79it/s] 89%|████████▉ | 319/358 [00:32<00:04,  9.74it/s] 89%|████████▉ | 320/358 [00:32<00:03,  9.80it/s] 90%|████████▉ | 321/358 [00:32<00:03,  9.73it/s] 90%|████████▉ | 322/358 [00:32<00:03,  9.69it/s] 90%|█████████ | 323/358 [00:32<00:03,  9.65it/s] 91%|█████████ | 324/358 [00:33<00:03,  9.62it/s] 91%|█████████ | 325/358 [00:33<00:03,  9.60it/s] 91%|█████████▏| 327/358 [00:33<00:03,  9.96it/s] 92%|█████████▏| 329/358 [00:33<00:02, 10.06it/s] 92%|█████████▏| 330/358 [00:33<00:02,  9.94it/s] 93%|█████████▎| 332/358 [00:33<00:02, 10.05it/s] 93%|█████████▎| 334/358 [00:34<00:02,  9.95it/s] 94%|█████████▎| 335/358 [00:34<00:02,  9.83it/s] 94%|█████████▍| 337/358 [00:34<00:02,  9.91it/s] 95%|█████████▍| 339/358 [00:34<00:01, 10.11it/s] 95%|█████████▌| 341/358 [00:34<00:01, 10.05it/s] 96%|█████████▌| 343/358 [00:34<00:01,  9.89it/s] 96%|█████████▌| 344/358 [00:35<00:01,  9.83it/s] 96%|█████████▋| 345/358 [00:35<00:01,  9.85it/s] 97%|█████████▋| 346/358 [00:35<00:01,  9.88it/s] 97%|█████████▋| 348/358 [00:35<00:01,  9.97it/s] 97%|█████████▋| 349/358 [00:35<00:00,  9.89it/s] 98%|█████████▊| 350/358 [00:35<00:00,  9.81it/s] 98%|█████████▊| 351/358 [00:35<00:00,  9.76it/s] 99%|█████████▊| 353/358 [00:36<00:00,  9.92it/s] 99%|█████████▉| 354/358 [00:36<00:00,  9.90it/s] 99%|█████████▉| 355/358 [00:36<00:00,  9.82it/s]100%|█████████▉| 357/358 [00:36<00:00,  9.87it/s]100%|██████████| 358/358 [00:36<00:00,  9.81it/s]
[32m2025-02-05 05:32:22.326[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    gen_loss  grad clip ratio  grad norm   ppl
       2.297                1      3.249 9.942[0m
[32m2025-02-05 05:32:22.326[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m169[0m - [1m[Valid][0m
  0%|          | 0/10256 [00:00<?, ?it/s]100%|██████████| 10256/10256 [00:00<00:00, 1055522.94it/s]
[32m2025-02-05 05:32:22.336[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:26,  1.45it/s]  5%|▌         | 2/40 [00:01<00:26,  1.46it/s]  8%|▊         | 3/40 [00:02<00:25,  1.47it/s] 10%|█         | 4/40 [00:02<00:24,  1.47it/s] 12%|█▎        | 5/40 [00:03<00:24,  1.46it/s] 15%|█▌        | 6/40 [00:04<00:23,  1.46it/s] 18%|█▊        | 7/40 [00:04<00:22,  1.46it/s] 20%|██        | 8/40 [00:05<00:21,  1.46it/s] 22%|██▎       | 9/40 [00:06<00:21,  1.46it/s] 25%|██▌       | 10/40 [00:06<00:20,  1.46it/s] 28%|██▊       | 11/40 [00:07<00:19,  1.46it/s] 30%|███       | 12/40 [00:08<00:19,  1.47it/s] 32%|███▎      | 13/40 [00:08<00:18,  1.47it/s] 35%|███▌      | 14/40 [00:09<00:17,  1.46it/s] 38%|███▊      | 15/40 [00:10<00:17,  1.46it/s] 40%|████      | 16/40 [00:10<00:16,  1.45it/s] 42%|████▎     | 17/40 [00:11<00:15,  1.46it/s] 45%|████▌     | 18/40 [00:12<00:15,  1.46it/s] 48%|████▊     | 19/40 [00:13<00:14,  1.46it/s] 50%|█████     | 20/40 [00:13<00:13,  1.47it/s] 52%|█████▎    | 21/40 [00:14<00:12,  1.47it/s] 55%|█████▌    | 22/40 [00:15<00:12,  1.46it/s] 57%|█████▊    | 23/40 [00:15<00:11,  1.46it/s] 60%|██████    | 24/40 [00:16<00:11,  1.45it/s] 62%|██████▎   | 25/40 [00:17<00:10,  1.45it/s] 65%|██████▌   | 26/40 [00:17<00:09,  1.46it/s] 68%|██████▊   | 27/40 [00:18<00:08,  1.47it/s] 70%|███████   | 28/40 [00:19<00:08,  1.47it/s] 72%|███████▎  | 29/40 [00:19<00:07,  1.47it/s] 75%|███████▌  | 30/40 [00:20<00:06,  1.47it/s] 78%|███████▊  | 31/40 [00:21<00:06,  1.47it/s] 80%|████████  | 32/40 [00:21<00:05,  1.47it/s] 82%|████████▎ | 33/40 [00:22<00:04,  1.46it/s] 85%|████████▌ | 34/40 [00:23<00:04,  1.46it/s] 88%|████████▊ | 35/40 [00:23<00:03,  1.46it/s] 90%|█████████ | 36/40 [00:24<00:02,  1.45it/s] 92%|█████████▎| 37/40 [00:25<00:02,  1.46it/s] 95%|█████████▌| 38/40 [00:26<00:01,  1.45it/s] 98%|█████████▊| 39/40 [00:26<00:00,  1.45it/s]100%|██████████| 40/40 [00:27<00:00,  1.61it/s]100%|██████████| 40/40 [00:27<00:00,  1.47it/s]
[32m2025-02-05 05:32:49.522[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    average  bleu@1  bleu@2  bleu@3  bleu@4  dist@1  dist@2  dist@3  dist@4  extreme  \
      .7667   .2920   .1045  .04643  .02514  .04657   .3262   .6451   .8246    .5799   
      f1  gen_loss  greedy  intra_dist@1  intra_dist@2  intra_dist@3  intra_dist@4  \
   .3473     4.493   .6604         .8941         .9796         .9566         .9142   
    ppl  rouge1  rouge2  rougeL  
   89.4   .3798  .08875   .3665[0m
[32m2025-02-05 05:32:49.529[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m163[0m - [1m[Conversation epoch 23][0m
[32m2025-02-05 05:32:49.529[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m164[0m - [1m[Train][0m
  0%|          | 0/92414 [00:00<?, ?it/s]100%|██████████| 92414/92414 [00:00<00:00, 987245.71it/s]
[32m2025-02-05 05:32:49.623[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/358 [00:00<?, ?it/s]  0%|          | 1/358 [00:00<00:36,  9.73it/s]  1%|          | 3/358 [00:00<00:35,  9.91it/s]  1%|          | 4/358 [00:00<00:35,  9.89it/s]  2%|▏         | 6/358 [00:00<00:35,  9.85it/s]  2%|▏         | 7/358 [00:00<00:35,  9.79it/s]  2%|▏         | 8/358 [00:00<00:35,  9.84it/s]  3%|▎         | 9/358 [00:00<00:35,  9.74it/s]  3%|▎         | 10/358 [00:01<00:35,  9.73it/s]  3%|▎         | 11/358 [00:01<00:35,  9.68it/s]  4%|▎         | 13/358 [00:01<00:34,  9.90it/s]  4%|▍         | 14/358 [00:01<00:34,  9.83it/s]  4%|▍         | 15/358 [00:01<00:35,  9.76it/s]  4%|▍         | 16/358 [00:01<00:35,  9.69it/s]  5%|▍         | 17/358 [00:01<00:35,  9.71it/s]  5%|▌         | 18/358 [00:01<00:34,  9.78it/s]  5%|▌         | 19/358 [00:01<00:34,  9.71it/s]  6%|▌         | 20/358 [00:02<00:34,  9.66it/s]  6%|▌         | 21/358 [00:02<00:35,  9.59it/s]  6%|▌         | 22/358 [00:02<00:34,  9.66it/s]  7%|▋         | 24/358 [00:02<00:34,  9.76it/s]  7%|▋         | 25/358 [00:02<00:34,  9.71it/s]  7%|▋         | 26/358 [00:02<00:34,  9.66it/s]  8%|▊         | 27/358 [00:02<00:34,  9.71it/s]  8%|▊         | 28/358 [00:02<00:34,  9.67it/s]  8%|▊         | 29/358 [00:02<00:34,  9.63it/s]  9%|▊         | 31/358 [00:03<00:33,  9.73it/s]  9%|▉         | 32/358 [00:03<00:33,  9.73it/s]  9%|▉         | 34/358 [00:03<00:32,  9.83it/s] 10%|█         | 36/358 [00:03<00:32,  9.83it/s] 10%|█         | 37/358 [00:03<00:32,  9.81it/s] 11%|█         | 38/358 [00:03<00:32,  9.77it/s] 11%|█         | 40/358 [00:04<00:32,  9.93it/s] 11%|█▏        | 41/358 [00:04<00:32,  9.84it/s] 12%|█▏        | 43/358 [00:04<00:31,  9.87it/s] 13%|█▎        | 45/358 [00:04<00:31,  9.96it/s] 13%|█▎        | 47/358 [00:04<00:31,  9.94it/s] 13%|█▎        | 48/358 [00:04<00:31,  9.93it/s] 14%|█▍        | 50/358 [00:05<00:31,  9.90it/s] 14%|█▍        | 51/358 [00:05<00:31,  9.83it/s] 15%|█▍        | 52/358 [00:05<00:31,  9.74it/s] 15%|█▍        | 53/358 [00:05<00:31,  9.69it/s] 15%|█▌        | 54/358 [00:05<00:31,  9.73it/s] 15%|█▌        | 55/358 [00:05<00:31,  9.68it/s] 16%|█▌        | 56/358 [00:05<00:31,  9.72it/s] 16%|█▌        | 57/358 [00:05<00:31,  9.68it/s] 16%|█▌        | 58/358 [00:05<00:31,  9.65it/s] 16%|█▋        | 59/358 [00:06<00:31,  9.62it/s] 17%|█▋        | 61/358 [00:06<00:30,  9.71it/s] 17%|█▋        | 62/358 [00:06<00:30,  9.63it/s] 18%|█▊        | 63/358 [00:06<00:30,  9.70it/s] 18%|█▊        | 64/358 [00:06<00:30,  9.64it/s] 18%|█▊        | 66/358 [00:06<00:30,  9.71it/s] 19%|█▊        | 67/358 [00:06<00:30,  9.70it/s] 19%|█▉        | 69/358 [00:07<00:29,  9.76it/s] 20%|█▉        | 70/358 [00:07<00:29,  9.71it/s] 20%|█▉        | 71/358 [00:07<00:29,  9.75it/s] 20%|██        | 72/358 [00:07<00:29,  9.70it/s] 20%|██        | 73/358 [00:07<00:29,  9.67it/s] 21%|██        | 74/358 [00:07<00:29,  9.63it/s] 21%|██        | 75/358 [00:07<00:29,  9.60it/s] 21%|██        | 76/358 [00:07<00:29,  9.71it/s] 22%|██▏       | 77/358 [00:07<00:29,  9.67it/s] 22%|██▏       | 79/358 [00:08<00:28,  9.68it/s] 23%|██▎       | 81/358 [00:08<00:28,  9.74it/s] 23%|██▎       | 83/358 [00:08<00:28,  9.77it/s] 23%|██▎       | 84/358 [00:08<00:28,  9.72it/s] 24%|██▎       | 85/358 [00:08<00:28,  9.67it/s] 24%|██▍       | 86/358 [00:08<00:28,  9.66it/s] 24%|██▍       | 87/358 [00:08<00:28,  9.64it/s] 25%|██▍       | 88/358 [00:09<00:27,  9.65it/s] 25%|██▌       | 90/358 [00:09<00:27,  9.89it/s] 26%|██▌       | 92/358 [00:09<00:26,  9.99it/s] 26%|██▌       | 93/358 [00:09<00:26,  9.95it/s] 26%|██▋       | 94/358 [00:09<00:26,  9.87it/s] 27%|██▋       | 96/358 [00:09<00:25, 10.15it/s] 27%|██▋       | 98/358 [00:10<00:25, 10.04it/s] 28%|██▊       | 99/358 [00:10<00:26,  9.95it/s] 28%|██▊       | 101/358 [00:10<00:25,  9.91it/s] 29%|██▉       | 103/358 [00:10<00:25,  9.90it/s] 29%|██▉       | 104/358 [00:10<00:25,  9.86it/s] 29%|██▉       | 105/358 [00:10<00:25,  9.78it/s] 30%|██▉       | 106/358 [00:10<00:25,  9.76it/s] 30%|███       | 108/358 [00:11<00:25,  9.79it/s] 30%|███       | 109/358 [00:11<00:25,  9.70it/s] 31%|███       | 110/358 [00:11<00:25,  9.68it/s] 31%|███       | 111/358 [00:11<00:25,  9.63it/s] 32%|███▏      | 113/358 [00:11<00:24,  9.90it/s] 32%|███▏      | 114/358 [00:11<00:24,  9.86it/s] 32%|███▏      | 115/358 [00:11<00:24,  9.77it/s] 32%|███▏      | 116/358 [00:11<00:25,  9.68it/s] 33%|███▎      | 117/358 [00:11<00:24,  9.65it/s] 33%|███▎      | 119/358 [00:12<00:24,  9.77it/s] 34%|███▍      | 121/358 [00:12<00:23,  9.97it/s] 34%|███▍      | 123/358 [00:12<00:23, 10.07it/s] 35%|███▍      | 125/358 [00:12<00:23, 10.04it/s] 35%|███▌      | 126/358 [00:12<00:23, 10.01it/s] 35%|███▌      | 127/358 [00:12<00:23,  9.96it/s] 36%|███▌      | 128/358 [00:13<00:23,  9.91it/s] 36%|███▋      | 130/358 [00:13<00:22,  9.98it/s] 37%|███▋      | 131/358 [00:13<00:22,  9.88it/s] 37%|███▋      | 132/358 [00:13<00:22,  9.90it/s] 37%|███▋      | 134/358 [00:13<00:22,  9.92it/s] 38%|███▊      | 135/358 [00:13<00:22,  9.86it/s] 38%|███▊      | 137/358 [00:13<00:22,  9.95it/s] 39%|███▊      | 138/358 [00:14<00:22,  9.93it/s] 39%|███▉      | 139/358 [00:14<00:22,  9.84it/s] 39%|███▉      | 141/358 [00:14<00:21,  9.97it/s] 40%|███▉      | 142/358 [00:14<00:21,  9.89it/s] 40%|███▉      | 143/358 [00:14<00:21,  9.86it/s] 40%|████      | 144/358 [00:14<00:21,  9.77it/s] 41%|████      | 145/358 [00:14<00:21,  9.79it/s] 41%|████      | 146/358 [00:14<00:21,  9.73it/s] 41%|████      | 147/358 [00:15<00:21,  9.67it/s] 41%|████▏     | 148/358 [00:15<00:21,  9.70it/s] 42%|████▏     | 149/358 [00:15<00:21,  9.68it/s] 42%|████▏     | 150/358 [00:15<00:21,  9.64it/s] 42%|████▏     | 151/358 [00:15<00:22,  9.38it/s] 42%|████▏     | 152/358 [00:15<00:21,  9.42it/s] 43%|████▎     | 153/358 [00:15<00:21,  9.44it/s] 43%|████▎     | 154/358 [00:15<00:21,  9.53it/s] 43%|████▎     | 155/358 [00:15<00:21,  9.54it/s] 44%|████▎     | 156/358 [00:15<00:20,  9.67it/s] 44%|████▍     | 157/358 [00:16<00:20,  9.61it/s] 44%|████▍     | 158/358 [00:16<00:20,  9.69it/s] 44%|████▍     | 159/358 [00:16<00:20,  9.69it/s] 45%|████▍     | 160/358 [00:16<00:20,  9.70it/s] 45%|████▌     | 162/358 [00:16<00:19,  9.99it/s] 46%|████▌     | 164/358 [00:16<00:19,  9.99it/s] 46%|████▌     | 165/358 [00:16<00:19,  9.94it/s] 47%|████▋     | 167/358 [00:17<00:19,  9.89it/s] 47%|████▋     | 169/358 [00:17<00:19,  9.93it/s] 48%|████▊     | 171/358 [00:17<00:18,  9.91it/s] 48%|████▊     | 172/358 [00:17<00:18,  9.86it/s] 48%|████▊     | 173/358 [00:17<00:18,  9.80it/s] 49%|████▉     | 175/358 [00:17<00:18,  9.82it/s] 49%|████▉     | 176/358 [00:17<00:18,  9.84it/s] 49%|████▉     | 177/358 [00:18<00:18,  9.82it/s] 50%|█████     | 179/358 [00:18<00:18,  9.84it/s] 50%|█████     | 180/358 [00:18<00:18,  9.78it/s] 51%|█████     | 182/358 [00:18<00:17,  9.93it/s] 51%|█████     | 183/358 [00:18<00:17,  9.88it/s] 51%|█████▏    | 184/358 [00:18<00:17,  9.77it/s] 52%|█████▏    | 185/358 [00:18<00:17,  9.72it/s] 52%|█████▏    | 187/358 [00:19<00:17,  9.93it/s] 53%|█████▎    | 188/358 [00:19<00:17,  9.88it/s] 53%|█████▎    | 189/358 [00:19<00:17,  9.82it/s] 53%|█████▎    | 190/358 [00:19<00:17,  9.86it/s] 53%|█████▎    | 191/358 [00:19<00:17,  9.70it/s] 54%|█████▎    | 192/358 [00:19<00:17,  9.65it/s] 54%|█████▍    | 193/358 [00:19<00:17,  9.65it/s] 54%|█████▍    | 194/358 [00:19<00:17,  9.64it/s] 54%|█████▍    | 195/358 [00:19<00:16,  9.72it/s] 55%|█████▌    | 197/358 [00:20<00:16,  9.90it/s] 55%|█████▌    | 198/358 [00:20<00:16,  9.83it/s] 56%|█████▌    | 199/358 [00:20<00:16,  9.86it/s] 56%|█████▌    | 200/358 [00:20<00:16,  9.79it/s] 56%|█████▌    | 201/358 [00:20<00:16,  9.75it/s] 57%|█████▋    | 203/358 [00:20<00:15,  9.84it/s] 57%|█████▋    | 204/358 [00:20<00:15,  9.73it/s] 57%|█████▋    | 205/358 [00:20<00:15,  9.69it/s] 58%|█████▊    | 207/358 [00:21<00:15,  9.86it/s] 58%|█████▊    | 208/358 [00:21<00:15,  9.79it/s] 59%|█████▊    | 210/358 [00:21<00:15,  9.81it/s] 59%|█████▉    | 212/358 [00:21<00:14,  9.80it/s] 60%|█████▉    | 214/358 [00:21<00:14,  9.88it/s] 60%|██████    | 215/358 [00:21<00:14,  9.82it/s] 60%|██████    | 216/358 [00:22<00:14,  9.75it/s] 61%|██████    | 217/358 [00:22<00:14,  9.79it/s] 61%|██████    | 218/358 [00:22<00:14,  9.76it/s] 61%|██████    | 219/358 [00:22<00:14,  9.76it/s] 62%|██████▏   | 221/358 [00:22<00:13,  9.89it/s] 62%|██████▏   | 222/358 [00:22<00:13,  9.79it/s] 62%|██████▏   | 223/358 [00:22<00:13,  9.73it/s] 63%|██████▎   | 224/358 [00:22<00:13,  9.68it/s] 63%|██████▎   | 225/358 [00:22<00:13,  9.76it/s] 63%|██████▎   | 226/358 [00:23<00:13,  9.70it/s] 64%|██████▎   | 228/358 [00:23<00:13,  9.75it/s] 64%|██████▍   | 229/358 [00:23<00:13,  9.72it/s] 64%|██████▍   | 230/358 [00:23<00:13,  9.67it/s] 65%|██████▍   | 232/358 [00:23<00:12,  9.72it/s] 65%|██████▌   | 234/358 [00:23<00:12, 10.01it/s] 66%|██████▌   | 236/358 [00:24<00:12,  9.97it/s] 66%|██████▋   | 238/358 [00:24<00:11, 10.03it/s] 67%|██████▋   | 240/358 [00:24<00:11,  9.99it/s] 68%|██████▊   | 242/358 [00:24<00:11,  9.97it/s] 68%|██████▊   | 243/358 [00:24<00:11,  9.90it/s] 68%|██████▊   | 244/358 [00:24<00:11,  9.84it/s] 69%|██████▊   | 246/358 [00:25<00:11,  9.86it/s] 69%|██████▉   | 247/358 [00:25<00:11,  9.79it/s] 69%|██████▉   | 248/358 [00:25<00:11,  9.74it/s] 70%|██████▉   | 250/358 [00:25<00:10,  9.84it/s] 70%|███████   | 251/358 [00:25<00:10,  9.78it/s] 70%|███████   | 252/358 [00:25<00:10,  9.71it/s] 71%|███████   | 253/358 [00:25<00:10,  9.67it/s] 71%|███████   | 254/358 [00:25<00:10,  9.64it/s] 72%|███████▏  | 256/358 [00:26<00:10,  9.82it/s] 72%|███████▏  | 257/358 [00:26<00:10,  9.83it/s] 72%|███████▏  | 258/358 [00:26<00:10,  9.70it/s] 72%|███████▏  | 259/358 [00:26<00:10,  9.67it/s] 73%|███████▎  | 260/358 [00:26<00:10,  9.70it/s] 73%|███████▎  | 262/358 [00:26<00:09,  9.87it/s] 74%|███████▎  | 264/358 [00:26<00:09,  9.90it/s] 74%|███████▍  | 266/358 [00:27<00:09,  9.89it/s] 75%|███████▍  | 267/358 [00:27<00:09,  9.83it/s] 75%|███████▌  | 269/358 [00:27<00:09,  9.88it/s] 75%|███████▌  | 270/358 [00:27<00:08,  9.82it/s] 76%|███████▌  | 271/358 [00:27<00:08,  9.74it/s] 76%|███████▌  | 272/358 [00:27<00:08,  9.72it/s] 76%|███████▋  | 273/358 [00:27<00:08,  9.62it/s] 77%|███████▋  | 274/358 [00:27<00:08,  9.62it/s] 77%|███████▋  | 275/358 [00:28<00:08,  9.67it/s] 77%|███████▋  | 276/358 [00:28<00:08,  9.67it/s] 77%|███████▋  | 277/358 [00:28<00:08,  9.63it/s] 78%|███████▊  | 278/358 [00:28<00:08,  9.61it/s] 78%|███████▊  | 280/358 [00:28<00:07,  9.80it/s] 78%|███████▊  | 281/358 [00:28<00:07,  9.81it/s] 79%|███████▉  | 282/358 [00:28<00:07,  9.76it/s] 79%|███████▉  | 283/358 [00:28<00:07,  9.70it/s] 79%|███████▉  | 284/358 [00:29<00:07,  9.66it/s] 80%|███████▉  | 285/358 [00:29<00:07,  9.73it/s] 80%|███████▉  | 286/358 [00:29<00:07,  9.68it/s] 80%|████████  | 287/358 [00:29<00:07,  9.66it/s] 80%|████████  | 288/358 [00:29<00:07,  9.61it/s] 81%|████████  | 290/358 [00:29<00:06,  9.83it/s] 81%|████████▏ | 291/358 [00:29<00:06,  9.81it/s] 82%|████████▏ | 293/358 [00:29<00:06,  9.82it/s] 82%|████████▏ | 295/358 [00:30<00:06,  9.90it/s] 83%|████████▎ | 296/358 [00:30<00:06,  9.83it/s] 83%|████████▎ | 297/358 [00:30<00:06,  9.72it/s] 84%|████████▎ | 299/358 [00:30<00:05,  9.88it/s] 84%|████████▍ | 301/358 [00:30<00:05,  9.92it/s] 84%|████████▍ | 302/358 [00:30<00:05,  9.85it/s] 85%|████████▍ | 303/358 [00:30<00:05,  9.86it/s] 85%|████████▌ | 305/358 [00:31<00:05,  9.89it/s] 85%|████████▌ | 306/358 [00:31<00:05,  9.81it/s] 86%|████████▌ | 308/358 [00:31<00:05,  9.91it/s] 86%|████████▋ | 309/358 [00:31<00:04,  9.81it/s] 87%|████████▋ | 310/358 [00:31<00:04,  9.76it/s] 87%|████████▋ | 311/358 [00:31<00:04,  9.68it/s] 87%|████████▋ | 312/358 [00:31<00:04,  9.70it/s] 87%|████████▋ | 313/358 [00:31<00:04,  9.72it/s] 88%|████████▊ | 315/358 [00:32<00:04,  9.97it/s] 88%|████████▊ | 316/358 [00:32<00:04,  9.92it/s] 89%|████████▊ | 317/358 [00:32<00:04,  9.84it/s] 89%|████████▉ | 318/358 [00:32<00:04,  9.79it/s] 89%|████████▉ | 319/358 [00:32<00:04,  9.74it/s] 89%|████████▉ | 320/358 [00:32<00:03,  9.80it/s] 90%|████████▉ | 321/358 [00:32<00:03,  9.73it/s] 90%|████████▉ | 322/358 [00:32<00:03,  9.69it/s] 90%|█████████ | 323/358 [00:32<00:03,  9.65it/s] 91%|█████████ | 324/358 [00:33<00:03,  9.62it/s] 91%|█████████ | 325/358 [00:33<00:03,  9.60it/s] 91%|█████████▏| 327/358 [00:33<00:03,  9.96it/s] 92%|█████████▏| 329/358 [00:33<00:02, 10.05it/s] 92%|█████████▏| 330/358 [00:33<00:02,  9.94it/s] 93%|█████████▎| 332/358 [00:33<00:02, 10.04it/s] 93%|█████████▎| 334/358 [00:34<00:02,  9.95it/s] 94%|█████████▎| 335/358 [00:34<00:02,  9.83it/s] 94%|█████████▍| 337/358 [00:34<00:02,  9.91it/s] 95%|█████████▍| 339/358 [00:34<00:01, 10.11it/s] 95%|█████████▌| 341/358 [00:34<00:01, 10.05it/s] 96%|█████████▌| 343/358 [00:34<00:01,  9.89it/s] 96%|█████████▌| 344/358 [00:35<00:01,  9.83it/s] 96%|█████████▋| 345/358 [00:35<00:01,  9.85it/s] 97%|█████████▋| 346/358 [00:35<00:01,  9.88it/s] 97%|█████████▋| 348/358 [00:35<00:01,  9.97it/s] 97%|█████████▋| 349/358 [00:35<00:00,  9.89it/s] 98%|█████████▊| 350/358 [00:35<00:00,  9.81it/s] 98%|█████████▊| 351/358 [00:35<00:00,  9.75it/s] 99%|█████████▊| 353/358 [00:36<00:00,  9.92it/s] 99%|█████████▉| 354/358 [00:36<00:00,  9.90it/s] 99%|█████████▉| 355/358 [00:36<00:00,  9.80it/s]100%|█████████▉| 357/358 [00:36<00:00,  9.86it/s]100%|██████████| 358/358 [00:36<00:00,  9.81it/s]
[32m2025-02-05 05:33:26.110[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    gen_loss  grad clip ratio  grad norm   ppl
        2.27                1      3.185 9.682[0m
[32m2025-02-05 05:33:26.110[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m169[0m - [1m[Valid][0m
  0%|          | 0/10256 [00:00<?, ?it/s]100%|██████████| 10256/10256 [00:00<00:00, 1071481.85it/s]
[32m2025-02-05 05:33:26.120[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:26,  1.45it/s]  5%|▌         | 2/40 [00:01<00:25,  1.47it/s]  8%|▊         | 3/40 [00:02<00:25,  1.47it/s] 10%|█         | 4/40 [00:02<00:24,  1.47it/s] 12%|█▎        | 5/40 [00:03<00:23,  1.46it/s] 15%|█▌        | 6/40 [00:04<00:23,  1.46it/s] 18%|█▊        | 7/40 [00:04<00:22,  1.46it/s] 20%|██        | 8/40 [00:05<00:21,  1.47it/s] 22%|██▎       | 9/40 [00:06<00:21,  1.47it/s] 25%|██▌       | 10/40 [00:06<00:20,  1.47it/s] 28%|██▊       | 11/40 [00:07<00:19,  1.47it/s] 30%|███       | 12/40 [00:08<00:19,  1.47it/s] 32%|███▎      | 13/40 [00:08<00:18,  1.48it/s] 35%|███▌      | 14/40 [00:09<00:17,  1.47it/s] 38%|███▊      | 15/40 [00:10<00:17,  1.46it/s] 40%|████      | 16/40 [00:10<00:16,  1.46it/s] 42%|████▎     | 17/40 [00:11<00:15,  1.47it/s] 45%|████▌     | 18/40 [00:12<00:15,  1.47it/s] 48%|████▊     | 19/40 [00:12<00:14,  1.46it/s] 50%|█████     | 20/40 [00:13<00:13,  1.47it/s] 52%|█████▎    | 21/40 [00:14<00:12,  1.47it/s] 55%|█████▌    | 22/40 [00:14<00:12,  1.46it/s] 57%|█████▊    | 23/40 [00:15<00:11,  1.47it/s] 60%|██████    | 24/40 [00:16<00:10,  1.46it/s] 62%|██████▎   | 25/40 [00:17<00:10,  1.46it/s] 65%|██████▌   | 26/40 [00:17<00:09,  1.47it/s] 68%|██████▊   | 27/40 [00:18<00:08,  1.47it/s] 70%|███████   | 28/40 [00:19<00:08,  1.47it/s] 72%|███████▎  | 29/40 [00:19<00:07,  1.47it/s] 75%|███████▌  | 30/40 [00:20<00:06,  1.48it/s] 78%|███████▊  | 31/40 [00:21<00:06,  1.48it/s] 80%|████████  | 32/40 [00:21<00:05,  1.47it/s] 82%|████████▎ | 33/40 [00:22<00:04,  1.47it/s] 85%|████████▌ | 34/40 [00:23<00:04,  1.47it/s] 88%|████████▊ | 35/40 [00:23<00:03,  1.47it/s] 90%|█████████ | 36/40 [00:24<00:02,  1.46it/s] 92%|█████████▎| 37/40 [00:25<00:02,  1.47it/s] 95%|█████████▌| 38/40 [00:25<00:01,  1.46it/s] 98%|█████████▊| 39/40 [00:26<00:00,  1.46it/s]100%|██████████| 40/40 [00:27<00:00,  1.62it/s]100%|██████████| 40/40 [00:27<00:00,  1.48it/s]
[32m2025-02-05 05:33:53.186[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    average  bleu@1  bleu@2  bleu@3  bleu@4  dist@1  dist@2  dist@3  dist@4  extreme  \
      .7732   .2985   .1094  .04443  .02527  .04524   .3086   .6128   .7902    .5845   
      f1  gen_loss  greedy  intra_dist@1  intra_dist@2  intra_dist@3  intra_dist@4  \
   .3534     4.486   .6666         .8952         .9787         .9559         .9145   
     ppl  rouge1  rouge2  rougeL  
   88.81   .3875  .09207   .3740[0m
[32m2025-02-05 05:33:53.191[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m163[0m - [1m[Conversation epoch 24][0m
[32m2025-02-05 05:33:53.192[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m164[0m - [1m[Train][0m
  0%|          | 0/92414 [00:00<?, ?it/s]100%|██████████| 92414/92414 [00:00<00:00, 996694.27it/s]
[32m2025-02-05 05:33:53.285[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/358 [00:00<?, ?it/s]  0%|          | 1/358 [00:00<00:36,  9.73it/s]  1%|          | 3/358 [00:00<00:35,  9.91it/s]  1%|          | 4/358 [00:00<00:35,  9.89it/s]  2%|▏         | 6/358 [00:00<00:35,  9.86it/s]  2%|▏         | 7/358 [00:00<00:35,  9.80it/s]  2%|▏         | 8/358 [00:00<00:35,  9.84it/s]  3%|▎         | 9/358 [00:00<00:35,  9.74it/s]  3%|▎         | 10/358 [00:01<00:35,  9.73it/s]  3%|▎         | 11/358 [00:01<00:35,  9.68it/s]  4%|▎         | 13/358 [00:01<00:34,  9.90it/s]  4%|▍         | 14/358 [00:01<00:35,  9.83it/s]  4%|▍         | 15/358 [00:01<00:35,  9.75it/s]  4%|▍         | 16/358 [00:01<00:35,  9.69it/s]  5%|▍         | 17/358 [00:01<00:35,  9.71it/s]  5%|▌         | 18/358 [00:01<00:34,  9.78it/s]  5%|▌         | 19/358 [00:01<00:34,  9.72it/s]  6%|▌         | 20/358 [00:02<00:34,  9.66it/s]  6%|▌         | 21/358 [00:02<00:35,  9.59it/s]  6%|▌         | 22/358 [00:02<00:34,  9.65it/s]  7%|▋         | 24/358 [00:02<00:34,  9.75it/s]  7%|▋         | 25/358 [00:02<00:34,  9.70it/s]  7%|▋         | 26/358 [00:02<00:34,  9.65it/s]  8%|▊         | 27/358 [00:02<00:34,  9.71it/s]  8%|▊         | 28/358 [00:02<00:34,  9.66it/s]  8%|▊         | 29/358 [00:02<00:34,  9.63it/s]  9%|▊         | 31/358 [00:03<00:33,  9.74it/s]  9%|▉         | 32/358 [00:03<00:33,  9.73it/s]  9%|▉         | 34/358 [00:03<00:32,  9.83it/s] 10%|█         | 36/358 [00:03<00:32,  9.83it/s] 10%|█         | 37/358 [00:03<00:32,  9.82it/s] 11%|█         | 38/358 [00:03<00:32,  9.77it/s] 11%|█         | 40/358 [00:04<00:32,  9.93it/s] 11%|█▏        | 41/358 [00:04<00:32,  9.84it/s] 12%|█▏        | 43/358 [00:04<00:31,  9.86it/s] 13%|█▎        | 45/358 [00:04<00:31,  9.96it/s] 13%|█▎        | 47/358 [00:04<00:31,  9.93it/s] 13%|█▎        | 48/358 [00:04<00:31,  9.92it/s] 14%|█▍        | 50/358 [00:05<00:31,  9.90it/s] 14%|█▍        | 51/358 [00:05<00:31,  9.83it/s] 15%|█▍        | 52/358 [00:05<00:31,  9.74it/s] 15%|█▍        | 53/358 [00:05<00:31,  9.69it/s] 15%|█▌        | 54/358 [00:05<00:31,  9.73it/s] 15%|█▌        | 55/358 [00:05<00:31,  9.68it/s] 16%|█▌        | 56/358 [00:05<00:31,  9.72it/s] 16%|█▌        | 57/358 [00:05<00:31,  9.68it/s] 16%|█▌        | 58/358 [00:05<00:31,  9.65it/s] 16%|█▋        | 59/358 [00:06<00:31,  9.62it/s] 17%|█▋        | 61/358 [00:06<00:30,  9.71it/s] 17%|█▋        | 62/358 [00:06<00:30,  9.63it/s] 18%|█▊        | 63/358 [00:06<00:30,  9.69it/s] 18%|█▊        | 64/358 [00:06<00:30,  9.65it/s] 18%|█▊        | 66/358 [00:06<00:30,  9.71it/s] 19%|█▊        | 67/358 [00:06<00:29,  9.70it/s] 19%|█▉        | 69/358 [00:07<00:29,  9.76it/s] 20%|█▉        | 70/358 [00:07<00:29,  9.71it/s] 20%|█▉        | 71/358 [00:07<00:29,  9.75it/s] 20%|██        | 72/358 [00:07<00:29,  9.70it/s] 20%|██        | 73/358 [00:07<00:29,  9.67it/s] 21%|██        | 74/358 [00:07<00:29,  9.64it/s] 21%|██        | 75/358 [00:07<00:29,  9.61it/s] 21%|██        | 76/358 [00:07<00:29,  9.71it/s] 22%|██▏       | 77/358 [00:07<00:29,  9.67it/s] 22%|██▏       | 79/358 [00:08<00:28,  9.68it/s] 23%|██▎       | 81/358 [00:08<00:28,  9.74it/s] 23%|██▎       | 83/358 [00:08<00:28,  9.77it/s] 23%|██▎       | 84/358 [00:08<00:28,  9.72it/s] 24%|██▎       | 85/358 [00:08<00:28,  9.67it/s] 24%|██▍       | 86/358 [00:08<00:28,  9.66it/s] 24%|██▍       | 87/358 [00:08<00:28,  9.64it/s] 25%|██▍       | 88/358 [00:09<00:27,  9.66it/s] 25%|██▌       | 90/358 [00:09<00:27,  9.90it/s] 26%|██▌       | 92/358 [00:09<00:26,  9.99it/s] 26%|██▌       | 93/358 [00:09<00:26,  9.96it/s] 26%|██▋       | 94/358 [00:09<00:26,  9.87it/s] 27%|██▋       | 96/358 [00:09<00:25, 10.15it/s] 27%|██▋       | 98/358 [00:10<00:25, 10.04it/s] 28%|██▊       | 99/358 [00:10<00:26,  9.95it/s] 28%|██▊       | 101/358 [00:10<00:25,  9.92it/s] 29%|██▉       | 103/358 [00:10<00:25,  9.90it/s] 29%|██▉       | 104/358 [00:10<00:25,  9.86it/s] 29%|██▉       | 105/358 [00:10<00:25,  9.78it/s] 30%|██▉       | 106/358 [00:10<00:25,  9.76it/s] 30%|███       | 108/358 [00:11<00:25,  9.79it/s] 30%|███       | 109/358 [00:11<00:25,  9.70it/s] 31%|███       | 110/358 [00:11<00:25,  9.69it/s] 31%|███       | 111/358 [00:11<00:25,  9.64it/s] 32%|███▏      | 113/358 [00:11<00:24,  9.90it/s] 32%|███▏      | 114/358 [00:11<00:24,  9.86it/s] 32%|███▏      | 115/358 [00:11<00:24,  9.77it/s] 32%|███▏      | 116/358 [00:11<00:24,  9.68it/s] 33%|███▎      | 117/358 [00:11<00:24,  9.65it/s] 33%|███▎      | 119/358 [00:12<00:24,  9.77it/s] 34%|███▍      | 121/358 [00:12<00:23,  9.97it/s] 34%|███▍      | 123/358 [00:12<00:23, 10.07it/s] 35%|███▍      | 125/358 [00:12<00:23, 10.05it/s] 35%|███▌      | 126/358 [00:12<00:23, 10.01it/s] 35%|███▌      | 127/358 [00:12<00:23,  9.97it/s] 36%|███▌      | 128/358 [00:13<00:23,  9.92it/s] 36%|███▋      | 130/358 [00:13<00:22,  9.98it/s] 37%|███▋      | 131/358 [00:13<00:22,  9.88it/s] 37%|███▋      | 132/358 [00:13<00:22,  9.90it/s] 37%|███▋      | 134/358 [00:13<00:22,  9.92it/s] 38%|███▊      | 135/358 [00:13<00:22,  9.86it/s] 38%|███▊      | 137/358 [00:13<00:22,  9.95it/s] 39%|███▊      | 138/358 [00:14<00:22,  9.93it/s] 39%|███▉      | 139/358 [00:14<00:22,  9.84it/s] 39%|███▉      | 141/358 [00:14<00:21,  9.96it/s] 40%|███▉      | 142/358 [00:14<00:21,  9.89it/s] 40%|███▉      | 143/358 [00:14<00:21,  9.85it/s] 40%|████      | 144/358 [00:14<00:21,  9.77it/s] 41%|████      | 145/358 [00:14<00:21,  9.79it/s] 41%|████      | 146/358 [00:14<00:21,  9.72it/s] 41%|████      | 147/358 [00:15<00:21,  9.67it/s] 41%|████▏     | 148/358 [00:15<00:21,  9.69it/s] 42%|████▏     | 149/358 [00:15<00:21,  9.68it/s] 42%|████▏     | 150/358 [00:15<00:21,  9.64it/s] 42%|████▏     | 151/358 [00:15<00:22,  9.37it/s] 42%|████▏     | 152/358 [00:15<00:21,  9.42it/s] 43%|████▎     | 153/358 [00:15<00:21,  9.44it/s] 43%|████▎     | 154/358 [00:15<00:21,  9.53it/s] 43%|████▎     | 155/358 [00:15<00:21,  9.54it/s] 44%|████▎     | 156/358 [00:15<00:20,  9.67it/s] 44%|████▍     | 157/358 [00:16<00:20,  9.61it/s] 44%|████▍     | 158/358 [00:16<00:20,  9.69it/s] 44%|████▍     | 159/358 [00:16<00:20,  9.68it/s] 45%|████▍     | 160/358 [00:16<00:20,  9.69it/s] 45%|████▌     | 162/358 [00:16<00:19,  9.99it/s] 46%|████▌     | 164/358 [00:16<00:19,  9.99it/s] 46%|████▌     | 165/358 [00:16<00:19,  9.95it/s] 47%|████▋     | 167/358 [00:17<00:19,  9.90it/s] 47%|████▋     | 169/358 [00:17<00:19,  9.94it/s] 48%|████▊     | 171/358 [00:17<00:18,  9.92it/s] 48%|████▊     | 172/358 [00:17<00:18,  9.86it/s] 48%|████▊     | 173/358 [00:17<00:18,  9.80it/s] 49%|████▉     | 175/358 [00:17<00:18,  9.82it/s] 49%|████▉     | 176/358 [00:17<00:18,  9.84it/s] 49%|████▉     | 177/358 [00:18<00:18,  9.82it/s] 50%|█████     | 179/358 [00:18<00:18,  9.84it/s] 50%|█████     | 180/358 [00:18<00:18,  9.78it/s] 51%|█████     | 182/358 [00:18<00:17,  9.93it/s] 51%|█████     | 183/358 [00:18<00:17,  9.88it/s] 51%|█████▏    | 184/358 [00:18<00:17,  9.77it/s] 52%|█████▏    | 185/358 [00:18<00:17,  9.72it/s] 52%|█████▏    | 187/358 [00:19<00:17,  9.93it/s] 53%|█████▎    | 188/358 [00:19<00:17,  9.88it/s] 53%|█████▎    | 189/358 [00:19<00:17,  9.82it/s] 53%|█████▎    | 191/358 [00:19<00:17,  9.74it/s] 54%|█████▎    | 192/358 [00:19<00:17,  9.69it/s] 54%|█████▍    | 193/358 [00:19<00:17,  9.68it/s] 54%|█████▍    | 194/358 [00:19<00:16,  9.66it/s] 54%|█████▍    | 195/358 [00:19<00:16,  9.73it/s] 55%|█████▌    | 197/358 [00:20<00:16,  9.90it/s] 55%|█████▌    | 198/358 [00:20<00:16,  9.83it/s] 56%|█████▌    | 199/358 [00:20<00:16,  9.86it/s] 56%|█████▌    | 200/358 [00:20<00:16,  9.79it/s] 56%|█████▌    | 201/358 [00:20<00:16,  9.75it/s] 57%|█████▋    | 203/358 [00:20<00:15,  9.84it/s] 57%|█████▋    | 204/358 [00:20<00:15,  9.74it/s] 57%|█████▋    | 205/358 [00:20<00:15,  9.69it/s] 58%|█████▊    | 207/358 [00:21<00:15,  9.86it/s] 58%|█████▊    | 208/358 [00:21<00:15,  9.80it/s] 59%|█████▊    | 210/358 [00:21<00:15,  9.81it/s] 59%|█████▉    | 212/358 [00:21<00:14,  9.80it/s] 60%|█████▉    | 214/358 [00:21<00:14,  9.88it/s] 60%|██████    | 215/358 [00:21<00:14,  9.82it/s] 60%|██████    | 216/358 [00:22<00:14,  9.76it/s] 61%|██████    | 217/358 [00:22<00:14,  9.79it/s] 61%|██████    | 218/358 [00:22<00:14,  9.76it/s] 61%|██████    | 219/358 [00:22<00:14,  9.76it/s] 62%|██████▏   | 221/358 [00:22<00:13,  9.89it/s] 62%|██████▏   | 222/358 [00:22<00:13,  9.79it/s] 62%|██████▏   | 223/358 [00:22<00:13,  9.73it/s] 63%|██████▎   | 224/358 [00:22<00:13,  9.68it/s] 63%|██████▎   | 225/358 [00:22<00:13,  9.76it/s] 63%|██████▎   | 226/358 [00:23<00:13,  9.71it/s] 64%|██████▎   | 228/358 [00:23<00:13,  9.75it/s] 64%|██████▍   | 229/358 [00:23<00:13,  9.72it/s] 64%|██████▍   | 230/358 [00:23<00:13,  9.67it/s] 65%|██████▍   | 232/358 [00:23<00:12,  9.72it/s] 65%|██████▌   | 234/358 [00:23<00:12, 10.02it/s] 66%|██████▌   | 236/358 [00:24<00:12,  9.97it/s] 66%|██████▋   | 238/358 [00:24<00:11, 10.03it/s] 67%|██████▋   | 240/358 [00:24<00:11,  9.99it/s] 68%|██████▊   | 242/358 [00:24<00:11,  9.96it/s] 68%|██████▊   | 243/358 [00:24<00:11,  9.90it/s] 68%|██████▊   | 244/358 [00:24<00:11,  9.84it/s] 69%|██████▊   | 246/358 [00:25<00:11,  9.86it/s] 69%|██████▉   | 247/358 [00:25<00:11,  9.79it/s] 69%|██████▉   | 248/358 [00:25<00:11,  9.74it/s] 70%|██████▉   | 250/358 [00:25<00:10,  9.84it/s] 70%|███████   | 251/358 [00:25<00:10,  9.78it/s] 70%|███████   | 252/358 [00:25<00:10,  9.71it/s] 71%|███████   | 253/358 [00:25<00:10,  9.67it/s] 71%|███████   | 254/358 [00:25<00:10,  9.64it/s] 72%|███████▏  | 256/358 [00:26<00:10,  9.82it/s] 72%|███████▏  | 257/358 [00:26<00:10,  9.83it/s] 72%|███████▏  | 258/358 [00:26<00:10,  9.70it/s] 72%|███████▏  | 259/358 [00:26<00:10,  9.66it/s] 73%|███████▎  | 260/358 [00:26<00:10,  9.70it/s] 73%|███████▎  | 262/358 [00:26<00:09,  9.88it/s] 74%|███████▎  | 264/358 [00:26<00:09,  9.90it/s] 74%|███████▍  | 266/358 [00:27<00:09,  9.89it/s] 75%|███████▍  | 267/358 [00:27<00:09,  9.83it/s] 75%|███████▌  | 269/358 [00:27<00:09,  9.89it/s] 75%|███████▌  | 270/358 [00:27<00:08,  9.81it/s] 76%|███████▌  | 271/358 [00:27<00:08,  9.74it/s] 76%|███████▌  | 272/358 [00:27<00:08,  9.72it/s] 76%|███████▋  | 273/358 [00:27<00:08,  9.62it/s] 77%|███████▋  | 274/358 [00:27<00:08,  9.62it/s] 77%|███████▋  | 275/358 [00:28<00:08,  9.67it/s] 77%|███████▋  | 276/358 [00:28<00:08,  9.67it/s] 77%|███████▋  | 277/358 [00:28<00:08,  9.64it/s] 78%|███████▊  | 278/358 [00:28<00:08,  9.62it/s] 78%|███████▊  | 280/358 [00:28<00:07,  9.80it/s] 78%|███████▊  | 281/358 [00:28<00:07,  9.82it/s] 79%|███████▉  | 282/358 [00:28<00:07,  9.75it/s] 79%|███████▉  | 283/358 [00:28<00:07,  9.69it/s] 79%|███████▉  | 284/358 [00:28<00:07,  9.66it/s] 80%|███████▉  | 285/358 [00:29<00:07,  9.72it/s] 80%|███████▉  | 286/358 [00:29<00:07,  9.68it/s] 80%|████████  | 287/358 [00:29<00:07,  9.66it/s] 80%|████████  | 288/358 [00:29<00:07,  9.62it/s] 81%|████████  | 289/358 [00:29<00:07,  9.72it/s] 81%|████████▏ | 291/358 [00:29<00:06,  9.83it/s] 82%|████████▏ | 293/358 [00:29<00:06,  9.83it/s] 82%|████████▏ | 295/358 [00:30<00:06,  9.90it/s] 83%|████████▎ | 296/358 [00:30<00:06,  9.84it/s] 83%|████████▎ | 297/358 [00:30<00:06,  9.74it/s] 84%|████████▎ | 299/358 [00:30<00:05,  9.89it/s] 84%|████████▍ | 301/358 [00:30<00:05,  9.92it/s] 84%|████████▍ | 302/358 [00:30<00:05,  9.86it/s] 85%|████████▍ | 303/358 [00:30<00:05,  9.86it/s] 85%|████████▌ | 305/358 [00:31<00:05,  9.89it/s] 85%|████████▌ | 306/358 [00:31<00:05,  9.81it/s] 86%|████████▌ | 308/358 [00:31<00:05,  9.92it/s] 86%|████████▋ | 309/358 [00:31<00:04,  9.82it/s] 87%|████████▋ | 310/358 [00:31<00:04,  9.76it/s] 87%|████████▋ | 311/358 [00:31<00:04,  9.68it/s] 87%|████████▋ | 312/358 [00:31<00:04,  9.70it/s] 87%|████████▋ | 313/358 [00:31<00:04,  9.72it/s] 88%|████████▊ | 315/358 [00:32<00:04,  9.97it/s] 88%|████████▊ | 316/358 [00:32<00:04,  9.92it/s] 89%|████████▊ | 317/358 [00:32<00:04,  9.84it/s] 89%|████████▉ | 318/358 [00:32<00:04,  9.79it/s] 89%|████████▉ | 319/358 [00:32<00:04,  9.75it/s] 89%|████████▉ | 320/358 [00:32<00:03,  9.81it/s] 90%|████████▉ | 321/358 [00:32<00:03,  9.73it/s] 90%|████████▉ | 322/358 [00:32<00:03,  9.69it/s] 90%|█████████ | 323/358 [00:32<00:03,  9.65it/s] 91%|█████████ | 324/358 [00:33<00:03,  9.62it/s] 91%|█████████ | 325/358 [00:33<00:03,  9.60it/s] 91%|█████████▏| 327/358 [00:33<00:03,  9.96it/s] 92%|█████████▏| 329/358 [00:33<00:02, 10.06it/s] 92%|█████████▏| 330/358 [00:33<00:02,  9.94it/s] 93%|█████████▎| 332/358 [00:33<00:02, 10.04it/s] 93%|█████████▎| 334/358 [00:34<00:02,  9.95it/s] 94%|█████████▎| 335/358 [00:34<00:02,  9.83it/s] 94%|█████████▍| 337/358 [00:34<00:02,  9.91it/s] 95%|█████████▍| 339/358 [00:34<00:01, 10.10it/s] 95%|█████████▌| 341/358 [00:34<00:01, 10.05it/s] 96%|█████████▌| 343/358 [00:34<00:01,  9.88it/s] 96%|█████████▌| 344/358 [00:35<00:01,  9.83it/s] 96%|█████████▋| 345/358 [00:35<00:01,  9.85it/s] 97%|█████████▋| 347/358 [00:35<00:01, 10.03it/s] 97%|█████████▋| 348/358 [00:35<00:01,  9.92it/s] 97%|█████████▋| 349/358 [00:35<00:00,  9.84it/s] 98%|█████████▊| 350/358 [00:35<00:00,  9.77it/s] 98%|█████████▊| 351/358 [00:35<00:00,  9.73it/s] 99%|█████████▊| 353/358 [00:35<00:00,  9.91it/s] 99%|█████████▉| 354/358 [00:36<00:00,  9.89it/s] 99%|█████████▉| 355/358 [00:36<00:00,  9.81it/s]100%|█████████▉| 357/358 [00:36<00:00,  9.86it/s]100%|██████████| 358/358 [00:36<00:00,  9.81it/s]
[32m2025-02-05 05:34:29.769[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    gen_loss  grad clip ratio  grad norm   ppl
       2.247                1      6.346 9.464[0m
[32m2025-02-05 05:34:29.770[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m169[0m - [1m[Valid][0m
  0%|          | 0/10256 [00:00<?, ?it/s]100%|██████████| 10256/10256 [00:00<00:00, 1095271.34it/s]
[32m2025-02-05 05:34:29.779[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:26,  1.46it/s]  5%|▌         | 2/40 [00:01<00:25,  1.47it/s]  8%|▊         | 3/40 [00:02<00:25,  1.47it/s] 10%|█         | 4/40 [00:02<00:24,  1.48it/s] 12%|█▎        | 5/40 [00:03<00:23,  1.47it/s] 15%|█▌        | 6/40 [00:04<00:23,  1.46it/s] 18%|█▊        | 7/40 [00:04<00:22,  1.46it/s] 20%|██        | 8/40 [00:05<00:21,  1.47it/s] 22%|██▎       | 9/40 [00:06<00:21,  1.46it/s] 25%|██▌       | 10/40 [00:06<00:20,  1.46it/s] 28%|██▊       | 11/40 [00:07<00:19,  1.47it/s] 30%|███       | 12/40 [00:08<00:19,  1.47it/s] 32%|███▎      | 13/40 [00:08<00:18,  1.47it/s] 35%|███▌      | 14/40 [00:09<00:17,  1.46it/s] 38%|███▊      | 15/40 [00:10<00:17,  1.46it/s] 40%|████      | 16/40 [00:10<00:16,  1.46it/s] 42%|████▎     | 17/40 [00:11<00:15,  1.47it/s] 45%|████▌     | 18/40 [00:12<00:14,  1.47it/s] 48%|████▊     | 19/40 [00:12<00:14,  1.47it/s] 50%|█████     | 20/40 [00:13<00:13,  1.47it/s] 52%|█████▎    | 21/40 [00:14<00:12,  1.47it/s] 55%|█████▌    | 22/40 [00:14<00:12,  1.47it/s] 57%|█████▊    | 23/40 [00:15<00:11,  1.47it/s] 60%|██████    | 24/40 [00:16<00:10,  1.46it/s] 62%|██████▎   | 25/40 [00:17<00:10,  1.46it/s] 65%|██████▌   | 26/40 [00:17<00:09,  1.47it/s] 68%|██████▊   | 27/40 [00:18<00:08,  1.47it/s] 70%|███████   | 28/40 [00:19<00:08,  1.47it/s] 72%|███████▎  | 29/40 [00:19<00:07,  1.47it/s] 75%|███████▌  | 30/40 [00:20<00:06,  1.48it/s] 78%|███████▊  | 31/40 [00:21<00:06,  1.48it/s] 80%|████████  | 32/40 [00:21<00:05,  1.48it/s] 82%|████████▎ | 33/40 [00:22<00:04,  1.47it/s] 85%|████████▌ | 34/40 [00:23<00:04,  1.47it/s] 88%|████████▊ | 35/40 [00:23<00:03,  1.47it/s] 90%|█████████ | 36/40 [00:24<00:02,  1.47it/s] 92%|█████████▎| 37/40 [00:25<00:02,  1.47it/s] 95%|█████████▌| 38/40 [00:25<00:01,  1.46it/s] 98%|█████████▊| 39/40 [00:26<00:00,  1.46it/s]100%|██████████| 40/40 [00:27<00:00,  1.62it/s]100%|██████████| 40/40 [00:27<00:00,  1.48it/s]
[32m2025-02-05 05:34:56.813[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    average  bleu@1  bleu@2  bleu@3  bleu@4  dist@1  dist@2  dist@3  dist@4  extreme  \
      .7674   .2904   .1050  .04635  .02537  .04367   .3004   .6063   .7914    .5808   
      f1  gen_loss  greedy  intra_dist@1  intra_dist@2  intra_dist@3  intra_dist@4  \
   .3504     4.537   .6637         .8959         .9793         .9515         .9006   
     ppl  rouge1  rouge2  rougeL  
   93.43   .3828  .09035   .3702[0m
[32m2025-02-05 05:34:56.819[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m163[0m - [1m[Conversation epoch 25][0m
[32m2025-02-05 05:34:56.819[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m164[0m - [1m[Train][0m
  0%|          | 0/92414 [00:00<?, ?it/s]100%|██████████| 92414/92414 [00:00<00:00, 981861.50it/s]
[32m2025-02-05 05:34:56.914[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/358 [00:00<?, ?it/s]  0%|          | 1/358 [00:00<00:36,  9.71it/s]  1%|          | 3/358 [00:00<00:35,  9.91it/s]  1%|          | 4/358 [00:00<00:35,  9.89it/s]  2%|▏         | 6/358 [00:00<00:35,  9.86it/s]  2%|▏         | 7/358 [00:00<00:35,  9.79it/s]  2%|▏         | 8/358 [00:00<00:35,  9.84it/s]  3%|▎         | 9/358 [00:00<00:35,  9.74it/s]  3%|▎         | 10/358 [00:01<00:35,  9.73it/s]  3%|▎         | 11/358 [00:01<00:35,  9.68it/s]  4%|▎         | 13/358 [00:01<00:34,  9.91it/s]  4%|▍         | 14/358 [00:01<00:34,  9.83it/s]  4%|▍         | 15/358 [00:01<00:35,  9.76it/s]  4%|▍         | 16/358 [00:01<00:35,  9.70it/s]  5%|▍         | 17/358 [00:01<00:35,  9.71it/s]  5%|▌         | 18/358 [00:01<00:34,  9.79it/s]  5%|▌         | 19/358 [00:01<00:34,  9.71it/s]  6%|▌         | 20/358 [00:02<00:34,  9.66it/s]  6%|▌         | 21/358 [00:02<00:35,  9.59it/s]  6%|▌         | 22/358 [00:02<00:34,  9.66it/s]  7%|▋         | 24/358 [00:02<00:34,  9.75it/s]  7%|▋         | 25/358 [00:02<00:34,  9.70it/s]  7%|▋         | 26/358 [00:02<00:34,  9.65it/s]  8%|▊         | 27/358 [00:02<00:34,  9.71it/s]  8%|▊         | 28/358 [00:02<00:34,  9.67it/s]  8%|▊         | 29/358 [00:02<00:34,  9.63it/s]  9%|▊         | 31/358 [00:03<00:33,  9.73it/s]  9%|▉         | 32/358 [00:03<00:33,  9.73it/s]  9%|▉         | 34/358 [00:03<00:32,  9.83it/s] 10%|█         | 36/358 [00:03<00:32,  9.83it/s] 10%|█         | 37/358 [00:03<00:32,  9.82it/s] 11%|█         | 38/358 [00:03<00:32,  9.77it/s] 11%|█         | 40/358 [00:04<00:32,  9.93it/s] 11%|█▏        | 41/358 [00:04<00:32,  9.84it/s] 12%|█▏        | 43/358 [00:04<00:31,  9.87it/s] 13%|█▎        | 45/358 [00:04<00:31,  9.97it/s] 13%|█▎        | 47/358 [00:04<00:31,  9.94it/s] 13%|█▎        | 48/358 [00:04<00:31,  9.93it/s] 14%|█▍        | 50/358 [00:05<00:31,  9.90it/s] 14%|█▍        | 51/358 [00:05<00:31,  9.83it/s] 15%|█▍        | 52/358 [00:05<00:31,  9.74it/s] 15%|█▍        | 53/358 [00:05<00:31,  9.69it/s] 15%|█▌        | 54/358 [00:05<00:31,  9.73it/s] 15%|█▌        | 55/358 [00:05<00:31,  9.68it/s] 16%|█▌        | 56/358 [00:05<00:31,  9.72it/s] 16%|█▌        | 57/358 [00:05<00:31,  9.68it/s] 16%|█▌        | 58/358 [00:05<00:31,  9.65it/s] 16%|█▋        | 59/358 [00:06<00:31,  9.63it/s] 17%|█▋        | 61/358 [00:06<00:30,  9.71it/s] 17%|█▋        | 62/358 [00:06<00:30,  9.63it/s] 18%|█▊        | 63/358 [00:06<00:30,  9.70it/s] 18%|█▊        | 64/358 [00:06<00:30,  9.65it/s] 18%|█▊        | 66/358 [00:06<00:30,  9.71it/s] 19%|█▊        | 67/358 [00:06<00:29,  9.70it/s] 19%|█▉        | 69/358 [00:07<00:29,  9.77it/s] 20%|█▉        | 70/358 [00:07<00:29,  9.72it/s] 20%|█▉        | 71/358 [00:07<00:29,  9.76it/s] 20%|██        | 72/358 [00:07<00:29,  9.71it/s] 20%|██        | 73/358 [00:07<00:29,  9.68it/s] 21%|██        | 74/358 [00:07<00:29,  9.64it/s] 21%|██        | 75/358 [00:07<00:29,  9.61it/s] 21%|██        | 76/358 [00:07<00:29,  9.71it/s] 22%|██▏       | 77/358 [00:07<00:29,  9.67it/s] 22%|██▏       | 79/358 [00:08<00:28,  9.68it/s] 23%|██▎       | 81/358 [00:08<00:28,  9.74it/s] 23%|██▎       | 83/358 [00:08<00:28,  9.77it/s] 23%|██▎       | 84/358 [00:08<00:28,  9.72it/s] 24%|██▎       | 85/358 [00:08<00:28,  9.67it/s] 24%|██▍       | 86/358 [00:08<00:28,  9.66it/s] 24%|██▍       | 87/358 [00:08<00:28,  9.64it/s] 25%|██▍       | 88/358 [00:09<00:27,  9.65it/s] 25%|██▌       | 90/358 [00:09<00:27,  9.89it/s] 26%|██▌       | 92/358 [00:09<00:26,  9.99it/s] 26%|██▌       | 93/358 [00:09<00:26,  9.96it/s] 26%|██▋       | 94/358 [00:09<00:26,  9.87it/s] 27%|██▋       | 96/358 [00:09<00:25, 10.15it/s] 27%|██▋       | 98/358 [00:10<00:25, 10.04it/s] 28%|██▊       | 99/358 [00:10<00:26,  9.95it/s] 28%|██▊       | 101/358 [00:10<00:25,  9.92it/s] 29%|██▉       | 103/358 [00:10<00:25,  9.90it/s] 29%|██▉       | 104/358 [00:10<00:25,  9.86it/s] 29%|██▉       | 105/358 [00:10<00:25,  9.78it/s] 30%|██▉       | 106/358 [00:10<00:25,  9.76it/s] 30%|███       | 108/358 [00:11<00:25,  9.79it/s] 30%|███       | 109/358 [00:11<00:25,  9.70it/s] 31%|███       | 110/358 [00:11<00:25,  9.68it/s] 31%|███       | 111/358 [00:11<00:25,  9.63it/s] 32%|███▏      | 113/358 [00:11<00:24,  9.90it/s] 32%|███▏      | 114/358 [00:11<00:24,  9.86it/s] 32%|███▏      | 115/358 [00:11<00:24,  9.77it/s] 32%|███▏      | 116/358 [00:11<00:24,  9.69it/s] 33%|███▎      | 117/358 [00:11<00:24,  9.66it/s] 33%|███▎      | 119/358 [00:12<00:24,  9.78it/s] 34%|███▍      | 121/358 [00:12<00:23,  9.97it/s] 34%|███▍      | 123/358 [00:12<00:23, 10.07it/s] 35%|███▍      | 125/358 [00:12<00:23, 10.05it/s] 35%|███▌      | 126/358 [00:12<00:23, 10.01it/s] 35%|███▌      | 127/358 [00:12<00:23,  9.96it/s] 36%|███▌      | 128/358 [00:13<00:23,  9.91it/s] 36%|███▋      | 130/358 [00:13<00:22,  9.98it/s] 37%|███▋      | 131/358 [00:13<00:22,  9.88it/s] 37%|███▋      | 132/358 [00:13<00:22,  9.90it/s] 37%|███▋      | 134/358 [00:13<00:22,  9.92it/s] 38%|███▊      | 135/358 [00:13<00:22,  9.86it/s] 38%|███▊      | 137/358 [00:13<00:22,  9.95it/s] 39%|███▊      | 138/358 [00:14<00:22,  9.94it/s] 39%|███▉      | 139/358 [00:14<00:22,  9.85it/s] 39%|███▉      | 141/358 [00:14<00:21,  9.97it/s] 40%|███▉      | 142/358 [00:14<00:21,  9.89it/s] 40%|███▉      | 143/358 [00:14<00:21,  9.86it/s] 40%|████      | 144/358 [00:14<00:21,  9.77it/s] 41%|████      | 145/358 [00:14<00:21,  9.79it/s] 41%|████      | 146/358 [00:14<00:21,  9.73it/s] 41%|████      | 147/358 [00:14<00:21,  9.67it/s] 41%|████▏     | 148/358 [00:15<00:21,  9.70it/s] 42%|████▏     | 149/358 [00:15<00:21,  9.68it/s] 42%|████▏     | 150/358 [00:15<00:21,  9.64it/s] 42%|████▏     | 151/358 [00:15<00:22,  9.37it/s] 42%|████▏     | 152/358 [00:15<00:21,  9.42it/s] 43%|████▎     | 153/358 [00:15<00:21,  9.44it/s] 43%|████▎     | 154/358 [00:15<00:21,  9.53it/s] 43%|████▎     | 155/358 [00:15<00:21,  9.54it/s] 44%|████▎     | 156/358 [00:15<00:20,  9.67it/s] 44%|████▍     | 157/358 [00:16<00:20,  9.61it/s] 44%|████▍     | 158/358 [00:16<00:20,  9.69it/s] 44%|████▍     | 159/358 [00:16<00:20,  9.69it/s] 45%|████▍     | 160/358 [00:16<00:20,  9.70it/s] 45%|████▌     | 162/358 [00:16<00:19,  9.99it/s] 46%|████▌     | 164/358 [00:16<00:19,  9.99it/s] 46%|████▌     | 165/358 [00:16<00:19,  9.95it/s] 47%|████▋     | 167/358 [00:17<00:19,  9.90it/s] 47%|████▋     | 169/358 [00:17<00:19,  9.93it/s] 48%|████▊     | 171/358 [00:17<00:18,  9.92it/s] 48%|████▊     | 172/358 [00:17<00:18,  9.86it/s] 48%|████▊     | 173/358 [00:17<00:18,  9.80it/s] 49%|████▉     | 175/358 [00:17<00:18,  9.82it/s] 49%|████▉     | 176/358 [00:17<00:18,  9.84it/s] 49%|████▉     | 177/358 [00:18<00:18,  9.82it/s] 50%|█████     | 179/358 [00:18<00:18,  9.85it/s] 50%|█████     | 180/358 [00:18<00:18,  9.78it/s] 51%|█████     | 182/358 [00:18<00:17,  9.93it/s] 51%|█████     | 183/358 [00:18<00:17,  9.88it/s] 51%|█████▏    | 184/358 [00:18<00:17,  9.77it/s] 52%|█████▏    | 185/358 [00:18<00:17,  9.72it/s] 52%|█████▏    | 187/358 [00:19<00:17,  9.93it/s] 53%|█████▎    | 188/358 [00:19<00:17,  9.88it/s] 53%|█████▎    | 189/358 [00:19<00:17,  9.82it/s] 53%|█████▎    | 190/358 [00:19<00:17,  9.87it/s] 53%|█████▎    | 191/358 [00:19<00:17,  9.70it/s] 54%|█████▎    | 192/358 [00:19<00:17,  9.65it/s] 54%|█████▍    | 193/358 [00:19<00:17,  9.65it/s] 54%|█████▍    | 194/358 [00:19<00:17,  9.64it/s] 54%|█████▍    | 195/358 [00:19<00:16,  9.72it/s] 55%|█████▌    | 197/358 [00:20<00:16,  9.91it/s] 55%|█████▌    | 198/358 [00:20<00:16,  9.83it/s] 56%|█████▌    | 199/358 [00:20<00:16,  9.86it/s] 56%|█████▌    | 200/358 [00:20<00:16,  9.79it/s] 56%|█████▌    | 201/358 [00:20<00:16,  9.75it/s] 57%|█████▋    | 203/358 [00:20<00:15,  9.84it/s] 57%|█████▋    | 204/358 [00:20<00:15,  9.74it/s] 57%|█████▋    | 205/358 [00:20<00:15,  9.69it/s] 58%|█████▊    | 207/358 [00:21<00:15,  9.86it/s] 58%|█████▊    | 208/358 [00:21<00:15,  9.79it/s] 59%|█████▊    | 210/358 [00:21<00:15,  9.81it/s] 59%|█████▉    | 212/358 [00:21<00:14,  9.80it/s] 60%|█████▉    | 214/358 [00:21<00:14,  9.88it/s] 60%|██████    | 215/358 [00:21<00:14,  9.82it/s] 60%|██████    | 216/358 [00:22<00:14,  9.75it/s] 61%|██████    | 217/358 [00:22<00:14,  9.79it/s] 61%|██████    | 218/358 [00:22<00:14,  9.76it/s] 61%|██████    | 219/358 [00:22<00:14,  9.76it/s] 62%|██████▏   | 221/358 [00:22<00:13,  9.89it/s] 62%|██████▏   | 222/358 [00:22<00:13,  9.79it/s] 62%|██████▏   | 223/358 [00:22<00:13,  9.73it/s] 63%|██████▎   | 224/358 [00:22<00:13,  9.68it/s] 63%|██████▎   | 225/358 [00:22<00:13,  9.76it/s] 63%|██████▎   | 226/358 [00:23<00:13,  9.71it/s] 64%|██████▎   | 228/358 [00:23<00:13,  9.75it/s] 64%|██████▍   | 229/358 [00:23<00:13,  9.72it/s] 64%|██████▍   | 230/358 [00:23<00:13,  9.67it/s] 65%|██████▍   | 232/358 [00:23<00:12,  9.72it/s] 65%|██████▌   | 234/358 [00:23<00:12, 10.02it/s] 66%|██████▌   | 236/358 [00:24<00:12,  9.97it/s] 66%|██████▋   | 238/358 [00:24<00:11, 10.03it/s] 67%|██████▋   | 240/358 [00:24<00:11,  9.99it/s] 68%|██████▊   | 242/358 [00:24<00:11,  9.97it/s] 68%|██████▊   | 243/358 [00:24<00:11,  9.90it/s] 68%|██████▊   | 244/358 [00:24<00:11,  9.84it/s] 69%|██████▊   | 246/358 [00:25<00:11,  9.86it/s] 69%|██████▉   | 247/358 [00:25<00:11,  9.79it/s] 69%|██████▉   | 248/358 [00:25<00:11,  9.74it/s] 70%|██████▉   | 250/358 [00:25<00:10,  9.84it/s] 70%|███████   | 251/358 [00:25<00:10,  9.78it/s] 70%|███████   | 252/358 [00:25<00:10,  9.71it/s] 71%|███████   | 253/358 [00:25<00:10,  9.67it/s] 71%|███████   | 254/358 [00:25<00:10,  9.65it/s] 72%|███████▏  | 256/358 [00:26<00:10,  9.82it/s] 72%|███████▏  | 257/358 [00:26<00:10,  9.83it/s] 72%|███████▏  | 258/358 [00:26<00:10,  9.70it/s] 72%|███████▏  | 259/358 [00:26<00:10,  9.67it/s] 73%|███████▎  | 260/358 [00:26<00:10,  9.70it/s] 73%|███████▎  | 262/358 [00:26<00:09,  9.88it/s] 74%|███████▎  | 264/358 [00:26<00:09,  9.90it/s] 74%|███████▍  | 266/358 [00:27<00:09,  9.89it/s] 75%|███████▍  | 267/358 [00:27<00:09,  9.83it/s] 75%|███████▌  | 269/358 [00:27<00:09,  9.89it/s] 75%|███████▌  | 270/358 [00:27<00:08,  9.81it/s] 76%|███████▌  | 271/358 [00:27<00:08,  9.74it/s] 76%|███████▌  | 272/358 [00:27<00:08,  9.72it/s] 76%|███████▋  | 273/358 [00:27<00:08,  9.62it/s] 77%|███████▋  | 274/358 [00:27<00:08,  9.62it/s] 77%|███████▋  | 275/358 [00:28<00:08,  9.67it/s] 77%|███████▋  | 276/358 [00:28<00:08,  9.67it/s] 77%|███████▋  | 277/358 [00:28<00:08,  9.64it/s] 78%|███████▊  | 278/358 [00:28<00:08,  9.62it/s] 78%|███████▊  | 280/358 [00:28<00:07,  9.81it/s] 78%|███████▊  | 281/358 [00:28<00:07,  9.82it/s] 79%|███████▉  | 282/358 [00:28<00:07,  9.76it/s] 79%|███████▉  | 283/358 [00:28<00:07,  9.70it/s] 79%|███████▉  | 284/358 [00:28<00:07,  9.66it/s] 80%|███████▉  | 285/358 [00:29<00:07,  9.72it/s] 80%|███████▉  | 286/358 [00:29<00:07,  9.68it/s] 80%|████████  | 287/358 [00:29<00:07,  9.66it/s] 80%|████████  | 288/358 [00:29<00:07,  9.62it/s] 81%|████████  | 289/358 [00:29<00:07,  9.73it/s] 81%|████████▏ | 291/358 [00:29<00:06,  9.84it/s] 82%|████████▏ | 293/358 [00:29<00:06,  9.84it/s] 82%|████████▏ | 295/358 [00:30<00:06,  9.90it/s] 83%|████████▎ | 296/358 [00:30<00:06,  9.84it/s] 83%|████████▎ | 297/358 [00:30<00:06,  9.73it/s] 84%|████████▎ | 299/358 [00:30<00:05,  9.89it/s] 84%|████████▍ | 301/358 [00:30<00:05,  9.92it/s] 84%|████████▍ | 302/358 [00:30<00:05,  9.86it/s] 85%|████████▍ | 303/358 [00:30<00:05,  9.87it/s] 85%|████████▌ | 305/358 [00:31<00:05,  9.89it/s] 85%|████████▌ | 306/358 [00:31<00:05,  9.82it/s] 86%|████████▌ | 308/358 [00:31<00:05,  9.92it/s] 86%|████████▋ | 309/358 [00:31<00:04,  9.82it/s] 87%|████████▋ | 310/358 [00:31<00:04,  9.76it/s] 87%|████████▋ | 311/358 [00:31<00:04,  9.68it/s] 87%|████████▋ | 312/358 [00:31<00:04,  9.69it/s] 87%|████████▋ | 313/358 [00:31<00:04,  9.71it/s] 88%|████████▊ | 315/358 [00:32<00:04,  9.97it/s] 88%|████████▊ | 316/358 [00:32<00:04,  9.92it/s] 89%|████████▊ | 317/358 [00:32<00:04,  9.84it/s] 89%|████████▉ | 318/358 [00:32<00:04,  9.79it/s] 89%|████████▉ | 319/358 [00:32<00:04,  9.74it/s] 89%|████████▉ | 320/358 [00:32<00:03,  9.80it/s] 90%|████████▉ | 321/358 [00:32<00:03,  9.73it/s] 90%|████████▉ | 322/358 [00:32<00:03,  9.70it/s] 90%|█████████ | 323/358 [00:32<00:03,  9.65it/s] 91%|█████████ | 324/358 [00:33<00:03,  9.62it/s] 91%|█████████ | 325/358 [00:33<00:03,  9.60it/s] 91%|█████████▏| 327/358 [00:33<00:03,  9.96it/s] 92%|█████████▏| 329/358 [00:33<00:02, 10.06it/s] 92%|█████████▏| 330/358 [00:33<00:02,  9.95it/s] 93%|█████████▎| 332/358 [00:33<00:02, 10.04it/s] 93%|█████████▎| 334/358 [00:34<00:02,  9.95it/s] 94%|█████████▎| 335/358 [00:34<00:02,  9.82it/s] 94%|█████████▍| 337/358 [00:34<00:02,  9.90it/s] 95%|█████████▍| 339/358 [00:34<00:01, 10.10it/s] 95%|█████████▌| 341/358 [00:34<00:01, 10.04it/s] 96%|█████████▌| 343/358 [00:34<00:01,  9.89it/s] 96%|█████████▌| 344/358 [00:35<00:01,  9.83it/s] 96%|█████████▋| 345/358 [00:35<00:01,  9.85it/s] 97%|█████████▋| 346/358 [00:35<00:01,  9.88it/s] 97%|█████████▋| 348/358 [00:35<00:01,  9.97it/s] 97%|█████████▋| 349/358 [00:35<00:00,  9.87it/s] 98%|█████████▊| 350/358 [00:35<00:00,  9.79it/s] 98%|█████████▊| 351/358 [00:35<00:00,  9.74it/s] 99%|█████████▊| 353/358 [00:35<00:00,  9.91it/s] 99%|█████████▉| 354/358 [00:36<00:00,  9.89it/s] 99%|█████████▉| 355/358 [00:36<00:00,  9.80it/s]100%|█████████▉| 357/358 [00:36<00:00,  9.86it/s]100%|██████████| 358/358 [00:36<00:00,  9.81it/s]
[32m2025-02-05 05:35:33.405[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    gen_loss  grad clip ratio  grad norm   ppl
       2.229                1      4.196 9.287[0m
[32m2025-02-05 05:35:33.405[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m169[0m - [1m[Valid][0m
  0%|          | 0/10256 [00:00<?, ?it/s]100%|██████████| 10256/10256 [00:00<00:00, 926906.03it/s]
[32m2025-02-05 05:35:33.416[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:26,  1.45it/s]  5%|▌         | 2/40 [00:01<00:25,  1.47it/s]  8%|▊         | 3/40 [00:02<00:25,  1.47it/s] 10%|█         | 4/40 [00:02<00:24,  1.47it/s] 12%|█▎        | 5/40 [00:03<00:23,  1.46it/s] 15%|█▌        | 6/40 [00:04<00:23,  1.47it/s] 18%|█▊        | 7/40 [00:04<00:22,  1.46it/s] 20%|██        | 8/40 [00:05<00:21,  1.47it/s] 22%|██▎       | 9/40 [00:06<00:21,  1.47it/s] 25%|██▌       | 10/40 [00:06<00:20,  1.47it/s] 28%|██▊       | 11/40 [00:07<00:19,  1.48it/s] 30%|███       | 12/40 [00:08<00:18,  1.48it/s] 32%|███▎      | 13/40 [00:08<00:18,  1.48it/s] 35%|███▌      | 14/40 [00:09<00:17,  1.47it/s] 38%|███▊      | 15/40 [00:10<00:17,  1.47it/s] 40%|████      | 16/40 [00:10<00:16,  1.46it/s] 42%|████▎     | 17/40 [00:11<00:15,  1.47it/s] 45%|████▌     | 18/40 [00:12<00:14,  1.47it/s] 48%|████▊     | 19/40 [00:12<00:14,  1.47it/s] 50%|█████     | 20/40 [00:13<00:13,  1.47it/s] 52%|█████▎    | 21/40 [00:14<00:12,  1.48it/s] 55%|█████▌    | 22/40 [00:14<00:12,  1.47it/s] 57%|█████▊    | 23/40 [00:15<00:11,  1.47it/s] 60%|██████    | 24/40 [00:16<00:10,  1.46it/s] 62%|██████▎   | 25/40 [00:17<00:10,  1.47it/s] 65%|██████▌   | 26/40 [00:17<00:09,  1.48it/s] 68%|██████▊   | 27/40 [00:18<00:08,  1.48it/s] 70%|███████   | 28/40 [00:19<00:08,  1.47it/s] 72%|███████▎  | 29/40 [00:19<00:07,  1.47it/s] 75%|███████▌  | 30/40 [00:20<00:06,  1.48it/s] 78%|███████▊  | 31/40 [00:21<00:06,  1.48it/s] 80%|████████  | 32/40 [00:21<00:05,  1.48it/s] 82%|████████▎ | 33/40 [00:22<00:04,  1.47it/s] 85%|████████▌ | 34/40 [00:23<00:04,  1.48it/s] 88%|████████▊ | 35/40 [00:23<00:03,  1.47it/s] 90%|█████████ | 36/40 [00:24<00:02,  1.46it/s] 92%|█████████▎| 37/40 [00:25<00:02,  1.47it/s] 95%|█████████▌| 38/40 [00:25<00:01,  1.46it/s] 98%|█████████▊| 39/40 [00:26<00:00,  1.46it/s]100%|██████████| 40/40 [00:27<00:00,  1.61it/s]100%|██████████| 40/40 [00:27<00:00,  1.48it/s]
[32m2025-02-05 05:36:00.429[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    average  bleu@1  bleu@2  bleu@3  bleu@4  dist@1  dist@2  dist@3  dist@4  extreme  \
      .7738   .2939   .1092  .04598  .02482  .04389   .3079   .6166   .8017    .5885   
      f1  gen_loss  greedy  intra_dist@1  intra_dist@2  intra_dist@3  intra_dist@4  \
   .3539     4.498   .6666         .8989         .9844         .9563         .9086   
     ppl  rouge1  rouge2  rougeL  
   89.88   .3854  .09281   .3733[0m
[32m2025-02-05 05:36:00.435[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m163[0m - [1m[Conversation epoch 26][0m
[32m2025-02-05 05:36:00.435[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m164[0m - [1m[Train][0m
  0%|          | 0/92414 [00:00<?, ?it/s]100%|██████████| 92414/92414 [00:00<00:00, 1075100.43it/s]
[32m2025-02-05 05:36:00.521[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/358 [00:00<?, ?it/s]  0%|          | 1/358 [00:00<00:36,  9.73it/s]  1%|          | 3/358 [00:00<00:35,  9.92it/s]  1%|          | 4/358 [00:00<00:35,  9.89it/s]  2%|▏         | 6/358 [00:00<00:35,  9.86it/s]  2%|▏         | 7/358 [00:00<00:35,  9.80it/s]  2%|▏         | 8/358 [00:00<00:35,  9.84it/s]  3%|▎         | 9/358 [00:00<00:35,  9.74it/s]  3%|▎         | 10/358 [00:01<00:35,  9.73it/s]  3%|▎         | 11/358 [00:01<00:35,  9.68it/s]  4%|▎         | 13/358 [00:01<00:34,  9.90it/s]  4%|▍         | 14/358 [00:01<00:34,  9.83it/s]  4%|▍         | 15/358 [00:01<00:35,  9.75it/s]  4%|▍         | 16/358 [00:01<00:35,  9.69it/s]  5%|▍         | 17/358 [00:01<00:35,  9.71it/s]  5%|▌         | 18/358 [00:01<00:34,  9.78it/s]  5%|▌         | 19/358 [00:01<00:34,  9.72it/s]  6%|▌         | 20/358 [00:02<00:34,  9.66it/s]  6%|▌         | 21/358 [00:02<00:35,  9.59it/s]  6%|▌         | 22/358 [00:02<00:34,  9.66it/s]  7%|▋         | 24/358 [00:02<00:34,  9.76it/s]  7%|▋         | 25/358 [00:02<00:34,  9.71it/s]  7%|▋         | 26/358 [00:02<00:34,  9.66it/s]  8%|▊         | 27/358 [00:02<00:34,  9.71it/s]  8%|▊         | 28/358 [00:02<00:34,  9.66it/s]  8%|▊         | 29/358 [00:02<00:34,  9.63it/s]  9%|▊         | 31/358 [00:03<00:33,  9.73it/s]  9%|▉         | 32/358 [00:03<00:33,  9.73it/s]  9%|▉         | 34/358 [00:03<00:32,  9.83it/s] 10%|█         | 36/358 [00:03<00:32,  9.83it/s] 10%|█         | 37/358 [00:03<00:32,  9.81it/s] 11%|█         | 38/358 [00:03<00:32,  9.77it/s] 11%|█         | 40/358 [00:04<00:32,  9.93it/s] 11%|█▏        | 41/358 [00:04<00:32,  9.84it/s] 12%|█▏        | 43/358 [00:04<00:31,  9.87it/s] 13%|█▎        | 45/358 [00:04<00:31,  9.97it/s] 13%|█▎        | 47/358 [00:04<00:31,  9.94it/s] 13%|█▎        | 48/358 [00:04<00:31,  9.93it/s] 14%|█▍        | 50/358 [00:05<00:31,  9.90it/s] 14%|█▍        | 51/358 [00:05<00:31,  9.83it/s] 15%|█▍        | 52/358 [00:05<00:31,  9.74it/s] 15%|█▍        | 53/358 [00:05<00:31,  9.69it/s] 15%|█▌        | 54/358 [00:05<00:31,  9.73it/s] 15%|█▌        | 55/358 [00:05<00:31,  9.68it/s] 16%|█▌        | 56/358 [00:05<00:31,  9.72it/s] 16%|█▌        | 57/358 [00:05<00:31,  9.68it/s] 16%|█▌        | 58/358 [00:05<00:31,  9.65it/s] 16%|█▋        | 59/358 [00:06<00:31,  9.62it/s] 17%|█▋        | 61/358 [00:06<00:30,  9.71it/s] 17%|█▋        | 62/358 [00:06<00:30,  9.63it/s] 18%|█▊        | 63/358 [00:06<00:30,  9.70it/s] 18%|█▊        | 64/358 [00:06<00:30,  9.65it/s] 18%|█▊        | 66/358 [00:06<00:30,  9.72it/s] 19%|█▊        | 67/358 [00:06<00:29,  9.71it/s] 19%|█▉        | 69/358 [00:07<00:29,  9.77it/s] 20%|█▉        | 70/358 [00:07<00:29,  9.72it/s] 20%|█▉        | 71/358 [00:07<00:29,  9.76it/s] 20%|██        | 72/358 [00:07<00:29,  9.71it/s] 20%|██        | 73/358 [00:07<00:29,  9.68it/s] 21%|██        | 74/358 [00:07<00:29,  9.64it/s] 21%|██        | 75/358 [00:07<00:29,  9.60it/s] 21%|██        | 76/358 [00:07<00:29,  9.70it/s] 22%|██▏       | 77/358 [00:07<00:29,  9.67it/s] 22%|██▏       | 79/358 [00:08<00:28,  9.68it/s] 23%|██▎       | 81/358 [00:08<00:28,  9.74it/s] 23%|██▎       | 83/358 [00:08<00:28,  9.77it/s] 23%|██▎       | 84/358 [00:08<00:28,  9.72it/s] 24%|██▎       | 85/358 [00:08<00:28,  9.67it/s] 24%|██▍       | 86/358 [00:08<00:28,  9.66it/s] 24%|██▍       | 87/358 [00:08<00:28,  9.64it/s] 25%|██▍       | 88/358 [00:09<00:27,  9.66it/s] 25%|██▌       | 90/358 [00:09<00:27,  9.90it/s] 26%|██▌       | 92/358 [00:09<00:26, 10.00it/s] 26%|██▌       | 93/358 [00:09<00:26,  9.96it/s] 26%|██▋       | 94/358 [00:09<00:26,  9.87it/s] 27%|██▋       | 96/358 [00:09<00:25, 10.15it/s] 27%|██▋       | 98/358 [00:10<00:25, 10.04it/s] 28%|██▊       | 99/358 [00:10<00:26,  9.95it/s] 28%|██▊       | 101/358 [00:10<00:25,  9.92it/s] 29%|██▉       | 103/358 [00:10<00:25,  9.90it/s] 29%|██▉       | 104/358 [00:10<00:25,  9.85it/s] 29%|██▉       | 105/358 [00:10<00:25,  9.78it/s] 30%|██▉       | 106/358 [00:10<00:25,  9.76it/s] 30%|███       | 108/358 [00:11<00:25,  9.79it/s] 30%|███       | 109/358 [00:11<00:25,  9.70it/s] 31%|███       | 110/358 [00:11<00:25,  9.68it/s] 31%|███       | 111/358 [00:11<00:25,  9.63it/s] 32%|███▏      | 113/358 [00:11<00:24,  9.90it/s] 32%|███▏      | 114/358 [00:11<00:24,  9.86it/s] 32%|███▏      | 115/358 [00:11<00:24,  9.76it/s] 32%|███▏      | 116/358 [00:11<00:24,  9.68it/s] 33%|███▎      | 117/358 [00:11<00:24,  9.65it/s] 33%|███▎      | 119/358 [00:12<00:24,  9.77it/s] 34%|███▍      | 121/358 [00:12<00:23,  9.97it/s] 34%|███▍      | 123/358 [00:12<00:23, 10.07it/s] 35%|███▍      | 125/358 [00:12<00:23, 10.05it/s] 35%|███▌      | 126/358 [00:12<00:23, 10.01it/s] 35%|███▌      | 127/358 [00:12<00:23,  9.96it/s] 36%|███▌      | 128/358 [00:13<00:23,  9.91it/s] 36%|███▋      | 130/358 [00:13<00:22,  9.97it/s] 37%|███▋      | 131/358 [00:13<00:22,  9.88it/s] 37%|███▋      | 132/358 [00:13<00:22,  9.90it/s] 37%|███▋      | 134/358 [00:13<00:22,  9.92it/s] 38%|███▊      | 135/358 [00:13<00:22,  9.86it/s] 38%|███▊      | 137/358 [00:13<00:22,  9.95it/s] 39%|███▊      | 138/358 [00:14<00:22,  9.93it/s] 39%|███▉      | 139/358 [00:14<00:22,  9.85it/s] 39%|███▉      | 141/358 [00:14<00:21,  9.97it/s] 40%|███▉      | 142/358 [00:14<00:21,  9.89it/s] 40%|███▉      | 143/358 [00:14<00:21,  9.86it/s] 40%|████      | 144/358 [00:14<00:21,  9.77it/s] 41%|████      | 145/358 [00:14<00:21,  9.79it/s] 41%|████      | 146/358 [00:14<00:21,  9.73it/s] 41%|████      | 147/358 [00:14<00:21,  9.66it/s] 41%|████▏     | 148/358 [00:15<00:21,  9.69it/s] 42%|████▏     | 149/358 [00:15<00:21,  9.68it/s] 42%|████▏     | 150/358 [00:15<00:21,  9.64it/s] 42%|████▏     | 151/358 [00:15<00:22,  9.37it/s] 42%|████▏     | 152/358 [00:15<00:21,  9.42it/s] 43%|████▎     | 153/358 [00:15<00:21,  9.44it/s] 43%|████▎     | 154/358 [00:15<00:21,  9.53it/s] 43%|████▎     | 155/358 [00:15<00:21,  9.54it/s] 44%|████▎     | 156/358 [00:15<00:20,  9.67it/s] 44%|████▍     | 157/358 [00:16<00:20,  9.61it/s] 44%|████▍     | 158/358 [00:16<00:20,  9.69it/s] 44%|████▍     | 159/358 [00:16<00:20,  9.69it/s] 45%|████▍     | 160/358 [00:16<00:20,  9.69it/s] 45%|████▌     | 162/358 [00:16<00:19,  9.99it/s] 46%|████▌     | 164/358 [00:16<00:19,  9.98it/s] 46%|████▌     | 165/358 [00:16<00:19,  9.94it/s] 47%|████▋     | 167/358 [00:17<00:19,  9.89it/s] 47%|████▋     | 169/358 [00:17<00:19,  9.93it/s] 48%|████▊     | 171/358 [00:17<00:18,  9.92it/s] 48%|████▊     | 172/358 [00:17<00:18,  9.86it/s] 48%|████▊     | 173/358 [00:17<00:18,  9.80it/s] 49%|████▉     | 175/358 [00:17<00:18,  9.82it/s] 49%|████▉     | 176/358 [00:17<00:18,  9.83it/s] 49%|████▉     | 177/358 [00:18<00:18,  9.82it/s] 50%|█████     | 179/358 [00:18<00:18,  9.84it/s] 50%|█████     | 180/358 [00:18<00:18,  9.77it/s] 51%|█████     | 182/358 [00:18<00:17,  9.92it/s] 51%|█████     | 183/358 [00:18<00:17,  9.88it/s] 51%|█████▏    | 184/358 [00:18<00:17,  9.77it/s] 52%|█████▏    | 185/358 [00:18<00:17,  9.71it/s] 52%|█████▏    | 187/358 [00:19<00:17,  9.93it/s] 53%|█████▎    | 188/358 [00:19<00:17,  9.88it/s] 53%|█████▎    | 189/358 [00:19<00:17,  9.82it/s] 53%|█████▎    | 190/358 [00:19<00:17,  9.86it/s] 53%|█████▎    | 191/358 [00:19<00:17,  9.69it/s] 54%|█████▎    | 192/358 [00:19<00:17,  9.64it/s] 54%|█████▍    | 193/358 [00:19<00:17,  9.65it/s] 54%|█████▍    | 194/358 [00:19<00:17,  9.63it/s] 54%|█████▍    | 195/358 [00:19<00:16,  9.71it/s] 55%|█████▌    | 197/358 [00:20<00:16,  9.90it/s] 55%|█████▌    | 198/358 [00:20<00:16,  9.83it/s] 56%|█████▌    | 199/358 [00:20<00:16,  9.86it/s] 56%|█████▌    | 200/358 [00:20<00:16,  9.79it/s] 56%|█████▌    | 201/358 [00:20<00:16,  9.75it/s] 57%|█████▋    | 203/358 [00:20<00:15,  9.84it/s] 57%|█████▋    | 204/358 [00:20<00:15,  9.74it/s] 57%|█████▋    | 205/358 [00:20<00:15,  9.69it/s] 58%|█████▊    | 207/358 [00:21<00:15,  9.86it/s] 58%|█████▊    | 208/358 [00:21<00:15,  9.79it/s] 59%|█████▊    | 210/358 [00:21<00:15,  9.81it/s] 59%|█████▉    | 212/358 [00:21<00:14,  9.80it/s] 60%|█████▉    | 214/358 [00:21<00:14,  9.88it/s] 60%|██████    | 215/358 [00:21<00:14,  9.82it/s] 60%|██████    | 216/358 [00:22<00:14,  9.75it/s] 61%|██████    | 217/358 [00:22<00:14,  9.79it/s] 61%|██████    | 218/358 [00:22<00:14,  9.76it/s] 61%|██████    | 219/358 [00:22<00:14,  9.76it/s] 62%|██████▏   | 221/358 [00:22<00:13,  9.89it/s] 62%|██████▏   | 222/358 [00:22<00:13,  9.79it/s] 62%|██████▏   | 223/358 [00:22<00:13,  9.74it/s] 63%|██████▎   | 224/358 [00:22<00:13,  9.68it/s] 63%|██████▎   | 225/358 [00:22<00:13,  9.76it/s] 63%|██████▎   | 226/358 [00:23<00:13,  9.71it/s] 64%|██████▎   | 228/358 [00:23<00:13,  9.75it/s] 64%|██████▍   | 229/358 [00:23<00:13,  9.72it/s] 64%|██████▍   | 230/358 [00:23<00:13,  9.67it/s] 65%|██████▍   | 232/358 [00:23<00:12,  9.72it/s] 65%|██████▌   | 234/358 [00:23<00:12, 10.01it/s] 66%|██████▌   | 236/358 [00:24<00:12,  9.97it/s] 66%|██████▋   | 238/358 [00:24<00:11, 10.02it/s] 67%|██████▋   | 240/358 [00:24<00:11,  9.98it/s] 68%|██████▊   | 242/358 [00:24<00:11,  9.96it/s] 68%|██████▊   | 243/358 [00:24<00:11,  9.90it/s] 68%|██████▊   | 244/358 [00:24<00:11,  9.83it/s] 69%|██████▊   | 246/358 [00:25<00:11,  9.86it/s] 69%|██████▉   | 247/358 [00:25<00:11,  9.78it/s] 69%|██████▉   | 248/358 [00:25<00:11,  9.74it/s] 70%|██████▉   | 250/358 [00:25<00:11,  9.77it/s] 70%|███████   | 251/358 [00:25<00:11,  9.72it/s] 70%|███████   | 252/358 [00:25<00:10,  9.67it/s] 71%|███████   | 253/358 [00:25<00:10,  9.64it/s] 71%|███████   | 254/358 [00:25<00:10,  9.62it/s] 72%|███████▏  | 256/358 [00:26<00:10,  9.80it/s] 72%|███████▏  | 257/358 [00:26<00:10,  9.81it/s] 72%|███████▏  | 258/358 [00:26<00:10,  9.68it/s] 72%|███████▏  | 259/358 [00:26<00:10,  9.65it/s] 73%|███████▎  | 260/358 [00:26<00:10,  9.69it/s] 73%|███████▎  | 262/358 [00:26<00:09,  9.87it/s] 74%|███████▎  | 264/358 [00:26<00:09,  9.89it/s] 74%|███████▍  | 266/358 [00:27<00:09,  9.89it/s] 75%|███████▍  | 267/358 [00:27<00:09,  9.83it/s] 75%|███████▌  | 269/358 [00:27<00:09,  9.88it/s] 75%|███████▌  | 270/358 [00:27<00:08,  9.81it/s] 76%|███████▌  | 271/358 [00:27<00:08,  9.74it/s] 76%|███████▌  | 272/358 [00:27<00:08,  9.72it/s] 76%|███████▋  | 273/358 [00:27<00:08,  9.62it/s] 77%|███████▋  | 274/358 [00:27<00:08,  9.61it/s] 77%|███████▋  | 275/358 [00:28<00:08,  9.66it/s] 77%|███████▋  | 276/358 [00:28<00:08,  9.67it/s] 77%|███████▋  | 277/358 [00:28<00:08,  9.64it/s] 78%|███████▊  | 278/358 [00:28<00:08,  9.61it/s] 78%|███████▊  | 280/358 [00:28<00:07,  9.80it/s] 78%|███████▊  | 281/358 [00:28<00:07,  9.82it/s] 79%|███████▉  | 282/358 [00:28<00:07,  9.75it/s] 79%|███████▉  | 283/358 [00:28<00:07,  9.69it/s] 79%|███████▉  | 284/358 [00:29<00:07,  9.65it/s] 80%|███████▉  | 285/358 [00:29<00:07,  9.72it/s] 80%|███████▉  | 286/358 [00:29<00:07,  9.68it/s] 80%|████████  | 287/358 [00:29<00:07,  9.65it/s] 80%|████████  | 288/358 [00:29<00:07,  9.61it/s] 81%|████████  | 289/358 [00:29<00:07,  9.72it/s] 81%|████████▏ | 291/358 [00:29<00:06,  9.84it/s] 82%|████████▏ | 293/358 [00:29<00:06,  9.84it/s] 82%|████████▏ | 295/358 [00:30<00:06,  9.90it/s] 83%|████████▎ | 296/358 [00:30<00:06,  9.84it/s] 83%|████████▎ | 297/358 [00:30<00:06,  9.73it/s] 84%|████████▎ | 299/358 [00:30<00:05,  9.88it/s] 84%|████████▍ | 301/358 [00:30<00:05,  9.90it/s] 84%|████████▍ | 302/358 [00:30<00:05,  9.84it/s] 85%|████████▍ | 303/358 [00:30<00:05,  9.85it/s] 85%|████████▌ | 305/358 [00:31<00:05,  9.88it/s] 85%|████████▌ | 306/358 [00:31<00:05,  9.80it/s] 86%|████████▌ | 308/358 [00:31<00:05,  9.91it/s] 86%|████████▋ | 309/358 [00:31<00:04,  9.81it/s] 87%|████████▋ | 310/358 [00:31<00:04,  9.75it/s] 87%|████████▋ | 311/358 [00:31<00:04,  9.67it/s] 87%|████████▋ | 312/358 [00:31<00:04,  9.69it/s] 87%|████████▋ | 313/358 [00:31<00:04,  9.71it/s] 88%|████████▊ | 315/358 [00:32<00:04,  9.97it/s] 88%|████████▊ | 316/358 [00:32<00:04,  9.92it/s] 89%|████████▊ | 317/358 [00:32<00:04,  9.84it/s] 89%|████████▉ | 318/358 [00:32<00:04,  9.79it/s] 89%|████████▉ | 319/358 [00:32<00:04,  9.74it/s] 89%|████████▉ | 320/358 [00:32<00:03,  9.80it/s] 90%|████████▉ | 321/358 [00:32<00:03,  9.72it/s] 90%|████████▉ | 322/358 [00:32<00:03,  9.69it/s] 90%|█████████ | 323/358 [00:32<00:03,  9.64it/s] 91%|█████████ | 324/358 [00:33<00:03,  9.61it/s] 91%|█████████ | 325/358 [00:33<00:03,  9.59it/s] 91%|█████████▏| 327/358 [00:33<00:03,  9.95it/s] 92%|█████████▏| 329/358 [00:33<00:02, 10.05it/s] 92%|█████████▏| 330/358 [00:33<00:02,  9.94it/s] 93%|█████████▎| 332/358 [00:33<00:02, 10.04it/s] 93%|█████████▎| 334/358 [00:34<00:02,  9.95it/s] 94%|█████████▎| 335/358 [00:34<00:02,  9.82it/s] 94%|█████████▍| 337/358 [00:34<00:02,  9.90it/s] 95%|█████████▍| 339/358 [00:34<00:01, 10.10it/s] 95%|█████████▌| 341/358 [00:34<00:01, 10.04it/s] 96%|█████████▌| 342/358 [00:34<00:01,  9.96it/s] 96%|█████████▌| 343/358 [00:34<00:01,  9.85it/s] 96%|█████████▌| 344/358 [00:35<00:01,  9.79it/s] 96%|█████████▋| 345/358 [00:35<00:01,  9.82it/s] 97%|█████████▋| 346/358 [00:35<00:01,  9.86it/s] 97%|█████████▋| 348/358 [00:35<00:01,  9.96it/s] 97%|█████████▋| 349/358 [00:35<00:00,  9.87it/s] 98%|█████████▊| 350/358 [00:35<00:00,  9.79it/s] 98%|█████████▊| 351/358 [00:35<00:00,  9.74it/s] 99%|█████████▊| 353/358 [00:36<00:00,  9.92it/s] 99%|█████████▉| 354/358 [00:36<00:00,  9.90it/s] 99%|█████████▉| 355/358 [00:36<00:00,  9.80it/s]100%|█████████▉| 357/358 [00:36<00:00,  9.86it/s]100%|██████████| 358/358 [00:36<00:00,  9.81it/s]
[32m2025-02-05 05:36:37.024[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    gen_loss  grad clip ratio  grad norm  ppl
       2.208                1      3.695  9.1[0m
[32m2025-02-05 05:36:37.024[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m169[0m - [1m[Valid][0m
  0%|          | 0/10256 [00:00<?, ?it/s]100%|██████████| 10256/10256 [00:00<00:00, 918004.69it/s]
[32m2025-02-05 05:36:37.036[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:26,  1.45it/s]  5%|▌         | 2/40 [00:01<00:25,  1.47it/s]  8%|▊         | 3/40 [00:02<00:25,  1.47it/s] 10%|█         | 4/40 [00:02<00:24,  1.47it/s] 12%|█▎        | 5/40 [00:03<00:23,  1.46it/s] 15%|█▌        | 6/40 [00:04<00:23,  1.46it/s] 18%|█▊        | 7/40 [00:04<00:22,  1.46it/s] 20%|██        | 8/40 [00:05<00:21,  1.47it/s] 22%|██▎       | 9/40 [00:06<00:21,  1.47it/s] 25%|██▌       | 10/40 [00:06<00:20,  1.47it/s] 28%|██▊       | 11/40 [00:07<00:19,  1.47it/s] 30%|███       | 12/40 [00:08<00:18,  1.48it/s] 32%|███▎      | 13/40 [00:08<00:18,  1.47it/s] 35%|███▌      | 14/40 [00:09<00:17,  1.47it/s] 38%|███▊      | 15/40 [00:10<00:17,  1.47it/s] 40%|████      | 16/40 [00:10<00:16,  1.46it/s] 42%|████▎     | 17/40 [00:11<00:15,  1.47it/s] 45%|████▌     | 18/40 [00:12<00:14,  1.47it/s] 48%|████▊     | 19/40 [00:12<00:14,  1.46it/s] 50%|█████     | 20/40 [00:13<00:13,  1.47it/s] 52%|█████▎    | 21/40 [00:14<00:12,  1.47it/s] 55%|█████▌    | 22/40 [00:14<00:12,  1.47it/s] 57%|█████▊    | 23/40 [00:15<00:11,  1.47it/s] 60%|██████    | 24/40 [00:16<00:10,  1.46it/s] 62%|██████▎   | 25/40 [00:17<00:10,  1.46it/s] 65%|██████▌   | 26/40 [00:17<00:09,  1.48it/s] 68%|██████▊   | 27/40 [00:18<00:08,  1.47it/s] 70%|███████   | 28/40 [00:19<00:08,  1.47it/s] 72%|███████▎  | 29/40 [00:19<00:07,  1.47it/s] 75%|███████▌  | 30/40 [00:20<00:06,  1.47it/s] 78%|███████▊  | 31/40 [00:21<00:06,  1.47it/s] 80%|████████  | 32/40 [00:21<00:05,  1.47it/s] 82%|████████▎ | 33/40 [00:22<00:04,  1.46it/s] 85%|████████▌ | 34/40 [00:23<00:04,  1.47it/s] 88%|████████▊ | 35/40 [00:23<00:03,  1.47it/s] 90%|█████████ | 36/40 [00:24<00:02,  1.46it/s] 92%|█████████▎| 37/40 [00:25<00:02,  1.47it/s] 95%|█████████▌| 38/40 [00:25<00:01,  1.46it/s] 98%|█████████▊| 39/40 [00:26<00:00,  1.46it/s]100%|██████████| 40/40 [00:27<00:00,  1.62it/s]100%|██████████| 40/40 [00:27<00:00,  1.48it/s]
[32m2025-02-05 05:37:04.089[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    average  bleu@1  bleu@2  bleu@3  bleu@4  dist@1  dist@2  dist@3  dist@4  extreme  \
      .7731   .2946   .1058  .04384  .02353  .04892   .3256   .6354   .8155    .5875   
      f1  gen_loss  greedy  intra_dist@1  intra_dist@2  intra_dist@3  intra_dist@4  \
   .3550     4.552   .6653         .9012         .9851         .9558         .9074   
     ppl  rouge1  rouge2  rougeL  
   94.84   .3835  .08924   .3712[0m
[32m2025-02-05 05:37:04.095[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m163[0m - [1m[Conversation epoch 27][0m
[32m2025-02-05 05:37:04.095[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m164[0m - [1m[Train][0m
  0%|          | 0/92414 [00:00<?, ?it/s]100%|██████████| 92414/92414 [00:00<00:00, 1098021.05it/s]
[32m2025-02-05 05:37:04.179[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/358 [00:00<?, ?it/s]  0%|          | 1/358 [00:00<00:36,  9.76it/s]  1%|          | 3/358 [00:00<00:35,  9.92it/s]  1%|          | 4/358 [00:00<00:35,  9.90it/s]  2%|▏         | 6/358 [00:00<00:35,  9.87it/s]  2%|▏         | 7/358 [00:00<00:35,  9.80it/s]  2%|▏         | 8/358 [00:00<00:35,  9.85it/s]  3%|▎         | 9/358 [00:00<00:35,  9.75it/s]  3%|▎         | 10/358 [00:01<00:35,  9.74it/s]  3%|▎         | 11/358 [00:01<00:35,  9.69it/s]  4%|▎         | 13/358 [00:01<00:34,  9.91it/s]  4%|▍         | 14/358 [00:01<00:34,  9.83it/s]  4%|▍         | 15/358 [00:01<00:35,  9.76it/s]  4%|▍         | 16/358 [00:01<00:35,  9.70it/s]  5%|▍         | 17/358 [00:01<00:35,  9.71it/s]  5%|▌         | 18/358 [00:01<00:34,  9.79it/s]  5%|▌         | 19/358 [00:01<00:34,  9.71it/s]  6%|▌         | 20/358 [00:02<00:34,  9.66it/s]  6%|▌         | 21/358 [00:02<00:35,  9.59it/s]  6%|▌         | 22/358 [00:02<00:34,  9.66it/s]  7%|▋         | 24/358 [00:02<00:34,  9.76it/s]  7%|▋         | 25/358 [00:02<00:34,  9.71it/s]  7%|▋         | 26/358 [00:02<00:34,  9.66it/s]  8%|▊         | 27/358 [00:02<00:34,  9.71it/s]  8%|▊         | 28/358 [00:02<00:34,  9.66it/s]  8%|▊         | 29/358 [00:02<00:34,  9.63it/s]  9%|▊         | 31/358 [00:03<00:33,  9.73it/s]  9%|▉         | 32/358 [00:03<00:33,  9.73it/s]  9%|▉         | 34/358 [00:03<00:32,  9.83it/s] 10%|█         | 36/358 [00:03<00:32,  9.83it/s] 10%|█         | 37/358 [00:03<00:32,  9.81it/s] 11%|█         | 38/358 [00:03<00:32,  9.77it/s] 11%|█         | 40/358 [00:04<00:32,  9.93it/s] 11%|█▏        | 41/358 [00:04<00:32,  9.84it/s] 12%|█▏        | 43/358 [00:04<00:31,  9.87it/s] 13%|█▎        | 45/358 [00:04<00:31,  9.96it/s] 13%|█▎        | 47/358 [00:04<00:31,  9.94it/s] 13%|█▎        | 48/358 [00:04<00:31,  9.93it/s] 14%|█▍        | 50/358 [00:05<00:31,  9.90it/s] 14%|█▍        | 51/358 [00:05<00:31,  9.83it/s] 15%|█▍        | 52/358 [00:05<00:31,  9.74it/s] 15%|█▍        | 53/358 [00:05<00:31,  9.69it/s] 15%|█▌        | 54/358 [00:05<00:31,  9.73it/s] 15%|█▌        | 55/358 [00:05<00:31,  9.68it/s] 16%|█▌        | 56/358 [00:05<00:31,  9.72it/s] 16%|█▌        | 57/358 [00:05<00:31,  9.68it/s] 16%|█▌        | 58/358 [00:05<00:31,  9.66it/s] 16%|█▋        | 59/358 [00:06<00:31,  9.63it/s] 17%|█▋        | 61/358 [00:06<00:30,  9.71it/s] 17%|█▋        | 62/358 [00:06<00:30,  9.63it/s] 18%|█▊        | 63/358 [00:06<00:30,  9.70it/s] 18%|█▊        | 64/358 [00:06<00:30,  9.65it/s] 18%|█▊        | 66/358 [00:06<00:30,  9.71it/s] 19%|█▊        | 67/358 [00:06<00:30,  9.70it/s] 19%|█▉        | 69/358 [00:07<00:29,  9.76it/s] 20%|█▉        | 70/358 [00:07<00:29,  9.71it/s] 20%|█▉        | 71/358 [00:07<00:29,  9.76it/s] 20%|██        | 72/358 [00:07<00:29,  9.70it/s] 20%|██        | 73/358 [00:07<00:29,  9.67it/s] 21%|██        | 74/358 [00:07<00:29,  9.64it/s] 21%|██        | 75/358 [00:07<00:29,  9.61it/s] 21%|██        | 76/358 [00:07<00:29,  9.71it/s] 22%|██▏       | 77/358 [00:07<00:29,  9.67it/s] 22%|██▏       | 79/358 [00:08<00:28,  9.68it/s] 23%|██▎       | 81/358 [00:08<00:28,  9.74it/s] 23%|██▎       | 83/358 [00:08<00:28,  9.77it/s] 23%|██▎       | 84/358 [00:08<00:28,  9.71it/s] 24%|██▎       | 85/358 [00:08<00:28,  9.67it/s] 24%|██▍       | 86/358 [00:08<00:28,  9.66it/s] 24%|██▍       | 87/358 [00:08<00:28,  9.64it/s] 25%|██▍       | 88/358 [00:09<00:27,  9.66it/s] 25%|██▌       | 90/358 [00:09<00:27,  9.89it/s] 26%|██▌       | 92/358 [00:09<00:26,  9.99it/s] 26%|██▌       | 93/358 [00:09<00:26,  9.96it/s] 26%|██▋       | 94/358 [00:09<00:26,  9.87it/s] 27%|██▋       | 96/358 [00:09<00:25, 10.15it/s] 27%|██▋       | 98/358 [00:10<00:25, 10.04it/s] 28%|██▊       | 99/358 [00:10<00:26,  9.95it/s] 28%|██▊       | 101/358 [00:10<00:25,  9.91it/s] 29%|██▉       | 103/358 [00:10<00:25,  9.90it/s] 29%|██▉       | 104/358 [00:10<00:25,  9.85it/s] 29%|██▉       | 105/358 [00:10<00:25,  9.77it/s] 30%|██▉       | 106/358 [00:10<00:25,  9.76it/s] 30%|███       | 108/358 [00:11<00:25,  9.78it/s] 30%|███       | 109/358 [00:11<00:25,  9.70it/s] 31%|███       | 110/358 [00:11<00:25,  9.68it/s] 31%|███       | 111/358 [00:11<00:25,  9.63it/s] 32%|███▏      | 113/358 [00:11<00:24,  9.90it/s] 32%|███▏      | 114/358 [00:11<00:24,  9.86it/s] 32%|███▏      | 115/358 [00:11<00:24,  9.77it/s] 32%|███▏      | 116/358 [00:11<00:24,  9.68it/s] 33%|███▎      | 117/358 [00:11<00:24,  9.65it/s] 33%|███▎      | 119/358 [00:12<00:24,  9.77it/s] 34%|███▍      | 121/358 [00:12<00:23,  9.97it/s] 34%|███▍      | 123/358 [00:12<00:23, 10.07it/s] 35%|███▍      | 125/358 [00:12<00:23, 10.05it/s] 35%|███▌      | 126/358 [00:12<00:23, 10.01it/s] 35%|███▌      | 127/358 [00:12<00:23,  9.96it/s] 36%|███▌      | 128/358 [00:13<00:23,  9.91it/s] 36%|███▋      | 130/358 [00:13<00:22,  9.98it/s] 37%|███▋      | 131/358 [00:13<00:22,  9.88it/s] 37%|███▋      | 132/358 [00:13<00:22,  9.90it/s] 37%|███▋      | 134/358 [00:13<00:22,  9.92it/s] 38%|███▊      | 135/358 [00:13<00:22,  9.86it/s] 38%|███▊      | 137/358 [00:13<00:22,  9.95it/s] 39%|███▊      | 138/358 [00:14<00:22,  9.93it/s] 39%|███▉      | 139/358 [00:14<00:22,  9.85it/s] 39%|███▉      | 141/358 [00:14<00:21,  9.97it/s] 40%|███▉      | 142/358 [00:14<00:21,  9.89it/s] 40%|███▉      | 143/358 [00:14<00:21,  9.86it/s] 40%|████      | 144/358 [00:14<00:21,  9.77it/s] 41%|████      | 145/358 [00:14<00:21,  9.79it/s] 41%|████      | 146/358 [00:14<00:21,  9.73it/s] 41%|████      | 147/358 [00:14<00:21,  9.67it/s] 41%|████▏     | 148/358 [00:15<00:21,  9.70it/s] 42%|████▏     | 149/358 [00:15<00:21,  9.68it/s] 42%|████▏     | 150/358 [00:15<00:21,  9.64it/s] 42%|████▏     | 151/358 [00:15<00:22,  9.38it/s] 42%|████▏     | 152/358 [00:15<00:21,  9.42it/s] 43%|████▎     | 153/358 [00:15<00:21,  9.44it/s] 43%|████▎     | 154/358 [00:15<00:21,  9.54it/s] 43%|████▎     | 155/358 [00:15<00:21,  9.55it/s] 44%|████▎     | 156/358 [00:15<00:20,  9.67it/s] 44%|████▍     | 157/358 [00:16<00:20,  9.61it/s] 44%|████▍     | 158/358 [00:16<00:20,  9.69it/s] 44%|████▍     | 159/358 [00:16<00:20,  9.69it/s] 45%|████▍     | 160/358 [00:16<00:20,  9.70it/s] 45%|████▌     | 162/358 [00:16<00:19,  9.99it/s] 46%|████▌     | 164/358 [00:16<00:19,  9.99it/s] 46%|████▌     | 165/358 [00:16<00:19,  9.95it/s] 47%|████▋     | 167/358 [00:17<00:19,  9.89it/s] 47%|████▋     | 169/358 [00:17<00:19,  9.93it/s] 48%|████▊     | 171/358 [00:17<00:18,  9.91it/s] 48%|████▊     | 172/358 [00:17<00:18,  9.86it/s] 48%|████▊     | 173/358 [00:17<00:18,  9.80it/s] 49%|████▉     | 175/358 [00:17<00:18,  9.82it/s] 49%|████▉     | 176/358 [00:17<00:18,  9.83it/s] 49%|████▉     | 177/358 [00:18<00:18,  9.82it/s] 50%|█████     | 179/358 [00:18<00:18,  9.85it/s] 50%|█████     | 180/358 [00:18<00:18,  9.77it/s] 51%|█████     | 182/358 [00:18<00:17,  9.92it/s] 51%|█████     | 183/358 [00:18<00:17,  9.87it/s] 51%|█████▏    | 184/358 [00:18<00:17,  9.76it/s] 52%|█████▏    | 185/358 [00:18<00:17,  9.69it/s] 52%|█████▏    | 187/358 [00:19<00:17,  9.90it/s] 53%|█████▎    | 188/358 [00:19<00:17,  9.85it/s] 53%|█████▎    | 189/358 [00:19<00:17,  9.80it/s] 53%|█████▎    | 190/358 [00:19<00:17,  9.85it/s] 53%|█████▎    | 191/358 [00:19<00:17,  9.68it/s] 54%|█████▎    | 192/358 [00:19<00:17,  9.64it/s] 54%|█████▍    | 193/358 [00:19<00:17,  9.64it/s] 54%|█████▍    | 194/358 [00:19<00:17,  9.63it/s] 54%|█████▍    | 195/358 [00:19<00:16,  9.71it/s] 55%|█████▌    | 197/358 [00:20<00:16,  9.90it/s] 55%|█████▌    | 198/358 [00:20<00:16,  9.82it/s] 56%|█████▌    | 199/358 [00:20<00:16,  9.85it/s] 56%|█████▌    | 200/358 [00:20<00:16,  9.78it/s] 56%|█████▌    | 201/358 [00:20<00:16,  9.74it/s] 57%|█████▋    | 203/358 [00:20<00:15,  9.83it/s] 57%|█████▋    | 204/358 [00:20<00:15,  9.73it/s] 57%|█████▋    | 205/358 [00:20<00:15,  9.68it/s] 58%|█████▊    | 207/358 [00:21<00:15,  9.85it/s] 58%|█████▊    | 208/358 [00:21<00:15,  9.78it/s] 59%|█████▊    | 210/358 [00:21<00:15,  9.80it/s] 59%|█████▉    | 212/358 [00:21<00:14,  9.79it/s] 60%|█████▉    | 214/358 [00:21<00:14,  9.87it/s] 60%|██████    | 215/358 [00:21<00:14,  9.81it/s] 60%|██████    | 216/358 [00:22<00:14,  9.75it/s] 61%|██████    | 217/358 [00:22<00:14,  9.78it/s] 61%|██████    | 218/358 [00:22<00:14,  9.76it/s] 61%|██████    | 219/358 [00:22<00:14,  9.75it/s] 62%|██████▏   | 221/358 [00:22<00:13,  9.88it/s] 62%|██████▏   | 222/358 [00:22<00:13,  9.78it/s] 62%|██████▏   | 223/358 [00:22<00:13,  9.73it/s] 63%|██████▎   | 224/358 [00:22<00:13,  9.67it/s] 63%|██████▎   | 225/358 [00:22<00:13,  9.76it/s] 63%|██████▎   | 226/358 [00:23<00:13,  9.70it/s] 64%|██████▎   | 228/358 [00:23<00:13,  9.74it/s] 64%|██████▍   | 229/358 [00:23<00:13,  9.71it/s] 64%|██████▍   | 230/358 [00:23<00:13,  9.66it/s] 65%|██████▍   | 232/358 [00:23<00:12,  9.72it/s] 65%|██████▌   | 234/358 [00:23<00:12, 10.01it/s] 66%|██████▌   | 236/358 [00:24<00:12,  9.97it/s] 66%|██████▋   | 238/358 [00:24<00:11, 10.02it/s] 67%|██████▋   | 240/358 [00:24<00:11,  9.97it/s] 68%|██████▊   | 242/358 [00:24<00:11,  9.95it/s] 68%|██████▊   | 243/358 [00:24<00:11,  9.89it/s] 68%|██████▊   | 244/358 [00:24<00:11,  9.83it/s] 69%|██████▊   | 246/358 [00:25<00:11,  9.85it/s] 69%|██████▉   | 247/358 [00:25<00:11,  9.78it/s] 69%|██████▉   | 248/358 [00:25<00:11,  9.74it/s] 70%|██████▉   | 250/358 [00:25<00:10,  9.83it/s] 70%|███████   | 251/358 [00:25<00:10,  9.77it/s] 70%|███████   | 252/358 [00:25<00:10,  9.70it/s] 71%|███████   | 253/358 [00:25<00:10,  9.67it/s] 71%|███████   | 254/358 [00:25<00:10,  9.64it/s] 72%|███████▏  | 256/358 [00:26<00:10,  9.82it/s] 72%|███████▏  | 257/358 [00:26<00:10,  9.82it/s] 72%|███████▏  | 258/358 [00:26<00:10,  9.70it/s] 72%|███████▏  | 259/358 [00:26<00:10,  9.66it/s] 73%|███████▎  | 260/358 [00:26<00:10,  9.70it/s] 73%|███████▎  | 262/358 [00:26<00:09,  9.88it/s] 74%|███████▎  | 264/358 [00:26<00:09,  9.89it/s] 74%|███████▍  | 266/358 [00:27<00:09,  9.87it/s] 75%|███████▍  | 267/358 [00:27<00:09,  9.82it/s] 75%|███████▌  | 269/358 [00:27<00:09,  9.88it/s] 75%|███████▌  | 270/358 [00:27<00:08,  9.81it/s] 76%|███████▌  | 271/358 [00:27<00:08,  9.74it/s] 76%|███████▌  | 272/358 [00:27<00:08,  9.71it/s] 76%|███████▋  | 273/358 [00:27<00:08,  9.62it/s] 77%|███████▋  | 274/358 [00:27<00:08,  9.62it/s] 77%|███████▋  | 275/358 [00:28<00:08,  9.67it/s] 77%|███████▋  | 276/358 [00:28<00:08,  9.67it/s] 77%|███████▋  | 277/358 [00:28<00:08,  9.64it/s] 78%|███████▊  | 278/358 [00:28<00:08,  9.61it/s] 78%|███████▊  | 280/358 [00:28<00:07,  9.80it/s] 78%|███████▊  | 281/358 [00:28<00:07,  9.81it/s] 79%|███████▉  | 282/358 [00:28<00:07,  9.75it/s] 79%|███████▉  | 283/358 [00:28<00:07,  9.69it/s] 79%|███████▉  | 284/358 [00:29<00:07,  9.66it/s] 80%|███████▉  | 285/358 [00:29<00:07,  9.72it/s] 80%|███████▉  | 286/358 [00:29<00:07,  9.68it/s] 80%|████████  | 287/358 [00:29<00:07,  9.65it/s] 80%|████████  | 288/358 [00:29<00:07,  9.61it/s] 81%|████████  | 290/358 [00:29<00:06,  9.82it/s] 81%|████████▏ | 291/358 [00:29<00:06,  9.81it/s] 82%|████████▏ | 293/358 [00:29<00:06,  9.81it/s] 82%|████████▏ | 295/358 [00:30<00:06,  9.89it/s] 83%|████████▎ | 296/358 [00:30<00:06,  9.83it/s] 83%|████████▎ | 297/358 [00:30<00:06,  9.72it/s] 84%|████████▎ | 299/358 [00:30<00:05,  9.88it/s] 84%|████████▍ | 301/358 [00:30<00:05,  9.92it/s] 84%|████████▍ | 302/358 [00:30<00:05,  9.85it/s] 85%|████████▍ | 303/358 [00:30<00:05,  9.86it/s] 85%|████████▌ | 305/358 [00:31<00:05,  9.89it/s] 85%|████████▌ | 306/358 [00:31<00:05,  9.81it/s] 86%|████████▌ | 308/358 [00:31<00:05,  9.91it/s] 86%|████████▋ | 309/358 [00:31<00:04,  9.81it/s] 87%|████████▋ | 310/358 [00:31<00:04,  9.75it/s] 87%|████████▋ | 311/358 [00:31<00:04,  9.67it/s] 87%|████████▋ | 312/358 [00:31<00:04,  9.69it/s] 87%|████████▋ | 313/358 [00:31<00:04,  9.70it/s] 88%|████████▊ | 315/358 [00:32<00:04,  9.97it/s] 88%|████████▊ | 316/358 [00:32<00:04,  9.91it/s] 89%|████████▊ | 317/358 [00:32<00:04,  9.83it/s] 89%|████████▉ | 318/358 [00:32<00:04,  9.78it/s] 89%|████████▉ | 319/358 [00:32<00:04,  9.74it/s] 89%|████████▉ | 320/358 [00:32<00:03,  9.80it/s] 90%|████████▉ | 321/358 [00:32<00:03,  9.72it/s] 90%|████████▉ | 322/358 [00:32<00:03,  9.69it/s] 90%|█████████ | 323/358 [00:32<00:03,  9.64it/s] 91%|█████████ | 324/358 [00:33<00:03,  9.61it/s] 91%|█████████ | 325/358 [00:33<00:03,  9.59it/s] 91%|█████████▏| 327/358 [00:33<00:03,  9.95it/s] 92%|█████████▏| 329/358 [00:33<00:02, 10.05it/s] 92%|█████████▏| 330/358 [00:33<00:02,  9.94it/s] 93%|█████████▎| 332/358 [00:33<00:02, 10.04it/s] 93%|█████████▎| 334/358 [00:34<00:02,  9.94it/s] 94%|█████████▎| 335/358 [00:34<00:02,  9.82it/s] 94%|█████████▍| 337/358 [00:34<00:02,  9.90it/s] 95%|█████████▍| 339/358 [00:34<00:01, 10.10it/s] 95%|█████████▌| 341/358 [00:34<00:01, 10.04it/s] 96%|█████████▌| 342/358 [00:34<00:01,  9.96it/s] 96%|█████████▌| 343/358 [00:34<00:01,  9.86it/s] 96%|█████████▌| 344/358 [00:35<00:01,  9.79it/s] 96%|█████████▋| 345/358 [00:35<00:01,  9.82it/s] 97%|█████████▋| 346/358 [00:35<00:01,  9.86it/s] 97%|█████████▋| 348/358 [00:35<00:01,  9.97it/s] 97%|█████████▋| 349/358 [00:35<00:00,  9.88it/s] 98%|█████████▊| 350/358 [00:35<00:00,  9.80it/s] 98%|█████████▊| 351/358 [00:35<00:00,  9.74it/s] 99%|█████████▊| 353/358 [00:36<00:00,  9.92it/s] 99%|█████████▉| 354/358 [00:36<00:00,  9.90it/s] 99%|█████████▉| 355/358 [00:36<00:00,  9.80it/s]100%|█████████▉| 357/358 [00:36<00:00,  9.86it/s]100%|██████████| 358/358 [00:36<00:00,  9.81it/s]
[32m2025-02-05 05:37:40.681[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    gen_loss  grad clip ratio  grad norm   ppl
       2.194                1      3.005 8.968[0m
[32m2025-02-05 05:37:40.681[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m169[0m - [1m[Valid][0m
  0%|          | 0/10256 [00:00<?, ?it/s]100%|██████████| 10256/10256 [00:00<00:00, 926566.62it/s]
[32m2025-02-05 05:37:40.692[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:27,  1.43it/s]  5%|▌         | 2/40 [00:01<00:26,  1.44it/s]  8%|▊         | 3/40 [00:02<00:25,  1.45it/s] 10%|█         | 4/40 [00:02<00:24,  1.45it/s] 12%|█▎        | 5/40 [00:03<00:24,  1.45it/s] 15%|█▌        | 6/40 [00:04<00:23,  1.44it/s] 18%|█▊        | 7/40 [00:04<00:22,  1.44it/s] 20%|██        | 8/40 [00:05<00:22,  1.45it/s] 22%|██▎       | 9/40 [00:06<00:21,  1.45it/s] 25%|██▌       | 10/40 [00:06<00:20,  1.45it/s] 28%|██▊       | 11/40 [00:07<00:19,  1.45it/s] 30%|███       | 12/40 [00:08<00:19,  1.46it/s] 32%|███▎      | 13/40 [00:08<00:18,  1.46it/s] 35%|███▌      | 14/40 [00:09<00:17,  1.45it/s] 38%|███▊      | 15/40 [00:10<00:17,  1.45it/s] 40%|████      | 16/40 [00:11<00:16,  1.45it/s] 42%|████▎     | 17/40 [00:11<00:15,  1.45it/s] 45%|████▌     | 18/40 [00:12<00:15,  1.45it/s] 48%|████▊     | 19/40 [00:13<00:14,  1.45it/s] 50%|█████     | 20/40 [00:13<00:13,  1.45it/s] 52%|█████▎    | 21/40 [00:14<00:13,  1.45it/s] 55%|█████▌    | 22/40 [00:15<00:12,  1.46it/s] 57%|█████▊    | 23/40 [00:15<00:11,  1.46it/s] 60%|██████    | 24/40 [00:16<00:11,  1.45it/s] 62%|██████▎   | 25/40 [00:17<00:10,  1.45it/s] 65%|██████▌   | 26/40 [00:17<00:09,  1.46it/s] 68%|██████▊   | 27/40 [00:18<00:08,  1.45it/s] 70%|███████   | 28/40 [00:19<00:08,  1.45it/s] 72%|███████▎  | 29/40 [00:19<00:07,  1.45it/s] 75%|███████▌  | 30/40 [00:20<00:06,  1.46it/s] 78%|███████▊  | 31/40 [00:21<00:06,  1.46it/s] 80%|████████  | 32/40 [00:22<00:05,  1.46it/s] 82%|████████▎ | 33/40 [00:22<00:04,  1.45it/s] 85%|████████▌ | 34/40 [00:23<00:04,  1.45it/s] 88%|████████▊ | 35/40 [00:24<00:03,  1.46it/s] 90%|█████████ | 36/40 [00:24<00:02,  1.45it/s] 92%|█████████▎| 37/40 [00:25<00:02,  1.45it/s] 95%|█████████▌| 38/40 [00:26<00:01,  1.45it/s] 98%|█████████▊| 39/40 [00:26<00:00,  1.45it/s]100%|██████████| 40/40 [00:27<00:00,  1.60it/s]100%|██████████| 40/40 [00:27<00:00,  1.46it/s]
[32m2025-02-05 05:38:08.047[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    average  bleu@1  bleu@2  bleu@3  bleu@4  dist@1  dist@2  dist@3  dist@4  extreme  \
      .7663   .2928   .1065  .05102  .02852  .04469   .3091   .6128   .7947    .5785   
      f1  gen_loss  greedy  intra_dist@1  intra_dist@2  intra_dist@3  intra_dist@4  \
   .3479     4.569   .6603         .8792         .9734         .9557         .9139   
    ppl  rouge1  rouge2  rougeL  
   96.4   .3838  .09097   .3701[0m
[32m2025-02-05 05:38:08.053[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m163[0m - [1m[Conversation epoch 28][0m
[32m2025-02-05 05:38:08.053[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m164[0m - [1m[Train][0m
  0%|          | 0/92414 [00:00<?, ?it/s]100%|██████████| 92414/92414 [00:00<00:00, 1112288.18it/s]
[32m2025-02-05 05:38:08.137[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/358 [00:00<?, ?it/s]  0%|          | 1/358 [00:00<00:36,  9.76it/s]  1%|          | 3/358 [00:00<00:35,  9.92it/s]  1%|          | 4/358 [00:00<00:35,  9.91it/s]  2%|▏         | 6/358 [00:00<00:35,  9.87it/s]  2%|▏         | 7/358 [00:00<00:35,  9.80it/s]  2%|▏         | 8/358 [00:00<00:35,  9.85it/s]  3%|▎         | 9/358 [00:00<00:35,  9.75it/s]  3%|▎         | 10/358 [00:01<00:35,  9.74it/s]  3%|▎         | 11/358 [00:01<00:35,  9.69it/s]  4%|▎         | 13/358 [00:01<00:34,  9.91it/s]  4%|▍         | 14/358 [00:01<00:34,  9.83it/s]  4%|▍         | 15/358 [00:01<00:35,  9.75it/s]  4%|▍         | 16/358 [00:01<00:35,  9.69it/s]  5%|▍         | 17/358 [00:01<00:35,  9.71it/s]  5%|▌         | 18/358 [00:01<00:34,  9.78it/s]  5%|▌         | 19/358 [00:01<00:34,  9.72it/s]  6%|▌         | 20/358 [00:02<00:34,  9.66it/s]  6%|▌         | 21/358 [00:02<00:35,  9.60it/s]  6%|▌         | 22/358 [00:02<00:34,  9.66it/s]  7%|▋         | 24/358 [00:02<00:34,  9.76it/s]  7%|▋         | 25/358 [00:02<00:34,  9.71it/s]  7%|▋         | 26/358 [00:02<00:34,  9.66it/s]  8%|▊         | 27/358 [00:02<00:34,  9.71it/s]  8%|▊         | 28/358 [00:02<00:34,  9.67it/s]  8%|▊         | 29/358 [00:02<00:34,  9.63it/s]  9%|▊         | 31/358 [00:03<00:33,  9.74it/s]  9%|▉         | 32/358 [00:03<00:33,  9.73it/s]  9%|▉         | 34/358 [00:03<00:32,  9.83it/s] 10%|█         | 36/358 [00:03<00:32,  9.83it/s] 10%|█         | 37/358 [00:03<00:32,  9.81it/s] 11%|█         | 38/358 [00:03<00:32,  9.77it/s] 11%|█         | 40/358 [00:04<00:32,  9.93it/s] 11%|█▏        | 41/358 [00:04<00:32,  9.84it/s] 12%|█▏        | 43/358 [00:04<00:31,  9.87it/s] 13%|█▎        | 45/358 [00:04<00:31,  9.96it/s] 13%|█▎        | 47/358 [00:04<00:31,  9.94it/s] 13%|█▎        | 48/358 [00:04<00:31,  9.92it/s] 14%|█▍        | 50/358 [00:05<00:31,  9.90it/s] 14%|█▍        | 51/358 [00:05<00:31,  9.83it/s] 15%|█▍        | 52/358 [00:05<00:31,  9.74it/s] 15%|█▍        | 53/358 [00:05<00:31,  9.69it/s] 15%|█▌        | 54/358 [00:05<00:31,  9.73it/s] 15%|█▌        | 55/358 [00:05<00:31,  9.68it/s] 16%|█▌        | 56/358 [00:05<00:31,  9.72it/s] 16%|█▌        | 57/358 [00:05<00:31,  9.68it/s] 16%|█▌        | 58/358 [00:05<00:31,  9.65it/s] 16%|█▋        | 59/358 [00:06<00:31,  9.62it/s] 17%|█▋        | 61/358 [00:06<00:30,  9.71it/s] 17%|█▋        | 62/358 [00:06<00:30,  9.63it/s] 18%|█▊        | 63/358 [00:06<00:30,  9.70it/s] 18%|█▊        | 64/358 [00:06<00:30,  9.65it/s] 18%|█▊        | 66/358 [00:06<00:30,  9.72it/s] 19%|█▊        | 67/358 [00:06<00:29,  9.70it/s] 19%|█▉        | 69/358 [00:07<00:29,  9.77it/s] 20%|█▉        | 70/358 [00:07<00:29,  9.72it/s] 20%|█▉        | 71/358 [00:07<00:29,  9.76it/s] 20%|██        | 72/358 [00:07<00:29,  9.71it/s] 20%|██        | 73/358 [00:07<00:29,  9.67it/s] 21%|██        | 74/358 [00:07<00:29,  9.64it/s] 21%|██        | 75/358 [00:07<00:29,  9.61it/s] 21%|██        | 76/358 [00:07<00:29,  9.71it/s] 22%|██▏       | 77/358 [00:07<00:29,  9.68it/s] 22%|██▏       | 79/358 [00:08<00:28,  9.69it/s] 23%|██▎       | 81/358 [00:08<00:28,  9.75it/s] 23%|██▎       | 83/358 [00:08<00:28,  9.77it/s] 23%|██▎       | 84/358 [00:08<00:28,  9.72it/s] 24%|██▎       | 85/358 [00:08<00:28,  9.67it/s] 24%|██▍       | 86/358 [00:08<00:28,  9.66it/s] 24%|██▍       | 87/358 [00:08<00:28,  9.64it/s] 25%|██▍       | 88/358 [00:09<00:27,  9.66it/s] 25%|██▌       | 90/358 [00:09<00:27,  9.90it/s] 26%|██▌       | 92/358 [00:09<00:26,  9.99it/s] 26%|██▌       | 93/358 [00:09<00:26,  9.96it/s] 26%|██▋       | 94/358 [00:09<00:26,  9.87it/s] 27%|██▋       | 96/358 [00:09<00:25, 10.15it/s] 27%|██▋       | 98/358 [00:10<00:25, 10.04it/s] 28%|██▊       | 99/358 [00:10<00:26,  9.95it/s] 28%|██▊       | 101/358 [00:10<00:25,  9.92it/s] 29%|██▉       | 103/358 [00:10<00:25,  9.90it/s] 29%|██▉       | 104/358 [00:10<00:25,  9.86it/s] 29%|██▉       | 105/358 [00:10<00:25,  9.78it/s] 30%|██▉       | 106/358 [00:10<00:25,  9.76it/s] 30%|███       | 108/358 [00:11<00:25,  9.79it/s] 30%|███       | 109/358 [00:11<00:25,  9.70it/s] 31%|███       | 110/358 [00:11<00:25,  9.68it/s] 31%|███       | 111/358 [00:11<00:25,  9.63it/s] 32%|███▏      | 113/358 [00:11<00:24,  9.90it/s] 32%|███▏      | 114/358 [00:11<00:24,  9.85it/s] 32%|███▏      | 115/358 [00:11<00:24,  9.74it/s] 32%|███▏      | 116/358 [00:11<00:25,  9.66it/s] 33%|███▎      | 117/358 [00:11<00:25,  9.63it/s] 33%|███▎      | 119/358 [00:12<00:24,  9.76it/s] 34%|███▍      | 121/358 [00:12<00:23,  9.96it/s] 34%|███▍      | 123/358 [00:12<00:23, 10.06it/s] 35%|███▍      | 125/358 [00:12<00:23, 10.03it/s] 35%|███▌      | 126/358 [00:12<00:23, 10.00it/s] 35%|███▌      | 127/358 [00:12<00:23,  9.95it/s] 36%|███▌      | 128/358 [00:13<00:23,  9.90it/s] 36%|███▋      | 130/358 [00:13<00:22,  9.97it/s] 37%|███▋      | 131/358 [00:13<00:22,  9.87it/s] 37%|███▋      | 132/358 [00:13<00:22,  9.89it/s] 37%|███▋      | 134/358 [00:13<00:22,  9.92it/s] 38%|███▊      | 135/358 [00:13<00:22,  9.85it/s] 38%|███▊      | 137/358 [00:13<00:22,  9.94it/s] 39%|███▊      | 138/358 [00:14<00:22,  9.92it/s] 39%|███▉      | 139/358 [00:14<00:22,  9.84it/s] 39%|███▉      | 141/358 [00:14<00:21,  9.96it/s] 40%|███▉      | 142/358 [00:14<00:21,  9.88it/s] 40%|███▉      | 143/358 [00:14<00:21,  9.85it/s] 40%|████      | 144/358 [00:14<00:21,  9.76it/s] 41%|████      | 145/358 [00:14<00:21,  9.79it/s] 41%|████      | 146/358 [00:14<00:21,  9.72it/s] 41%|████      | 147/358 [00:15<00:21,  9.67it/s] 41%|████▏     | 148/358 [00:15<00:21,  9.69it/s] 42%|████▏     | 149/358 [00:15<00:21,  9.68it/s] 42%|████▏     | 150/358 [00:15<00:21,  9.63it/s] 42%|████▏     | 151/358 [00:15<00:22,  9.37it/s] 42%|████▏     | 152/358 [00:15<00:21,  9.42it/s] 43%|████▎     | 153/358 [00:15<00:21,  9.44it/s] 43%|████▎     | 154/358 [00:15<00:21,  9.53it/s] 43%|████▎     | 155/358 [00:15<00:21,  9.54it/s] 44%|████▎     | 156/358 [00:15<00:20,  9.66it/s] 44%|████▍     | 157/358 [00:16<00:20,  9.61it/s] 44%|████▍     | 158/358 [00:16<00:20,  9.69it/s] 44%|████▍     | 159/358 [00:16<00:20,  9.68it/s] 45%|████▍     | 160/358 [00:16<00:20,  9.69it/s] 45%|████▌     | 162/358 [00:16<00:19,  9.99it/s] 46%|████▌     | 164/358 [00:16<00:19,  9.99it/s] 46%|████▌     | 165/358 [00:16<00:19,  9.95it/s] 47%|████▋     | 167/358 [00:17<00:19,  9.89it/s] 47%|████▋     | 169/358 [00:17<00:19,  9.91it/s] 48%|████▊     | 171/358 [00:17<00:18,  9.90it/s] 48%|████▊     | 172/358 [00:17<00:18,  9.85it/s] 48%|████▊     | 173/358 [00:17<00:18,  9.79it/s] 49%|████▉     | 175/358 [00:17<00:18,  9.81it/s] 49%|████▉     | 176/358 [00:17<00:18,  9.83it/s] 49%|████▉     | 177/358 [00:18<00:18,  9.82it/s] 50%|█████     | 179/358 [00:18<00:18,  9.84it/s] 50%|█████     | 180/358 [00:18<00:18,  9.77it/s] 51%|█████     | 182/358 [00:18<00:17,  9.92it/s] 51%|█████     | 183/358 [00:18<00:17,  9.87it/s] 51%|█████▏    | 184/358 [00:18<00:17,  9.76it/s] 52%|█████▏    | 185/358 [00:18<00:17,  9.71it/s] 52%|█████▏    | 187/358 [00:19<00:17,  9.93it/s] 53%|█████▎    | 188/358 [00:19<00:17,  9.87it/s] 53%|█████▎    | 189/358 [00:19<00:17,  9.82it/s] 53%|█████▎    | 190/358 [00:19<00:17,  9.86it/s] 53%|█████▎    | 191/358 [00:19<00:17,  9.69it/s] 54%|█████▎    | 192/358 [00:19<00:17,  9.65it/s] 54%|█████▍    | 193/358 [00:19<00:17,  9.65it/s] 54%|█████▍    | 194/358 [00:19<00:17,  9.62it/s] 54%|█████▍    | 195/358 [00:19<00:16,  9.70it/s] 55%|█████▌    | 197/358 [00:20<00:16,  9.90it/s] 55%|█████▌    | 198/358 [00:20<00:16,  9.82it/s] 56%|█████▌    | 199/358 [00:20<00:16,  9.85it/s] 56%|█████▌    | 200/358 [00:20<00:16,  9.78it/s] 56%|█████▌    | 201/358 [00:20<00:16,  9.74it/s] 57%|█████▋    | 203/358 [00:20<00:15,  9.84it/s] 57%|█████▋    | 204/358 [00:20<00:15,  9.73it/s] 57%|█████▋    | 205/358 [00:20<00:15,  9.69it/s] 58%|█████▊    | 207/358 [00:21<00:15,  9.86it/s] 58%|█████▊    | 208/358 [00:21<00:15,  9.79it/s] 59%|█████▊    | 210/358 [00:21<00:15,  9.80it/s] 59%|█████▉    | 212/358 [00:21<00:14,  9.80it/s] 60%|█████▉    | 214/358 [00:21<00:14,  9.87it/s] 60%|██████    | 215/358 [00:21<00:14,  9.81it/s] 60%|██████    | 216/358 [00:22<00:14,  9.75it/s] 61%|██████    | 217/358 [00:22<00:14,  9.78it/s] 61%|██████    | 218/358 [00:22<00:14,  9.75it/s] 61%|██████    | 219/358 [00:22<00:14,  9.75it/s] 62%|██████▏   | 221/358 [00:22<00:13,  9.88it/s] 62%|██████▏   | 222/358 [00:22<00:13,  9.78it/s] 62%|██████▏   | 223/358 [00:22<00:13,  9.73it/s] 63%|██████▎   | 224/358 [00:22<00:13,  9.67it/s] 63%|██████▎   | 225/358 [00:22<00:13,  9.75it/s] 63%|██████▎   | 226/358 [00:23<00:13,  9.70it/s] 64%|██████▎   | 228/358 [00:23<00:13,  9.74it/s] 64%|██████▍   | 229/358 [00:23<00:13,  9.71it/s] 64%|██████▍   | 230/358 [00:23<00:13,  9.66it/s] 65%|██████▍   | 232/358 [00:23<00:12,  9.72it/s] 65%|██████▌   | 234/358 [00:23<00:12, 10.01it/s] 66%|██████▌   | 236/358 [00:24<00:12,  9.97it/s] 66%|██████▋   | 238/358 [00:24<00:11, 10.02it/s] 67%|██████▋   | 240/358 [00:24<00:11,  9.98it/s] 68%|██████▊   | 242/358 [00:24<00:11,  9.96it/s] 68%|██████▊   | 243/358 [00:24<00:11,  9.90it/s] 68%|██████▊   | 244/358 [00:24<00:11,  9.83it/s] 69%|██████▊   | 246/358 [00:25<00:11,  9.85it/s] 69%|██████▉   | 247/358 [00:25<00:11,  9.78it/s] 69%|██████▉   | 248/358 [00:25<00:11,  9.73it/s] 70%|██████▉   | 250/358 [00:25<00:10,  9.83it/s] 70%|███████   | 251/358 [00:25<00:10,  9.77it/s] 70%|███████   | 252/358 [00:25<00:10,  9.70it/s] 71%|███████   | 253/358 [00:25<00:10,  9.66it/s] 71%|███████   | 254/358 [00:25<00:10,  9.64it/s] 72%|███████▏  | 256/358 [00:26<00:10,  9.81it/s] 72%|███████▏  | 257/358 [00:26<00:10,  9.82it/s] 72%|███████▏  | 258/358 [00:26<00:10,  9.69it/s] 72%|███████▏  | 259/358 [00:26<00:10,  9.66it/s] 73%|███████▎  | 260/358 [00:26<00:10,  9.69it/s] 73%|███████▎  | 262/358 [00:26<00:09,  9.88it/s] 74%|███████▎  | 264/358 [00:26<00:09,  9.89it/s] 74%|███████▍  | 266/358 [00:27<00:09,  9.89it/s] 75%|███████▍  | 267/358 [00:27<00:09,  9.83it/s] 75%|███████▌  | 269/358 [00:27<00:09,  9.88it/s] 75%|███████▌  | 270/358 [00:27<00:08,  9.81it/s] 76%|███████▌  | 271/358 [00:27<00:08,  9.74it/s] 76%|███████▌  | 272/358 [00:27<00:08,  9.71it/s] 76%|███████▋  | 273/358 [00:27<00:08,  9.62it/s] 77%|███████▋  | 274/358 [00:27<00:08,  9.62it/s] 77%|███████▋  | 275/358 [00:28<00:08,  9.66it/s] 77%|███████▋  | 276/358 [00:28<00:08,  9.67it/s] 77%|███████▋  | 277/358 [00:28<00:08,  9.63it/s] 78%|███████▊  | 278/358 [00:28<00:08,  9.61it/s] 78%|███████▊  | 280/358 [00:28<00:07,  9.80it/s] 78%|███████▊  | 281/358 [00:28<00:07,  9.81it/s] 79%|███████▉  | 282/358 [00:28<00:07,  9.75it/s] 79%|███████▉  | 283/358 [00:28<00:07,  9.69it/s] 79%|███████▉  | 284/358 [00:29<00:07,  9.65it/s] 80%|███████▉  | 285/358 [00:29<00:07,  9.72it/s] 80%|███████▉  | 286/358 [00:29<00:07,  9.68it/s] 80%|████████  | 287/358 [00:29<00:07,  9.65it/s] 80%|████████  | 288/358 [00:29<00:07,  9.61it/s] 81%|████████  | 289/358 [00:29<00:07,  9.72it/s] 81%|████████▏ | 291/358 [00:29<00:06,  9.83it/s] 82%|████████▏ | 293/358 [00:29<00:06,  9.83it/s] 82%|████████▏ | 295/358 [00:30<00:06,  9.90it/s] 83%|████████▎ | 296/358 [00:30<00:06,  9.84it/s] 83%|████████▎ | 297/358 [00:30<00:06,  9.73it/s] 84%|████████▎ | 299/358 [00:30<00:05,  9.89it/s] 84%|████████▍ | 301/358 [00:30<00:05,  9.92it/s] 84%|████████▍ | 302/358 [00:30<00:05,  9.85it/s] 85%|████████▍ | 303/358 [00:30<00:05,  9.86it/s] 85%|████████▌ | 305/358 [00:31<00:05,  9.89it/s] 85%|████████▌ | 306/358 [00:31<00:05,  9.81it/s] 86%|████████▌ | 308/358 [00:31<00:05,  9.91it/s] 86%|████████▋ | 309/358 [00:31<00:04,  9.81it/s] 87%|████████▋ | 310/358 [00:31<00:04,  9.75it/s] 87%|████████▋ | 311/358 [00:31<00:04,  9.68it/s] 87%|████████▋ | 312/358 [00:31<00:04,  9.69it/s] 87%|████████▋ | 313/358 [00:31<00:04,  9.71it/s] 88%|████████▊ | 315/358 [00:32<00:04,  9.97it/s] 88%|████████▊ | 316/358 [00:32<00:04,  9.92it/s] 89%|████████▊ | 317/358 [00:32<00:04,  9.84it/s] 89%|████████▉ | 318/358 [00:32<00:04,  9.79it/s] 89%|████████▉ | 319/358 [00:32<00:04,  9.74it/s] 89%|████████▉ | 320/358 [00:32<00:03,  9.80it/s] 90%|████████▉ | 321/358 [00:32<00:03,  9.72it/s] 90%|████████▉ | 322/358 [00:32<00:03,  9.69it/s] 90%|█████████ | 323/358 [00:32<00:03,  9.64it/s] 91%|█████████ | 324/358 [00:33<00:03,  9.61it/s] 91%|█████████ | 325/358 [00:33<00:03,  9.59it/s] 91%|█████████▏| 327/358 [00:33<00:03,  9.95it/s] 92%|█████████▏| 329/358 [00:33<00:02, 10.05it/s] 92%|█████████▏| 330/358 [00:33<00:02,  9.94it/s] 93%|█████████▎| 332/358 [00:33<00:02, 10.04it/s] 93%|█████████▎| 334/358 [00:34<00:02,  9.94it/s] 94%|█████████▎| 335/358 [00:34<00:02,  9.82it/s] 94%|█████████▍| 337/358 [00:34<00:02,  9.90it/s] 95%|█████████▍| 339/358 [00:34<00:01, 10.10it/s] 95%|█████████▌| 341/358 [00:34<00:01, 10.04it/s] 96%|█████████▌| 342/358 [00:34<00:01,  9.96it/s] 96%|█████████▌| 343/358 [00:34<00:01,  9.85it/s] 96%|█████████▌| 344/358 [00:35<00:01,  9.79it/s] 96%|█████████▋| 345/358 [00:35<00:01,  9.82it/s] 97%|█████████▋| 346/358 [00:35<00:01,  9.86it/s] 97%|█████████▋| 348/358 [00:35<00:01,  9.96it/s] 97%|█████████▋| 349/358 [00:35<00:00,  9.87it/s] 98%|█████████▊| 350/358 [00:35<00:00,  9.79it/s] 98%|█████████▊| 351/358 [00:35<00:00,  9.74it/s] 99%|█████████▊| 353/358 [00:36<00:00,  9.91it/s] 99%|█████████▉| 354/358 [00:36<00:00,  9.89it/s] 99%|█████████▉| 355/358 [00:36<00:00,  9.80it/s]100%|█████████▉| 357/358 [00:36<00:00,  9.86it/s]100%|██████████| 358/358 [00:36<00:00,  9.81it/s]
[32m2025-02-05 05:38:44.639[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    gen_loss  grad clip ratio  grad norm   ppl
       2.179                1      2.978 8.841[0m
[32m2025-02-05 05:38:44.639[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m169[0m - [1m[Valid][0m
  0%|          | 0/10256 [00:00<?, ?it/s]100%|██████████| 10256/10256 [00:00<00:00, 938534.32it/s]
[32m2025-02-05 05:38:44.651[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:27,  1.43it/s]  5%|▌         | 2/40 [00:01<00:26,  1.45it/s]  8%|▊         | 3/40 [00:02<00:25,  1.46it/s] 10%|█         | 4/40 [00:02<00:24,  1.46it/s] 12%|█▎        | 5/40 [00:03<00:24,  1.45it/s] 15%|█▌        | 6/40 [00:04<00:23,  1.45it/s] 18%|█▊        | 7/40 [00:04<00:22,  1.45it/s] 20%|██        | 8/40 [00:05<00:21,  1.46it/s] 22%|██▎       | 9/40 [00:06<00:21,  1.46it/s] 25%|██▌       | 10/40 [00:06<00:20,  1.46it/s] 28%|██▊       | 11/40 [00:07<00:19,  1.46it/s] 30%|███       | 12/40 [00:08<00:19,  1.46it/s] 32%|███▎      | 13/40 [00:08<00:18,  1.46it/s] 35%|███▌      | 14/40 [00:09<00:17,  1.45it/s] 38%|███▊      | 15/40 [00:10<00:17,  1.45it/s] 40%|████      | 16/40 [00:11<00:16,  1.45it/s] 42%|████▎     | 17/40 [00:11<00:15,  1.46it/s] 45%|████▌     | 18/40 [00:12<00:15,  1.46it/s] 48%|████▊     | 19/40 [00:13<00:14,  1.45it/s] 50%|█████     | 20/40 [00:13<00:13,  1.46it/s] 52%|█████▎    | 21/40 [00:14<00:13,  1.46it/s] 55%|█████▌    | 22/40 [00:15<00:12,  1.45it/s] 57%|█████▊    | 23/40 [00:15<00:11,  1.45it/s] 60%|██████    | 24/40 [00:16<00:11,  1.44it/s] 62%|██████▎   | 25/40 [00:17<00:10,  1.45it/s] 65%|██████▌   | 26/40 [00:17<00:09,  1.46it/s] 68%|██████▊   | 27/40 [00:18<00:08,  1.46it/s] 70%|███████   | 28/40 [00:19<00:08,  1.46it/s] 72%|███████▎  | 29/40 [00:19<00:07,  1.46it/s] 75%|███████▌  | 30/40 [00:20<00:06,  1.46it/s] 78%|███████▊  | 31/40 [00:21<00:06,  1.46it/s] 80%|████████  | 32/40 [00:21<00:05,  1.46it/s] 82%|████████▎ | 33/40 [00:22<00:04,  1.46it/s] 85%|████████▌ | 34/40 [00:23<00:04,  1.46it/s] 88%|████████▊ | 35/40 [00:24<00:03,  1.46it/s] 90%|█████████ | 36/40 [00:24<00:02,  1.45it/s] 92%|█████████▎| 37/40 [00:25<00:02,  1.46it/s] 95%|█████████▌| 38/40 [00:26<00:01,  1.45it/s] 98%|█████████▊| 39/40 [00:26<00:00,  1.45it/s]100%|██████████| 40/40 [00:27<00:00,  1.60it/s]100%|██████████| 40/40 [00:27<00:00,  1.47it/s]
[32m2025-02-05 05:39:11.942[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    average  bleu@1  bleu@2  bleu@3  bleu@4  dist@1  dist@2  dist@3  dist@4  extreme  \
      .7710   .2959   .1087  .04716  .02438  .04524   .3067   .5977   .7682    .5858   
      f1  gen_loss  greedy  intra_dist@1  intra_dist@2  intra_dist@3  intra_dist@4  \
   .3492     4.622   .6625         .8780         .9673         .9538         .9193   
     ppl  rouge1  rouge2  rougeL  
   101.7   .3821  .09112   .3698[0m
[32m2025-02-05 05:39:11.948[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m163[0m - [1m[Conversation epoch 29][0m
[32m2025-02-05 05:39:11.948[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m164[0m - [1m[Train][0m
  0%|          | 0/92414 [00:00<?, ?it/s]100%|██████████| 92414/92414 [00:00<00:00, 1131976.16it/s]
[32m2025-02-05 05:39:12.030[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/358 [00:00<?, ?it/s]  0%|          | 1/358 [00:00<00:36,  9.75it/s]  1%|          | 3/358 [00:00<00:35,  9.92it/s]  1%|          | 4/358 [00:00<00:35,  9.90it/s]  2%|▏         | 6/358 [00:00<00:35,  9.86it/s]  2%|▏         | 7/358 [00:00<00:35,  9.80it/s]  2%|▏         | 8/358 [00:00<00:35,  9.84it/s]  3%|▎         | 9/358 [00:00<00:35,  9.75it/s]  3%|▎         | 10/358 [00:01<00:35,  9.74it/s]  3%|▎         | 11/358 [00:01<00:35,  9.69it/s]  4%|▎         | 13/358 [00:01<00:34,  9.91it/s]  4%|▍         | 14/358 [00:01<00:34,  9.83it/s]  4%|▍         | 15/358 [00:01<00:35,  9.75it/s]  4%|▍         | 16/358 [00:01<00:35,  9.69it/s]  5%|▍         | 17/358 [00:01<00:35,  9.71it/s]  5%|▌         | 18/358 [00:01<00:34,  9.79it/s]  5%|▌         | 19/358 [00:01<00:34,  9.71it/s]  6%|▌         | 20/358 [00:02<00:34,  9.66it/s]  6%|▌         | 21/358 [00:02<00:35,  9.59it/s]  6%|▌         | 22/358 [00:02<00:34,  9.66it/s]  7%|▋         | 24/358 [00:02<00:34,  9.76it/s]  7%|▋         | 25/358 [00:02<00:34,  9.71it/s]  7%|▋         | 26/358 [00:02<00:34,  9.65it/s]  8%|▊         | 27/358 [00:02<00:34,  9.71it/s]  8%|▊         | 28/358 [00:02<00:34,  9.67it/s]  8%|▊         | 29/358 [00:02<00:34,  9.64it/s]  9%|▊         | 31/358 [00:03<00:33,  9.74it/s]  9%|▉         | 32/358 [00:03<00:33,  9.74it/s]  9%|▉         | 34/358 [00:03<00:32,  9.83it/s] 10%|█         | 36/358 [00:03<00:32,  9.83it/s] 10%|█         | 37/358 [00:03<00:32,  9.81it/s] 11%|█         | 38/358 [00:03<00:32,  9.77it/s] 11%|█         | 40/358 [00:04<00:32,  9.93it/s] 11%|█▏        | 41/358 [00:04<00:32,  9.84it/s] 12%|█▏        | 43/358 [00:04<00:31,  9.87it/s] 13%|█▎        | 45/358 [00:04<00:31,  9.95it/s] 13%|█▎        | 46/358 [00:04<00:31,  9.96it/s] 13%|█▎        | 47/358 [00:04<00:31,  9.91it/s] 13%|█▎        | 48/358 [00:04<00:31,  9.90it/s] 14%|█▍        | 50/358 [00:05<00:31,  9.87it/s] 14%|█▍        | 51/358 [00:05<00:31,  9.80it/s] 15%|█▍        | 52/358 [00:05<00:31,  9.71it/s] 15%|█▍        | 53/358 [00:05<00:31,  9.66it/s] 15%|█▌        | 54/358 [00:05<00:31,  9.71it/s] 15%|█▌        | 55/358 [00:05<00:31,  9.66it/s] 16%|█▌        | 56/358 [00:05<00:31,  9.70it/s] 16%|█▌        | 57/358 [00:05<00:31,  9.66it/s] 16%|█▌        | 58/358 [00:05<00:31,  9.64it/s] 16%|█▋        | 59/358 [00:06<00:31,  9.62it/s] 17%|█▋        | 61/358 [00:06<00:30,  9.70it/s] 17%|█▋        | 62/358 [00:06<00:30,  9.62it/s] 18%|█▊        | 63/358 [00:06<00:30,  9.69it/s] 18%|█▊        | 64/358 [00:06<00:30,  9.63it/s] 18%|█▊        | 66/358 [00:06<00:30,  9.70it/s] 19%|█▊        | 67/358 [00:06<00:30,  9.69it/s] 19%|█▉        | 68/358 [00:06<00:29,  9.74it/s] 19%|█▉        | 69/358 [00:07<00:29,  9.68it/s] 20%|█▉        | 70/358 [00:07<00:29,  9.63it/s] 20%|█▉        | 71/358 [00:07<00:29,  9.70it/s] 20%|██        | 72/358 [00:07<00:29,  9.66it/s] 20%|██        | 73/358 [00:07<00:29,  9.63it/s] 21%|██        | 74/358 [00:07<00:29,  9.61it/s] 21%|██        | 75/358 [00:07<00:29,  9.58it/s] 21%|██        | 76/358 [00:07<00:29,  9.69it/s] 22%|██▏       | 77/358 [00:07<00:29,  9.66it/s] 22%|██▏       | 79/358 [00:08<00:28,  9.67it/s] 23%|██▎       | 81/358 [00:08<00:28,  9.73it/s] 23%|██▎       | 83/358 [00:08<00:28,  9.76it/s] 23%|██▎       | 84/358 [00:08<00:28,  9.71it/s] 24%|██▎       | 85/358 [00:08<00:28,  9.67it/s] 24%|██▍       | 86/358 [00:08<00:28,  9.65it/s] 24%|██▍       | 87/358 [00:08<00:28,  9.63it/s] 25%|██▍       | 88/358 [00:09<00:27,  9.65it/s] 25%|██▌       | 90/358 [00:09<00:27,  9.89it/s] 26%|██▌       | 92/358 [00:09<00:26,  9.98it/s] 26%|██▌       | 93/358 [00:09<00:26,  9.95it/s] 26%|██▋       | 94/358 [00:09<00:26,  9.86it/s] 27%|██▋       | 96/358 [00:09<00:25, 10.13it/s] 27%|██▋       | 98/358 [00:10<00:25, 10.01it/s] 28%|██▊       | 99/358 [00:10<00:26,  9.93it/s] 28%|██▊       | 101/358 [00:10<00:25,  9.90it/s] 29%|██▉       | 103/358 [00:10<00:25,  9.89it/s] 29%|██▉       | 104/358 [00:10<00:25,  9.84it/s] 29%|██▉       | 105/358 [00:10<00:25,  9.77it/s] 30%|██▉       | 106/358 [00:10<00:25,  9.75it/s] 30%|███       | 108/358 [00:11<00:25,  9.78it/s] 30%|███       | 109/358 [00:11<00:25,  9.69it/s] 31%|███       | 110/358 [00:11<00:25,  9.68it/s] 31%|███       | 111/358 [00:11<00:25,  9.63it/s] 32%|███▏      | 113/358 [00:11<00:24,  9.89it/s] 32%|███▏      | 114/358 [00:11<00:24,  9.85it/s] 32%|███▏      | 115/358 [00:11<00:24,  9.76it/s] 32%|███▏      | 116/358 [00:11<00:25,  9.68it/s] 33%|███▎      | 117/358 [00:11<00:24,  9.65it/s] 33%|███▎      | 119/358 [00:12<00:24,  9.75it/s] 34%|███▍      | 121/358 [00:12<00:23,  9.95it/s] 34%|███▍      | 123/358 [00:12<00:23, 10.06it/s] 35%|███▍      | 125/358 [00:12<00:23, 10.04it/s] 35%|███▌      | 126/358 [00:12<00:23, 10.00it/s] 35%|███▌      | 127/358 [00:12<00:23,  9.95it/s] 36%|███▌      | 128/358 [00:13<00:23,  9.90it/s] 36%|███▋      | 130/358 [00:13<00:22,  9.97it/s] 37%|███▋      | 131/358 [00:13<00:23,  9.87it/s] 37%|███▋      | 132/358 [00:13<00:22,  9.89it/s] 37%|███▋      | 134/358 [00:13<00:22,  9.91it/s] 38%|███▊      | 135/358 [00:13<00:22,  9.85it/s] 38%|███▊      | 137/358 [00:13<00:22,  9.94it/s] 39%|███▊      | 138/358 [00:14<00:22,  9.92it/s] 39%|███▉      | 139/358 [00:14<00:22,  9.83it/s] 39%|███▉      | 141/358 [00:14<00:21,  9.96it/s] 40%|███▉      | 142/358 [00:14<00:21,  9.88it/s] 40%|███▉      | 143/358 [00:14<00:21,  9.85it/s] 40%|████      | 144/358 [00:14<00:21,  9.76it/s] 41%|████      | 145/358 [00:14<00:21,  9.79it/s] 41%|████      | 146/358 [00:14<00:21,  9.72it/s] 41%|████      | 147/358 [00:15<00:21,  9.66it/s] 41%|████▏     | 148/358 [00:15<00:21,  9.69it/s] 42%|████▏     | 149/358 [00:15<00:21,  9.67it/s] 42%|████▏     | 150/358 [00:15<00:21,  9.63it/s] 42%|████▏     | 151/358 [00:15<00:22,  9.36it/s] 42%|████▏     | 152/358 [00:15<00:21,  9.41it/s] 43%|████▎     | 153/358 [00:15<00:21,  9.43it/s] 43%|████▎     | 154/358 [00:15<00:21,  9.52it/s] 43%|████▎     | 155/358 [00:15<00:21,  9.54it/s] 44%|████▎     | 156/358 [00:15<00:20,  9.66it/s] 44%|████▍     | 157/358 [00:16<00:20,  9.60it/s] 44%|████▍     | 158/358 [00:16<00:20,  9.69it/s] 44%|████▍     | 159/358 [00:16<00:20,  9.68it/s] 45%|████▍     | 160/358 [00:16<00:20,  9.69it/s] 45%|████▌     | 162/358 [00:16<00:19,  9.98it/s] 46%|████▌     | 164/358 [00:16<00:19,  9.98it/s] 46%|████▌     | 165/358 [00:16<00:19,  9.94it/s] 47%|████▋     | 167/358 [00:17<00:19,  9.88it/s] 47%|████▋     | 169/358 [00:17<00:19,  9.92it/s] 48%|████▊     | 171/358 [00:17<00:18,  9.90it/s] 48%|████▊     | 172/358 [00:17<00:18,  9.85it/s] 48%|████▊     | 173/358 [00:17<00:18,  9.79it/s] 49%|████▉     | 175/358 [00:17<00:18,  9.81it/s] 49%|████▉     | 176/358 [00:17<00:18,  9.83it/s] 49%|████▉     | 177/358 [00:18<00:18,  9.82it/s] 50%|█████     | 179/358 [00:18<00:18,  9.84it/s] 50%|█████     | 180/358 [00:18<00:18,  9.77it/s] 51%|█████     | 182/358 [00:18<00:17,  9.92it/s] 51%|█████     | 183/358 [00:18<00:17,  9.87it/s] 51%|█████▏    | 184/358 [00:18<00:17,  9.76it/s] 52%|█████▏    | 185/358 [00:18<00:17,  9.71it/s] 52%|█████▏    | 187/358 [00:19<00:17,  9.92it/s] 53%|█████▎    | 188/358 [00:19<00:17,  9.87it/s] 53%|█████▎    | 189/358 [00:19<00:17,  9.82it/s] 53%|█████▎    | 190/358 [00:19<00:17,  9.86it/s] 53%|█████▎    | 191/358 [00:19<00:17,  9.69it/s] 54%|█████▎    | 192/358 [00:19<00:17,  9.64it/s] 54%|█████▍    | 193/358 [00:19<00:17,  9.64it/s] 54%|█████▍    | 194/358 [00:19<00:17,  9.63it/s] 54%|█████▍    | 195/358 [00:19<00:16,  9.71it/s] 55%|█████▌    | 197/358 [00:20<00:16,  9.90it/s] 55%|█████▌    | 198/358 [00:20<00:16,  9.82it/s] 56%|█████▌    | 199/358 [00:20<00:16,  9.86it/s] 56%|█████▌    | 200/358 [00:20<00:16,  9.78it/s] 56%|█████▌    | 201/358 [00:20<00:16,  9.74it/s] 57%|█████▋    | 203/358 [00:20<00:15,  9.84it/s] 57%|█████▋    | 204/358 [00:20<00:15,  9.73it/s] 57%|█████▋    | 205/358 [00:20<00:15,  9.69it/s] 58%|█████▊    | 207/358 [00:21<00:15,  9.86it/s] 58%|█████▊    | 208/358 [00:21<00:15,  9.78it/s] 59%|█████▊    | 210/358 [00:21<00:15,  9.80it/s] 59%|█████▉    | 212/358 [00:21<00:14,  9.79it/s] 60%|█████▉    | 214/358 [00:21<00:14,  9.87it/s] 60%|██████    | 215/358 [00:21<00:14,  9.81it/s] 60%|██████    | 216/358 [00:22<00:14,  9.74it/s] 61%|██████    | 217/358 [00:22<00:14,  9.78it/s] 61%|██████    | 218/358 [00:22<00:14,  9.75it/s] 61%|██████    | 219/358 [00:22<00:14,  9.76it/s] 62%|██████▏   | 221/358 [00:22<00:13,  9.89it/s] 62%|██████▏   | 222/358 [00:22<00:13,  9.78it/s] 62%|██████▏   | 223/358 [00:22<00:13,  9.73it/s] 63%|██████▎   | 224/358 [00:22<00:13,  9.67it/s] 63%|██████▎   | 225/358 [00:22<00:13,  9.75it/s] 63%|██████▎   | 226/358 [00:23<00:13,  9.70it/s] 64%|██████▎   | 228/358 [00:23<00:13,  9.74it/s] 64%|██████▍   | 229/358 [00:23<00:13,  9.71it/s] 64%|██████▍   | 230/358 [00:23<00:13,  9.66it/s] 65%|██████▍   | 232/358 [00:23<00:12,  9.72it/s] 65%|██████▌   | 234/358 [00:23<00:12, 10.01it/s] 66%|██████▌   | 236/358 [00:24<00:12,  9.97it/s] 66%|██████▋   | 238/358 [00:24<00:11, 10.02it/s] 67%|██████▋   | 240/358 [00:24<00:11,  9.98it/s] 68%|██████▊   | 242/358 [00:24<00:11,  9.96it/s] 68%|██████▊   | 243/358 [00:24<00:11,  9.90it/s] 68%|██████▊   | 244/358 [00:24<00:11,  9.83it/s] 69%|██████▊   | 246/358 [00:25<00:11,  9.85it/s] 69%|██████▉   | 247/358 [00:25<00:11,  9.78it/s] 69%|██████▉   | 248/358 [00:25<00:11,  9.74it/s] 70%|██████▉   | 250/358 [00:25<00:10,  9.83it/s] 70%|███████   | 251/358 [00:25<00:10,  9.77it/s] 70%|███████   | 252/358 [00:25<00:10,  9.71it/s] 71%|███████   | 253/358 [00:25<00:10,  9.67it/s] 71%|███████   | 254/358 [00:25<00:10,  9.64it/s] 72%|███████▏  | 256/358 [00:26<00:10,  9.82it/s] 72%|███████▏  | 257/358 [00:26<00:10,  9.82it/s] 72%|███████▏  | 258/358 [00:26<00:10,  9.69it/s] 72%|███████▏  | 259/358 [00:26<00:10,  9.66it/s] 73%|███████▎  | 260/358 [00:26<00:10,  9.70it/s] 73%|███████▎  | 262/358 [00:26<00:09,  9.87it/s] 74%|███████▎  | 264/358 [00:26<00:09,  9.90it/s] 74%|███████▍  | 266/358 [00:27<00:09,  9.89it/s] 75%|███████▍  | 267/358 [00:27<00:09,  9.83it/s] 75%|███████▌  | 269/358 [00:27<00:09,  9.88it/s] 75%|███████▌  | 270/358 [00:27<00:08,  9.81it/s] 76%|███████▌  | 271/358 [00:27<00:08,  9.74it/s] 76%|███████▌  | 272/358 [00:27<00:08,  9.72it/s] 76%|███████▋  | 273/358 [00:27<00:08,  9.62it/s] 77%|███████▋  | 274/358 [00:27<00:08,  9.62it/s] 77%|███████▋  | 275/358 [00:28<00:08,  9.66it/s] 77%|███████▋  | 276/358 [00:28<00:08,  9.67it/s] 77%|███████▋  | 277/358 [00:28<00:08,  9.64it/s] 78%|███████▊  | 278/358 [00:28<00:08,  9.62it/s] 78%|███████▊  | 280/358 [00:28<00:07,  9.81it/s] 78%|███████▊  | 281/358 [00:28<00:07,  9.82it/s] 79%|███████▉  | 282/358 [00:28<00:07,  9.76it/s] 79%|███████▉  | 283/358 [00:28<00:07,  9.70it/s] 79%|███████▉  | 284/358 [00:29<00:07,  9.66it/s] 80%|███████▉  | 285/358 [00:29<00:07,  9.72it/s] 80%|███████▉  | 286/358 [00:29<00:07,  9.68it/s] 80%|████████  | 287/358 [00:29<00:07,  9.66it/s] 80%|████████  | 288/358 [00:29<00:07,  9.62it/s] 81%|████████  | 290/358 [00:29<00:06,  9.83it/s] 81%|████████▏ | 291/358 [00:29<00:06,  9.81it/s] 82%|████████▏ | 293/358 [00:29<00:06,  9.82it/s] 82%|████████▏ | 295/358 [00:30<00:06,  9.90it/s] 83%|████████▎ | 296/358 [00:30<00:06,  9.83it/s] 83%|████████▎ | 297/358 [00:30<00:06,  9.72it/s] 84%|████████▎ | 299/358 [00:30<00:05,  9.88it/s] 84%|████████▍ | 301/358 [00:30<00:05,  9.92it/s] 84%|████████▍ | 302/358 [00:30<00:05,  9.85it/s] 85%|████████▍ | 303/358 [00:30<00:05,  9.86it/s] 85%|████████▌ | 305/358 [00:31<00:05,  9.89it/s] 85%|████████▌ | 306/358 [00:31<00:05,  9.81it/s] 86%|████████▌ | 308/358 [00:31<00:05,  9.91it/s] 86%|████████▋ | 309/358 [00:31<00:04,  9.81it/s] 87%|████████▋ | 310/358 [00:31<00:04,  9.75it/s] 87%|████████▋ | 311/358 [00:31<00:04,  9.68it/s] 87%|████████▋ | 312/358 [00:31<00:04,  9.69it/s] 87%|████████▋ | 313/358 [00:31<00:04,  9.71it/s] 88%|████████▊ | 315/358 [00:32<00:04,  9.97it/s] 88%|████████▊ | 316/358 [00:32<00:04,  9.92it/s] 89%|████████▊ | 317/358 [00:32<00:04,  9.84it/s] 89%|████████▉ | 318/358 [00:32<00:04,  9.79it/s] 89%|████████▉ | 319/358 [00:32<00:04,  9.74it/s] 89%|████████▉ | 320/358 [00:32<00:03,  9.80it/s] 90%|████████▉ | 321/358 [00:32<00:03,  9.72it/s] 90%|████████▉ | 322/358 [00:32<00:03,  9.69it/s] 90%|█████████ | 323/358 [00:33<00:03,  9.64it/s] 91%|█████████ | 324/358 [00:33<00:03,  9.62it/s] 91%|█████████ | 325/358 [00:33<00:03,  9.59it/s] 91%|█████████▏| 327/358 [00:33<00:03,  9.96it/s] 92%|█████████▏| 329/358 [00:33<00:02, 10.05it/s] 92%|█████████▏| 330/358 [00:33<00:02,  9.94it/s] 93%|█████████▎| 332/358 [00:33<00:02, 10.04it/s] 93%|█████████▎| 334/358 [00:34<00:02,  9.95it/s] 94%|█████████▎| 335/358 [00:34<00:02,  9.82it/s] 94%|█████████▍| 337/358 [00:34<00:02,  9.90it/s] 95%|█████████▍| 339/358 [00:34<00:01, 10.10it/s] 95%|█████████▌| 341/358 [00:34<00:01, 10.04it/s] 96%|█████████▌| 343/358 [00:35<00:01,  9.88it/s] 96%|█████████▌| 344/358 [00:35<00:01,  9.83it/s] 96%|█████████▋| 345/358 [00:35<00:01,  9.85it/s] 97%|█████████▋| 346/358 [00:35<00:01,  9.88it/s] 97%|█████████▋| 348/358 [00:35<00:01,  9.97it/s] 97%|█████████▋| 349/358 [00:35<00:00,  9.88it/s] 98%|█████████▊| 350/358 [00:35<00:00,  9.80it/s] 98%|█████████▊| 351/358 [00:35<00:00,  9.75it/s] 99%|█████████▊| 353/358 [00:36<00:00,  9.92it/s] 99%|█████████▉| 354/358 [00:36<00:00,  9.90it/s] 99%|█████████▉| 355/358 [00:36<00:00,  9.81it/s]100%|█████████▉| 357/358 [00:36<00:00,  9.86it/s]100%|██████████| 358/358 [00:36<00:00,  9.81it/s]
[32m2025-02-05 05:39:48.542[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    gen_loss  grad clip ratio  grad norm   ppl
       2.163                1      3.667 8.702[0m
[32m2025-02-05 05:39:48.542[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m169[0m - [1m[Valid][0m
  0%|          | 0/10256 [00:00<?, ?it/s]100%|██████████| 10256/10256 [00:00<00:00, 1038275.25it/s]
[32m2025-02-05 05:39:48.552[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:27,  1.44it/s]  5%|▌         | 2/40 [00:01<00:26,  1.46it/s]  8%|▊         | 3/40 [00:02<00:25,  1.46it/s] 10%|█         | 4/40 [00:02<00:24,  1.46it/s] 12%|█▎        | 5/40 [00:03<00:23,  1.46it/s] 15%|█▌        | 6/40 [00:04<00:23,  1.45it/s] 18%|█▊        | 7/40 [00:04<00:22,  1.45it/s] 20%|██        | 8/40 [00:05<00:21,  1.46it/s] 22%|██▎       | 9/40 [00:06<00:21,  1.46it/s] 25%|██▌       | 10/40 [00:06<00:20,  1.46it/s] 28%|██▊       | 11/40 [00:07<00:19,  1.46it/s] 30%|███       | 12/40 [00:08<00:19,  1.46it/s] 32%|███▎      | 13/40 [00:08<00:18,  1.46it/s] 35%|███▌      | 14/40 [00:09<00:17,  1.45it/s] 38%|███▊      | 15/40 [00:10<00:17,  1.45it/s] 40%|████      | 16/40 [00:10<00:16,  1.45it/s] 42%|████▎     | 17/40 [00:11<00:15,  1.46it/s] 45%|████▌     | 18/40 [00:12<00:15,  1.46it/s] 48%|████▊     | 19/40 [00:13<00:14,  1.46it/s] 50%|█████     | 20/40 [00:13<00:13,  1.46it/s] 52%|█████▎    | 21/40 [00:14<00:12,  1.46it/s] 55%|█████▌    | 22/40 [00:15<00:12,  1.46it/s] 57%|█████▊    | 23/40 [00:15<00:11,  1.47it/s] 60%|██████    | 24/40 [00:16<00:10,  1.46it/s] 62%|██████▎   | 25/40 [00:17<00:10,  1.46it/s] 65%|██████▌   | 26/40 [00:17<00:09,  1.47it/s] 68%|██████▊   | 27/40 [00:18<00:08,  1.47it/s] 70%|███████   | 28/40 [00:19<00:08,  1.47it/s] 72%|███████▎  | 29/40 [00:19<00:07,  1.47it/s] 75%|███████▌  | 30/40 [00:20<00:06,  1.47it/s] 78%|███████▊  | 31/40 [00:21<00:06,  1.47it/s] 80%|████████  | 32/40 [00:21<00:05,  1.47it/s] 82%|████████▎ | 33/40 [00:22<00:04,  1.46it/s] 85%|████████▌ | 34/40 [00:23<00:04,  1.47it/s] 88%|████████▊ | 35/40 [00:23<00:03,  1.46it/s] 90%|█████████ | 36/40 [00:24<00:02,  1.46it/s] 92%|█████████▎| 37/40 [00:25<00:02,  1.46it/s] 95%|█████████▌| 38/40 [00:26<00:01,  1.45it/s] 98%|█████████▊| 39/40 [00:26<00:00,  1.45it/s]100%|██████████| 40/40 [00:27<00:00,  1.60it/s]100%|██████████| 40/40 [00:27<00:00,  1.47it/s]
[32m2025-02-05 05:40:15.728[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    average  bleu@1  bleu@2  bleu@3  bleu@4  dist@1  dist@2  dist@3  dist@4  extreme  \
      .7735   .2969   .1111  .04915  .02637   .0469   .3163   .6159   .7916    .5867   
      f1  gen_loss  greedy  intra_dist@1  intra_dist@2  intra_dist@3  intra_dist@4  \
   .3526     4.659   .6659         .8894         .9789         .9529         .9090   
     ppl  rouge1  rouge2  rougeL  
   105.5   .3840  .09355   .3717[0m
[32m2025-02-05 05:40:15.735[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m163[0m - [1m[Conversation epoch 30][0m
[32m2025-02-05 05:40:15.735[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m164[0m - [1m[Train][0m
  0%|          | 0/92414 [00:00<?, ?it/s]100%|██████████| 92414/92414 [00:00<00:00, 996727.59it/s]
[32m2025-02-05 05:40:15.828[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/358 [00:00<?, ?it/s]  0%|          | 1/358 [00:00<00:36,  9.74it/s]  1%|          | 3/358 [00:00<00:35,  9.91it/s]  1%|          | 4/358 [00:00<00:35,  9.89it/s]  2%|▏         | 6/358 [00:00<00:35,  9.85it/s]  2%|▏         | 7/358 [00:00<00:35,  9.79it/s]  2%|▏         | 8/358 [00:00<00:35,  9.84it/s]  3%|▎         | 9/358 [00:00<00:35,  9.74it/s]  3%|▎         | 10/358 [00:01<00:35,  9.73it/s]  3%|▎         | 11/358 [00:01<00:35,  9.68it/s]  4%|▎         | 13/358 [00:01<00:34,  9.87it/s]  4%|▍         | 14/358 [00:01<00:35,  9.80it/s]  4%|▍         | 15/358 [00:01<00:35,  9.73it/s]  4%|▍         | 16/358 [00:01<00:35,  9.68it/s]  5%|▍         | 17/358 [00:01<00:35,  9.70it/s]  5%|▌         | 18/358 [00:01<00:34,  9.78it/s]  5%|▌         | 19/358 [00:01<00:34,  9.70it/s]  6%|▌         | 20/358 [00:02<00:35,  9.65it/s]  6%|▌         | 21/358 [00:02<00:35,  9.58it/s]  6%|▌         | 22/358 [00:02<00:34,  9.65it/s]  7%|▋         | 24/358 [00:02<00:34,  9.75it/s]  7%|▋         | 25/358 [00:02<00:34,  9.70it/s]  7%|▋         | 26/358 [00:02<00:34,  9.65it/s]  8%|▊         | 27/358 [00:02<00:34,  9.71it/s]  8%|▊         | 28/358 [00:02<00:34,  9.66it/s]  8%|▊         | 29/358 [00:02<00:34,  9.63it/s]  9%|▊         | 31/358 [00:03<00:33,  9.73it/s]  9%|▉         | 32/358 [00:03<00:33,  9.73it/s]  9%|▉         | 34/358 [00:03<00:32,  9.83it/s] 10%|█         | 36/358 [00:03<00:32,  9.83it/s] 10%|█         | 37/358 [00:03<00:32,  9.81it/s] 11%|█         | 38/358 [00:03<00:32,  9.76it/s] 11%|█         | 40/358 [00:04<00:32,  9.92it/s] 11%|█▏        | 41/358 [00:04<00:32,  9.84it/s] 12%|█▏        | 43/358 [00:04<00:31,  9.87it/s] 13%|█▎        | 45/358 [00:04<00:31,  9.96it/s] 13%|█▎        | 47/358 [00:04<00:31,  9.94it/s] 13%|█▎        | 48/358 [00:04<00:31,  9.92it/s] 14%|█▍        | 50/358 [00:05<00:31,  9.89it/s] 14%|█▍        | 51/358 [00:05<00:31,  9.82it/s] 15%|█▍        | 52/358 [00:05<00:31,  9.73it/s] 15%|█▍        | 53/358 [00:05<00:31,  9.68it/s] 15%|█▌        | 54/358 [00:05<00:31,  9.72it/s] 15%|█▌        | 55/358 [00:05<00:31,  9.67it/s] 16%|█▌        | 56/358 [00:05<00:31,  9.71it/s] 16%|█▌        | 57/358 [00:05<00:31,  9.67it/s] 16%|█▌        | 58/358 [00:05<00:31,  9.65it/s] 16%|█▋        | 59/358 [00:06<00:31,  9.62it/s] 17%|█▋        | 61/358 [00:06<00:30,  9.71it/s] 17%|█▋        | 62/358 [00:06<00:30,  9.63it/s] 18%|█▊        | 63/358 [00:06<00:30,  9.70it/s] 18%|█▊        | 64/358 [00:06<00:30,  9.65it/s] 18%|█▊        | 66/358 [00:06<00:30,  9.72it/s] 19%|█▊        | 67/358 [00:06<00:29,  9.70it/s] 19%|█▉        | 69/358 [00:07<00:29,  9.77it/s] 20%|█▉        | 70/358 [00:07<00:29,  9.71it/s] 20%|█▉        | 71/358 [00:07<00:29,  9.76it/s] 20%|██        | 72/358 [00:07<00:29,  9.70it/s] 20%|██        | 73/358 [00:07<00:29,  9.67it/s] 21%|██        | 74/358 [00:07<00:29,  9.64it/s] 21%|██        | 75/358 [00:07<00:29,  9.61it/s] 21%|██        | 76/358 [00:07<00:29,  9.71it/s] 22%|██▏       | 77/358 [00:07<00:29,  9.67it/s] 22%|██▏       | 79/358 [00:08<00:28,  9.68it/s] 23%|██▎       | 81/358 [00:08<00:28,  9.74it/s] 23%|██▎       | 83/358 [00:08<00:28,  9.77it/s] 23%|██▎       | 84/358 [00:08<00:28,  9.72it/s] 24%|██▎       | 85/358 [00:08<00:28,  9.67it/s] 24%|██▍       | 86/358 [00:08<00:28,  9.65it/s] 24%|██▍       | 87/358 [00:08<00:28,  9.64it/s] 25%|██▍       | 88/358 [00:09<00:27,  9.66it/s] 25%|██▌       | 90/358 [00:09<00:27,  9.89it/s] 26%|██▌       | 92/358 [00:09<00:26,  9.99it/s] 26%|██▌       | 93/358 [00:09<00:26,  9.95it/s] 26%|██▋       | 94/358 [00:09<00:26,  9.87it/s] 27%|██▋       | 96/358 [00:09<00:25, 10.15it/s] 27%|██▋       | 98/358 [00:10<00:25, 10.03it/s] 28%|██▊       | 99/358 [00:10<00:26,  9.95it/s] 28%|██▊       | 101/358 [00:10<00:25,  9.91it/s] 29%|██▉       | 103/358 [00:10<00:25,  9.90it/s] 29%|██▉       | 104/358 [00:10<00:25,  9.85it/s] 29%|██▉       | 105/358 [00:10<00:25,  9.78it/s] 30%|██▉       | 106/358 [00:10<00:25,  9.76it/s] 30%|███       | 108/358 [00:11<00:25,  9.79it/s] 30%|███       | 109/358 [00:11<00:25,  9.70it/s] 31%|███       | 110/358 [00:11<00:25,  9.68it/s] 31%|███       | 111/358 [00:11<00:25,  9.63it/s] 32%|███▏      | 113/358 [00:11<00:24,  9.90it/s] 32%|███▏      | 114/358 [00:11<00:24,  9.86it/s] 32%|███▏      | 115/358 [00:11<00:24,  9.77it/s] 32%|███▏      | 116/358 [00:11<00:24,  9.68it/s] 33%|███▎      | 117/358 [00:11<00:24,  9.65it/s] 33%|███▎      | 119/358 [00:12<00:24,  9.77it/s] 34%|███▍      | 121/358 [00:12<00:23,  9.97it/s] 34%|███▍      | 123/358 [00:12<00:23, 10.07it/s] 35%|███▍      | 125/358 [00:12<00:23, 10.05it/s] 35%|███▌      | 126/358 [00:12<00:23, 10.01it/s] 35%|███▌      | 127/358 [00:12<00:23,  9.96it/s] 36%|███▌      | 128/358 [00:13<00:23,  9.91it/s] 36%|███▋      | 130/358 [00:13<00:22,  9.97it/s] 37%|███▋      | 131/358 [00:13<00:22,  9.87it/s] 37%|███▋      | 132/358 [00:13<00:22,  9.90it/s] 37%|███▋      | 134/358 [00:13<00:22,  9.92it/s] 38%|███▊      | 135/358 [00:13<00:22,  9.86it/s] 38%|███▊      | 137/358 [00:13<00:22,  9.95it/s] 39%|███▊      | 138/358 [00:14<00:22,  9.93it/s] 39%|███▉      | 139/358 [00:14<00:22,  9.84it/s] 39%|███▉      | 141/358 [00:14<00:21,  9.97it/s] 40%|███▉      | 142/358 [00:14<00:21,  9.89it/s] 40%|███▉      | 143/358 [00:14<00:21,  9.86it/s] 40%|████      | 144/358 [00:14<00:21,  9.77it/s] 41%|████      | 145/358 [00:14<00:21,  9.79it/s] 41%|████      | 146/358 [00:14<00:21,  9.72it/s] 41%|████      | 147/358 [00:15<00:21,  9.67it/s] 41%|████▏     | 148/358 [00:15<00:21,  9.69it/s] 42%|████▏     | 149/358 [00:15<00:21,  9.68it/s] 42%|████▏     | 150/358 [00:15<00:21,  9.64it/s] 42%|████▏     | 151/358 [00:15<00:22,  9.37it/s] 42%|████▏     | 152/358 [00:15<00:21,  9.42it/s] 43%|████▎     | 153/358 [00:15<00:21,  9.44it/s] 43%|████▎     | 154/358 [00:15<00:21,  9.52it/s] 43%|████▎     | 155/358 [00:15<00:21,  9.54it/s] 44%|████▎     | 156/358 [00:15<00:20,  9.66it/s] 44%|████▍     | 157/358 [00:16<00:20,  9.60it/s] 44%|████▍     | 158/358 [00:16<00:20,  9.69it/s] 44%|████▍     | 159/358 [00:16<00:20,  9.69it/s] 45%|████▍     | 160/358 [00:16<00:20,  9.69it/s] 45%|████▌     | 162/358 [00:16<00:19,  9.99it/s] 46%|████▌     | 164/358 [00:16<00:19,  9.99it/s] 46%|████▌     | 165/358 [00:16<00:19,  9.94it/s] 47%|████▋     | 167/358 [00:17<00:19,  9.89it/s] 47%|████▋     | 169/358 [00:17<00:19,  9.93it/s] 48%|████▊     | 171/358 [00:17<00:18,  9.92it/s] 48%|████▊     | 172/358 [00:17<00:18,  9.87it/s] 48%|████▊     | 173/358 [00:17<00:18,  9.80it/s] 49%|████▉     | 175/358 [00:17<00:18,  9.83it/s] 49%|████▉     | 176/358 [00:17<00:18,  9.84it/s] 49%|████▉     | 177/358 [00:18<00:18,  9.82it/s] 50%|█████     | 179/358 [00:18<00:18,  9.85it/s] 50%|█████     | 180/358 [00:18<00:18,  9.78it/s] 51%|█████     | 182/358 [00:18<00:17,  9.93it/s] 51%|█████     | 183/358 [00:18<00:17,  9.88it/s] 51%|█████▏    | 184/358 [00:18<00:17,  9.77it/s] 52%|█████▏    | 185/358 [00:18<00:17,  9.71it/s] 52%|█████▏    | 187/358 [00:19<00:17,  9.93it/s] 53%|█████▎    | 188/358 [00:19<00:17,  9.87it/s] 53%|█████▎    | 189/358 [00:19<00:17,  9.82it/s] 53%|█████▎    | 190/358 [00:19<00:17,  9.86it/s] 53%|█████▎    | 191/358 [00:19<00:17,  9.70it/s] 54%|█████▎    | 192/358 [00:19<00:17,  9.65it/s] 54%|█████▍    | 193/358 [00:19<00:17,  9.65it/s] 54%|█████▍    | 194/358 [00:19<00:17,  9.63it/s] 54%|█████▍    | 195/358 [00:19<00:16,  9.71it/s] 55%|█████▌    | 197/358 [00:20<00:16,  9.90it/s] 55%|█████▌    | 198/358 [00:20<00:16,  9.83it/s] 56%|█████▌    | 199/358 [00:20<00:16,  9.86it/s] 56%|█████▌    | 200/358 [00:20<00:16,  9.79it/s] 56%|█████▌    | 201/358 [00:20<00:16,  9.75it/s] 57%|█████▋    | 203/358 [00:20<00:15,  9.84it/s] 57%|█████▋    | 204/358 [00:20<00:15,  9.73it/s] 57%|█████▋    | 205/358 [00:20<00:15,  9.69it/s] 58%|█████▊    | 207/358 [00:21<00:15,  9.87it/s] 58%|█████▊    | 208/358 [00:21<00:15,  9.79it/s] 59%|█████▊    | 210/358 [00:21<00:15,  9.81it/s] 59%|█████▉    | 212/358 [00:21<00:14,  9.80it/s] 60%|█████▉    | 214/358 [00:21<00:14,  9.88it/s] 60%|██████    | 215/358 [00:21<00:14,  9.82it/s] 60%|██████    | 216/358 [00:22<00:14,  9.76it/s] 61%|██████    | 217/358 [00:22<00:14,  9.79it/s] 61%|██████    | 218/358 [00:22<00:14,  9.76it/s] 61%|██████    | 219/358 [00:22<00:14,  9.76it/s] 62%|██████▏   | 221/358 [00:22<00:13,  9.89it/s] 62%|██████▏   | 222/358 [00:22<00:13,  9.79it/s] 62%|██████▏   | 223/358 [00:22<00:13,  9.74it/s] 63%|██████▎   | 224/358 [00:22<00:13,  9.68it/s] 63%|██████▎   | 225/358 [00:22<00:13,  9.76it/s] 63%|██████▎   | 226/358 [00:23<00:13,  9.71it/s] 64%|██████▎   | 228/358 [00:23<00:13,  9.75it/s] 64%|██████▍   | 229/358 [00:23<00:13,  9.72it/s] 64%|██████▍   | 230/358 [00:23<00:13,  9.67it/s] 65%|██████▍   | 232/358 [00:23<00:12,  9.72it/s] 65%|██████▌   | 234/358 [00:23<00:12, 10.01it/s] 66%|██████▌   | 236/358 [00:24<00:12,  9.97it/s] 66%|██████▋   | 238/358 [00:24<00:11, 10.03it/s] 67%|██████▋   | 240/358 [00:24<00:11,  9.99it/s] 68%|██████▊   | 242/358 [00:24<00:11,  9.96it/s] 68%|██████▊   | 243/358 [00:24<00:11,  9.90it/s] 68%|██████▊   | 244/358 [00:24<00:11,  9.84it/s] 69%|██████▊   | 246/358 [00:25<00:11,  9.86it/s] 69%|██████▉   | 247/358 [00:25<00:11,  9.79it/s] 69%|██████▉   | 248/358 [00:25<00:11,  9.75it/s] 70%|██████▉   | 250/358 [00:25<00:10,  9.84it/s] 70%|███████   | 251/358 [00:25<00:10,  9.78it/s] 70%|███████   | 252/358 [00:25<00:10,  9.72it/s] 71%|███████   | 253/358 [00:25<00:10,  9.68it/s] 71%|███████   | 254/358 [00:25<00:10,  9.65it/s] 72%|███████▏  | 256/358 [00:26<00:10,  9.82it/s] 72%|███████▏  | 257/358 [00:26<00:10,  9.83it/s] 72%|███████▏  | 258/358 [00:26<00:10,  9.70it/s] 72%|███████▏  | 259/358 [00:26<00:10,  9.66it/s] 73%|███████▎  | 260/358 [00:26<00:10,  9.70it/s] 73%|███████▎  | 262/358 [00:26<00:09,  9.88it/s] 74%|███████▎  | 264/358 [00:26<00:09,  9.90it/s] 74%|███████▍  | 266/358 [00:27<00:09,  9.89it/s] 75%|███████▍  | 267/358 [00:27<00:09,  9.83it/s] 75%|███████▌  | 269/358 [00:27<00:09,  9.89it/s] 75%|███████▌  | 270/358 [00:27<00:08,  9.82it/s] 76%|███████▌  | 271/358 [00:27<00:08,  9.74it/s] 76%|███████▌  | 272/358 [00:27<00:08,  9.72it/s] 76%|███████▋  | 273/358 [00:27<00:08,  9.62it/s] 77%|███████▋  | 274/358 [00:27<00:08,  9.62it/s] 77%|███████▋  | 275/358 [00:28<00:08,  9.67it/s] 77%|███████▋  | 276/358 [00:28<00:08,  9.67it/s] 77%|███████▋  | 277/358 [00:28<00:08,  9.64it/s] 78%|███████▊  | 278/358 [00:28<00:08,  9.62it/s] 78%|███████▊  | 280/358 [00:28<00:07,  9.81it/s] 78%|███████▊  | 281/358 [00:28<00:07,  9.82it/s] 79%|███████▉  | 282/358 [00:28<00:07,  9.76it/s] 79%|███████▉  | 283/358 [00:28<00:07,  9.70it/s] 79%|███████▉  | 284/358 [00:29<00:07,  9.66it/s] 80%|███████▉  | 285/358 [00:29<00:07,  9.73it/s] 80%|███████▉  | 286/358 [00:29<00:07,  9.68it/s] 80%|████████  | 287/358 [00:29<00:07,  9.66it/s] 80%|████████  | 288/358 [00:29<00:07,  9.62it/s] 81%|████████  | 290/358 [00:29<00:06,  9.83it/s] 81%|████████▏ | 291/358 [00:29<00:06,  9.81it/s] 82%|████████▏ | 293/358 [00:29<00:06,  9.82it/s] 82%|████████▏ | 295/358 [00:30<00:06,  9.89it/s] 83%|████████▎ | 296/358 [00:30<00:06,  9.83it/s] 83%|████████▎ | 297/358 [00:30<00:06,  9.72it/s] 84%|████████▎ | 299/358 [00:30<00:05,  9.89it/s] 84%|████████▍ | 301/358 [00:30<00:05,  9.92it/s] 84%|████████▍ | 302/358 [00:30<00:05,  9.86it/s] 85%|████████▍ | 303/358 [00:30<00:05,  9.86it/s] 85%|████████▌ | 305/358 [00:31<00:05,  9.89it/s] 85%|████████▌ | 306/358 [00:31<00:05,  9.82it/s] 86%|████████▌ | 308/358 [00:31<00:05,  9.92it/s] 86%|████████▋ | 309/358 [00:31<00:04,  9.82it/s] 87%|████████▋ | 310/358 [00:31<00:04,  9.76it/s] 87%|████████▋ | 311/358 [00:31<00:04,  9.68it/s] 87%|████████▋ | 312/358 [00:31<00:04,  9.70it/s] 87%|████████▋ | 313/358 [00:31<00:04,  9.72it/s] 88%|████████▊ | 315/358 [00:32<00:04,  9.97it/s] 88%|████████▊ | 316/358 [00:32<00:04,  9.92it/s] 89%|████████▊ | 317/358 [00:32<00:04,  9.84it/s] 89%|████████▉ | 318/358 [00:32<00:04,  9.79it/s] 89%|████████▉ | 319/358 [00:32<00:04,  9.75it/s] 89%|████████▉ | 320/358 [00:32<00:03,  9.80it/s] 90%|████████▉ | 321/358 [00:32<00:03,  9.73it/s] 90%|████████▉ | 322/358 [00:32<00:03,  9.69it/s] 90%|█████████ | 323/358 [00:32<00:03,  9.65it/s] 91%|█████████ | 324/358 [00:33<00:03,  9.62it/s] 91%|█████████ | 325/358 [00:33<00:03,  9.60it/s] 91%|█████████▏| 327/358 [00:33<00:03,  9.96it/s] 92%|█████████▏| 329/358 [00:33<00:02, 10.06it/s] 92%|█████████▏| 330/358 [00:33<00:02,  9.95it/s] 93%|█████████▎| 332/358 [00:33<00:02, 10.05it/s] 93%|█████████▎| 334/358 [00:34<00:02,  9.95it/s] 94%|█████████▎| 335/358 [00:34<00:02,  9.83it/s] 94%|█████████▍| 337/358 [00:34<00:02,  9.91it/s] 95%|█████████▍| 339/358 [00:34<00:01, 10.11it/s] 95%|█████████▌| 341/358 [00:34<00:01, 10.05it/s] 96%|█████████▌| 343/358 [00:34<00:01,  9.89it/s] 96%|█████████▌| 344/358 [00:35<00:01,  9.83it/s] 96%|█████████▋| 345/358 [00:35<00:01,  9.85it/s] 97%|█████████▋| 347/358 [00:35<00:01, 10.03it/s] 97%|█████████▋| 348/358 [00:35<00:01,  9.93it/s] 97%|█████████▋| 349/358 [00:35<00:00,  9.85it/s] 98%|█████████▊| 350/358 [00:35<00:00,  9.78it/s] 98%|█████████▊| 351/358 [00:35<00:00,  9.73it/s] 99%|█████████▊| 353/358 [00:36<00:00,  9.91it/s] 99%|█████████▉| 354/358 [00:36<00:00,  9.89it/s] 99%|█████████▉| 355/358 [00:36<00:00,  9.81it/s]100%|█████████▉| 357/358 [00:36<00:00,  9.86it/s]100%|██████████| 358/358 [00:36<00:00,  9.81it/s]
[32m2025-02-05 05:40:52.318[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    gen_loss  grad clip ratio  grad norm   ppl
       2.144                1      3.829 8.538[0m
[32m2025-02-05 05:40:52.318[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m169[0m - [1m[Valid][0m
  0%|          | 0/10256 [00:00<?, ?it/s]100%|██████████| 10256/10256 [00:00<00:00, 1042148.94it/s]
[32m2025-02-05 05:40:52.328[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:27,  1.44it/s]  5%|▌         | 2/40 [00:01<00:26,  1.46it/s]  8%|▊         | 3/40 [00:02<00:25,  1.46it/s] 10%|█         | 4/40 [00:02<00:24,  1.46it/s] 12%|█▎        | 5/40 [00:03<00:24,  1.45it/s] 15%|█▌        | 6/40 [00:04<00:23,  1.45it/s] 18%|█▊        | 7/40 [00:04<00:22,  1.44it/s] 20%|██        | 8/40 [00:05<00:22,  1.45it/s] 22%|██▎       | 9/40 [00:06<00:21,  1.44it/s] 25%|██▌       | 10/40 [00:06<00:20,  1.45it/s] 28%|██▊       | 11/40 [00:07<00:20,  1.45it/s] 30%|███       | 12/40 [00:08<00:19,  1.45it/s] 32%|███▎      | 13/40 [00:08<00:18,  1.46it/s] 35%|███▌      | 14/40 [00:09<00:18,  1.44it/s] 38%|███▊      | 15/40 [00:10<00:17,  1.44it/s] 40%|████      | 16/40 [00:11<00:16,  1.44it/s] 42%|████▎     | 17/40 [00:11<00:15,  1.45it/s] 45%|████▌     | 18/40 [00:12<00:15,  1.45it/s] 48%|████▊     | 19/40 [00:13<00:14,  1.45it/s] 50%|█████     | 20/40 [00:13<00:13,  1.45it/s] 52%|█████▎    | 21/40 [00:14<00:13,  1.45it/s] 55%|█████▌    | 22/40 [00:15<00:12,  1.45it/s] 57%|█████▊    | 23/40 [00:15<00:11,  1.45it/s] 60%|██████    | 24/40 [00:16<00:11,  1.44it/s] 62%|██████▎   | 25/40 [00:17<00:10,  1.44it/s] 65%|██████▌   | 26/40 [00:17<00:09,  1.46it/s] 68%|██████▊   | 27/40 [00:18<00:08,  1.45it/s] 70%|███████   | 28/40 [00:19<00:08,  1.45it/s] 72%|███████▎  | 29/40 [00:20<00:07,  1.45it/s] 75%|███████▌  | 30/40 [00:20<00:06,  1.45it/s] 78%|███████▊  | 31/40 [00:21<00:06,  1.45it/s] 80%|████████  | 32/40 [00:22<00:05,  1.45it/s] 82%|████████▎ | 33/40 [00:22<00:04,  1.45it/s] 85%|████████▌ | 34/40 [00:23<00:04,  1.45it/s] 88%|████████▊ | 35/40 [00:24<00:03,  1.45it/s] 90%|█████████ | 36/40 [00:24<00:02,  1.44it/s] 92%|█████████▎| 37/40 [00:25<00:02,  1.45it/s] 95%|█████████▌| 38/40 [00:26<00:01,  1.44it/s] 98%|█████████▊| 39/40 [00:26<00:00,  1.44it/s]100%|██████████| 40/40 [00:27<00:00,  1.59it/s]100%|██████████| 40/40 [00:27<00:00,  1.46it/s]
[32m2025-02-05 05:41:19.739[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    average  bleu@1  bleu@2  bleu@3  bleu@4  dist@1  dist@2  dist@3  dist@4  extreme  \
      .7761   .3002   .1135  .04773  .02495  .04362   .3010   .5863   .7489    .5945   
      f1  gen_loss  greedy  intra_dist@1  intra_dist@2  intra_dist@3  intra_dist@4  \
   .3526      4.65   .6671         .8702         .9629         .9489         .9130   
     ppl  rouge1  rouge2  rougeL  
   104.6   .3894  .09487   .3765[0m
[32m2025-02-05 05:41:19.746[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m163[0m - [1m[Conversation epoch 31][0m
[32m2025-02-05 05:41:19.746[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m164[0m - [1m[Train][0m
  0%|          | 0/92414 [00:00<?, ?it/s]100%|██████████| 92414/92414 [00:00<00:00, 990464.68it/s]
[32m2025-02-05 05:41:19.839[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/358 [00:00<?, ?it/s]  0%|          | 1/358 [00:00<00:36,  9.71it/s]  1%|          | 3/358 [00:00<00:35,  9.91it/s]  1%|          | 4/358 [00:00<00:35,  9.89it/s]  2%|▏         | 6/358 [00:00<00:35,  9.86it/s]  2%|▏         | 7/358 [00:00<00:35,  9.80it/s]  2%|▏         | 8/358 [00:00<00:35,  9.84it/s]  3%|▎         | 9/358 [00:00<00:35,  9.74it/s]  3%|▎         | 10/358 [00:01<00:35,  9.73it/s]  3%|▎         | 11/358 [00:01<00:35,  9.69it/s]  4%|▎         | 13/358 [00:01<00:34,  9.90it/s]  4%|▍         | 14/358 [00:01<00:35,  9.83it/s]  4%|▍         | 15/358 [00:01<00:35,  9.75it/s]  4%|▍         | 16/358 [00:01<00:35,  9.69it/s]  5%|▍         | 17/358 [00:01<00:35,  9.71it/s]  5%|▌         | 18/358 [00:01<00:34,  9.78it/s]  5%|▌         | 19/358 [00:01<00:34,  9.71it/s]  6%|▌         | 20/358 [00:02<00:35,  9.65it/s]  6%|▌         | 21/358 [00:02<00:35,  9.58it/s]  6%|▌         | 22/358 [00:02<00:34,  9.65it/s]  7%|▋         | 24/358 [00:02<00:34,  9.75it/s]  7%|▋         | 25/358 [00:02<00:34,  9.70it/s]  7%|▋         | 26/358 [00:02<00:34,  9.65it/s]  8%|▊         | 27/358 [00:02<00:34,  9.71it/s]  8%|▊         | 28/358 [00:02<00:34,  9.66it/s]  8%|▊         | 29/358 [00:02<00:34,  9.63it/s]  9%|▊         | 31/358 [00:03<00:33,  9.73it/s]  9%|▉         | 32/358 [00:03<00:33,  9.73it/s]  9%|▉         | 34/358 [00:03<00:32,  9.83it/s] 10%|█         | 36/358 [00:03<00:32,  9.83it/s] 10%|█         | 37/358 [00:03<00:32,  9.81it/s] 11%|█         | 38/358 [00:03<00:32,  9.77it/s] 11%|█         | 40/358 [00:04<00:32,  9.92it/s] 11%|█▏        | 41/358 [00:04<00:32,  9.84it/s] 12%|█▏        | 43/358 [00:04<00:31,  9.86it/s] 12%|█▏        | 44/358 [00:04<00:31,  9.89it/s] 13%|█▎        | 46/358 [00:04<00:31,  9.98it/s] 13%|█▎        | 47/358 [00:04<00:31,  9.93it/s] 13%|█▎        | 48/358 [00:04<00:31,  9.92it/s] 14%|█▍        | 50/358 [00:05<00:31,  9.89it/s] 14%|█▍        | 51/358 [00:05<00:31,  9.82it/s] 15%|█▍        | 52/358 [00:05<00:31,  9.73it/s] 15%|█▍        | 53/358 [00:05<00:31,  9.67it/s] 15%|█▌        | 54/358 [00:05<00:31,  9.72it/s] 15%|█▌        | 55/358 [00:05<00:31,  9.67it/s] 16%|█▌        | 56/358 [00:05<00:31,  9.71it/s] 16%|█▌        | 57/358 [00:05<00:31,  9.67it/s] 16%|█▌        | 58/358 [00:05<00:31,  9.65it/s] 16%|█▋        | 59/358 [00:06<00:31,  9.62it/s] 17%|█▋        | 61/358 [00:06<00:30,  9.71it/s] 17%|█▋        | 62/358 [00:06<00:30,  9.63it/s] 18%|█▊        | 63/358 [00:06<00:30,  9.70it/s] 18%|█▊        | 64/358 [00:06<00:30,  9.65it/s] 18%|█▊        | 66/358 [00:06<00:30,  9.72it/s] 19%|█▊        | 67/358 [00:06<00:29,  9.70it/s] 19%|█▉        | 69/358 [00:07<00:29,  9.76it/s] 20%|█▉        | 70/358 [00:07<00:29,  9.71it/s] 20%|█▉        | 71/358 [00:07<00:29,  9.75it/s] 20%|██        | 72/358 [00:07<00:29,  9.70it/s] 20%|██        | 73/358 [00:07<00:29,  9.67it/s] 21%|██        | 74/358 [00:07<00:29,  9.64it/s] 21%|██        | 75/358 [00:07<00:29,  9.60it/s] 21%|██        | 76/358 [00:07<00:29,  9.70it/s] 22%|██▏       | 77/358 [00:07<00:29,  9.67it/s] 22%|██▏       | 79/358 [00:08<00:28,  9.68it/s] 23%|██▎       | 81/358 [00:08<00:28,  9.74it/s] 23%|██▎       | 83/358 [00:08<00:28,  9.76it/s] 23%|██▎       | 84/358 [00:08<00:28,  9.71it/s] 24%|██▎       | 85/358 [00:08<00:28,  9.67it/s] 24%|██▍       | 86/358 [00:08<00:28,  9.66it/s] 24%|██▍       | 87/358 [00:08<00:28,  9.64it/s] 25%|██▍       | 88/358 [00:09<00:27,  9.65it/s] 25%|██▌       | 90/358 [00:09<00:27,  9.89it/s] 26%|██▌       | 92/358 [00:09<00:26,  9.99it/s] 26%|██▌       | 93/358 [00:09<00:26,  9.95it/s] 26%|██▋       | 94/358 [00:09<00:26,  9.86it/s] 27%|██▋       | 96/358 [00:09<00:25, 10.14it/s] 27%|██▋       | 98/358 [00:10<00:25, 10.04it/s] 28%|██▊       | 99/358 [00:10<00:26,  9.95it/s] 28%|██▊       | 101/358 [00:10<00:25,  9.91it/s] 29%|██▉       | 103/358 [00:10<00:25,  9.90it/s] 29%|██▉       | 104/358 [00:10<00:25,  9.86it/s] 29%|██▉       | 105/358 [00:10<00:25,  9.78it/s] 30%|██▉       | 106/358 [00:10<00:25,  9.76it/s] 30%|███       | 108/358 [00:11<00:25,  9.79it/s] 30%|███       | 109/358 [00:11<00:25,  9.71it/s] 31%|███       | 110/358 [00:11<00:25,  9.69it/s] 31%|███       | 111/358 [00:11<00:25,  9.64it/s] 32%|███▏      | 113/358 [00:11<00:24,  9.90it/s] 32%|███▏      | 114/358 [00:11<00:24,  9.86it/s] 32%|███▏      | 115/358 [00:11<00:24,  9.77it/s] 32%|███▏      | 116/358 [00:11<00:24,  9.68it/s] 33%|███▎      | 117/358 [00:11<00:24,  9.65it/s] 33%|███▎      | 119/358 [00:12<00:24,  9.77it/s] 34%|███▍      | 121/358 [00:12<00:23,  9.97it/s] 34%|███▍      | 123/358 [00:12<00:23, 10.07it/s] 35%|███▍      | 125/358 [00:12<00:23, 10.05it/s] 35%|███▌      | 126/358 [00:12<00:23, 10.01it/s] 35%|███▌      | 127/358 [00:12<00:23,  9.96it/s] 36%|███▌      | 128/358 [00:13<00:23,  9.91it/s] 36%|███▋      | 130/358 [00:13<00:22,  9.98it/s] 37%|███▋      | 131/358 [00:13<00:22,  9.88it/s] 37%|███▋      | 132/358 [00:13<00:22,  9.90it/s] 37%|███▋      | 134/358 [00:13<00:22,  9.92it/s] 38%|███▊      | 135/358 [00:13<00:22,  9.86it/s] 38%|███▊      | 137/358 [00:13<00:22,  9.95it/s] 39%|███▊      | 138/358 [00:14<00:22,  9.93it/s] 39%|███▉      | 139/358 [00:14<00:22,  9.84it/s] 39%|███▉      | 141/358 [00:14<00:21,  9.97it/s] 40%|███▉      | 142/358 [00:14<00:21,  9.89it/s] 40%|███▉      | 143/358 [00:14<00:21,  9.86it/s] 40%|████      | 144/358 [00:14<00:21,  9.77it/s] 41%|████      | 145/358 [00:14<00:21,  9.79it/s] 41%|████      | 146/358 [00:14<00:21,  9.73it/s] 41%|████      | 147/358 [00:15<00:21,  9.67it/s] 41%|████▏     | 148/358 [00:15<00:21,  9.70it/s] 42%|████▏     | 149/358 [00:15<00:21,  9.68it/s] 42%|████▏     | 150/358 [00:15<00:21,  9.64it/s] 42%|████▏     | 151/358 [00:15<00:22,  9.38it/s] 42%|████▏     | 152/358 [00:15<00:21,  9.42it/s] 43%|████▎     | 153/358 [00:15<00:21,  9.44it/s] 43%|████▎     | 154/358 [00:15<00:21,  9.53it/s] 43%|████▎     | 155/358 [00:15<00:21,  9.55it/s] 44%|████▎     | 156/358 [00:15<00:20,  9.67it/s] 44%|████▍     | 157/358 [00:16<00:20,  9.61it/s] 44%|████▍     | 158/358 [00:16<00:20,  9.70it/s] 44%|████▍     | 159/358 [00:16<00:20,  9.69it/s] 45%|████▍     | 160/358 [00:16<00:20,  9.70it/s] 45%|████▌     | 162/358 [00:16<00:19,  9.98it/s] 46%|████▌     | 164/358 [00:16<00:19,  9.99it/s] 46%|████▌     | 165/358 [00:16<00:19,  9.95it/s] 47%|████▋     | 167/358 [00:17<00:19,  9.89it/s] 47%|████▋     | 169/358 [00:17<00:19,  9.93it/s] 48%|████▊     | 171/358 [00:17<00:18,  9.91it/s] 48%|████▊     | 172/358 [00:17<00:18,  9.86it/s] 48%|████▊     | 173/358 [00:17<00:18,  9.80it/s] 49%|████▉     | 175/358 [00:17<00:18,  9.82it/s] 49%|████▉     | 176/358 [00:17<00:18,  9.84it/s] 49%|████▉     | 177/358 [00:18<00:18,  9.82it/s] 50%|█████     | 179/358 [00:18<00:18,  9.85it/s] 50%|█████     | 180/358 [00:18<00:18,  9.78it/s] 51%|█████     | 182/358 [00:18<00:17,  9.92it/s] 51%|█████     | 183/358 [00:18<00:17,  9.88it/s] 51%|█████▏    | 184/358 [00:18<00:17,  9.77it/s] 52%|█████▏    | 185/358 [00:18<00:17,  9.71it/s] 52%|█████▏    | 187/358 [00:19<00:17,  9.93it/s] 53%|█████▎    | 188/358 [00:19<00:17,  9.88it/s] 53%|█████▎    | 189/358 [00:19<00:17,  9.82it/s] 53%|█████▎    | 191/358 [00:19<00:17,  9.74it/s] 54%|█████▎    | 192/358 [00:19<00:17,  9.69it/s] 54%|█████▍    | 193/358 [00:19<00:17,  9.68it/s] 54%|█████▍    | 194/358 [00:19<00:16,  9.66it/s] 54%|█████▍    | 195/358 [00:19<00:16,  9.73it/s] 55%|█████▌    | 197/358 [00:20<00:16,  9.90it/s] 55%|█████▌    | 198/358 [00:20<00:16,  9.83it/s] 56%|█████▌    | 199/358 [00:20<00:16,  9.86it/s] 56%|█████▌    | 200/358 [00:20<00:16,  9.79it/s] 56%|█████▌    | 201/358 [00:20<00:16,  9.75it/s] 57%|█████▋    | 203/358 [00:20<00:15,  9.84it/s] 57%|█████▋    | 204/358 [00:20<00:15,  9.74it/s] 57%|█████▋    | 205/358 [00:20<00:15,  9.70it/s] 58%|█████▊    | 207/358 [00:21<00:15,  9.87it/s] 58%|█████▊    | 208/358 [00:21<00:15,  9.79it/s] 59%|█████▊    | 210/358 [00:21<00:15,  9.81it/s] 59%|█████▉    | 212/358 [00:21<00:14,  9.80it/s] 60%|█████▉    | 214/358 [00:21<00:14,  9.88it/s] 60%|██████    | 215/358 [00:21<00:14,  9.82it/s] 60%|██████    | 216/358 [00:22<00:14,  9.76it/s] 61%|██████    | 217/358 [00:22<00:14,  9.79it/s] 61%|██████    | 218/358 [00:22<00:14,  9.76it/s] 61%|██████    | 219/358 [00:22<00:14,  9.76it/s] 62%|██████▏   | 221/358 [00:22<00:13,  9.89it/s] 62%|██████▏   | 222/358 [00:22<00:13,  9.79it/s] 62%|██████▏   | 223/358 [00:22<00:13,  9.73it/s] 63%|██████▎   | 224/358 [00:22<00:13,  9.68it/s] 63%|██████▎   | 225/358 [00:22<00:13,  9.76it/s] 63%|██████▎   | 226/358 [00:23<00:13,  9.71it/s] 64%|██████▎   | 228/358 [00:23<00:13,  9.74it/s] 64%|██████▍   | 229/358 [00:23<00:13,  9.72it/s] 64%|██████▍   | 230/358 [00:23<00:13,  9.67it/s] 65%|██████▍   | 232/358 [00:23<00:12,  9.72it/s] 65%|██████▌   | 234/358 [00:23<00:12, 10.01it/s] 66%|██████▌   | 236/358 [00:24<00:12,  9.97it/s] 66%|██████▋   | 238/358 [00:24<00:11, 10.02it/s] 67%|██████▋   | 240/358 [00:24<00:11,  9.98it/s] 68%|██████▊   | 242/358 [00:24<00:11,  9.96it/s] 68%|██████▊   | 243/358 [00:24<00:11,  9.90it/s] 68%|██████▊   | 244/358 [00:24<00:11,  9.84it/s] 69%|██████▊   | 246/358 [00:25<00:11,  9.86it/s] 69%|██████▉   | 247/358 [00:25<00:11,  9.78it/s] 69%|██████▉   | 248/358 [00:25<00:11,  9.74it/s] 70%|██████▉   | 250/358 [00:25<00:10,  9.84it/s] 70%|███████   | 251/358 [00:25<00:10,  9.78it/s] 70%|███████   | 252/358 [00:25<00:10,  9.71it/s] 71%|███████   | 253/358 [00:25<00:10,  9.67it/s] 71%|███████   | 254/358 [00:25<00:10,  9.64it/s] 72%|███████▏  | 256/358 [00:26<00:10,  9.82it/s] 72%|███████▏  | 257/358 [00:26<00:10,  9.83it/s] 72%|███████▏  | 258/358 [00:26<00:10,  9.70it/s] 72%|███████▏  | 259/358 [00:26<00:10,  9.67it/s] 73%|███████▎  | 260/358 [00:26<00:10,  9.70it/s] 73%|███████▎  | 262/358 [00:26<00:09,  9.88it/s] 74%|███████▎  | 264/358 [00:26<00:09,  9.90it/s] 74%|███████▍  | 266/358 [00:27<00:09,  9.89it/s] 75%|███████▍  | 267/358 [00:27<00:09,  9.83it/s] 75%|███████▌  | 269/358 [00:27<00:08,  9.89it/s] 75%|███████▌  | 270/358 [00:27<00:08,  9.82it/s] 76%|███████▌  | 271/358 [00:27<00:08,  9.75it/s] 76%|███████▌  | 272/358 [00:27<00:08,  9.72it/s] 76%|███████▋  | 273/358 [00:27<00:08,  9.62it/s] 77%|███████▋  | 274/358 [00:27<00:08,  9.62it/s] 77%|███████▋  | 275/358 [00:28<00:08,  9.67it/s] 77%|███████▋  | 276/358 [00:28<00:08,  9.67it/s] 77%|███████▋  | 277/358 [00:28<00:08,  9.64it/s] 78%|███████▊  | 278/358 [00:28<00:08,  9.62it/s] 78%|███████▊  | 280/358 [00:28<00:07,  9.81it/s] 78%|███████▊  | 281/358 [00:28<00:07,  9.82it/s] 79%|███████▉  | 282/358 [00:28<00:07,  9.76it/s] 79%|███████▉  | 283/358 [00:28<00:07,  9.70it/s] 79%|███████▉  | 284/358 [00:29<00:07,  9.66it/s] 80%|███████▉  | 285/358 [00:29<00:07,  9.73it/s] 80%|███████▉  | 286/358 [00:29<00:07,  9.68it/s] 80%|████████  | 287/358 [00:29<00:07,  9.66it/s] 80%|████████  | 288/358 [00:29<00:07,  9.62it/s] 81%|████████  | 290/358 [00:29<00:06,  9.83it/s] 81%|████████▏ | 291/358 [00:29<00:06,  9.81it/s] 82%|████████▏ | 293/358 [00:29<00:06,  9.82it/s] 82%|████████▏ | 295/358 [00:30<00:06,  9.89it/s] 83%|████████▎ | 296/358 [00:30<00:06,  9.83it/s] 83%|████████▎ | 297/358 [00:30<00:06,  9.73it/s] 84%|████████▎ | 299/358 [00:30<00:05,  9.89it/s] 84%|████████▍ | 301/358 [00:30<00:05,  9.92it/s] 84%|████████▍ | 302/358 [00:30<00:05,  9.86it/s] 85%|████████▍ | 303/358 [00:30<00:05,  9.86it/s] 85%|████████▌ | 305/358 [00:31<00:05,  9.89it/s] 85%|████████▌ | 306/358 [00:31<00:05,  9.82it/s] 86%|████████▌ | 308/358 [00:31<00:05,  9.92it/s] 86%|████████▋ | 309/358 [00:31<00:04,  9.82it/s] 87%|████████▋ | 310/358 [00:31<00:04,  9.76it/s] 87%|████████▋ | 311/358 [00:31<00:04,  9.68it/s] 87%|████████▋ | 312/358 [00:31<00:04,  9.70it/s] 87%|████████▋ | 313/358 [00:31<00:04,  9.71it/s] 88%|████████▊ | 315/358 [00:32<00:04,  9.97it/s] 88%|████████▊ | 316/358 [00:32<00:04,  9.92it/s] 89%|████████▊ | 317/358 [00:32<00:04,  9.84it/s] 89%|████████▉ | 318/358 [00:32<00:04,  9.79it/s] 89%|████████▉ | 319/358 [00:32<00:04,  9.74it/s] 89%|████████▉ | 320/358 [00:32<00:03,  9.80it/s] 90%|████████▉ | 321/358 [00:32<00:03,  9.73it/s] 90%|████████▉ | 322/358 [00:32<00:03,  9.69it/s] 90%|█████████ | 323/358 [00:32<00:03,  9.64it/s] 91%|█████████ | 324/358 [00:33<00:03,  9.61it/s] 91%|█████████ | 325/358 [00:33<00:03,  9.60it/s] 91%|█████████▏| 327/358 [00:33<00:03,  9.95it/s] 92%|█████████▏| 329/358 [00:33<00:02, 10.05it/s] 92%|█████████▏| 330/358 [00:33<00:02,  9.94it/s] 93%|█████████▎| 332/358 [00:33<00:02, 10.04it/s] 93%|█████████▎| 334/358 [00:34<00:02,  9.95it/s] 94%|█████████▎| 335/358 [00:34<00:02,  9.83it/s] 94%|█████████▍| 337/358 [00:34<00:02,  9.90it/s] 95%|█████████▍| 339/358 [00:34<00:01, 10.10it/s] 95%|█████████▌| 341/358 [00:34<00:01, 10.05it/s] 96%|█████████▌| 343/358 [00:34<00:01,  9.89it/s] 96%|█████████▌| 344/358 [00:35<00:01,  9.83it/s] 96%|█████████▋| 345/358 [00:35<00:01,  9.85it/s] 97%|█████████▋| 346/358 [00:35<00:01,  9.88it/s] 97%|█████████▋| 348/358 [00:35<00:01,  9.97it/s] 97%|█████████▋| 349/358 [00:35<00:00,  9.89it/s] 98%|█████████▊| 350/358 [00:35<00:00,  9.80it/s] 98%|█████████▊| 351/358 [00:35<00:00,  9.75it/s] 99%|█████████▊| 353/358 [00:36<00:00,  9.92it/s] 99%|█████████▉| 354/358 [00:36<00:00,  9.90it/s] 99%|█████████▉| 355/358 [00:36<00:00,  9.81it/s]100%|█████████▉| 357/358 [00:36<00:00,  9.86it/s]100%|██████████| 358/358 [00:36<00:00,  9.81it/s]
[32m2025-02-05 05:41:56.326[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    gen_loss  grad clip ratio  grad norm   ppl
       2.127                1      3.648 8.391[0m
[32m2025-02-05 05:41:56.327[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m169[0m - [1m[Valid][0m
  0%|          | 0/10256 [00:00<?, ?it/s]100%|██████████| 10256/10256 [00:00<00:00, 1054048.71it/s]
[32m2025-02-05 05:41:56.337[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:26,  1.45it/s]  5%|▌         | 2/40 [00:01<00:26,  1.46it/s]  8%|▊         | 3/40 [00:02<00:25,  1.46it/s] 10%|█         | 4/40 [00:02<00:24,  1.46it/s] 12%|█▎        | 5/40 [00:03<00:24,  1.44it/s] 15%|█▌        | 6/40 [00:04<00:23,  1.45it/s] 18%|█▊        | 7/40 [00:04<00:22,  1.45it/s] 20%|██        | 8/40 [00:05<00:21,  1.46it/s] 22%|██▎       | 9/40 [00:06<00:21,  1.46it/s] 25%|██▌       | 10/40 [00:06<00:20,  1.46it/s] 28%|██▊       | 11/40 [00:07<00:19,  1.46it/s] 30%|███       | 12/40 [00:08<00:19,  1.46it/s] 32%|███▎      | 13/40 [00:08<00:18,  1.46it/s] 35%|███▌      | 14/40 [00:09<00:17,  1.45it/s] 38%|███▊      | 15/40 [00:10<00:17,  1.45it/s] 40%|████      | 16/40 [00:11<00:16,  1.45it/s] 42%|████▎     | 17/40 [00:11<00:15,  1.45it/s] 45%|████▌     | 18/40 [00:12<00:15,  1.46it/s] 48%|████▊     | 19/40 [00:13<00:14,  1.45it/s] 50%|█████     | 20/40 [00:13<00:13,  1.46it/s] 52%|█████▎    | 21/40 [00:14<00:13,  1.46it/s] 55%|█████▌    | 22/40 [00:15<00:12,  1.45it/s] 57%|█████▊    | 23/40 [00:15<00:11,  1.46it/s] 60%|██████    | 24/40 [00:16<00:11,  1.45it/s] 62%|██████▎   | 25/40 [00:17<00:10,  1.45it/s] 65%|██████▌   | 26/40 [00:17<00:09,  1.46it/s] 68%|██████▊   | 27/40 [00:18<00:08,  1.46it/s] 70%|███████   | 28/40 [00:19<00:08,  1.46it/s] 72%|███████▎  | 29/40 [00:19<00:07,  1.46it/s] 75%|███████▌  | 30/40 [00:20<00:06,  1.47it/s] 78%|███████▊  | 31/40 [00:21<00:06,  1.46it/s] 80%|████████  | 32/40 [00:21<00:05,  1.46it/s] 82%|████████▎ | 33/40 [00:22<00:04,  1.46it/s] 85%|████████▌ | 34/40 [00:23<00:04,  1.46it/s] 88%|████████▊ | 35/40 [00:24<00:03,  1.46it/s] 90%|█████████ | 36/40 [00:24<00:02,  1.45it/s] 92%|█████████▎| 37/40 [00:25<00:02,  1.45it/s] 95%|█████████▌| 38/40 [00:26<00:01,  1.45it/s] 98%|█████████▊| 39/40 [00:26<00:00,  1.45it/s]100%|██████████| 40/40 [00:27<00:00,  1.60it/s]100%|██████████| 40/40 [00:27<00:00,  1.47it/s]
[32m2025-02-05 05:42:23.632[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    average  bleu@1  bleu@2  bleu@3  bleu@4  dist@1  dist@2  dist@3  dist@4  extreme  \
      .7747   .2990   .1086  .04707   .0251  .04452   .3119   .6194   .7993    .5861   
      f1  gen_loss  greedy  intra_dist@1  intra_dist@2  intra_dist@3  intra_dist@4  \
   .3529       4.7   .6657         .8890         .9766         .9601         .9172   
     ppl  rouge1  rouge2  rougeL  
   109.9   .3860  .09002   .3729[0m
[32m2025-02-05 05:42:23.639[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m163[0m - [1m[Conversation epoch 32][0m
[32m2025-02-05 05:42:23.639[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m164[0m - [1m[Train][0m
  0%|          | 0/92414 [00:00<?, ?it/s]100%|██████████| 92414/92414 [00:00<00:00, 993060.61it/s]
[32m2025-02-05 05:42:23.732[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/358 [00:00<?, ?it/s]  0%|          | 1/358 [00:00<00:36,  9.73it/s]  1%|          | 3/358 [00:00<00:35,  9.92it/s]  1%|          | 4/358 [00:00<00:35,  9.89it/s]  2%|▏         | 6/358 [00:00<00:35,  9.85it/s]  2%|▏         | 7/358 [00:00<00:35,  9.79it/s]  2%|▏         | 8/358 [00:00<00:35,  9.84it/s]  3%|▎         | 9/358 [00:00<00:35,  9.74it/s]  3%|▎         | 10/358 [00:01<00:35,  9.73it/s]  3%|▎         | 11/358 [00:01<00:35,  9.68it/s]  4%|▎         | 13/358 [00:01<00:34,  9.90it/s]  4%|▍         | 14/358 [00:01<00:34,  9.83it/s]  4%|▍         | 15/358 [00:01<00:35,  9.75it/s]  4%|▍         | 16/358 [00:01<00:35,  9.69it/s]  5%|▍         | 17/358 [00:01<00:35,  9.71it/s]  5%|▌         | 18/358 [00:01<00:34,  9.78it/s]  5%|▌         | 19/358 [00:01<00:34,  9.71it/s]  6%|▌         | 20/358 [00:02<00:35,  9.65it/s]  6%|▌         | 21/358 [00:02<00:35,  9.58it/s]  6%|▌         | 22/358 [00:02<00:34,  9.66it/s]  7%|▋         | 24/358 [00:02<00:34,  9.75it/s]  7%|▋         | 25/358 [00:02<00:34,  9.70it/s]  7%|▋         | 26/358 [00:02<00:34,  9.65it/s]  8%|▊         | 27/358 [00:02<00:34,  9.71it/s]  8%|▊         | 28/358 [00:02<00:34,  9.66it/s]  8%|▊         | 29/358 [00:02<00:34,  9.63it/s]  9%|▊         | 31/358 [00:03<00:33,  9.73it/s]  9%|▉         | 32/358 [00:03<00:33,  9.72it/s]  9%|▉         | 34/358 [00:03<00:32,  9.83it/s] 10%|█         | 36/358 [00:03<00:32,  9.83it/s] 10%|█         | 37/358 [00:03<00:32,  9.81it/s] 11%|█         | 38/358 [00:03<00:32,  9.77it/s] 11%|█         | 40/358 [00:04<00:32,  9.93it/s] 11%|█▏        | 41/358 [00:04<00:32,  9.84it/s] 12%|█▏        | 43/358 [00:04<00:31,  9.87it/s] 13%|█▎        | 45/358 [00:04<00:31,  9.96it/s] 13%|█▎        | 47/358 [00:04<00:31,  9.93it/s] 13%|█▎        | 48/358 [00:04<00:31,  9.92it/s] 14%|█▍        | 50/358 [00:05<00:31,  9.90it/s] 14%|█▍        | 51/358 [00:05<00:31,  9.83it/s] 15%|█▍        | 52/358 [00:05<00:31,  9.74it/s] 15%|█▍        | 53/358 [00:05<00:31,  9.69it/s] 15%|█▌        | 54/358 [00:05<00:31,  9.73it/s] 15%|█▌        | 55/358 [00:05<00:31,  9.68it/s] 16%|█▌        | 56/358 [00:05<00:31,  9.72it/s] 16%|█▌        | 57/358 [00:05<00:31,  9.68it/s] 16%|█▌        | 58/358 [00:05<00:31,  9.66it/s] 16%|█▋        | 59/358 [00:06<00:31,  9.62it/s] 17%|█▋        | 61/358 [00:06<00:30,  9.71it/s] 17%|█▋        | 62/358 [00:06<00:30,  9.63it/s] 18%|█▊        | 63/358 [00:06<00:30,  9.70it/s] 18%|█▊        | 64/358 [00:06<00:30,  9.65it/s] 18%|█▊        | 66/358 [00:06<00:30,  9.72it/s] 19%|█▊        | 67/358 [00:06<00:29,  9.71it/s] 19%|█▉        | 69/358 [00:07<00:29,  9.76it/s] 20%|█▉        | 70/358 [00:07<00:29,  9.71it/s] 20%|█▉        | 71/358 [00:07<00:29,  9.75it/s] 20%|██        | 72/358 [00:07<00:29,  9.70it/s] 20%|██        | 73/358 [00:07<00:29,  9.67it/s] 21%|██        | 74/358 [00:07<00:29,  9.64it/s] 21%|██        | 75/358 [00:07<00:29,  9.60it/s] 21%|██        | 76/358 [00:07<00:29,  9.71it/s] 22%|██▏       | 77/358 [00:07<00:29,  9.68it/s] 22%|██▏       | 79/358 [00:08<00:28,  9.68it/s] 23%|██▎       | 81/358 [00:08<00:28,  9.74it/s] 23%|██▎       | 83/358 [00:08<00:28,  9.77it/s] 23%|██▎       | 84/358 [00:08<00:28,  9.71it/s] 24%|██▎       | 85/358 [00:08<00:28,  9.67it/s] 24%|██▍       | 86/358 [00:08<00:28,  9.65it/s] 24%|██▍       | 87/358 [00:08<00:28,  9.64it/s] 25%|██▍       | 88/358 [00:09<00:27,  9.66it/s] 25%|██▌       | 90/358 [00:09<00:27,  9.89it/s] 26%|██▌       | 92/358 [00:09<00:26,  9.99it/s] 26%|██▌       | 93/358 [00:09<00:26,  9.96it/s] 26%|██▋       | 94/358 [00:09<00:26,  9.87it/s] 27%|██▋       | 96/358 [00:09<00:25, 10.15it/s] 27%|██▋       | 98/358 [00:10<00:25, 10.03it/s] 28%|██▊       | 99/358 [00:10<00:26,  9.94it/s] 28%|██▊       | 101/358 [00:10<00:25,  9.91it/s] 29%|██▉       | 103/358 [00:10<00:25,  9.90it/s] 29%|██▉       | 104/358 [00:10<00:25,  9.85it/s] 29%|██▉       | 105/358 [00:10<00:25,  9.77it/s] 30%|██▉       | 106/358 [00:10<00:25,  9.76it/s] 30%|███       | 108/358 [00:11<00:25,  9.79it/s] 30%|███       | 109/358 [00:11<00:25,  9.70it/s] 31%|███       | 110/358 [00:11<00:25,  9.68it/s] 31%|███       | 111/358 [00:11<00:25,  9.64it/s] 32%|███▏      | 113/358 [00:11<00:24,  9.91it/s] 32%|███▏      | 114/358 [00:11<00:24,  9.86it/s] 32%|███▏      | 115/358 [00:11<00:24,  9.77it/s] 32%|███▏      | 116/358 [00:11<00:24,  9.69it/s] 33%|███▎      | 117/358 [00:11<00:24,  9.66it/s] 33%|███▎      | 119/358 [00:12<00:24,  9.77it/s] 34%|███▍      | 121/358 [00:12<00:23,  9.97it/s] 34%|███▍      | 123/358 [00:12<00:23, 10.07it/s] 35%|███▍      | 125/358 [00:12<00:23, 10.04it/s] 35%|███▌      | 126/358 [00:12<00:23, 10.01it/s] 35%|███▌      | 127/358 [00:12<00:23,  9.96it/s] 36%|███▌      | 128/358 [00:13<00:23,  9.91it/s] 36%|███▋      | 130/358 [00:13<00:22,  9.98it/s] 37%|███▋      | 131/358 [00:13<00:22,  9.87it/s] 37%|███▋      | 132/358 [00:13<00:22,  9.90it/s] 37%|███▋      | 134/358 [00:13<00:22,  9.92it/s] 38%|███▊      | 135/358 [00:13<00:22,  9.86it/s] 38%|███▊      | 137/358 [00:13<00:22,  9.95it/s] 39%|███▊      | 138/358 [00:14<00:22,  9.93it/s] 39%|███▉      | 139/358 [00:14<00:22,  9.85it/s] 39%|███▉      | 141/358 [00:14<00:21,  9.97it/s] 40%|███▉      | 142/358 [00:14<00:21,  9.89it/s] 40%|███▉      | 143/358 [00:14<00:21,  9.86it/s] 40%|████      | 144/358 [00:14<00:21,  9.77it/s] 41%|████      | 145/358 [00:14<00:21,  9.79it/s] 41%|████      | 146/358 [00:14<00:21,  9.73it/s] 41%|████      | 147/358 [00:15<00:21,  9.67it/s] 41%|████▏     | 148/358 [00:15<00:21,  9.70it/s] 42%|████▏     | 149/358 [00:15<00:21,  9.68it/s] 42%|████▏     | 150/358 [00:15<00:21,  9.64it/s] 42%|████▏     | 151/358 [00:15<00:22,  9.38it/s] 42%|████▏     | 152/358 [00:15<00:21,  9.42it/s] 43%|████▎     | 153/358 [00:15<00:21,  9.44it/s] 43%|████▎     | 154/358 [00:15<00:21,  9.53it/s] 43%|████▎     | 155/358 [00:15<00:21,  9.54it/s] 44%|████▎     | 156/358 [00:15<00:20,  9.67it/s] 44%|████▍     | 157/358 [00:16<00:20,  9.61it/s] 44%|████▍     | 158/358 [00:16<00:20,  9.69it/s] 44%|████▍     | 159/358 [00:16<00:20,  9.69it/s] 45%|████▍     | 160/358 [00:16<00:20,  9.70it/s] 45%|████▌     | 162/358 [00:16<00:19,  9.99it/s] 46%|████▌     | 164/358 [00:16<00:19,  9.99it/s] 46%|████▌     | 165/358 [00:16<00:19,  9.95it/s] 47%|████▋     | 167/358 [00:17<00:19,  9.90it/s] 47%|████▋     | 169/358 [00:17<00:19,  9.93it/s] 48%|████▊     | 171/358 [00:17<00:18,  9.91it/s] 48%|████▊     | 172/358 [00:17<00:18,  9.86it/s] 48%|████▊     | 173/358 [00:17<00:18,  9.80it/s] 49%|████▉     | 175/358 [00:17<00:18,  9.82it/s] 49%|████▉     | 176/358 [00:17<00:18,  9.83it/s] 49%|████▉     | 177/358 [00:18<00:18,  9.82it/s] 50%|█████     | 179/358 [00:18<00:18,  9.85it/s] 50%|█████     | 180/358 [00:18<00:18,  9.78it/s] 51%|█████     | 182/358 [00:18<00:17,  9.92it/s] 51%|█████     | 183/358 [00:18<00:17,  9.88it/s] 51%|█████▏    | 184/358 [00:18<00:17,  9.77it/s] 52%|█████▏    | 185/358 [00:18<00:17,  9.71it/s] 52%|█████▏    | 187/358 [00:19<00:17,  9.93it/s] 53%|█████▎    | 188/358 [00:19<00:17,  9.87it/s] 53%|█████▎    | 189/358 [00:19<00:17,  9.82it/s] 53%|█████▎    | 190/358 [00:19<00:17,  9.86it/s] 53%|█████▎    | 191/358 [00:19<00:17,  9.70it/s] 54%|█████▎    | 192/358 [00:19<00:17,  9.65it/s] 54%|█████▍    | 193/358 [00:19<00:17,  9.65it/s] 54%|█████▍    | 194/358 [00:19<00:17,  9.64it/s] 54%|█████▍    | 195/358 [00:19<00:16,  9.72it/s] 55%|█████▌    | 197/358 [00:20<00:16,  9.91it/s] 55%|█████▌    | 198/358 [00:20<00:16,  9.83it/s] 56%|█████▌    | 199/358 [00:20<00:16,  9.86it/s] 56%|█████▌    | 200/358 [00:20<00:16,  9.79it/s] 56%|█████▌    | 201/358 [00:20<00:16,  9.75it/s] 57%|█████▋    | 203/358 [00:20<00:15,  9.84it/s] 57%|█████▋    | 204/358 [00:20<00:15,  9.74it/s] 57%|█████▋    | 205/358 [00:20<00:15,  9.69it/s] 58%|█████▊    | 207/358 [00:21<00:15,  9.86it/s] 58%|█████▊    | 208/358 [00:21<00:15,  9.79it/s] 59%|█████▊    | 210/358 [00:21<00:15,  9.81it/s] 59%|█████▉    | 212/358 [00:21<00:14,  9.80it/s] 60%|█████▉    | 214/358 [00:21<00:14,  9.88it/s] 60%|██████    | 215/358 [00:21<00:14,  9.82it/s] 60%|██████    | 216/358 [00:22<00:14,  9.75it/s] 61%|██████    | 217/358 [00:22<00:14,  9.79it/s] 61%|██████    | 218/358 [00:22<00:14,  9.76it/s] 61%|██████    | 219/358 [00:22<00:14,  9.76it/s] 62%|██████▏   | 221/358 [00:22<00:13,  9.89it/s] 62%|██████▏   | 222/358 [00:22<00:13,  9.79it/s] 62%|██████▏   | 223/358 [00:22<00:13,  9.73it/s] 63%|██████▎   | 224/358 [00:22<00:13,  9.68it/s] 63%|██████▎   | 225/358 [00:22<00:13,  9.76it/s] 63%|██████▎   | 226/358 [00:23<00:13,  9.71it/s] 64%|██████▎   | 228/358 [00:23<00:13,  9.75it/s] 64%|██████▍   | 229/358 [00:23<00:13,  9.72it/s] 64%|██████▍   | 230/358 [00:23<00:13,  9.67it/s] 65%|██████▍   | 232/358 [00:23<00:12,  9.72it/s] 65%|██████▌   | 234/358 [00:23<00:12, 10.01it/s] 66%|██████▌   | 236/358 [00:24<00:12,  9.97it/s] 66%|██████▋   | 238/358 [00:24<00:11, 10.02it/s] 67%|██████▋   | 240/358 [00:24<00:11,  9.98it/s] 68%|██████▊   | 242/358 [00:24<00:11,  9.96it/s] 68%|██████▊   | 243/358 [00:24<00:11,  9.90it/s] 68%|██████▊   | 244/358 [00:24<00:11,  9.83it/s] 69%|██████▊   | 246/358 [00:25<00:11,  9.86it/s] 69%|██████▉   | 247/358 [00:25<00:11,  9.78it/s] 69%|██████▉   | 248/358 [00:25<00:11,  9.74it/s] 70%|██████▉   | 250/358 [00:25<00:10,  9.84it/s] 70%|███████   | 251/358 [00:25<00:10,  9.78it/s] 70%|███████   | 252/358 [00:25<00:10,  9.70it/s] 71%|███████   | 253/358 [00:25<00:10,  9.67it/s] 71%|███████   | 254/358 [00:25<00:10,  9.64it/s] 72%|███████▏  | 256/358 [00:26<00:10,  9.81it/s] 72%|███████▏  | 257/358 [00:26<00:10,  9.82it/s] 72%|███████▏  | 258/358 [00:26<00:10,  9.69it/s] 72%|███████▏  | 259/358 [00:26<00:10,  9.66it/s] 73%|███████▎  | 260/358 [00:26<00:10,  9.70it/s] 73%|███████▎  | 262/358 [00:26<00:09,  9.88it/s] 74%|███████▎  | 264/358 [00:26<00:09,  9.90it/s] 74%|███████▍  | 266/358 [00:27<00:09,  9.89it/s] 75%|███████▍  | 267/358 [00:27<00:09,  9.83it/s] 75%|███████▌  | 269/358 [00:27<00:08,  9.89it/s] 75%|███████▌  | 270/358 [00:27<00:08,  9.82it/s] 76%|███████▌  | 271/358 [00:27<00:08,  9.74it/s] 76%|███████▌  | 272/358 [00:27<00:08,  9.72it/s] 76%|███████▋  | 273/358 [00:27<00:08,  9.62it/s] 77%|███████▋  | 274/358 [00:27<00:08,  9.62it/s] 77%|███████▋  | 275/358 [00:28<00:08,  9.67it/s] 77%|███████▋  | 276/358 [00:28<00:08,  9.67it/s] 77%|███████▋  | 277/358 [00:28<00:08,  9.65it/s] 78%|███████▊  | 278/358 [00:28<00:08,  9.62it/s] 78%|███████▊  | 280/358 [00:28<00:07,  9.81it/s] 78%|███████▊  | 281/358 [00:28<00:07,  9.82it/s] 79%|███████▉  | 282/358 [00:28<00:07,  9.76it/s] 79%|███████▉  | 283/358 [00:28<00:07,  9.70it/s] 79%|███████▉  | 284/358 [00:29<00:07,  9.66it/s] 80%|███████▉  | 285/358 [00:29<00:07,  9.73it/s] 80%|███████▉  | 286/358 [00:29<00:07,  9.68it/s] 80%|████████  | 287/358 [00:29<00:07,  9.66it/s] 80%|████████  | 288/358 [00:29<00:07,  9.62it/s] 81%|████████  | 290/358 [00:29<00:06,  9.83it/s] 81%|████████▏ | 291/358 [00:29<00:06,  9.82it/s] 82%|████████▏ | 293/358 [00:29<00:06,  9.83it/s] 82%|████████▏ | 295/358 [00:30<00:06,  9.90it/s] 83%|████████▎ | 296/358 [00:30<00:06,  9.83it/s] 83%|████████▎ | 297/358 [00:30<00:06,  9.72it/s] 84%|████████▎ | 299/358 [00:30<00:05,  9.88it/s] 84%|████████▍ | 301/358 [00:30<00:05,  9.92it/s] 84%|████████▍ | 302/358 [00:30<00:05,  9.85it/s] 85%|████████▍ | 303/358 [00:30<00:05,  9.86it/s] 85%|████████▌ | 305/358 [00:31<00:05,  9.89it/s] 85%|████████▌ | 306/358 [00:31<00:05,  9.81it/s] 86%|████████▌ | 308/358 [00:31<00:05,  9.91it/s] 86%|████████▋ | 309/358 [00:31<00:04,  9.81it/s] 87%|████████▋ | 310/358 [00:31<00:04,  9.76it/s] 87%|████████▋ | 311/358 [00:31<00:04,  9.68it/s] 87%|████████▋ | 312/358 [00:31<00:04,  9.69it/s] 87%|████████▋ | 313/358 [00:31<00:04,  9.71it/s] 88%|████████▊ | 315/358 [00:32<00:04,  9.97it/s] 88%|████████▊ | 316/358 [00:32<00:04,  9.92it/s] 89%|████████▊ | 317/358 [00:32<00:04,  9.84it/s] 89%|████████▉ | 318/358 [00:32<00:04,  9.79it/s] 89%|████████▉ | 319/358 [00:32<00:04,  9.74it/s] 89%|████████▉ | 320/358 [00:32<00:03,  9.80it/s] 90%|████████▉ | 321/358 [00:32<00:03,  9.73it/s] 90%|████████▉ | 322/358 [00:32<00:03,  9.69it/s] 90%|█████████ | 323/358 [00:32<00:03,  9.65it/s] 91%|█████████ | 324/358 [00:33<00:03,  9.62it/s] 91%|█████████ | 325/358 [00:33<00:03,  9.60it/s] 91%|█████████▏| 327/358 [00:33<00:03,  9.96it/s] 92%|█████████▏| 329/358 [00:33<00:02, 10.06it/s] 92%|█████████▏| 330/358 [00:33<00:02,  9.94it/s] 93%|█████████▎| 332/358 [00:33<00:02, 10.04it/s] 93%|█████████▎| 334/358 [00:34<00:02,  9.95it/s] 94%|█████████▎| 335/358 [00:34<00:02,  9.83it/s] 94%|█████████▍| 337/358 [00:34<00:02,  9.90it/s] 95%|█████████▍| 339/358 [00:34<00:01, 10.10it/s] 95%|█████████▌| 341/358 [00:34<00:01, 10.05it/s] 96%|█████████▌| 343/358 [00:34<00:01,  9.89it/s] 96%|█████████▌| 344/358 [00:35<00:01,  9.83it/s] 96%|█████████▋| 345/358 [00:35<00:01,  9.85it/s] 97%|█████████▋| 347/358 [00:35<00:01, 10.03it/s] 97%|█████████▋| 348/358 [00:35<00:01,  9.93it/s] 97%|█████████▋| 349/358 [00:35<00:00,  9.84it/s] 98%|█████████▊| 350/358 [00:35<00:00,  9.77it/s] 98%|█████████▊| 351/358 [00:35<00:00,  9.73it/s] 99%|█████████▊| 353/358 [00:36<00:00,  9.91it/s] 99%|█████████▉| 354/358 [00:36<00:00,  9.89it/s] 99%|█████████▉| 355/358 [00:36<00:00,  9.80it/s]100%|█████████▉| 357/358 [00:36<00:00,  9.86it/s]100%|██████████| 358/358 [00:36<00:00,  9.81it/s]
[32m2025-02-05 05:43:00.220[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    gen_loss  grad clip ratio  grad norm   ppl
       2.115                1       3.99 8.287[0m
[32m2025-02-05 05:43:00.220[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m169[0m - [1m[Valid][0m
  0%|          | 0/10256 [00:00<?, ?it/s]100%|██████████| 10256/10256 [00:00<00:00, 1089363.40it/s]
[32m2025-02-05 05:43:00.230[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:27,  1.44it/s]  5%|▌         | 2/40 [00:01<00:26,  1.45it/s]  8%|▊         | 3/40 [00:02<00:25,  1.45it/s] 10%|█         | 4/40 [00:02<00:24,  1.46it/s] 12%|█▎        | 5/40 [00:03<00:24,  1.44it/s] 15%|█▌        | 6/40 [00:04<00:23,  1.44it/s] 18%|█▊        | 7/40 [00:04<00:22,  1.45it/s] 20%|██        | 8/40 [00:05<00:21,  1.45it/s] 22%|██▎       | 9/40 [00:06<00:21,  1.45it/s] 25%|██▌       | 10/40 [00:06<00:20,  1.45it/s] 28%|██▊       | 11/40 [00:07<00:19,  1.45it/s] 30%|███       | 12/40 [00:08<00:19,  1.45it/s] 32%|███▎      | 13/40 [00:08<00:18,  1.45it/s] 35%|███▌      | 14/40 [00:09<00:18,  1.44it/s] 38%|███▊      | 15/40 [00:10<00:17,  1.44it/s] 40%|████      | 16/40 [00:11<00:16,  1.44it/s] 42%|████▎     | 17/40 [00:11<00:15,  1.44it/s] 45%|████▌     | 18/40 [00:12<00:15,  1.45it/s] 48%|████▊     | 19/40 [00:13<00:14,  1.45it/s] 50%|█████     | 20/40 [00:13<00:13,  1.45it/s] 52%|█████▎    | 21/40 [00:14<00:13,  1.46it/s] 55%|█████▌    | 22/40 [00:15<00:12,  1.45it/s] 57%|█████▊    | 23/40 [00:15<00:11,  1.45it/s] 60%|██████    | 24/40 [00:16<00:11,  1.45it/s] 62%|██████▎   | 25/40 [00:17<00:10,  1.44it/s] 65%|██████▌   | 26/40 [00:17<00:09,  1.46it/s] 68%|██████▊   | 27/40 [00:18<00:08,  1.46it/s] 70%|███████   | 28/40 [00:19<00:08,  1.46it/s] 72%|███████▎  | 29/40 [00:19<00:07,  1.45it/s] 75%|███████▌  | 30/40 [00:20<00:06,  1.46it/s] 78%|███████▊  | 31/40 [00:21<00:06,  1.46it/s] 80%|████████  | 32/40 [00:22<00:05,  1.46it/s] 82%|████████▎ | 33/40 [00:22<00:04,  1.45it/s] 85%|████████▌ | 34/40 [00:23<00:04,  1.46it/s] 88%|████████▊ | 35/40 [00:24<00:03,  1.45it/s] 90%|█████████ | 36/40 [00:24<00:02,  1.45it/s] 92%|█████████▎| 37/40 [00:25<00:02,  1.45it/s] 95%|█████████▌| 38/40 [00:26<00:01,  1.44it/s] 98%|█████████▊| 39/40 [00:26<00:00,  1.44it/s]100%|██████████| 40/40 [00:27<00:00,  1.59it/s]100%|██████████| 40/40 [00:27<00:00,  1.46it/s]
[32m2025-02-05 05:43:27.608[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    average  bleu@1  bleu@2  bleu@3  bleu@4  dist@1  dist@2  dist@3  dist@4  extreme  \
      .7723   .2932   .1047  .04118  .01887  .04687   .3239   .6255   .7972    .5856   
      f1  gen_loss  greedy  intra_dist@1  intra_dist@2  intra_dist@3  intra_dist@4  \
   .3460      4.72   .6622         .8746         .9714         .9595         .9267   
     ppl  rouge1  rouge2  rougeL  
   112.2   .3780  .08544   .3662[0m
[32m2025-02-05 05:43:27.615[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m163[0m - [1m[Conversation epoch 33][0m
[32m2025-02-05 05:43:27.615[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m164[0m - [1m[Train][0m
  0%|          | 0/92414 [00:00<?, ?it/s]100%|██████████| 92414/92414 [00:00<00:00, 998748.80it/s]
[32m2025-02-05 05:43:27.708[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/358 [00:00<?, ?it/s]  0%|          | 1/358 [00:00<00:36,  9.73it/s]  1%|          | 3/358 [00:00<00:35,  9.91it/s]  1%|          | 4/358 [00:00<00:35,  9.90it/s]  2%|▏         | 6/358 [00:00<00:35,  9.86it/s]  2%|▏         | 7/358 [00:00<00:35,  9.80it/s]  2%|▏         | 8/358 [00:00<00:35,  9.84it/s]  3%|▎         | 9/358 [00:00<00:35,  9.74it/s]  3%|▎         | 10/358 [00:01<00:35,  9.73it/s]  3%|▎         | 11/358 [00:01<00:35,  9.68it/s]  4%|▎         | 13/358 [00:01<00:34,  9.90it/s]  4%|▍         | 14/358 [00:01<00:34,  9.83it/s]  4%|▍         | 15/358 [00:01<00:35,  9.75it/s]  4%|▍         | 16/358 [00:01<00:35,  9.69it/s]  5%|▍         | 17/358 [00:01<00:35,  9.70it/s]  5%|▌         | 18/358 [00:01<00:34,  9.78it/s]  5%|▌         | 19/358 [00:01<00:34,  9.71it/s]  6%|▌         | 20/358 [00:02<00:35,  9.65it/s]  6%|▌         | 21/358 [00:02<00:35,  9.59it/s]  6%|▌         | 22/358 [00:02<00:34,  9.65it/s]  7%|▋         | 24/358 [00:02<00:34,  9.75it/s]  7%|▋         | 25/358 [00:02<00:34,  9.70it/s]  7%|▋         | 26/358 [00:02<00:34,  9.65it/s]  8%|▊         | 27/358 [00:02<00:34,  9.71it/s]  8%|▊         | 28/358 [00:02<00:34,  9.67it/s]  8%|▊         | 29/358 [00:02<00:34,  9.63it/s]  9%|▊         | 31/358 [00:03<00:33,  9.74it/s]  9%|▉         | 32/358 [00:03<00:33,  9.73it/s]  9%|▉         | 34/358 [00:03<00:32,  9.83it/s] 10%|█         | 36/358 [00:03<00:32,  9.83it/s] 10%|█         | 37/358 [00:03<00:32,  9.82it/s] 11%|█         | 38/358 [00:03<00:32,  9.77it/s] 11%|█         | 40/358 [00:04<00:32,  9.93it/s] 11%|█▏        | 41/358 [00:04<00:32,  9.84it/s] 12%|█▏        | 43/358 [00:04<00:31,  9.87it/s] 13%|█▎        | 45/358 [00:04<00:31,  9.96it/s] 13%|█▎        | 47/358 [00:04<00:31,  9.94it/s] 13%|█▎        | 48/358 [00:04<00:31,  9.92it/s] 14%|█▍        | 50/358 [00:05<00:31,  9.90it/s] 14%|█▍        | 51/358 [00:05<00:31,  9.83it/s] 15%|█▍        | 52/358 [00:05<00:31,  9.74it/s] 15%|█▍        | 53/358 [00:05<00:31,  9.69it/s] 15%|█▌        | 54/358 [00:05<00:31,  9.73it/s] 15%|█▌        | 55/358 [00:05<00:31,  9.67it/s] 16%|█▌        | 56/358 [00:05<00:31,  9.71it/s] 16%|█▌        | 57/358 [00:05<00:31,  9.67it/s] 16%|█▌        | 58/358 [00:05<00:31,  9.65it/s] 16%|█▋        | 59/358 [00:06<00:31,  9.62it/s] 17%|█▋        | 61/358 [00:06<00:30,  9.71it/s] 17%|█▋        | 62/358 [00:06<00:30,  9.63it/s] 18%|█▊        | 63/358 [00:06<00:30,  9.69it/s] 18%|█▊        | 64/358 [00:06<00:30,  9.65it/s] 18%|█▊        | 66/358 [00:06<00:30,  9.72it/s] 19%|█▊        | 67/358 [00:06<00:30,  9.70it/s] 19%|█▉        | 69/358 [00:07<00:29,  9.76it/s] 20%|█▉        | 70/358 [00:07<00:29,  9.71it/s] 20%|█▉        | 71/358 [00:07<00:29,  9.75it/s] 20%|██        | 72/358 [00:07<00:29,  9.70it/s] 20%|██        | 73/358 [00:07<00:29,  9.67it/s] 21%|██        | 74/358 [00:07<00:29,  9.64it/s] 21%|██        | 75/358 [00:07<00:29,  9.60it/s] 21%|██        | 76/358 [00:07<00:29,  9.71it/s] 22%|██▏       | 77/358 [00:07<00:29,  9.67it/s] 22%|██▏       | 79/358 [00:08<00:28,  9.68it/s] 23%|██▎       | 81/358 [00:08<00:28,  9.74it/s] 23%|██▎       | 83/358 [00:08<00:28,  9.77it/s] 23%|██▎       | 84/358 [00:08<00:28,  9.72it/s] 24%|██▎       | 85/358 [00:08<00:28,  9.67it/s] 24%|██▍       | 86/358 [00:08<00:28,  9.66it/s] 24%|██▍       | 87/358 [00:08<00:28,  9.64it/s] 25%|██▍       | 88/358 [00:09<00:27,  9.66it/s] 25%|██▌       | 90/358 [00:09<00:27,  9.90it/s] 26%|██▌       | 92/358 [00:09<00:26,  9.99it/s] 26%|██▌       | 93/358 [00:09<00:26,  9.96it/s] 26%|██▋       | 94/358 [00:09<00:26,  9.88it/s] 27%|██▋       | 96/358 [00:09<00:25, 10.15it/s] 27%|██▋       | 98/358 [00:10<00:25, 10.04it/s] 28%|██▊       | 99/358 [00:10<00:26,  9.95it/s] 28%|██▊       | 101/358 [00:10<00:25,  9.92it/s] 29%|██▉       | 103/358 [00:10<00:25,  9.91it/s] 29%|██▉       | 104/358 [00:10<00:25,  9.86it/s] 29%|██▉       | 105/358 [00:10<00:25,  9.78it/s] 30%|██▉       | 106/358 [00:10<00:25,  9.76it/s] 30%|███       | 108/358 [00:11<00:25,  9.79it/s] 30%|███       | 109/358 [00:11<00:25,  9.70it/s] 31%|███       | 110/358 [00:11<00:25,  9.68it/s] 31%|███       | 111/358 [00:11<00:25,  9.64it/s] 32%|███▏      | 113/358 [00:11<00:24,  9.90it/s] 32%|███▏      | 114/358 [00:11<00:24,  9.86it/s] 32%|███▏      | 115/358 [00:11<00:24,  9.77it/s] 32%|███▏      | 116/358 [00:11<00:24,  9.68it/s] 33%|███▎      | 117/358 [00:11<00:24,  9.65it/s] 33%|███▎      | 119/358 [00:12<00:24,  9.77it/s] 34%|███▍      | 121/358 [00:12<00:23,  9.97it/s] 34%|███▍      | 123/358 [00:12<00:23, 10.07it/s] 35%|███▍      | 125/358 [00:12<00:23, 10.05it/s] 35%|███▌      | 126/358 [00:12<00:23, 10.01it/s] 35%|███▌      | 127/358 [00:12<00:23,  9.96it/s] 36%|███▌      | 128/358 [00:13<00:23,  9.91it/s] 36%|███▋      | 130/358 [00:13<00:22,  9.97it/s] 37%|███▋      | 131/358 [00:13<00:22,  9.87it/s] 37%|███▋      | 132/358 [00:13<00:22,  9.90it/s] 37%|███▋      | 134/358 [00:13<00:22,  9.92it/s] 38%|███▊      | 135/358 [00:13<00:22,  9.86it/s] 38%|███▊      | 137/358 [00:13<00:22,  9.95it/s] 39%|███▊      | 138/358 [00:14<00:22,  9.93it/s] 39%|███▉      | 139/358 [00:14<00:22,  9.84it/s] 39%|███▉      | 141/358 [00:14<00:21,  9.97it/s] 40%|███▉      | 142/358 [00:14<00:21,  9.89it/s] 40%|███▉      | 143/358 [00:14<00:21,  9.86it/s] 40%|████      | 144/358 [00:14<00:21,  9.77it/s] 41%|████      | 145/358 [00:14<00:21,  9.78it/s] 41%|████      | 146/358 [00:14<00:21,  9.72it/s] 41%|████      | 147/358 [00:15<00:21,  9.66it/s] 41%|████▏     | 148/358 [00:15<00:21,  9.70it/s] 42%|████▏     | 149/358 [00:15<00:21,  9.67it/s] 42%|████▏     | 150/358 [00:15<00:21,  9.63it/s] 42%|████▏     | 151/358 [00:15<00:22,  9.37it/s] 42%|████▏     | 152/358 [00:15<00:21,  9.41it/s] 43%|████▎     | 153/358 [00:15<00:21,  9.44it/s] 43%|████▎     | 154/358 [00:15<00:21,  9.53it/s] 43%|████▎     | 155/358 [00:15<00:21,  9.54it/s] 44%|████▎     | 156/358 [00:15<00:20,  9.67it/s] 44%|████▍     | 157/358 [00:16<00:20,  9.61it/s] 44%|████▍     | 158/358 [00:16<00:20,  9.69it/s] 44%|████▍     | 159/358 [00:16<00:20,  9.68it/s] 45%|████▍     | 160/358 [00:16<00:20,  9.69it/s] 45%|████▌     | 162/358 [00:16<00:19,  9.99it/s] 46%|████▌     | 164/358 [00:16<00:19,  9.99it/s] 46%|████▌     | 165/358 [00:16<00:19,  9.95it/s] 47%|████▋     | 167/358 [00:17<00:19,  9.89it/s] 47%|████▋     | 169/358 [00:17<00:19,  9.93it/s] 48%|████▊     | 171/358 [00:17<00:18,  9.92it/s] 48%|████▊     | 172/358 [00:17<00:18,  9.86it/s] 48%|████▊     | 173/358 [00:17<00:18,  9.80it/s] 49%|████▉     | 175/358 [00:17<00:18,  9.82it/s] 49%|████▉     | 176/358 [00:17<00:18,  9.84it/s] 49%|████▉     | 177/358 [00:18<00:18,  9.82it/s] 50%|█████     | 179/358 [00:18<00:18,  9.85it/s] 50%|█████     | 180/358 [00:18<00:18,  9.77it/s] 51%|█████     | 182/358 [00:18<00:17,  9.93it/s] 51%|█████     | 183/358 [00:18<00:17,  9.88it/s] 51%|█████▏    | 184/358 [00:18<00:17,  9.77it/s] 52%|█████▏    | 185/358 [00:18<00:17,  9.72it/s] 52%|█████▏    | 187/358 [00:19<00:17,  9.93it/s] 53%|█████▎    | 188/358 [00:19<00:17,  9.88it/s] 53%|█████▎    | 189/358 [00:19<00:17,  9.82it/s] 53%|█████▎    | 191/358 [00:19<00:17,  9.74it/s] 54%|█████▎    | 192/358 [00:19<00:17,  9.69it/s] 54%|█████▍    | 193/358 [00:19<00:17,  9.68it/s] 54%|█████▍    | 194/358 [00:19<00:16,  9.66it/s] 54%|█████▍    | 195/358 [00:19<00:16,  9.73it/s] 55%|█████▌    | 197/358 [00:20<00:16,  9.90it/s] 55%|█████▌    | 198/358 [00:20<00:16,  9.83it/s] 56%|█████▌    | 199/358 [00:20<00:16,  9.86it/s] 56%|█████▌    | 200/358 [00:20<00:16,  9.79it/s] 56%|█████▌    | 201/358 [00:20<00:16,  9.75it/s] 57%|█████▋    | 203/358 [00:20<00:15,  9.84it/s] 57%|█████▋    | 204/358 [00:20<00:15,  9.74it/s] 57%|█████▋    | 205/358 [00:20<00:15,  9.70it/s] 58%|█████▊    | 207/358 [00:21<00:15,  9.86it/s] 58%|█████▊    | 208/358 [00:21<00:15,  9.79it/s] 59%|█████▊    | 210/358 [00:21<00:15,  9.81it/s] 59%|█████▉    | 212/358 [00:21<00:14,  9.80it/s] 60%|█████▉    | 214/358 [00:21<00:14,  9.88it/s] 60%|██████    | 215/358 [00:21<00:14,  9.82it/s] 60%|██████    | 216/358 [00:22<00:14,  9.75it/s] 61%|██████    | 217/358 [00:22<00:14,  9.79it/s] 61%|██████    | 218/358 [00:22<00:14,  9.76it/s] 61%|██████    | 219/358 [00:22<00:14,  9.76it/s] 62%|██████▏   | 221/358 [00:22<00:13,  9.90it/s] 62%|██████▏   | 222/358 [00:22<00:13,  9.79it/s] 62%|██████▏   | 223/358 [00:22<00:13,  9.74it/s] 63%|██████▎   | 224/358 [00:22<00:13,  9.68it/s] 63%|██████▎   | 225/358 [00:22<00:13,  9.76it/s] 63%|██████▎   | 226/358 [00:23<00:13,  9.71it/s] 64%|██████▎   | 228/358 [00:23<00:13,  9.75it/s] 64%|██████▍   | 229/358 [00:23<00:13,  9.72it/s] 64%|██████▍   | 230/358 [00:23<00:13,  9.67it/s] 65%|██████▍   | 232/358 [00:23<00:12,  9.72it/s] 65%|██████▌   | 234/358 [00:23<00:12, 10.01it/s] 66%|██████▌   | 236/358 [00:24<00:12,  9.97it/s] 66%|██████▋   | 238/358 [00:24<00:11, 10.03it/s] 67%|██████▋   | 240/358 [00:24<00:11,  9.99it/s] 68%|██████▊   | 242/358 [00:24<00:11,  9.97it/s] 68%|██████▊   | 243/358 [00:24<00:11,  9.90it/s] 68%|██████▊   | 244/358 [00:24<00:11,  9.84it/s] 69%|██████▊   | 246/358 [00:25<00:11,  9.86it/s] 69%|██████▉   | 247/358 [00:25<00:11,  9.79it/s] 69%|██████▉   | 248/358 [00:25<00:11,  9.74it/s] 70%|██████▉   | 250/358 [00:25<00:10,  9.84it/s] 70%|███████   | 251/358 [00:25<00:10,  9.77it/s] 70%|███████   | 252/358 [00:25<00:10,  9.71it/s] 71%|███████   | 253/358 [00:25<00:10,  9.67it/s] 71%|███████   | 254/358 [00:25<00:10,  9.64it/s] 72%|███████▏  | 256/358 [00:26<00:10,  9.82it/s] 72%|███████▏  | 257/358 [00:26<00:10,  9.83it/s] 72%|███████▏  | 258/358 [00:26<00:10,  9.70it/s] 72%|███████▏  | 259/358 [00:26<00:10,  9.66it/s] 73%|███████▎  | 260/358 [00:26<00:10,  9.70it/s] 73%|███████▎  | 262/358 [00:26<00:09,  9.88it/s] 74%|███████▎  | 264/358 [00:26<00:09,  9.90it/s] 74%|███████▍  | 266/358 [00:27<00:09,  9.89it/s] 75%|███████▍  | 267/358 [00:27<00:09,  9.83it/s] 75%|███████▌  | 269/358 [00:27<00:09,  9.89it/s] 75%|███████▌  | 270/358 [00:27<00:08,  9.82it/s] 76%|███████▌  | 271/358 [00:27<00:08,  9.74it/s] 76%|███████▌  | 272/358 [00:27<00:08,  9.72it/s] 76%|███████▋  | 273/358 [00:27<00:08,  9.62it/s] 77%|███████▋  | 274/358 [00:27<00:08,  9.61it/s] 77%|███████▋  | 275/358 [00:28<00:08,  9.66it/s] 77%|███████▋  | 276/358 [00:28<00:08,  9.67it/s] 77%|███████▋  | 277/358 [00:28<00:08,  9.64it/s] 78%|███████▊  | 278/358 [00:28<00:08,  9.62it/s] 78%|███████▊  | 280/358 [00:28<00:07,  9.81it/s] 78%|███████▊  | 281/358 [00:28<00:07,  9.82it/s] 79%|███████▉  | 282/358 [00:28<00:07,  9.76it/s] 79%|███████▉  | 283/358 [00:28<00:07,  9.70it/s] 79%|███████▉  | 284/358 [00:28<00:07,  9.65it/s] 80%|███████▉  | 285/358 [00:29<00:07,  9.72it/s] 80%|███████▉  | 286/358 [00:29<00:07,  9.68it/s] 80%|████████  | 287/358 [00:29<00:07,  9.65it/s] 80%|████████  | 288/358 [00:29<00:07,  9.61it/s] 81%|████████  | 290/358 [00:29<00:06,  9.83it/s] 81%|████████▏ | 291/358 [00:29<00:06,  9.81it/s] 82%|████████▏ | 293/358 [00:29<00:06,  9.82it/s] 82%|████████▏ | 295/358 [00:30<00:06,  9.89it/s] 83%|████████▎ | 296/358 [00:30<00:06,  9.83it/s] 83%|████████▎ | 297/358 [00:30<00:06,  9.72it/s] 84%|████████▎ | 299/358 [00:30<00:05,  9.89it/s] 84%|████████▍ | 301/358 [00:30<00:05,  9.92it/s] 84%|████████▍ | 302/358 [00:30<00:05,  9.86it/s] 85%|████████▍ | 303/358 [00:30<00:05,  9.86it/s] 85%|████████▌ | 305/358 [00:31<00:05,  9.89it/s] 85%|████████▌ | 306/358 [00:31<00:05,  9.81it/s] 86%|████████▌ | 308/358 [00:31<00:05,  9.91it/s] 86%|████████▋ | 309/358 [00:31<00:04,  9.81it/s] 87%|████████▋ | 310/358 [00:31<00:04,  9.76it/s] 87%|████████▋ | 311/358 [00:31<00:04,  9.68it/s] 87%|████████▋ | 312/358 [00:31<00:04,  9.70it/s] 87%|████████▋ | 313/358 [00:31<00:04,  9.71it/s] 88%|████████▊ | 315/358 [00:32<00:04,  9.97it/s] 88%|████████▊ | 316/358 [00:32<00:04,  9.92it/s] 89%|████████▊ | 317/358 [00:32<00:04,  9.84it/s] 89%|████████▉ | 318/358 [00:32<00:04,  9.79it/s] 89%|████████▉ | 319/358 [00:32<00:04,  9.74it/s] 89%|████████▉ | 320/358 [00:32<00:03,  9.80it/s] 90%|████████▉ | 321/358 [00:32<00:03,  9.73it/s] 90%|████████▉ | 322/358 [00:32<00:03,  9.69it/s] 90%|█████████ | 323/358 [00:32<00:03,  9.65it/s] 91%|█████████ | 324/358 [00:33<00:03,  9.62it/s] 91%|█████████ | 325/358 [00:33<00:03,  9.60it/s] 91%|█████████▏| 327/358 [00:33<00:03,  9.96it/s] 92%|█████████▏| 329/358 [00:33<00:02, 10.06it/s] 92%|█████████▏| 330/358 [00:33<00:02,  9.95it/s] 93%|█████████▎| 332/358 [00:33<00:02, 10.05it/s] 93%|█████████▎| 334/358 [00:34<00:02,  9.95it/s] 94%|█████████▎| 335/358 [00:34<00:02,  9.83it/s] 94%|█████████▍| 337/358 [00:34<00:02,  9.90it/s] 95%|█████████▍| 339/358 [00:34<00:01, 10.10it/s] 95%|█████████▌| 341/358 [00:34<00:01, 10.04it/s] 96%|█████████▌| 342/358 [00:34<00:01,  9.96it/s] 96%|█████████▌| 343/358 [00:34<00:01,  9.85it/s] 96%|█████████▌| 344/358 [00:35<00:01,  9.79it/s] 96%|█████████▋| 345/358 [00:35<00:01,  9.82it/s] 97%|█████████▋| 347/358 [00:35<00:01, 10.03it/s] 97%|█████████▋| 348/358 [00:35<00:01,  9.92it/s] 97%|█████████▋| 349/358 [00:35<00:00,  9.84it/s] 98%|█████████▊| 350/358 [00:35<00:00,  9.77it/s] 98%|█████████▊| 351/358 [00:35<00:00,  9.72it/s] 99%|█████████▊| 353/358 [00:36<00:00,  9.91it/s] 99%|█████████▉| 354/358 [00:36<00:00,  9.89it/s] 99%|█████████▉| 355/358 [00:36<00:00,  9.80it/s]100%|█████████▉| 357/358 [00:36<00:00,  9.86it/s]100%|██████████| 358/358 [00:36<00:00,  9.81it/s]
[32m2025-02-05 05:44:04.194[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    gen_loss  grad clip ratio  grad norm   ppl
       2.105                1      13.37 8.211[0m
[32m2025-02-05 05:44:04.194[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m169[0m - [1m[Valid][0m
  0%|          | 0/10256 [00:00<?, ?it/s]100%|██████████| 10256/10256 [00:00<00:00, 1105062.86it/s]
[32m2025-02-05 05:44:04.204[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:27,  1.44it/s]  5%|▌         | 2/40 [00:01<00:26,  1.46it/s]  8%|▊         | 3/40 [00:02<00:25,  1.46it/s] 10%|█         | 4/40 [00:02<00:24,  1.46it/s] 12%|█▎        | 5/40 [00:03<00:24,  1.45it/s] 15%|█▌        | 6/40 [00:04<00:23,  1.45it/s] 18%|█▊        | 7/40 [00:04<00:22,  1.44it/s] 20%|██        | 8/40 [00:05<00:22,  1.45it/s] 22%|██▎       | 9/40 [00:06<00:21,  1.45it/s] 25%|██▌       | 10/40 [00:06<00:20,  1.45it/s] 28%|██▊       | 11/40 [00:07<00:19,  1.46it/s] 30%|███       | 12/40 [00:08<00:19,  1.46it/s] 32%|███▎      | 13/40 [00:08<00:18,  1.46it/s] 35%|███▌      | 14/40 [00:09<00:17,  1.45it/s] 38%|███▊      | 15/40 [00:10<00:17,  1.45it/s] 40%|████      | 16/40 [00:11<00:16,  1.44it/s] 42%|████▎     | 17/40 [00:11<00:15,  1.45it/s] 45%|████▌     | 18/40 [00:12<00:15,  1.45it/s] 48%|████▊     | 19/40 [00:13<00:14,  1.45it/s] 50%|█████     | 20/40 [00:13<00:13,  1.46it/s] 52%|█████▎    | 21/40 [00:14<00:13,  1.46it/s] 55%|█████▌    | 22/40 [00:15<00:12,  1.45it/s] 57%|█████▊    | 23/40 [00:15<00:11,  1.46it/s] 60%|██████    | 24/40 [00:16<00:11,  1.45it/s] 62%|██████▎   | 25/40 [00:17<00:10,  1.45it/s] 65%|██████▌   | 26/40 [00:17<00:09,  1.47it/s] 68%|██████▊   | 27/40 [00:18<00:08,  1.47it/s] 70%|███████   | 28/40 [00:19<00:08,  1.47it/s] 72%|███████▎  | 29/40 [00:19<00:07,  1.47it/s] 75%|███████▌  | 30/40 [00:20<00:06,  1.47it/s] 78%|███████▊  | 31/40 [00:21<00:06,  1.47it/s] 80%|████████  | 32/40 [00:21<00:05,  1.46it/s] 82%|████████▎ | 33/40 [00:22<00:04,  1.46it/s] 85%|████████▌ | 34/40 [00:23<00:04,  1.46it/s] 88%|████████▊ | 35/40 [00:24<00:03,  1.45it/s] 90%|█████████ | 36/40 [00:24<00:02,  1.45it/s] 92%|█████████▎| 37/40 [00:25<00:02,  1.45it/s] 95%|█████████▌| 38/40 [00:26<00:01,  1.45it/s] 98%|█████████▊| 39/40 [00:26<00:00,  1.44it/s]100%|██████████| 40/40 [00:27<00:00,  1.60it/s]100%|██████████| 40/40 [00:27<00:00,  1.47it/s]
[32m2025-02-05 05:44:31.497[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    average  bleu@1  bleu@2  bleu@3  bleu@4  dist@1  dist@2  dist@3  dist@4  extreme  \
      .7782   .3033   .1143  .04869  .02572  .04384   .3079   .6145   .7953    .5900   
      f1  gen_loss  greedy  intra_dist@1  intra_dist@2  intra_dist@3  intra_dist@4  \
   .3565     4.692   .6685         .8855         .9783         .9630         .9314   
    ppl  rouge1  rouge2  rougeL  
    109   .3880  .09453   .3755[0m
[32m2025-02-05 05:44:31.503[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m163[0m - [1m[Conversation epoch 34][0m
[32m2025-02-05 05:44:31.503[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m164[0m - [1m[Train][0m
  0%|          | 0/92414 [00:00<?, ?it/s]100%|██████████| 92414/92414 [00:00<00:00, 987534.96it/s]
[32m2025-02-05 05:44:31.597[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/358 [00:00<?, ?it/s]  0%|          | 1/358 [00:00<00:36,  9.73it/s]  1%|          | 3/358 [00:00<00:35,  9.91it/s]  1%|          | 4/358 [00:00<00:35,  9.89it/s]  2%|▏         | 6/358 [00:00<00:35,  9.86it/s]  2%|▏         | 7/358 [00:00<00:35,  9.80it/s]  2%|▏         | 8/358 [00:00<00:35,  9.84it/s]  3%|▎         | 9/358 [00:00<00:35,  9.74it/s]  3%|▎         | 10/358 [00:01<00:35,  9.73it/s]  3%|▎         | 11/358 [00:01<00:35,  9.68it/s]  4%|▎         | 13/358 [00:01<00:34,  9.90it/s]  4%|▍         | 14/358 [00:01<00:34,  9.83it/s]  4%|▍         | 15/358 [00:01<00:35,  9.76it/s]  4%|▍         | 16/358 [00:01<00:35,  9.69it/s]  5%|▍         | 17/358 [00:01<00:35,  9.71it/s]  5%|▌         | 18/358 [00:01<00:34,  9.78it/s]  5%|▌         | 19/358 [00:01<00:34,  9.72it/s]  6%|▌         | 20/358 [00:02<00:34,  9.66it/s]  6%|▌         | 21/358 [00:02<00:35,  9.59it/s]  6%|▌         | 22/358 [00:02<00:34,  9.66it/s]  7%|▋         | 24/358 [00:02<00:34,  9.75it/s]  7%|▋         | 25/358 [00:02<00:34,  9.70it/s]  7%|▋         | 26/358 [00:02<00:34,  9.65it/s]  8%|▊         | 27/358 [00:02<00:34,  9.71it/s]  8%|▊         | 28/358 [00:02<00:34,  9.66it/s]  8%|▊         | 29/358 [00:02<00:34,  9.63it/s]  9%|▊         | 31/358 [00:03<00:33,  9.74it/s]  9%|▉         | 32/358 [00:03<00:33,  9.73it/s]  9%|▉         | 34/358 [00:03<00:32,  9.83it/s] 10%|█         | 36/358 [00:03<00:32,  9.83it/s] 10%|█         | 37/358 [00:03<00:32,  9.82it/s] 11%|█         | 38/358 [00:03<00:32,  9.77it/s] 11%|█         | 40/358 [00:04<00:32,  9.93it/s] 11%|█▏        | 41/358 [00:04<00:32,  9.84it/s] 12%|█▏        | 43/358 [00:04<00:31,  9.87it/s] 13%|█▎        | 45/358 [00:04<00:31,  9.97it/s] 13%|█▎        | 47/358 [00:04<00:31,  9.94it/s] 13%|█▎        | 48/358 [00:04<00:31,  9.93it/s] 14%|█▍        | 50/358 [00:05<00:31,  9.90it/s] 14%|█▍        | 51/358 [00:05<00:31,  9.83it/s] 15%|█▍        | 52/358 [00:05<00:31,  9.74it/s] 15%|█▍        | 53/358 [00:05<00:31,  9.69it/s] 15%|█▌        | 54/358 [00:05<00:31,  9.73it/s] 15%|█▌        | 55/358 [00:05<00:31,  9.68it/s] 16%|█▌        | 56/358 [00:05<00:31,  9.72it/s] 16%|█▌        | 57/358 [00:05<00:31,  9.68it/s] 16%|█▌        | 58/358 [00:05<00:31,  9.65it/s] 16%|█▋        | 59/358 [00:06<00:31,  9.62it/s] 17%|█▋        | 61/358 [00:06<00:30,  9.71it/s] 17%|█▋        | 62/358 [00:06<00:30,  9.63it/s] 18%|█▊        | 63/358 [00:06<00:30,  9.70it/s] 18%|█▊        | 64/358 [00:06<00:30,  9.65it/s] 18%|█▊        | 66/358 [00:06<00:30,  9.72it/s] 19%|█▊        | 67/358 [00:06<00:29,  9.71it/s] 19%|█▉        | 69/358 [00:07<00:29,  9.77it/s] 20%|█▉        | 70/358 [00:07<00:29,  9.72it/s] 20%|█▉        | 71/358 [00:07<00:29,  9.76it/s] 20%|██        | 72/358 [00:07<00:29,  9.70it/s] 20%|██        | 73/358 [00:07<00:29,  9.67it/s] 21%|██        | 74/358 [00:07<00:29,  9.64it/s] 21%|██        | 75/358 [00:07<00:29,  9.61it/s] 21%|██        | 76/358 [00:07<00:29,  9.71it/s] 22%|██▏       | 77/358 [00:07<00:29,  9.68it/s] 22%|██▏       | 79/358 [00:08<00:28,  9.68it/s] 23%|██▎       | 81/358 [00:08<00:28,  9.75it/s] 23%|██▎       | 83/358 [00:08<00:28,  9.77it/s] 23%|██▎       | 84/358 [00:08<00:28,  9.72it/s] 24%|██▎       | 85/358 [00:08<00:28,  9.67it/s] 24%|██▍       | 86/358 [00:08<00:28,  9.66it/s] 24%|██▍       | 87/358 [00:08<00:28,  9.64it/s] 25%|██▍       | 88/358 [00:09<00:27,  9.66it/s] 25%|██▌       | 90/358 [00:09<00:27,  9.90it/s] 26%|██▌       | 92/358 [00:09<00:26, 10.00it/s] 26%|██▌       | 93/358 [00:09<00:26,  9.96it/s] 26%|██▋       | 94/358 [00:09<00:26,  9.87it/s] 27%|██▋       | 96/358 [00:09<00:25, 10.15it/s] 27%|██▋       | 98/358 [00:10<00:25, 10.04it/s] 28%|██▊       | 99/358 [00:10<00:26,  9.95it/s] 28%|██▊       | 101/358 [00:10<00:25,  9.91it/s] 29%|██▉       | 103/358 [00:10<00:25,  9.90it/s] 29%|██▉       | 104/358 [00:10<00:25,  9.85it/s] 29%|██▉       | 105/358 [00:10<00:25,  9.78it/s] 30%|██▉       | 106/358 [00:10<00:25,  9.76it/s] 30%|███       | 108/358 [00:11<00:25,  9.79it/s] 30%|███       | 109/358 [00:11<00:25,  9.70it/s] 31%|███       | 110/358 [00:11<00:25,  9.68it/s] 31%|███       | 111/358 [00:11<00:25,  9.63it/s] 32%|███▏      | 113/358 [00:11<00:24,  9.90it/s] 32%|███▏      | 114/358 [00:11<00:24,  9.86it/s] 32%|███▏      | 115/358 [00:11<00:24,  9.77it/s] 32%|███▏      | 116/358 [00:11<00:24,  9.68it/s] 33%|███▎      | 117/358 [00:11<00:24,  9.65it/s] 33%|███▎      | 119/358 [00:12<00:24,  9.77it/s] 34%|███▍      | 121/358 [00:12<00:23,  9.97it/s] 34%|███▍      | 123/358 [00:12<00:23, 10.07it/s] 35%|███▍      | 125/358 [00:12<00:23, 10.05it/s] 35%|███▌      | 126/358 [00:12<00:23, 10.01it/s] 35%|███▌      | 127/358 [00:12<00:23,  9.96it/s] 36%|███▌      | 128/358 [00:13<00:23,  9.91it/s] 36%|███▋      | 130/358 [00:13<00:22,  9.98it/s] 37%|███▋      | 131/358 [00:13<00:22,  9.88it/s] 37%|███▋      | 132/358 [00:13<00:22,  9.90it/s] 37%|███▋      | 134/358 [00:13<00:22,  9.92it/s] 38%|███▊      | 135/358 [00:13<00:22,  9.86it/s] 38%|███▊      | 137/358 [00:13<00:22,  9.95it/s] 39%|███▊      | 138/358 [00:14<00:22,  9.94it/s] 39%|███▉      | 139/358 [00:14<00:22,  9.85it/s] 39%|███▉      | 141/358 [00:14<00:21,  9.97it/s] 40%|███▉      | 142/358 [00:14<00:21,  9.89it/s] 40%|███▉      | 143/358 [00:14<00:21,  9.86it/s] 40%|████      | 144/358 [00:14<00:21,  9.77it/s] 41%|████      | 145/358 [00:14<00:21,  9.79it/s] 41%|████      | 146/358 [00:14<00:21,  9.73it/s] 41%|████      | 147/358 [00:14<00:21,  9.67it/s] 41%|████▏     | 148/358 [00:15<00:21,  9.70it/s] 42%|████▏     | 149/358 [00:15<00:21,  9.68it/s] 42%|████▏     | 150/358 [00:15<00:21,  9.64it/s] 42%|████▏     | 151/358 [00:15<00:22,  9.37it/s] 42%|████▏     | 152/358 [00:15<00:21,  9.42it/s] 43%|████▎     | 153/358 [00:15<00:21,  9.44it/s] 43%|████▎     | 154/358 [00:15<00:21,  9.53it/s] 43%|████▎     | 155/358 [00:15<00:21,  9.54it/s] 44%|████▎     | 156/358 [00:15<00:20,  9.66it/s] 44%|████▍     | 157/358 [00:16<00:20,  9.60it/s] 44%|████▍     | 158/358 [00:16<00:20,  9.69it/s] 44%|████▍     | 159/358 [00:16<00:20,  9.69it/s] 45%|████▍     | 160/358 [00:16<00:20,  9.69it/s] 45%|████▌     | 162/358 [00:16<00:19,  9.99it/s] 46%|████▌     | 164/358 [00:16<00:19,  9.99it/s] 46%|████▌     | 165/358 [00:16<00:19,  9.95it/s] 47%|████▋     | 167/358 [00:17<00:19,  9.90it/s] 47%|████▋     | 169/358 [00:17<00:19,  9.93it/s] 48%|████▊     | 171/358 [00:17<00:18,  9.91it/s] 48%|████▊     | 172/358 [00:17<00:18,  9.86it/s] 48%|████▊     | 173/358 [00:17<00:18,  9.80it/s] 49%|████▉     | 175/358 [00:17<00:18,  9.82it/s] 49%|████▉     | 176/358 [00:17<00:18,  9.84it/s] 49%|████▉     | 177/358 [00:18<00:18,  9.82it/s] 50%|█████     | 179/358 [00:18<00:18,  9.84it/s] 50%|█████     | 180/358 [00:18<00:18,  9.78it/s] 51%|█████     | 182/358 [00:18<00:17,  9.92it/s] 51%|█████     | 183/358 [00:18<00:17,  9.88it/s] 51%|█████▏    | 184/358 [00:18<00:17,  9.77it/s] 52%|█████▏    | 185/358 [00:18<00:17,  9.71it/s] 52%|█████▏    | 187/358 [00:19<00:17,  9.93it/s] 53%|█████▎    | 188/358 [00:19<00:17,  9.87it/s] 53%|█████▎    | 189/358 [00:19<00:17,  9.82it/s] 53%|█████▎    | 190/358 [00:19<00:17,  9.86it/s] 53%|█████▎    | 191/358 [00:19<00:17,  9.70it/s] 54%|█████▎    | 192/358 [00:19<00:17,  9.65it/s] 54%|█████▍    | 193/358 [00:19<00:17,  9.65it/s] 54%|█████▍    | 194/358 [00:19<00:17,  9.64it/s] 54%|█████▍    | 195/358 [00:19<00:16,  9.72it/s] 55%|█████▌    | 197/358 [00:20<00:16,  9.90it/s] 55%|█████▌    | 198/358 [00:20<00:16,  9.82it/s] 56%|█████▌    | 199/358 [00:20<00:16,  9.86it/s] 56%|█████▌    | 200/358 [00:20<00:16,  9.79it/s] 56%|█████▌    | 201/358 [00:20<00:16,  9.75it/s] 57%|█████▋    | 203/358 [00:20<00:15,  9.84it/s] 57%|█████▋    | 204/358 [00:20<00:15,  9.74it/s] 57%|█████▋    | 205/358 [00:20<00:15,  9.70it/s] 58%|█████▊    | 207/358 [00:21<00:15,  9.87it/s] 58%|█████▊    | 208/358 [00:21<00:15,  9.80it/s] 59%|█████▊    | 210/358 [00:21<00:15,  9.81it/s] 59%|█████▉    | 212/358 [00:21<00:14,  9.81it/s] 60%|█████▉    | 214/358 [00:21<00:14,  9.88it/s] 60%|██████    | 215/358 [00:21<00:14,  9.81it/s] 60%|██████    | 216/358 [00:22<00:14,  9.75it/s] 61%|██████    | 217/358 [00:22<00:14,  9.79it/s] 61%|██████    | 218/358 [00:22<00:14,  9.76it/s] 61%|██████    | 219/358 [00:22<00:14,  9.76it/s] 62%|██████▏   | 221/358 [00:22<00:13,  9.89it/s] 62%|██████▏   | 222/358 [00:22<00:13,  9.79it/s] 62%|██████▏   | 223/358 [00:22<00:13,  9.73it/s] 63%|██████▎   | 224/358 [00:22<00:13,  9.68it/s] 63%|██████▎   | 225/358 [00:22<00:13,  9.76it/s] 63%|██████▎   | 226/358 [00:23<00:13,  9.71it/s] 64%|██████▎   | 228/358 [00:23<00:13,  9.75it/s] 64%|██████▍   | 229/358 [00:23<00:13,  9.72it/s] 64%|██████▍   | 230/358 [00:23<00:13,  9.67it/s] 65%|██████▍   | 232/358 [00:23<00:12,  9.72it/s] 65%|██████▌   | 234/358 [00:23<00:12, 10.01it/s] 66%|██████▌   | 236/358 [00:24<00:12,  9.97it/s] 66%|██████▋   | 238/358 [00:24<00:11, 10.02it/s] 67%|██████▋   | 240/358 [00:24<00:11,  9.99it/s] 68%|██████▊   | 242/358 [00:24<00:11,  9.96it/s] 68%|██████▊   | 243/358 [00:24<00:11,  9.90it/s] 68%|██████▊   | 244/358 [00:24<00:11,  9.83it/s] 69%|██████▊   | 246/358 [00:25<00:11,  9.86it/s] 69%|██████▉   | 247/358 [00:25<00:11,  9.78it/s] 69%|██████▉   | 248/358 [00:25<00:11,  9.74it/s] 70%|██████▉   | 250/358 [00:25<00:10,  9.83it/s] 70%|███████   | 251/358 [00:25<00:10,  9.77it/s] 70%|███████   | 252/358 [00:25<00:10,  9.71it/s] 71%|███████   | 253/358 [00:25<00:10,  9.67it/s] 71%|███████   | 254/358 [00:25<00:10,  9.64it/s] 72%|███████▏  | 256/358 [00:26<00:10,  9.82it/s] 72%|███████▏  | 257/358 [00:26<00:10,  9.82it/s] 72%|███████▏  | 258/358 [00:26<00:10,  9.70it/s] 72%|███████▏  | 259/358 [00:26<00:10,  9.66it/s] 73%|███████▎  | 260/358 [00:26<00:10,  9.70it/s] 73%|███████▎  | 262/358 [00:26<00:09,  9.88it/s] 74%|███████▎  | 264/358 [00:26<00:09,  9.90it/s] 74%|███████▍  | 266/358 [00:27<00:09,  9.89it/s] 75%|███████▍  | 267/358 [00:27<00:09,  9.83it/s] 75%|███████▌  | 269/358 [00:27<00:09,  9.89it/s] 75%|███████▌  | 270/358 [00:27<00:08,  9.82it/s] 76%|███████▌  | 271/358 [00:27<00:08,  9.75it/s] 76%|███████▌  | 272/358 [00:27<00:08,  9.72it/s] 76%|███████▋  | 273/358 [00:27<00:08,  9.63it/s] 77%|███████▋  | 274/358 [00:27<00:08,  9.62it/s] 77%|███████▋  | 275/358 [00:28<00:08,  9.67it/s] 77%|███████▋  | 276/358 [00:28<00:08,  9.67it/s] 77%|███████▋  | 277/358 [00:28<00:08,  9.64it/s] 78%|███████▊  | 278/358 [00:28<00:08,  9.61it/s] 78%|███████▊  | 280/358 [00:28<00:07,  9.81it/s] 78%|███████▊  | 281/358 [00:28<00:07,  9.82it/s] 79%|███████▉  | 282/358 [00:28<00:07,  9.76it/s] 79%|███████▉  | 283/358 [00:28<00:07,  9.70it/s] 79%|███████▉  | 284/358 [00:28<00:07,  9.66it/s] 80%|███████▉  | 285/358 [00:29<00:07,  9.73it/s] 80%|███████▉  | 286/358 [00:29<00:07,  9.68it/s] 80%|████████  | 287/358 [00:29<00:07,  9.66it/s] 80%|████████  | 288/358 [00:29<00:07,  9.62it/s] 81%|████████  | 290/358 [00:29<00:06,  9.83it/s] 81%|████████▏ | 291/358 [00:29<00:06,  9.82it/s] 82%|████████▏ | 293/358 [00:29<00:06,  9.83it/s] 82%|████████▏ | 295/358 [00:30<00:06,  9.90it/s] 83%|████████▎ | 296/358 [00:30<00:06,  9.83it/s] 83%|████████▎ | 297/358 [00:30<00:06,  9.72it/s] 84%|████████▎ | 299/358 [00:30<00:05,  9.88it/s] 84%|████████▍ | 301/358 [00:30<00:05,  9.92it/s] 84%|████████▍ | 302/358 [00:30<00:05,  9.84it/s] 85%|████████▍ | 303/358 [00:30<00:05,  9.85it/s] 85%|████████▌ | 305/358 [00:31<00:05,  9.88it/s] 85%|████████▌ | 306/358 [00:31<00:05,  9.80it/s] 86%|████████▌ | 308/358 [00:31<00:05,  9.91it/s] 86%|████████▋ | 309/358 [00:31<00:04,  9.80it/s] 87%|████████▋ | 310/358 [00:31<00:04,  9.75it/s] 87%|████████▋ | 311/358 [00:31<00:04,  9.67it/s] 87%|████████▋ | 312/358 [00:31<00:04,  9.69it/s] 87%|████████▋ | 313/358 [00:31<00:04,  9.71it/s] 88%|████████▊ | 315/358 [00:32<00:04,  9.97it/s] 88%|████████▊ | 316/358 [00:32<00:04,  9.92it/s] 89%|████████▊ | 317/358 [00:32<00:04,  9.84it/s] 89%|████████▉ | 318/358 [00:32<00:04,  9.79it/s] 89%|████████▉ | 319/358 [00:32<00:04,  9.74it/s] 89%|████████▉ | 320/358 [00:32<00:03,  9.79it/s] 90%|████████▉ | 321/358 [00:32<00:03,  9.72it/s] 90%|████████▉ | 322/358 [00:32<00:03,  9.69it/s] 90%|█████████ | 323/358 [00:32<00:03,  9.64it/s] 91%|█████████ | 324/358 [00:33<00:03,  9.61it/s] 91%|█████████ | 325/358 [00:33<00:03,  9.59it/s] 91%|█████████▏| 327/358 [00:33<00:03,  9.95it/s] 92%|█████████▏| 329/358 [00:33<00:02, 10.05it/s] 92%|█████████▏| 330/358 [00:33<00:02,  9.94it/s] 93%|█████████▎| 332/358 [00:33<00:02, 10.04it/s] 93%|█████████▎| 334/358 [00:34<00:02,  9.94it/s] 94%|█████████▎| 335/358 [00:34<00:02,  9.82it/s] 94%|█████████▍| 337/358 [00:34<00:02,  9.90it/s] 95%|█████████▍| 339/358 [00:34<00:01, 10.10it/s] 95%|█████████▌| 341/358 [00:34<00:01, 10.04it/s] 96%|█████████▌| 342/358 [00:34<00:01,  9.96it/s] 96%|█████████▌| 343/358 [00:34<00:01,  9.85it/s] 96%|█████████▌| 344/358 [00:35<00:01,  9.79it/s] 96%|█████████▋| 345/358 [00:35<00:01,  9.82it/s] 97%|█████████▋| 346/358 [00:35<00:01,  9.87it/s] 97%|█████████▋| 348/358 [00:35<00:01,  9.97it/s] 97%|█████████▋| 349/358 [00:35<00:00,  9.88it/s] 98%|█████████▊| 350/358 [00:35<00:00,  9.80it/s] 98%|█████████▊| 351/358 [00:35<00:00,  9.75it/s] 99%|█████████▊| 353/358 [00:36<00:00,  9.91it/s] 99%|█████████▉| 354/358 [00:36<00:00,  9.89it/s] 99%|█████████▉| 355/358 [00:36<00:00,  9.79it/s]100%|█████████▉| 357/358 [00:36<00:00,  9.85it/s]100%|██████████| 358/358 [00:36<00:00,  9.81it/s]
[32m2025-02-05 05:45:08.094[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    gen_loss  grad clip ratio  grad norm   ppl
       2.094                1      2.843 8.121[0m
[32m2025-02-05 05:45:08.094[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m169[0m - [1m[Valid][0m
  0%|          | 0/10256 [00:00<?, ?it/s]100%|██████████| 10256/10256 [00:00<00:00, 930132.80it/s]
[32m2025-02-05 05:45:08.106[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:27,  1.43it/s]  5%|▌         | 2/40 [00:01<00:26,  1.45it/s]  8%|▊         | 3/40 [00:02<00:25,  1.45it/s] 10%|█         | 4/40 [00:02<00:24,  1.46it/s] 12%|█▎        | 5/40 [00:03<00:24,  1.45it/s] 15%|█▌        | 6/40 [00:04<00:23,  1.45it/s] 18%|█▊        | 7/40 [00:04<00:22,  1.44it/s] 20%|██        | 8/40 [00:05<00:22,  1.45it/s] 22%|██▎       | 9/40 [00:06<00:21,  1.45it/s] 25%|██▌       | 10/40 [00:06<00:20,  1.45it/s] 28%|██▊       | 11/40 [00:07<00:19,  1.46it/s] 30%|███       | 12/40 [00:08<00:19,  1.46it/s] 32%|███▎      | 13/40 [00:08<00:18,  1.46it/s] 35%|███▌      | 14/40 [00:09<00:17,  1.45it/s] 38%|███▊      | 15/40 [00:10<00:17,  1.45it/s] 40%|████      | 16/40 [00:11<00:16,  1.45it/s] 42%|████▎     | 17/40 [00:11<00:15,  1.45it/s] 45%|████▌     | 18/40 [00:12<00:15,  1.45it/s] 48%|████▊     | 19/40 [00:13<00:14,  1.45it/s] 50%|█████     | 20/40 [00:13<00:13,  1.46it/s] 52%|█████▎    | 21/40 [00:14<00:12,  1.46it/s] 55%|█████▌    | 22/40 [00:15<00:12,  1.46it/s] 57%|█████▊    | 23/40 [00:15<00:11,  1.46it/s] 60%|██████    | 24/40 [00:16<00:11,  1.45it/s] 62%|██████▎   | 25/40 [00:17<00:10,  1.45it/s] 65%|██████▌   | 26/40 [00:17<00:09,  1.46it/s] 68%|██████▊   | 27/40 [00:18<00:08,  1.46it/s] 70%|███████   | 28/40 [00:19<00:08,  1.46it/s] 72%|███████▎  | 29/40 [00:19<00:07,  1.46it/s] 75%|███████▌  | 30/40 [00:20<00:06,  1.47it/s] 78%|███████▊  | 31/40 [00:21<00:06,  1.46it/s] 80%|████████  | 32/40 [00:21<00:05,  1.47it/s] 82%|████████▎ | 33/40 [00:22<00:04,  1.46it/s] 85%|████████▌ | 34/40 [00:23<00:04,  1.46it/s] 88%|████████▊ | 35/40 [00:24<00:03,  1.46it/s] 90%|█████████ | 36/40 [00:24<00:02,  1.45it/s] 92%|█████████▎| 37/40 [00:25<00:02,  1.46it/s] 95%|█████████▌| 38/40 [00:26<00:01,  1.45it/s] 98%|█████████▊| 39/40 [00:26<00:00,  1.45it/s]100%|██████████| 40/40 [00:27<00:00,  1.60it/s]100%|██████████| 40/40 [00:27<00:00,  1.47it/s]
[32m2025-02-05 05:45:35.394[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    average  bleu@1  bleu@2  bleu@3  bleu@4  dist@1  dist@2  dist@3  dist@4  extreme  \
      .7761   .3047   .1127  .04856  .02578  .04472   .3059   .5995   .7728    .5913   
      f1  gen_loss  greedy  intra_dist@1  intra_dist@2  intra_dist@3  intra_dist@4  \
   .3546     4.728   .6681         .8771         .9714         .9557         .9207   
     ppl  rouge1  rouge2  rougeL  
   113.1   .3890  .09366   .3761[0m
[32m2025-02-05 05:45:35.400[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m163[0m - [1m[Conversation epoch 35][0m
[32m2025-02-05 05:45:35.400[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m164[0m - [1m[Train][0m
  0%|          | 0/92414 [00:00<?, ?it/s]100%|██████████| 92414/92414 [00:00<00:00, 1089989.93it/s]
[32m2025-02-05 05:45:35.485[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/358 [00:00<?, ?it/s]  0%|          | 1/358 [00:00<00:36,  9.75it/s]  1%|          | 3/358 [00:00<00:35,  9.93it/s]  1%|          | 4/358 [00:00<00:35,  9.91it/s]  2%|▏         | 6/358 [00:00<00:35,  9.87it/s]  2%|▏         | 7/358 [00:00<00:35,  9.80it/s]  2%|▏         | 8/358 [00:00<00:35,  9.85it/s]  3%|▎         | 9/358 [00:00<00:35,  9.75it/s]  3%|▎         | 10/358 [00:01<00:35,  9.74it/s]  3%|▎         | 11/358 [00:01<00:35,  9.69it/s]  4%|▎         | 13/358 [00:01<00:34,  9.91it/s]  4%|▍         | 14/358 [00:01<00:34,  9.83it/s]  4%|▍         | 15/358 [00:01<00:35,  9.76it/s]  4%|▍         | 16/358 [00:01<00:35,  9.70it/s]  5%|▍         | 17/358 [00:01<00:35,  9.71it/s]  5%|▌         | 18/358 [00:01<00:34,  9.79it/s]  5%|▌         | 19/358 [00:01<00:34,  9.72it/s]  6%|▌         | 20/358 [00:02<00:34,  9.66it/s]  6%|▌         | 21/358 [00:02<00:35,  9.60it/s]  6%|▌         | 22/358 [00:02<00:34,  9.66it/s]  7%|▋         | 24/358 [00:02<00:34,  9.76it/s]  7%|▋         | 25/358 [00:02<00:34,  9.71it/s]  7%|▋         | 26/358 [00:02<00:34,  9.66it/s]  8%|▊         | 27/358 [00:02<00:34,  9.72it/s]  8%|▊         | 28/358 [00:02<00:34,  9.67it/s]  8%|▊         | 29/358 [00:02<00:34,  9.64it/s]  9%|▊         | 31/358 [00:03<00:33,  9.74it/s]  9%|▉         | 32/358 [00:03<00:33,  9.74it/s]  9%|▉         | 34/358 [00:03<00:32,  9.83it/s] 10%|█         | 36/358 [00:03<00:32,  9.83it/s] 10%|█         | 37/358 [00:03<00:32,  9.81it/s] 11%|█         | 38/358 [00:03<00:32,  9.77it/s] 11%|█         | 40/358 [00:04<00:32,  9.93it/s] 11%|█▏        | 41/358 [00:04<00:32,  9.85it/s] 12%|█▏        | 43/358 [00:04<00:31,  9.87it/s] 13%|█▎        | 45/358 [00:04<00:31,  9.97it/s] 13%|█▎        | 47/358 [00:04<00:31,  9.94it/s] 13%|█▎        | 48/358 [00:04<00:31,  9.93it/s] 14%|█▍        | 50/358 [00:05<00:31,  9.90it/s] 14%|█▍        | 51/358 [00:05<00:31,  9.83it/s] 15%|█▍        | 52/358 [00:05<00:31,  9.74it/s] 15%|█▍        | 53/358 [00:05<00:31,  9.70it/s] 15%|█▌        | 54/358 [00:05<00:31,  9.74it/s] 15%|█▌        | 55/358 [00:05<00:31,  9.69it/s] 16%|█▌        | 56/358 [00:05<00:31,  9.73it/s] 16%|█▌        | 57/358 [00:05<00:31,  9.68it/s] 16%|█▌        | 58/358 [00:05<00:31,  9.66it/s] 16%|█▋        | 59/358 [00:06<00:31,  9.63it/s] 17%|█▋        | 61/358 [00:06<00:30,  9.72it/s] 17%|█▋        | 62/358 [00:06<00:30,  9.64it/s] 18%|█▊        | 63/358 [00:06<00:30,  9.70it/s] 18%|█▊        | 64/358 [00:06<00:30,  9.65it/s] 18%|█▊        | 66/358 [00:06<00:30,  9.72it/s] 19%|█▊        | 67/358 [00:06<00:29,  9.70it/s] 19%|█▉        | 69/358 [00:07<00:29,  9.76it/s] 20%|█▉        | 70/358 [00:07<00:29,  9.71it/s] 20%|█▉        | 71/358 [00:07<00:29,  9.75it/s] 20%|██        | 72/358 [00:07<00:29,  9.70it/s] 20%|██        | 73/358 [00:07<00:29,  9.67it/s] 21%|██        | 74/358 [00:07<00:29,  9.64it/s] 21%|██        | 75/358 [00:07<00:29,  9.61it/s] 21%|██        | 76/358 [00:07<00:29,  9.71it/s] 22%|██▏       | 77/358 [00:07<00:29,  9.67it/s] 22%|██▏       | 79/358 [00:08<00:28,  9.68it/s] 23%|██▎       | 81/358 [00:08<00:28,  9.74it/s] 23%|██▎       | 83/358 [00:08<00:28,  9.77it/s] 23%|██▎       | 84/358 [00:08<00:28,  9.72it/s] 24%|██▎       | 85/358 [00:08<00:28,  9.67it/s] 24%|██▍       | 86/358 [00:08<00:28,  9.66it/s] 24%|██▍       | 87/358 [00:08<00:28,  9.64it/s] 25%|██▍       | 88/358 [00:09<00:27,  9.66it/s] 25%|██▌       | 90/358 [00:09<00:27,  9.89it/s] 26%|██▌       | 92/358 [00:09<00:26,  9.99it/s] 26%|██▌       | 93/358 [00:09<00:26,  9.95it/s] 26%|██▋       | 94/358 [00:09<00:26,  9.87it/s] 27%|██▋       | 96/358 [00:09<00:25, 10.15it/s] 27%|██▋       | 98/358 [00:10<00:25, 10.04it/s] 28%|██▊       | 99/358 [00:10<00:26,  9.94it/s] 28%|██▊       | 101/358 [00:10<00:25,  9.91it/s] 29%|██▉       | 103/358 [00:10<00:25,  9.90it/s] 29%|██▉       | 104/358 [00:10<00:25,  9.86it/s] 29%|██▉       | 105/358 [00:10<00:25,  9.78it/s] 30%|██▉       | 106/358 [00:10<00:25,  9.76it/s] 30%|███       | 108/358 [00:11<00:25,  9.79it/s] 30%|███       | 109/358 [00:11<00:25,  9.70it/s] 31%|███       | 110/358 [00:11<00:25,  9.69it/s] 31%|███       | 111/358 [00:11<00:25,  9.64it/s] 32%|███▏      | 113/358 [00:11<00:24,  9.90it/s] 32%|███▏      | 114/358 [00:11<00:24,  9.86it/s] 32%|███▏      | 115/358 [00:11<00:24,  9.77it/s] 32%|███▏      | 116/358 [00:11<00:25,  9.68it/s] 33%|███▎      | 117/358 [00:11<00:24,  9.65it/s] 33%|███▎      | 119/358 [00:12<00:24,  9.77it/s] 34%|███▍      | 121/358 [00:12<00:23,  9.97it/s] 34%|███▍      | 123/358 [00:12<00:23, 10.07it/s] 35%|███▍      | 125/358 [00:12<00:23, 10.05it/s] 35%|███▌      | 126/358 [00:12<00:23, 10.01it/s] 35%|███▌      | 127/358 [00:12<00:23,  9.96it/s] 36%|███▌      | 128/358 [00:13<00:23,  9.91it/s] 36%|███▋      | 130/358 [00:13<00:22,  9.98it/s] 37%|███▋      | 131/358 [00:13<00:22,  9.88it/s] 37%|███▋      | 132/358 [00:13<00:22,  9.90it/s] 37%|███▋      | 134/358 [00:13<00:22,  9.92it/s] 38%|███▊      | 135/358 [00:13<00:22,  9.86it/s] 38%|███▊      | 137/358 [00:13<00:22,  9.95it/s] 39%|███▊      | 138/358 [00:14<00:22,  9.93it/s] 39%|███▉      | 139/358 [00:14<00:22,  9.84it/s] 39%|███▉      | 141/358 [00:14<00:21,  9.97it/s] 40%|███▉      | 142/358 [00:14<00:21,  9.89it/s] 40%|███▉      | 143/358 [00:14<00:21,  9.86it/s] 40%|████      | 144/358 [00:14<00:21,  9.77it/s] 41%|████      | 145/358 [00:14<00:21,  9.79it/s] 41%|████      | 146/358 [00:14<00:21,  9.73it/s] 41%|████      | 147/358 [00:14<00:21,  9.67it/s] 41%|████▏     | 148/358 [00:15<00:21,  9.70it/s] 42%|████▏     | 149/358 [00:15<00:21,  9.68it/s] 42%|████▏     | 150/358 [00:15<00:21,  9.64it/s] 42%|████▏     | 151/358 [00:15<00:22,  9.37it/s] 42%|████▏     | 152/358 [00:15<00:21,  9.42it/s] 43%|████▎     | 153/358 [00:15<00:21,  9.44it/s] 43%|████▎     | 154/358 [00:15<00:21,  9.54it/s] 43%|████▎     | 155/358 [00:15<00:21,  9.55it/s] 44%|████▎     | 156/358 [00:15<00:20,  9.67it/s] 44%|████▍     | 157/358 [00:16<00:20,  9.61it/s] 44%|████▍     | 158/358 [00:16<00:20,  9.70it/s] 44%|████▍     | 159/358 [00:16<00:20,  9.69it/s] 45%|████▍     | 160/358 [00:16<00:20,  9.70it/s] 45%|████▌     | 162/358 [00:16<00:19,  9.99it/s] 46%|████▌     | 164/358 [00:16<00:19,  9.99it/s] 46%|████▌     | 165/358 [00:16<00:19,  9.95it/s] 47%|████▋     | 167/358 [00:17<00:19,  9.90it/s] 47%|████▋     | 169/358 [00:17<00:19,  9.93it/s] 48%|████▊     | 171/358 [00:17<00:18,  9.91it/s] 48%|████▊     | 172/358 [00:17<00:18,  9.86it/s] 48%|████▊     | 173/358 [00:17<00:18,  9.79it/s] 49%|████▉     | 175/358 [00:17<00:18,  9.82it/s] 49%|████▉     | 176/358 [00:17<00:18,  9.83it/s] 49%|████▉     | 177/358 [00:18<00:18,  9.82it/s] 50%|█████     | 179/358 [00:18<00:18,  9.84it/s] 50%|█████     | 180/358 [00:18<00:18,  9.77it/s] 51%|█████     | 182/358 [00:18<00:17,  9.92it/s] 51%|█████     | 183/358 [00:18<00:17,  9.88it/s] 51%|█████▏    | 184/358 [00:18<00:17,  9.77it/s] 52%|█████▏    | 185/358 [00:18<00:17,  9.72it/s] 52%|█████▏    | 187/358 [00:19<00:17,  9.93it/s] 53%|█████▎    | 188/358 [00:19<00:17,  9.88it/s] 53%|█████▎    | 189/358 [00:19<00:17,  9.82it/s] 53%|█████▎    | 190/358 [00:19<00:17,  9.86it/s] 53%|█████▎    | 191/358 [00:19<00:17,  9.70it/s] 54%|█████▎    | 192/358 [00:19<00:17,  9.65it/s] 54%|█████▍    | 193/358 [00:19<00:17,  9.65it/s] 54%|█████▍    | 194/358 [00:19<00:17,  9.64it/s] 54%|█████▍    | 195/358 [00:19<00:16,  9.72it/s] 55%|█████▌    | 197/358 [00:20<00:16,  9.82it/s] 55%|█████▌    | 198/358 [00:20<00:16,  9.76it/s] 56%|█████▌    | 199/358 [00:20<00:16,  9.81it/s] 56%|█████▌    | 200/358 [00:20<00:16,  9.75it/s] 56%|█████▌    | 201/358 [00:20<00:16,  9.72it/s] 57%|█████▋    | 203/358 [00:20<00:15,  9.82it/s] 57%|█████▋    | 204/358 [00:20<00:15,  9.72it/s] 57%|█████▋    | 205/358 [00:20<00:15,  9.67it/s] 58%|█████▊    | 207/358 [00:21<00:15,  9.84it/s] 58%|█████▊    | 208/358 [00:21<00:15,  9.77it/s] 59%|█████▊    | 210/358 [00:21<00:15,  9.80it/s] 59%|█████▉    | 212/358 [00:21<00:14,  9.79it/s] 60%|█████▉    | 214/358 [00:21<00:14,  9.87it/s] 60%|██████    | 215/358 [00:21<00:14,  9.81it/s] 60%|██████    | 216/358 [00:22<00:14,  9.74it/s] 61%|██████    | 217/358 [00:22<00:14,  9.78it/s] 61%|██████    | 218/358 [00:22<00:14,  9.75it/s] 61%|██████    | 219/358 [00:22<00:14,  9.75it/s] 62%|██████▏   | 221/358 [00:22<00:13,  9.88it/s] 62%|██████▏   | 222/358 [00:22<00:13,  9.78it/s] 62%|██████▏   | 223/358 [00:22<00:13,  9.73it/s] 63%|██████▎   | 224/358 [00:22<00:13,  9.67it/s] 63%|██████▎   | 225/358 [00:22<00:13,  9.75it/s] 63%|██████▎   | 226/358 [00:23<00:13,  9.70it/s] 64%|██████▎   | 228/358 [00:23<00:13,  9.74it/s] 64%|██████▍   | 229/358 [00:23<00:13,  9.71it/s] 64%|██████▍   | 230/358 [00:23<00:13,  9.66it/s] 65%|██████▍   | 232/358 [00:23<00:12,  9.71it/s] 65%|██████▌   | 234/358 [00:23<00:12, 10.00it/s] 66%|██████▌   | 236/358 [00:24<00:12,  9.96it/s] 66%|██████▋   | 238/358 [00:24<00:11, 10.02it/s] 67%|██████▋   | 240/358 [00:24<00:11,  9.98it/s] 68%|██████▊   | 242/358 [00:24<00:11,  9.96it/s] 68%|██████▊   | 243/358 [00:24<00:11,  9.90it/s] 68%|██████▊   | 244/358 [00:24<00:11,  9.83it/s] 69%|██████▊   | 246/358 [00:25<00:11,  9.85it/s] 69%|██████▉   | 247/358 [00:25<00:11,  9.78it/s] 69%|██████▉   | 248/358 [00:25<00:11,  9.73it/s] 70%|██████▉   | 250/358 [00:25<00:10,  9.83it/s] 70%|███████   | 251/358 [00:25<00:10,  9.77it/s] 70%|███████   | 252/358 [00:25<00:10,  9.71it/s] 71%|███████   | 253/358 [00:25<00:10,  9.67it/s] 71%|███████   | 254/358 [00:25<00:10,  9.64it/s] 72%|███████▏  | 256/358 [00:26<00:10,  9.82it/s] 72%|███████▏  | 257/358 [00:26<00:10,  9.82it/s] 72%|███████▏  | 258/358 [00:26<00:10,  9.68it/s] 72%|███████▏  | 259/358 [00:26<00:10,  9.65it/s] 73%|███████▎  | 260/358 [00:26<00:10,  9.69it/s] 73%|███████▎  | 262/358 [00:26<00:09,  9.87it/s] 74%|███████▎  | 264/358 [00:26<00:09,  9.89it/s] 74%|███████▍  | 266/358 [00:27<00:09,  9.88it/s] 75%|███████▍  | 267/358 [00:27<00:09,  9.82it/s] 75%|███████▌  | 269/358 [00:27<00:09,  9.88it/s] 75%|███████▌  | 270/358 [00:27<00:08,  9.81it/s] 76%|███████▌  | 271/358 [00:27<00:08,  9.74it/s] 76%|███████▌  | 272/358 [00:27<00:08,  9.71it/s] 76%|███████▋  | 273/358 [00:27<00:08,  9.61it/s] 77%|███████▋  | 274/358 [00:27<00:08,  9.61it/s] 77%|███████▋  | 275/358 [00:28<00:08,  9.66it/s] 77%|███████▋  | 276/358 [00:28<00:08,  9.66it/s] 77%|███████▋  | 277/358 [00:28<00:08,  9.63it/s] 78%|███████▊  | 278/358 [00:28<00:08,  9.61it/s] 78%|███████▊  | 280/358 [00:28<00:07,  9.80it/s] 78%|███████▊  | 281/358 [00:28<00:07,  9.81it/s] 79%|███████▉  | 282/358 [00:28<00:07,  9.75it/s] 79%|███████▉  | 283/358 [00:28<00:07,  9.68it/s] 79%|███████▉  | 284/358 [00:29<00:07,  9.65it/s] 80%|███████▉  | 285/358 [00:29<00:07,  9.71it/s] 80%|███████▉  | 286/358 [00:29<00:07,  9.67it/s] 80%|████████  | 287/358 [00:29<00:07,  9.65it/s] 80%|████████  | 288/358 [00:29<00:07,  9.61it/s] 81%|████████  | 289/358 [00:29<00:07,  9.72it/s] 81%|████████▏ | 291/358 [00:29<00:06,  9.83it/s] 82%|████████▏ | 293/358 [00:29<00:06,  9.83it/s] 82%|████████▏ | 295/358 [00:30<00:06,  9.90it/s] 83%|████████▎ | 296/358 [00:30<00:06,  9.84it/s] 83%|████████▎ | 297/358 [00:30<00:06,  9.73it/s] 84%|████████▎ | 299/358 [00:30<00:05,  9.88it/s] 84%|████████▍ | 301/358 [00:30<00:05,  9.92it/s] 84%|████████▍ | 302/358 [00:30<00:05,  9.85it/s] 85%|████████▍ | 303/358 [00:30<00:05,  9.86it/s] 85%|████████▌ | 305/358 [00:31<00:05,  9.89it/s] 85%|████████▌ | 306/358 [00:31<00:05,  9.81it/s] 86%|████████▌ | 308/358 [00:31<00:05,  9.91it/s] 86%|████████▋ | 309/358 [00:31<00:04,  9.81it/s] 87%|████████▋ | 310/358 [00:31<00:04,  9.75it/s] 87%|████████▋ | 311/358 [00:31<00:04,  9.67it/s] 87%|████████▋ | 312/358 [00:31<00:04,  9.69it/s] 87%|████████▋ | 313/358 [00:31<00:04,  9.71it/s] 88%|████████▊ | 315/358 [00:32<00:04,  9.97it/s] 88%|████████▊ | 316/358 [00:32<00:04,  9.92it/s] 89%|████████▊ | 317/358 [00:32<00:04,  9.84it/s] 89%|████████▉ | 318/358 [00:32<00:04,  9.79it/s] 89%|████████▉ | 319/358 [00:32<00:04,  9.74it/s] 89%|████████▉ | 320/358 [00:32<00:03,  9.80it/s] 90%|████████▉ | 321/358 [00:32<00:03,  9.73it/s] 90%|████████▉ | 322/358 [00:32<00:03,  9.69it/s] 90%|█████████ | 323/358 [00:32<00:03,  9.64it/s] 91%|█████████ | 324/358 [00:33<00:03,  9.61it/s] 91%|█████████ | 325/358 [00:33<00:03,  9.59it/s] 91%|█████████▏| 327/358 [00:33<00:03,  9.95it/s] 92%|█████████▏| 329/358 [00:33<00:02, 10.05it/s] 92%|█████████▏| 330/358 [00:33<00:02,  9.94it/s] 93%|█████████▎| 332/358 [00:33<00:02, 10.04it/s] 93%|█████████▎| 334/358 [00:34<00:02,  9.94it/s] 94%|█████████▎| 335/358 [00:34<00:02,  9.81it/s] 94%|█████████▍| 337/358 [00:34<00:02,  9.89it/s] 95%|█████████▍| 339/358 [00:34<00:01, 10.10it/s] 95%|█████████▌| 341/358 [00:34<00:01, 10.04it/s] 96%|█████████▌| 342/358 [00:34<00:01,  9.96it/s] 96%|█████████▌| 343/358 [00:34<00:01,  9.85it/s] 96%|█████████▌| 344/358 [00:35<00:01,  9.79it/s] 96%|█████████▋| 345/358 [00:35<00:01,  9.82it/s] 97%|█████████▋| 346/358 [00:35<00:01,  9.86it/s] 97%|█████████▋| 348/358 [00:35<00:01,  9.96it/s] 97%|█████████▋| 349/358 [00:35<00:00,  9.87it/s] 98%|█████████▊| 350/358 [00:35<00:00,  9.79it/s] 98%|█████████▊| 351/358 [00:35<00:00,  9.74it/s] 99%|█████████▊| 353/358 [00:36<00:00,  9.92it/s] 99%|█████████▉| 354/358 [00:36<00:00,  9.90it/s] 99%|█████████▉| 355/358 [00:36<00:00,  9.81it/s]100%|█████████▉| 357/358 [00:36<00:00,  9.86it/s]100%|██████████| 358/358 [00:36<00:00,  9.81it/s]
[32m2025-02-05 05:46:11.987[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    gen_loss  grad clip ratio  grad norm   ppl
        2.08                1      3.341 8.007[0m
[32m2025-02-05 05:46:11.987[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m169[0m - [1m[Valid][0m
  0%|          | 0/10256 [00:00<?, ?it/s]100%|██████████| 10256/10256 [00:00<00:00, 918200.64it/s]
[32m2025-02-05 05:46:11.999[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:27,  1.43it/s]  5%|▌         | 2/40 [00:01<00:26,  1.45it/s]  8%|▊         | 3/40 [00:02<00:25,  1.46it/s] 10%|█         | 4/40 [00:02<00:24,  1.46it/s] 12%|█▎        | 5/40 [00:03<00:24,  1.45it/s] 15%|█▌        | 6/40 [00:04<00:23,  1.45it/s] 18%|█▊        | 7/40 [00:04<00:22,  1.46it/s] 20%|██        | 8/40 [00:05<00:21,  1.46it/s] 22%|██▎       | 9/40 [00:06<00:21,  1.46it/s] 25%|██▌       | 10/40 [00:06<00:20,  1.46it/s] 28%|██▊       | 11/40 [00:07<00:19,  1.47it/s] 30%|███       | 12/40 [00:08<00:19,  1.47it/s] 32%|███▎      | 13/40 [00:08<00:18,  1.47it/s] 35%|███▌      | 14/40 [00:09<00:17,  1.46it/s] 38%|███▊      | 15/40 [00:10<00:17,  1.45it/s] 40%|████      | 16/40 [00:10<00:16,  1.45it/s] 42%|████▎     | 17/40 [00:11<00:15,  1.46it/s] 45%|████▌     | 18/40 [00:12<00:15,  1.46it/s] 48%|████▊     | 19/40 [00:13<00:14,  1.45it/s] 50%|█████     | 20/40 [00:13<00:13,  1.46it/s] 52%|█████▎    | 21/40 [00:14<00:12,  1.47it/s] 55%|█████▌    | 22/40 [00:15<00:12,  1.47it/s] 57%|█████▊    | 23/40 [00:15<00:11,  1.46it/s] 60%|██████    | 24/40 [00:16<00:10,  1.46it/s] 62%|██████▎   | 25/40 [00:17<00:10,  1.46it/s] 65%|██████▌   | 26/40 [00:17<00:09,  1.47it/s] 68%|██████▊   | 27/40 [00:18<00:08,  1.47it/s] 70%|███████   | 28/40 [00:19<00:08,  1.47it/s] 72%|███████▎  | 29/40 [00:19<00:07,  1.46it/s] 75%|███████▌  | 30/40 [00:20<00:06,  1.47it/s] 78%|███████▊  | 31/40 [00:21<00:06,  1.47it/s] 80%|████████  | 32/40 [00:21<00:05,  1.47it/s] 82%|████████▎ | 33/40 [00:22<00:04,  1.46it/s] 85%|████████▌ | 34/40 [00:23<00:04,  1.47it/s] 88%|████████▊ | 35/40 [00:23<00:03,  1.46it/s] 90%|█████████ | 36/40 [00:24<00:02,  1.45it/s] 92%|█████████▎| 37/40 [00:25<00:02,  1.46it/s] 95%|█████████▌| 38/40 [00:26<00:01,  1.45it/s] 98%|█████████▊| 39/40 [00:26<00:00,  1.45it/s]100%|██████████| 40/40 [00:27<00:00,  1.60it/s]100%|██████████| 40/40 [00:27<00:00,  1.47it/s]
[32m2025-02-05 05:46:39.182[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    average  bleu@1  bleu@2  bleu@3  bleu@4  dist@1  dist@2  dist@3  dist@4  extreme  \
      .7748   .2969   .1084  .04437  .02377  .04299   .2911   .5803   .7573    .5872   
      f1  gen_loss  greedy  intra_dist@1  intra_dist@2  intra_dist@3  intra_dist@4  \
   .3510     4.661   .6676         .8791         .9706         .9579         .9123   
     ppl  rouge1  rouge2  rougeL  
   105.8   .3860  .08984   .3735[0m
[32m2025-02-05 05:46:39.188[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m163[0m - [1m[Conversation epoch 36][0m
[32m2025-02-05 05:46:39.188[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m164[0m - [1m[Train][0m
  0%|          | 0/92414 [00:00<?, ?it/s]100%|██████████| 92414/92414 [00:00<00:00, 1100802.60it/s]
[32m2025-02-05 05:46:39.272[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/358 [00:00<?, ?it/s]  0%|          | 1/358 [00:00<00:36,  9.76it/s]  1%|          | 3/358 [00:00<00:35,  9.93it/s]  1%|          | 4/358 [00:00<00:35,  9.91it/s]  2%|▏         | 6/358 [00:00<00:35,  9.87it/s]  2%|▏         | 7/358 [00:00<00:35,  9.80it/s]  2%|▏         | 8/358 [00:00<00:35,  9.84it/s]  3%|▎         | 9/358 [00:00<00:35,  9.74it/s]  3%|▎         | 10/358 [00:01<00:35,  9.73it/s]  3%|▎         | 11/358 [00:01<00:35,  9.68it/s]  4%|▎         | 13/358 [00:01<00:34,  9.90it/s]  4%|▍         | 14/358 [00:01<00:35,  9.83it/s]  4%|▍         | 15/358 [00:01<00:35,  9.75it/s]  4%|▍         | 16/358 [00:01<00:35,  9.69it/s]  5%|▍         | 17/358 [00:01<00:35,  9.71it/s]  5%|▌         | 18/358 [00:01<00:34,  9.78it/s]  5%|▌         | 19/358 [00:01<00:34,  9.71it/s]  6%|▌         | 20/358 [00:02<00:35,  9.66it/s]  6%|▌         | 21/358 [00:02<00:35,  9.59it/s]  6%|▌         | 22/358 [00:02<00:34,  9.66it/s]  7%|▋         | 24/358 [00:02<00:34,  9.76it/s]  7%|▋         | 25/358 [00:02<00:34,  9.70it/s]  7%|▋         | 26/358 [00:02<00:34,  9.66it/s]  8%|▊         | 27/358 [00:02<00:34,  9.71it/s]  8%|▊         | 28/358 [00:02<00:34,  9.66it/s]  8%|▊         | 29/358 [00:02<00:34,  9.63it/s]  9%|▊         | 31/358 [00:03<00:33,  9.73it/s]  9%|▉         | 32/358 [00:03<00:33,  9.72it/s]  9%|▉         | 34/358 [00:03<00:32,  9.83it/s] 10%|█         | 36/358 [00:03<00:32,  9.83it/s] 10%|█         | 37/358 [00:03<00:32,  9.81it/s] 11%|█         | 38/358 [00:03<00:32,  9.77it/s] 11%|█         | 40/358 [00:04<00:32,  9.93it/s] 11%|█▏        | 41/358 [00:04<00:32,  9.84it/s] 12%|█▏        | 43/358 [00:04<00:31,  9.87it/s] 13%|█▎        | 45/358 [00:04<00:31,  9.96it/s] 13%|█▎        | 47/358 [00:04<00:31,  9.94it/s] 13%|█▎        | 48/358 [00:04<00:31,  9.92it/s] 14%|█▍        | 50/358 [00:05<00:31,  9.90it/s] 14%|█▍        | 51/358 [00:05<00:31,  9.83it/s] 15%|█▍        | 52/358 [00:05<00:31,  9.74it/s] 15%|█▍        | 53/358 [00:05<00:31,  9.69it/s] 15%|█▌        | 54/358 [00:05<00:31,  9.73it/s] 15%|█▌        | 55/358 [00:05<00:31,  9.68it/s] 16%|█▌        | 56/358 [00:05<00:31,  9.72it/s] 16%|█▌        | 57/358 [00:05<00:31,  9.68it/s] 16%|█▌        | 58/358 [00:05<00:31,  9.66it/s] 16%|█▋        | 59/358 [00:06<00:31,  9.63it/s] 17%|█▋        | 61/358 [00:06<00:30,  9.71it/s] 17%|█▋        | 62/358 [00:06<00:30,  9.63it/s] 18%|█▊        | 63/358 [00:06<00:30,  9.70it/s] 18%|█▊        | 64/358 [00:06<00:30,  9.65it/s] 18%|█▊        | 66/358 [00:06<00:30,  9.72it/s] 19%|█▊        | 67/358 [00:06<00:29,  9.71it/s] 19%|█▉        | 69/358 [00:07<00:29,  9.77it/s] 20%|█▉        | 70/358 [00:07<00:29,  9.71it/s] 20%|█▉        | 71/358 [00:07<00:29,  9.76it/s] 20%|██        | 72/358 [00:07<00:29,  9.70it/s] 20%|██        | 73/358 [00:07<00:29,  9.68it/s] 21%|██        | 74/358 [00:07<00:29,  9.64it/s] 21%|██        | 75/358 [00:07<00:29,  9.61it/s] 21%|██        | 76/358 [00:07<00:29,  9.71it/s] 22%|██▏       | 77/358 [00:07<00:29,  9.68it/s] 22%|██▏       | 79/358 [00:08<00:28,  9.69it/s] 23%|██▎       | 81/358 [00:08<00:28,  9.75it/s] 23%|██▎       | 83/358 [00:08<00:28,  9.77it/s] 23%|██▎       | 84/358 [00:08<00:28,  9.72it/s] 24%|██▎       | 85/358 [00:08<00:28,  9.67it/s] 24%|██▍       | 86/358 [00:08<00:28,  9.66it/s] 24%|██▍       | 87/358 [00:08<00:28,  9.64it/s] 25%|██▍       | 88/358 [00:09<00:27,  9.66it/s] 25%|██▌       | 90/358 [00:09<00:27,  9.90it/s] 26%|██▌       | 92/358 [00:09<00:26,  9.99it/s] 26%|██▌       | 93/358 [00:09<00:26,  9.96it/s] 26%|██▋       | 94/358 [00:09<00:26,  9.87it/s] 27%|██▋       | 96/358 [00:09<00:25, 10.15it/s] 27%|██▋       | 98/358 [00:10<00:25, 10.04it/s] 28%|██▊       | 99/358 [00:10<00:26,  9.95it/s] 28%|██▊       | 101/358 [00:10<00:25,  9.91it/s] 29%|██▉       | 103/358 [00:10<00:25,  9.90it/s] 29%|██▉       | 104/358 [00:10<00:25,  9.85it/s] 29%|██▉       | 105/358 [00:10<00:25,  9.78it/s] 30%|██▉       | 106/358 [00:10<00:25,  9.76it/s] 30%|███       | 108/358 [00:11<00:25,  9.79it/s] 30%|███       | 109/358 [00:11<00:25,  9.71it/s] 31%|███       | 110/358 [00:11<00:25,  9.69it/s] 31%|███       | 111/358 [00:11<00:25,  9.64it/s] 32%|███▏      | 113/358 [00:11<00:24,  9.90it/s] 32%|███▏      | 114/358 [00:11<00:24,  9.86it/s] 32%|███▏      | 115/358 [00:11<00:24,  9.77it/s] 32%|███▏      | 116/358 [00:11<00:24,  9.68it/s] 33%|███▎      | 117/358 [00:11<00:24,  9.65it/s] 33%|███▎      | 119/358 [00:12<00:24,  9.77it/s] 34%|███▍      | 121/358 [00:12<00:23,  9.97it/s] 34%|███▍      | 123/358 [00:12<00:23, 10.07it/s] 35%|███▍      | 125/358 [00:12<00:23, 10.05it/s] 35%|███▌      | 126/358 [00:12<00:23, 10.01it/s] 35%|███▌      | 127/358 [00:12<00:23,  9.96it/s] 36%|███▌      | 128/358 [00:13<00:23,  9.91it/s] 36%|███▋      | 130/358 [00:13<00:22,  9.98it/s] 37%|███▋      | 131/358 [00:13<00:22,  9.88it/s] 37%|███▋      | 132/358 [00:13<00:22,  9.90it/s] 37%|███▋      | 134/358 [00:13<00:22,  9.90it/s] 38%|███▊      | 135/358 [00:13<00:22,  9.84it/s] 38%|███▊      | 137/358 [00:13<00:22,  9.94it/s] 39%|███▊      | 138/358 [00:14<00:22,  9.92it/s] 39%|███▉      | 139/358 [00:14<00:22,  9.84it/s] 39%|███▉      | 141/358 [00:14<00:21,  9.96it/s] 40%|███▉      | 142/358 [00:14<00:21,  9.88it/s] 40%|███▉      | 143/358 [00:14<00:21,  9.85it/s] 40%|████      | 144/358 [00:14<00:21,  9.76it/s] 41%|████      | 145/358 [00:14<00:21,  9.78it/s] 41%|████      | 146/358 [00:14<00:21,  9.72it/s] 41%|████      | 147/358 [00:15<00:21,  9.66it/s] 41%|████▏     | 148/358 [00:15<00:21,  9.69it/s] 42%|████▏     | 149/358 [00:15<00:21,  9.68it/s] 42%|████▏     | 150/358 [00:15<00:21,  9.63it/s] 42%|████▏     | 151/358 [00:15<00:22,  9.36it/s] 42%|████▏     | 152/358 [00:15<00:21,  9.41it/s] 43%|████▎     | 153/358 [00:15<00:21,  9.43it/s] 43%|████▎     | 154/358 [00:15<00:21,  9.52it/s] 43%|████▎     | 155/358 [00:15<00:21,  9.54it/s] 44%|████▎     | 156/358 [00:15<00:20,  9.66it/s] 44%|████▍     | 157/358 [00:16<00:20,  9.60it/s] 44%|████▍     | 158/358 [00:16<00:20,  9.69it/s] 44%|████▍     | 159/358 [00:16<00:20,  9.68it/s] 45%|████▍     | 160/358 [00:16<00:20,  9.69it/s] 45%|████▌     | 162/358 [00:16<00:19,  9.98it/s] 46%|████▌     | 164/358 [00:16<00:19,  9.98it/s] 46%|████▌     | 165/358 [00:16<00:19,  9.94it/s] 47%|████▋     | 167/358 [00:17<00:19,  9.89it/s] 47%|████▋     | 169/358 [00:17<00:19,  9.92it/s] 48%|████▊     | 171/358 [00:17<00:18,  9.90it/s] 48%|████▊     | 172/358 [00:17<00:18,  9.85it/s] 48%|████▊     | 173/358 [00:17<00:18,  9.78it/s] 49%|████▉     | 175/358 [00:17<00:18,  9.81it/s] 49%|████▉     | 176/358 [00:17<00:18,  9.82it/s] 49%|████▉     | 177/358 [00:18<00:18,  9.80it/s] 50%|█████     | 179/358 [00:18<00:18,  9.83it/s] 50%|█████     | 180/358 [00:18<00:18,  9.76it/s] 51%|█████     | 182/358 [00:18<00:17,  9.92it/s] 51%|█████     | 183/358 [00:18<00:17,  9.87it/s] 51%|█████▏    | 184/358 [00:18<00:17,  9.76it/s] 52%|█████▏    | 185/358 [00:18<00:17,  9.71it/s] 52%|█████▏    | 187/358 [00:19<00:17,  9.91it/s] 53%|█████▎    | 188/358 [00:19<00:17,  9.86it/s] 53%|█████▎    | 189/358 [00:19<00:17,  9.80it/s] 53%|█████▎    | 190/358 [00:19<00:17,  9.85it/s] 53%|█████▎    | 191/358 [00:19<00:17,  9.68it/s] 54%|█████▎    | 192/358 [00:19<00:17,  9.64it/s] 54%|█████▍    | 193/358 [00:19<00:17,  9.64it/s] 54%|█████▍    | 194/358 [00:19<00:17,  9.63it/s] 54%|█████▍    | 195/358 [00:19<00:16,  9.71it/s] 55%|█████▌    | 197/358 [00:20<00:16,  9.90it/s] 55%|█████▌    | 198/358 [00:20<00:16,  9.82it/s] 56%|█████▌    | 199/358 [00:20<00:16,  9.85it/s] 56%|█████▌    | 200/358 [00:20<00:16,  9.78it/s] 56%|█████▌    | 201/358 [00:20<00:16,  9.74it/s] 57%|█████▋    | 203/358 [00:20<00:15,  9.84it/s] 57%|█████▋    | 204/358 [00:20<00:15,  9.73it/s] 57%|█████▋    | 205/358 [00:20<00:15,  9.69it/s] 58%|█████▊    | 207/358 [00:21<00:15,  9.86it/s] 58%|█████▊    | 208/358 [00:21<00:15,  9.79it/s] 59%|█████▊    | 210/358 [00:21<00:15,  9.80it/s] 59%|█████▉    | 212/358 [00:21<00:14,  9.79it/s] 60%|█████▉    | 214/358 [00:21<00:14,  9.87it/s] 60%|██████    | 215/358 [00:21<00:14,  9.81it/s] 60%|██████    | 216/358 [00:22<00:14,  9.75it/s] 61%|██████    | 217/358 [00:22<00:14,  9.78it/s] 61%|██████    | 218/358 [00:22<00:14,  9.75it/s] 61%|██████    | 219/358 [00:22<00:14,  9.75it/s] 62%|██████▏   | 221/358 [00:22<00:13,  9.89it/s] 62%|██████▏   | 222/358 [00:22<00:13,  9.78it/s] 62%|██████▏   | 223/358 [00:22<00:13,  9.73it/s] 63%|██████▎   | 224/358 [00:22<00:13,  9.67it/s] 63%|██████▎   | 225/358 [00:22<00:13,  9.76it/s] 63%|██████▎   | 226/358 [00:23<00:13,  9.71it/s] 64%|██████▎   | 228/358 [00:23<00:13,  9.74it/s] 64%|██████▍   | 229/358 [00:23<00:13,  9.72it/s] 64%|██████▍   | 230/358 [00:23<00:13,  9.67it/s] 65%|██████▍   | 232/358 [00:23<00:12,  9.72it/s] 65%|██████▌   | 234/358 [00:23<00:12, 10.01it/s] 66%|██████▌   | 236/358 [00:24<00:12,  9.96it/s] 66%|██████▋   | 238/358 [00:24<00:11, 10.01it/s] 67%|██████▋   | 240/358 [00:24<00:11,  9.97it/s] 68%|██████▊   | 242/358 [00:24<00:11,  9.95it/s] 68%|██████▊   | 243/358 [00:24<00:11,  9.89it/s] 68%|██████▊   | 244/358 [00:24<00:11,  9.83it/s] 69%|██████▊   | 246/358 [00:25<00:11,  9.85it/s] 69%|██████▉   | 247/358 [00:25<00:11,  9.78it/s] 69%|██████▉   | 248/358 [00:25<00:11,  9.74it/s] 70%|██████▉   | 250/358 [00:25<00:10,  9.83it/s] 70%|███████   | 251/358 [00:25<00:10,  9.77it/s] 70%|███████   | 252/358 [00:25<00:10,  9.70it/s] 71%|███████   | 253/358 [00:25<00:10,  9.67it/s] 71%|███████   | 254/358 [00:25<00:10,  9.64it/s] 72%|███████▏  | 256/358 [00:26<00:10,  9.82it/s] 72%|███████▏  | 257/358 [00:26<00:10,  9.82it/s] 72%|███████▏  | 258/358 [00:26<00:10,  9.69it/s] 72%|███████▏  | 259/358 [00:26<00:10,  9.66it/s] 73%|███████▎  | 260/358 [00:26<00:10,  9.69it/s] 73%|███████▎  | 262/358 [00:26<00:09,  9.87it/s] 74%|███████▎  | 264/358 [00:26<00:09,  9.89it/s] 74%|███████▍  | 266/358 [00:27<00:09,  9.88it/s] 75%|███████▍  | 267/358 [00:27<00:09,  9.82it/s] 75%|███████▌  | 269/358 [00:27<00:09,  9.88it/s] 75%|███████▌  | 270/358 [00:27<00:08,  9.81it/s] 76%|███████▌  | 271/358 [00:27<00:08,  9.74it/s] 76%|███████▌  | 272/358 [00:27<00:08,  9.72it/s] 76%|███████▋  | 273/358 [00:27<00:08,  9.62it/s] 77%|███████▋  | 274/358 [00:27<00:08,  9.62it/s] 77%|███████▋  | 275/358 [00:28<00:08,  9.66it/s] 77%|███████▋  | 276/358 [00:28<00:08,  9.67it/s] 77%|███████▋  | 277/358 [00:28<00:08,  9.64it/s] 78%|███████▊  | 278/358 [00:28<00:08,  9.61it/s] 78%|███████▊  | 280/358 [00:28<00:07,  9.80it/s] 78%|███████▊  | 281/358 [00:28<00:07,  9.81it/s] 79%|███████▉  | 282/358 [00:28<00:07,  9.76it/s] 79%|███████▉  | 283/358 [00:28<00:07,  9.69it/s] 79%|███████▉  | 284/358 [00:29<00:07,  9.65it/s] 80%|███████▉  | 285/358 [00:29<00:07,  9.72it/s] 80%|███████▉  | 286/358 [00:29<00:07,  9.68it/s] 80%|████████  | 287/358 [00:29<00:07,  9.65it/s] 80%|████████  | 288/358 [00:29<00:07,  9.61it/s] 81%|████████  | 289/358 [00:29<00:07,  9.72it/s] 81%|████████▏ | 291/358 [00:29<00:06,  9.83it/s] 82%|████████▏ | 293/358 [00:29<00:06,  9.83it/s] 82%|████████▏ | 295/358 [00:30<00:06,  9.90it/s] 83%|████████▎ | 296/358 [00:30<00:06,  9.83it/s] 83%|████████▎ | 297/358 [00:30<00:06,  9.73it/s] 84%|████████▎ | 299/358 [00:30<00:05,  9.88it/s] 84%|████████▍ | 301/358 [00:30<00:05,  9.92it/s] 84%|████████▍ | 302/358 [00:30<00:05,  9.85it/s] 85%|████████▍ | 303/358 [00:30<00:05,  9.86it/s] 85%|████████▌ | 305/358 [00:31<00:05,  9.88it/s] 85%|████████▌ | 306/358 [00:31<00:05,  9.81it/s] 86%|████████▌ | 308/358 [00:31<00:05,  9.91it/s] 86%|████████▋ | 309/358 [00:31<00:04,  9.81it/s] 87%|████████▋ | 310/358 [00:31<00:04,  9.75it/s] 87%|████████▋ | 311/358 [00:31<00:04,  9.68it/s] 87%|████████▋ | 312/358 [00:31<00:04,  9.69it/s] 87%|████████▋ | 313/358 [00:31<00:04,  9.71it/s] 88%|████████▊ | 315/358 [00:32<00:04,  9.97it/s] 88%|████████▊ | 316/358 [00:32<00:04,  9.92it/s] 89%|████████▊ | 317/358 [00:32<00:04,  9.83it/s] 89%|████████▉ | 318/358 [00:32<00:04,  9.78it/s] 89%|████████▉ | 319/358 [00:32<00:04,  9.74it/s] 89%|████████▉ | 320/358 [00:32<00:03,  9.80it/s] 90%|████████▉ | 321/358 [00:32<00:03,  9.73it/s] 90%|████████▉ | 322/358 [00:32<00:03,  9.69it/s] 90%|█████████ | 323/358 [00:32<00:03,  9.65it/s] 91%|█████████ | 324/358 [00:33<00:03,  9.61it/s] 91%|█████████ | 325/358 [00:33<00:03,  9.59it/s] 91%|█████████▏| 327/358 [00:33<00:03,  9.95it/s] 92%|█████████▏| 329/358 [00:33<00:02, 10.05it/s] 92%|█████████▏| 330/358 [00:33<00:02,  9.94it/s] 93%|█████████▎| 332/358 [00:33<00:02, 10.04it/s] 93%|█████████▎| 334/358 [00:34<00:02,  9.94it/s] 94%|█████████▎| 335/358 [00:34<00:02,  9.82it/s] 94%|█████████▍| 337/358 [00:34<00:02,  9.90it/s] 95%|█████████▍| 339/358 [00:34<00:01, 10.10it/s] 95%|█████████▌| 341/358 [00:34<00:01, 10.04it/s] 96%|█████████▌| 343/358 [00:35<00:01,  9.88it/s] 96%|█████████▌| 344/358 [00:35<00:01,  9.83it/s] 96%|█████████▋| 345/358 [00:35<00:01,  9.84it/s] 97%|█████████▋| 346/358 [00:35<00:01,  9.88it/s] 97%|█████████▋| 348/358 [00:35<00:01,  9.97it/s] 97%|█████████▋| 349/358 [00:35<00:00,  9.88it/s] 98%|█████████▊| 350/358 [00:35<00:00,  9.80it/s] 98%|█████████▊| 351/358 [00:35<00:00,  9.75it/s] 99%|█████████▊| 353/358 [00:36<00:00,  9.92it/s] 99%|█████████▉| 354/358 [00:36<00:00,  9.90it/s] 99%|█████████▉| 355/358 [00:36<00:00,  9.81it/s]100%|█████████▉| 357/358 [00:36<00:00,  9.86it/s]100%|██████████| 358/358 [00:36<00:00,  9.81it/s]
[32m2025-02-05 05:47:15.777[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    gen_loss  grad clip ratio  grad norm   ppl
       2.073                1      2.643 7.953[0m
[32m2025-02-05 05:47:15.777[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m169[0m - [1m[Valid][0m
  0%|          | 0/10256 [00:00<?, ?it/s]100%|██████████| 10256/10256 [00:00<00:00, 920263.17it/s]
[32m2025-02-05 05:47:15.789[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:27,  1.44it/s]  5%|▌         | 2/40 [00:01<00:26,  1.46it/s]  8%|▊         | 3/40 [00:02<00:25,  1.46it/s] 10%|█         | 4/40 [00:02<00:24,  1.46it/s] 12%|█▎        | 5/40 [00:03<00:24,  1.46it/s] 15%|█▌        | 6/40 [00:04<00:23,  1.45it/s] 18%|█▊        | 7/40 [00:04<00:22,  1.45it/s] 20%|██        | 8/40 [00:05<00:21,  1.46it/s] 22%|██▎       | 9/40 [00:06<00:21,  1.46it/s] 25%|██▌       | 10/40 [00:06<00:20,  1.46it/s] 28%|██▊       | 11/40 [00:07<00:19,  1.46it/s] 30%|███       | 12/40 [00:08<00:19,  1.47it/s] 32%|███▎      | 13/40 [00:08<00:18,  1.47it/s] 35%|███▌      | 14/40 [00:09<00:17,  1.46it/s] 38%|███▊      | 15/40 [00:10<00:17,  1.46it/s] 40%|████      | 16/40 [00:10<00:16,  1.45it/s] 42%|████▎     | 17/40 [00:11<00:15,  1.46it/s] 45%|████▌     | 18/40 [00:12<00:15,  1.47it/s] 48%|████▊     | 19/40 [00:13<00:14,  1.46it/s] 50%|█████     | 20/40 [00:13<00:13,  1.47it/s] 52%|█████▎    | 21/40 [00:14<00:12,  1.47it/s] 55%|█████▌    | 22/40 [00:15<00:12,  1.46it/s] 57%|█████▊    | 23/40 [00:15<00:11,  1.46it/s] 60%|██████    | 24/40 [00:16<00:11,  1.45it/s] 62%|██████▎   | 25/40 [00:17<00:10,  1.46it/s] 65%|██████▌   | 26/40 [00:17<00:09,  1.47it/s] 68%|██████▊   | 27/40 [00:18<00:08,  1.47it/s] 70%|███████   | 28/40 [00:19<00:08,  1.47it/s] 72%|███████▎  | 29/40 [00:19<00:07,  1.47it/s] 75%|███████▌  | 30/40 [00:20<00:06,  1.47it/s] 78%|███████▊  | 31/40 [00:21<00:06,  1.47it/s] 80%|████████  | 32/40 [00:21<00:05,  1.47it/s] 82%|████████▎ | 33/40 [00:22<00:04,  1.46it/s] 85%|████████▌ | 34/40 [00:23<00:04,  1.46it/s] 88%|████████▊ | 35/40 [00:23<00:03,  1.46it/s] 90%|█████████ | 36/40 [00:24<00:02,  1.46it/s] 92%|█████████▎| 37/40 [00:25<00:02,  1.46it/s] 95%|█████████▌| 38/40 [00:25<00:01,  1.45it/s] 98%|█████████▊| 39/40 [00:26<00:00,  1.45it/s]100%|██████████| 40/40 [00:27<00:00,  1.61it/s]100%|██████████| 40/40 [00:27<00:00,  1.47it/s]
[32m2025-02-05 05:47:42.952[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    average  bleu@1  bleu@2  bleu@3  bleu@4  dist@1  dist@2  dist@3  dist@4  extreme  \
      .7752   .2982   .1095  .04725  .02562  .04537   .3225   .6387   .8195    .5870   
      f1  gen_loss  greedy  intra_dist@1  intra_dist@2  intra_dist@3  intra_dist@4  \
   .3549     4.699   .6658         .8965         .9828         .9599         .9143   
     ppl  rouge1  rouge2  rougeL  
   109.9   .3848  .09146   .3718[0m
[32m2025-02-05 05:47:42.958[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m163[0m - [1m[Conversation epoch 37][0m
[32m2025-02-05 05:47:42.958[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m164[0m - [1m[Train][0m
  0%|          | 0/92414 [00:00<?, ?it/s]100%|██████████| 92414/92414 [00:00<00:00, 1114818.65it/s]
[32m2025-02-05 05:47:43.041[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/358 [00:00<?, ?it/s]  0%|          | 1/358 [00:00<00:36,  9.75it/s]  1%|          | 3/358 [00:00<00:35,  9.92it/s]  1%|          | 4/358 [00:00<00:35,  9.90it/s]  2%|▏         | 6/358 [00:00<00:35,  9.86it/s]  2%|▏         | 7/358 [00:00<00:35,  9.80it/s]  2%|▏         | 8/358 [00:00<00:35,  9.84it/s]  3%|▎         | 9/358 [00:00<00:35,  9.75it/s]  3%|▎         | 10/358 [00:01<00:35,  9.74it/s]  3%|▎         | 11/358 [00:01<00:35,  9.69it/s]  4%|▎         | 13/358 [00:01<00:34,  9.91it/s]  4%|▍         | 14/358 [00:01<00:34,  9.83it/s]  4%|▍         | 15/358 [00:01<00:35,  9.76it/s]  4%|▍         | 16/358 [00:01<00:35,  9.69it/s]  5%|▍         | 17/358 [00:01<00:35,  9.71it/s]  5%|▌         | 18/358 [00:01<00:34,  9.79it/s]  5%|▌         | 19/358 [00:01<00:34,  9.72it/s]  6%|▌         | 20/358 [00:02<00:34,  9.66it/s]  6%|▌         | 21/358 [00:02<00:35,  9.59it/s]  6%|▌         | 22/358 [00:02<00:34,  9.66it/s]  7%|▋         | 24/358 [00:02<00:34,  9.76it/s]  7%|▋         | 25/358 [00:02<00:34,  9.71it/s]  7%|▋         | 26/358 [00:02<00:34,  9.66it/s]  8%|▊         | 27/358 [00:02<00:34,  9.72it/s]  8%|▊         | 28/358 [00:02<00:34,  9.67it/s]  8%|▊         | 29/358 [00:02<00:34,  9.64it/s]  9%|▊         | 31/358 [00:03<00:33,  9.73it/s]  9%|▉         | 32/358 [00:03<00:33,  9.73it/s]  9%|▉         | 34/358 [00:03<00:32,  9.83it/s] 10%|█         | 36/358 [00:03<00:32,  9.83it/s] 10%|█         | 37/358 [00:03<00:32,  9.82it/s] 11%|█         | 38/358 [00:03<00:32,  9.77it/s] 11%|█         | 40/358 [00:04<00:32,  9.93it/s] 11%|█▏        | 41/358 [00:04<00:32,  9.85it/s] 12%|█▏        | 43/358 [00:04<00:31,  9.87it/s] 12%|█▏        | 44/358 [00:04<00:31,  9.90it/s] 13%|█▎        | 46/358 [00:04<00:31,  9.99it/s] 13%|█▎        | 47/358 [00:04<00:31,  9.94it/s] 13%|█▎        | 48/358 [00:04<00:31,  9.93it/s] 14%|█▍        | 50/358 [00:05<00:31,  9.90it/s] 14%|█▍        | 51/358 [00:05<00:31,  9.82it/s] 15%|█▍        | 52/358 [00:05<00:31,  9.73it/s] 15%|█▍        | 53/358 [00:05<00:31,  9.68it/s] 15%|█▌        | 54/358 [00:05<00:31,  9.73it/s] 15%|█▌        | 55/358 [00:05<00:31,  9.68it/s] 16%|█▌        | 56/358 [00:05<00:31,  9.72it/s] 16%|█▌        | 57/358 [00:05<00:31,  9.68it/s] 16%|█▌        | 58/358 [00:05<00:31,  9.65it/s] 16%|█▋        | 59/358 [00:06<00:31,  9.62it/s] 17%|█▋        | 61/358 [00:06<00:30,  9.70it/s] 17%|█▋        | 62/358 [00:06<00:30,  9.61it/s] 18%|█▊        | 63/358 [00:06<00:30,  9.68it/s] 18%|█▊        | 64/358 [00:06<00:30,  9.63it/s] 18%|█▊        | 66/358 [00:06<00:30,  9.70it/s] 19%|█▊        | 67/358 [00:06<00:30,  9.69it/s] 19%|█▉        | 69/358 [00:07<00:29,  9.75it/s] 20%|█▉        | 70/358 [00:07<00:29,  9.70it/s] 20%|█▉        | 71/358 [00:07<00:29,  9.75it/s] 20%|██        | 72/358 [00:07<00:29,  9.70it/s] 20%|██        | 73/358 [00:07<00:29,  9.67it/s] 21%|██        | 74/358 [00:07<00:29,  9.63it/s] 21%|██        | 75/358 [00:07<00:29,  9.60it/s] 21%|██        | 76/358 [00:07<00:29,  9.70it/s] 22%|██▏       | 77/358 [00:07<00:29,  9.67it/s] 22%|██▏       | 79/358 [00:08<00:29,  9.61it/s] 23%|██▎       | 81/358 [00:08<00:28,  9.70it/s] 23%|██▎       | 83/358 [00:08<00:28,  9.74it/s] 23%|██▎       | 84/358 [00:08<00:28,  9.69it/s] 24%|██▎       | 85/358 [00:08<00:28,  9.65it/s] 24%|██▍       | 86/358 [00:08<00:28,  9.64it/s] 24%|██▍       | 87/358 [00:08<00:28,  9.63it/s] 25%|██▍       | 88/358 [00:09<00:27,  9.65it/s] 25%|██▌       | 90/358 [00:09<00:27,  9.89it/s] 26%|██▌       | 92/358 [00:09<00:26,  9.98it/s] 26%|██▌       | 93/358 [00:09<00:26,  9.95it/s] 26%|██▋       | 94/358 [00:09<00:26,  9.87it/s] 27%|██▋       | 96/358 [00:09<00:25, 10.15it/s] 27%|██▋       | 98/358 [00:10<00:25, 10.03it/s] 28%|██▊       | 99/358 [00:10<00:26,  9.94it/s] 28%|██▊       | 101/358 [00:10<00:25,  9.91it/s] 29%|██▉       | 103/358 [00:10<00:25,  9.90it/s] 29%|██▉       | 104/358 [00:10<00:25,  9.85it/s] 29%|██▉       | 105/358 [00:10<00:25,  9.77it/s] 30%|██▉       | 106/358 [00:10<00:25,  9.76it/s] 30%|███       | 108/358 [00:11<00:25,  9.78it/s] 30%|███       | 109/358 [00:11<00:25,  9.70it/s] 31%|███       | 110/358 [00:11<00:25,  9.68it/s] 31%|███       | 111/358 [00:11<00:25,  9.63it/s] 32%|███▏      | 113/358 [00:11<00:24,  9.90it/s] 32%|███▏      | 114/358 [00:11<00:24,  9.85it/s] 32%|███▏      | 115/358 [00:11<00:24,  9.75it/s] 32%|███▏      | 116/358 [00:11<00:25,  9.66it/s] 33%|███▎      | 117/358 [00:11<00:25,  9.64it/s] 33%|███▎      | 119/358 [00:12<00:24,  9.76it/s] 34%|███▍      | 121/358 [00:12<00:23,  9.96it/s] 34%|███▍      | 123/358 [00:12<00:23, 10.06it/s] 35%|███▍      | 125/358 [00:12<00:23, 10.04it/s] 35%|███▌      | 126/358 [00:12<00:23, 10.00it/s] 35%|███▌      | 127/358 [00:12<00:23,  9.95it/s] 36%|███▌      | 128/358 [00:13<00:23,  9.90it/s] 36%|███▋      | 130/358 [00:13<00:22,  9.97it/s] 37%|███▋      | 131/358 [00:13<00:23,  9.87it/s] 37%|███▋      | 132/358 [00:13<00:22,  9.89it/s] 37%|███▋      | 134/358 [00:13<00:22,  9.91it/s] 38%|███▊      | 135/358 [00:13<00:22,  9.85it/s] 38%|███▊      | 137/358 [00:13<00:22,  9.94it/s] 39%|███▊      | 138/358 [00:14<00:22,  9.92it/s] 39%|███▉      | 139/358 [00:14<00:22,  9.83it/s] 39%|███▉      | 141/358 [00:14<00:21,  9.95it/s] 40%|███▉      | 142/358 [00:14<00:21,  9.87it/s] 40%|███▉      | 143/358 [00:14<00:21,  9.84it/s] 40%|████      | 144/358 [00:14<00:21,  9.76it/s] 41%|████      | 145/358 [00:14<00:21,  9.78it/s] 41%|████      | 146/358 [00:14<00:21,  9.72it/s] 41%|████      | 147/358 [00:15<00:21,  9.66it/s] 41%|████▏     | 148/358 [00:15<00:21,  9.69it/s] 42%|████▏     | 149/358 [00:15<00:21,  9.68it/s] 42%|████▏     | 150/358 [00:15<00:21,  9.64it/s] 42%|████▏     | 151/358 [00:15<00:22,  9.37it/s] 42%|████▏     | 152/358 [00:15<00:21,  9.42it/s] 43%|████▎     | 153/358 [00:15<00:21,  9.44it/s] 43%|████▎     | 154/358 [00:15<00:21,  9.53it/s] 43%|████▎     | 155/358 [00:15<00:21,  9.54it/s] 44%|████▎     | 156/358 [00:15<00:20,  9.66it/s] 44%|████▍     | 157/358 [00:16<00:20,  9.60it/s] 44%|████▍     | 158/358 [00:16<00:20,  9.69it/s] 44%|████▍     | 159/358 [00:16<00:20,  9.68it/s] 45%|████▍     | 160/358 [00:16<00:20,  9.69it/s] 45%|████▌     | 162/358 [00:16<00:19,  9.98it/s] 46%|████▌     | 164/358 [00:16<00:19,  9.98it/s] 46%|████▌     | 165/358 [00:16<00:19,  9.94it/s] 47%|████▋     | 167/358 [00:17<00:19,  9.88it/s] 47%|████▋     | 169/358 [00:17<00:19,  9.93it/s] 48%|████▊     | 171/358 [00:17<00:18,  9.91it/s] 48%|████▊     | 172/358 [00:17<00:18,  9.86it/s] 48%|████▊     | 173/358 [00:17<00:18,  9.79it/s] 49%|████▉     | 175/358 [00:17<00:18,  9.82it/s] 49%|████▉     | 176/358 [00:17<00:18,  9.83it/s] 49%|████▉     | 177/358 [00:18<00:18,  9.82it/s] 50%|█████     | 179/358 [00:18<00:18,  9.84it/s] 50%|█████     | 180/358 [00:18<00:18,  9.77it/s] 51%|█████     | 182/358 [00:18<00:17,  9.92it/s] 51%|█████     | 183/358 [00:18<00:17,  9.88it/s] 51%|█████▏    | 184/358 [00:18<00:17,  9.76it/s] 52%|█████▏    | 185/358 [00:18<00:17,  9.71it/s] 52%|█████▏    | 187/358 [00:19<00:17,  9.92it/s] 53%|█████▎    | 188/358 [00:19<00:17,  9.87it/s] 53%|█████▎    | 189/358 [00:19<00:17,  9.81it/s] 53%|█████▎    | 191/358 [00:19<00:17,  9.73it/s] 54%|█████▎    | 192/358 [00:19<00:17,  9.68it/s] 54%|█████▍    | 193/358 [00:19<00:17,  9.67it/s] 54%|█████▍    | 194/358 [00:19<00:16,  9.65it/s] 54%|█████▍    | 195/358 [00:19<00:16,  9.72it/s] 55%|█████▌    | 197/358 [00:20<00:16,  9.90it/s] 55%|█████▌    | 198/358 [00:20<00:16,  9.82it/s] 56%|█████▌    | 199/358 [00:20<00:16,  9.85it/s] 56%|█████▌    | 200/358 [00:20<00:16,  9.78it/s] 56%|█████▌    | 201/358 [00:20<00:16,  9.74it/s] 57%|█████▋    | 203/358 [00:20<00:15,  9.83it/s] 57%|█████▋    | 204/358 [00:20<00:15,  9.73it/s] 57%|█████▋    | 205/358 [00:20<00:15,  9.69it/s] 58%|█████▊    | 207/358 [00:21<00:15,  9.86it/s] 58%|█████▊    | 208/358 [00:21<00:15,  9.79it/s] 59%|█████▊    | 210/358 [00:21<00:15,  9.80it/s] 59%|█████▉    | 212/358 [00:21<00:14,  9.80it/s] 60%|█████▉    | 214/358 [00:21<00:14,  9.88it/s] 60%|██████    | 215/358 [00:21<00:14,  9.82it/s] 60%|██████    | 216/358 [00:22<00:14,  9.75it/s] 61%|██████    | 217/358 [00:22<00:14,  9.79it/s] 61%|██████    | 218/358 [00:22<00:14,  9.75it/s] 61%|██████    | 219/358 [00:22<00:14,  9.76it/s] 62%|██████▏   | 221/358 [00:22<00:13,  9.88it/s] 62%|██████▏   | 222/358 [00:22<00:13,  9.78it/s] 62%|██████▏   | 223/358 [00:22<00:13,  9.73it/s] 63%|██████▎   | 224/358 [00:22<00:13,  9.67it/s] 63%|██████▎   | 225/358 [00:22<00:13,  9.75it/s] 63%|██████▎   | 226/358 [00:23<00:13,  9.70it/s] 64%|██████▎   | 228/358 [00:23<00:13,  9.74it/s] 64%|██████▍   | 229/358 [00:23<00:13,  9.71it/s] 64%|██████▍   | 230/358 [00:23<00:13,  9.66it/s] 65%|██████▍   | 232/358 [00:23<00:12,  9.72it/s] 65%|██████▌   | 234/358 [00:23<00:12, 10.01it/s] 66%|██████▌   | 236/358 [00:24<00:12,  9.96it/s] 66%|██████▋   | 238/358 [00:24<00:11, 10.02it/s] 67%|██████▋   | 240/358 [00:24<00:11,  9.98it/s] 68%|██████▊   | 242/358 [00:24<00:11,  9.96it/s] 68%|██████▊   | 243/358 [00:24<00:11,  9.89it/s] 68%|██████▊   | 244/358 [00:24<00:11,  9.83it/s] 69%|██████▊   | 246/358 [00:25<00:11,  9.85it/s] 69%|██████▉   | 247/358 [00:25<00:11,  9.78it/s] 69%|██████▉   | 248/358 [00:25<00:11,  9.74it/s] 70%|██████▉   | 250/358 [00:25<00:10,  9.83it/s] 70%|███████   | 251/358 [00:25<00:10,  9.77it/s] 70%|███████   | 252/358 [00:25<00:10,  9.70it/s] 71%|███████   | 253/358 [00:25<00:10,  9.66it/s] 71%|███████   | 254/358 [00:25<00:10,  9.64it/s] 72%|███████▏  | 256/358 [00:26<00:10,  9.81it/s] 72%|███████▏  | 257/358 [00:26<00:10,  9.81it/s] 72%|███████▏  | 258/358 [00:26<00:10,  9.69it/s] 72%|███████▏  | 259/358 [00:26<00:10,  9.65it/s] 73%|███████▎  | 260/358 [00:26<00:10,  9.69it/s] 73%|███████▎  | 262/358 [00:26<00:09,  9.87it/s] 74%|███████▎  | 264/358 [00:26<00:09,  9.89it/s] 74%|███████▍  | 266/358 [00:27<00:09,  9.89it/s] 75%|███████▍  | 267/358 [00:27<00:09,  9.82it/s] 75%|███████▌  | 269/358 [00:27<00:09,  9.88it/s] 75%|███████▌  | 270/358 [00:27<00:08,  9.81it/s] 76%|███████▌  | 271/358 [00:27<00:08,  9.74it/s] 76%|███████▌  | 272/358 [00:27<00:08,  9.72it/s] 76%|███████▋  | 273/358 [00:27<00:08,  9.61it/s] 77%|███████▋  | 274/358 [00:27<00:08,  9.61it/s] 77%|███████▋  | 275/358 [00:28<00:08,  9.66it/s] 77%|███████▋  | 276/358 [00:28<00:08,  9.66it/s] 77%|███████▋  | 277/358 [00:28<00:08,  9.64it/s] 78%|███████▊  | 278/358 [00:28<00:08,  9.61it/s] 78%|███████▊  | 280/358 [00:28<00:07,  9.80it/s] 78%|███████▊  | 281/358 [00:28<00:07,  9.81it/s] 79%|███████▉  | 282/358 [00:28<00:07,  9.75it/s] 79%|███████▉  | 283/358 [00:28<00:07,  9.69it/s] 79%|███████▉  | 284/358 [00:29<00:07,  9.65it/s] 80%|███████▉  | 285/358 [00:29<00:07,  9.72it/s] 80%|███████▉  | 286/358 [00:29<00:07,  9.68it/s] 80%|████████  | 287/358 [00:29<00:07,  9.65it/s] 80%|████████  | 288/358 [00:29<00:07,  9.61it/s] 81%|████████  | 289/358 [00:29<00:07,  9.72it/s] 81%|████████▏ | 291/358 [00:29<00:06,  9.84it/s] 82%|████████▏ | 293/358 [00:29<00:06,  9.83it/s] 82%|████████▏ | 295/358 [00:30<00:06,  9.90it/s] 83%|████████▎ | 296/358 [00:30<00:06,  9.84it/s] 83%|████████▎ | 297/358 [00:30<00:06,  9.73it/s] 84%|████████▎ | 299/358 [00:30<00:05,  9.89it/s] 84%|████████▍ | 301/358 [00:30<00:05,  9.92it/s] 84%|████████▍ | 302/358 [00:30<00:05,  9.86it/s] 85%|████████▍ | 303/358 [00:30<00:05,  9.86it/s] 85%|████████▌ | 305/358 [00:31<00:05,  9.89it/s] 85%|████████▌ | 306/358 [00:31<00:05,  9.81it/s] 86%|████████▌ | 308/358 [00:31<00:05,  9.91it/s] 86%|████████▋ | 309/358 [00:31<00:04,  9.81it/s] 87%|████████▋ | 310/358 [00:31<00:04,  9.75it/s] 87%|████████▋ | 311/358 [00:31<00:04,  9.68it/s] 87%|████████▋ | 312/358 [00:31<00:04,  9.69it/s] 87%|████████▋ | 313/358 [00:31<00:04,  9.71it/s] 88%|████████▊ | 315/358 [00:32<00:04,  9.96it/s] 88%|████████▊ | 316/358 [00:32<00:04,  9.92it/s] 89%|████████▊ | 317/358 [00:32<00:04,  9.83it/s] 89%|████████▉ | 318/358 [00:32<00:04,  9.79it/s] 89%|████████▉ | 319/358 [00:32<00:04,  9.74it/s] 89%|████████▉ | 320/358 [00:32<00:03,  9.80it/s] 90%|████████▉ | 321/358 [00:32<00:03,  9.73it/s] 90%|████████▉ | 322/358 [00:32<00:03,  9.69it/s] 90%|█████████ | 323/358 [00:32<00:03,  9.64it/s] 91%|█████████ | 324/358 [00:33<00:03,  9.61it/s] 91%|█████████ | 325/358 [00:33<00:03,  9.59it/s] 91%|█████████▏| 327/358 [00:33<00:03,  9.95it/s] 92%|█████████▏| 329/358 [00:33<00:02, 10.05it/s] 92%|█████████▏| 330/358 [00:33<00:02,  9.94it/s] 93%|█████████▎| 332/358 [00:33<00:02, 10.03it/s] 93%|█████████▎| 334/358 [00:34<00:02,  9.94it/s] 94%|█████████▎| 335/358 [00:34<00:02,  9.82it/s] 94%|█████████▍| 337/358 [00:34<00:02,  9.89it/s] 95%|█████████▍| 339/358 [00:34<00:01, 10.10it/s] 95%|█████████▌| 341/358 [00:34<00:01, 10.04it/s] 96%|█████████▌| 342/358 [00:34<00:01,  9.96it/s] 96%|█████████▌| 343/358 [00:35<00:01,  9.85it/s] 96%|█████████▌| 344/358 [00:35<00:01,  9.79it/s] 96%|█████████▋| 345/358 [00:35<00:01,  9.82it/s] 97%|█████████▋| 347/358 [00:35<00:01, 10.03it/s] 97%|█████████▋| 348/358 [00:35<00:01,  9.92it/s] 97%|█████████▋| 349/358 [00:35<00:00,  9.84it/s] 98%|█████████▊| 350/358 [00:35<00:00,  9.76it/s] 98%|█████████▊| 351/358 [00:35<00:00,  9.72it/s] 99%|█████████▊| 353/358 [00:36<00:00,  9.91it/s] 99%|█████████▉| 354/358 [00:36<00:00,  9.89it/s] 99%|█████████▉| 355/358 [00:36<00:00,  9.80it/s]100%|█████████▉| 357/358 [00:36<00:00,  9.86it/s]100%|██████████| 358/358 [00:36<00:00,  9.81it/s]
[32m2025-02-05 05:48:19.551[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    gen_loss  grad clip ratio  grad norm   ppl
        2.06                1      2.674 7.844[0m
[32m2025-02-05 05:48:19.551[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m169[0m - [1m[Valid][0m
  0%|          | 0/10256 [00:00<?, ?it/s]100%|██████████| 10256/10256 [00:00<00:00, 1034554.64it/s]
[32m2025-02-05 05:48:19.562[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:27,  1.43it/s]  5%|▌         | 2/40 [00:01<00:26,  1.45it/s]  8%|▊         | 3/40 [00:02<00:25,  1.46it/s] 10%|█         | 4/40 [00:02<00:24,  1.46it/s] 12%|█▎        | 5/40 [00:03<00:24,  1.45it/s] 15%|█▌        | 6/40 [00:04<00:23,  1.45it/s] 18%|█▊        | 7/40 [00:04<00:22,  1.44it/s] 20%|██        | 8/40 [00:05<00:22,  1.45it/s] 22%|██▎       | 9/40 [00:06<00:21,  1.45it/s] 25%|██▌       | 10/40 [00:06<00:20,  1.45it/s] 28%|██▊       | 11/40 [00:07<00:19,  1.45it/s] 30%|███       | 12/40 [00:08<00:19,  1.45it/s] 32%|███▎      | 13/40 [00:08<00:18,  1.46it/s] 35%|███▌      | 14/40 [00:09<00:17,  1.45it/s] 38%|███▊      | 15/40 [00:10<00:17,  1.45it/s] 40%|████      | 16/40 [00:11<00:16,  1.44it/s] 42%|████▎     | 17/40 [00:11<00:15,  1.45it/s] 45%|████▌     | 18/40 [00:12<00:15,  1.45it/s] 48%|████▊     | 19/40 [00:13<00:14,  1.45it/s] 50%|█████     | 20/40 [00:13<00:13,  1.46it/s] 52%|█████▎    | 21/40 [00:14<00:13,  1.46it/s] 55%|█████▌    | 22/40 [00:15<00:12,  1.45it/s] 57%|█████▊    | 23/40 [00:15<00:11,  1.46it/s] 60%|██████    | 24/40 [00:16<00:11,  1.45it/s] 62%|██████▎   | 25/40 [00:17<00:10,  1.45it/s] 65%|██████▌   | 26/40 [00:17<00:09,  1.46it/s] 68%|██████▊   | 27/40 [00:18<00:08,  1.46it/s] 70%|███████   | 28/40 [00:19<00:08,  1.46it/s] 72%|███████▎  | 29/40 [00:19<00:07,  1.46it/s] 75%|███████▌  | 30/40 [00:20<00:06,  1.47it/s] 78%|███████▊  | 31/40 [00:21<00:06,  1.46it/s] 80%|████████  | 32/40 [00:22<00:05,  1.46it/s] 82%|████████▎ | 33/40 [00:22<00:04,  1.46it/s] 85%|████████▌ | 34/40 [00:23<00:04,  1.46it/s] 88%|████████▊ | 35/40 [00:24<00:03,  1.45it/s] 90%|█████████ | 36/40 [00:24<00:02,  1.45it/s] 92%|█████████▎| 37/40 [00:25<00:02,  1.45it/s] 95%|█████████▌| 38/40 [00:26<00:01,  1.45it/s] 98%|█████████▊| 39/40 [00:26<00:00,  1.44it/s]100%|██████████| 40/40 [00:27<00:00,  1.59it/s]100%|██████████| 40/40 [00:27<00:00,  1.46it/s]
[32m2025-02-05 05:48:46.896[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    average  bleu@1  bleu@2  bleu@3  bleu@4  dist@1  dist@2  dist@3  dist@4  extreme  \
      .7763   .3031   .1116  .04778   .0253  .04136   .2843   .5571   .7221    .5958   
      f1  gen_loss  greedy  intra_dist@1  intra_dist@2  intra_dist@3  intra_dist@4  \
   .3545     4.676   .6693         .8658         .9600         .9480         .9180   
     ppl  rouge1  rouge2  rougeL  
   107.4   .3906  .09274   .3773[0m
[32m2025-02-05 05:48:46.904[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m163[0m - [1m[Conversation epoch 38][0m
[32m2025-02-05 05:48:46.904[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m164[0m - [1m[Train][0m
  0%|          | 0/92414 [00:00<?, ?it/s]100%|██████████| 92414/92414 [00:00<00:00, 996071.89it/s]
[32m2025-02-05 05:48:46.997[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/358 [00:00<?, ?it/s]  0%|          | 1/358 [00:00<00:36,  9.74it/s]  1%|          | 3/358 [00:00<00:35,  9.91it/s]  1%|          | 4/358 [00:00<00:35,  9.89it/s]  2%|▏         | 6/358 [00:00<00:35,  9.86it/s]  2%|▏         | 7/358 [00:00<00:35,  9.79it/s]  2%|▏         | 8/358 [00:00<00:35,  9.84it/s]  3%|▎         | 9/358 [00:00<00:35,  9.74it/s]  3%|▎         | 10/358 [00:01<00:35,  9.73it/s]  3%|▎         | 11/358 [00:01<00:35,  9.67it/s]  4%|▎         | 13/358 [00:01<00:34,  9.89it/s]  4%|▍         | 14/358 [00:01<00:35,  9.82it/s]  4%|▍         | 15/358 [00:01<00:35,  9.75it/s]  4%|▍         | 16/358 [00:01<00:35,  9.68it/s]  5%|▍         | 17/358 [00:01<00:35,  9.70it/s]  5%|▌         | 18/358 [00:01<00:34,  9.78it/s]  5%|▌         | 19/358 [00:01<00:34,  9.71it/s]  6%|▌         | 20/358 [00:02<00:34,  9.66it/s]  6%|▌         | 21/358 [00:02<00:35,  9.58it/s]  6%|▌         | 22/358 [00:02<00:34,  9.65it/s]  7%|▋         | 24/358 [00:02<00:34,  9.75it/s]  7%|▋         | 25/358 [00:02<00:34,  9.70it/s]  7%|▋         | 26/358 [00:02<00:34,  9.65it/s]  8%|▊         | 27/358 [00:02<00:34,  9.71it/s]  8%|▊         | 28/358 [00:02<00:34,  9.66it/s]  8%|▊         | 29/358 [00:02<00:34,  9.63it/s]  9%|▊         | 31/358 [00:03<00:33,  9.73it/s]  9%|▉         | 32/358 [00:03<00:33,  9.73it/s]  9%|▉         | 34/358 [00:03<00:32,  9.83it/s] 10%|█         | 36/358 [00:03<00:32,  9.83it/s] 10%|█         | 37/358 [00:03<00:32,  9.81it/s] 11%|█         | 38/358 [00:03<00:32,  9.77it/s] 11%|█         | 40/358 [00:04<00:32,  9.92it/s] 11%|█▏        | 41/358 [00:04<00:32,  9.84it/s] 12%|█▏        | 43/358 [00:04<00:31,  9.86it/s] 12%|█▏        | 44/358 [00:04<00:31,  9.89it/s] 13%|█▎        | 46/358 [00:04<00:31,  9.98it/s] 13%|█▎        | 47/358 [00:04<00:31,  9.93it/s] 13%|█▎        | 48/358 [00:04<00:31,  9.92it/s] 14%|█▍        | 50/358 [00:05<00:31,  9.89it/s] 14%|█▍        | 51/358 [00:05<00:31,  9.82it/s] 15%|█▍        | 52/358 [00:05<00:31,  9.72it/s] 15%|█▍        | 53/358 [00:05<00:31,  9.67it/s] 15%|█▌        | 54/358 [00:05<00:31,  9.72it/s] 15%|█▌        | 55/358 [00:05<00:31,  9.67it/s] 16%|█▌        | 56/358 [00:05<00:31,  9.71it/s] 16%|█▌        | 57/358 [00:05<00:31,  9.67it/s] 16%|█▌        | 58/358 [00:05<00:31,  9.65it/s] 16%|█▋        | 59/358 [00:06<00:31,  9.62it/s] 17%|█▋        | 61/358 [00:06<00:30,  9.71it/s] 17%|█▋        | 62/358 [00:06<00:30,  9.63it/s] 18%|█▊        | 63/358 [00:06<00:30,  9.69it/s] 18%|█▊        | 64/358 [00:06<00:30,  9.65it/s] 18%|█▊        | 66/358 [00:06<00:30,  9.71it/s] 19%|█▊        | 67/358 [00:06<00:30,  9.69it/s] 19%|█▉        | 69/358 [00:07<00:29,  9.75it/s] 20%|█▉        | 70/358 [00:07<00:29,  9.70it/s] 20%|█▉        | 71/358 [00:07<00:29,  9.75it/s] 20%|██        | 72/358 [00:07<00:29,  9.70it/s] 20%|██        | 73/358 [00:07<00:29,  9.67it/s] 21%|██        | 74/358 [00:07<00:29,  9.64it/s] 21%|██        | 75/358 [00:07<00:29,  9.61it/s] 21%|██        | 76/358 [00:07<00:29,  9.71it/s] 22%|██▏       | 77/358 [00:07<00:29,  9.68it/s] 22%|██▏       | 79/358 [00:08<00:28,  9.69it/s] 23%|██▎       | 81/358 [00:08<00:28,  9.74it/s] 23%|██▎       | 83/358 [00:08<00:28,  9.77it/s] 23%|██▎       | 84/358 [00:08<00:28,  9.72it/s] 24%|██▎       | 85/358 [00:08<00:28,  9.67it/s] 24%|██▍       | 86/358 [00:08<00:28,  9.66it/s] 24%|██▍       | 87/358 [00:08<00:28,  9.64it/s] 25%|██▍       | 88/358 [00:09<00:27,  9.65it/s] 25%|██▌       | 90/358 [00:09<00:27,  9.89it/s] 26%|██▌       | 92/358 [00:09<00:26,  9.99it/s] 26%|██▌       | 93/358 [00:09<00:26,  9.95it/s] 26%|██▋       | 94/358 [00:09<00:26,  9.86it/s] 27%|██▋       | 96/358 [00:09<00:25, 10.14it/s] 27%|██▋       | 98/358 [00:10<00:25, 10.03it/s] 28%|██▊       | 99/358 [00:10<00:26,  9.94it/s] 28%|██▊       | 101/358 [00:10<00:25,  9.91it/s] 29%|██▉       | 103/358 [00:10<00:25,  9.90it/s] 29%|██▉       | 104/358 [00:10<00:25,  9.85it/s] 29%|██▉       | 105/358 [00:10<00:25,  9.77it/s] 30%|██▉       | 106/358 [00:10<00:25,  9.75it/s] 30%|███       | 108/358 [00:11<00:25,  9.78it/s] 30%|███       | 109/358 [00:11<00:25,  9.70it/s] 31%|███       | 110/358 [00:11<00:25,  9.68it/s] 31%|███       | 111/358 [00:11<00:25,  9.63it/s] 32%|███▏      | 113/358 [00:11<00:24,  9.90it/s] 32%|███▏      | 114/358 [00:11<00:24,  9.86it/s] 32%|███▏      | 115/358 [00:11<00:24,  9.76it/s] 32%|███▏      | 116/358 [00:11<00:25,  9.66it/s] 33%|███▎      | 117/358 [00:11<00:25,  9.64it/s] 33%|███▎      | 119/358 [00:12<00:24,  9.76it/s] 34%|███▍      | 121/358 [00:12<00:23,  9.96it/s] 34%|███▍      | 123/358 [00:12<00:23, 10.06it/s] 35%|███▍      | 125/358 [00:12<00:23, 10.04it/s] 35%|███▌      | 126/358 [00:12<00:23, 10.00it/s] 35%|███▌      | 127/358 [00:12<00:23,  9.96it/s] 36%|███▌      | 128/358 [00:13<00:23,  9.91it/s] 36%|███▋      | 130/358 [00:13<00:22,  9.97it/s] 37%|███▋      | 131/358 [00:13<00:22,  9.87it/s] 37%|███▋      | 132/358 [00:13<00:22,  9.89it/s] 37%|███▋      | 134/358 [00:13<00:22,  9.92it/s] 38%|███▊      | 135/358 [00:13<00:22,  9.86it/s] 38%|███▊      | 137/358 [00:13<00:22,  9.95it/s] 39%|███▊      | 138/358 [00:14<00:22,  9.93it/s] 39%|███▉      | 139/358 [00:14<00:22,  9.84it/s] 39%|███▉      | 141/358 [00:14<00:21,  9.97it/s] 40%|███▉      | 142/358 [00:14<00:21,  9.88it/s] 40%|███▉      | 143/358 [00:14<00:21,  9.85it/s] 40%|████      | 144/358 [00:14<00:21,  9.77it/s] 41%|████      | 145/358 [00:14<00:21,  9.79it/s] 41%|████      | 146/358 [00:14<00:21,  9.72it/s] 41%|████      | 147/358 [00:15<00:21,  9.66it/s] 41%|████▏     | 148/358 [00:15<00:21,  9.69it/s] 42%|████▏     | 149/358 [00:15<00:21,  9.67it/s] 42%|████▏     | 150/358 [00:15<00:21,  9.63it/s] 42%|████▏     | 151/358 [00:15<00:22,  9.37it/s] 42%|████▏     | 152/358 [00:15<00:21,  9.42it/s] 43%|████▎     | 153/358 [00:15<00:21,  9.44it/s] 43%|████▎     | 154/358 [00:15<00:21,  9.53it/s] 43%|████▎     | 155/358 [00:15<00:21,  9.54it/s] 44%|████▎     | 156/358 [00:15<00:20,  9.66it/s] 44%|████▍     | 157/358 [00:16<00:20,  9.61it/s] 44%|████▍     | 158/358 [00:16<00:20,  9.69it/s] 44%|████▍     | 159/358 [00:16<00:20,  9.68it/s] 45%|████▍     | 160/358 [00:16<00:20,  9.70it/s] 45%|████▌     | 162/358 [00:16<00:19,  9.99it/s] 46%|████▌     | 164/358 [00:16<00:19,  9.99it/s] 46%|████▌     | 165/358 [00:16<00:19,  9.95it/s] 47%|████▋     | 167/358 [00:17<00:19,  9.89it/s] 47%|████▋     | 169/358 [00:17<00:19,  9.93it/s] 48%|████▊     | 171/358 [00:17<00:18,  9.91it/s] 48%|████▊     | 172/358 [00:17<00:18,  9.86it/s] 48%|████▊     | 173/358 [00:17<00:18,  9.80it/s] 49%|████▉     | 175/358 [00:17<00:18,  9.82it/s] 49%|████▉     | 176/358 [00:17<00:18,  9.84it/s] 49%|████▉     | 177/358 [00:18<00:18,  9.82it/s] 50%|█████     | 179/358 [00:18<00:18,  9.85it/s] 50%|█████     | 180/358 [00:18<00:18,  9.78it/s] 51%|█████     | 182/358 [00:18<00:17,  9.92it/s] 51%|█████     | 183/358 [00:18<00:17,  9.88it/s] 51%|█████▏    | 184/358 [00:18<00:17,  9.77it/s] 52%|█████▏    | 185/358 [00:18<00:17,  9.71it/s] 52%|█████▏    | 187/358 [00:19<00:17,  9.93it/s] 53%|█████▎    | 188/358 [00:19<00:17,  9.88it/s] 53%|█████▎    | 189/358 [00:19<00:17,  9.82it/s] 53%|█████▎    | 190/358 [00:19<00:17,  9.86it/s] 53%|█████▎    | 191/358 [00:19<00:17,  9.69it/s] 54%|█████▎    | 192/358 [00:19<00:17,  9.64it/s] 54%|█████▍    | 193/358 [00:19<00:17,  9.65it/s] 54%|█████▍    | 194/358 [00:19<00:17,  9.63it/s] 54%|█████▍    | 195/358 [00:19<00:16,  9.71it/s] 55%|█████▌    | 197/358 [00:20<00:16,  9.90it/s] 55%|█████▌    | 198/358 [00:20<00:16,  9.82it/s] 56%|█████▌    | 199/358 [00:20<00:16,  9.86it/s] 56%|█████▌    | 200/358 [00:20<00:16,  9.79it/s] 56%|█████▌    | 201/358 [00:20<00:16,  9.75it/s] 57%|█████▋    | 203/358 [00:20<00:15,  9.84it/s] 57%|█████▋    | 204/358 [00:20<00:15,  9.73it/s] 57%|█████▋    | 205/358 [00:20<00:15,  9.69it/s] 58%|█████▊    | 207/358 [00:21<00:15,  9.86it/s] 58%|█████▊    | 208/358 [00:21<00:15,  9.79it/s] 59%|█████▊    | 210/358 [00:21<00:15,  9.80it/s] 59%|█████▉    | 212/358 [00:21<00:14,  9.80it/s] 60%|█████▉    | 214/358 [00:21<00:14,  9.88it/s] 60%|██████    | 215/358 [00:21<00:14,  9.81it/s] 60%|██████    | 216/358 [00:22<00:14,  9.75it/s] 61%|██████    | 217/358 [00:22<00:14,  9.79it/s] 61%|██████    | 218/358 [00:22<00:14,  9.76it/s] 61%|██████    | 219/358 [00:22<00:14,  9.76it/s] 62%|██████▏   | 221/358 [00:22<00:13,  9.90it/s] 62%|██████▏   | 222/358 [00:22<00:13,  9.79it/s] 62%|██████▏   | 223/358 [00:22<00:13,  9.73it/s] 63%|██████▎   | 224/358 [00:22<00:13,  9.68it/s] 63%|██████▎   | 225/358 [00:22<00:13,  9.76it/s] 63%|██████▎   | 226/358 [00:23<00:13,  9.71it/s] 64%|██████▎   | 228/358 [00:23<00:13,  9.75it/s] 64%|██████▍   | 229/358 [00:23<00:13,  9.72it/s] 64%|██████▍   | 230/358 [00:23<00:13,  9.67it/s] 65%|██████▍   | 232/358 [00:23<00:12,  9.72it/s] 65%|██████▌   | 234/358 [00:23<00:12, 10.01it/s] 66%|██████▌   | 236/358 [00:24<00:12,  9.97it/s] 66%|██████▋   | 238/358 [00:24<00:11, 10.02it/s] 67%|██████▋   | 240/358 [00:24<00:11,  9.98it/s] 68%|██████▊   | 242/358 [00:24<00:11,  9.96it/s] 68%|██████▊   | 243/358 [00:24<00:11,  9.90it/s] 68%|██████▊   | 244/358 [00:24<00:11,  9.83it/s] 69%|██████▊   | 246/358 [00:25<00:11,  9.86it/s] 69%|██████▉   | 247/358 [00:25<00:11,  9.78it/s] 69%|██████▉   | 248/358 [00:25<00:11,  9.74it/s] 70%|██████▉   | 250/358 [00:25<00:10,  9.83it/s] 70%|███████   | 251/358 [00:25<00:10,  9.77it/s] 70%|███████   | 252/358 [00:25<00:10,  9.71it/s] 71%|███████   | 253/358 [00:25<00:10,  9.67it/s] 71%|███████   | 254/358 [00:25<00:10,  9.64it/s] 72%|███████▏  | 256/358 [00:26<00:10,  9.82it/s] 72%|███████▏  | 257/358 [00:26<00:10,  9.83it/s] 72%|███████▏  | 258/358 [00:26<00:10,  9.70it/s] 72%|███████▏  | 259/358 [00:26<00:10,  9.66it/s] 73%|███████▎  | 260/358 [00:26<00:10,  9.70it/s] 73%|███████▎  | 262/358 [00:26<00:09,  9.88it/s] 74%|███████▎  | 264/358 [00:26<00:09,  9.90it/s] 74%|███████▍  | 266/358 [00:27<00:09,  9.89it/s] 75%|███████▍  | 267/358 [00:27<00:09,  9.83it/s] 75%|███████▌  | 269/358 [00:27<00:08,  9.89it/s] 75%|███████▌  | 270/358 [00:27<00:08,  9.82it/s] 76%|███████▌  | 271/358 [00:27<00:08,  9.74it/s] 76%|███████▌  | 272/358 [00:27<00:08,  9.72it/s] 76%|███████▋  | 273/358 [00:27<00:08,  9.62it/s] 77%|███████▋  | 274/358 [00:27<00:08,  9.62it/s] 77%|███████▋  | 275/358 [00:28<00:08,  9.66it/s] 77%|███████▋  | 276/358 [00:28<00:08,  9.67it/s] 77%|███████▋  | 277/358 [00:28<00:08,  9.64it/s] 78%|███████▊  | 278/358 [00:28<00:08,  9.61it/s] 78%|███████▊  | 280/358 [00:28<00:07,  9.81it/s] 78%|███████▊  | 281/358 [00:28<00:07,  9.82it/s] 79%|███████▉  | 282/358 [00:28<00:07,  9.76it/s] 79%|███████▉  | 283/358 [00:28<00:07,  9.70it/s] 79%|███████▉  | 284/358 [00:29<00:07,  9.66it/s] 80%|███████▉  | 285/358 [00:29<00:07,  9.73it/s] 80%|███████▉  | 286/358 [00:29<00:07,  9.68it/s] 80%|████████  | 287/358 [00:29<00:07,  9.66it/s] 80%|████████  | 288/358 [00:29<00:07,  9.62it/s] 81%|████████  | 289/358 [00:29<00:07,  9.73it/s] 81%|████████▏ | 291/358 [00:29<00:06,  9.84it/s] 82%|████████▏ | 293/358 [00:29<00:06,  9.84it/s] 82%|████████▏ | 295/358 [00:30<00:06,  9.90it/s] 83%|████████▎ | 296/358 [00:30<00:06,  9.84it/s] 83%|████████▎ | 297/358 [00:30<00:06,  9.73it/s] 84%|████████▎ | 299/358 [00:30<00:05,  9.89it/s] 84%|████████▍ | 301/358 [00:30<00:05,  9.92it/s] 84%|████████▍ | 302/358 [00:30<00:05,  9.86it/s] 85%|████████▍ | 303/358 [00:30<00:05,  9.86it/s] 85%|████████▌ | 305/358 [00:31<00:05,  9.89it/s] 85%|████████▌ | 306/358 [00:31<00:05,  9.82it/s] 86%|████████▌ | 308/358 [00:31<00:05,  9.92it/s] 86%|████████▋ | 309/358 [00:31<00:04,  9.81it/s] 87%|████████▋ | 310/358 [00:31<00:04,  9.76it/s] 87%|████████▋ | 311/358 [00:31<00:04,  9.68it/s] 87%|████████▋ | 312/358 [00:31<00:04,  9.70it/s] 87%|████████▋ | 313/358 [00:31<00:04,  9.71it/s] 88%|████████▊ | 315/358 [00:32<00:04,  9.97it/s] 88%|████████▊ | 316/358 [00:32<00:04,  9.92it/s] 89%|████████▊ | 317/358 [00:32<00:04,  9.84it/s] 89%|████████▉ | 318/358 [00:32<00:04,  9.79it/s] 89%|████████▉ | 319/358 [00:32<00:04,  9.75it/s] 89%|████████▉ | 320/358 [00:32<00:03,  9.81it/s] 90%|████████▉ | 321/358 [00:32<00:03,  9.73it/s] 90%|████████▉ | 322/358 [00:32<00:03,  9.69it/s] 90%|█████████ | 323/358 [00:32<00:03,  9.64it/s] 91%|█████████ | 324/358 [00:33<00:03,  9.62it/s] 91%|█████████ | 325/358 [00:33<00:03,  9.60it/s] 91%|█████████▏| 327/358 [00:33<00:03,  9.96it/s] 92%|█████████▏| 329/358 [00:33<00:02, 10.05it/s] 92%|█████████▏| 330/358 [00:33<00:02,  9.94it/s] 93%|█████████▎| 332/358 [00:33<00:02, 10.04it/s] 93%|█████████▎| 334/358 [00:34<00:02,  9.95it/s] 94%|█████████▎| 335/358 [00:34<00:02,  9.83it/s] 94%|█████████▍| 337/358 [00:34<00:02,  9.91it/s] 95%|█████████▍| 339/358 [00:34<00:01, 10.10it/s] 95%|█████████▌| 341/358 [00:34<00:01, 10.04it/s] 96%|█████████▌| 343/358 [00:34<00:01,  9.88it/s] 96%|█████████▌| 344/358 [00:35<00:01,  9.83it/s] 96%|█████████▋| 345/358 [00:35<00:01,  9.85it/s] 97%|█████████▋| 346/358 [00:35<00:01,  9.88it/s] 97%|█████████▋| 348/358 [00:35<00:01,  9.97it/s] 97%|█████████▋| 349/358 [00:35<00:00,  9.88it/s] 98%|█████████▊| 350/358 [00:35<00:00,  9.80it/s] 98%|█████████▊| 351/358 [00:35<00:00,  9.75it/s] 99%|█████████▊| 353/358 [00:36<00:00,  9.92it/s] 99%|█████████▉| 354/358 [00:36<00:00,  9.90it/s] 99%|█████████▉| 355/358 [00:36<00:00,  9.81it/s]100%|█████████▉| 357/358 [00:36<00:00,  9.86it/s]100%|██████████| 358/358 [00:36<00:00,  9.81it/s]
[32m2025-02-05 05:49:23.492[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    gen_loss  grad clip ratio  grad norm   ppl
       2.048                1      2.615 7.754[0m
[32m2025-02-05 05:49:23.493[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m169[0m - [1m[Valid][0m
  0%|          | 0/10256 [00:00<?, ?it/s]100%|██████████| 10256/10256 [00:00<00:00, 1041492.91it/s]
[32m2025-02-05 05:49:23.503[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:27,  1.44it/s]  5%|▌         | 2/40 [00:01<00:26,  1.45it/s]  8%|▊         | 3/40 [00:02<00:25,  1.46it/s] 10%|█         | 4/40 [00:02<00:24,  1.46it/s] 12%|█▎        | 5/40 [00:03<00:24,  1.46it/s] 15%|█▌        | 6/40 [00:04<00:23,  1.46it/s] 18%|█▊        | 7/40 [00:04<00:22,  1.45it/s] 20%|██        | 8/40 [00:05<00:21,  1.46it/s] 22%|██▎       | 9/40 [00:06<00:21,  1.46it/s] 25%|██▌       | 10/40 [00:06<00:20,  1.46it/s] 28%|██▊       | 11/40 [00:07<00:19,  1.46it/s] 30%|███       | 12/40 [00:08<00:19,  1.46it/s] 32%|███▎      | 13/40 [00:08<00:18,  1.46it/s] 35%|███▌      | 14/40 [00:09<00:17,  1.45it/s] 38%|███▊      | 15/40 [00:10<00:20,  1.22it/s] 40%|████      | 16/40 [00:11<00:18,  1.28it/s] 42%|████▎     | 17/40 [00:12<00:17,  1.33it/s] 45%|████▌     | 18/40 [00:12<00:16,  1.37it/s] 48%|████▊     | 19/40 [00:13<00:14,  1.40it/s] 50%|█████     | 20/40 [00:14<00:14,  1.42it/s] 52%|█████▎    | 21/40 [00:14<00:13,  1.44it/s] 55%|█████▌    | 22/40 [00:15<00:12,  1.44it/s] 57%|█████▊    | 23/40 [00:16<00:11,  1.45it/s] 60%|██████    | 24/40 [00:16<00:11,  1.45it/s] 62%|██████▎   | 25/40 [00:17<00:10,  1.45it/s] 65%|██████▌   | 26/40 [00:18<00:09,  1.47it/s] 68%|██████▊   | 27/40 [00:18<00:08,  1.47it/s] 70%|███████   | 28/40 [00:19<00:08,  1.47it/s] 72%|███████▎  | 29/40 [00:20<00:07,  1.47it/s] 75%|███████▌  | 30/40 [00:20<00:06,  1.47it/s] 78%|███████▊  | 31/40 [00:21<00:06,  1.47it/s] 80%|████████  | 32/40 [00:22<00:05,  1.47it/s] 82%|████████▎ | 33/40 [00:23<00:04,  1.46it/s] 85%|████████▌ | 34/40 [00:23<00:04,  1.46it/s] 88%|████████▊ | 35/40 [00:24<00:03,  1.46it/s] 90%|█████████ | 36/40 [00:25<00:02,  1.46it/s] 92%|█████████▎| 37/40 [00:25<00:02,  1.46it/s] 95%|█████████▌| 38/40 [00:26<00:01,  1.45it/s] 98%|█████████▊| 39/40 [00:27<00:00,  1.45it/s]100%|██████████| 40/40 [00:27<00:00,  1.61it/s]100%|██████████| 40/40 [00:27<00:00,  1.45it/s]
[32m2025-02-05 05:49:51.114[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    average  bleu@1  bleu@2  bleu@3  bleu@4  dist@1  dist@2  dist@3  dist@4  extreme  \
      .7761   .3024   .1143  .04917  .02748  .04532   .3036   .6037   .7846    .5889   
      f1  gen_loss  greedy  intra_dist@1  intra_dist@2  intra_dist@3  intra_dist@4  \
   .3573     4.787   .6698         .8887         .9772         .9594         .9147   
     ppl  rouge1  rouge2  rougeL  
   119.9   .3894  .09657   .3767[0m
[32m2025-02-05 05:49:51.121[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m163[0m - [1m[Conversation epoch 39][0m
[32m2025-02-05 05:49:51.121[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m164[0m - [1m[Train][0m
  0%|          | 0/92414 [00:00<?, ?it/s]100%|██████████| 92414/92414 [00:00<00:00, 989984.04it/s]
[32m2025-02-05 05:49:51.215[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/358 [00:00<?, ?it/s]  0%|          | 1/358 [00:00<00:36,  9.74it/s]  1%|          | 3/358 [00:00<00:35,  9.91it/s]  1%|          | 4/358 [00:00<00:35,  9.89it/s]  2%|▏         | 6/358 [00:00<00:35,  9.86it/s]  2%|▏         | 7/358 [00:00<00:35,  9.79it/s]  2%|▏         | 8/358 [00:00<00:35,  9.84it/s]  3%|▎         | 9/358 [00:00<00:35,  9.74it/s]  3%|▎         | 10/358 [00:01<00:35,  9.73it/s]  3%|▎         | 11/358 [00:01<00:35,  9.69it/s]  4%|▎         | 13/358 [00:01<00:34,  9.89it/s]  4%|▍         | 14/358 [00:01<00:35,  9.82it/s]  4%|▍         | 15/358 [00:01<00:35,  9.75it/s]  4%|▍         | 16/358 [00:01<00:35,  9.69it/s]  5%|▍         | 17/358 [00:01<00:35,  9.71it/s]  5%|▌         | 18/358 [00:01<00:34,  9.78it/s]  5%|▌         | 19/358 [00:01<00:34,  9.71it/s]  6%|▌         | 20/358 [00:02<00:34,  9.66it/s]  6%|▌         | 21/358 [00:02<00:35,  9.58it/s]  6%|▌         | 22/358 [00:02<00:34,  9.65it/s]  7%|▋         | 24/358 [00:02<00:34,  9.75it/s]  7%|▋         | 25/358 [00:02<00:34,  9.70it/s]  7%|▋         | 26/358 [00:02<00:34,  9.65it/s]  8%|▊         | 27/358 [00:02<00:34,  9.71it/s]  8%|▊         | 28/358 [00:02<00:34,  9.66it/s]  8%|▊         | 29/358 [00:02<00:34,  9.63it/s]  9%|▊         | 31/358 [00:03<00:33,  9.73it/s]  9%|▉         | 32/358 [00:03<00:33,  9.73it/s]  9%|▉         | 34/358 [00:03<00:32,  9.83it/s] 10%|█         | 36/358 [00:03<00:32,  9.83it/s] 10%|█         | 37/358 [00:03<00:32,  9.81it/s] 11%|█         | 38/358 [00:03<00:32,  9.77it/s] 11%|█         | 40/358 [00:04<00:32,  9.93it/s] 11%|█▏        | 41/358 [00:04<00:32,  9.84it/s] 12%|█▏        | 43/358 [00:04<00:31,  9.87it/s] 13%|█▎        | 45/358 [00:04<00:31,  9.97it/s] 13%|█▎        | 47/358 [00:04<00:31,  9.94it/s] 13%|█▎        | 48/358 [00:04<00:31,  9.93it/s] 14%|█▍        | 50/358 [00:05<00:31,  9.90it/s] 14%|█▍        | 51/358 [00:05<00:31,  9.83it/s] 15%|█▍        | 52/358 [00:05<00:31,  9.74it/s] 15%|█▍        | 53/358 [00:05<00:31,  9.69it/s] 15%|█▌        | 54/358 [00:05<00:31,  9.73it/s] 15%|█▌        | 55/358 [00:05<00:31,  9.68it/s] 16%|█▌        | 56/358 [00:05<00:31,  9.72it/s] 16%|█▌        | 57/358 [00:05<00:31,  9.68it/s] 16%|█▌        | 58/358 [00:05<00:31,  9.65it/s] 16%|█▋        | 59/358 [00:06<00:31,  9.62it/s] 17%|█▋        | 61/358 [00:06<00:30,  9.71it/s] 17%|█▋        | 62/358 [00:06<00:30,  9.63it/s] 18%|█▊        | 63/358 [00:06<00:30,  9.70it/s] 18%|█▊        | 64/358 [00:06<00:30,  9.65it/s] 18%|█▊        | 66/358 [00:06<00:30,  9.72it/s] 19%|█▊        | 67/358 [00:06<00:29,  9.70it/s] 19%|█▉        | 69/358 [00:07<00:29,  9.77it/s] 20%|█▉        | 70/358 [00:07<00:29,  9.71it/s] 20%|█▉        | 71/358 [00:07<00:29,  9.76it/s] 20%|██        | 72/358 [00:07<00:29,  9.71it/s] 20%|██        | 73/358 [00:07<00:29,  9.67it/s] 21%|██        | 74/358 [00:07<00:29,  9.64it/s] 21%|██        | 75/358 [00:07<00:29,  9.61it/s] 21%|██        | 76/358 [00:07<00:29,  9.71it/s] 22%|██▏       | 77/358 [00:07<00:29,  9.67it/s] 22%|██▏       | 79/358 [00:08<00:28,  9.69it/s] 23%|██▎       | 81/358 [00:08<00:28,  9.75it/s] 23%|██▎       | 83/358 [00:08<00:28,  9.77it/s] 23%|██▎       | 84/358 [00:08<00:28,  9.72it/s] 24%|██▎       | 85/358 [00:08<00:28,  9.67it/s] 24%|██▍       | 86/358 [00:08<00:28,  9.66it/s] 24%|██▍       | 87/358 [00:08<00:28,  9.64it/s] 25%|██▍       | 88/358 [00:09<00:27,  9.66it/s] 25%|██▌       | 90/358 [00:09<00:27,  9.90it/s] 26%|██▌       | 92/358 [00:09<00:26,  9.99it/s] 26%|██▌       | 93/358 [00:09<00:26,  9.96it/s] 26%|██▋       | 94/358 [00:09<00:26,  9.87it/s] 27%|██▋       | 96/358 [00:09<00:25, 10.15it/s] 27%|██▋       | 98/358 [00:10<00:25, 10.04it/s] 28%|██▊       | 99/358 [00:10<00:26,  9.95it/s] 28%|██▊       | 101/358 [00:10<00:25,  9.92it/s] 29%|██▉       | 103/358 [00:10<00:25,  9.91it/s] 29%|██▉       | 104/358 [00:10<00:25,  9.86it/s] 29%|██▉       | 105/358 [00:10<00:25,  9.78it/s] 30%|██▉       | 106/358 [00:10<00:25,  9.77it/s] 30%|███       | 108/358 [00:11<00:25,  9.79it/s] 30%|███       | 109/358 [00:11<00:25,  9.71it/s] 31%|███       | 110/358 [00:11<00:25,  9.69it/s] 31%|███       | 111/358 [00:11<00:25,  9.64it/s] 32%|███▏      | 113/358 [00:11<00:24,  9.91it/s] 32%|███▏      | 114/358 [00:11<00:24,  9.86it/s] 32%|███▏      | 115/358 [00:11<00:24,  9.77it/s] 32%|███▏      | 116/358 [00:11<00:24,  9.69it/s] 33%|███▎      | 117/358 [00:11<00:24,  9.66it/s] 33%|███▎      | 119/358 [00:12<00:24,  9.78it/s] 34%|███▍      | 121/358 [00:12<00:23,  9.98it/s] 34%|███▍      | 123/358 [00:12<00:23, 10.07it/s] 35%|███▍      | 125/358 [00:12<00:23, 10.05it/s] 35%|███▌      | 127/358 [00:12<00:23,  9.98it/s] 36%|███▌      | 128/358 [00:13<00:23,  9.94it/s] 36%|███▋      | 130/358 [00:13<00:22,  9.98it/s] 37%|███▋      | 131/358 [00:13<00:22,  9.89it/s] 37%|███▋      | 132/358 [00:13<00:22,  9.91it/s] 37%|███▋      | 134/358 [00:13<00:22,  9.93it/s] 38%|███▊      | 135/358 [00:13<00:22,  9.87it/s] 38%|███▊      | 137/358 [00:13<00:22,  9.96it/s] 39%|███▊      | 138/358 [00:14<00:22,  9.94it/s] 39%|███▉      | 139/358 [00:14<00:22,  9.85it/s] 39%|███▉      | 141/358 [00:14<00:21,  9.97it/s] 40%|███▉      | 142/358 [00:14<00:21,  9.89it/s] 40%|███▉      | 143/358 [00:14<00:21,  9.86it/s] 40%|████      | 144/358 [00:14<00:21,  9.78it/s] 41%|████      | 145/358 [00:14<00:21,  9.80it/s] 41%|████      | 146/358 [00:14<00:21,  9.74it/s] 41%|████      | 147/358 [00:14<00:21,  9.68it/s] 41%|████▏     | 148/358 [00:15<00:21,  9.70it/s] 42%|████▏     | 149/358 [00:15<00:21,  9.68it/s] 42%|████▏     | 150/358 [00:15<00:21,  9.64it/s] 42%|████▏     | 151/358 [00:15<00:22,  9.38it/s] 42%|████▏     | 152/358 [00:15<00:21,  9.43it/s] 43%|████▎     | 153/358 [00:15<00:21,  9.45it/s] 43%|████▎     | 154/358 [00:15<00:21,  9.54it/s] 43%|████▎     | 155/358 [00:15<00:21,  9.55it/s] 44%|████▎     | 156/358 [00:15<00:20,  9.67it/s] 44%|████▍     | 157/358 [00:16<00:20,  9.61it/s] 44%|████▍     | 158/358 [00:16<00:20,  9.70it/s] 44%|████▍     | 159/358 [00:16<00:20,  9.70it/s] 45%|████▍     | 160/358 [00:16<00:20,  9.70it/s] 45%|████▌     | 162/358 [00:16<00:19, 10.00it/s] 46%|████▌     | 164/358 [00:16<00:19, 10.00it/s] 46%|████▌     | 165/358 [00:16<00:19,  9.95it/s] 47%|████▋     | 167/358 [00:17<00:19,  9.90it/s] 47%|████▋     | 169/358 [00:17<00:19,  9.94it/s] 48%|████▊     | 171/358 [00:17<00:18,  9.92it/s] 48%|████▊     | 172/358 [00:17<00:18,  9.87it/s] 48%|████▊     | 173/358 [00:17<00:18,  9.80it/s] 49%|████▉     | 175/358 [00:17<00:18,  9.82it/s] 49%|████▉     | 176/358 [00:17<00:18,  9.83it/s] 49%|████▉     | 177/358 [00:18<00:18,  9.82it/s] 50%|█████     | 179/358 [00:18<00:18,  9.84it/s] 50%|█████     | 180/358 [00:18<00:18,  9.77it/s] 51%|█████     | 182/358 [00:18<00:17,  9.93it/s] 51%|█████     | 183/358 [00:18<00:17,  9.88it/s] 51%|█████▏    | 184/358 [00:18<00:17,  9.77it/s] 52%|█████▏    | 185/358 [00:18<00:17,  9.72it/s] 52%|█████▏    | 187/358 [00:19<00:17,  9.94it/s] 53%|█████▎    | 188/358 [00:19<00:17,  9.88it/s] 53%|█████▎    | 189/358 [00:19<00:17,  9.82it/s] 53%|█████▎    | 191/358 [00:19<00:17,  9.75it/s] 54%|█████▎    | 192/358 [00:19<00:17,  9.69it/s] 54%|█████▍    | 193/358 [00:19<00:17,  9.69it/s] 54%|█████▍    | 194/358 [00:19<00:16,  9.67it/s] 54%|█████▍    | 195/358 [00:19<00:16,  9.73it/s] 55%|█████▌    | 197/358 [00:20<00:16,  9.90it/s] 55%|█████▌    | 198/358 [00:20<00:16,  9.83it/s] 56%|█████▌    | 199/358 [00:20<00:16,  9.86it/s] 56%|█████▌    | 200/358 [00:20<00:16,  9.79it/s] 56%|█████▌    | 201/358 [00:20<00:16,  9.75it/s] 57%|█████▋    | 203/358 [00:20<00:15,  9.85it/s] 57%|█████▋    | 204/358 [00:20<00:15,  9.74it/s] 57%|█████▋    | 205/358 [00:20<00:15,  9.70it/s] 58%|█████▊    | 207/358 [00:21<00:15,  9.87it/s] 58%|█████▊    | 208/358 [00:21<00:15,  9.80it/s] 59%|█████▊    | 210/358 [00:21<00:15,  9.81it/s] 59%|█████▉    | 212/358 [00:21<00:14,  9.80it/s] 60%|█████▉    | 214/358 [00:21<00:14,  9.89it/s] 60%|██████    | 215/358 [00:21<00:14,  9.82it/s] 60%|██████    | 216/358 [00:22<00:14,  9.76it/s] 61%|██████    | 217/358 [00:22<00:14,  9.79it/s] 61%|██████    | 218/358 [00:22<00:14,  9.76it/s] 61%|██████    | 219/358 [00:22<00:14,  9.77it/s] 62%|██████▏   | 221/358 [00:22<00:13,  9.90it/s] 62%|██████▏   | 222/358 [00:22<00:13,  9.79it/s] 62%|██████▏   | 223/358 [00:22<00:13,  9.73it/s] 63%|██████▎   | 224/358 [00:22<00:13,  9.68it/s] 63%|██████▎   | 225/358 [00:22<00:13,  9.77it/s] 63%|██████▎   | 226/358 [00:23<00:13,  9.71it/s] 64%|██████▎   | 228/358 [00:23<00:13,  9.75it/s] 64%|██████▍   | 229/358 [00:23<00:13,  9.72it/s] 64%|██████▍   | 230/358 [00:23<00:13,  9.67it/s] 65%|██████▍   | 232/358 [00:23<00:12,  9.72it/s] 65%|██████▌   | 234/358 [00:23<00:12, 10.02it/s] 66%|██████▌   | 236/358 [00:24<00:12,  9.97it/s] 66%|██████▋   | 238/358 [00:24<00:11, 10.03it/s] 67%|██████▋   | 240/358 [00:24<00:11,  9.99it/s] 68%|██████▊   | 242/358 [00:24<00:11,  9.97it/s] 68%|██████▊   | 243/358 [00:24<00:11,  9.90it/s] 68%|██████▊   | 244/358 [00:24<00:11,  9.84it/s] 69%|██████▊   | 246/358 [00:25<00:11,  9.86it/s] 69%|██████▉   | 247/358 [00:25<00:11,  9.79it/s] 69%|██████▉   | 248/358 [00:25<00:11,  9.75it/s] 70%|██████▉   | 250/358 [00:25<00:10,  9.84it/s] 70%|███████   | 251/358 [00:25<00:10,  9.78it/s] 70%|███████   | 252/358 [00:25<00:10,  9.71it/s] 71%|███████   | 253/358 [00:25<00:10,  9.68it/s] 71%|███████   | 254/358 [00:25<00:10,  9.65it/s] 72%|███████▏  | 256/358 [00:26<00:10,  9.83it/s] 72%|███████▏  | 257/358 [00:26<00:10,  9.83it/s] 72%|███████▏  | 258/358 [00:26<00:10,  9.70it/s] 72%|███████▏  | 259/358 [00:26<00:10,  9.67it/s] 73%|███████▎  | 260/358 [00:26<00:10,  9.71it/s] 73%|███████▎  | 262/358 [00:26<00:09,  9.88it/s] 74%|███████▎  | 264/358 [00:26<00:09,  9.90it/s] 74%|███████▍  | 266/358 [00:27<00:09,  9.89it/s] 75%|███████▍  | 267/358 [00:27<00:09,  9.83it/s] 75%|███████▌  | 269/358 [00:27<00:08,  9.89it/s] 75%|███████▌  | 270/358 [00:27<00:08,  9.82it/s] 76%|███████▌  | 271/358 [00:27<00:08,  9.75it/s] 76%|███████▌  | 272/358 [00:27<00:08,  9.73it/s] 76%|███████▋  | 273/358 [00:27<00:08,  9.63it/s] 77%|███████▋  | 274/358 [00:27<00:08,  9.63it/s] 77%|███████▋  | 275/358 [00:28<00:08,  9.67it/s] 77%|███████▋  | 276/358 [00:28<00:08,  9.67it/s] 77%|███████▋  | 277/358 [00:28<00:08,  9.64it/s] 78%|███████▊  | 278/358 [00:28<00:08,  9.62it/s] 78%|███████▊  | 280/358 [00:28<00:07,  9.81it/s] 78%|███████▊  | 281/358 [00:28<00:07,  9.82it/s] 79%|███████▉  | 282/358 [00:28<00:07,  9.76it/s] 79%|███████▉  | 283/358 [00:28<00:07,  9.69it/s] 79%|███████▉  | 284/358 [00:28<00:07,  9.66it/s] 80%|███████▉  | 285/358 [00:29<00:07,  9.72it/s] 80%|███████▉  | 286/358 [00:29<00:07,  9.68it/s] 80%|████████  | 287/358 [00:29<00:07,  9.66it/s] 80%|████████  | 288/358 [00:29<00:07,  9.62it/s] 81%|████████  | 290/358 [00:29<00:06,  9.83it/s] 81%|████████▏ | 291/358 [00:29<00:06,  9.82it/s] 82%|████████▏ | 293/358 [00:29<00:06,  9.83it/s] 82%|████████▏ | 295/358 [00:30<00:06,  9.90it/s] 83%|████████▎ | 296/358 [00:30<00:06,  9.84it/s] 83%|████████▎ | 297/358 [00:30<00:06,  9.73it/s] 84%|████████▎ | 299/358 [00:30<00:05,  9.88it/s] 84%|████████▍ | 301/358 [00:30<00:05,  9.92it/s] 84%|████████▍ | 302/358 [00:30<00:05,  9.86it/s] 85%|████████▍ | 303/358 [00:30<00:05,  9.87it/s] 85%|████████▌ | 305/358 [00:31<00:05,  9.90it/s] 85%|████████▌ | 306/358 [00:31<00:05,  9.82it/s] 86%|████████▌ | 308/358 [00:31<00:05,  9.92it/s] 86%|████████▋ | 309/358 [00:31<00:04,  9.82it/s] 87%|████████▋ | 310/358 [00:31<00:04,  9.76it/s] 87%|████████▋ | 311/358 [00:31<00:04,  9.68it/s] 87%|████████▋ | 312/358 [00:31<00:04,  9.70it/s] 87%|████████▋ | 313/358 [00:31<00:04,  9.72it/s] 88%|████████▊ | 315/358 [00:32<00:04,  9.97it/s] 88%|████████▊ | 316/358 [00:32<00:04,  9.92it/s] 89%|████████▊ | 317/358 [00:32<00:04,  9.84it/s] 89%|████████▉ | 318/358 [00:32<00:04,  9.79it/s] 89%|████████▉ | 319/358 [00:32<00:04,  9.75it/s] 89%|████████▉ | 320/358 [00:32<00:03,  9.81it/s] 90%|████████▉ | 321/358 [00:32<00:03,  9.73it/s] 90%|████████▉ | 322/358 [00:32<00:03,  9.69it/s] 90%|█████████ | 323/358 [00:32<00:03,  9.65it/s] 91%|█████████ | 324/358 [00:33<00:03,  9.62it/s] 91%|█████████ | 325/358 [00:33<00:03,  9.60it/s] 91%|█████████▏| 327/358 [00:33<00:03,  9.96it/s] 92%|█████████▏| 329/358 [00:33<00:02, 10.06it/s] 92%|█████████▏| 330/358 [00:33<00:02,  9.95it/s] 93%|█████████▎| 332/358 [00:33<00:02, 10.05it/s] 93%|█████████▎| 334/358 [00:34<00:02,  9.95it/s] 94%|█████████▎| 335/358 [00:34<00:02,  9.83it/s] 94%|█████████▍| 337/358 [00:34<00:02,  9.91it/s] 95%|█████████▍| 339/358 [00:34<00:01, 10.11it/s] 95%|█████████▌| 341/358 [00:34<00:01, 10.05it/s] 96%|█████████▌| 343/358 [00:34<00:01,  9.89it/s] 96%|█████████▌| 344/358 [00:35<00:01,  9.83it/s] 96%|█████████▋| 345/358 [00:35<00:01,  9.85it/s] 97%|█████████▋| 346/358 [00:35<00:01,  9.88it/s] 97%|█████████▋| 348/358 [00:35<00:01,  9.97it/s] 97%|█████████▋| 349/358 [00:35<00:00,  9.89it/s] 98%|█████████▊| 350/358 [00:35<00:00,  9.81it/s] 98%|█████████▊| 351/358 [00:35<00:00,  9.76it/s] 99%|█████████▊| 353/358 [00:35<00:00,  9.92it/s] 99%|█████████▉| 354/358 [00:36<00:00,  9.90it/s] 99%|█████████▉| 355/358 [00:36<00:00,  9.81it/s]100%|█████████▉| 357/358 [00:36<00:00,  9.87it/s]100%|██████████| 358/358 [00:36<00:00,  9.82it/s]
[32m2025-02-05 05:50:27.691[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    gen_loss  grad clip ratio  grad norm  ppl
       2.029                1      3.088 7.61[0m
[32m2025-02-05 05:50:27.691[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m169[0m - [1m[Valid][0m
  0%|          | 0/10256 [00:00<?, ?it/s]100%|██████████| 10256/10256 [00:00<00:00, 1074774.68it/s]
[32m2025-02-05 05:50:27.701[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:26,  1.46it/s]  5%|▌         | 2/40 [00:01<00:25,  1.46it/s]  8%|▊         | 3/40 [00:02<00:25,  1.47it/s] 10%|█         | 4/40 [00:02<00:24,  1.47it/s] 12%|█▎        | 5/40 [00:03<00:23,  1.46it/s] 15%|█▌        | 6/40 [00:04<00:23,  1.46it/s] 18%|█▊        | 7/40 [00:04<00:22,  1.45it/s] 20%|██        | 8/40 [00:05<00:21,  1.46it/s] 22%|██▎       | 9/40 [00:06<00:21,  1.46it/s] 25%|██▌       | 10/40 [00:06<00:20,  1.46it/s] 28%|██▊       | 11/40 [00:07<00:19,  1.46it/s] 30%|███       | 12/40 [00:08<00:19,  1.46it/s] 32%|███▎      | 13/40 [00:08<00:18,  1.46it/s] 35%|███▌      | 14/40 [00:09<00:17,  1.45it/s] 38%|███▊      | 15/40 [00:10<00:17,  1.45it/s] 40%|████      | 16/40 [00:10<00:16,  1.45it/s] 42%|████▎     | 17/40 [00:11<00:15,  1.46it/s] 45%|████▌     | 18/40 [00:12<00:15,  1.46it/s] 48%|████▊     | 19/40 [00:13<00:14,  1.46it/s] 50%|█████     | 20/40 [00:13<00:13,  1.47it/s] 52%|█████▎    | 21/40 [00:14<00:12,  1.47it/s] 55%|█████▌    | 22/40 [00:15<00:12,  1.46it/s] 57%|█████▊    | 23/40 [00:15<00:11,  1.46it/s] 60%|██████    | 24/40 [00:16<00:11,  1.45it/s] 62%|██████▎   | 25/40 [00:17<00:10,  1.45it/s] 65%|██████▌   | 26/40 [00:17<00:09,  1.46it/s] 68%|██████▊   | 27/40 [00:18<00:08,  1.47it/s] 70%|███████   | 28/40 [00:19<00:08,  1.46it/s] 72%|███████▎  | 29/40 [00:19<00:07,  1.47it/s] 75%|███████▌  | 30/40 [00:20<00:06,  1.47it/s] 78%|███████▊  | 31/40 [00:21<00:06,  1.47it/s] 80%|████████  | 32/40 [00:21<00:05,  1.47it/s] 82%|████████▎ | 33/40 [00:22<00:04,  1.46it/s] 85%|████████▌ | 34/40 [00:23<00:04,  1.46it/s] 88%|████████▊ | 35/40 [00:23<00:03,  1.46it/s] 90%|█████████ | 36/40 [00:24<00:02,  1.45it/s] 92%|█████████▎| 37/40 [00:25<00:02,  1.46it/s] 95%|█████████▌| 38/40 [00:26<00:01,  1.45it/s] 98%|█████████▊| 39/40 [00:26<00:00,  1.45it/s]100%|██████████| 40/40 [00:27<00:00,  1.60it/s]100%|██████████| 40/40 [00:27<00:00,  1.47it/s]
[32m2025-02-05 05:50:54.903[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    average  bleu@1  bleu@2  bleu@3  bleu@4  dist@1  dist@2  dist@3  dist@4  extreme  \
      .7758   .3082   .1153  .04638  .02332  .04272   .2846   .5645   .7304    .5963   
      f1  gen_loss  greedy  intra_dist@1  intra_dist@2  intra_dist@3  intra_dist@4  \
   .3546     4.809   .6726         .8670         .9599         .9392         .9048   
     ppl  rouge1  rouge2  rougeL  
   122.6   .3909  .09515   .3780[0m
[32m2025-02-05 05:50:54.908[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m163[0m - [1m[Conversation epoch 40][0m
[32m2025-02-05 05:50:54.909[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m164[0m - [1m[Train][0m
  0%|          | 0/92414 [00:00<?, ?it/s]100%|██████████| 92414/92414 [00:00<00:00, 994046.20it/s]
[32m2025-02-05 05:50:55.002[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/358 [00:00<?, ?it/s]  0%|          | 1/358 [00:00<00:36,  9.72it/s]  1%|          | 3/358 [00:00<00:35,  9.92it/s]  1%|          | 4/358 [00:00<00:35,  9.89it/s]  2%|▏         | 6/358 [00:00<00:35,  9.86it/s]  2%|▏         | 7/358 [00:00<00:35,  9.80it/s]  2%|▏         | 8/358 [00:00<00:35,  9.84it/s]  3%|▎         | 9/358 [00:00<00:35,  9.74it/s]  3%|▎         | 10/358 [00:01<00:35,  9.73it/s]  3%|▎         | 11/358 [00:01<00:35,  9.68it/s]  4%|▎         | 13/358 [00:01<00:34,  9.90it/s]  4%|▍         | 14/358 [00:01<00:35,  9.83it/s]  4%|▍         | 15/358 [00:01<00:35,  9.75it/s]  4%|▍         | 16/358 [00:01<00:35,  9.69it/s]  5%|▍         | 17/358 [00:01<00:35,  9.70it/s]  5%|▌         | 18/358 [00:01<00:34,  9.78it/s]  5%|▌         | 19/358 [00:01<00:34,  9.71it/s]  6%|▌         | 20/358 [00:02<00:34,  9.66it/s]  6%|▌         | 21/358 [00:02<00:35,  9.59it/s]  6%|▌         | 22/358 [00:02<00:34,  9.66it/s]  7%|▋         | 24/358 [00:02<00:34,  9.76it/s]  7%|▋         | 25/358 [00:02<00:34,  9.71it/s]  7%|▋         | 26/358 [00:02<00:34,  9.66it/s]  8%|▊         | 27/358 [00:02<00:34,  9.71it/s]  8%|▊         | 28/358 [00:02<00:34,  9.67it/s]  8%|▊         | 29/358 [00:02<00:34,  9.64it/s]  9%|▊         | 31/358 [00:03<00:33,  9.74it/s]  9%|▉         | 32/358 [00:03<00:33,  9.73it/s]  9%|▉         | 34/358 [00:03<00:32,  9.84it/s] 10%|█         | 36/358 [00:03<00:32,  9.83it/s] 10%|█         | 37/358 [00:03<00:32,  9.82it/s] 11%|█         | 38/358 [00:03<00:32,  9.77it/s] 11%|█         | 40/358 [00:04<00:32,  9.93it/s] 11%|█▏        | 41/358 [00:04<00:32,  9.84it/s] 12%|█▏        | 43/358 [00:04<00:31,  9.87it/s] 13%|█▎        | 45/358 [00:04<00:31,  9.97it/s] 13%|█▎        | 47/358 [00:04<00:31,  9.94it/s] 13%|█▎        | 48/358 [00:04<00:31,  9.93it/s] 14%|█▍        | 50/358 [00:05<00:31,  9.90it/s] 14%|█▍        | 51/358 [00:05<00:31,  9.83it/s] 15%|█▍        | 52/358 [00:05<00:31,  9.74it/s] 15%|█▍        | 53/358 [00:05<00:31,  9.69it/s] 15%|█▌        | 54/358 [00:05<00:31,  9.73it/s] 15%|█▌        | 55/358 [00:05<00:31,  9.68it/s] 16%|█▌        | 56/358 [00:05<00:31,  9.72it/s] 16%|█▌        | 57/358 [00:05<00:31,  9.68it/s] 16%|█▌        | 58/358 [00:05<00:31,  9.65it/s] 16%|█▋        | 59/358 [00:06<00:31,  9.63it/s] 17%|█▋        | 61/358 [00:06<00:30,  9.71it/s] 17%|█▋        | 62/358 [00:06<00:30,  9.63it/s] 18%|█▊        | 63/358 [00:06<00:30,  9.70it/s] 18%|█▊        | 64/358 [00:06<00:30,  9.65it/s] 18%|█▊        | 66/358 [00:06<00:30,  9.72it/s] 19%|█▊        | 67/358 [00:06<00:29,  9.71it/s] 19%|█▉        | 69/358 [00:07<00:29,  9.77it/s] 20%|█▉        | 70/358 [00:07<00:29,  9.72it/s] 20%|█▉        | 71/358 [00:07<00:29,  9.76it/s] 20%|██        | 72/358 [00:07<00:29,  9.71it/s] 20%|██        | 73/358 [00:07<00:29,  9.67it/s] 21%|██        | 74/358 [00:07<00:29,  9.64it/s] 21%|██        | 75/358 [00:07<00:29,  9.61it/s] 21%|██        | 76/358 [00:07<00:29,  9.71it/s] 22%|██▏       | 77/358 [00:07<00:29,  9.68it/s] 22%|██▏       | 79/358 [00:08<00:28,  9.68it/s] 23%|██▎       | 81/358 [00:08<00:28,  9.74it/s] 23%|██▎       | 83/358 [00:08<00:28,  9.77it/s] 23%|██▎       | 84/358 [00:08<00:28,  9.72it/s] 24%|██▎       | 85/358 [00:08<00:28,  9.67it/s] 24%|██▍       | 86/358 [00:08<00:28,  9.66it/s] 24%|██▍       | 87/358 [00:08<00:28,  9.64it/s] 25%|██▍       | 88/358 [00:09<00:27,  9.66it/s] 25%|██▌       | 90/358 [00:09<00:27,  9.90it/s] 26%|██▌       | 92/358 [00:09<00:26,  9.99it/s] 26%|██▌       | 93/358 [00:09<00:26,  9.96it/s] 26%|██▋       | 94/358 [00:09<00:26,  9.87it/s] 27%|██▋       | 96/358 [00:09<00:25, 10.15it/s] 27%|██▋       | 98/358 [00:10<00:25, 10.04it/s] 28%|██▊       | 99/358 [00:10<00:26,  9.95it/s] 28%|██▊       | 101/358 [00:10<00:25,  9.92it/s] 29%|██▉       | 103/358 [00:10<00:25,  9.91it/s] 29%|██▉       | 104/358 [00:10<00:25,  9.86it/s] 29%|██▉       | 105/358 [00:10<00:25,  9.78it/s] 30%|██▉       | 106/358 [00:10<00:25,  9.76it/s] 30%|███       | 108/358 [00:11<00:25,  9.79it/s] 30%|███       | 109/358 [00:11<00:25,  9.71it/s] 31%|███       | 110/358 [00:11<00:25,  9.69it/s] 31%|███       | 111/358 [00:11<00:25,  9.64it/s] 32%|███▏      | 113/358 [00:11<00:24,  9.90it/s] 32%|███▏      | 114/358 [00:11<00:24,  9.86it/s] 32%|███▏      | 115/358 [00:11<00:24,  9.76it/s] 32%|███▏      | 116/358 [00:11<00:25,  9.68it/s] 33%|███▎      | 117/358 [00:11<00:24,  9.65it/s] 33%|███▎      | 119/358 [00:12<00:24,  9.77it/s] 34%|███▍      | 121/358 [00:12<00:23,  9.97it/s] 34%|███▍      | 123/358 [00:12<00:23, 10.07it/s] 35%|███▍      | 125/358 [00:12<00:23, 10.05it/s] 35%|███▌      | 126/358 [00:12<00:23, 10.01it/s] 35%|███▌      | 127/358 [00:12<00:23,  9.96it/s] 36%|███▌      | 128/358 [00:13<00:23,  9.91it/s] 36%|███▋      | 130/358 [00:13<00:22,  9.98it/s] 37%|███▋      | 131/358 [00:13<00:22,  9.88it/s] 37%|███▋      | 132/358 [00:13<00:22,  9.90it/s] 37%|███▋      | 134/358 [00:13<00:22,  9.92it/s] 38%|███▊      | 135/358 [00:13<00:22,  9.85it/s] 38%|███▊      | 137/358 [00:13<00:22,  9.95it/s] 39%|███▊      | 138/358 [00:14<00:22,  9.93it/s] 39%|███▉      | 139/358 [00:14<00:22,  9.84it/s] 39%|███▉      | 141/358 [00:14<00:21,  9.97it/s] 40%|███▉      | 142/358 [00:14<00:21,  9.89it/s] 40%|███▉      | 143/358 [00:14<00:21,  9.86it/s] 40%|████      | 144/358 [00:14<00:21,  9.77it/s] 41%|████      | 145/358 [00:14<00:21,  9.79it/s] 41%|████      | 146/358 [00:14<00:21,  9.73it/s] 41%|████      | 147/358 [00:14<00:21,  9.67it/s] 41%|████▏     | 148/358 [00:15<00:21,  9.70it/s] 42%|████▏     | 149/358 [00:15<00:21,  9.69it/s] 42%|████▏     | 150/358 [00:15<00:21,  9.65it/s] 42%|████▏     | 151/358 [00:15<00:22,  9.38it/s] 42%|████▏     | 152/358 [00:15<00:21,  9.43it/s] 43%|████▎     | 153/358 [00:15<00:21,  9.45it/s] 43%|████▎     | 154/358 [00:15<00:21,  9.53it/s] 43%|████▎     | 155/358 [00:15<00:21,  9.54it/s] 44%|████▎     | 156/358 [00:15<00:20,  9.67it/s] 44%|████▍     | 157/358 [00:16<00:20,  9.61it/s] 44%|████▍     | 158/358 [00:16<00:20,  9.69it/s] 44%|████▍     | 159/358 [00:16<00:20,  9.69it/s] 45%|████▍     | 160/358 [00:16<00:20,  9.70it/s] 45%|████▌     | 162/358 [00:16<00:19,  9.99it/s] 46%|████▌     | 164/358 [00:16<00:19,  9.99it/s] 46%|████▌     | 165/358 [00:16<00:19,  9.95it/s] 47%|████▋     | 167/358 [00:17<00:19,  9.90it/s] 47%|████▋     | 169/358 [00:17<00:19,  9.93it/s] 48%|████▊     | 171/358 [00:17<00:18,  9.92it/s] 48%|████▊     | 172/358 [00:17<00:18,  9.86it/s] 48%|████▊     | 173/358 [00:17<00:18,  9.80it/s] 49%|████▉     | 175/358 [00:17<00:18,  9.83it/s] 49%|████▉     | 176/358 [00:17<00:18,  9.84it/s] 49%|████▉     | 177/358 [00:18<00:18,  9.83it/s] 50%|█████     | 179/358 [00:18<00:18,  9.85it/s] 50%|█████     | 180/358 [00:18<00:18,  9.77it/s] 51%|█████     | 182/358 [00:18<00:17,  9.93it/s] 51%|█████     | 183/358 [00:18<00:17,  9.88it/s] 51%|█████▏    | 184/358 [00:18<00:17,  9.77it/s] 52%|█████▏    | 185/358 [00:18<00:17,  9.72it/s] 52%|█████▏    | 187/358 [00:19<00:17,  9.93it/s] 53%|█████▎    | 188/358 [00:19<00:17,  9.88it/s] 53%|█████▎    | 189/358 [00:19<00:17,  9.82it/s] 53%|█████▎    | 191/358 [00:19<00:17,  9.74it/s] 54%|█████▎    | 192/358 [00:19<00:17,  9.69it/s] 54%|█████▍    | 193/358 [00:19<00:17,  9.68it/s] 54%|█████▍    | 194/358 [00:19<00:16,  9.66it/s] 54%|█████▍    | 195/358 [00:19<00:16,  9.72it/s] 55%|█████▌    | 197/358 [00:20<00:16,  9.90it/s] 55%|█████▌    | 198/358 [00:20<00:16,  9.83it/s] 56%|█████▌    | 199/358 [00:20<00:16,  9.86it/s] 56%|█████▌    | 200/358 [00:20<00:16,  9.79it/s] 56%|█████▌    | 201/358 [00:20<00:16,  9.76it/s] 57%|█████▋    | 203/358 [00:20<00:15,  9.85it/s] 57%|█████▋    | 204/358 [00:20<00:15,  9.74it/s] 57%|█████▋    | 205/358 [00:20<00:15,  9.69it/s] 58%|█████▊    | 207/358 [00:21<00:15,  9.86it/s] 58%|█████▊    | 208/358 [00:21<00:15,  9.79it/s] 59%|█████▊    | 210/358 [00:21<00:15,  9.81it/s] 59%|█████▉    | 212/358 [00:21<00:14,  9.80it/s] 60%|█████▉    | 214/358 [00:21<00:14,  9.88it/s] 60%|██████    | 215/358 [00:21<00:14,  9.82it/s] 60%|██████    | 216/358 [00:22<00:14,  9.75it/s] 61%|██████    | 217/358 [00:22<00:14,  9.79it/s] 61%|██████    | 218/358 [00:22<00:14,  9.76it/s] 61%|██████    | 219/358 [00:22<00:14,  9.76it/s] 62%|██████▏   | 221/358 [00:22<00:13,  9.89it/s] 62%|██████▏   | 222/358 [00:22<00:13,  9.79it/s] 62%|██████▏   | 223/358 [00:22<00:13,  9.74it/s] 63%|██████▎   | 224/358 [00:22<00:13,  9.68it/s] 63%|██████▎   | 225/358 [00:22<00:13,  9.76it/s] 63%|██████▎   | 226/358 [00:23<00:13,  9.71it/s] 64%|██████▎   | 228/358 [00:23<00:13,  9.75it/s] 64%|██████▍   | 229/358 [00:23<00:13,  9.72it/s] 64%|██████▍   | 230/358 [00:23<00:13,  9.67it/s] 65%|██████▍   | 232/358 [00:23<00:12,  9.72it/s] 65%|██████▌   | 234/358 [00:23<00:12, 10.02it/s] 66%|██████▌   | 236/358 [00:24<00:12,  9.97it/s] 66%|██████▋   | 238/358 [00:24<00:11, 10.03it/s] 67%|██████▋   | 240/358 [00:24<00:11,  9.99it/s] 68%|██████▊   | 242/358 [00:24<00:11,  9.96it/s] 68%|██████▊   | 243/358 [00:24<00:11,  9.90it/s] 68%|██████▊   | 244/358 [00:24<00:11,  9.84it/s] 69%|██████▊   | 246/358 [00:25<00:11,  9.86it/s] 69%|██████▉   | 247/358 [00:25<00:11,  9.78it/s] 69%|██████▉   | 248/358 [00:25<00:11,  9.74it/s] 70%|██████▉   | 250/358 [00:25<00:10,  9.84it/s] 70%|███████   | 251/358 [00:25<00:10,  9.78it/s] 70%|███████   | 252/358 [00:25<00:10,  9.71it/s] 71%|███████   | 253/358 [00:25<00:10,  9.67it/s] 71%|███████   | 254/358 [00:25<00:10,  9.65it/s] 72%|███████▏  | 256/358 [00:26<00:10,  9.82it/s] 72%|███████▏  | 257/358 [00:26<00:10,  9.82it/s] 72%|███████▏  | 258/358 [00:26<00:10,  9.70it/s] 72%|███████▏  | 259/358 [00:26<00:10,  9.67it/s] 73%|███████▎  | 260/358 [00:26<00:10,  9.70it/s] 73%|███████▎  | 262/358 [00:26<00:09,  9.88it/s] 74%|███████▎  | 264/358 [00:26<00:09,  9.90it/s] 74%|███████▍  | 266/358 [00:27<00:09,  9.89it/s] 75%|███████▍  | 267/358 [00:27<00:09,  9.83it/s] 75%|███████▌  | 269/358 [00:27<00:08,  9.89it/s] 75%|███████▌  | 270/358 [00:27<00:08,  9.82it/s] 76%|███████▌  | 271/358 [00:27<00:08,  9.75it/s] 76%|███████▌  | 272/358 [00:27<00:08,  9.72it/s] 76%|███████▋  | 273/358 [00:27<00:08,  9.62it/s] 77%|███████▋  | 274/358 [00:27<00:08,  9.62it/s] 77%|███████▋  | 275/358 [00:28<00:08,  9.67it/s] 77%|███████▋  | 276/358 [00:28<00:08,  9.67it/s] 77%|███████▋  | 277/358 [00:28<00:08,  9.64it/s] 78%|███████▊  | 278/358 [00:28<00:08,  9.62it/s] 78%|███████▊  | 280/358 [00:28<00:07,  9.81it/s] 78%|███████▊  | 281/358 [00:28<00:07,  9.82it/s] 79%|███████▉  | 282/358 [00:28<00:07,  9.76it/s] 79%|███████▉  | 283/358 [00:28<00:07,  9.70it/s] 79%|███████▉  | 284/358 [00:28<00:07,  9.66it/s] 80%|███████▉  | 285/358 [00:29<00:07,  9.73it/s] 80%|███████▉  | 286/358 [00:29<00:07,  9.68it/s] 80%|████████  | 287/358 [00:29<00:07,  9.66it/s] 80%|████████  | 288/358 [00:29<00:07,  9.62it/s] 81%|████████  | 289/358 [00:29<00:07,  9.73it/s] 81%|████████▏ | 291/358 [00:29<00:06,  9.84it/s] 82%|████████▏ | 293/358 [00:29<00:06,  9.84it/s] 82%|████████▏ | 295/358 [00:30<00:06,  9.90it/s] 83%|████████▎ | 296/358 [00:30<00:06,  9.84it/s] 83%|████████▎ | 297/358 [00:30<00:06,  9.73it/s] 84%|████████▎ | 299/358 [00:30<00:05,  9.89it/s] 84%|████████▍ | 301/358 [00:30<00:05,  9.92it/s] 84%|████████▍ | 302/358 [00:30<00:05,  9.86it/s] 85%|████████▍ | 303/358 [00:30<00:05,  9.86it/s] 85%|████████▌ | 305/358 [00:31<00:05,  9.89it/s] 85%|████████▌ | 306/358 [00:31<00:05,  9.81it/s] 86%|████████▌ | 308/358 [00:31<00:05,  9.91it/s] 86%|████████▋ | 309/358 [00:31<00:04,  9.81it/s] 87%|████████▋ | 310/358 [00:31<00:04,  9.75it/s] 87%|████████▋ | 311/358 [00:31<00:04,  9.67it/s] 87%|████████▋ | 312/358 [00:31<00:04,  9.70it/s] 87%|████████▋ | 313/358 [00:31<00:04,  9.71it/s] 88%|████████▊ | 315/358 [00:32<00:04,  9.97it/s] 88%|████████▊ | 316/358 [00:32<00:04,  9.92it/s] 89%|████████▊ | 317/358 [00:32<00:04,  9.83it/s] 89%|████████▉ | 318/358 [00:32<00:04,  9.79it/s] 89%|████████▉ | 319/358 [00:32<00:04,  9.74it/s] 89%|████████▉ | 320/358 [00:32<00:03,  9.80it/s] 90%|████████▉ | 321/358 [00:32<00:03,  9.73it/s] 90%|████████▉ | 322/358 [00:32<00:03,  9.69it/s] 90%|█████████ | 323/358 [00:32<00:03,  9.65it/s] 91%|█████████ | 324/358 [00:33<00:03,  9.61it/s] 91%|█████████ | 325/358 [00:33<00:03,  9.60it/s] 91%|█████████▏| 327/358 [00:33<00:03,  9.96it/s] 92%|█████████▏| 329/358 [00:33<00:02, 10.06it/s] 92%|█████████▏| 330/358 [00:33<00:02,  9.95it/s] 93%|█████████▎| 332/358 [00:33<00:02, 10.05it/s] 93%|█████████▎| 334/358 [00:34<00:02,  9.95it/s] 94%|█████████▎| 335/358 [00:34<00:02,  9.83it/s] 94%|█████████▍| 337/358 [00:34<00:02,  9.91it/s] 95%|█████████▍| 339/358 [00:34<00:01, 10.11it/s] 95%|█████████▌| 341/358 [00:34<00:01, 10.05it/s] 96%|█████████▌| 343/358 [00:34<00:01,  9.89it/s] 96%|█████████▌| 344/358 [00:35<00:01,  9.83it/s] 96%|█████████▋| 345/358 [00:35<00:01,  9.85it/s] 97%|█████████▋| 346/358 [00:35<00:01,  9.88it/s] 97%|█████████▋| 348/358 [00:35<00:01,  9.97it/s] 97%|█████████▋| 349/358 [00:35<00:00,  9.88it/s] 98%|█████████▊| 350/358 [00:35<00:00,  9.80it/s] 98%|█████████▊| 351/358 [00:35<00:00,  9.75it/s] 99%|█████████▊| 353/358 [00:35<00:00,  9.92it/s] 99%|█████████▉| 354/358 [00:36<00:00,  9.90it/s] 99%|█████████▉| 355/358 [00:36<00:00,  9.81it/s]100%|█████████▉| 357/358 [00:36<00:00,  9.87it/s]100%|██████████| 358/358 [00:36<00:00,  9.82it/s]
[32m2025-02-05 05:51:31.483[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    gen_loss  grad clip ratio  grad norm   ppl
       2.018                1       2.47 7.525[0m
[32m2025-02-05 05:51:31.483[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m169[0m - [1m[Valid][0m
  0%|          | 0/10256 [00:00<?, ?it/s]100%|██████████| 10256/10256 [00:00<00:00, 1087930.75it/s]
[32m2025-02-05 05:51:31.493[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:27,  1.44it/s]  5%|▌         | 2/40 [00:01<00:26,  1.46it/s]  8%|▊         | 3/40 [00:02<00:25,  1.47it/s] 10%|█         | 4/40 [00:02<00:24,  1.47it/s] 12%|█▎        | 5/40 [00:03<00:23,  1.46it/s] 15%|█▌        | 6/40 [00:04<00:23,  1.46it/s] 18%|█▊        | 7/40 [00:04<00:22,  1.45it/s] 20%|██        | 8/40 [00:05<00:21,  1.46it/s] 22%|██▎       | 9/40 [00:06<00:21,  1.46it/s] 25%|██▌       | 10/40 [00:06<00:20,  1.46it/s] 28%|██▊       | 11/40 [00:07<00:19,  1.46it/s] 30%|███       | 12/40 [00:08<00:19,  1.46it/s] 32%|███▎      | 13/40 [00:08<00:18,  1.46it/s] 35%|███▌      | 14/40 [00:09<00:17,  1.45it/s] 38%|███▊      | 15/40 [00:10<00:17,  1.45it/s] 40%|████      | 16/40 [00:10<00:16,  1.45it/s] 42%|████▎     | 17/40 [00:11<00:15,  1.46it/s] 45%|████▌     | 18/40 [00:12<00:15,  1.46it/s] 48%|████▊     | 19/40 [00:13<00:14,  1.45it/s] 50%|█████     | 20/40 [00:13<00:13,  1.46it/s] 52%|█████▎    | 21/40 [00:14<00:12,  1.47it/s] 55%|█████▌    | 22/40 [00:15<00:12,  1.46it/s] 57%|█████▊    | 23/40 [00:15<00:11,  1.46it/s] 60%|██████    | 24/40 [00:16<00:11,  1.45it/s] 62%|██████▎   | 25/40 [00:17<00:10,  1.45it/s] 65%|██████▌   | 26/40 [00:17<00:09,  1.47it/s] 68%|██████▊   | 27/40 [00:18<00:08,  1.47it/s] 70%|███████   | 28/40 [00:19<00:08,  1.46it/s] 72%|███████▎  | 29/40 [00:19<00:07,  1.47it/s] 75%|███████▌  | 30/40 [00:20<00:06,  1.47it/s] 78%|███████▊  | 31/40 [00:21<00:06,  1.46it/s] 80%|████████  | 32/40 [00:21<00:05,  1.47it/s] 82%|████████▎ | 33/40 [00:22<00:04,  1.46it/s] 85%|████████▌ | 34/40 [00:23<00:04,  1.46it/s] 88%|████████▊ | 35/40 [00:23<00:03,  1.46it/s] 90%|█████████ | 36/40 [00:24<00:02,  1.46it/s] 92%|█████████▎| 37/40 [00:25<00:02,  1.46it/s] 95%|█████████▌| 38/40 [00:26<00:01,  1.45it/s] 98%|█████████▊| 39/40 [00:26<00:00,  1.45it/s]100%|██████████| 40/40 [00:27<00:00,  1.60it/s]100%|██████████| 40/40 [00:27<00:00,  1.47it/s]
[32m2025-02-05 05:51:58.706[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    average  bleu@1  bleu@2  bleu@3  bleu@4  dist@1  dist@2  dist@3  dist@4  extreme  \
      .7769   .3048   .1147  .04928  .02548  .04294   .2952   .5945   .7815    .5920   
      f1  gen_loss  greedy  intra_dist@1  intra_dist@2  intra_dist@3  intra_dist@4  \
   .3552     4.853   .6690         .8799         .9758         .9583         .9214   
     ppl  rouge1  rouge2  rougeL  
   128.2   .3893  .09484   .3765[0m
[32m2025-02-05 05:51:58.712[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m163[0m - [1m[Conversation epoch 41][0m
[32m2025-02-05 05:51:58.713[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m164[0m - [1m[Train][0m
  0%|          | 0/92414 [00:00<?, ?it/s]100%|██████████| 92414/92414 [00:00<00:00, 991757.14it/s]
[32m2025-02-05 05:51:58.806[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/358 [00:00<?, ?it/s]  0%|          | 1/358 [00:00<00:36,  9.72it/s]  1%|          | 3/358 [00:00<00:35,  9.92it/s]  1%|          | 4/358 [00:00<00:35,  9.90it/s]  2%|▏         | 6/358 [00:00<00:35,  9.87it/s]  2%|▏         | 7/358 [00:00<00:35,  9.80it/s]  2%|▏         | 8/358 [00:00<00:35,  9.85it/s]  3%|▎         | 9/358 [00:00<00:35,  9.75it/s]  3%|▎         | 10/358 [00:01<00:35,  9.74it/s]  3%|▎         | 11/358 [00:01<00:35,  9.69it/s]  4%|▎         | 13/358 [00:01<00:34,  9.90it/s]  4%|▍         | 14/358 [00:01<00:34,  9.83it/s]  4%|▍         | 15/358 [00:01<00:35,  9.76it/s]  4%|▍         | 16/358 [00:01<00:35,  9.69it/s]  5%|▍         | 17/358 [00:01<00:35,  9.71it/s]  5%|▌         | 18/358 [00:01<00:34,  9.79it/s]  5%|▌         | 19/358 [00:01<00:34,  9.71it/s]  6%|▌         | 20/358 [00:02<00:35,  9.66it/s]  6%|▌         | 21/358 [00:02<00:35,  9.59it/s]  6%|▌         | 22/358 [00:02<00:34,  9.65it/s]  7%|▋         | 24/358 [00:02<00:34,  9.76it/s]  7%|▋         | 25/358 [00:02<00:34,  9.71it/s]  7%|▋         | 26/358 [00:02<00:34,  9.66it/s]  8%|▊         | 27/358 [00:02<00:34,  9.71it/s]  8%|▊         | 28/358 [00:02<00:34,  9.67it/s]  8%|▊         | 29/358 [00:02<00:34,  9.63it/s]  9%|▊         | 31/358 [00:03<00:33,  9.73it/s]  9%|▉         | 32/358 [00:03<00:33,  9.73it/s]  9%|▉         | 34/358 [00:03<00:32,  9.84it/s] 10%|█         | 36/358 [00:03<00:32,  9.83it/s] 10%|█         | 37/358 [00:03<00:32,  9.82it/s] 11%|█         | 38/358 [00:03<00:32,  9.77it/s] 11%|█         | 40/358 [00:04<00:32,  9.93it/s] 11%|█▏        | 41/358 [00:04<00:32,  9.85it/s] 12%|█▏        | 43/358 [00:04<00:31,  9.87it/s] 13%|█▎        | 45/358 [00:04<00:31,  9.97it/s] 13%|█▎        | 47/358 [00:04<00:31,  9.94it/s] 13%|█▎        | 48/358 [00:04<00:31,  9.93it/s] 14%|█▍        | 50/358 [00:05<00:31,  9.90it/s] 14%|█▍        | 51/358 [00:05<00:31,  9.84it/s] 15%|█▍        | 52/358 [00:05<00:31,  9.75it/s] 15%|█▍        | 53/358 [00:05<00:31,  9.69it/s] 15%|█▌        | 54/358 [00:05<00:31,  9.73it/s] 15%|█▌        | 55/358 [00:05<00:31,  9.68it/s] 16%|█▌        | 56/358 [00:05<00:31,  9.73it/s] 16%|█▌        | 57/358 [00:05<00:31,  9.68it/s] 16%|█▌        | 58/358 [00:05<00:31,  9.66it/s] 16%|█▋        | 59/358 [00:06<00:31,  9.63it/s] 17%|█▋        | 61/358 [00:06<00:30,  9.71it/s] 17%|█▋        | 62/358 [00:06<00:30,  9.63it/s] 18%|█▊        | 63/358 [00:06<00:30,  9.70it/s] 18%|█▊        | 64/358 [00:06<00:30,  9.65it/s] 18%|█▊        | 66/358 [00:06<00:30,  9.72it/s] 19%|█▊        | 67/358 [00:06<00:29,  9.71it/s] 19%|█▉        | 69/358 [00:07<00:29,  9.77it/s] 20%|█▉        | 70/358 [00:07<00:29,  9.72it/s] 20%|█▉        | 71/358 [00:07<00:29,  9.76it/s] 20%|██        | 72/358 [00:07<00:29,  9.71it/s] 20%|██        | 73/358 [00:07<00:29,  9.68it/s] 21%|██        | 74/358 [00:07<00:29,  9.64it/s] 21%|██        | 75/358 [00:07<00:29,  9.61it/s] 21%|██        | 76/358 [00:07<00:29,  9.72it/s] 22%|██▏       | 77/358 [00:07<00:29,  9.68it/s] 22%|██▏       | 79/358 [00:08<00:28,  9.69it/s] 23%|██▎       | 81/358 [00:08<00:28,  9.75it/s] 23%|██▎       | 83/358 [00:08<00:28,  9.77it/s] 23%|██▎       | 84/358 [00:08<00:28,  9.72it/s] 24%|██▎       | 85/358 [00:08<00:28,  9.67it/s] 24%|██▍       | 86/358 [00:08<00:28,  9.66it/s] 24%|██▍       | 87/358 [00:08<00:28,  9.64it/s] 25%|██▍       | 88/358 [00:09<00:27,  9.66it/s] 25%|██▌       | 90/358 [00:09<00:27,  9.89it/s] 26%|██▌       | 92/358 [00:09<00:26,  9.99it/s] 26%|██▌       | 93/358 [00:09<00:26,  9.96it/s] 26%|██▋       | 94/358 [00:09<00:26,  9.87it/s] 27%|██▋       | 96/358 [00:09<00:25, 10.15it/s] 27%|██▋       | 98/358 [00:10<00:25, 10.04it/s] 28%|██▊       | 99/358 [00:10<00:26,  9.95it/s] 28%|██▊       | 101/358 [00:10<00:25,  9.92it/s] 29%|██▉       | 103/358 [00:10<00:25,  9.91it/s] 29%|██▉       | 104/358 [00:10<00:25,  9.86it/s] 29%|██▉       | 105/358 [00:10<00:25,  9.78it/s] 30%|██▉       | 106/358 [00:10<00:25,  9.77it/s] 30%|███       | 108/358 [00:11<00:25,  9.79it/s] 30%|███       | 109/358 [00:11<00:25,  9.71it/s] 31%|███       | 110/358 [00:11<00:25,  9.69it/s] 31%|███       | 111/358 [00:11<00:25,  9.64it/s] 32%|███▏      | 113/358 [00:11<00:24,  9.90it/s] 32%|███▏      | 114/358 [00:11<00:24,  9.86it/s] 32%|███▏      | 115/358 [00:11<00:24,  9.77it/s] 32%|███▏      | 116/358 [00:11<00:24,  9.68it/s] 33%|███▎      | 117/358 [00:11<00:24,  9.65it/s] 33%|███▎      | 119/358 [00:12<00:24,  9.77it/s] 34%|███▍      | 121/358 [00:12<00:23,  9.97it/s] 34%|███▍      | 123/358 [00:12<00:23, 10.07it/s] 35%|███▍      | 125/358 [00:12<00:23, 10.05it/s] 35%|███▌      | 127/358 [00:12<00:23,  9.98it/s] 36%|███▌      | 128/358 [00:13<00:23,  9.94it/s] 36%|███▋      | 130/358 [00:13<00:22,  9.98it/s] 37%|███▋      | 131/358 [00:13<00:22,  9.89it/s] 37%|███▋      | 132/358 [00:13<00:22,  9.91it/s] 37%|███▋      | 134/358 [00:13<00:22,  9.93it/s] 38%|███▊      | 135/358 [00:13<00:22,  9.87it/s] 38%|███▊      | 137/358 [00:13<00:22,  9.96it/s] 39%|███▊      | 138/358 [00:14<00:22,  9.94it/s] 39%|███▉      | 139/358 [00:14<00:22,  9.85it/s] 39%|███▉      | 141/358 [00:14<00:21,  9.97it/s] 40%|███▉      | 142/358 [00:14<00:21,  9.89it/s] 40%|███▉      | 143/358 [00:14<00:21,  9.86it/s] 40%|████      | 144/358 [00:14<00:21,  9.77it/s] 41%|████      | 145/358 [00:14<00:21,  9.79it/s] 41%|████      | 146/358 [00:14<00:21,  9.73it/s] 41%|████      | 147/358 [00:14<00:21,  9.67it/s] 41%|████▏     | 148/358 [00:15<00:21,  9.70it/s] 42%|████▏     | 149/358 [00:15<00:21,  9.69it/s] 42%|████▏     | 150/358 [00:15<00:21,  9.64it/s] 42%|████▏     | 151/358 [00:15<00:22,  9.38it/s] 42%|████▏     | 152/358 [00:15<00:21,  9.42it/s] 43%|████▎     | 153/358 [00:15<00:21,  9.45it/s] 43%|████▎     | 154/358 [00:15<00:21,  9.53it/s] 43%|████▎     | 155/358 [00:15<00:21,  9.54it/s] 44%|████▎     | 156/358 [00:15<00:20,  9.67it/s] 44%|████▍     | 157/358 [00:16<00:20,  9.61it/s] 44%|████▍     | 158/358 [00:16<00:20,  9.69it/s] 44%|████▍     | 159/358 [00:16<00:20,  9.69it/s] 45%|████▍     | 160/358 [00:16<00:20,  9.70it/s] 45%|████▌     | 162/358 [00:16<00:19,  9.99it/s] 46%|████▌     | 164/358 [00:16<00:19,  9.99it/s] 46%|████▌     | 165/358 [00:16<00:19,  9.95it/s] 47%|████▋     | 167/358 [00:17<00:19,  9.90it/s] 47%|████▋     | 169/358 [00:17<00:19,  9.93it/s] 48%|████▊     | 171/358 [00:17<00:18,  9.92it/s] 48%|████▊     | 172/358 [00:17<00:18,  9.87it/s] 48%|████▊     | 173/358 [00:17<00:18,  9.80it/s] 49%|████▉     | 175/358 [00:17<00:18,  9.82it/s] 49%|████▉     | 176/358 [00:17<00:18,  9.83it/s] 49%|████▉     | 177/358 [00:18<00:18,  9.82it/s] 50%|█████     | 179/358 [00:18<00:18,  9.85it/s] 50%|█████     | 180/358 [00:18<00:18,  9.78it/s] 51%|█████     | 182/358 [00:18<00:17,  9.93it/s] 51%|█████     | 183/358 [00:18<00:17,  9.88it/s] 51%|█████▏    | 184/358 [00:18<00:17,  9.77it/s] 52%|█████▏    | 185/358 [00:18<00:17,  9.72it/s] 52%|█████▏    | 187/358 [00:19<00:17,  9.93it/s] 53%|█████▎    | 188/358 [00:19<00:17,  9.88it/s] 53%|█████▎    | 189/358 [00:19<00:17,  9.82it/s] 53%|█████▎    | 190/358 [00:19<00:17,  9.87it/s] 53%|█████▎    | 191/358 [00:19<00:17,  9.70it/s] 54%|█████▎    | 192/358 [00:19<00:17,  9.65it/s] 54%|█████▍    | 193/358 [00:19<00:17,  9.65it/s] 54%|█████▍    | 194/358 [00:19<00:17,  9.64it/s] 54%|█████▍    | 195/358 [00:19<00:16,  9.72it/s] 55%|█████▌    | 197/358 [00:20<00:16,  9.91it/s] 55%|█████▌    | 198/358 [00:20<00:16,  9.83it/s] 56%|█████▌    | 199/358 [00:20<00:16,  9.86it/s] 56%|█████▌    | 200/358 [00:20<00:16,  9.79it/s] 56%|█████▌    | 201/358 [00:20<00:16,  9.75it/s] 57%|█████▋    | 203/358 [00:20<00:15,  9.84it/s] 57%|█████▋    | 204/358 [00:20<00:15,  9.74it/s] 57%|█████▋    | 205/358 [00:20<00:15,  9.69it/s] 58%|█████▊    | 207/358 [00:21<00:15,  9.86it/s] 58%|█████▊    | 208/358 [00:21<00:15,  9.79it/s] 59%|█████▊    | 210/358 [00:21<00:15,  9.81it/s] 59%|█████▉    | 212/358 [00:21<00:14,  9.80it/s] 60%|█████▉    | 214/358 [00:21<00:14,  9.88it/s] 60%|██████    | 215/358 [00:21<00:14,  9.82it/s] 60%|██████    | 216/358 [00:22<00:14,  9.75it/s] 61%|██████    | 217/358 [00:22<00:14,  9.79it/s] 61%|██████    | 218/358 [00:22<00:14,  9.76it/s] 61%|██████    | 219/358 [00:22<00:14,  9.76it/s] 62%|██████▏   | 221/358 [00:22<00:13,  9.89it/s] 62%|██████▏   | 222/358 [00:22<00:13,  9.79it/s] 62%|██████▏   | 223/358 [00:22<00:13,  9.73it/s] 63%|██████▎   | 224/358 [00:22<00:13,  9.68it/s] 63%|██████▎   | 225/358 [00:22<00:13,  9.76it/s] 63%|██████▎   | 226/358 [00:23<00:13,  9.71it/s] 64%|██████▎   | 228/358 [00:23<00:13,  9.75it/s] 64%|██████▍   | 229/358 [00:23<00:13,  9.72it/s] 64%|██████▍   | 230/358 [00:23<00:13,  9.67it/s] 65%|██████▍   | 232/358 [00:23<00:12,  9.72it/s] 65%|██████▌   | 234/358 [00:23<00:12, 10.01it/s] 66%|██████▌   | 236/358 [00:24<00:12,  9.97it/s] 66%|██████▋   | 238/358 [00:24<00:11, 10.02it/s] 67%|██████▋   | 240/358 [00:24<00:11,  9.99it/s] 68%|██████▊   | 242/358 [00:24<00:11,  9.97it/s] 68%|██████▊   | 243/358 [00:24<00:11,  9.90it/s] 68%|██████▊   | 244/358 [00:24<00:11,  9.84it/s] 69%|██████▊   | 246/358 [00:25<00:11,  9.86it/s] 69%|██████▉   | 247/358 [00:25<00:11,  9.79it/s] 69%|██████▉   | 248/358 [00:25<00:11,  9.75it/s] 70%|██████▉   | 250/358 [00:25<00:10,  9.83it/s] 70%|███████   | 251/358 [00:25<00:10,  9.77it/s] 70%|███████   | 252/358 [00:25<00:10,  9.71it/s] 71%|███████   | 253/358 [00:25<00:10,  9.67it/s] 71%|███████   | 254/358 [00:25<00:10,  9.65it/s] 72%|███████▏  | 256/358 [00:26<00:10,  9.82it/s] 72%|███████▏  | 257/358 [00:26<00:10,  9.83it/s] 72%|███████▏  | 258/358 [00:26<00:10,  9.70it/s] 72%|███████▏  | 259/358 [00:26<00:10,  9.66it/s] 73%|███████▎  | 260/358 [00:26<00:10,  9.70it/s] 73%|███████▎  | 262/358 [00:26<00:09,  9.88it/s] 74%|███████▎  | 264/358 [00:26<00:09,  9.90it/s] 74%|███████▍  | 266/358 [00:27<00:09,  9.89it/s] 75%|███████▍  | 267/358 [00:27<00:09,  9.83it/s] 75%|███████▌  | 269/358 [00:27<00:09,  9.88it/s] 75%|███████▌  | 270/358 [00:27<00:08,  9.82it/s] 76%|███████▌  | 271/358 [00:27<00:08,  9.74it/s] 76%|███████▌  | 272/358 [00:27<00:08,  9.72it/s] 76%|███████▋  | 273/358 [00:27<00:08,  9.62it/s] 77%|███████▋  | 274/358 [00:27<00:08,  9.62it/s] 77%|███████▋  | 275/358 [00:28<00:08,  9.67it/s] 77%|███████▋  | 276/358 [00:28<00:08,  9.67it/s] 77%|███████▋  | 277/358 [00:28<00:08,  9.64it/s] 78%|███████▊  | 278/358 [00:28<00:08,  9.62it/s] 78%|███████▊  | 280/358 [00:28<00:07,  9.81it/s] 78%|███████▊  | 281/358 [00:28<00:07,  9.82it/s] 79%|███████▉  | 282/358 [00:28<00:07,  9.76it/s] 79%|███████▉  | 283/358 [00:28<00:07,  9.70it/s] 79%|███████▉  | 284/358 [00:28<00:07,  9.66it/s] 80%|███████▉  | 285/358 [00:29<00:07,  9.73it/s] 80%|███████▉  | 286/358 [00:29<00:07,  9.68it/s] 80%|████████  | 287/358 [00:29<00:07,  9.66it/s] 80%|████████  | 288/358 [00:29<00:07,  9.62it/s] 81%|████████  | 290/358 [00:29<00:06,  9.84it/s] 81%|████████▏ | 291/358 [00:29<00:06,  9.82it/s] 82%|████████▏ | 293/358 [00:29<00:06,  9.82it/s] 82%|████████▏ | 295/358 [00:30<00:06,  9.90it/s] 83%|████████▎ | 296/358 [00:30<00:06,  9.83it/s] 83%|████████▎ | 297/358 [00:30<00:06,  9.72it/s] 84%|████████▎ | 299/358 [00:30<00:05,  9.88it/s] 84%|████████▍ | 301/358 [00:30<00:05,  9.92it/s] 84%|████████▍ | 302/358 [00:30<00:05,  9.86it/s] 85%|████████▍ | 303/358 [00:30<00:05,  9.86it/s] 85%|████████▌ | 305/358 [00:31<00:05,  9.89it/s] 85%|████████▌ | 306/358 [00:31<00:05,  9.81it/s] 86%|████████▌ | 308/358 [00:31<00:05,  9.92it/s] 86%|████████▋ | 309/358 [00:31<00:04,  9.82it/s] 87%|████████▋ | 310/358 [00:31<00:04,  9.76it/s] 87%|████████▋ | 311/358 [00:31<00:04,  9.68it/s] 87%|████████▋ | 312/358 [00:31<00:04,  9.70it/s] 87%|████████▋ | 313/358 [00:31<00:04,  9.72it/s] 88%|████████▊ | 315/358 [00:32<00:04,  9.97it/s] 88%|████████▊ | 316/358 [00:32<00:04,  9.92it/s] 89%|████████▊ | 317/358 [00:32<00:04,  9.84it/s] 89%|████████▉ | 318/358 [00:32<00:04,  9.80it/s] 89%|████████▉ | 319/358 [00:32<00:04,  9.75it/s] 89%|████████▉ | 320/358 [00:32<00:03,  9.81it/s] 90%|████████▉ | 321/358 [00:32<00:03,  9.73it/s] 90%|████████▉ | 322/358 [00:32<00:03,  9.70it/s] 90%|█████████ | 323/358 [00:32<00:03,  9.65it/s] 91%|█████████ | 324/358 [00:33<00:03,  9.62it/s] 91%|█████████ | 325/358 [00:33<00:03,  9.60it/s] 91%|█████████▏| 327/358 [00:33<00:03,  9.96it/s] 92%|█████████▏| 329/358 [00:33<00:02, 10.06it/s] 92%|█████████▏| 330/358 [00:33<00:02,  9.95it/s] 93%|█████████▎| 332/358 [00:33<00:02, 10.05it/s] 93%|█████████▎| 334/358 [00:34<00:02,  9.95it/s] 94%|█████████▎| 335/358 [00:34<00:02,  9.83it/s] 94%|█████████▍| 337/358 [00:34<00:02,  9.90it/s] 95%|█████████▍| 339/358 [00:34<00:01, 10.11it/s] 95%|█████████▌| 341/358 [00:34<00:01, 10.05it/s] 96%|█████████▌| 343/358 [00:34<00:01,  9.89it/s] 96%|█████████▌| 344/358 [00:35<00:01,  9.83it/s] 96%|█████████▋| 345/358 [00:35<00:01,  9.85it/s] 97%|█████████▋| 346/358 [00:35<00:01,  9.88it/s] 97%|█████████▋| 348/358 [00:35<00:01,  9.97it/s] 97%|█████████▋| 349/358 [00:35<00:00,  9.88it/s] 98%|█████████▊| 350/358 [00:35<00:00,  9.80it/s] 98%|█████████▊| 351/358 [00:35<00:00,  9.75it/s] 99%|█████████▊| 353/358 [00:35<00:00,  9.92it/s] 99%|█████████▉| 354/358 [00:36<00:00,  9.90it/s] 99%|█████████▉| 355/358 [00:36<00:00,  9.82it/s]100%|█████████▉| 357/358 [00:36<00:00,  9.87it/s]100%|██████████| 358/358 [00:36<00:00,  9.82it/s]
[32m2025-02-05 05:52:35.284[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    gen_loss  grad clip ratio  grad norm   ppl
       2.009                1      2.748 7.452[0m
[32m2025-02-05 05:52:35.284[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m169[0m - [1m[Valid][0m
  0%|          | 0/10256 [00:00<?, ?it/s]100%|██████████| 10256/10256 [00:00<00:00, 1098151.28it/s]
[32m2025-02-05 05:52:35.294[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:27,  1.44it/s]  5%|▌         | 2/40 [00:01<00:26,  1.46it/s]  8%|▊         | 3/40 [00:02<00:25,  1.46it/s] 10%|█         | 4/40 [00:02<00:24,  1.46it/s] 12%|█▎        | 5/40 [00:03<00:24,  1.45it/s] 15%|█▌        | 6/40 [00:04<00:23,  1.45it/s] 18%|█▊        | 7/40 [00:04<00:22,  1.45it/s] 20%|██        | 8/40 [00:05<00:21,  1.46it/s] 22%|██▎       | 9/40 [00:06<00:21,  1.46it/s] 25%|██▌       | 10/40 [00:06<00:20,  1.45it/s] 28%|██▊       | 11/40 [00:07<00:19,  1.46it/s] 30%|███       | 12/40 [00:08<00:19,  1.46it/s] 32%|███▎      | 13/40 [00:08<00:18,  1.46it/s] 35%|███▌      | 14/40 [00:09<00:17,  1.45it/s] 38%|███▊      | 15/40 [00:10<00:17,  1.45it/s] 40%|████      | 16/40 [00:11<00:16,  1.45it/s] 42%|████▎     | 17/40 [00:11<00:15,  1.45it/s] 45%|████▌     | 18/40 [00:12<00:15,  1.46it/s] 48%|████▊     | 19/40 [00:13<00:14,  1.45it/s] 50%|█████     | 20/40 [00:13<00:13,  1.46it/s] 52%|█████▎    | 21/40 [00:14<00:13,  1.46it/s] 55%|█████▌    | 22/40 [00:15<00:12,  1.45it/s] 57%|█████▊    | 23/40 [00:15<00:11,  1.45it/s] 60%|██████    | 24/40 [00:16<00:11,  1.45it/s] 62%|██████▎   | 25/40 [00:17<00:10,  1.45it/s] 65%|██████▌   | 26/40 [00:17<00:09,  1.46it/s] 68%|██████▊   | 27/40 [00:18<00:08,  1.45it/s] 70%|███████   | 28/40 [00:19<00:08,  1.46it/s] 72%|███████▎  | 29/40 [00:19<00:07,  1.46it/s] 75%|███████▌  | 30/40 [00:20<00:06,  1.46it/s] 78%|███████▊  | 31/40 [00:21<00:06,  1.46it/s] 80%|████████  | 32/40 [00:21<00:05,  1.46it/s] 82%|████████▎ | 33/40 [00:22<00:04,  1.46it/s] 85%|████████▌ | 34/40 [00:23<00:04,  1.46it/s] 88%|████████▊ | 35/40 [00:24<00:03,  1.46it/s] 90%|█████████ | 36/40 [00:24<00:02,  1.45it/s] 92%|█████████▎| 37/40 [00:25<00:02,  1.46it/s] 95%|█████████▌| 38/40 [00:26<00:01,  1.44it/s] 98%|█████████▊| 39/40 [00:26<00:00,  1.45it/s]100%|██████████| 40/40 [00:27<00:00,  1.60it/s]100%|██████████| 40/40 [00:27<00:00,  1.47it/s]
[32m2025-02-05 05:53:02.605[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    average  bleu@1  bleu@2  bleu@3  bleu@4  dist@1  dist@2  dist@3  dist@4  extreme  \
      .7791   .3011   .1115  .04593  .02314  .04619   .3168   .6132   .7858    .5931   
      f1  gen_loss  greedy  intra_dist@1  intra_dist@2  intra_dist@3  intra_dist@4  \
   .3545     4.827   .6666         .8811         .9743         .9591         .9240   
     ppl  rouge1  rouge2  rougeL  
   124.8   .3863  .09162   .3743[0m
[32m2025-02-05 05:53:02.611[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m163[0m - [1m[Conversation epoch 42][0m
[32m2025-02-05 05:53:02.611[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m164[0m - [1m[Train][0m
  0%|          | 0/92414 [00:00<?, ?it/s]100%|██████████| 92414/92414 [00:00<00:00, 997302.04it/s]
[32m2025-02-05 05:53:02.704[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/358 [00:00<?, ?it/s]  0%|          | 1/358 [00:00<00:36,  9.72it/s]  1%|          | 3/358 [00:00<00:35,  9.91it/s]  1%|          | 4/358 [00:00<00:35,  9.89it/s]  2%|▏         | 6/358 [00:00<00:35,  9.86it/s]  2%|▏         | 7/358 [00:00<00:35,  9.79it/s]  2%|▏         | 8/358 [00:00<00:35,  9.84it/s]  3%|▎         | 9/358 [00:00<00:35,  9.74it/s]  3%|▎         | 10/358 [00:01<00:35,  9.73it/s]  3%|▎         | 11/358 [00:01<00:35,  9.68it/s]  4%|▎         | 13/358 [00:01<00:34,  9.90it/s]  4%|▍         | 14/358 [00:01<00:34,  9.83it/s]  4%|▍         | 15/358 [00:01<00:35,  9.75it/s]  4%|▍         | 16/358 [00:01<00:35,  9.69it/s]  5%|▍         | 17/358 [00:01<00:35,  9.71it/s]  5%|▌         | 19/358 [00:01<00:34,  9.74it/s]  6%|▌         | 20/358 [00:02<00:34,  9.69it/s]  6%|▌         | 21/358 [00:02<00:35,  9.62it/s]  6%|▌         | 22/358 [00:02<00:34,  9.68it/s]  7%|▋         | 24/358 [00:02<00:34,  9.76it/s]  7%|▋         | 25/358 [00:02<00:34,  9.71it/s]  7%|▋         | 26/358 [00:02<00:34,  9.66it/s]  8%|▊         | 27/358 [00:02<00:34,  9.71it/s]  8%|▊         | 28/358 [00:02<00:34,  9.67it/s]  8%|▊         | 29/358 [00:02<00:34,  9.63it/s]  9%|▊         | 31/358 [00:03<00:33,  9.74it/s]  9%|▉         | 32/358 [00:03<00:33,  9.73it/s]  9%|▉         | 34/358 [00:03<00:32,  9.84it/s] 10%|█         | 36/358 [00:03<00:32,  9.83it/s] 10%|█         | 37/358 [00:03<00:32,  9.81it/s] 11%|█         | 38/358 [00:03<00:32,  9.77it/s] 11%|█         | 40/358 [00:04<00:32,  9.93it/s] 11%|█▏        | 41/358 [00:04<00:32,  9.84it/s] 12%|█▏        | 43/358 [00:04<00:31,  9.87it/s] 13%|█▎        | 45/358 [00:04<00:31,  9.97it/s] 13%|█▎        | 47/358 [00:04<00:31,  9.94it/s] 13%|█▎        | 48/358 [00:04<00:31,  9.93it/s] 14%|█▍        | 50/358 [00:05<00:31,  9.90it/s] 14%|█▍        | 51/358 [00:05<00:31,  9.83it/s] 15%|█▍        | 52/358 [00:05<00:31,  9.74it/s] 15%|█▍        | 53/358 [00:05<00:31,  9.69it/s] 15%|█▌        | 54/358 [00:05<00:31,  9.73it/s] 15%|█▌        | 55/358 [00:05<00:31,  9.68it/s] 16%|█▌        | 56/358 [00:05<00:31,  9.72it/s] 16%|█▌        | 57/358 [00:05<00:31,  9.68it/s] 16%|█▌        | 58/358 [00:05<00:31,  9.65it/s] 16%|█▋        | 59/358 [00:06<00:31,  9.62it/s] 17%|█▋        | 61/358 [00:06<00:30,  9.71it/s] 17%|█▋        | 62/358 [00:06<00:30,  9.63it/s] 18%|█▊        | 63/358 [00:06<00:30,  9.69it/s] 18%|█▊        | 64/358 [00:06<00:30,  9.65it/s] 18%|█▊        | 66/358 [00:06<00:30,  9.72it/s] 19%|█▊        | 67/358 [00:06<00:29,  9.70it/s] 19%|█▉        | 69/358 [00:07<00:29,  9.77it/s] 20%|█▉        | 70/358 [00:07<00:29,  9.71it/s] 20%|█▉        | 71/358 [00:07<00:29,  9.76it/s] 20%|██        | 72/358 [00:07<00:29,  9.71it/s] 20%|██        | 73/358 [00:07<00:29,  9.68it/s] 21%|██        | 74/358 [00:07<00:29,  9.64it/s] 21%|██        | 75/358 [00:07<00:29,  9.61it/s] 21%|██        | 76/358 [00:07<00:29,  9.71it/s] 22%|██▏       | 77/358 [00:07<00:29,  9.67it/s] 22%|██▏       | 79/358 [00:08<00:28,  9.68it/s] 23%|██▎       | 81/358 [00:08<00:28,  9.74it/s] 23%|██▎       | 83/358 [00:08<00:28,  9.77it/s] 23%|██▎       | 84/358 [00:08<00:28,  9.72it/s] 24%|██▎       | 85/358 [00:08<00:28,  9.67it/s] 24%|██▍       | 86/358 [00:08<00:28,  9.66it/s] 24%|██▍       | 87/358 [00:08<00:28,  9.64it/s] 25%|██▍       | 88/358 [00:09<00:27,  9.66it/s] 25%|██▌       | 90/358 [00:09<00:27,  9.89it/s] 26%|██▌       | 92/358 [00:09<00:26,  9.99it/s] 26%|██▌       | 93/358 [00:09<00:26,  9.95it/s] 26%|██▋       | 94/358 [00:09<00:26,  9.87it/s] 27%|██▋       | 96/358 [00:09<00:25, 10.15it/s] 27%|██▋       | 98/358 [00:10<00:25, 10.04it/s] 28%|██▊       | 99/358 [00:10<00:26,  9.95it/s] 28%|██▊       | 101/358 [00:10<00:25,  9.92it/s] 29%|██▉       | 103/358 [00:10<00:25,  9.91it/s] 29%|██▉       | 104/358 [00:10<00:25,  9.86it/s] 29%|██▉       | 105/358 [00:10<00:25,  9.78it/s] 30%|██▉       | 106/358 [00:10<00:25,  9.77it/s] 30%|███       | 108/358 [00:11<00:25,  9.79it/s] 30%|███       | 109/358 [00:11<00:25,  9.71it/s] 31%|███       | 110/358 [00:11<00:25,  9.68it/s] 31%|███       | 111/358 [00:11<00:25,  9.63it/s] 32%|███▏      | 113/358 [00:11<00:24,  9.90it/s] 32%|███▏      | 114/358 [00:11<00:24,  9.86it/s] 32%|███▏      | 115/358 [00:11<00:24,  9.77it/s] 32%|███▏      | 116/358 [00:11<00:24,  9.68it/s] 33%|███▎      | 117/358 [00:11<00:24,  9.65it/s] 33%|███▎      | 119/358 [00:12<00:24,  9.77it/s] 34%|███▍      | 121/358 [00:12<00:23,  9.97it/s] 34%|███▍      | 123/358 [00:12<00:23, 10.07it/s] 35%|███▍      | 125/358 [00:12<00:23, 10.05it/s] 35%|███▌      | 126/358 [00:12<00:23, 10.01it/s] 35%|███▌      | 127/358 [00:12<00:23,  9.96it/s] 36%|███▌      | 128/358 [00:13<00:23,  9.91it/s] 36%|███▋      | 130/358 [00:13<00:22,  9.98it/s] 37%|███▋      | 131/358 [00:13<00:22,  9.88it/s] 37%|███▋      | 132/358 [00:13<00:22,  9.90it/s] 37%|███▋      | 134/358 [00:13<00:22,  9.92it/s] 38%|███▊      | 135/358 [00:13<00:22,  9.86it/s] 38%|███▊      | 137/358 [00:13<00:22,  9.95it/s] 39%|███▊      | 138/358 [00:14<00:22,  9.93it/s] 39%|███▉      | 139/358 [00:14<00:22,  9.84it/s] 39%|███▉      | 141/358 [00:14<00:21,  9.97it/s] 40%|███▉      | 142/358 [00:14<00:21,  9.89it/s] 40%|███▉      | 143/358 [00:14<00:21,  9.86it/s] 40%|████      | 144/358 [00:14<00:21,  9.78it/s] 41%|████      | 145/358 [00:14<00:21,  9.79it/s] 41%|████      | 146/358 [00:14<00:21,  9.73it/s] 41%|████      | 147/358 [00:14<00:21,  9.67it/s] 41%|████▏     | 148/358 [00:15<00:21,  9.70it/s] 42%|████▏     | 149/358 [00:15<00:21,  9.68it/s] 42%|████▏     | 150/358 [00:15<00:21,  9.64it/s] 42%|████▏     | 151/358 [00:15<00:22,  9.37it/s] 42%|████▏     | 152/358 [00:15<00:21,  9.42it/s] 43%|████▎     | 153/358 [00:15<00:21,  9.44it/s] 43%|████▎     | 154/358 [00:15<00:21,  9.53it/s] 43%|████▎     | 155/358 [00:15<00:21,  9.54it/s] 44%|████▎     | 156/358 [00:15<00:20,  9.67it/s] 44%|████▍     | 157/358 [00:16<00:20,  9.61it/s] 44%|████▍     | 158/358 [00:16<00:20,  9.70it/s] 44%|████▍     | 159/358 [00:16<00:20,  9.69it/s] 45%|████▍     | 160/358 [00:16<00:20,  9.70it/s] 45%|████▌     | 162/358 [00:16<00:19,  9.99it/s] 46%|████▌     | 164/358 [00:16<00:19,  9.99it/s] 46%|████▌     | 165/358 [00:16<00:19,  9.95it/s] 47%|████▋     | 167/358 [00:17<00:19,  9.90it/s] 47%|████▋     | 169/358 [00:17<00:19,  9.94it/s] 48%|████▊     | 171/358 [00:17<00:18,  9.92it/s] 48%|████▊     | 172/358 [00:17<00:18,  9.87it/s] 48%|████▊     | 173/358 [00:17<00:18,  9.80it/s] 49%|████▉     | 175/358 [00:17<00:18,  9.82it/s] 49%|████▉     | 176/358 [00:17<00:18,  9.84it/s] 49%|████▉     | 177/358 [00:18<00:18,  9.82it/s] 50%|█████     | 179/358 [00:18<00:18,  9.85it/s] 50%|█████     | 180/358 [00:18<00:18,  9.78it/s] 51%|█████     | 182/358 [00:18<00:17,  9.93it/s] 51%|█████     | 183/358 [00:18<00:17,  9.88it/s] 51%|█████▏    | 184/358 [00:18<00:17,  9.77it/s] 52%|█████▏    | 185/358 [00:18<00:17,  9.72it/s] 52%|█████▏    | 187/358 [00:19<00:17,  9.93it/s] 53%|█████▎    | 188/358 [00:19<00:17,  9.88it/s] 53%|█████▎    | 189/358 [00:19<00:17,  9.82it/s] 53%|█████▎    | 190/358 [00:19<00:17,  9.87it/s] 53%|█████▎    | 191/358 [00:19<00:17,  9.70it/s] 54%|█████▎    | 192/358 [00:19<00:17,  9.65it/s] 54%|█████▍    | 193/358 [00:19<00:17,  9.65it/s] 54%|█████▍    | 194/358 [00:19<00:17,  9.63it/s] 54%|█████▍    | 195/358 [00:19<00:16,  9.71it/s] 55%|█████▌    | 197/358 [00:20<00:16,  9.90it/s] 55%|█████▌    | 198/358 [00:20<00:16,  9.83it/s] 56%|█████▌    | 199/358 [00:20<00:16,  9.85it/s] 56%|█████▌    | 200/358 [00:20<00:16,  9.79it/s] 56%|█████▌    | 201/358 [00:20<00:16,  9.75it/s] 57%|█████▋    | 203/358 [00:20<00:15,  9.84it/s] 57%|█████▋    | 204/358 [00:20<00:15,  9.73it/s] 57%|█████▋    | 205/358 [00:20<00:15,  9.70it/s] 58%|█████▊    | 207/358 [00:21<00:15,  9.87it/s] 58%|█████▊    | 208/358 [00:21<00:15,  9.80it/s] 59%|█████▊    | 210/358 [00:21<00:15,  9.81it/s] 59%|█████▉    | 212/358 [00:21<00:14,  9.80it/s] 60%|█████▉    | 214/358 [00:21<00:14,  9.88it/s] 60%|██████    | 215/358 [00:21<00:14,  9.81it/s] 60%|██████    | 216/358 [00:22<00:14,  9.75it/s] 61%|██████    | 217/358 [00:22<00:14,  9.79it/s] 61%|██████    | 218/358 [00:22<00:14,  9.76it/s] 61%|██████    | 219/358 [00:22<00:14,  9.76it/s] 62%|██████▏   | 221/358 [00:22<00:13,  9.89it/s] 62%|██████▏   | 222/358 [00:22<00:13,  9.79it/s] 62%|██████▏   | 223/358 [00:22<00:13,  9.74it/s] 63%|██████▎   | 224/358 [00:22<00:13,  9.68it/s] 63%|██████▎   | 225/358 [00:22<00:13,  9.76it/s] 63%|██████▎   | 226/358 [00:23<00:13,  9.71it/s] 64%|██████▎   | 228/358 [00:23<00:13,  9.75it/s] 64%|██████▍   | 229/358 [00:23<00:13,  9.72it/s] 64%|██████▍   | 230/358 [00:23<00:13,  9.67it/s] 65%|██████▍   | 232/358 [00:23<00:12,  9.72it/s] 65%|██████▌   | 234/358 [00:23<00:12, 10.02it/s] 66%|██████▌   | 236/358 [00:24<00:12,  9.97it/s] 66%|██████▋   | 238/358 [00:24<00:11, 10.02it/s] 67%|██████▋   | 240/358 [00:24<00:11,  9.98it/s] 68%|██████▊   | 242/358 [00:24<00:11,  9.96it/s] 68%|██████▊   | 243/358 [00:24<00:11,  9.90it/s] 68%|██████▊   | 244/358 [00:24<00:11,  9.83it/s] 69%|██████▊   | 246/358 [00:25<00:11,  9.86it/s] 69%|██████▉   | 247/358 [00:25<00:11,  9.79it/s] 69%|██████▉   | 248/358 [00:25<00:11,  9.74it/s] 70%|██████▉   | 250/358 [00:25<00:10,  9.84it/s] 70%|███████   | 251/358 [00:25<00:10,  9.78it/s] 70%|███████   | 252/358 [00:25<00:10,  9.72it/s] 71%|███████   | 253/358 [00:25<00:10,  9.68it/s] 71%|███████   | 254/358 [00:25<00:10,  9.65it/s] 72%|███████▏  | 256/358 [00:26<00:10,  9.83it/s] 72%|███████▏  | 257/358 [00:26<00:10,  9.83it/s] 72%|███████▏  | 258/358 [00:26<00:10,  9.70it/s] 72%|███████▏  | 259/358 [00:26<00:10,  9.67it/s] 73%|███████▎  | 260/358 [00:26<00:10,  9.70it/s] 73%|███████▎  | 262/358 [00:26<00:09,  9.88it/s] 74%|███████▎  | 264/358 [00:26<00:09,  9.90it/s] 74%|███████▍  | 266/358 [00:27<00:09,  9.89it/s] 75%|███████▍  | 267/358 [00:27<00:09,  9.83it/s] 75%|███████▌  | 269/358 [00:27<00:09,  9.89it/s] 75%|███████▌  | 270/358 [00:27<00:08,  9.82it/s] 76%|███████▌  | 271/358 [00:27<00:08,  9.74it/s] 76%|███████▌  | 272/358 [00:27<00:08,  9.72it/s] 76%|███████▋  | 273/358 [00:27<00:08,  9.62it/s] 77%|███████▋  | 274/358 [00:27<00:08,  9.62it/s] 77%|███████▋  | 275/358 [00:28<00:08,  9.67it/s] 77%|███████▋  | 276/358 [00:28<00:08,  9.67it/s] 77%|███████▋  | 277/358 [00:28<00:08,  9.64it/s] 78%|███████▊  | 278/358 [00:28<00:08,  9.62it/s] 78%|███████▊  | 280/358 [00:28<00:07,  9.81it/s] 78%|███████▊  | 281/358 [00:28<00:07,  9.82it/s] 79%|███████▉  | 282/358 [00:28<00:07,  9.76it/s] 79%|███████▉  | 283/358 [00:28<00:07,  9.70it/s] 79%|███████▉  | 284/358 [00:28<00:07,  9.66it/s] 80%|███████▉  | 285/358 [00:29<00:07,  9.73it/s] 80%|███████▉  | 286/358 [00:29<00:07,  9.68it/s] 80%|████████  | 287/358 [00:29<00:07,  9.66it/s] 80%|████████  | 288/358 [00:29<00:07,  9.62it/s] 81%|████████  | 290/358 [00:29<00:06,  9.83it/s] 81%|████████▏ | 291/358 [00:29<00:06,  9.81it/s] 82%|████████▏ | 293/358 [00:29<00:06,  9.82it/s] 82%|████████▏ | 295/358 [00:30<00:06,  9.90it/s] 83%|████████▎ | 296/358 [00:30<00:06,  9.83it/s] 83%|████████▎ | 297/358 [00:30<00:06,  9.72it/s] 84%|████████▎ | 299/358 [00:30<00:05,  9.89it/s] 84%|████████▍ | 301/358 [00:30<00:05,  9.92it/s] 84%|████████▍ | 302/358 [00:30<00:05,  9.86it/s] 85%|████████▍ | 303/358 [00:30<00:05,  9.87it/s] 85%|████████▌ | 305/358 [00:31<00:05,  9.89it/s] 85%|████████▌ | 306/358 [00:31<00:05,  9.82it/s] 86%|████████▌ | 308/358 [00:31<00:05,  9.92it/s] 86%|████████▋ | 309/358 [00:31<00:04,  9.81it/s] 87%|████████▋ | 310/358 [00:31<00:04,  9.76it/s] 87%|████████▋ | 311/358 [00:31<00:04,  9.68it/s] 87%|████████▋ | 312/358 [00:31<00:04,  9.70it/s] 87%|████████▋ | 313/358 [00:31<00:04,  9.71it/s] 88%|████████▊ | 315/358 [00:32<00:04,  9.97it/s] 88%|████████▊ | 316/358 [00:32<00:04,  9.92it/s] 89%|████████▊ | 317/358 [00:32<00:04,  9.84it/s] 89%|████████▉ | 318/358 [00:32<00:04,  9.79it/s] 89%|████████▉ | 319/358 [00:32<00:04,  9.73it/s] 89%|████████▉ | 320/358 [00:32<00:03,  9.79it/s] 90%|████████▉ | 321/358 [00:32<00:03,  9.72it/s] 90%|████████▉ | 322/358 [00:32<00:03,  9.68it/s] 90%|█████████ | 323/358 [00:32<00:03,  9.64it/s] 91%|█████████ | 324/358 [00:33<00:03,  9.61it/s] 91%|█████████ | 325/358 [00:33<00:03,  9.59it/s] 91%|█████████▏| 327/358 [00:33<00:03,  9.95it/s] 92%|█████████▏| 329/358 [00:33<00:02, 10.05it/s] 92%|█████████▏| 330/358 [00:33<00:02,  9.94it/s] 93%|█████████▎| 332/358 [00:33<00:02, 10.04it/s] 93%|█████████▎| 334/358 [00:34<00:02,  9.94it/s] 94%|█████████▎| 335/358 [00:34<00:02,  9.82it/s] 94%|█████████▍| 337/358 [00:34<00:02,  9.90it/s] 95%|█████████▍| 339/358 [00:34<00:01, 10.10it/s] 95%|█████████▌| 341/358 [00:34<00:01, 10.04it/s] 96%|█████████▌| 343/358 [00:34<00:01,  9.88it/s] 96%|█████████▌| 344/358 [00:35<00:01,  9.82it/s] 96%|█████████▋| 345/358 [00:35<00:01,  9.84it/s] 97%|█████████▋| 346/358 [00:35<00:01,  9.88it/s] 97%|█████████▋| 348/358 [00:35<00:01,  9.96it/s] 97%|█████████▋| 349/358 [00:35<00:00,  9.88it/s] 98%|█████████▊| 350/358 [00:35<00:00,  9.80it/s] 98%|█████████▊| 351/358 [00:35<00:00,  9.75it/s] 99%|█████████▊| 353/358 [00:35<00:00,  9.92it/s] 99%|█████████▉| 354/358 [00:36<00:00,  9.90it/s] 99%|█████████▉| 355/358 [00:36<00:00,  9.81it/s]100%|█████████▉| 357/358 [00:36<00:00,  9.86it/s]100%|██████████| 358/358 [00:36<00:00,  9.81it/s]
[32m2025-02-05 05:53:39.195[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    gen_loss  grad clip ratio  grad norm   ppl
       2.005                1       2.66 7.423[0m
[32m2025-02-05 05:53:39.195[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m169[0m - [1m[Valid][0m
  0%|          | 0/10256 [00:00<?, ?it/s]100%|██████████| 10256/10256 [00:00<00:00, 926367.08it/s]
[32m2025-02-05 05:53:39.206[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:27,  1.44it/s]  5%|▌         | 2/40 [00:01<00:25,  1.46it/s]  8%|▊         | 3/40 [00:02<00:25,  1.47it/s] 10%|█         | 4/40 [00:02<00:24,  1.47it/s] 12%|█▎        | 5/40 [00:03<00:24,  1.46it/s] 15%|█▌        | 6/40 [00:04<00:23,  1.45it/s] 18%|█▊        | 7/40 [00:04<00:22,  1.45it/s] 20%|██        | 8/40 [00:05<00:21,  1.46it/s] 22%|██▎       | 9/40 [00:06<00:21,  1.46it/s] 25%|██▌       | 10/40 [00:06<00:20,  1.47it/s] 28%|██▊       | 11/40 [00:07<00:19,  1.46it/s] 30%|███       | 12/40 [00:08<00:19,  1.46it/s] 32%|███▎      | 13/40 [00:08<00:18,  1.46it/s] 35%|███▌      | 14/40 [00:09<00:17,  1.45it/s] 38%|███▊      | 15/40 [00:10<00:17,  1.45it/s] 40%|████      | 16/40 [00:10<00:16,  1.45it/s] 42%|████▎     | 17/40 [00:11<00:15,  1.46it/s] 45%|████▌     | 18/40 [00:12<00:15,  1.46it/s] 48%|████▊     | 19/40 [00:13<00:14,  1.46it/s] 50%|█████     | 20/40 [00:13<00:13,  1.46it/s] 52%|█████▎    | 21/40 [00:14<00:12,  1.47it/s] 55%|█████▌    | 22/40 [00:15<00:12,  1.46it/s] 57%|█████▊    | 23/40 [00:15<00:11,  1.46it/s] 60%|██████    | 24/40 [00:16<00:10,  1.46it/s] 62%|██████▎   | 25/40 [00:17<00:10,  1.46it/s] 65%|██████▌   | 26/40 [00:17<00:09,  1.47it/s] 68%|██████▊   | 27/40 [00:18<00:08,  1.46it/s] 70%|███████   | 28/40 [00:19<00:08,  1.46it/s] 72%|███████▎  | 29/40 [00:19<00:07,  1.46it/s] 75%|███████▌  | 30/40 [00:20<00:06,  1.47it/s] 78%|███████▊  | 31/40 [00:21<00:06,  1.47it/s] 80%|████████  | 32/40 [00:21<00:05,  1.47it/s] 82%|████████▎ | 33/40 [00:22<00:04,  1.46it/s] 85%|████████▌ | 34/40 [00:23<00:04,  1.46it/s] 88%|████████▊ | 35/40 [00:23<00:03,  1.46it/s] 90%|█████████ | 36/40 [00:24<00:02,  1.46it/s] 92%|█████████▎| 37/40 [00:25<00:02,  1.46it/s] 95%|█████████▌| 38/40 [00:26<00:01,  1.45it/s] 98%|█████████▊| 39/40 [00:26<00:00,  1.45it/s]100%|██████████| 40/40 [00:27<00:00,  1.60it/s]100%|██████████| 40/40 [00:27<00:00,  1.47it/s]
[32m2025-02-05 05:54:06.394[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    average  bleu@1  bleu@2  bleu@3  bleu@4  dist@1  dist@2  dist@3  dist@4  extreme  \
      .7763   .2994   .1076  .04756  .02522  .04993   .3310   .6228   .7955    .5900   
      f1  gen_loss  greedy  intra_dist@1  intra_dist@2  intra_dist@3  intra_dist@4  \
   .3544     4.889   .6656         .8909         .9794         .9603         .9178   
     ppl  rouge1  rouge2  rougeL  
   132.9   .3855  .09021   .3732[0m
[32m2025-02-05 05:54:06.400[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m163[0m - [1m[Conversation epoch 43][0m
[32m2025-02-05 05:54:06.400[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m164[0m - [1m[Train][0m
  0%|          | 0/92414 [00:00<?, ?it/s]100%|██████████| 92414/92414 [00:00<00:00, 1080714.79it/s]
[32m2025-02-05 05:54:06.486[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/358 [00:00<?, ?it/s]  0%|          | 1/358 [00:00<00:36,  9.74it/s]  1%|          | 3/358 [00:00<00:35,  9.92it/s]  1%|          | 4/358 [00:00<00:35,  9.90it/s]  2%|▏         | 6/358 [00:00<00:35,  9.87it/s]  2%|▏         | 7/358 [00:00<00:35,  9.80it/s]  2%|▏         | 8/358 [00:00<00:35,  9.84it/s]  3%|▎         | 9/358 [00:00<00:35,  9.74it/s]  3%|▎         | 10/358 [00:01<00:35,  9.74it/s]  3%|▎         | 11/358 [00:01<00:35,  9.68it/s]  4%|▎         | 13/358 [00:01<00:34,  9.91it/s]  4%|▍         | 14/358 [00:01<00:34,  9.83it/s]  4%|▍         | 15/358 [00:01<00:35,  9.76it/s]  4%|▍         | 16/358 [00:01<00:35,  9.70it/s]  5%|▍         | 17/358 [00:01<00:35,  9.71it/s]  5%|▌         | 18/358 [00:01<00:34,  9.79it/s]  5%|▌         | 19/358 [00:01<00:34,  9.72it/s]  6%|▌         | 20/358 [00:02<00:34,  9.66it/s]  6%|▌         | 21/358 [00:02<00:35,  9.59it/s]  6%|▌         | 22/358 [00:02<00:34,  9.66it/s]  7%|▋         | 24/358 [00:02<00:34,  9.76it/s]  7%|▋         | 25/358 [00:02<00:34,  9.71it/s]  7%|▋         | 26/358 [00:02<00:34,  9.66it/s]  8%|▊         | 27/358 [00:02<00:34,  9.71it/s]  8%|▊         | 28/358 [00:02<00:34,  9.67it/s]  8%|▊         | 29/358 [00:02<00:34,  9.64it/s]  9%|▊         | 31/358 [00:03<00:33,  9.74it/s]  9%|▉         | 32/358 [00:03<00:33,  9.74it/s]  9%|▉         | 34/358 [00:03<00:32,  9.84it/s] 10%|█         | 36/358 [00:03<00:32,  9.83it/s] 10%|█         | 37/358 [00:03<00:32,  9.82it/s] 11%|█         | 38/358 [00:03<00:32,  9.77it/s] 11%|█         | 40/358 [00:04<00:32,  9.93it/s] 11%|█▏        | 41/358 [00:04<00:32,  9.85it/s] 12%|█▏        | 43/358 [00:04<00:31,  9.87it/s] 13%|█▎        | 45/358 [00:04<00:31,  9.97it/s] 13%|█▎        | 47/358 [00:04<00:31,  9.94it/s] 13%|█▎        | 48/358 [00:04<00:31,  9.93it/s] 14%|█▍        | 50/358 [00:05<00:31,  9.90it/s] 14%|█▍        | 51/358 [00:05<00:31,  9.83it/s] 15%|█▍        | 52/358 [00:05<00:31,  9.74it/s] 15%|█▍        | 53/358 [00:05<00:31,  9.69it/s] 15%|█▌        | 54/358 [00:05<00:31,  9.73it/s] 15%|█▌        | 55/358 [00:05<00:31,  9.68it/s] 16%|█▌        | 56/358 [00:05<00:31,  9.72it/s] 16%|█▌        | 57/358 [00:05<00:31,  9.68it/s] 16%|█▌        | 58/358 [00:05<00:31,  9.66it/s] 16%|█▋        | 59/358 [00:06<00:31,  9.63it/s] 17%|█▋        | 61/358 [00:06<00:30,  9.71it/s] 17%|█▋        | 62/358 [00:06<00:30,  9.63it/s] 18%|█▊        | 63/358 [00:06<00:30,  9.70it/s] 18%|█▊        | 64/358 [00:06<00:30,  9.65it/s] 18%|█▊        | 66/358 [00:06<00:30,  9.72it/s] 19%|█▊        | 67/358 [00:06<00:29,  9.70it/s] 19%|█▉        | 69/358 [00:07<00:29,  9.77it/s] 20%|█▉        | 70/358 [00:07<00:29,  9.72it/s] 20%|█▉        | 71/358 [00:07<00:29,  9.76it/s] 20%|██        | 72/358 [00:07<00:29,  9.71it/s] 20%|██        | 73/358 [00:07<00:29,  9.68it/s] 21%|██        | 74/358 [00:07<00:29,  9.64it/s] 21%|██        | 75/358 [00:07<00:29,  9.61it/s] 21%|██        | 76/358 [00:07<00:29,  9.71it/s] 22%|██▏       | 77/358 [00:07<00:29,  9.68it/s] 22%|██▏       | 79/358 [00:08<00:28,  9.69it/s] 23%|██▎       | 81/358 [00:08<00:28,  9.75it/s] 23%|██▎       | 83/358 [00:08<00:28,  9.77it/s] 23%|██▎       | 84/358 [00:08<00:28,  9.72it/s] 24%|██▎       | 85/358 [00:08<00:28,  9.68it/s] 24%|██▍       | 86/358 [00:08<00:28,  9.66it/s] 24%|██▍       | 87/358 [00:08<00:28,  9.64it/s] 25%|██▍       | 88/358 [00:09<00:27,  9.66it/s] 25%|██▌       | 90/358 [00:09<00:27,  9.90it/s] 26%|██▌       | 92/358 [00:09<00:26, 10.00it/s] 26%|██▌       | 93/358 [00:09<00:26,  9.96it/s] 26%|██▋       | 94/358 [00:09<00:26,  9.87it/s] 27%|██▋       | 96/358 [00:09<00:25, 10.15it/s] 27%|██▋       | 98/358 [00:10<00:25, 10.04it/s] 28%|██▊       | 99/358 [00:10<00:26,  9.95it/s] 28%|██▊       | 101/358 [00:10<00:25,  9.92it/s] 29%|██▉       | 103/358 [00:10<00:25,  9.91it/s] 29%|██▉       | 104/358 [00:10<00:25,  9.86it/s] 29%|██▉       | 105/358 [00:10<00:25,  9.78it/s] 30%|██▉       | 106/358 [00:10<00:25,  9.76it/s] 30%|███       | 108/358 [00:11<00:25,  9.79it/s] 30%|███       | 109/358 [00:11<00:25,  9.70it/s] 31%|███       | 110/358 [00:11<00:25,  9.69it/s] 31%|███       | 111/358 [00:11<00:25,  9.64it/s] 32%|███▏      | 113/358 [00:11<00:24,  9.91it/s] 32%|███▏      | 114/358 [00:11<00:24,  9.87it/s] 32%|███▏      | 115/358 [00:11<00:24,  9.77it/s] 32%|███▏      | 116/358 [00:11<00:24,  9.69it/s] 33%|███▎      | 117/358 [00:11<00:24,  9.66it/s] 33%|███▎      | 119/358 [00:12<00:24,  9.78it/s] 34%|███▍      | 121/358 [00:12<00:23,  9.97it/s] 34%|███▍      | 123/358 [00:12<00:23, 10.07it/s] 35%|███▍      | 125/358 [00:12<00:23, 10.05it/s] 35%|███▌      | 127/358 [00:12<00:23,  9.98it/s] 36%|███▌      | 128/358 [00:13<00:23,  9.94it/s] 36%|███▋      | 130/358 [00:13<00:22,  9.99it/s] 37%|███▋      | 131/358 [00:13<00:22,  9.90it/s] 37%|███▋      | 132/358 [00:13<00:22,  9.91it/s] 37%|███▋      | 134/358 [00:13<00:22,  9.93it/s] 38%|███▊      | 135/358 [00:13<00:22,  9.87it/s] 38%|███▊      | 137/358 [00:13<00:22,  9.95it/s] 39%|███▊      | 138/358 [00:14<00:22,  9.94it/s] 39%|███▉      | 139/358 [00:14<00:22,  9.85it/s] 39%|███▉      | 141/358 [00:14<00:21,  9.97it/s] 40%|███▉      | 142/358 [00:14<00:21,  9.89it/s] 40%|███▉      | 143/358 [00:14<00:21,  9.86it/s] 40%|████      | 144/358 [00:14<00:21,  9.77it/s] 41%|████      | 145/358 [00:14<00:21,  9.79it/s] 41%|████      | 146/358 [00:14<00:21,  9.73it/s] 41%|████      | 147/358 [00:14<00:21,  9.67it/s] 41%|████▏     | 148/358 [00:15<00:21,  9.70it/s] 42%|████▏     | 149/358 [00:15<00:21,  9.69it/s] 42%|████▏     | 150/358 [00:15<00:21,  9.64it/s] 42%|████▏     | 151/358 [00:15<00:22,  9.38it/s] 42%|████▏     | 152/358 [00:15<00:21,  9.43it/s] 43%|████▎     | 153/358 [00:15<00:21,  9.44it/s] 43%|████▎     | 154/358 [00:15<00:21,  9.54it/s] 43%|████▎     | 155/358 [00:15<00:21,  9.54it/s] 44%|████▎     | 156/358 [00:15<00:20,  9.67it/s] 44%|████▍     | 157/358 [00:16<00:20,  9.61it/s] 44%|████▍     | 158/358 [00:16<00:20,  9.69it/s] 44%|████▍     | 159/358 [00:16<00:20,  9.69it/s] 45%|████▍     | 160/358 [00:16<00:20,  9.70it/s] 45%|████▌     | 162/358 [00:16<00:19,  9.99it/s] 46%|████▌     | 164/358 [00:16<00:19,  9.99it/s] 46%|████▌     | 165/358 [00:16<00:19,  9.95it/s] 47%|████▋     | 167/358 [00:17<00:19,  9.89it/s] 47%|████▋     | 169/358 [00:17<00:19,  9.93it/s] 48%|████▊     | 171/358 [00:17<00:18,  9.92it/s] 48%|████▊     | 172/358 [00:17<00:18,  9.86it/s] 48%|████▊     | 173/358 [00:17<00:18,  9.80it/s] 49%|████▉     | 175/358 [00:17<00:18,  9.82it/s] 49%|████▉     | 176/358 [00:17<00:18,  9.84it/s] 49%|████▉     | 177/358 [00:18<00:18,  9.82it/s] 50%|█████     | 179/358 [00:18<00:18,  9.84it/s] 50%|█████     | 180/358 [00:18<00:18,  9.77it/s] 51%|█████     | 182/358 [00:18<00:17,  9.92it/s] 51%|█████     | 183/358 [00:18<00:17,  9.88it/s] 51%|█████▏    | 184/358 [00:18<00:17,  9.77it/s] 52%|█████▏    | 185/358 [00:18<00:17,  9.71it/s] 52%|█████▏    | 187/358 [00:19<00:17,  9.93it/s] 53%|█████▎    | 188/358 [00:19<00:17,  9.88it/s] 53%|█████▎    | 189/358 [00:19<00:17,  9.82it/s] 53%|█████▎    | 190/358 [00:19<00:17,  9.86it/s] 53%|█████▎    | 191/358 [00:19<00:17,  9.70it/s] 54%|█████▎    | 192/358 [00:19<00:17,  9.64it/s] 54%|█████▍    | 193/358 [00:19<00:17,  9.65it/s] 54%|█████▍    | 194/358 [00:19<00:17,  9.63it/s] 54%|█████▍    | 195/358 [00:19<00:16,  9.71it/s] 55%|█████▌    | 197/358 [00:20<00:16,  9.90it/s] 55%|█████▌    | 198/358 [00:20<00:16,  9.82it/s] 56%|█████▌    | 199/358 [00:20<00:16,  9.86it/s] 56%|█████▌    | 200/358 [00:20<00:16,  9.79it/s] 56%|█████▌    | 201/358 [00:20<00:16,  9.75it/s] 57%|█████▋    | 203/358 [00:20<00:15,  9.84it/s] 57%|█████▋    | 204/358 [00:20<00:15,  9.74it/s] 57%|█████▋    | 205/358 [00:20<00:15,  9.69it/s] 58%|█████▊    | 207/358 [00:21<00:15,  9.86it/s] 58%|█████▊    | 208/358 [00:21<00:15,  9.79it/s] 59%|█████▊    | 210/358 [00:21<00:15,  9.81it/s] 59%|█████▉    | 212/358 [00:21<00:14,  9.80it/s] 60%|█████▉    | 214/358 [00:21<00:14,  9.88it/s] 60%|██████    | 215/358 [00:21<00:14,  9.82it/s] 60%|██████    | 216/358 [00:22<00:14,  9.76it/s] 61%|██████    | 217/358 [00:22<00:14,  9.79it/s] 61%|██████    | 218/358 [00:22<00:14,  9.76it/s] 61%|██████    | 219/358 [00:22<00:14,  9.76it/s] 62%|██████▏   | 221/358 [00:22<00:13,  9.89it/s] 62%|██████▏   | 222/358 [00:22<00:13,  9.79it/s] 62%|██████▏   | 223/358 [00:22<00:13,  9.73it/s] 63%|██████▎   | 224/358 [00:22<00:13,  9.68it/s] 63%|██████▎   | 225/358 [00:22<00:13,  9.76it/s] 63%|██████▎   | 226/358 [00:23<00:13,  9.71it/s] 64%|██████▎   | 228/358 [00:23<00:13,  9.75it/s] 64%|██████▍   | 229/358 [00:23<00:13,  9.72it/s] 64%|██████▍   | 230/358 [00:23<00:13,  9.67it/s] 65%|██████▍   | 232/358 [00:23<00:12,  9.72it/s] 65%|██████▌   | 234/358 [00:23<00:12, 10.01it/s] 66%|██████▌   | 236/358 [00:24<00:12,  9.97it/s] 66%|██████▋   | 238/358 [00:24<00:11, 10.02it/s] 67%|██████▋   | 240/358 [00:24<00:11,  9.98it/s] 68%|██████▊   | 242/358 [00:24<00:11,  9.96it/s] 68%|██████▊   | 243/358 [00:24<00:11,  9.90it/s] 68%|██████▊   | 244/358 [00:24<00:11,  9.84it/s] 69%|██████▊   | 246/358 [00:25<00:11,  9.86it/s] 69%|██████▉   | 247/358 [00:25<00:11,  9.78it/s] 69%|██████▉   | 248/358 [00:25<00:11,  9.74it/s] 70%|██████▉   | 250/358 [00:25<00:10,  9.82it/s] 70%|███████   | 251/358 [00:25<00:10,  9.76it/s] 70%|███████   | 252/358 [00:25<00:10,  9.70it/s] 71%|███████   | 253/358 [00:25<00:10,  9.66it/s] 71%|███████   | 254/358 [00:25<00:10,  9.63it/s] 72%|███████▏  | 256/358 [00:26<00:10,  9.81it/s] 72%|███████▏  | 257/358 [00:26<00:10,  9.82it/s] 72%|███████▏  | 258/358 [00:26<00:10,  9.69it/s] 72%|███████▏  | 259/358 [00:26<00:10,  9.66it/s] 73%|███████▎  | 260/358 [00:26<00:10,  9.70it/s] 73%|███████▎  | 262/358 [00:26<00:09,  9.88it/s] 74%|███████▎  | 264/358 [00:26<00:09,  9.90it/s] 74%|███████▍  | 266/358 [00:27<00:09,  9.89it/s] 75%|███████▍  | 267/358 [00:27<00:09,  9.83it/s] 75%|███████▌  | 269/358 [00:27<00:09,  9.88it/s] 75%|███████▌  | 270/358 [00:27<00:08,  9.82it/s] 76%|███████▌  | 271/358 [00:27<00:08,  9.74it/s] 76%|███████▌  | 272/358 [00:27<00:08,  9.72it/s] 76%|███████▋  | 273/358 [00:27<00:08,  9.62it/s] 77%|███████▋  | 274/358 [00:27<00:08,  9.62it/s] 77%|███████▋  | 275/358 [00:28<00:08,  9.66it/s] 77%|███████▋  | 276/358 [00:28<00:08,  9.67it/s] 77%|███████▋  | 277/358 [00:28<00:08,  9.63it/s] 78%|███████▊  | 278/358 [00:28<00:08,  9.61it/s] 78%|███████▊  | 280/358 [00:28<00:07,  9.81it/s] 78%|███████▊  | 281/358 [00:28<00:07,  9.82it/s] 79%|███████▉  | 282/358 [00:28<00:07,  9.76it/s] 79%|███████▉  | 283/358 [00:28<00:07,  9.69it/s] 79%|███████▉  | 284/358 [00:28<00:07,  9.66it/s] 80%|███████▉  | 285/358 [00:29<00:07,  9.72it/s] 80%|███████▉  | 286/358 [00:29<00:07,  9.68it/s] 80%|████████  | 287/358 [00:29<00:07,  9.66it/s] 80%|████████  | 288/358 [00:29<00:07,  9.62it/s] 81%|████████  | 290/358 [00:29<00:06,  9.83it/s] 81%|████████▏ | 291/358 [00:29<00:06,  9.81it/s] 82%|████████▏ | 293/358 [00:29<00:06,  9.82it/s] 82%|████████▏ | 295/358 [00:30<00:06,  9.90it/s] 83%|████████▎ | 296/358 [00:30<00:06,  9.83it/s] 83%|████████▎ | 297/358 [00:30<00:06,  9.72it/s] 84%|████████▎ | 299/358 [00:30<00:05,  9.88it/s] 84%|████████▍ | 301/358 [00:30<00:05,  9.92it/s] 84%|████████▍ | 302/358 [00:30<00:05,  9.84it/s] 85%|████████▍ | 303/358 [00:30<00:05,  9.84it/s] 85%|████████▌ | 305/358 [00:31<00:05,  9.88it/s] 85%|████████▌ | 306/358 [00:31<00:05,  9.81it/s] 86%|████████▌ | 308/358 [00:31<00:05,  9.91it/s] 86%|████████▋ | 309/358 [00:31<00:04,  9.81it/s] 87%|████████▋ | 310/358 [00:31<00:04,  9.76it/s] 87%|████████▋ | 311/358 [00:31<00:04,  9.68it/s] 87%|████████▋ | 312/358 [00:31<00:04,  9.69it/s] 87%|████████▋ | 313/358 [00:31<00:04,  9.71it/s] 88%|████████▊ | 315/358 [00:32<00:04,  9.97it/s] 88%|████████▊ | 316/358 [00:32<00:04,  9.92it/s] 89%|████████▊ | 317/358 [00:32<00:04,  9.84it/s] 89%|████████▉ | 318/358 [00:32<00:04,  9.79it/s] 89%|████████▉ | 319/358 [00:32<00:04,  9.74it/s] 89%|████████▉ | 320/358 [00:32<00:03,  9.80it/s] 90%|████████▉ | 321/358 [00:32<00:03,  9.73it/s] 90%|████████▉ | 322/358 [00:32<00:03,  9.69it/s] 90%|█████████ | 323/358 [00:32<00:03,  9.64it/s] 91%|█████████ | 324/358 [00:33<00:03,  9.61it/s] 91%|█████████ | 325/358 [00:33<00:03,  9.59it/s] 91%|█████████▏| 327/358 [00:33<00:03,  9.96it/s] 92%|█████████▏| 329/358 [00:33<00:02, 10.05it/s] 92%|█████████▏| 330/358 [00:33<00:02,  9.94it/s] 93%|█████████▎| 332/358 [00:33<00:02, 10.04it/s] 93%|█████████▎| 334/358 [00:34<00:02,  9.94it/s] 94%|█████████▎| 335/358 [00:34<00:02,  9.82it/s] 94%|█████████▍| 337/358 [00:34<00:02,  9.90it/s] 95%|█████████▍| 339/358 [00:34<00:01, 10.10it/s] 95%|█████████▌| 341/358 [00:34<00:01, 10.04it/s] 96%|█████████▌| 343/358 [00:34<00:01,  9.88it/s] 96%|█████████▌| 344/358 [00:35<00:01,  9.82it/s] 96%|█████████▋| 345/358 [00:35<00:01,  9.84it/s] 97%|█████████▋| 346/358 [00:35<00:01,  9.87it/s] 97%|█████████▋| 348/358 [00:35<00:01,  9.96it/s] 97%|█████████▋| 349/358 [00:35<00:00,  9.88it/s] 98%|█████████▊| 350/358 [00:35<00:00,  9.80it/s] 98%|█████████▊| 351/358 [00:35<00:00,  9.75it/s] 99%|█████████▊| 353/358 [00:35<00:00,  9.91it/s] 99%|█████████▉| 354/358 [00:36<00:00,  9.89it/s] 99%|█████████▉| 355/358 [00:36<00:00,  9.80it/s]100%|█████████▉| 357/358 [00:36<00:00,  9.85it/s]100%|██████████| 358/358 [00:36<00:00,  9.81it/s]
[32m2025-02-05 05:54:42.978[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    gen_loss  grad clip ratio  grad norm  ppl
       1.991                1      4.839 7.32[0m
[32m2025-02-05 05:54:42.979[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m169[0m - [1m[Valid][0m
  0%|          | 0/10256 [00:00<?, ?it/s]100%|██████████| 10256/10256 [00:00<00:00, 921149.96it/s]
[32m2025-02-05 05:54:42.990[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:27,  1.43it/s]  5%|▌         | 2/40 [00:01<00:26,  1.46it/s]  8%|▊         | 3/40 [00:02<00:25,  1.46it/s] 10%|█         | 4/40 [00:02<00:24,  1.46it/s] 12%|█▎        | 5/40 [00:03<00:24,  1.45it/s] 15%|█▌        | 6/40 [00:04<00:23,  1.45it/s] 18%|█▊        | 7/40 [00:04<00:22,  1.45it/s] 20%|██        | 8/40 [00:05<00:21,  1.46it/s] 22%|██▎       | 9/40 [00:06<00:21,  1.46it/s] 25%|██▌       | 10/40 [00:06<00:20,  1.46it/s] 28%|██▊       | 11/40 [00:07<00:19,  1.46it/s] 30%|███       | 12/40 [00:08<00:19,  1.46it/s] 32%|███▎      | 13/40 [00:08<00:18,  1.46it/s] 35%|███▌      | 14/40 [00:09<00:17,  1.45it/s] 38%|███▊      | 15/40 [00:10<00:17,  1.45it/s] 40%|████      | 16/40 [00:11<00:16,  1.45it/s] 42%|████▎     | 17/40 [00:11<00:15,  1.46it/s] 45%|████▌     | 18/40 [00:12<00:15,  1.46it/s] 48%|████▊     | 19/40 [00:13<00:14,  1.45it/s] 50%|█████     | 20/40 [00:13<00:13,  1.46it/s] 52%|█████▎    | 21/40 [00:14<00:13,  1.46it/s] 55%|█████▌    | 22/40 [00:15<00:12,  1.46it/s] 57%|█████▊    | 23/40 [00:15<00:11,  1.46it/s] 60%|██████    | 24/40 [00:16<00:11,  1.45it/s] 62%|██████▎   | 25/40 [00:17<00:10,  1.45it/s] 65%|██████▌   | 26/40 [00:17<00:09,  1.46it/s] 68%|██████▊   | 27/40 [00:18<00:08,  1.46it/s] 70%|███████   | 28/40 [00:19<00:08,  1.46it/s] 72%|███████▎  | 29/40 [00:19<00:07,  1.46it/s] 75%|███████▌  | 30/40 [00:20<00:06,  1.46it/s] 78%|███████▊  | 31/40 [00:21<00:06,  1.46it/s] 80%|████████  | 32/40 [00:21<00:05,  1.46it/s] 82%|████████▎ | 33/40 [00:22<00:04,  1.46it/s] 85%|████████▌ | 34/40 [00:23<00:04,  1.46it/s] 88%|████████▊ | 35/40 [00:24<00:03,  1.45it/s] 90%|█████████ | 36/40 [00:24<00:02,  1.45it/s] 92%|█████████▎| 37/40 [00:25<00:02,  1.45it/s] 95%|█████████▌| 38/40 [00:26<00:01,  1.45it/s] 98%|█████████▊| 39/40 [00:26<00:00,  1.45it/s]100%|██████████| 40/40 [00:27<00:00,  1.60it/s]100%|██████████| 40/40 [00:27<00:00,  1.47it/s]
[32m2025-02-05 05:55:10.282[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    average  bleu@1  bleu@2  bleu@3  bleu@4  dist@1  dist@2  dist@3  dist@4  extreme  \
      .7792   .3022   .1124   .0468  .02402  .04449   .3015   .5901   .7746    .5949   
      f1  gen_loss  greedy  intra_dist@1  intra_dist@2  intra_dist@3  intra_dist@4  \
   .3556     4.857   .6687         .8774         .9744         .9591         .9251   
     ppl  rouge1  rouge2  rougeL  
   128.6   .3883  .09213   .3754[0m
[32m2025-02-05 05:55:10.287[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m163[0m - [1m[Conversation epoch 44][0m
[32m2025-02-05 05:55:10.287[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m164[0m - [1m[Train][0m
  0%|          | 0/92414 [00:00<?, ?it/s]100%|██████████| 92414/92414 [00:00<00:00, 1099410.06it/s]
[32m2025-02-05 05:55:10.372[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/358 [00:00<?, ?it/s]  0%|          | 1/358 [00:00<00:36,  9.76it/s]  1%|          | 3/358 [00:00<00:35,  9.92it/s]  1%|          | 4/358 [00:00<00:35,  9.90it/s]  2%|▏         | 6/358 [00:00<00:35,  9.86it/s]  2%|▏         | 7/358 [00:00<00:35,  9.80it/s]  2%|▏         | 8/358 [00:00<00:35,  9.84it/s]  3%|▎         | 9/358 [00:00<00:35,  9.75it/s]  3%|▎         | 10/358 [00:01<00:35,  9.73it/s]  3%|▎         | 11/358 [00:01<00:35,  9.68it/s]  4%|▎         | 13/358 [00:01<00:34,  9.90it/s]  4%|▍         | 14/358 [00:01<00:34,  9.83it/s]  4%|▍         | 15/358 [00:01<00:35,  9.76it/s]  4%|▍         | 16/358 [00:01<00:35,  9.69it/s]  5%|▍         | 17/358 [00:01<00:35,  9.71it/s]  5%|▌         | 18/358 [00:01<00:34,  9.78it/s]  5%|▌         | 19/358 [00:01<00:34,  9.71it/s]  6%|▌         | 20/358 [00:02<00:34,  9.66it/s]  6%|▌         | 21/358 [00:02<00:35,  9.59it/s]  6%|▌         | 22/358 [00:02<00:34,  9.66it/s]  7%|▋         | 24/358 [00:02<00:34,  9.76it/s]  7%|▋         | 25/358 [00:02<00:34,  9.71it/s]  7%|▋         | 26/358 [00:02<00:34,  9.66it/s]  8%|▊         | 27/358 [00:02<00:34,  9.71it/s]  8%|▊         | 28/358 [00:02<00:34,  9.67it/s]  8%|▊         | 29/358 [00:02<00:34,  9.64it/s]  9%|▊         | 31/358 [00:03<00:33,  9.74it/s]  9%|▉         | 32/358 [00:03<00:33,  9.73it/s]  9%|▉         | 34/358 [00:03<00:32,  9.83it/s] 10%|█         | 36/358 [00:03<00:32,  9.83it/s] 10%|█         | 37/358 [00:03<00:32,  9.82it/s] 11%|█         | 38/358 [00:03<00:32,  9.78it/s] 11%|█         | 40/358 [00:04<00:32,  9.93it/s] 11%|█▏        | 41/358 [00:04<00:32,  9.85it/s] 12%|█▏        | 43/358 [00:04<00:31,  9.87it/s] 13%|█▎        | 45/358 [00:04<00:31,  9.97it/s] 13%|█▎        | 47/358 [00:04<00:31,  9.94it/s] 13%|█▎        | 48/358 [00:04<00:31,  9.93it/s] 14%|█▍        | 50/358 [00:05<00:31,  9.90it/s] 14%|█▍        | 51/358 [00:05<00:31,  9.83it/s] 15%|█▍        | 52/358 [00:05<00:31,  9.74it/s] 15%|█▍        | 53/358 [00:05<00:31,  9.69it/s] 15%|█▌        | 54/358 [00:05<00:31,  9.73it/s] 15%|█▌        | 55/358 [00:05<00:31,  9.68it/s] 16%|█▌        | 56/358 [00:05<00:31,  9.72it/s] 16%|█▌        | 57/358 [00:05<00:31,  9.68it/s] 16%|█▌        | 58/358 [00:05<00:31,  9.66it/s] 16%|█▋        | 59/358 [00:06<00:31,  9.63it/s] 17%|█▋        | 61/358 [00:06<00:30,  9.71it/s] 17%|█▋        | 62/358 [00:06<00:30,  9.64it/s] 18%|█▊        | 63/358 [00:06<00:30,  9.70it/s] 18%|█▊        | 64/358 [00:06<00:30,  9.65it/s] 18%|█▊        | 66/358 [00:06<00:30,  9.72it/s] 19%|█▊        | 67/358 [00:06<00:29,  9.71it/s] 19%|█▉        | 69/358 [00:07<00:29,  9.77it/s] 20%|█▉        | 70/358 [00:07<00:29,  9.72it/s] 20%|█▉        | 71/358 [00:07<00:29,  9.76it/s] 20%|██        | 72/358 [00:07<00:29,  9.71it/s] 20%|██        | 73/358 [00:07<00:29,  9.67it/s] 21%|██        | 74/358 [00:07<00:29,  9.64it/s] 21%|██        | 75/358 [00:07<00:29,  9.61it/s] 21%|██        | 76/358 [00:07<00:29,  9.72it/s] 22%|██▏       | 77/358 [00:07<00:29,  9.68it/s] 22%|██▏       | 79/358 [00:08<00:28,  9.69it/s] 23%|██▎       | 81/358 [00:08<00:28,  9.75it/s] 23%|██▎       | 83/358 [00:08<00:28,  9.77it/s] 23%|██▎       | 84/358 [00:08<00:28,  9.72it/s] 24%|██▎       | 85/358 [00:08<00:28,  9.68it/s] 24%|██▍       | 86/358 [00:08<00:28,  9.66it/s] 24%|██▍       | 87/358 [00:08<00:28,  9.64it/s] 25%|██▍       | 88/358 [00:09<00:27,  9.66it/s] 25%|██▌       | 90/358 [00:09<00:27,  9.90it/s] 26%|██▌       | 92/358 [00:09<00:26, 10.00it/s] 26%|██▌       | 93/358 [00:09<00:26,  9.96it/s] 26%|██▋       | 94/358 [00:09<00:26,  9.87it/s] 27%|██▋       | 96/358 [00:09<00:25, 10.15it/s] 27%|██▋       | 98/358 [00:10<00:25, 10.04it/s] 28%|██▊       | 99/358 [00:10<00:26,  9.95it/s] 28%|██▊       | 101/358 [00:10<00:25,  9.92it/s] 29%|██▉       | 103/358 [00:10<00:25,  9.90it/s] 29%|██▉       | 104/358 [00:10<00:25,  9.86it/s] 29%|██▉       | 105/358 [00:10<00:25,  9.78it/s] 30%|██▉       | 106/358 [00:10<00:25,  9.76it/s] 30%|███       | 108/358 [00:11<00:25,  9.79it/s] 30%|███       | 109/358 [00:11<00:25,  9.71it/s] 31%|███       | 110/358 [00:11<00:25,  9.69it/s] 31%|███       | 111/358 [00:11<00:25,  9.64it/s] 32%|███▏      | 113/358 [00:11<00:24,  9.91it/s] 32%|███▏      | 114/358 [00:11<00:24,  9.87it/s] 32%|███▏      | 115/358 [00:11<00:24,  9.77it/s] 32%|███▏      | 116/358 [00:11<00:24,  9.68it/s] 33%|███▎      | 117/358 [00:11<00:24,  9.65it/s] 33%|███▎      | 119/358 [00:12<00:24,  9.77it/s] 34%|███▍      | 121/358 [00:12<00:23,  9.97it/s] 34%|███▍      | 123/358 [00:12<00:23, 10.07it/s] 35%|███▍      | 125/358 [00:12<00:23, 10.05it/s] 35%|███▌      | 126/358 [00:12<00:23, 10.01it/s] 35%|███▌      | 127/358 [00:12<00:23,  9.96it/s] 36%|███▌      | 128/358 [00:13<00:23,  9.91it/s] 36%|███▋      | 130/358 [00:13<00:22,  9.98it/s] 37%|███▋      | 131/358 [00:13<00:22,  9.88it/s] 37%|███▋      | 132/358 [00:13<00:22,  9.90it/s] 37%|███▋      | 134/358 [00:13<00:22,  9.92it/s] 38%|███▊      | 135/358 [00:13<00:22,  9.86it/s] 38%|███▊      | 137/358 [00:13<00:22,  9.95it/s] 39%|███▊      | 138/358 [00:14<00:22,  9.93it/s] 39%|███▉      | 139/358 [00:14<00:22,  9.85it/s] 39%|███▉      | 141/358 [00:14<00:21,  9.96it/s] 40%|███▉      | 142/358 [00:14<00:21,  9.88it/s] 40%|███▉      | 143/358 [00:14<00:21,  9.85it/s] 40%|████      | 144/358 [00:14<00:21,  9.77it/s] 41%|████      | 145/358 [00:14<00:21,  9.79it/s] 41%|████      | 146/358 [00:14<00:21,  9.72it/s] 41%|████      | 147/358 [00:14<00:21,  9.67it/s] 41%|████▏     | 148/358 [00:15<00:21,  9.69it/s] 42%|████▏     | 149/358 [00:15<00:21,  9.60it/s] 42%|████▏     | 150/358 [00:15<00:21,  9.57it/s] 42%|████▏     | 151/358 [00:15<00:22,  9.32it/s] 42%|████▏     | 152/358 [00:15<00:21,  9.38it/s] 43%|████▎     | 153/358 [00:15<00:21,  9.41it/s] 43%|████▎     | 154/358 [00:15<00:21,  9.51it/s] 43%|████▎     | 155/358 [00:15<00:21,  9.52it/s] 44%|████▎     | 156/358 [00:15<00:20,  9.65it/s] 44%|████▍     | 157/358 [00:16<00:20,  9.59it/s] 44%|████▍     | 158/358 [00:16<00:20,  9.68it/s] 44%|████▍     | 159/358 [00:16<00:20,  9.68it/s] 45%|████▍     | 160/358 [00:16<00:20,  9.69it/s] 45%|████▌     | 162/358 [00:16<00:19,  9.98it/s] 46%|████▌     | 164/358 [00:16<00:19,  9.99it/s] 46%|████▌     | 165/358 [00:16<00:19,  9.95it/s] 47%|████▋     | 167/358 [00:17<00:19,  9.90it/s] 47%|████▋     | 169/358 [00:17<00:19,  9.93it/s] 48%|████▊     | 171/358 [00:17<00:18,  9.91it/s] 48%|████▊     | 172/358 [00:17<00:18,  9.86it/s] 48%|████▊     | 173/358 [00:17<00:18,  9.80it/s] 49%|████▉     | 175/358 [00:17<00:18,  9.82it/s] 49%|████▉     | 176/358 [00:17<00:18,  9.83it/s] 49%|████▉     | 177/358 [00:18<00:18,  9.82it/s] 50%|████▉     | 178/358 [00:18<00:18,  9.86it/s] 50%|█████     | 179/358 [00:18<00:18,  9.83it/s] 50%|█████     | 180/358 [00:18<00:18,  9.74it/s] 51%|█████     | 182/358 [00:18<00:17,  9.93it/s] 51%|█████     | 183/358 [00:18<00:17,  9.87it/s] 51%|█████▏    | 184/358 [00:18<00:17,  9.75it/s] 52%|█████▏    | 185/358 [00:18<00:17,  9.70it/s] 52%|█████▏    | 187/358 [00:19<00:17,  9.93it/s] 53%|█████▎    | 188/358 [00:19<00:17,  9.87it/s] 53%|█████▎    | 189/358 [00:19<00:17,  9.82it/s] 53%|█████▎    | 190/358 [00:19<00:17,  9.86it/s] 53%|█████▎    | 191/358 [00:19<00:17,  9.69it/s] 54%|█████▎    | 192/358 [00:19<00:17,  9.64it/s] 54%|█████▍    | 193/358 [00:19<00:17,  9.64it/s] 54%|█████▍    | 194/358 [00:19<00:17,  9.63it/s] 54%|█████▍    | 195/358 [00:19<00:16,  9.71it/s] 55%|█████▌    | 197/358 [00:20<00:16,  9.89it/s] 55%|█████▌    | 198/358 [00:20<00:16,  9.82it/s] 56%|█████▌    | 199/358 [00:20<00:16,  9.82it/s] 56%|█████▌    | 200/358 [00:20<00:16,  9.76it/s] 56%|█████▌    | 201/358 [00:20<00:16,  9.73it/s] 57%|█████▋    | 203/358 [00:20<00:15,  9.83it/s] 57%|█████▋    | 204/358 [00:20<00:15,  9.73it/s] 57%|█████▋    | 205/358 [00:20<00:15,  9.69it/s] 58%|█████▊    | 207/358 [00:21<00:15,  9.86it/s] 58%|█████▊    | 208/358 [00:21<00:15,  9.79it/s] 59%|█████▊    | 210/358 [00:21<00:15,  9.81it/s] 59%|█████▉    | 212/358 [00:21<00:14,  9.80it/s] 60%|█████▉    | 214/358 [00:21<00:14,  9.88it/s] 60%|██████    | 215/358 [00:21<00:14,  9.82it/s] 60%|██████    | 216/358 [00:22<00:14,  9.75it/s] 61%|██████    | 217/358 [00:22<00:14,  9.78it/s] 61%|██████    | 218/358 [00:22<00:14,  9.76it/s] 61%|██████    | 219/358 [00:22<00:14,  9.76it/s] 62%|██████▏   | 221/358 [00:22<00:13,  9.89it/s] 62%|██████▏   | 222/358 [00:22<00:13,  9.79it/s] 62%|██████▏   | 223/358 [00:22<00:13,  9.73it/s] 63%|██████▎   | 224/358 [00:22<00:13,  9.67it/s] 63%|██████▎   | 225/358 [00:22<00:13,  9.76it/s] 63%|██████▎   | 226/358 [00:23<00:13,  9.71it/s] 64%|██████▎   | 228/358 [00:23<00:13,  9.74it/s] 64%|██████▍   | 229/358 [00:23<00:13,  9.72it/s] 64%|██████▍   | 230/358 [00:23<00:13,  9.66it/s] 65%|██████▍   | 232/358 [00:23<00:12,  9.71it/s] 65%|██████▌   | 234/358 [00:23<00:12, 10.00it/s] 66%|██████▌   | 236/358 [00:24<00:12,  9.96it/s] 66%|██████▋   | 238/358 [00:24<00:11, 10.01it/s] 67%|██████▋   | 240/358 [00:24<00:11,  9.98it/s] 68%|██████▊   | 242/358 [00:24<00:11,  9.96it/s] 68%|██████▊   | 243/358 [00:24<00:11,  9.90it/s] 68%|██████▊   | 244/358 [00:24<00:11,  9.83it/s] 69%|██████▊   | 246/358 [00:25<00:11,  9.86it/s] 69%|██████▉   | 247/358 [00:25<00:11,  9.78it/s] 69%|██████▉   | 248/358 [00:25<00:11,  9.74it/s] 70%|██████▉   | 250/358 [00:25<00:10,  9.84it/s] 70%|███████   | 251/358 [00:25<00:10,  9.77it/s] 70%|███████   | 252/358 [00:25<00:10,  9.71it/s] 71%|███████   | 253/358 [00:25<00:10,  9.67it/s] 71%|███████   | 254/358 [00:25<00:10,  9.64it/s] 72%|███████▏  | 256/358 [00:26<00:10,  9.82it/s] 72%|███████▏  | 257/358 [00:26<00:10,  9.82it/s] 72%|███████▏  | 258/358 [00:26<00:10,  9.69it/s] 72%|███████▏  | 259/358 [00:26<00:10,  9.66it/s] 73%|███████▎  | 260/358 [00:26<00:10,  9.70it/s] 73%|███████▎  | 262/358 [00:26<00:09,  9.87it/s] 74%|███████▎  | 264/358 [00:26<00:09,  9.90it/s] 74%|███████▍  | 266/358 [00:27<00:09,  9.89it/s] 75%|███████▍  | 267/358 [00:27<00:09,  9.83it/s] 75%|███████▌  | 269/358 [00:27<00:09,  9.88it/s] 75%|███████▌  | 270/358 [00:27<00:08,  9.81it/s] 76%|███████▌  | 271/358 [00:27<00:08,  9.74it/s] 76%|███████▌  | 272/358 [00:27<00:08,  9.72it/s] 76%|███████▋  | 273/358 [00:27<00:08,  9.62it/s] 77%|███████▋  | 274/358 [00:27<00:08,  9.62it/s] 77%|███████▋  | 275/358 [00:28<00:08,  9.67it/s] 77%|███████▋  | 276/358 [00:28<00:08,  9.67it/s] 77%|███████▋  | 277/358 [00:28<00:08,  9.64it/s] 78%|███████▊  | 278/358 [00:28<00:08,  9.62it/s] 78%|███████▊  | 280/358 [00:28<00:07,  9.80it/s] 78%|███████▊  | 281/358 [00:28<00:07,  9.82it/s] 79%|███████▉  | 282/358 [00:28<00:07,  9.76it/s] 79%|███████▉  | 283/358 [00:28<00:07,  9.69it/s] 79%|███████▉  | 284/358 [00:29<00:07,  9.65it/s] 80%|███████▉  | 285/358 [00:29<00:07,  9.72it/s] 80%|███████▉  | 286/358 [00:29<00:07,  9.67it/s] 80%|████████  | 287/358 [00:29<00:07,  9.65it/s] 80%|████████  | 288/358 [00:29<00:07,  9.62it/s] 81%|████████  | 289/358 [00:29<00:07,  9.73it/s] 81%|████████▏ | 291/358 [00:29<00:06,  9.83it/s] 82%|████████▏ | 293/358 [00:29<00:06,  9.84it/s] 82%|████████▏ | 295/358 [00:30<00:06,  9.90it/s] 83%|████████▎ | 296/358 [00:30<00:06,  9.84it/s] 83%|████████▎ | 297/358 [00:30<00:06,  9.73it/s] 84%|████████▎ | 299/358 [00:30<00:05,  9.89it/s] 84%|████████▍ | 301/358 [00:30<00:05,  9.92it/s] 84%|████████▍ | 302/358 [00:30<00:05,  9.86it/s] 85%|████████▍ | 303/358 [00:30<00:05,  9.86it/s] 85%|████████▌ | 305/358 [00:31<00:05,  9.89it/s] 85%|████████▌ | 306/358 [00:31<00:05,  9.81it/s] 86%|████████▌ | 308/358 [00:31<00:05,  9.91it/s] 86%|████████▋ | 309/358 [00:31<00:04,  9.81it/s] 87%|████████▋ | 310/358 [00:31<00:04,  9.75it/s] 87%|████████▋ | 311/358 [00:31<00:04,  9.68it/s] 87%|████████▋ | 312/358 [00:31<00:04,  9.69it/s] 87%|████████▋ | 313/358 [00:31<00:04,  9.71it/s] 88%|████████▊ | 315/358 [00:32<00:04,  9.97it/s] 88%|████████▊ | 316/358 [00:32<00:04,  9.92it/s] 89%|████████▊ | 317/358 [00:32<00:04,  9.83it/s] 89%|████████▉ | 318/358 [00:32<00:04,  9.79it/s] 89%|████████▉ | 319/358 [00:32<00:04,  9.74it/s] 89%|████████▉ | 320/358 [00:32<00:03,  9.80it/s] 90%|████████▉ | 321/358 [00:32<00:03,  9.73it/s] 90%|████████▉ | 322/358 [00:32<00:03,  9.69it/s] 90%|█████████ | 323/358 [00:32<00:03,  9.64it/s] 91%|█████████ | 324/358 [00:33<00:03,  9.61it/s] 91%|█████████ | 325/358 [00:33<00:03,  9.59it/s] 91%|█████████▏| 327/358 [00:33<00:03,  9.95it/s] 92%|█████████▏| 329/358 [00:33<00:02, 10.05it/s] 92%|█████████▏| 330/358 [00:33<00:02,  9.94it/s] 93%|█████████▎| 332/358 [00:33<00:02, 10.04it/s] 93%|█████████▎| 334/358 [00:34<00:02,  9.94it/s] 94%|█████████▎| 335/358 [00:34<00:02,  9.82it/s] 94%|█████████▍| 337/358 [00:34<00:02,  9.90it/s] 95%|█████████▍| 339/358 [00:34<00:01, 10.10it/s] 95%|█████████▌| 341/358 [00:34<00:01, 10.04it/s] 96%|█████████▌| 343/358 [00:34<00:01,  9.88it/s] 96%|█████████▌| 344/358 [00:35<00:01,  9.83it/s] 96%|█████████▋| 345/358 [00:35<00:01,  9.84it/s] 97%|█████████▋| 346/358 [00:35<00:01,  9.88it/s] 97%|█████████▋| 348/358 [00:35<00:01,  9.96it/s] 97%|█████████▋| 349/358 [00:35<00:00,  9.88it/s] 98%|█████████▊| 350/358 [00:35<00:00,  9.80it/s] 98%|█████████▊| 351/358 [00:35<00:00,  9.75it/s] 99%|█████████▊| 353/358 [00:36<00:00,  9.92it/s] 99%|█████████▉| 354/358 [00:36<00:00,  9.90it/s] 99%|█████████▉| 355/358 [00:36<00:00,  9.81it/s]100%|█████████▉| 357/358 [00:36<00:00,  9.86it/s]100%|██████████| 358/358 [00:36<00:00,  9.81it/s]
[32m2025-02-05 05:55:46.872[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    gen_loss  grad clip ratio  grad norm   ppl
       1.981                1       2.38 7.251[0m
[32m2025-02-05 05:55:46.872[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m169[0m - [1m[Valid][0m
  0%|          | 0/10256 [00:00<?, ?it/s]100%|██████████| 10256/10256 [00:00<00:00, 925092.08it/s]
[32m2025-02-05 05:55:46.884[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:27,  1.42it/s]  5%|▌         | 2/40 [00:01<00:26,  1.45it/s]  8%|▊         | 3/40 [00:02<00:25,  1.45it/s] 10%|█         | 4/40 [00:02<00:24,  1.45it/s] 12%|█▎        | 5/40 [00:03<00:24,  1.44it/s] 15%|█▌        | 6/40 [00:04<00:23,  1.44it/s] 18%|█▊        | 7/40 [00:04<00:22,  1.44it/s] 20%|██        | 8/40 [00:05<00:22,  1.45it/s] 22%|██▎       | 9/40 [00:06<00:21,  1.45it/s] 25%|██▌       | 10/40 [00:06<00:20,  1.45it/s] 28%|██▊       | 11/40 [00:07<00:20,  1.45it/s] 30%|███       | 12/40 [00:08<00:19,  1.45it/s] 32%|███▎      | 13/40 [00:08<00:18,  1.45it/s] 35%|███▌      | 14/40 [00:09<00:18,  1.44it/s] 38%|███▊      | 15/40 [00:10<00:17,  1.44it/s] 40%|████      | 16/40 [00:11<00:16,  1.44it/s] 42%|████▎     | 17/40 [00:11<00:15,  1.44it/s] 45%|████▌     | 18/40 [00:12<00:15,  1.44it/s] 48%|████▊     | 19/40 [00:13<00:14,  1.44it/s] 50%|█████     | 20/40 [00:13<00:13,  1.45it/s] 52%|█████▎    | 21/40 [00:14<00:13,  1.45it/s] 55%|█████▌    | 22/40 [00:15<00:12,  1.45it/s] 57%|█████▊    | 23/40 [00:15<00:11,  1.45it/s] 60%|██████    | 24/40 [00:16<00:11,  1.44it/s] 62%|██████▎   | 25/40 [00:17<00:10,  1.44it/s] 65%|██████▌   | 26/40 [00:17<00:09,  1.45it/s] 68%|██████▊   | 27/40 [00:18<00:08,  1.45it/s] 70%|███████   | 28/40 [00:19<00:08,  1.45it/s] 72%|███████▎  | 29/40 [00:20<00:07,  1.45it/s] 75%|███████▌  | 30/40 [00:20<00:06,  1.45it/s] 78%|███████▊  | 31/40 [00:21<00:06,  1.45it/s] 80%|████████  | 32/40 [00:22<00:05,  1.45it/s] 82%|████████▎ | 33/40 [00:22<00:04,  1.45it/s] 85%|████████▌ | 34/40 [00:23<00:04,  1.45it/s] 88%|████████▊ | 35/40 [00:24<00:03,  1.45it/s] 90%|█████████ | 36/40 [00:24<00:02,  1.44it/s] 92%|█████████▎| 37/40 [00:25<00:02,  1.44it/s] 95%|█████████▌| 38/40 [00:26<00:01,  1.44it/s] 98%|█████████▊| 39/40 [00:26<00:00,  1.44it/s]100%|██████████| 40/40 [00:27<00:00,  1.59it/s]100%|██████████| 40/40 [00:27<00:00,  1.46it/s]
[32m2025-02-05 05:56:14.367[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    average  bleu@1  bleu@2  bleu@3  bleu@4  dist@1  dist@2  dist@3  dist@4  extreme  \
      .7782   .2998   .1129  .04589   .0231  .04208   .2875   .5591   .7186    .5975   
      f1  gen_loss  greedy  intra_dist@1  intra_dist@2  intra_dist@3  intra_dist@4  \
   .3535     4.827   .6682         .8594         .9558         .9409         .9116   
     ppl  rouge1  rouge2  rougeL  
   124.9   .3890  .09381   .3761[0m
[32m2025-02-05 05:56:14.373[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m163[0m - [1m[Conversation epoch 45][0m
[32m2025-02-05 05:56:14.373[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m164[0m - [1m[Train][0m
  0%|          | 0/92414 [00:00<?, ?it/s]100%|██████████| 92414/92414 [00:00<00:00, 1095752.00it/s]
[32m2025-02-05 05:56:14.457[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/358 [00:00<?, ?it/s]  0%|          | 1/358 [00:00<00:36,  9.75it/s]  1%|          | 3/358 [00:00<00:35,  9.92it/s]  1%|          | 4/358 [00:00<00:35,  9.90it/s]  2%|▏         | 6/358 [00:00<00:35,  9.86it/s]  2%|▏         | 7/358 [00:00<00:35,  9.80it/s]  2%|▏         | 8/358 [00:00<00:35,  9.84it/s]  3%|▎         | 9/358 [00:00<00:35,  9.75it/s]  3%|▎         | 10/358 [00:01<00:35,  9.74it/s]  3%|▎         | 11/358 [00:01<00:35,  9.69it/s]  4%|▎         | 13/358 [00:01<00:34,  9.91it/s]  4%|▍         | 14/358 [00:01<00:34,  9.83it/s]  4%|▍         | 15/358 [00:01<00:35,  9.76it/s]  4%|▍         | 16/358 [00:01<00:35,  9.70it/s]  5%|▍         | 17/358 [00:01<00:35,  9.71it/s]  5%|▌         | 18/358 [00:01<00:34,  9.79it/s]  5%|▌         | 19/358 [00:01<00:34,  9.72it/s]  6%|▌         | 20/358 [00:02<00:34,  9.66it/s]  6%|▌         | 21/358 [00:02<00:35,  9.59it/s]  6%|▌         | 22/358 [00:02<00:34,  9.66it/s]  7%|▋         | 24/358 [00:02<00:34,  9.76it/s]  7%|▋         | 25/358 [00:02<00:34,  9.72it/s]  7%|▋         | 26/358 [00:02<00:34,  9.66it/s]  8%|▊         | 27/358 [00:02<00:34,  9.71it/s]  8%|▊         | 28/358 [00:02<00:34,  9.67it/s]  8%|▊         | 29/358 [00:02<00:34,  9.64it/s]  9%|▊         | 31/358 [00:03<00:33,  9.74it/s]  9%|▉         | 32/358 [00:03<00:33,  9.73it/s]  9%|▉         | 34/358 [00:03<00:32,  9.83it/s] 10%|█         | 36/358 [00:03<00:32,  9.83it/s] 10%|█         | 37/358 [00:03<00:32,  9.81it/s] 11%|█         | 38/358 [00:03<00:32,  9.77it/s] 11%|█         | 40/358 [00:04<00:32,  9.93it/s] 11%|█▏        | 41/358 [00:04<00:32,  9.84it/s] 12%|█▏        | 43/358 [00:04<00:31,  9.87it/s] 12%|█▏        | 44/358 [00:04<00:31,  9.89it/s] 13%|█▎        | 46/358 [00:04<00:31,  9.99it/s] 13%|█▎        | 47/358 [00:04<00:31,  9.94it/s] 13%|█▎        | 48/358 [00:04<00:31,  9.92it/s] 14%|█▍        | 50/358 [00:05<00:31,  9.89it/s] 14%|█▍        | 51/358 [00:05<00:31,  9.82it/s] 15%|█▍        | 52/358 [00:05<00:31,  9.73it/s] 15%|█▍        | 53/358 [00:05<00:31,  9.68it/s] 15%|█▌        | 54/358 [00:05<00:31,  9.73it/s] 15%|█▌        | 55/358 [00:05<00:31,  9.67it/s] 16%|█▌        | 56/358 [00:05<00:31,  9.72it/s] 16%|█▌        | 57/358 [00:05<00:31,  9.67it/s] 16%|█▌        | 58/358 [00:05<00:31,  9.65it/s] 16%|█▋        | 59/358 [00:06<00:31,  9.62it/s] 17%|█▋        | 61/358 [00:06<00:30,  9.71it/s] 17%|█▋        | 62/358 [00:06<00:30,  9.63it/s] 18%|█▊        | 63/358 [00:06<00:30,  9.70it/s] 18%|█▊        | 64/358 [00:06<00:30,  9.65it/s] 18%|█▊        | 66/358 [00:06<00:30,  9.72it/s] 19%|█▊        | 67/358 [00:06<00:29,  9.70it/s] 19%|█▉        | 69/358 [00:07<00:29,  9.77it/s] 20%|█▉        | 70/358 [00:07<00:29,  9.71it/s] 20%|█▉        | 71/358 [00:07<00:29,  9.76it/s] 20%|██        | 72/358 [00:07<00:29,  9.71it/s] 20%|██        | 73/358 [00:07<00:29,  9.67it/s] 21%|██        | 74/358 [00:07<00:29,  9.64it/s] 21%|██        | 75/358 [00:07<00:29,  9.61it/s] 21%|██        | 76/358 [00:07<00:29,  9.71it/s] 22%|██▏       | 77/358 [00:07<00:29,  9.67it/s] 22%|██▏       | 79/358 [00:08<00:28,  9.68it/s] 23%|██▎       | 81/358 [00:08<00:28,  9.73it/s] 23%|██▎       | 83/358 [00:08<00:28,  9.75it/s] 23%|██▎       | 84/358 [00:08<00:28,  9.70it/s] 24%|██▎       | 85/358 [00:08<00:28,  9.66it/s] 24%|██▍       | 86/358 [00:08<00:28,  9.65it/s] 24%|██▍       | 87/358 [00:08<00:28,  9.63it/s] 25%|██▍       | 88/358 [00:09<00:27,  9.65it/s] 25%|██▌       | 90/358 [00:09<00:27,  9.88it/s] 26%|██▌       | 92/358 [00:09<00:26,  9.98it/s] 26%|██▌       | 93/358 [00:09<00:26,  9.95it/s] 26%|██▋       | 94/358 [00:09<00:26,  9.86it/s] 27%|██▋       | 96/358 [00:09<00:25, 10.14it/s] 27%|██▋       | 98/358 [00:10<00:25, 10.03it/s] 28%|██▊       | 99/358 [00:10<00:26,  9.94it/s] 28%|██▊       | 101/358 [00:10<00:25,  9.91it/s] 29%|██▉       | 103/358 [00:10<00:25,  9.90it/s] 29%|██▉       | 104/358 [00:10<00:25,  9.85it/s] 29%|██▉       | 105/358 [00:10<00:25,  9.77it/s] 30%|██▉       | 106/358 [00:10<00:25,  9.76it/s] 30%|██▉       | 107/358 [00:10<00:25,  9.81it/s] 30%|███       | 108/358 [00:11<00:25,  9.75it/s] 30%|███       | 109/358 [00:11<00:25,  9.65it/s] 31%|███       | 110/358 [00:11<00:25,  9.64it/s] 31%|███       | 111/358 [00:11<00:25,  9.60it/s] 32%|███▏      | 113/358 [00:11<00:24,  9.89it/s] 32%|███▏      | 114/358 [00:11<00:24,  9.85it/s] 32%|███▏      | 115/358 [00:11<00:24,  9.76it/s] 32%|███▏      | 116/358 [00:11<00:25,  9.67it/s] 33%|███▎      | 117/358 [00:11<00:24,  9.64it/s] 33%|███▎      | 119/358 [00:12<00:24,  9.76it/s] 34%|███▍      | 121/358 [00:12<00:23,  9.96it/s] 34%|███▍      | 123/358 [00:12<00:23, 10.06it/s] 35%|███▍      | 125/358 [00:12<00:23, 10.04it/s] 35%|███▌      | 126/358 [00:12<00:23, 10.00it/s] 35%|███▌      | 127/358 [00:12<00:23,  9.95it/s] 36%|███▌      | 128/358 [00:13<00:23,  9.91it/s] 36%|███▋      | 130/358 [00:13<00:22,  9.97it/s] 37%|███▋      | 131/358 [00:13<00:23,  9.85it/s] 37%|███▋      | 132/358 [00:13<00:22,  9.87it/s] 37%|███▋      | 134/358 [00:13<00:22,  9.90it/s] 38%|███▊      | 135/358 [00:13<00:22,  9.84it/s] 38%|███▊      | 137/358 [00:13<00:22,  9.94it/s] 39%|███▊      | 138/358 [00:14<00:22,  9.92it/s] 39%|███▉      | 139/358 [00:14<00:22,  9.83it/s] 39%|███▉      | 141/358 [00:14<00:21,  9.96it/s] 40%|███▉      | 142/358 [00:14<00:21,  9.88it/s] 40%|███▉      | 143/358 [00:14<00:21,  9.85it/s] 40%|████      | 144/358 [00:14<00:21,  9.77it/s] 41%|████      | 145/358 [00:14<00:21,  9.79it/s] 41%|████      | 146/358 [00:14<00:21,  9.73it/s] 41%|████      | 147/358 [00:15<00:21,  9.67it/s] 41%|████▏     | 148/358 [00:15<00:21,  9.70it/s] 42%|████▏     | 149/358 [00:15<00:21,  9.68it/s] 42%|████▏     | 150/358 [00:15<00:21,  9.64it/s] 42%|████▏     | 151/358 [00:15<00:22,  9.37it/s] 42%|████▏     | 152/358 [00:15<00:21,  9.42it/s] 43%|████▎     | 153/358 [00:15<00:21,  9.44it/s] 43%|████▎     | 154/358 [00:15<00:21,  9.53it/s] 43%|████▎     | 155/358 [00:15<00:21,  9.54it/s] 44%|████▎     | 156/358 [00:15<00:20,  9.66it/s] 44%|████▍     | 157/358 [00:16<00:20,  9.61it/s] 44%|████▍     | 158/358 [00:16<00:20,  9.69it/s] 44%|████▍     | 159/358 [00:16<00:20,  9.68it/s] 45%|████▍     | 160/358 [00:16<00:20,  9.69it/s] 45%|████▌     | 162/358 [00:16<00:19,  9.98it/s] 46%|████▌     | 164/358 [00:16<00:19,  9.98it/s] 46%|████▌     | 165/358 [00:16<00:19,  9.94it/s] 47%|████▋     | 167/358 [00:17<00:19,  9.89it/s] 47%|████▋     | 169/358 [00:17<00:19,  9.93it/s] 48%|████▊     | 171/358 [00:17<00:18,  9.91it/s] 48%|████▊     | 172/358 [00:17<00:18,  9.86it/s] 48%|████▊     | 173/358 [00:17<00:18,  9.80it/s] 49%|████▉     | 175/358 [00:17<00:18,  9.82it/s] 49%|████▉     | 176/358 [00:17<00:18,  9.83it/s] 49%|████▉     | 177/358 [00:18<00:18,  9.82it/s] 50%|█████     | 179/358 [00:18<00:18,  9.84it/s] 50%|█████     | 180/358 [00:18<00:18,  9.77it/s] 51%|█████     | 182/358 [00:18<00:17,  9.92it/s] 51%|█████     | 183/358 [00:18<00:17,  9.87it/s] 51%|█████▏    | 184/358 [00:18<00:17,  9.76it/s] 52%|█████▏    | 185/358 [00:18<00:17,  9.71it/s] 52%|█████▏    | 187/358 [00:19<00:17,  9.92it/s] 53%|█████▎    | 188/358 [00:19<00:17,  9.87it/s] 53%|█████▎    | 189/358 [00:19<00:17,  9.81it/s] 53%|█████▎    | 190/358 [00:19<00:17,  9.86it/s] 53%|█████▎    | 191/358 [00:19<00:17,  9.69it/s] 54%|█████▎    | 192/358 [00:19<00:17,  9.64it/s] 54%|█████▍    | 193/358 [00:19<00:17,  9.64it/s] 54%|█████▍    | 194/358 [00:19<00:17,  9.63it/s] 54%|█████▍    | 195/358 [00:19<00:16,  9.71it/s] 55%|█████▌    | 197/358 [00:20<00:16,  9.90it/s] 55%|█████▌    | 198/358 [00:20<00:16,  9.82it/s] 56%|█████▌    | 199/358 [00:20<00:16,  9.86it/s] 56%|█████▌    | 200/358 [00:20<00:16,  9.79it/s] 56%|█████▌    | 201/358 [00:20<00:16,  9.75it/s] 57%|█████▋    | 203/358 [00:20<00:15,  9.84it/s] 57%|█████▋    | 204/358 [00:20<00:15,  9.73it/s] 57%|█████▋    | 205/358 [00:20<00:15,  9.69it/s] 58%|█████▊    | 207/358 [00:21<00:15,  9.86it/s] 58%|█████▊    | 208/358 [00:21<00:15,  9.79it/s] 59%|█████▊    | 210/358 [00:21<00:15,  9.80it/s] 59%|█████▉    | 212/358 [00:21<00:14,  9.79it/s] 60%|█████▉    | 214/358 [00:21<00:14,  9.87it/s] 60%|██████    | 215/358 [00:21<00:14,  9.80it/s] 60%|██████    | 216/358 [00:22<00:14,  9.74it/s] 61%|██████    | 217/358 [00:22<00:14,  9.78it/s] 61%|██████    | 218/358 [00:22<00:14,  9.75it/s] 61%|██████    | 219/358 [00:22<00:14,  9.76it/s] 62%|██████▏   | 221/358 [00:22<00:13,  9.89it/s] 62%|██████▏   | 222/358 [00:22<00:13,  9.79it/s] 62%|██████▏   | 223/358 [00:22<00:13,  9.73it/s] 63%|██████▎   | 224/358 [00:22<00:13,  9.67it/s] 63%|██████▎   | 225/358 [00:22<00:13,  9.76it/s] 63%|██████▎   | 226/358 [00:23<00:13,  9.71it/s] 64%|██████▎   | 228/358 [00:23<00:13,  9.74it/s] 64%|██████▍   | 229/358 [00:23<00:13,  9.72it/s] 64%|██████▍   | 230/358 [00:23<00:13,  9.66it/s] 65%|██████▍   | 232/358 [00:23<00:12,  9.72it/s] 65%|██████▌   | 234/358 [00:23<00:12, 10.01it/s] 66%|██████▌   | 236/358 [00:24<00:12,  9.97it/s] 66%|██████▋   | 238/358 [00:24<00:11, 10.02it/s] 67%|██████▋   | 240/358 [00:24<00:11,  9.98it/s] 68%|██████▊   | 242/358 [00:24<00:11,  9.96it/s] 68%|██████▊   | 243/358 [00:24<00:11,  9.90it/s] 68%|██████▊   | 244/358 [00:24<00:11,  9.83it/s] 69%|██████▊   | 246/358 [00:25<00:11,  9.85it/s] 69%|██████▉   | 247/358 [00:25<00:11,  9.78it/s] 69%|██████▉   | 248/358 [00:25<00:11,  9.74it/s] 70%|██████▉   | 250/358 [00:25<00:10,  9.83it/s] 70%|███████   | 251/358 [00:25<00:10,  9.77it/s] 70%|███████   | 252/358 [00:25<00:10,  9.71it/s] 71%|███████   | 253/358 [00:25<00:10,  9.67it/s] 71%|███████   | 254/358 [00:25<00:10,  9.64it/s] 72%|███████▏  | 256/358 [00:26<00:10,  9.81it/s] 72%|███████▏  | 257/358 [00:26<00:10,  9.82it/s] 72%|███████▏  | 258/358 [00:26<00:10,  9.69it/s] 72%|███████▏  | 259/358 [00:26<00:10,  9.66it/s] 73%|███████▎  | 260/358 [00:26<00:10,  9.70it/s] 73%|███████▎  | 262/358 [00:26<00:09,  9.88it/s] 74%|███████▎  | 264/358 [00:26<00:09,  9.90it/s] 74%|███████▍  | 266/358 [00:27<00:09,  9.89it/s] 75%|███████▍  | 267/358 [00:27<00:09,  9.83it/s] 75%|███████▌  | 269/358 [00:27<00:09,  9.89it/s] 75%|███████▌  | 270/358 [00:27<00:08,  9.82it/s] 76%|███████▌  | 271/358 [00:27<00:08,  9.74it/s] 76%|███████▌  | 272/358 [00:27<00:08,  9.72it/s] 76%|███████▋  | 273/358 [00:27<00:08,  9.62it/s] 77%|███████▋  | 274/358 [00:27<00:08,  9.61it/s] 77%|███████▋  | 275/358 [00:28<00:08,  9.66it/s] 77%|███████▋  | 276/358 [00:28<00:08,  9.66it/s] 77%|███████▋  | 277/358 [00:28<00:08,  9.63it/s] 78%|███████▊  | 278/358 [00:28<00:08,  9.61it/s] 78%|███████▊  | 280/358 [00:28<00:07,  9.80it/s] 78%|███████▊  | 281/358 [00:28<00:07,  9.81it/s] 79%|███████▉  | 282/358 [00:28<00:07,  9.76it/s] 79%|███████▉  | 283/358 [00:28<00:07,  9.69it/s] 79%|███████▉  | 284/358 [00:29<00:07,  9.65it/s] 80%|███████▉  | 285/358 [00:29<00:07,  9.72it/s] 80%|███████▉  | 286/358 [00:29<00:07,  9.68it/s] 80%|████████  | 287/358 [00:29<00:07,  9.66it/s] 80%|████████  | 288/358 [00:29<00:07,  9.61it/s] 81%|████████  | 290/358 [00:29<00:06,  9.83it/s] 81%|████████▏ | 291/358 [00:29<00:06,  9.81it/s] 82%|████████▏ | 293/358 [00:29<00:06,  9.82it/s] 82%|████████▏ | 295/358 [00:30<00:06,  9.89it/s] 83%|████████▎ | 296/358 [00:30<00:06,  9.83it/s] 83%|████████▎ | 297/358 [00:30<00:06,  9.72it/s] 84%|████████▎ | 299/358 [00:30<00:05,  9.88it/s] 84%|████████▍ | 301/358 [00:30<00:05,  9.92it/s] 84%|████████▍ | 302/358 [00:30<00:05,  9.85it/s] 85%|████████▍ | 303/358 [00:30<00:05,  9.86it/s] 85%|████████▌ | 305/358 [00:31<00:05,  9.89it/s] 85%|████████▌ | 306/358 [00:31<00:05,  9.81it/s] 86%|████████▌ | 308/358 [00:31<00:05,  9.91it/s] 86%|████████▋ | 309/358 [00:31<00:04,  9.81it/s] 87%|████████▋ | 310/358 [00:31<00:04,  9.75it/s] 87%|████████▋ | 311/358 [00:31<00:04,  9.68it/s] 87%|████████▋ | 312/358 [00:31<00:04,  9.69it/s] 87%|████████▋ | 313/358 [00:31<00:04,  9.71it/s] 88%|████████▊ | 315/358 [00:32<00:04,  9.96it/s] 88%|████████▊ | 316/358 [00:32<00:04,  9.91it/s] 89%|████████▊ | 317/358 [00:32<00:04,  9.83it/s] 89%|████████▉ | 318/358 [00:32<00:04,  9.79it/s] 89%|████████▉ | 319/358 [00:32<00:04,  9.74it/s] 89%|████████▉ | 320/358 [00:32<00:03,  9.80it/s] 90%|████████▉ | 321/358 [00:32<00:03,  9.73it/s] 90%|████████▉ | 322/358 [00:32<00:03,  9.70it/s] 90%|█████████ | 323/358 [00:32<00:03,  9.65it/s] 91%|█████████ | 324/358 [00:33<00:03,  9.61it/s] 91%|█████████ | 325/358 [00:33<00:03,  9.59it/s] 91%|█████████▏| 327/358 [00:33<00:03,  9.95it/s] 92%|█████████▏| 329/358 [00:33<00:02, 10.05it/s] 92%|█████████▏| 330/358 [00:33<00:02,  9.94it/s] 93%|█████████▎| 332/358 [00:33<00:02, 10.04it/s] 93%|█████████▎| 334/358 [00:34<00:02,  9.95it/s] 94%|█████████▎| 335/358 [00:34<00:02,  9.83it/s] 94%|█████████▍| 337/358 [00:34<00:02,  9.90it/s] 95%|█████████▍| 339/358 [00:34<00:01, 10.10it/s] 95%|█████████▌| 341/358 [00:34<00:01, 10.04it/s] 96%|█████████▌| 343/358 [00:35<00:01,  9.88it/s] 96%|█████████▌| 344/358 [00:35<00:01,  9.82it/s] 96%|█████████▋| 345/358 [00:35<00:01,  9.84it/s] 97%|█████████▋| 346/358 [00:35<00:01,  9.88it/s] 97%|█████████▋| 348/358 [00:35<00:01,  9.96it/s] 97%|█████████▋| 349/358 [00:35<00:00,  9.88it/s] 98%|█████████▊| 350/358 [00:35<00:00,  9.80it/s] 98%|█████████▊| 351/358 [00:35<00:00,  9.75it/s] 99%|█████████▊| 353/358 [00:36<00:00,  9.91it/s] 99%|█████████▉| 354/358 [00:36<00:00,  9.89it/s] 99%|█████████▉| 355/358 [00:36<00:00,  9.80it/s]100%|█████████▉| 357/358 [00:36<00:00,  9.86it/s]100%|██████████| 358/358 [00:36<00:00,  9.81it/s]
[32m2025-02-05 05:56:50.962[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    gen_loss  grad clip ratio  grad norm   ppl
       1.973                1      2.751 7.194[0m
[32m2025-02-05 05:56:50.963[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m169[0m - [1m[Valid][0m
  0%|          | 0/10256 [00:00<?, ?it/s]100%|██████████| 10256/10256 [00:00<00:00, 1001601.51it/s]
[32m2025-02-05 05:56:50.973[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:27,  1.43it/s]  5%|▌         | 2/40 [00:01<00:26,  1.44it/s]  8%|▊         | 3/40 [00:02<00:25,  1.45it/s] 10%|█         | 4/40 [00:02<00:24,  1.45it/s] 12%|█▎        | 5/40 [00:03<00:24,  1.44it/s] 15%|█▌        | 6/40 [00:04<00:23,  1.44it/s] 18%|█▊        | 7/40 [00:04<00:22,  1.44it/s] 20%|██        | 8/40 [00:05<00:22,  1.45it/s] 22%|██▎       | 9/40 [00:06<00:21,  1.45it/s] 25%|██▌       | 10/40 [00:06<00:20,  1.45it/s] 28%|██▊       | 11/40 [00:07<00:19,  1.45it/s] 30%|███       | 12/40 [00:08<00:19,  1.45it/s] 32%|███▎      | 13/40 [00:08<00:18,  1.45it/s] 35%|███▌      | 14/40 [00:09<00:18,  1.44it/s] 38%|███▊      | 15/40 [00:10<00:17,  1.45it/s] 40%|████      | 16/40 [00:11<00:16,  1.44it/s] 42%|████▎     | 17/40 [00:11<00:15,  1.45it/s] 45%|████▌     | 18/40 [00:12<00:15,  1.45it/s] 48%|████▊     | 19/40 [00:13<00:14,  1.45it/s] 50%|█████     | 20/40 [00:13<00:13,  1.46it/s] 52%|█████▎    | 21/40 [00:14<00:13,  1.46it/s] 55%|█████▌    | 22/40 [00:15<00:12,  1.45it/s] 57%|█████▊    | 23/40 [00:15<00:11,  1.45it/s] 60%|██████    | 24/40 [00:16<00:11,  1.45it/s] 62%|██████▎   | 25/40 [00:17<00:10,  1.45it/s] 65%|██████▌   | 26/40 [00:17<00:09,  1.46it/s] 68%|██████▊   | 27/40 [00:18<00:08,  1.46it/s] 70%|███████   | 28/40 [00:19<00:08,  1.45it/s] 72%|███████▎  | 29/40 [00:19<00:07,  1.45it/s] 75%|███████▌  | 30/40 [00:20<00:06,  1.46it/s] 78%|███████▊  | 31/40 [00:21<00:06,  1.45it/s] 80%|████████  | 32/40 [00:22<00:05,  1.46it/s] 82%|████████▎ | 33/40 [00:22<00:04,  1.45it/s] 85%|████████▌ | 34/40 [00:23<00:04,  1.45it/s] 88%|████████▊ | 35/40 [00:24<00:03,  1.45it/s] 90%|█████████ | 36/40 [00:24<00:02,  1.45it/s] 92%|█████████▎| 37/40 [00:25<00:02,  1.45it/s] 95%|█████████▌| 38/40 [00:26<00:01,  1.44it/s] 98%|█████████▊| 39/40 [00:26<00:00,  1.44it/s]100%|██████████| 40/40 [00:27<00:00,  1.59it/s]100%|██████████| 40/40 [00:27<00:00,  1.46it/s]
[32m2025-02-05 05:57:18.360[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    average  bleu@1  bleu@2  bleu@3  bleu@4  dist@1  dist@2  dist@3  dist@4  extreme  \
      .7827   .3006   .1111  .04288  .02134  .04402   .2941   .5811   .7508    .5987   
      f1  gen_loss  greedy  intra_dist@1  intra_dist@2  intra_dist@3  intra_dist@4  \
   .3539     4.922   .6717         .8678         .9663         .9556         .9230   
     ppl  rouge1  rouge2  rougeL  
   137.2   .3874  .09032   .3746[0m
[32m2025-02-05 05:57:18.367[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m163[0m - [1m[Conversation epoch 46][0m
[32m2025-02-05 05:57:18.367[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m164[0m - [1m[Train][0m
  0%|          | 0/92414 [00:00<?, ?it/s]100%|██████████| 92414/92414 [00:00<00:00, 1001466.00it/s]
[32m2025-02-05 05:57:18.460[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/358 [00:00<?, ?it/s]  0%|          | 1/358 [00:00<00:36,  9.73it/s]  1%|          | 3/358 [00:00<00:35,  9.91it/s]  1%|          | 4/358 [00:00<00:35,  9.89it/s]  2%|▏         | 6/358 [00:00<00:35,  9.85it/s]  2%|▏         | 7/358 [00:00<00:35,  9.79it/s]  2%|▏         | 8/358 [00:00<00:35,  9.84it/s]  3%|▎         | 9/358 [00:00<00:35,  9.74it/s]  3%|▎         | 10/358 [00:01<00:35,  9.73it/s]  3%|▎         | 11/358 [00:01<00:35,  9.68it/s]  4%|▎         | 13/358 [00:01<00:34,  9.90it/s]  4%|▍         | 14/358 [00:01<00:34,  9.83it/s]  4%|▍         | 15/358 [00:01<00:35,  9.75it/s]  4%|▍         | 16/358 [00:01<00:35,  9.69it/s]  5%|▍         | 17/358 [00:01<00:35,  9.71it/s]  5%|▌         | 18/358 [00:01<00:34,  9.78it/s]  5%|▌         | 19/358 [00:01<00:34,  9.72it/s]  6%|▌         | 20/358 [00:02<00:34,  9.66it/s]  6%|▌         | 21/358 [00:02<00:35,  9.59it/s]  6%|▌         | 22/358 [00:02<00:34,  9.66it/s]  7%|▋         | 24/358 [00:02<00:34,  9.75it/s]  7%|▋         | 25/358 [00:02<00:34,  9.70it/s]  7%|▋         | 26/358 [00:02<00:34,  9.65it/s]  8%|▊         | 27/358 [00:02<00:34,  9.71it/s]  8%|▊         | 28/358 [00:02<00:34,  9.67it/s]  8%|▊         | 29/358 [00:02<00:34,  9.63it/s]  9%|▊         | 31/358 [00:03<00:33,  9.73it/s]  9%|▉         | 32/358 [00:03<00:33,  9.73it/s]  9%|▉         | 34/358 [00:03<00:32,  9.83it/s] 10%|█         | 36/358 [00:03<00:32,  9.83it/s] 10%|█         | 37/358 [00:03<00:32,  9.81it/s] 11%|█         | 38/358 [00:03<00:32,  9.76it/s] 11%|█         | 40/358 [00:04<00:32,  9.92it/s] 11%|█▏        | 41/358 [00:04<00:32,  9.83it/s] 12%|█▏        | 43/358 [00:04<00:31,  9.86it/s] 13%|█▎        | 45/358 [00:04<00:31,  9.97it/s] 13%|█▎        | 47/358 [00:04<00:31,  9.94it/s] 13%|█▎        | 48/358 [00:04<00:31,  9.93it/s] 14%|█▍        | 50/358 [00:05<00:31,  9.90it/s] 14%|█▍        | 51/358 [00:05<00:31,  9.83it/s] 15%|█▍        | 52/358 [00:05<00:31,  9.74it/s] 15%|█▍        | 53/358 [00:05<00:31,  9.69it/s] 15%|█▌        | 54/358 [00:05<00:31,  9.73it/s] 15%|█▌        | 55/358 [00:05<00:31,  9.67it/s] 16%|█▌        | 56/358 [00:05<00:31,  9.72it/s] 16%|█▌        | 57/358 [00:05<00:31,  9.68it/s] 16%|█▌        | 58/358 [00:05<00:31,  9.66it/s] 16%|█▋        | 59/358 [00:06<00:31,  9.62it/s] 17%|█▋        | 61/358 [00:06<00:30,  9.71it/s] 17%|█▋        | 62/358 [00:06<00:30,  9.63it/s] 18%|█▊        | 63/358 [00:06<00:30,  9.68it/s] 18%|█▊        | 64/358 [00:06<00:30,  9.64it/s] 18%|█▊        | 66/358 [00:06<00:30,  9.71it/s] 19%|█▊        | 67/358 [00:06<00:30,  9.70it/s] 19%|█▉        | 69/358 [00:07<00:29,  9.76it/s] 20%|█▉        | 70/358 [00:07<00:29,  9.71it/s] 20%|█▉        | 71/358 [00:07<00:29,  9.75it/s] 20%|██        | 72/358 [00:07<00:29,  9.70it/s] 20%|██        | 73/358 [00:07<00:29,  9.67it/s] 21%|██        | 74/358 [00:07<00:29,  9.63it/s] 21%|██        | 75/358 [00:07<00:29,  9.60it/s] 21%|██        | 76/358 [00:07<00:29,  9.70it/s] 22%|██▏       | 77/358 [00:07<00:29,  9.67it/s] 22%|██▏       | 79/358 [00:08<00:28,  9.68it/s] 23%|██▎       | 81/358 [00:08<00:28,  9.74it/s] 23%|██▎       | 83/358 [00:08<00:28,  9.76it/s] 23%|██▎       | 84/358 [00:08<00:28,  9.72it/s] 24%|██▎       | 85/358 [00:08<00:28,  9.67it/s] 24%|██▍       | 86/358 [00:08<00:28,  9.66it/s] 24%|██▍       | 87/358 [00:08<00:28,  9.64it/s] 25%|██▍       | 88/358 [00:09<00:27,  9.66it/s] 25%|██▌       | 90/358 [00:09<00:27,  9.89it/s] 26%|██▌       | 92/358 [00:09<00:26,  9.99it/s] 26%|██▌       | 93/358 [00:09<00:26,  9.95it/s] 26%|██▋       | 94/358 [00:09<00:26,  9.87it/s] 27%|██▋       | 96/358 [00:09<00:25, 10.14it/s] 27%|██▋       | 98/358 [00:10<00:25, 10.04it/s] 28%|██▊       | 99/358 [00:10<00:26,  9.94it/s] 28%|██▊       | 101/358 [00:10<00:25,  9.91it/s] 29%|██▉       | 103/358 [00:10<00:25,  9.90it/s] 29%|██▉       | 104/358 [00:10<00:25,  9.86it/s] 29%|██▉       | 105/358 [00:10<00:25,  9.78it/s] 30%|██▉       | 106/358 [00:10<00:25,  9.76it/s] 30%|███       | 108/358 [00:11<00:25,  9.79it/s] 30%|███       | 109/358 [00:11<00:25,  9.70it/s] 31%|███       | 110/358 [00:11<00:25,  9.68it/s] 31%|███       | 111/358 [00:11<00:25,  9.64it/s] 32%|███▏      | 113/358 [00:11<00:24,  9.90it/s] 32%|███▏      | 114/358 [00:11<00:24,  9.86it/s] 32%|███▏      | 115/358 [00:11<00:24,  9.76it/s] 32%|███▏      | 116/358 [00:11<00:25,  9.68it/s] 33%|███▎      | 117/358 [00:11<00:24,  9.65it/s] 33%|███▎      | 119/358 [00:12<00:24,  9.77it/s] 34%|███▍      | 121/358 [00:12<00:23,  9.97it/s] 34%|███▍      | 123/358 [00:12<00:23, 10.07it/s] 35%|███▍      | 125/358 [00:12<00:23, 10.05it/s] 35%|███▌      | 126/358 [00:12<00:23, 10.01it/s] 35%|███▌      | 127/358 [00:12<00:23,  9.95it/s] 36%|███▌      | 128/358 [00:13<00:23,  9.91it/s] 36%|███▋      | 130/358 [00:13<00:22,  9.97it/s] 37%|███▋      | 131/358 [00:13<00:22,  9.87it/s] 37%|███▋      | 132/358 [00:13<00:22,  9.90it/s] 37%|███▋      | 134/358 [00:13<00:22,  9.92it/s] 38%|███▊      | 135/358 [00:13<00:22,  9.86it/s] 38%|███▊      | 137/358 [00:13<00:22,  9.95it/s] 39%|███▊      | 138/358 [00:14<00:22,  9.93it/s] 39%|███▉      | 139/358 [00:14<00:22,  9.84it/s] 39%|███▉      | 141/358 [00:14<00:21,  9.96it/s] 40%|███▉      | 142/358 [00:14<00:21,  9.88it/s] 40%|███▉      | 143/358 [00:14<00:21,  9.85it/s] 40%|████      | 144/358 [00:14<00:21,  9.77it/s] 41%|████      | 145/358 [00:14<00:21,  9.79it/s] 41%|████      | 146/358 [00:14<00:21,  9.73it/s] 41%|████      | 147/358 [00:15<00:21,  9.67it/s] 41%|████▏     | 148/358 [00:15<00:21,  9.69it/s] 42%|████▏     | 149/358 [00:15<00:21,  9.68it/s] 42%|████▏     | 150/358 [00:15<00:21,  9.64it/s] 42%|████▏     | 151/358 [00:15<00:22,  9.37it/s] 42%|████▏     | 152/358 [00:15<00:21,  9.42it/s] 43%|████▎     | 153/358 [00:15<00:21,  9.44it/s] 43%|████▎     | 154/358 [00:15<00:21,  9.53it/s] 43%|████▎     | 155/358 [00:15<00:21,  9.54it/s] 44%|████▎     | 156/358 [00:15<00:20,  9.66it/s] 44%|████▍     | 157/358 [00:16<00:20,  9.60it/s] 44%|████▍     | 158/358 [00:16<00:20,  9.69it/s] 44%|████▍     | 159/358 [00:16<00:20,  9.69it/s] 45%|████▍     | 160/358 [00:16<00:20,  9.69it/s] 45%|████▌     | 162/358 [00:16<00:19,  9.99it/s] 46%|████▌     | 164/358 [00:16<00:19,  9.99it/s] 46%|████▌     | 165/358 [00:16<00:19,  9.95it/s] 47%|████▋     | 167/358 [00:17<00:19,  9.90it/s] 47%|████▋     | 169/358 [00:17<00:19,  9.94it/s] 48%|████▊     | 171/358 [00:17<00:18,  9.92it/s] 48%|████▊     | 172/358 [00:17<00:18,  9.87it/s] 48%|████▊     | 173/358 [00:17<00:18,  9.80it/s] 49%|████▉     | 175/358 [00:17<00:18,  9.83it/s] 49%|████▉     | 176/358 [00:17<00:18,  9.84it/s] 49%|████▉     | 177/358 [00:18<00:18,  9.83it/s] 50%|█████     | 179/358 [00:18<00:18,  9.85it/s] 50%|█████     | 180/358 [00:18<00:18,  9.78it/s] 51%|█████     | 182/358 [00:18<00:17,  9.93it/s] 51%|█████     | 183/358 [00:18<00:17,  9.88it/s] 51%|█████▏    | 184/358 [00:18<00:17,  9.77it/s] 52%|█████▏    | 185/358 [00:18<00:17,  9.72it/s] 52%|█████▏    | 187/358 [00:19<00:17,  9.93it/s] 53%|█████▎    | 188/358 [00:19<00:17,  9.88it/s] 53%|█████▎    | 189/358 [00:19<00:17,  9.82it/s] 53%|█████▎    | 191/358 [00:19<00:17,  9.74it/s] 54%|█████▎    | 192/358 [00:19<00:17,  9.69it/s] 54%|█████▍    | 193/358 [00:19<00:17,  9.68it/s] 54%|█████▍    | 194/358 [00:19<00:16,  9.66it/s] 54%|█████▍    | 195/358 [00:19<00:16,  9.73it/s] 55%|█████▌    | 197/358 [00:20<00:16,  9.91it/s] 55%|█████▌    | 198/358 [00:20<00:16,  9.83it/s] 56%|█████▌    | 199/358 [00:20<00:16,  9.86it/s] 56%|█████▌    | 200/358 [00:20<00:16,  9.80it/s] 56%|█████▌    | 201/358 [00:20<00:16,  9.75it/s] 57%|█████▋    | 203/358 [00:20<00:15,  9.84it/s] 57%|█████▋    | 204/358 [00:20<00:15,  9.74it/s] 57%|█████▋    | 205/358 [00:20<00:15,  9.70it/s] 58%|█████▊    | 207/358 [00:21<00:15,  9.86it/s] 58%|█████▊    | 208/358 [00:21<00:15,  9.79it/s] 59%|█████▊    | 210/358 [00:21<00:15,  9.81it/s] 59%|█████▉    | 212/358 [00:21<00:14,  9.81it/s] 60%|█████▉    | 214/358 [00:21<00:14,  9.88it/s] 60%|██████    | 215/358 [00:21<00:14,  9.82it/s] 60%|██████    | 216/358 [00:22<00:14,  9.76it/s] 61%|██████    | 217/358 [00:22<00:14,  9.79it/s] 61%|██████    | 218/358 [00:22<00:14,  9.76it/s] 61%|██████    | 219/358 [00:22<00:14,  9.76it/s] 62%|██████▏   | 221/358 [00:22<00:13,  9.90it/s] 62%|██████▏   | 222/358 [00:22<00:13,  9.79it/s] 62%|██████▏   | 223/358 [00:22<00:13,  9.73it/s] 63%|██████▎   | 224/358 [00:22<00:13,  9.68it/s] 63%|██████▎   | 225/358 [00:22<00:13,  9.76it/s] 63%|██████▎   | 226/358 [00:23<00:13,  9.71it/s] 64%|██████▎   | 228/358 [00:23<00:13,  9.75it/s] 64%|██████▍   | 229/358 [00:23<00:13,  9.72it/s] 64%|██████▍   | 230/358 [00:23<00:13,  9.67it/s] 65%|██████▍   | 232/358 [00:23<00:12,  9.72it/s] 65%|██████▌   | 234/358 [00:23<00:12, 10.02it/s] 66%|██████▌   | 236/358 [00:24<00:12,  9.97it/s] 66%|██████▋   | 238/358 [00:24<00:11, 10.03it/s] 67%|██████▋   | 240/358 [00:24<00:11,  9.98it/s] 68%|██████▊   | 242/358 [00:24<00:11,  9.96it/s] 68%|██████▊   | 243/358 [00:24<00:11,  9.90it/s] 68%|██████▊   | 244/358 [00:24<00:11,  9.83it/s] 69%|██████▊   | 246/358 [00:25<00:11,  9.86it/s] 69%|██████▉   | 247/358 [00:25<00:11,  9.79it/s] 69%|██████▉   | 248/358 [00:25<00:11,  9.75it/s] 70%|██████▉   | 250/358 [00:25<00:10,  9.84it/s] 70%|███████   | 251/358 [00:25<00:10,  9.78it/s] 70%|███████   | 252/358 [00:25<00:10,  9.72it/s] 71%|███████   | 253/358 [00:25<00:10,  9.68it/s] 71%|███████   | 254/358 [00:25<00:10,  9.65it/s] 72%|███████▏  | 256/358 [00:26<00:10,  9.83it/s] 72%|███████▏  | 257/358 [00:26<00:10,  9.83it/s] 72%|███████▏  | 258/358 [00:26<00:10,  9.70it/s] 72%|███████▏  | 259/358 [00:26<00:10,  9.67it/s] 73%|███████▎  | 260/358 [00:26<00:10,  9.71it/s] 73%|███████▎  | 262/358 [00:26<00:09,  9.88it/s] 74%|███████▎  | 264/358 [00:26<00:09,  9.91it/s] 74%|███████▍  | 266/358 [00:27<00:09,  9.89it/s] 75%|███████▍  | 267/358 [00:27<00:09,  9.83it/s] 75%|███████▌  | 269/358 [00:27<00:08,  9.89it/s] 75%|███████▌  | 270/358 [00:27<00:08,  9.82it/s] 76%|███████▌  | 271/358 [00:27<00:08,  9.74it/s] 76%|███████▌  | 272/358 [00:27<00:08,  9.72it/s] 76%|███████▋  | 273/358 [00:27<00:08,  9.62it/s] 77%|███████▋  | 274/358 [00:27<00:08,  9.62it/s] 77%|███████▋  | 275/358 [00:28<00:08,  9.67it/s] 77%|███████▋  | 276/358 [00:28<00:08,  9.67it/s] 77%|███████▋  | 277/358 [00:28<00:08,  9.64it/s] 78%|███████▊  | 278/358 [00:28<00:08,  9.62it/s] 78%|███████▊  | 280/358 [00:28<00:07,  9.81it/s] 78%|███████▊  | 281/358 [00:28<00:07,  9.82it/s] 79%|███████▉  | 282/358 [00:28<00:07,  9.76it/s] 79%|███████▉  | 283/358 [00:28<00:07,  9.70it/s] 79%|███████▉  | 284/358 [00:28<00:07,  9.67it/s] 80%|███████▉  | 285/358 [00:29<00:07,  9.73it/s] 80%|███████▉  | 286/358 [00:29<00:07,  9.69it/s] 80%|████████  | 287/358 [00:29<00:07,  9.66it/s] 80%|████████  | 288/358 [00:29<00:07,  9.62it/s] 81%|████████  | 289/358 [00:29<00:07,  9.73it/s] 81%|████████▏ | 291/358 [00:29<00:06,  9.83it/s] 82%|████████▏ | 293/358 [00:29<00:06,  9.84it/s] 82%|████████▏ | 295/358 [00:30<00:06,  9.90it/s] 83%|████████▎ | 296/358 [00:30<00:06,  9.84it/s] 83%|████████▎ | 297/358 [00:30<00:06,  9.73it/s] 84%|████████▎ | 299/358 [00:30<00:05,  9.89it/s] 84%|████████▍ | 301/358 [00:30<00:05,  9.93it/s] 84%|████████▍ | 302/358 [00:30<00:05,  9.86it/s] 85%|████████▍ | 303/358 [00:30<00:05,  9.87it/s] 85%|████████▌ | 305/358 [00:31<00:05,  9.90it/s] 85%|████████▌ | 306/358 [00:31<00:05,  9.82it/s] 86%|████████▌ | 308/358 [00:31<00:05,  9.92it/s] 86%|████████▋ | 309/358 [00:31<00:04,  9.82it/s] 87%|████████▋ | 310/358 [00:31<00:04,  9.76it/s] 87%|████████▋ | 311/358 [00:31<00:04,  9.69it/s] 87%|████████▋ | 312/358 [00:31<00:04,  9.70it/s] 87%|████████▋ | 313/358 [00:31<00:04,  9.72it/s] 88%|████████▊ | 315/358 [00:32<00:04,  9.98it/s] 88%|████████▊ | 316/358 [00:32<00:04,  9.93it/s] 89%|████████▊ | 317/358 [00:32<00:04,  9.84it/s] 89%|████████▉ | 318/358 [00:32<00:04,  9.79it/s] 89%|████████▉ | 319/358 [00:32<00:04,  9.74it/s] 89%|████████▉ | 320/358 [00:32<00:03,  9.81it/s] 90%|████████▉ | 321/358 [00:32<00:03,  9.73it/s] 90%|████████▉ | 322/358 [00:32<00:03,  9.70it/s] 90%|█████████ | 323/358 [00:32<00:03,  9.65it/s] 91%|█████████ | 324/358 [00:33<00:03,  9.62it/s] 91%|█████████ | 325/358 [00:33<00:03,  9.60it/s] 91%|█████████▏| 327/358 [00:33<00:03,  9.96it/s] 92%|█████████▏| 329/358 [00:33<00:02, 10.06it/s] 92%|█████████▏| 330/358 [00:33<00:02,  9.95it/s] 93%|█████████▎| 332/358 [00:33<00:02, 10.05it/s] 93%|█████████▎| 334/358 [00:34<00:02,  9.95it/s] 94%|█████████▎| 335/358 [00:34<00:02,  9.83it/s] 94%|█████████▍| 337/358 [00:34<00:02,  9.90it/s] 95%|█████████▍| 339/358 [00:34<00:01, 10.10it/s] 95%|█████████▌| 341/358 [00:34<00:01, 10.05it/s] 96%|█████████▌| 343/358 [00:34<00:01,  9.89it/s] 96%|█████████▌| 344/358 [00:35<00:01,  9.83it/s] 96%|█████████▋| 345/358 [00:35<00:01,  9.85it/s] 97%|█████████▋| 347/358 [00:35<00:01, 10.03it/s] 97%|█████████▋| 348/358 [00:35<00:01,  9.93it/s] 97%|█████████▋| 349/358 [00:35<00:00,  9.85it/s] 98%|█████████▊| 350/358 [00:35<00:00,  9.78it/s] 98%|█████████▊| 351/358 [00:35<00:00,  9.73it/s] 99%|█████████▊| 353/358 [00:35<00:00,  9.91it/s] 99%|█████████▉| 354/358 [00:36<00:00,  9.90it/s] 99%|█████████▉| 355/358 [00:36<00:00,  9.81it/s]100%|█████████▉| 357/358 [00:36<00:00,  9.86it/s]100%|██████████| 358/358 [00:36<00:00,  9.81it/s]
[32m2025-02-05 05:57:54.944[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    gen_loss  grad clip ratio  grad norm   ppl
        1.96                1      3.564 7.101[0m
[32m2025-02-05 05:57:54.944[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m169[0m - [1m[Valid][0m
  0%|          | 0/10256 [00:00<?, ?it/s]100%|██████████| 10256/10256 [00:00<00:00, 1024501.81it/s]
[32m2025-02-05 05:57:54.955[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:27,  1.42it/s]  5%|▌         | 2/40 [00:01<00:26,  1.44it/s]  8%|▊         | 3/40 [00:02<00:25,  1.44it/s] 10%|█         | 4/40 [00:02<00:24,  1.44it/s] 12%|█▎        | 5/40 [00:03<00:24,  1.44it/s] 15%|█▌        | 6/40 [00:04<00:23,  1.44it/s] 18%|█▊        | 7/40 [00:04<00:22,  1.44it/s] 20%|██        | 8/40 [00:05<00:22,  1.45it/s] 22%|██▎       | 9/40 [00:06<00:21,  1.45it/s] 25%|██▌       | 10/40 [00:06<00:20,  1.45it/s] 28%|██▊       | 11/40 [00:07<00:20,  1.45it/s] 30%|███       | 12/40 [00:08<00:19,  1.45it/s] 32%|███▎      | 13/40 [00:09<00:18,  1.45it/s] 35%|███▌      | 14/40 [00:09<00:18,  1.44it/s] 38%|███▊      | 15/40 [00:10<00:17,  1.44it/s] 40%|████      | 16/40 [00:11<00:16,  1.44it/s] 42%|████▎     | 17/40 [00:11<00:15,  1.45it/s] 45%|████▌     | 18/40 [00:12<00:15,  1.45it/s] 48%|████▊     | 19/40 [00:13<00:14,  1.45it/s] 50%|█████     | 20/40 [00:13<00:13,  1.45it/s] 52%|█████▎    | 21/40 [00:14<00:13,  1.46it/s] 55%|█████▌    | 22/40 [00:15<00:12,  1.45it/s] 57%|█████▊    | 23/40 [00:15<00:11,  1.45it/s] 60%|██████    | 24/40 [00:16<00:11,  1.44it/s] 62%|██████▎   | 25/40 [00:17<00:10,  1.44it/s] 65%|██████▌   | 26/40 [00:17<00:09,  1.45it/s] 68%|██████▊   | 27/40 [00:18<00:08,  1.45it/s] 70%|███████   | 28/40 [00:19<00:08,  1.45it/s] 72%|███████▎  | 29/40 [00:20<00:07,  1.45it/s] 75%|███████▌  | 30/40 [00:20<00:06,  1.46it/s] 78%|███████▊  | 31/40 [00:21<00:06,  1.45it/s] 80%|████████  | 32/40 [00:22<00:05,  1.45it/s] 82%|████████▎ | 33/40 [00:22<00:04,  1.45it/s] 85%|████████▌ | 34/40 [00:23<00:04,  1.45it/s] 88%|████████▊ | 35/40 [00:24<00:03,  1.44it/s] 90%|█████████ | 36/40 [00:24<00:02,  1.44it/s] 92%|█████████▎| 37/40 [00:25<00:02,  1.45it/s] 95%|█████████▌| 38/40 [00:26<00:01,  1.44it/s] 98%|█████████▊| 39/40 [00:26<00:00,  1.44it/s]100%|██████████| 40/40 [00:27<00:00,  1.59it/s]100%|██████████| 40/40 [00:27<00:00,  1.46it/s]
[32m2025-02-05 05:58:22.415[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    average  bleu@1  bleu@2  bleu@3  bleu@4  dist@1  dist@2  dist@3  dist@4  extreme  \
      .7773   .2985   .1092  .04279  .02035  .04459   .2996   .5774   .7566    .5978   
      f1  gen_loss  greedy  intra_dist@1  intra_dist@2  intra_dist@3  intra_dist@4  \
   .3522      4.91   .6672         .8657         .9646         .9527         .9170   
     ppl  rouge1  rouge2  rougeL  
   135.7   .3868  .08923   .3740[0m
[32m2025-02-05 05:58:22.422[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m163[0m - [1m[Conversation epoch 47][0m
[32m2025-02-05 05:58:22.422[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m164[0m - [1m[Train][0m
  0%|          | 0/92414 [00:00<?, ?it/s]100%|██████████| 92414/92414 [00:00<00:00, 998813.14it/s]
[32m2025-02-05 05:58:22.515[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/358 [00:00<?, ?it/s]  0%|          | 1/358 [00:00<00:36,  9.73it/s]  1%|          | 3/358 [00:00<00:35,  9.91it/s]  1%|          | 4/358 [00:00<00:35,  9.89it/s]  2%|▏         | 6/358 [00:00<00:35,  9.86it/s]  2%|▏         | 7/358 [00:00<00:35,  9.80it/s]  2%|▏         | 8/358 [00:00<00:35,  9.84it/s]  3%|▎         | 9/358 [00:00<00:35,  9.75it/s]  3%|▎         | 10/358 [00:01<00:35,  9.73it/s]  3%|▎         | 11/358 [00:01<00:35,  9.68it/s]  4%|▎         | 13/358 [00:01<00:34,  9.90it/s]  4%|▍         | 14/358 [00:01<00:34,  9.83it/s]  4%|▍         | 15/358 [00:01<00:35,  9.75it/s]  4%|▍         | 16/358 [00:01<00:35,  9.69it/s]  5%|▍         | 17/358 [00:01<00:35,  9.71it/s]  5%|▌         | 18/358 [00:01<00:34,  9.79it/s]  5%|▌         | 19/358 [00:01<00:34,  9.72it/s]  6%|▌         | 20/358 [00:02<00:34,  9.66it/s]  6%|▌         | 21/358 [00:02<00:35,  9.59it/s]  6%|▌         | 22/358 [00:02<00:34,  9.66it/s]  7%|▋         | 24/358 [00:02<00:34,  9.76it/s]  7%|▋         | 25/358 [00:02<00:34,  9.71it/s]  7%|▋         | 26/358 [00:02<00:34,  9.66it/s]  8%|▊         | 27/358 [00:02<00:34,  9.72it/s]  8%|▊         | 28/358 [00:02<00:34,  9.67it/s]  8%|▊         | 29/358 [00:02<00:34,  9.64it/s]  9%|▊         | 31/358 [00:03<00:33,  9.74it/s]  9%|▉         | 32/358 [00:03<00:33,  9.74it/s]  9%|▉         | 34/358 [00:03<00:32,  9.84it/s] 10%|█         | 36/358 [00:03<00:32,  9.84it/s] 10%|█         | 37/358 [00:03<00:32,  9.82it/s] 11%|█         | 38/358 [00:03<00:32,  9.78it/s] 11%|█         | 40/358 [00:04<00:32,  9.94it/s] 11%|█▏        | 41/358 [00:04<00:32,  9.85it/s] 12%|█▏        | 43/358 [00:04<00:31,  9.86it/s] 13%|█▎        | 45/358 [00:04<00:31,  9.96it/s] 13%|█▎        | 46/358 [00:04<00:31,  9.97it/s] 13%|█▎        | 47/358 [00:04<00:31,  9.92it/s] 13%|█▎        | 48/358 [00:04<00:31,  9.91it/s] 14%|█▍        | 50/358 [00:05<00:31,  9.89it/s] 14%|█▍        | 51/358 [00:05<00:31,  9.82it/s] 15%|█▍        | 52/358 [00:05<00:31,  9.73it/s] 15%|█▍        | 53/358 [00:05<00:31,  9.67it/s] 15%|█▌        | 54/358 [00:05<00:31,  9.72it/s] 15%|█▌        | 55/358 [00:05<00:31,  9.68it/s] 16%|█▌        | 56/358 [00:05<00:31,  9.72it/s] 16%|█▌        | 57/358 [00:05<00:31,  9.68it/s] 16%|█▌        | 58/358 [00:05<00:31,  9.66it/s] 16%|█▋        | 59/358 [00:06<00:31,  9.63it/s] 17%|█▋        | 61/358 [00:06<00:30,  9.72it/s] 17%|█▋        | 62/358 [00:06<00:30,  9.64it/s] 18%|█▊        | 63/358 [00:06<00:30,  9.70it/s] 18%|█▊        | 64/358 [00:06<00:30,  9.66it/s] 18%|█▊        | 66/358 [00:06<00:30,  9.72it/s] 19%|█▊        | 67/358 [00:06<00:29,  9.71it/s] 19%|█▉        | 69/358 [00:07<00:29,  9.77it/s] 20%|█▉        | 70/358 [00:07<00:29,  9.72it/s] 20%|█▉        | 71/358 [00:07<00:29,  9.76it/s] 20%|██        | 72/358 [00:07<00:29,  9.71it/s] 20%|██        | 73/358 [00:07<00:29,  9.68it/s] 21%|██        | 74/358 [00:07<00:29,  9.64it/s] 21%|██        | 75/358 [00:07<00:29,  9.61it/s] 21%|██        | 76/358 [00:07<00:29,  9.72it/s] 22%|██▏       | 77/358 [00:07<00:29,  9.68it/s] 22%|██▏       | 79/358 [00:08<00:28,  9.69it/s] 23%|██▎       | 81/358 [00:08<00:28,  9.75it/s] 23%|██▎       | 83/358 [00:08<00:28,  9.77it/s] 23%|██▎       | 84/358 [00:08<00:28,  9.72it/s] 24%|██▎       | 85/358 [00:08<00:28,  9.68it/s] 24%|██▍       | 86/358 [00:08<00:28,  9.66it/s] 24%|██▍       | 87/358 [00:08<00:28,  9.65it/s] 25%|██▍       | 88/358 [00:09<00:27,  9.67it/s] 25%|██▌       | 90/358 [00:09<00:27,  9.90it/s] 26%|██▌       | 92/358 [00:09<00:26, 10.00it/s] 26%|██▌       | 93/358 [00:09<00:26,  9.96it/s] 26%|██▋       | 94/358 [00:09<00:26,  9.88it/s] 27%|██▋       | 96/358 [00:09<00:25, 10.16it/s] 27%|██▋       | 98/358 [00:10<00:25, 10.05it/s] 28%|██▊       | 99/358 [00:10<00:26,  9.95it/s] 28%|██▊       | 101/358 [00:10<00:25,  9.92it/s] 29%|██▉       | 103/358 [00:10<00:25,  9.91it/s] 29%|██▉       | 104/358 [00:10<00:25,  9.86it/s] 29%|██▉       | 105/358 [00:10<00:25,  9.78it/s] 30%|██▉       | 106/358 [00:10<00:25,  9.77it/s] 30%|███       | 108/358 [00:11<00:25,  9.80it/s] 30%|███       | 109/358 [00:11<00:25,  9.71it/s] 31%|███       | 110/358 [00:11<00:25,  9.69it/s] 31%|███       | 111/358 [00:11<00:25,  9.64it/s] 32%|███▏      | 113/358 [00:11<00:24,  9.91it/s] 32%|███▏      | 114/358 [00:11<00:24,  9.87it/s] 32%|███▏      | 115/358 [00:11<00:24,  9.77it/s] 32%|███▏      | 116/358 [00:11<00:24,  9.69it/s] 33%|███▎      | 117/358 [00:11<00:24,  9.66it/s] 33%|███▎      | 119/358 [00:12<00:24,  9.77it/s] 34%|███▍      | 121/358 [00:12<00:23,  9.97it/s] 34%|███▍      | 123/358 [00:12<00:23, 10.07it/s] 35%|███▍      | 125/358 [00:12<00:23, 10.05it/s] 35%|███▌      | 127/358 [00:12<00:23,  9.98it/s] 36%|███▌      | 128/358 [00:13<00:23,  9.94it/s] 36%|███▋      | 130/358 [00:13<00:22,  9.99it/s] 37%|███▋      | 131/358 [00:13<00:22,  9.90it/s] 37%|███▋      | 132/358 [00:13<00:22,  9.92it/s] 37%|███▋      | 134/358 [00:13<00:22,  9.93it/s] 38%|███▊      | 135/358 [00:13<00:22,  9.87it/s] 38%|███▊      | 137/358 [00:13<00:22,  9.96it/s] 39%|███▊      | 138/358 [00:14<00:22,  9.94it/s] 39%|███▉      | 139/358 [00:14<00:22,  9.85it/s] 39%|███▉      | 141/358 [00:14<00:21,  9.97it/s] 40%|███▉      | 142/358 [00:14<00:21,  9.90it/s] 40%|███▉      | 143/358 [00:14<00:21,  9.86it/s] 40%|████      | 144/358 [00:14<00:21,  9.77it/s] 41%|████      | 145/358 [00:14<00:21,  9.79it/s] 41%|████      | 146/358 [00:14<00:21,  9.73it/s] 41%|████      | 147/358 [00:14<00:21,  9.67it/s] 41%|████▏     | 148/358 [00:15<00:21,  9.70it/s] 42%|████▏     | 149/358 [00:15<00:21,  9.69it/s] 42%|████▏     | 150/358 [00:15<00:21,  9.64it/s] 42%|████▏     | 151/358 [00:15<00:22,  9.38it/s] 42%|████▏     | 152/358 [00:15<00:21,  9.43it/s] 43%|████▎     | 153/358 [00:15<00:21,  9.45it/s] 43%|████▎     | 154/358 [00:15<00:21,  9.54it/s] 43%|████▎     | 155/358 [00:15<00:21,  9.55it/s] 44%|████▎     | 156/358 [00:15<00:20,  9.67it/s] 44%|████▍     | 157/358 [00:16<00:20,  9.61it/s] 44%|████▍     | 158/358 [00:16<00:20,  9.70it/s] 44%|████▍     | 159/358 [00:16<00:20,  9.69it/s] 45%|████▍     | 160/358 [00:16<00:20,  9.70it/s] 45%|████▌     | 162/358 [00:16<00:19, 10.00it/s] 46%|████▌     | 164/358 [00:16<00:19, 10.00it/s] 46%|████▌     | 165/358 [00:16<00:19,  9.95it/s] 47%|████▋     | 167/358 [00:17<00:19,  9.90it/s] 47%|████▋     | 169/358 [00:17<00:19,  9.94it/s] 48%|████▊     | 171/358 [00:17<00:18,  9.92it/s] 48%|████▊     | 172/358 [00:17<00:18,  9.87it/s] 48%|████▊     | 173/358 [00:17<00:18,  9.80it/s] 49%|████▉     | 175/358 [00:17<00:18,  9.83it/s] 49%|████▉     | 176/358 [00:17<00:18,  9.84it/s] 49%|████▉     | 177/358 [00:18<00:18,  9.83it/s] 50%|█████     | 179/358 [00:18<00:18,  9.85it/s] 50%|█████     | 180/358 [00:18<00:18,  9.78it/s] 51%|█████     | 182/358 [00:18<00:17,  9.93it/s] 51%|█████     | 183/358 [00:18<00:17,  9.89it/s] 51%|█████▏    | 184/358 [00:18<00:17,  9.78it/s] 52%|█████▏    | 185/358 [00:18<00:17,  9.72it/s] 52%|█████▏    | 187/358 [00:19<00:17,  9.94it/s] 53%|█████▎    | 188/358 [00:19<00:17,  9.88it/s] 53%|█████▎    | 189/358 [00:19<00:17,  9.83it/s] 53%|█████▎    | 191/358 [00:19<00:17,  9.75it/s] 54%|█████▎    | 192/358 [00:19<00:17,  9.69it/s] 54%|█████▍    | 193/358 [00:19<00:17,  9.69it/s] 54%|█████▍    | 194/358 [00:19<00:16,  9.66it/s] 54%|█████▍    | 195/358 [00:19<00:16,  9.74it/s] 55%|█████▌    | 197/358 [00:20<00:16,  9.91it/s] 55%|█████▌    | 198/358 [00:20<00:16,  9.83it/s] 56%|█████▌    | 199/358 [00:20<00:16,  9.86it/s] 56%|█████▌    | 200/358 [00:20<00:16,  9.79it/s] 56%|█████▌    | 201/358 [00:20<00:16,  9.75it/s] 57%|█████▋    | 203/358 [00:20<00:15,  9.84it/s] 57%|█████▋    | 204/358 [00:20<00:15,  9.74it/s] 57%|█████▋    | 205/358 [00:20<00:15,  9.70it/s] 58%|█████▊    | 207/358 [00:21<00:15,  9.87it/s] 58%|█████▊    | 208/358 [00:21<00:15,  9.80it/s] 59%|█████▊    | 210/358 [00:21<00:15,  9.81it/s] 59%|█████▉    | 212/358 [00:21<00:14,  9.80it/s] 60%|█████▉    | 214/358 [00:21<00:14,  9.88it/s] 60%|██████    | 215/358 [00:21<00:14,  9.82it/s] 60%|██████    | 216/358 [00:22<00:14,  9.76it/s] 61%|██████    | 217/358 [00:22<00:14,  9.79it/s] 61%|██████    | 218/358 [00:22<00:14,  9.76it/s] 61%|██████    | 219/358 [00:22<00:14,  9.77it/s] 62%|██████▏   | 221/358 [00:22<00:13,  9.90it/s] 62%|██████▏   | 222/358 [00:22<00:13,  9.79it/s] 62%|██████▏   | 223/358 [00:22<00:13,  9.74it/s] 63%|██████▎   | 224/358 [00:22<00:13,  9.68it/s] 63%|██████▎   | 225/358 [00:22<00:13,  9.77it/s] 63%|██████▎   | 226/358 [00:23<00:13,  9.71it/s] 64%|██████▎   | 228/358 [00:23<00:13,  9.75it/s] 64%|██████▍   | 229/358 [00:23<00:13,  9.72it/s] 64%|██████▍   | 230/358 [00:23<00:13,  9.67it/s] 65%|██████▍   | 232/358 [00:23<00:12,  9.73it/s] 65%|██████▌   | 234/358 [00:23<00:12, 10.02it/s] 66%|██████▌   | 236/358 [00:24<00:12,  9.98it/s] 66%|██████▌   | 237/358 [00:24<00:12,  9.98it/s] 67%|██████▋   | 239/358 [00:24<00:11, 10.07it/s] 67%|██████▋   | 241/358 [00:24<00:11, 10.03it/s] 68%|██████▊   | 243/358 [00:24<00:11,  9.88it/s] 68%|██████▊   | 244/358 [00:24<00:11,  9.83it/s] 69%|██████▊   | 246/358 [00:25<00:11,  9.86it/s] 69%|██████▉   | 247/358 [00:25<00:11,  9.79it/s] 69%|██████▉   | 248/358 [00:25<00:11,  9.75it/s] 70%|██████▉   | 250/358 [00:25<00:10,  9.84it/s] 70%|███████   | 251/358 [00:25<00:10,  9.78it/s] 70%|███████   | 252/358 [00:25<00:10,  9.72it/s] 71%|███████   | 253/358 [00:25<00:10,  9.68it/s] 71%|███████   | 254/358 [00:25<00:10,  9.65it/s] 72%|███████▏  | 256/358 [00:26<00:10,  9.83it/s] 72%|███████▏  | 257/358 [00:26<00:10,  9.84it/s] 72%|███████▏  | 258/358 [00:26<00:10,  9.71it/s] 72%|███████▏  | 259/358 [00:26<00:10,  9.67it/s] 73%|███████▎  | 260/358 [00:26<00:10,  9.71it/s] 73%|███████▎  | 262/358 [00:26<00:09,  9.89it/s] 74%|███████▎  | 264/358 [00:26<00:09,  9.91it/s] 74%|███████▍  | 266/358 [00:27<00:09,  9.90it/s] 75%|███████▍  | 267/358 [00:27<00:09,  9.84it/s] 75%|███████▌  | 269/358 [00:27<00:08,  9.90it/s] 75%|███████▌  | 270/358 [00:27<00:08,  9.83it/s] 76%|███████▌  | 271/358 [00:27<00:08,  9.75it/s] 76%|███████▌  | 272/358 [00:27<00:08,  9.73it/s] 76%|███████▋  | 273/358 [00:27<00:08,  9.63it/s] 77%|███████▋  | 274/358 [00:27<00:08,  9.63it/s] 77%|███████▋  | 275/358 [00:28<00:08,  9.67it/s] 77%|███████▋  | 276/358 [00:28<00:08,  9.68it/s] 77%|███████▋  | 277/358 [00:28<00:08,  9.65it/s] 78%|███████▊  | 278/358 [00:28<00:08,  9.63it/s] 78%|███████▊  | 280/358 [00:28<00:07,  9.82it/s] 78%|███████▊  | 281/358 [00:28<00:07,  9.83it/s] 79%|███████▉  | 282/358 [00:28<00:07,  9.77it/s] 79%|███████▉  | 283/358 [00:28<00:07,  9.70it/s] 79%|███████▉  | 284/358 [00:28<00:07,  9.67it/s] 80%|███████▉  | 285/358 [00:29<00:07,  9.73it/s] 80%|███████▉  | 286/358 [00:29<00:07,  9.69it/s] 80%|████████  | 287/358 [00:29<00:07,  9.67it/s] 80%|████████  | 288/358 [00:29<00:07,  9.63it/s] 81%|████████  | 290/358 [00:29<00:06,  9.84it/s] 81%|████████▏ | 291/358 [00:29<00:06,  9.82it/s] 82%|████████▏ | 293/358 [00:29<00:06,  9.83it/s] 82%|████████▏ | 295/358 [00:30<00:06,  9.90it/s] 83%|████████▎ | 296/358 [00:30<00:06,  9.84it/s] 83%|████████▎ | 297/358 [00:30<00:06,  9.73it/s] 84%|████████▎ | 299/358 [00:30<00:05,  9.89it/s] 84%|████████▍ | 301/358 [00:30<00:05,  9.93it/s] 84%|████████▍ | 302/358 [00:30<00:05,  9.86it/s] 85%|████████▍ | 303/358 [00:30<00:05,  9.87it/s] 85%|████████▌ | 305/358 [00:31<00:05,  9.90it/s] 85%|████████▌ | 306/358 [00:31<00:05,  9.82it/s] 86%|████████▌ | 308/358 [00:31<00:05,  9.92it/s] 86%|████████▋ | 309/358 [00:31<00:04,  9.82it/s] 87%|████████▋ | 310/358 [00:31<00:04,  9.77it/s] 87%|████████▋ | 311/358 [00:31<00:04,  9.69it/s] 87%|████████▋ | 312/358 [00:31<00:04,  9.71it/s] 87%|████████▋ | 313/358 [00:31<00:04,  9.72it/s] 88%|████████▊ | 315/358 [00:32<00:04,  9.98it/s] 88%|████████▊ | 316/358 [00:32<00:04,  9.93it/s] 89%|████████▊ | 317/358 [00:32<00:04,  9.84it/s] 89%|████████▉ | 318/358 [00:32<00:04,  9.80it/s] 89%|████████▉ | 319/358 [00:32<00:03,  9.75it/s] 89%|████████▉ | 320/358 [00:32<00:03,  9.81it/s] 90%|████████▉ | 321/358 [00:32<00:03,  9.74it/s] 90%|████████▉ | 322/358 [00:32<00:03,  9.70it/s] 90%|█████████ | 323/358 [00:32<00:03,  9.65it/s] 91%|█████████ | 324/358 [00:33<00:03,  9.62it/s] 91%|█████████ | 325/358 [00:33<00:03,  9.60it/s] 91%|█████████▏| 327/358 [00:33<00:03,  9.96it/s] 92%|█████████▏| 329/358 [00:33<00:02, 10.06it/s] 92%|█████████▏| 330/358 [00:33<00:02,  9.95it/s] 93%|█████████▎| 332/358 [00:33<00:02, 10.04it/s] 93%|█████████▎| 334/358 [00:34<00:02,  9.95it/s] 94%|█████████▎| 335/358 [00:34<00:02,  9.83it/s] 94%|█████████▍| 337/358 [00:34<00:02,  9.90it/s] 95%|█████████▍| 339/358 [00:34<00:01, 10.10it/s] 95%|█████████▌| 341/358 [00:34<00:01, 10.05it/s] 96%|█████████▌| 343/358 [00:34<00:01,  9.89it/s] 96%|█████████▌| 344/358 [00:35<00:01,  9.84it/s] 96%|█████████▋| 345/358 [00:35<00:01,  9.85it/s] 97%|█████████▋| 347/358 [00:35<00:01, 10.03it/s] 97%|█████████▋| 348/358 [00:35<00:01,  9.93it/s] 97%|█████████▋| 349/358 [00:35<00:00,  9.86it/s] 98%|█████████▊| 350/358 [00:35<00:00,  9.78it/s] 98%|█████████▊| 351/358 [00:35<00:00,  9.74it/s] 99%|█████████▊| 353/358 [00:35<00:00,  9.92it/s] 99%|█████████▉| 354/358 [00:36<00:00,  9.90it/s] 99%|█████████▉| 355/358 [00:36<00:00,  9.81it/s]100%|█████████▉| 357/358 [00:36<00:00,  9.87it/s]100%|██████████| 358/358 [00:36<00:00,  9.82it/s]
[32m2025-02-05 05:58:58.979[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    gen_loss  grad clip ratio  grad norm   ppl
       1.954                1      3.537 7.057[0m
[32m2025-02-05 05:58:58.979[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m169[0m - [1m[Valid][0m
  0%|          | 0/10256 [00:00<?, ?it/s]100%|██████████| 10256/10256 [00:00<00:00, 1045136.71it/s]
[32m2025-02-05 05:58:58.989[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:27,  1.44it/s]  5%|▌         | 2/40 [00:01<00:26,  1.45it/s]  8%|▊         | 3/40 [00:02<00:25,  1.45it/s] 10%|█         | 4/40 [00:02<00:24,  1.45it/s] 12%|█▎        | 5/40 [00:03<00:24,  1.45it/s] 15%|█▌        | 6/40 [00:04<00:23,  1.44it/s] 18%|█▊        | 7/40 [00:04<00:22,  1.44it/s] 20%|██        | 8/40 [00:05<00:22,  1.45it/s] 22%|██▎       | 9/40 [00:06<00:21,  1.45it/s] 25%|██▌       | 10/40 [00:06<00:20,  1.46it/s] 28%|██▊       | 11/40 [00:07<00:19,  1.46it/s] 30%|███       | 12/40 [00:08<00:19,  1.46it/s] 32%|███▎      | 13/40 [00:08<00:18,  1.46it/s] 35%|███▌      | 14/40 [00:09<00:17,  1.45it/s] 38%|███▊      | 15/40 [00:10<00:17,  1.45it/s] 40%|████      | 16/40 [00:11<00:16,  1.45it/s] 42%|████▎     | 17/40 [00:11<00:15,  1.46it/s] 45%|████▌     | 18/40 [00:12<00:15,  1.46it/s] 48%|████▊     | 19/40 [00:13<00:14,  1.45it/s] 50%|█████     | 20/40 [00:13<00:13,  1.46it/s] 52%|█████▎    | 21/40 [00:14<00:12,  1.46it/s] 55%|█████▌    | 22/40 [00:15<00:12,  1.46it/s] 57%|█████▊    | 23/40 [00:15<00:11,  1.46it/s] 60%|██████    | 24/40 [00:16<00:11,  1.45it/s] 62%|██████▎   | 25/40 [00:17<00:10,  1.45it/s] 65%|██████▌   | 26/40 [00:17<00:09,  1.46it/s] 68%|██████▊   | 27/40 [00:18<00:08,  1.45it/s] 70%|███████   | 28/40 [00:19<00:08,  1.45it/s] 72%|███████▎  | 29/40 [00:19<00:07,  1.46it/s] 75%|███████▌  | 30/40 [00:20<00:06,  1.46it/s] 78%|███████▊  | 31/40 [00:21<00:06,  1.46it/s] 80%|████████  | 32/40 [00:22<00:05,  1.46it/s] 82%|████████▎ | 33/40 [00:22<00:04,  1.45it/s] 85%|████████▌ | 34/40 [00:23<00:04,  1.45it/s] 88%|████████▊ | 35/40 [00:24<00:03,  1.45it/s] 90%|█████████ | 36/40 [00:24<00:02,  1.45it/s] 92%|█████████▎| 37/40 [00:25<00:02,  1.45it/s] 95%|█████████▌| 38/40 [00:26<00:01,  1.45it/s] 98%|█████████▊| 39/40 [00:26<00:00,  1.44it/s]100%|██████████| 40/40 [00:27<00:00,  1.60it/s]100%|██████████| 40/40 [00:27<00:00,  1.46it/s]
[32m2025-02-05 05:59:26.319[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    average  bleu@1  bleu@2  bleu@3  bleu@4  dist@1  dist@2  dist@3  dist@4  extreme  \
      .7755   .2992   .1135  .04838  .02494  .04608   .3120   .6056   .7837    .5943   
      f1  gen_loss  greedy  intra_dist@1  intra_dist@2  intra_dist@3  intra_dist@4  \
   .3534     4.946   .6665         .8793         .9722         .9574         .9168   
     ppl  rouge1  rouge2  rougeL  
   140.7   .3883  .09519   .3756[0m
[32m2025-02-05 05:59:26.326[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m163[0m - [1m[Conversation epoch 48][0m
[32m2025-02-05 05:59:26.326[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m164[0m - [1m[Train][0m
  0%|          | 0/92414 [00:00<?, ?it/s]100%|██████████| 92414/92414 [00:00<00:00, 996161.48it/s]
[32m2025-02-05 05:59:26.420[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/358 [00:00<?, ?it/s]  0%|          | 1/358 [00:00<00:36,  9.74it/s]  1%|          | 3/358 [00:00<00:35,  9.93it/s]  1%|          | 4/358 [00:00<00:35,  9.90it/s]  2%|▏         | 6/358 [00:00<00:35,  9.87it/s]  2%|▏         | 7/358 [00:00<00:35,  9.80it/s]  2%|▏         | 8/358 [00:00<00:35,  9.85it/s]  3%|▎         | 9/358 [00:00<00:35,  9.75it/s]  3%|▎         | 10/358 [00:01<00:35,  9.74it/s]  3%|▎         | 11/358 [00:01<00:35,  9.69it/s]  4%|▎         | 13/358 [00:01<00:34,  9.90it/s]  4%|▍         | 14/358 [00:01<00:34,  9.83it/s]  4%|▍         | 15/358 [00:01<00:35,  9.76it/s]  4%|▍         | 16/358 [00:01<00:35,  9.70it/s]  5%|▍         | 17/358 [00:01<00:35,  9.72it/s]  5%|▌         | 18/358 [00:01<00:34,  9.79it/s]  5%|▌         | 19/358 [00:01<00:34,  9.72it/s]  6%|▌         | 20/358 [00:02<00:34,  9.67it/s]  6%|▌         | 21/358 [00:02<00:35,  9.60it/s]  6%|▌         | 22/358 [00:02<00:34,  9.67it/s]  7%|▋         | 24/358 [00:02<00:34,  9.77it/s]  7%|▋         | 25/358 [00:02<00:34,  9.72it/s]  7%|▋         | 26/358 [00:02<00:34,  9.66it/s]  8%|▊         | 27/358 [00:02<00:34,  9.72it/s]  8%|▊         | 28/358 [00:02<00:34,  9.67it/s]  8%|▊         | 29/358 [00:02<00:34,  9.64it/s]  9%|▊         | 31/358 [00:03<00:33,  9.75it/s]  9%|▉         | 32/358 [00:03<00:33,  9.74it/s]  9%|▉         | 34/358 [00:03<00:32,  9.84it/s] 10%|█         | 36/358 [00:03<00:32,  9.84it/s] 10%|█         | 37/358 [00:03<00:32,  9.82it/s] 11%|█         | 38/358 [00:03<00:32,  9.78it/s] 11%|█         | 40/358 [00:04<00:31,  9.94it/s] 11%|█▏        | 41/358 [00:04<00:32,  9.85it/s] 12%|█▏        | 43/358 [00:04<00:31,  9.88it/s] 13%|█▎        | 45/358 [00:04<00:31,  9.97it/s] 13%|█▎        | 47/358 [00:04<00:31,  9.95it/s] 13%|█▎        | 48/358 [00:04<00:31,  9.94it/s] 14%|█▍        | 50/358 [00:05<00:31,  9.91it/s] 14%|█▍        | 51/358 [00:05<00:31,  9.84it/s] 15%|█▍        | 52/358 [00:05<00:31,  9.75it/s] 15%|█▍        | 53/358 [00:05<00:31,  9.70it/s] 15%|█▌        | 54/358 [00:05<00:31,  9.74it/s] 15%|█▌        | 55/358 [00:05<00:31,  9.69it/s] 16%|█▌        | 56/358 [00:05<00:31,  9.73it/s] 16%|█▌        | 57/358 [00:05<00:31,  9.69it/s] 16%|█▌        | 58/358 [00:05<00:31,  9.67it/s] 16%|█▋        | 59/358 [00:06<00:31,  9.63it/s] 17%|█▋        | 61/358 [00:06<00:30,  9.72it/s] 17%|█▋        | 62/358 [00:06<00:30,  9.65it/s] 18%|█▊        | 63/358 [00:06<00:30,  9.71it/s] 18%|█▊        | 64/358 [00:06<00:30,  9.66it/s] 18%|█▊        | 66/358 [00:06<00:30,  9.73it/s] 19%|█▊        | 67/358 [00:06<00:29,  9.72it/s] 19%|█▉        | 69/358 [00:07<00:29,  9.78it/s] 20%|█▉        | 70/358 [00:07<00:29,  9.72it/s] 20%|█▉        | 71/358 [00:07<00:29,  9.77it/s] 20%|██        | 72/358 [00:07<00:29,  9.72it/s] 20%|██        | 73/358 [00:07<00:29,  9.68it/s] 21%|██        | 74/358 [00:07<00:29,  9.65it/s] 21%|██        | 75/358 [00:07<00:29,  9.62it/s] 21%|██        | 76/358 [00:07<00:29,  9.72it/s] 22%|██▏       | 77/358 [00:07<00:29,  9.69it/s] 22%|██▏       | 79/358 [00:08<00:28,  9.69it/s] 23%|██▎       | 81/358 [00:08<00:28,  9.75it/s] 23%|██▎       | 83/358 [00:08<00:28,  9.78it/s] 23%|██▎       | 84/358 [00:08<00:28,  9.72it/s] 24%|██▎       | 85/358 [00:08<00:28,  9.68it/s] 24%|██▍       | 86/358 [00:08<00:28,  9.67it/s] 24%|██▍       | 87/358 [00:08<00:28,  9.65it/s] 25%|██▍       | 88/358 [00:09<00:27,  9.67it/s] 25%|██▌       | 90/358 [00:09<00:27,  9.91it/s] 26%|██▌       | 92/358 [00:09<00:26, 10.01it/s] 26%|██▌       | 93/358 [00:09<00:26,  9.97it/s] 26%|██▋       | 94/358 [00:09<00:26,  9.88it/s] 27%|██▋       | 96/358 [00:09<00:25, 10.16it/s] 27%|██▋       | 98/358 [00:10<00:25, 10.05it/s] 28%|██▊       | 99/358 [00:10<00:26,  9.96it/s] 28%|██▊       | 101/358 [00:10<00:25,  9.92it/s] 29%|██▉       | 103/358 [00:10<00:25,  9.91it/s] 29%|██▉       | 104/358 [00:10<00:25,  9.86it/s] 29%|██▉       | 105/358 [00:10<00:25,  9.78it/s] 30%|██▉       | 106/358 [00:10<00:25,  9.77it/s] 30%|███       | 108/358 [00:11<00:25,  9.80it/s] 30%|███       | 109/358 [00:11<00:25,  9.71it/s] 31%|███       | 110/358 [00:11<00:25,  9.69it/s] 31%|███       | 111/358 [00:11<00:25,  9.65it/s] 32%|███▏      | 113/358 [00:11<00:24,  9.91it/s] 32%|███▏      | 114/358 [00:11<00:24,  9.87it/s] 32%|███▏      | 115/358 [00:11<00:24,  9.78it/s] 32%|███▏      | 116/358 [00:11<00:24,  9.70it/s] 33%|███▎      | 117/358 [00:11<00:24,  9.67it/s] 33%|███▎      | 119/358 [00:12<00:24,  9.79it/s] 34%|███▍      | 121/358 [00:12<00:23,  9.98it/s] 34%|███▍      | 123/358 [00:12<00:23, 10.08it/s] 35%|███▍      | 125/358 [00:12<00:23, 10.05it/s] 35%|███▌      | 127/358 [00:12<00:23,  9.98it/s] 36%|███▌      | 128/358 [00:13<00:23,  9.94it/s] 36%|███▋      | 130/358 [00:13<00:22,  9.99it/s] 37%|███▋      | 131/358 [00:13<00:22,  9.90it/s] 37%|███▋      | 132/358 [00:13<00:22,  9.92it/s] 37%|███▋      | 134/358 [00:13<00:22,  9.93it/s] 38%|███▊      | 135/358 [00:13<00:22,  9.87it/s] 38%|███▊      | 137/358 [00:13<00:22,  9.96it/s] 39%|███▊      | 138/358 [00:14<00:22,  9.94it/s] 39%|███▉      | 139/358 [00:14<00:22,  9.86it/s] 39%|███▉      | 141/358 [00:14<00:21,  9.98it/s] 40%|███▉      | 142/358 [00:14<00:21,  9.90it/s] 40%|███▉      | 143/358 [00:14<00:21,  9.87it/s] 40%|████      | 144/358 [00:14<00:21,  9.78it/s] 41%|████      | 145/358 [00:14<00:21,  9.80it/s] 41%|████      | 146/358 [00:14<00:21,  9.74it/s] 41%|████      | 147/358 [00:14<00:21,  9.68it/s] 41%|████▏     | 148/358 [00:15<00:21,  9.71it/s] 42%|████▏     | 149/358 [00:15<00:21,  9.69it/s] 42%|████▏     | 150/358 [00:15<00:21,  9.65it/s] 42%|████▏     | 151/358 [00:15<00:22,  9.39it/s] 42%|████▏     | 152/358 [00:15<00:21,  9.43it/s] 43%|████▎     | 153/358 [00:15<00:21,  9.45it/s] 43%|████▎     | 154/358 [00:15<00:21,  9.55it/s] 43%|████▎     | 155/358 [00:15<00:21,  9.56it/s] 44%|████▎     | 156/358 [00:15<00:20,  9.68it/s] 44%|████▍     | 157/358 [00:16<00:20,  9.62it/s] 44%|████▍     | 158/358 [00:16<00:20,  9.71it/s] 44%|████▍     | 159/358 [00:16<00:20,  9.70it/s] 45%|████▍     | 160/358 [00:16<00:20,  9.71it/s] 45%|████▌     | 162/358 [00:16<00:19, 10.00it/s] 46%|████▌     | 164/358 [00:16<00:19, 10.00it/s] 46%|████▌     | 165/358 [00:16<00:19,  9.96it/s] 47%|████▋     | 167/358 [00:17<00:19,  9.90it/s] 47%|████▋     | 169/358 [00:17<00:19,  9.94it/s] 48%|████▊     | 171/358 [00:17<00:18,  9.92it/s] 48%|████▊     | 172/358 [00:17<00:18,  9.87it/s] 48%|████▊     | 173/358 [00:17<00:18,  9.81it/s] 49%|████▉     | 175/358 [00:17<00:18,  9.83it/s] 49%|████▉     | 176/358 [00:17<00:18,  9.85it/s] 49%|████▉     | 177/358 [00:18<00:18,  9.83it/s] 50%|█████     | 179/358 [00:18<00:18,  9.85it/s] 50%|█████     | 180/358 [00:18<00:18,  9.78it/s] 51%|█████     | 182/358 [00:18<00:17,  9.94it/s] 51%|█████     | 183/358 [00:18<00:17,  9.89it/s] 51%|█████▏    | 184/358 [00:18<00:17,  9.78it/s] 52%|█████▏    | 185/358 [00:18<00:17,  9.72it/s] 52%|█████▏    | 187/358 [00:19<00:17,  9.94it/s] 53%|█████▎    | 188/358 [00:19<00:17,  9.89it/s] 53%|█████▎    | 189/358 [00:19<00:17,  9.83it/s] 53%|█████▎    | 191/358 [00:19<00:17,  9.75it/s] 54%|█████▎    | 192/358 [00:19<00:17,  9.70it/s] 54%|█████▍    | 193/358 [00:19<00:17,  9.69it/s] 54%|█████▍    | 194/358 [00:19<00:16,  9.67it/s] 54%|█████▍    | 195/358 [00:19<00:16,  9.74it/s] 55%|█████▌    | 197/358 [00:20<00:16,  9.92it/s] 55%|█████▌    | 198/358 [00:20<00:16,  9.84it/s] 56%|█████▌    | 199/358 [00:20<00:16,  9.87it/s] 56%|█████▌    | 200/358 [00:20<00:16,  9.80it/s] 56%|█████▌    | 201/358 [00:20<00:16,  9.76it/s] 57%|█████▋    | 203/358 [00:20<00:15,  9.85it/s] 57%|█████▋    | 204/358 [00:20<00:15,  9.75it/s] 57%|█████▋    | 205/358 [00:20<00:15,  9.71it/s] 58%|█████▊    | 207/358 [00:21<00:15,  9.87it/s] 58%|█████▊    | 208/358 [00:21<00:15,  9.80it/s] 59%|█████▊    | 210/358 [00:21<00:15,  9.82it/s] 59%|█████▉    | 212/358 [00:21<00:14,  9.81it/s] 60%|█████▉    | 214/358 [00:21<00:14,  9.87it/s] 60%|██████    | 215/358 [00:21<00:14,  9.81it/s] 60%|██████    | 216/358 [00:22<00:14,  9.75it/s] 61%|██████    | 217/358 [00:22<00:14,  9.79it/s] 61%|██████    | 218/358 [00:22<00:14,  9.76it/s] 61%|██████    | 219/358 [00:22<00:14,  9.76it/s] 62%|██████▏   | 221/358 [00:22<00:13,  9.90it/s] 62%|██████▏   | 222/358 [00:22<00:13,  9.80it/s] 62%|██████▏   | 223/358 [00:22<00:13,  9.75it/s] 63%|██████▎   | 224/358 [00:22<00:13,  9.69it/s] 63%|██████▎   | 226/358 [00:23<00:13,  9.74it/s] 64%|██████▎   | 228/358 [00:23<00:13,  9.76it/s] 64%|██████▍   | 229/358 [00:23<00:13,  9.74it/s] 64%|██████▍   | 230/358 [00:23<00:13,  9.69it/s] 65%|██████▍   | 232/358 [00:23<00:12,  9.74it/s] 65%|██████▌   | 234/358 [00:23<00:12, 10.02it/s] 66%|██████▌   | 236/358 [00:24<00:12,  9.98it/s] 66%|██████▋   | 238/358 [00:24<00:11, 10.04it/s] 67%|██████▋   | 240/358 [00:24<00:11, 10.00it/s] 68%|██████▊   | 242/358 [00:24<00:11,  9.98it/s] 68%|██████▊   | 243/358 [00:24<00:11,  9.91it/s] 68%|██████▊   | 244/358 [00:24<00:11,  9.85it/s] 69%|██████▊   | 246/358 [00:25<00:11,  9.87it/s] 69%|██████▉   | 247/358 [00:25<00:11,  9.80it/s] 69%|██████▉   | 248/358 [00:25<00:11,  9.75it/s] 70%|██████▉   | 250/358 [00:25<00:10,  9.85it/s] 70%|███████   | 251/358 [00:25<00:10,  9.79it/s] 70%|███████   | 252/358 [00:25<00:10,  9.73it/s] 71%|███████   | 253/358 [00:25<00:10,  9.69it/s] 71%|███████   | 254/358 [00:25<00:10,  9.66it/s] 72%|███████▏  | 256/358 [00:26<00:10,  9.84it/s] 72%|███████▏  | 257/358 [00:26<00:10,  9.84it/s] 72%|███████▏  | 258/358 [00:26<00:10,  9.71it/s] 72%|███████▏  | 259/358 [00:26<00:10,  9.68it/s] 73%|███████▎  | 260/358 [00:26<00:10,  9.72it/s] 73%|███████▎  | 262/358 [00:26<00:09,  9.89it/s] 74%|███████▎  | 264/358 [00:26<00:09,  9.92it/s] 74%|███████▍  | 266/358 [00:27<00:09,  9.91it/s] 75%|███████▍  | 267/358 [00:27<00:09,  9.85it/s] 75%|███████▌  | 269/358 [00:27<00:08,  9.91it/s] 75%|███████▌  | 270/358 [00:27<00:08,  9.83it/s] 76%|███████▌  | 271/358 [00:27<00:08,  9.76it/s] 76%|███████▌  | 272/358 [00:27<00:08,  9.74it/s] 76%|███████▋  | 273/358 [00:27<00:08,  9.64it/s] 77%|███████▋  | 274/358 [00:27<00:08,  9.64it/s] 77%|███████▋  | 275/358 [00:28<00:08,  9.68it/s] 77%|███████▋  | 276/358 [00:28<00:08,  9.68it/s] 77%|███████▋  | 277/358 [00:28<00:08,  9.65it/s] 78%|███████▊  | 278/358 [00:28<00:08,  9.63it/s] 78%|███████▊  | 280/358 [00:28<00:07,  9.82it/s] 78%|███████▊  | 281/358 [00:28<00:07,  9.83it/s] 79%|███████▉  | 282/358 [00:28<00:07,  9.77it/s] 79%|███████▉  | 283/358 [00:28<00:07,  9.70it/s] 79%|███████▉  | 284/358 [00:28<00:07,  9.67it/s] 80%|███████▉  | 285/358 [00:29<00:07,  9.73it/s] 80%|███████▉  | 286/358 [00:29<00:07,  9.69it/s] 80%|████████  | 287/358 [00:29<00:07,  9.67it/s] 80%|████████  | 288/358 [00:29<00:07,  9.63it/s] 81%|████████  | 290/358 [00:29<00:06,  9.84it/s] 81%|████████▏ | 291/358 [00:29<00:06,  9.82it/s] 82%|████████▏ | 293/358 [00:29<00:06,  9.83it/s] 82%|████████▏ | 295/358 [00:30<00:06,  9.91it/s] 83%|████████▎ | 296/358 [00:30<00:06,  9.84it/s] 83%|████████▎ | 297/358 [00:30<00:06,  9.74it/s] 84%|████████▎ | 299/358 [00:30<00:05,  9.90it/s] 84%|████████▍ | 301/358 [00:30<00:05,  9.94it/s] 84%|████████▍ | 302/358 [00:30<00:05,  9.87it/s] 85%|████████▍ | 303/358 [00:30<00:05,  9.88it/s] 85%|████████▌ | 305/358 [00:31<00:05,  9.90it/s] 85%|████████▌ | 306/358 [00:31<00:05,  9.82it/s] 86%|████████▌ | 308/358 [00:31<00:05,  9.93it/s] 86%|████████▋ | 309/358 [00:31<00:04,  9.82it/s] 87%|████████▋ | 310/358 [00:31<00:04,  9.77it/s] 87%|████████▋ | 311/358 [00:31<00:04,  9.69it/s] 87%|████████▋ | 312/358 [00:31<00:04,  9.71it/s] 87%|████████▋ | 313/358 [00:31<00:04,  9.73it/s] 88%|████████▊ | 315/358 [00:32<00:04,  9.99it/s] 88%|████████▊ | 316/358 [00:32<00:04,  9.94it/s] 89%|████████▊ | 317/358 [00:32<00:04,  9.85it/s] 89%|████████▉ | 318/358 [00:32<00:04,  9.81it/s] 89%|████████▉ | 319/358 [00:32<00:03,  9.76it/s] 89%|████████▉ | 320/358 [00:32<00:03,  9.82it/s] 90%|████████▉ | 321/358 [00:32<00:03,  9.74it/s] 90%|████████▉ | 322/358 [00:32<00:03,  9.71it/s] 90%|█████████ | 323/358 [00:32<00:03,  9.66it/s] 91%|█████████ | 324/358 [00:33<00:03,  9.63it/s] 91%|█████████ | 325/358 [00:33<00:03,  9.61it/s] 91%|█████████▏| 327/358 [00:33<00:03,  9.97it/s] 92%|█████████▏| 329/358 [00:33<00:02, 10.07it/s] 92%|█████████▏| 330/358 [00:33<00:02,  9.96it/s] 93%|█████████▎| 332/358 [00:33<00:02, 10.06it/s] 93%|█████████▎| 334/358 [00:34<00:02,  9.96it/s] 94%|█████████▎| 335/358 [00:34<00:02,  9.84it/s] 94%|█████████▍| 337/358 [00:34<00:02,  9.92it/s] 95%|█████████▍| 339/358 [00:34<00:01, 10.12it/s] 95%|█████████▌| 341/358 [00:34<00:01, 10.06it/s] 96%|█████████▌| 343/358 [00:34<00:01,  9.90it/s] 96%|█████████▌| 344/358 [00:35<00:01,  9.84it/s] 96%|█████████▋| 345/358 [00:35<00:01,  9.86it/s] 97%|█████████▋| 347/358 [00:35<00:01, 10.04it/s] 97%|█████████▋| 348/358 [00:35<00:01,  9.94it/s] 97%|█████████▋| 349/358 [00:35<00:00,  9.86it/s] 98%|█████████▊| 350/358 [00:35<00:00,  9.79it/s] 98%|█████████▊| 351/358 [00:35<00:00,  9.74it/s] 99%|█████████▊| 353/358 [00:35<00:00,  9.92it/s] 99%|█████████▉| 354/358 [00:36<00:00,  9.90it/s] 99%|█████████▉| 355/358 [00:36<00:00,  9.82it/s]100%|█████████▉| 357/358 [00:36<00:00,  9.87it/s]100%|██████████| 358/358 [00:36<00:00,  9.83it/s]
[32m2025-02-05 06:00:02.862[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    gen_loss  grad clip ratio  grad norm   ppl
       1.947                1       2.61 7.004[0m
[32m2025-02-05 06:00:02.863[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m169[0m - [1m[Valid][0m
  0%|          | 0/10256 [00:00<?, ?it/s]100%|██████████| 10256/10256 [00:00<00:00, 1078493.25it/s]
[32m2025-02-05 06:00:02.873[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:27,  1.44it/s]  5%|▌         | 2/40 [00:01<00:26,  1.45it/s]  8%|▊         | 3/40 [00:02<00:25,  1.45it/s] 10%|█         | 4/40 [00:02<00:24,  1.45it/s] 12%|█▎        | 5/40 [00:03<00:24,  1.45it/s] 15%|█▌        | 6/40 [00:04<00:23,  1.45it/s] 18%|█▊        | 7/40 [00:04<00:22,  1.45it/s] 20%|██        | 8/40 [00:05<00:22,  1.45it/s] 22%|██▎       | 9/40 [00:06<00:21,  1.45it/s] 25%|██▌       | 10/40 [00:06<00:20,  1.46it/s] 28%|██▊       | 11/40 [00:07<00:19,  1.46it/s] 30%|███       | 12/40 [00:08<00:19,  1.46it/s] 32%|███▎      | 13/40 [00:08<00:18,  1.46it/s] 35%|███▌      | 14/40 [00:09<00:17,  1.45it/s] 38%|███▊      | 15/40 [00:10<00:17,  1.45it/s] 40%|████      | 16/40 [00:11<00:16,  1.45it/s] 42%|████▎     | 17/40 [00:11<00:15,  1.45it/s] 45%|████▌     | 18/40 [00:12<00:15,  1.45it/s] 48%|████▊     | 19/40 [00:13<00:14,  1.45it/s] 50%|█████     | 20/40 [00:13<00:13,  1.45it/s] 52%|█████▎    | 21/40 [00:14<00:13,  1.46it/s] 55%|█████▌    | 22/40 [00:15<00:12,  1.45it/s] 57%|█████▊    | 23/40 [00:15<00:11,  1.45it/s] 60%|██████    | 24/40 [00:16<00:11,  1.45it/s] 62%|██████▎   | 25/40 [00:17<00:10,  1.45it/s] 65%|██████▌   | 26/40 [00:17<00:09,  1.46it/s] 68%|██████▊   | 27/40 [00:18<00:08,  1.46it/s] 70%|███████   | 28/40 [00:19<00:08,  1.46it/s] 72%|███████▎  | 29/40 [00:19<00:07,  1.46it/s] 75%|███████▌  | 30/40 [00:20<00:06,  1.46it/s] 78%|███████▊  | 31/40 [00:21<00:06,  1.46it/s] 80%|████████  | 32/40 [00:22<00:05,  1.46it/s] 82%|████████▎ | 33/40 [00:22<00:04,  1.45it/s] 85%|████████▌ | 34/40 [00:23<00:04,  1.45it/s] 88%|████████▊ | 35/40 [00:24<00:03,  1.45it/s] 90%|█████████ | 36/40 [00:24<00:02,  1.45it/s] 92%|█████████▎| 37/40 [00:25<00:02,  1.45it/s] 95%|█████████▌| 38/40 [00:26<00:01,  1.44it/s] 98%|█████████▊| 39/40 [00:26<00:00,  1.45it/s]100%|██████████| 40/40 [00:27<00:00,  1.60it/s]100%|██████████| 40/40 [00:27<00:00,  1.46it/s]
[32m2025-02-05 06:00:30.205[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    average  bleu@1  bleu@2  bleu@3  bleu@4  dist@1  dist@2  dist@3  dist@4  extreme  \
      .7719   .2971   .1100  .04299  .02054  .04288   .2933   .5624   .7211    .5934   
      f1  gen_loss  greedy  intra_dist@1  intra_dist@2  intra_dist@3  intra_dist@4  \
   .3469     5.016   .6675         .8612         .9551         .9367         .9077   
     ppl  rouge1  rouge2  rougeL  
   150.7   .3841  .09014   .3714[0m
[32m2025-02-05 06:00:30.212[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m163[0m - [1m[Conversation epoch 49][0m
[32m2025-02-05 06:00:30.212[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m164[0m - [1m[Train][0m
  0%|          | 0/92414 [00:00<?, ?it/s]100%|██████████| 92414/92414 [00:00<00:00, 999011.36it/s]
[32m2025-02-05 06:00:30.305[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/358 [00:00<?, ?it/s]  0%|          | 1/358 [00:00<00:36,  9.74it/s]  1%|          | 3/358 [00:00<00:35,  9.93it/s]  1%|          | 4/358 [00:00<00:35,  9.91it/s]  2%|▏         | 6/358 [00:00<00:35,  9.88it/s]  2%|▏         | 7/358 [00:00<00:35,  9.82it/s]  2%|▏         | 8/358 [00:00<00:35,  9.86it/s]  3%|▎         | 9/358 [00:00<00:35,  9.76it/s]  3%|▎         | 10/358 [00:01<00:35,  9.75it/s]  3%|▎         | 11/358 [00:01<00:35,  9.70it/s]  4%|▎         | 13/358 [00:01<00:34,  9.92it/s]  4%|▍         | 14/358 [00:01<00:34,  9.84it/s]  4%|▍         | 15/358 [00:01<00:35,  9.77it/s]  4%|▍         | 16/358 [00:01<00:35,  9.70it/s]  5%|▍         | 17/358 [00:01<00:35,  9.72it/s]  5%|▌         | 18/358 [00:01<00:34,  9.80it/s]  5%|▌         | 19/358 [00:01<00:34,  9.73it/s]  6%|▌         | 20/358 [00:02<00:34,  9.67it/s]  6%|▌         | 21/358 [00:02<00:35,  9.60it/s]  6%|▌         | 22/358 [00:02<00:34,  9.67it/s]  7%|▋         | 24/358 [00:02<00:34,  9.77it/s]  7%|▋         | 25/358 [00:02<00:34,  9.72it/s]  7%|▋         | 26/358 [00:02<00:34,  9.67it/s]  8%|▊         | 27/358 [00:02<00:34,  9.72it/s]  8%|▊         | 28/358 [00:02<00:34,  9.68it/s]  8%|▊         | 29/358 [00:02<00:34,  9.65it/s]  9%|▊         | 31/358 [00:03<00:33,  9.75it/s]  9%|▉         | 32/358 [00:03<00:33,  9.75it/s]  9%|▉         | 34/358 [00:03<00:32,  9.85it/s] 10%|█         | 36/358 [00:03<00:32,  9.85it/s] 10%|█         | 37/358 [00:03<00:32,  9.83it/s] 11%|█         | 38/358 [00:03<00:32,  9.78it/s] 11%|█         | 40/358 [00:04<00:31,  9.94it/s] 11%|█▏        | 41/358 [00:04<00:32,  9.85it/s] 12%|█▏        | 43/358 [00:04<00:31,  9.88it/s] 13%|█▎        | 45/358 [00:04<00:31,  9.98it/s] 13%|█▎        | 47/358 [00:04<00:31,  9.95it/s] 13%|█▎        | 48/358 [00:04<00:31,  9.94it/s] 14%|█▍        | 50/358 [00:05<00:31,  9.91it/s] 14%|█▍        | 51/358 [00:05<00:31,  9.84it/s] 15%|█▍        | 52/358 [00:05<00:31,  9.75it/s] 15%|█▍        | 53/358 [00:05<00:31,  9.70it/s] 15%|█▌        | 54/358 [00:05<00:31,  9.75it/s] 15%|█▌        | 55/358 [00:05<00:31,  9.69it/s] 16%|█▌        | 56/358 [00:05<00:31,  9.73it/s] 16%|█▌        | 57/358 [00:05<00:31,  9.69it/s] 16%|█▌        | 58/358 [00:05<00:31,  9.67it/s] 16%|█▋        | 59/358 [00:06<00:31,  9.64it/s] 17%|█▋        | 61/358 [00:06<00:30,  9.72it/s] 17%|█▋        | 62/358 [00:06<00:30,  9.65it/s] 18%|█▊        | 63/358 [00:06<00:30,  9.71it/s] 18%|█▊        | 64/358 [00:06<00:30,  9.66it/s] 18%|█▊        | 66/358 [00:06<00:30,  9.73it/s] 19%|█▊        | 67/358 [00:06<00:29,  9.72it/s] 19%|█▉        | 69/358 [00:07<00:29,  9.78it/s] 20%|█▉        | 70/358 [00:07<00:29,  9.73it/s] 20%|█▉        | 71/358 [00:07<00:29,  9.77it/s] 20%|██        | 72/358 [00:07<00:29,  9.72it/s] 20%|██        | 73/358 [00:07<00:29,  9.69it/s] 21%|██        | 74/358 [00:07<00:29,  9.66it/s] 21%|██        | 75/358 [00:07<00:29,  9.62it/s] 21%|██        | 76/358 [00:07<00:28,  9.73it/s] 22%|██▏       | 77/358 [00:07<00:29,  9.69it/s] 22%|██▏       | 79/358 [00:08<00:28,  9.69it/s] 23%|██▎       | 81/358 [00:08<00:28,  9.76it/s] 23%|██▎       | 83/358 [00:08<00:28,  9.78it/s] 23%|██▎       | 84/358 [00:08<00:28,  9.73it/s] 24%|██▎       | 85/358 [00:08<00:28,  9.69it/s] 24%|██▍       | 86/358 [00:08<00:28,  9.67it/s] 24%|██▍       | 87/358 [00:08<00:28,  9.65it/s] 25%|██▍       | 88/358 [00:09<00:27,  9.67it/s] 25%|██▌       | 90/358 [00:09<00:27,  9.91it/s] 26%|██▌       | 92/358 [00:09<00:26, 10.01it/s] 26%|██▌       | 93/358 [00:09<00:26,  9.97it/s] 26%|██▋       | 94/358 [00:09<00:26,  9.89it/s] 27%|██▋       | 96/358 [00:09<00:25, 10.17it/s] 27%|██▋       | 98/358 [00:10<00:25, 10.05it/s] 28%|██▊       | 99/358 [00:10<00:25,  9.96it/s] 28%|██▊       | 101/358 [00:10<00:25,  9.93it/s] 29%|██▉       | 103/358 [00:10<00:25,  9.92it/s] 29%|██▉       | 104/358 [00:10<00:25,  9.87it/s] 29%|██▉       | 105/358 [00:10<00:25,  9.79it/s] 30%|██▉       | 106/358 [00:10<00:25,  9.78it/s] 30%|███       | 108/358 [00:11<00:25,  9.80it/s] 30%|███       | 109/358 [00:11<00:25,  9.72it/s] 31%|███       | 110/358 [00:11<00:25,  9.70it/s] 31%|███       | 111/358 [00:11<00:25,  9.65it/s] 32%|███▏      | 113/358 [00:11<00:24,  9.92it/s] 32%|███▏      | 114/358 [00:11<00:24,  9.88it/s] 32%|███▏      | 115/358 [00:11<00:24,  9.78it/s] 32%|███▏      | 116/358 [00:11<00:24,  9.70it/s] 33%|███▎      | 117/358 [00:11<00:24,  9.67it/s] 33%|███▎      | 119/358 [00:12<00:24,  9.79it/s] 34%|███▍      | 121/358 [00:12<00:23,  9.98it/s] 34%|███▍      | 123/358 [00:12<00:23, 10.08it/s] 35%|███▍      | 125/358 [00:12<00:23, 10.06it/s] 35%|███▌      | 127/358 [00:12<00:23,  9.98it/s] 36%|███▌      | 128/358 [00:13<00:23,  9.94it/s] 36%|███▋      | 130/358 [00:13<00:22,  9.99it/s] 37%|███▋      | 131/358 [00:13<00:22,  9.90it/s] 37%|███▋      | 132/358 [00:13<00:22,  9.92it/s] 37%|███▋      | 134/358 [00:13<00:22,  9.94it/s] 38%|███▊      | 135/358 [00:13<00:22,  9.88it/s] 38%|███▊      | 137/358 [00:13<00:22,  9.97it/s] 39%|███▊      | 138/358 [00:14<00:22,  9.95it/s] 39%|███▉      | 139/358 [00:14<00:22,  9.86it/s] 39%|███▉      | 141/358 [00:14<00:21,  9.99it/s] 40%|███▉      | 142/358 [00:14<00:21,  9.91it/s] 40%|███▉      | 143/358 [00:14<00:21,  9.88it/s] 40%|████      | 144/358 [00:14<00:21,  9.78it/s] 41%|████      | 145/358 [00:14<00:21,  9.81it/s] 41%|████      | 146/358 [00:14<00:21,  9.74it/s] 41%|████      | 147/358 [00:14<00:21,  9.68it/s] 41%|████▏     | 148/358 [00:15<00:21,  9.71it/s] 42%|████▏     | 149/358 [00:15<00:21,  9.69it/s] 42%|████▏     | 150/358 [00:15<00:21,  9.65it/s] 42%|████▏     | 151/358 [00:15<00:22,  9.39it/s] 42%|████▏     | 152/358 [00:15<00:21,  9.43it/s] 43%|████▎     | 153/358 [00:15<00:21,  9.45it/s] 43%|████▎     | 154/358 [00:15<00:21,  9.54it/s] 43%|████▎     | 155/358 [00:15<00:21,  9.55it/s] 44%|████▎     | 156/358 [00:15<00:20,  9.68it/s] 44%|████▍     | 157/358 [00:16<00:20,  9.62it/s] 44%|████▍     | 158/358 [00:16<00:20,  9.71it/s] 44%|████▍     | 159/358 [00:16<00:20,  9.70it/s] 45%|████▍     | 160/358 [00:16<00:20,  9.71it/s] 45%|████▌     | 162/358 [00:16<00:19, 10.01it/s] 46%|████▌     | 164/358 [00:16<00:19, 10.01it/s] 46%|████▌     | 165/358 [00:16<00:19,  9.96it/s] 47%|████▋     | 167/358 [00:17<00:19,  9.91it/s] 47%|████▋     | 169/358 [00:17<00:19,  9.95it/s] 48%|████▊     | 171/358 [00:17<00:18,  9.93it/s] 48%|████▊     | 172/358 [00:17<00:18,  9.88it/s] 48%|████▊     | 173/358 [00:17<00:18,  9.81it/s] 49%|████▉     | 175/358 [00:17<00:18,  9.84it/s] 49%|████▉     | 176/358 [00:17<00:18,  9.85it/s] 49%|████▉     | 177/358 [00:18<00:18,  9.84it/s] 50%|█████     | 179/358 [00:18<00:18,  9.86it/s] 50%|█████     | 180/358 [00:18<00:18,  9.78it/s] 51%|█████     | 182/358 [00:18<00:17,  9.94it/s] 51%|█████     | 183/358 [00:18<00:17,  9.89it/s] 51%|█████▏    | 184/358 [00:18<00:17,  9.78it/s] 52%|█████▏    | 185/358 [00:18<00:17,  9.73it/s] 52%|█████▏    | 187/358 [00:19<00:17,  9.94it/s] 53%|█████▎    | 188/358 [00:19<00:17,  9.89it/s] 53%|█████▎    | 189/358 [00:19<00:17,  9.82it/s] 53%|█████▎    | 191/358 [00:19<00:17,  9.75it/s] 54%|█████▎    | 192/358 [00:19<00:17,  9.70it/s] 54%|█████▍    | 193/358 [00:19<00:17,  9.68it/s] 54%|█████▍    | 194/358 [00:19<00:16,  9.67it/s] 54%|█████▍    | 195/358 [00:19<00:16,  9.74it/s] 55%|█████▌    | 197/358 [00:20<00:16,  9.91it/s] 55%|█████▌    | 198/358 [00:20<00:16,  9.83it/s] 56%|█████▌    | 199/358 [00:20<00:16,  9.87it/s] 56%|█████▌    | 200/358 [00:20<00:16,  9.80it/s] 56%|█████▌    | 201/358 [00:20<00:16,  9.76it/s] 57%|█████▋    | 203/358 [00:20<00:15,  9.86it/s] 57%|█████▋    | 204/358 [00:20<00:15,  9.75it/s] 57%|█████▋    | 205/358 [00:20<00:15,  9.70it/s] 58%|█████▊    | 207/358 [00:21<00:15,  9.87it/s] 58%|█████▊    | 208/358 [00:21<00:15,  9.80it/s] 59%|█████▊    | 210/358 [00:21<00:15,  9.82it/s] 59%|█████▉    | 212/358 [00:21<00:14,  9.81it/s] 60%|█████▉    | 214/358 [00:21<00:14,  9.89it/s] 60%|██████    | 215/358 [00:21<00:14,  9.83it/s] 60%|██████    | 216/358 [00:22<00:14,  9.77it/s] 61%|██████    | 217/358 [00:22<00:14,  9.80it/s] 61%|██████    | 218/358 [00:22<00:14,  9.77it/s] 61%|██████    | 219/358 [00:22<00:14,  9.78it/s] 62%|██████▏   | 221/358 [00:22<00:13,  9.91it/s] 62%|██████▏   | 222/358 [00:22<00:13,  9.80it/s] 62%|██████▏   | 223/358 [00:22<00:13,  9.75it/s] 63%|██████▎   | 224/358 [00:22<00:13,  9.69it/s] 63%|██████▎   | 226/358 [00:23<00:13,  9.74it/s] 64%|██████▎   | 228/358 [00:23<00:13,  9.76it/s] 64%|██████▍   | 229/358 [00:23<00:13,  9.74it/s] 64%|██████▍   | 230/358 [00:23<00:13,  9.69it/s] 65%|██████▍   | 232/358 [00:23<00:12,  9.74it/s] 65%|██████▌   | 234/358 [00:23<00:12, 10.02it/s] 66%|██████▌   | 236/358 [00:24<00:12,  9.98it/s] 66%|██████▋   | 238/358 [00:24<00:11, 10.04it/s] 67%|██████▋   | 240/358 [00:24<00:11,  9.99it/s] 68%|██████▊   | 242/358 [00:24<00:11,  9.97it/s] 68%|██████▊   | 243/358 [00:24<00:11,  9.91it/s] 68%|██████▊   | 244/358 [00:24<00:11,  9.85it/s] 69%|██████▊   | 246/358 [00:25<00:11,  9.87it/s] 69%|██████▉   | 247/358 [00:25<00:11,  9.80it/s] 69%|██████▉   | 248/358 [00:25<00:11,  9.75it/s] 70%|██████▉   | 250/358 [00:25<00:10,  9.85it/s] 70%|███████   | 251/358 [00:25<00:10,  9.78it/s] 70%|███████   | 252/358 [00:25<00:10,  9.72it/s] 71%|███████   | 253/358 [00:25<00:10,  9.68it/s] 71%|███████   | 254/358 [00:25<00:10,  9.65it/s] 72%|███████▏  | 256/358 [00:26<00:10,  9.83it/s] 72%|███████▏  | 257/358 [00:26<00:10,  9.84it/s] 72%|███████▏  | 258/358 [00:26<00:10,  9.71it/s] 72%|███████▏  | 259/358 [00:26<00:10,  9.68it/s] 73%|███████▎  | 260/358 [00:26<00:10,  9.71it/s] 73%|███████▎  | 262/358 [00:26<00:09,  9.89it/s] 74%|███████▎  | 264/358 [00:26<00:09,  9.91it/s] 74%|███████▍  | 266/358 [00:27<00:09,  9.90it/s] 75%|███████▍  | 267/358 [00:27<00:09,  9.84it/s] 75%|███████▌  | 269/358 [00:27<00:08,  9.90it/s] 75%|███████▌  | 270/358 [00:27<00:08,  9.83it/s] 76%|███████▌  | 271/358 [00:27<00:08,  9.76it/s] 76%|███████▌  | 272/358 [00:27<00:08,  9.73it/s] 76%|███████▋  | 273/358 [00:27<00:08,  9.63it/s] 77%|███████▋  | 274/358 [00:27<00:08,  9.63it/s] 77%|███████▋  | 275/358 [00:28<00:08,  9.68it/s] 77%|███████▋  | 276/358 [00:28<00:08,  9.68it/s] 77%|███████▋  | 277/358 [00:28<00:08,  9.65it/s] 78%|███████▊  | 278/358 [00:28<00:08,  9.63it/s] 78%|███████▊  | 280/358 [00:28<00:07,  9.82it/s] 78%|███████▊  | 281/358 [00:28<00:07,  9.83it/s] 79%|███████▉  | 282/358 [00:28<00:07,  9.77it/s] 79%|███████▉  | 283/358 [00:28<00:07,  9.71it/s] 79%|███████▉  | 284/358 [00:28<00:07,  9.67it/s] 80%|███████▉  | 285/358 [00:29<00:07,  9.74it/s] 80%|███████▉  | 286/358 [00:29<00:07,  9.70it/s] 80%|████████  | 287/358 [00:29<00:07,  9.67it/s] 80%|████████  | 288/358 [00:29<00:07,  9.63it/s] 81%|████████  | 290/358 [00:29<00:06,  9.84it/s] 81%|████████▏ | 291/358 [00:29<00:06,  9.83it/s] 82%|████████▏ | 293/358 [00:29<00:06,  9.84it/s] 82%|████████▏ | 295/358 [00:30<00:06,  9.91it/s] 83%|████████▎ | 296/358 [00:30<00:06,  9.84it/s] 83%|████████▎ | 297/358 [00:30<00:06,  9.74it/s] 84%|████████▎ | 299/358 [00:30<00:05,  9.90it/s] 84%|████████▍ | 301/358 [00:30<00:05,  9.93it/s] 84%|████████▍ | 302/358 [00:30<00:05,  9.87it/s] 85%|████████▍ | 303/358 [00:30<00:05,  9.87it/s] 85%|████████▌ | 305/358 [00:31<00:05,  9.90it/s] 85%|████████▌ | 306/358 [00:31<00:05,  9.83it/s] 86%|████████▌ | 308/358 [00:31<00:05,  9.93it/s] 86%|████████▋ | 309/358 [00:31<00:04,  9.83it/s] 87%|████████▋ | 310/358 [00:31<00:04,  9.77it/s] 87%|████████▋ | 311/358 [00:31<00:04,  9.69it/s] 87%|████████▋ | 312/358 [00:31<00:04,  9.71it/s] 87%|████████▋ | 313/358 [00:31<00:04,  9.73it/s] 88%|████████▊ | 315/358 [00:32<00:04,  9.99it/s] 88%|████████▊ | 316/358 [00:32<00:04,  9.94it/s] 89%|████████▊ | 317/358 [00:32<00:04,  9.85it/s] 89%|████████▉ | 318/358 [00:32<00:04,  9.81it/s] 89%|████████▉ | 319/358 [00:32<00:03,  9.76it/s] 89%|████████▉ | 320/358 [00:32<00:03,  9.82it/s] 90%|████████▉ | 321/358 [00:32<00:03,  9.75it/s] 90%|████████▉ | 322/358 [00:32<00:03,  9.71it/s] 90%|█████████ | 323/358 [00:32<00:03,  9.66it/s] 91%|█████████ | 324/358 [00:33<00:03,  9.63it/s] 91%|█████████ | 325/358 [00:33<00:03,  9.61it/s] 91%|█████████▏| 327/358 [00:33<00:03,  9.97it/s] 92%|█████████▏| 329/358 [00:33<00:02, 10.07it/s] 92%|█████████▏| 330/358 [00:33<00:02,  9.96it/s] 93%|█████████▎| 332/358 [00:33<00:02, 10.06it/s] 93%|█████████▎| 334/358 [00:34<00:02,  9.96it/s] 94%|█████████▎| 335/358 [00:34<00:02,  9.84it/s] 94%|█████████▍| 337/358 [00:34<00:02,  9.92it/s] 95%|█████████▍| 339/358 [00:34<00:01, 10.12it/s] 95%|█████████▌| 341/358 [00:34<00:01, 10.06it/s] 96%|█████████▌| 343/358 [00:34<00:01,  9.90it/s] 96%|█████████▌| 344/358 [00:35<00:01,  9.84it/s] 96%|█████████▋| 345/358 [00:35<00:01,  9.86it/s] 97%|█████████▋| 347/358 [00:35<00:01, 10.04it/s] 97%|█████████▋| 348/358 [00:35<00:01,  9.94it/s] 97%|█████████▋| 349/358 [00:35<00:00,  9.85it/s] 98%|█████████▊| 350/358 [00:35<00:00,  9.78it/s] 98%|█████████▊| 351/358 [00:35<00:00,  9.74it/s] 99%|█████████▊| 353/358 [00:35<00:00,  9.92it/s] 99%|█████████▉| 354/358 [00:36<00:00,  9.91it/s] 99%|█████████▉| 355/358 [00:36<00:00,  9.82it/s]100%|█████████▉| 357/358 [00:36<00:00,  9.87it/s]100%|██████████| 358/358 [00:36<00:00,  9.83it/s]
[32m2025-02-05 06:01:06.740[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    gen_loss  grad clip ratio  grad norm   ppl
       1.939                1      2.777 6.953[0m
[32m2025-02-05 06:01:06.741[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m169[0m - [1m[Valid][0m
  0%|          | 0/10256 [00:00<?, ?it/s]100%|██████████| 10256/10256 [00:00<00:00, 1090744.51it/s]
[32m2025-02-05 06:01:06.750[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:26,  1.45it/s]  5%|▌         | 2/40 [00:01<00:25,  1.46it/s]  8%|▊         | 3/40 [00:02<00:25,  1.47it/s] 10%|█         | 4/40 [00:02<00:24,  1.47it/s] 12%|█▎        | 5/40 [00:03<00:23,  1.46it/s] 15%|█▌        | 6/40 [00:04<00:23,  1.46it/s] 18%|█▊        | 7/40 [00:04<00:22,  1.46it/s] 20%|██        | 8/40 [00:05<00:21,  1.46it/s] 22%|██▎       | 9/40 [00:06<00:21,  1.46it/s] 25%|██▌       | 10/40 [00:06<00:20,  1.47it/s] 28%|██▊       | 11/40 [00:07<00:19,  1.46it/s] 30%|███       | 12/40 [00:08<00:19,  1.47it/s] 32%|███▎      | 13/40 [00:08<00:18,  1.47it/s] 35%|███▌      | 14/40 [00:09<00:17,  1.46it/s] 38%|███▊      | 15/40 [00:10<00:17,  1.46it/s] 40%|████      | 16/40 [00:10<00:16,  1.46it/s] 42%|████▎     | 17/40 [00:11<00:15,  1.46it/s] 45%|████▌     | 18/40 [00:12<00:15,  1.46it/s] 48%|████▊     | 19/40 [00:12<00:14,  1.46it/s] 50%|█████     | 20/40 [00:13<00:13,  1.47it/s] 52%|█████▎    | 21/40 [00:14<00:12,  1.47it/s] 55%|█████▌    | 22/40 [00:15<00:12,  1.47it/s] 57%|█████▊    | 23/40 [00:15<00:11,  1.47it/s] 60%|██████    | 24/40 [00:16<00:10,  1.46it/s] 62%|██████▎   | 25/40 [00:17<00:10,  1.46it/s] 65%|██████▌   | 26/40 [00:17<00:09,  1.47it/s] 68%|██████▊   | 27/40 [00:18<00:08,  1.47it/s] 70%|███████   | 28/40 [00:19<00:08,  1.47it/s] 72%|███████▎  | 29/40 [00:19<00:07,  1.47it/s] 75%|███████▌  | 30/40 [00:20<00:06,  1.48it/s] 78%|███████▊  | 31/40 [00:21<00:06,  1.47it/s] 80%|████████  | 32/40 [00:21<00:05,  1.47it/s] 82%|████████▎ | 33/40 [00:22<00:04,  1.47it/s] 85%|████████▌ | 34/40 [00:23<00:04,  1.47it/s] 88%|████████▊ | 35/40 [00:23<00:03,  1.46it/s] 90%|█████████ | 36/40 [00:24<00:02,  1.46it/s] 92%|█████████▎| 37/40 [00:25<00:02,  1.46it/s] 95%|█████████▌| 38/40 [00:25<00:01,  1.45it/s] 98%|█████████▊| 39/40 [00:26<00:00,  1.46it/s]100%|██████████| 40/40 [00:27<00:00,  1.61it/s]100%|██████████| 40/40 [00:27<00:00,  1.48it/s]
[32m2025-02-05 06:01:33.870[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    average  bleu@1  bleu@2  bleu@3  bleu@4  dist@1  dist@2  dist@3  dist@4  extreme  \
      .7714   .2980   .1085  .04169  .02104  .04868   .3153   .5877   .7381    .5937   
      f1  gen_loss  greedy  intra_dist@1  intra_dist@2  intra_dist@3  intra_dist@4  \
   .3507     4.937   .6670         .8761         .9601         .9386         .8998   
     ppl  rouge1  rouge2  rougeL  
   139.4   .3845  .09013   .3722[0m
[32m2025-02-05 06:01:33.876[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m163[0m - [1m[Conversation epoch 50][0m
[32m2025-02-05 06:01:33.876[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m164[0m - [1m[Train][0m
  0%|          | 0/92414 [00:00<?, ?it/s]100%|██████████| 92414/92414 [00:00<00:00, 998952.14it/s]
[32m2025-02-05 06:01:33.969[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/358 [00:00<?, ?it/s]  0%|          | 1/358 [00:00<00:36,  9.74it/s]  1%|          | 3/358 [00:00<00:35,  9.93it/s]  1%|          | 4/358 [00:00<00:35,  9.91it/s]  2%|▏         | 6/358 [00:00<00:35,  9.87it/s]  2%|▏         | 7/358 [00:00<00:35,  9.81it/s]  2%|▏         | 8/358 [00:00<00:35,  9.86it/s]  3%|▎         | 9/358 [00:00<00:35,  9.75it/s]  3%|▎         | 10/358 [00:01<00:35,  9.75it/s]  3%|▎         | 11/358 [00:01<00:35,  9.70it/s]  4%|▎         | 13/358 [00:01<00:34,  9.91it/s]  4%|▍         | 14/358 [00:01<00:34,  9.84it/s]  4%|▍         | 15/358 [00:01<00:35,  9.77it/s]  4%|▍         | 16/358 [00:01<00:35,  9.70it/s]  5%|▍         | 17/358 [00:01<00:35,  9.72it/s]  5%|▌         | 19/358 [00:01<00:34,  9.74it/s]  6%|▌         | 20/358 [00:02<00:34,  9.70it/s]  6%|▌         | 21/358 [00:02<00:34,  9.63it/s]  6%|▌         | 22/358 [00:02<00:34,  9.69it/s]  7%|▋         | 24/358 [00:02<00:34,  9.77it/s]  7%|▋         | 25/358 [00:02<00:34,  9.73it/s]  7%|▋         | 26/358 [00:02<00:34,  9.68it/s]  8%|▊         | 27/358 [00:02<00:34,  9.73it/s]  8%|▊         | 28/358 [00:02<00:34,  9.68it/s]  8%|▊         | 29/358 [00:02<00:34,  9.65it/s]  9%|▊         | 31/358 [00:03<00:33,  9.74it/s]  9%|▉         | 32/358 [00:03<00:33,  9.74it/s]  9%|▉         | 34/358 [00:03<00:32,  9.85it/s] 10%|█         | 36/358 [00:03<00:32,  9.85it/s] 10%|█         | 37/358 [00:03<00:32,  9.83it/s] 11%|█         | 38/358 [00:03<00:32,  9.78it/s] 11%|█         | 40/358 [00:04<00:31,  9.94it/s] 11%|█▏        | 41/358 [00:04<00:32,  9.85it/s] 12%|█▏        | 43/358 [00:04<00:31,  9.88it/s] 13%|█▎        | 45/358 [00:04<00:31,  9.98it/s] 13%|█▎        | 47/358 [00:04<00:31,  9.95it/s] 13%|█▎        | 48/358 [00:04<00:31,  9.94it/s] 14%|█▍        | 50/358 [00:05<00:31,  9.91it/s] 14%|█▍        | 51/358 [00:05<00:31,  9.84it/s] 15%|█▍        | 52/358 [00:05<00:31,  9.75it/s] 15%|█▍        | 53/358 [00:05<00:31,  9.70it/s] 15%|█▌        | 54/358 [00:05<00:31,  9.74it/s] 15%|█▌        | 55/358 [00:05<00:31,  9.69it/s] 16%|█▌        | 56/358 [00:05<00:31,  9.73it/s] 16%|█▌        | 57/358 [00:05<00:31,  9.70it/s] 16%|█▌        | 58/358 [00:05<00:31,  9.66it/s] 16%|█▋        | 59/358 [00:06<00:31,  9.63it/s] 17%|█▋        | 61/358 [00:06<00:30,  9.72it/s] 17%|█▋        | 62/358 [00:06<00:30,  9.64it/s] 18%|█▊        | 63/358 [00:06<00:30,  9.71it/s] 18%|█▊        | 64/358 [00:06<00:30,  9.67it/s] 18%|█▊        | 66/358 [00:06<00:30,  9.73it/s] 19%|█▊        | 67/358 [00:06<00:29,  9.72it/s] 19%|█▉        | 69/358 [00:07<00:29,  9.78it/s] 20%|█▉        | 70/358 [00:07<00:29,  9.73it/s] 20%|█▉        | 71/358 [00:07<00:29,  9.77it/s] 20%|██        | 72/358 [00:07<00:29,  9.72it/s] 20%|██        | 73/358 [00:07<00:29,  9.69it/s] 21%|██        | 74/358 [00:07<00:29,  9.66it/s] 21%|██        | 75/358 [00:07<00:29,  9.62it/s] 21%|██        | 76/358 [00:07<00:28,  9.73it/s] 22%|██▏       | 77/358 [00:07<00:29,  9.69it/s] 22%|██▏       | 79/358 [00:08<00:28,  9.69it/s] 23%|██▎       | 81/358 [00:08<00:28,  9.75it/s] 23%|██▎       | 83/358 [00:08<00:28,  9.78it/s] 23%|██▎       | 84/358 [00:08<00:28,  9.73it/s] 24%|██▎       | 85/358 [00:08<00:28,  9.68it/s] 24%|██▍       | 86/358 [00:08<00:28,  9.67it/s] 24%|██▍       | 87/358 [00:08<00:28,  9.65it/s] 25%|██▍       | 88/358 [00:09<00:27,  9.67it/s] 25%|██▌       | 90/358 [00:09<00:27,  9.90it/s] 26%|██▌       | 92/358 [00:09<00:26, 10.00it/s] 26%|██▌       | 93/358 [00:09<00:26,  9.97it/s] 26%|██▋       | 94/358 [00:09<00:26,  9.88it/s] 27%|██▋       | 96/358 [00:09<00:25, 10.16it/s] 27%|██▋       | 98/358 [00:10<00:25, 10.05it/s] 28%|██▊       | 99/358 [00:10<00:26,  9.96it/s] 28%|██▊       | 101/358 [00:10<00:25,  9.93it/s] 29%|██▉       | 103/358 [00:10<00:25,  9.91it/s] 29%|██▉       | 104/358 [00:10<00:25,  9.86it/s] 29%|██▉       | 105/358 [00:10<00:25,  9.78it/s] 30%|██▉       | 106/358 [00:10<00:25,  9.77it/s] 30%|███       | 108/358 [00:11<00:25,  9.80it/s] 30%|███       | 109/358 [00:11<00:25,  9.71it/s] 31%|███       | 110/358 [00:11<00:25,  9.70it/s] 31%|███       | 111/358 [00:11<00:25,  9.65it/s] 32%|███▏      | 113/358 [00:11<00:24,  9.91it/s] 32%|███▏      | 114/358 [00:11<00:24,  9.87it/s] 32%|███▏      | 115/358 [00:11<00:24,  9.78it/s] 32%|███▏      | 116/358 [00:11<00:24,  9.69it/s] 33%|███▎      | 117/358 [00:11<00:24,  9.66it/s] 33%|███▎      | 119/358 [00:12<00:24,  9.79it/s] 34%|███▍      | 121/358 [00:12<00:23,  9.98it/s] 34%|███▍      | 123/358 [00:12<00:23, 10.08it/s] 35%|███▍      | 125/358 [00:12<00:23, 10.06it/s] 35%|███▌      | 127/358 [00:12<00:23,  9.98it/s] 36%|███▌      | 128/358 [00:13<00:23,  9.94it/s] 36%|███▋      | 130/358 [00:13<00:22,  9.99it/s] 37%|███▋      | 131/358 [00:13<00:22,  9.90it/s] 37%|███▋      | 132/358 [00:13<00:22,  9.92it/s] 37%|███▋      | 134/358 [00:13<00:22,  9.94it/s] 38%|███▊      | 135/358 [00:13<00:22,  9.88it/s] 38%|███▊      | 137/358 [00:13<00:22,  9.96it/s] 39%|███▊      | 138/358 [00:14<00:22,  9.94it/s] 39%|███▉      | 139/358 [00:14<00:22,  9.86it/s] 39%|███▉      | 141/358 [00:14<00:21,  9.98it/s] 40%|███▉      | 142/358 [00:14<00:21,  9.90it/s] 40%|███▉      | 143/358 [00:14<00:21,  9.87it/s] 40%|████      | 144/358 [00:14<00:21,  9.78it/s] 41%|████      | 145/358 [00:14<00:21,  9.80it/s] 41%|████      | 146/358 [00:14<00:21,  9.74it/s] 41%|████      | 147/358 [00:14<00:21,  9.68it/s] 41%|████▏     | 148/358 [00:15<00:21,  9.71it/s] 42%|████▏     | 149/358 [00:15<00:21,  9.69it/s] 42%|████▏     | 150/358 [00:15<00:21,  9.65it/s] 42%|████▏     | 151/358 [00:15<00:22,  9.38it/s] 42%|████▏     | 152/358 [00:15<00:21,  9.43it/s] 43%|████▎     | 153/358 [00:15<00:21,  9.45it/s] 43%|████▎     | 154/358 [00:15<00:21,  9.54it/s] 43%|████▎     | 155/358 [00:15<00:21,  9.55it/s] 44%|████▎     | 156/358 [00:15<00:20,  9.68it/s] 44%|████▍     | 157/358 [00:16<00:20,  9.62it/s] 44%|████▍     | 158/358 [00:16<00:20,  9.71it/s] 44%|████▍     | 159/358 [00:16<00:20,  9.70it/s] 45%|████▍     | 160/358 [00:16<00:20,  9.70it/s] 45%|████▌     | 162/358 [00:16<00:19, 10.00it/s] 46%|████▌     | 164/358 [00:16<00:19, 10.00it/s] 46%|████▌     | 165/358 [00:16<00:19,  9.96it/s] 47%|████▋     | 167/358 [00:17<00:19,  9.90it/s] 47%|████▋     | 169/358 [00:17<00:19,  9.95it/s] 48%|████▊     | 171/358 [00:17<00:18,  9.93it/s] 48%|████▊     | 172/358 [00:17<00:18,  9.88it/s] 48%|████▊     | 173/358 [00:17<00:18,  9.81it/s] 49%|████▉     | 175/358 [00:17<00:18,  9.84it/s] 49%|████▉     | 176/358 [00:17<00:18,  9.85it/s] 49%|████▉     | 177/358 [00:18<00:18,  9.84it/s] 50%|█████     | 179/358 [00:18<00:18,  9.86it/s] 50%|█████     | 180/358 [00:18<00:18,  9.79it/s] 51%|█████     | 182/358 [00:18<00:17,  9.94it/s] 51%|█████     | 183/358 [00:18<00:17,  9.89it/s] 51%|█████▏    | 184/358 [00:18<00:17,  9.78it/s] 52%|█████▏    | 185/358 [00:18<00:17,  9.72it/s] 52%|█████▏    | 187/358 [00:19<00:17,  9.94it/s] 53%|█████▎    | 188/358 [00:19<00:17,  9.89it/s] 53%|█████▎    | 189/358 [00:19<00:17,  9.83it/s] 53%|█████▎    | 191/358 [00:19<00:17,  9.75it/s] 54%|█████▎    | 192/358 [00:19<00:17,  9.70it/s] 54%|█████▍    | 193/358 [00:19<00:17,  9.69it/s] 54%|█████▍    | 194/358 [00:19<00:16,  9.67it/s] 54%|█████▍    | 195/358 [00:19<00:16,  9.74it/s] 55%|█████▌    | 197/358 [00:20<00:16,  9.91it/s] 55%|█████▌    | 198/358 [00:20<00:16,  9.84it/s] 56%|█████▌    | 199/358 [00:20<00:16,  9.87it/s] 56%|█████▌    | 200/358 [00:20<00:16,  9.81it/s] 56%|█████▌    | 201/358 [00:20<00:16,  9.77it/s] 57%|█████▋    | 203/358 [00:20<00:15,  9.85it/s] 57%|█████▋    | 204/358 [00:20<00:15,  9.75it/s] 57%|█████▋    | 205/358 [00:20<00:15,  9.71it/s] 58%|█████▊    | 207/358 [00:21<00:15,  9.87it/s] 58%|█████▊    | 208/358 [00:21<00:15,  9.80it/s] 59%|█████▊    | 210/358 [00:21<00:15,  9.82it/s] 59%|█████▉    | 212/358 [00:21<00:14,  9.81it/s] 60%|█████▉    | 214/358 [00:21<00:14,  9.89it/s] 60%|██████    | 215/358 [00:21<00:14,  9.83it/s] 60%|██████    | 216/358 [00:22<00:14,  9.77it/s] 61%|██████    | 217/358 [00:22<00:14,  9.80it/s] 61%|██████    | 218/358 [00:22<00:14,  9.77it/s] 61%|██████    | 219/358 [00:22<00:14,  9.77it/s] 62%|██████▏   | 221/358 [00:22<00:13,  9.90it/s] 62%|██████▏   | 222/358 [00:22<00:13,  9.80it/s] 62%|██████▏   | 223/358 [00:22<00:13,  9.74it/s] 63%|██████▎   | 224/358 [00:22<00:13,  9.69it/s] 63%|██████▎   | 225/358 [00:22<00:13,  9.77it/s] 63%|██████▎   | 226/358 [00:23<00:13,  9.71it/s] 64%|██████▎   | 228/358 [00:23<00:13,  9.75it/s] 64%|██████▍   | 229/358 [00:23<00:13,  9.73it/s] 64%|██████▍   | 230/358 [00:23<00:13,  9.67it/s] 65%|██████▍   | 232/358 [00:23<00:12,  9.73it/s] 65%|██████▌   | 234/358 [00:23<00:12, 10.02it/s] 66%|██████▌   | 236/358 [00:24<00:12,  9.98it/s] 66%|██████▋   | 238/358 [00:24<00:11, 10.03it/s] 67%|██████▋   | 240/358 [00:24<00:11,  9.99it/s] 68%|██████▊   | 242/358 [00:24<00:11,  9.97it/s] 68%|██████▊   | 243/358 [00:24<00:11,  9.91it/s] 68%|██████▊   | 244/358 [00:24<00:11,  9.85it/s] 69%|██████▊   | 246/358 [00:25<00:11,  9.87it/s] 69%|██████▉   | 247/358 [00:25<00:11,  9.80it/s] 69%|██████▉   | 248/358 [00:25<00:11,  9.76it/s] 70%|██████▉   | 250/358 [00:25<00:10,  9.85it/s] 70%|███████   | 251/358 [00:25<00:10,  9.79it/s] 70%|███████   | 252/358 [00:25<00:10,  9.73it/s] 71%|███████   | 253/358 [00:25<00:10,  9.68it/s] 71%|███████   | 254/358 [00:25<00:10,  9.66it/s] 72%|███████▏  | 256/358 [00:26<00:10,  9.83it/s] 72%|███████▏  | 257/358 [00:26<00:10,  9.84it/s] 72%|███████▏  | 258/358 [00:26<00:10,  9.71it/s] 72%|███████▏  | 259/358 [00:26<00:10,  9.68it/s] 73%|███████▎  | 260/358 [00:26<00:10,  9.72it/s] 73%|███████▎  | 262/358 [00:26<00:09,  9.90it/s] 74%|███████▎  | 264/358 [00:26<00:09,  9.92it/s] 74%|███████▍  | 266/358 [00:27<00:09,  9.91it/s] 75%|███████▍  | 267/358 [00:27<00:09,  9.84it/s] 75%|███████▌  | 269/358 [00:27<00:08,  9.90it/s] 75%|███████▌  | 270/358 [00:27<00:08,  9.83it/s] 76%|███████▌  | 271/358 [00:27<00:08,  9.76it/s] 76%|███████▌  | 272/358 [00:27<00:08,  9.74it/s] 76%|███████▋  | 273/358 [00:27<00:08,  9.64it/s] 77%|███████▋  | 274/358 [00:27<00:08,  9.63it/s] 77%|███████▋  | 275/358 [00:28<00:08,  9.68it/s] 77%|███████▋  | 276/358 [00:28<00:08,  9.68it/s] 77%|███████▋  | 277/358 [00:28<00:08,  9.65it/s] 78%|███████▊  | 278/358 [00:28<00:08,  9.63it/s] 78%|███████▊  | 280/358 [00:28<00:07,  9.82it/s] 78%|███████▊  | 281/358 [00:28<00:07,  9.83it/s] 79%|███████▉  | 282/358 [00:28<00:07,  9.78it/s] 79%|███████▉  | 283/358 [00:28<00:07,  9.71it/s] 79%|███████▉  | 284/358 [00:28<00:07,  9.67it/s] 80%|███████▉  | 285/358 [00:29<00:07,  9.74it/s] 80%|███████▉  | 286/358 [00:29<00:07,  9.70it/s] 80%|████████  | 287/358 [00:29<00:07,  9.67it/s] 80%|████████  | 288/358 [00:29<00:07,  9.63it/s] 81%|████████  | 290/358 [00:29<00:06,  9.84it/s] 81%|████████▏ | 291/358 [00:29<00:06,  9.83it/s] 82%|████████▏ | 293/358 [00:29<00:06,  9.84it/s] 82%|████████▏ | 295/358 [00:30<00:06,  9.91it/s] 83%|████████▎ | 296/358 [00:30<00:06,  9.85it/s] 83%|████████▎ | 297/358 [00:30<00:06,  9.74it/s] 84%|████████▎ | 299/358 [00:30<00:05,  9.90it/s] 84%|████████▍ | 301/358 [00:30<00:05,  9.94it/s] 84%|████████▍ | 302/358 [00:30<00:05,  9.87it/s] 85%|████████▍ | 303/358 [00:30<00:05,  9.88it/s] 85%|████████▌ | 305/358 [00:31<00:05,  9.91it/s] 85%|████████▌ | 306/358 [00:31<00:05,  9.83it/s] 86%|████████▌ | 308/358 [00:31<00:05,  9.93it/s] 86%|████████▋ | 309/358 [00:31<00:04,  9.83it/s] 87%|████████▋ | 310/358 [00:31<00:04,  9.77it/s] 87%|████████▋ | 311/358 [00:31<00:04,  9.69it/s] 87%|████████▋ | 312/358 [00:31<00:04,  9.71it/s] 87%|████████▋ | 313/358 [00:31<00:04,  9.73it/s] 88%|████████▊ | 315/358 [00:32<00:04,  9.99it/s] 88%|████████▊ | 316/358 [00:32<00:04,  9.94it/s] 89%|████████▊ | 317/358 [00:32<00:04,  9.85it/s] 89%|████████▉ | 318/358 [00:32<00:04,  9.81it/s] 89%|████████▉ | 319/358 [00:32<00:03,  9.76it/s] 89%|████████▉ | 320/358 [00:32<00:03,  9.82it/s] 90%|████████▉ | 321/358 [00:32<00:03,  9.75it/s] 90%|████████▉ | 322/358 [00:32<00:03,  9.71it/s] 90%|█████████ | 323/358 [00:32<00:03,  9.66it/s] 91%|█████████ | 324/358 [00:33<00:03,  9.63it/s] 91%|█████████ | 325/358 [00:33<00:03,  9.61it/s] 91%|█████████▏| 327/358 [00:33<00:03,  9.97it/s] 92%|█████████▏| 329/358 [00:33<00:02, 10.07it/s] 92%|█████████▏| 330/358 [00:33<00:02,  9.96it/s] 93%|█████████▎| 332/358 [00:33<00:02, 10.06it/s] 93%|█████████▎| 334/358 [00:34<00:02,  9.96it/s] 94%|█████████▎| 335/358 [00:34<00:02,  9.84it/s] 94%|█████████▍| 337/358 [00:34<00:02,  9.92it/s] 95%|█████████▍| 339/358 [00:34<00:01, 10.12it/s] 95%|█████████▌| 341/358 [00:34<00:01, 10.06it/s] 96%|█████████▌| 343/358 [00:34<00:01,  9.90it/s] 96%|█████████▌| 344/358 [00:35<00:01,  9.84it/s] 96%|█████████▋| 345/358 [00:35<00:01,  9.86it/s] 97%|█████████▋| 347/358 [00:35<00:01, 10.04it/s] 97%|█████████▋| 348/358 [00:35<00:01,  9.94it/s] 97%|█████████▋| 349/358 [00:35<00:00,  9.86it/s] 98%|█████████▊| 350/358 [00:35<00:00,  9.79it/s] 98%|█████████▊| 351/358 [00:35<00:00,  9.75it/s] 99%|█████████▊| 353/358 [00:35<00:00,  9.93it/s] 99%|█████████▉| 354/358 [00:36<00:00,  9.91it/s] 99%|█████████▉| 355/358 [00:36<00:00,  9.82it/s]100%|█████████▉| 357/358 [00:36<00:00,  9.87it/s]100%|██████████| 358/358 [00:36<00:00,  9.83it/s]
[32m2025-02-05 06:02:10.407[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    gen_loss  grad clip ratio  grad norm   ppl
        1.93                1       2.95 6.891[0m
[32m2025-02-05 06:02:10.407[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m169[0m - [1m[Valid][0m
  0%|          | 0/10256 [00:00<?, ?it/s]100%|██████████| 10256/10256 [00:00<00:00, 1113703.09it/s]
[32m2025-02-05 06:02:10.417[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:27,  1.43it/s]  5%|▌         | 2/40 [00:01<00:26,  1.44it/s]  8%|▊         | 3/40 [00:02<00:25,  1.46it/s] 10%|█         | 4/40 [00:02<00:24,  1.46it/s] 12%|█▎        | 5/40 [00:03<00:24,  1.45it/s] 15%|█▌        | 6/40 [00:04<00:23,  1.45it/s] 18%|█▊        | 7/40 [00:04<00:22,  1.45it/s] 20%|██        | 8/40 [00:05<00:21,  1.46it/s] 22%|██▎       | 9/40 [00:06<00:21,  1.46it/s] 25%|██▌       | 10/40 [00:06<00:20,  1.46it/s] 28%|██▊       | 11/40 [00:07<00:19,  1.46it/s] 30%|███       | 12/40 [00:08<00:19,  1.46it/s] 32%|███▎      | 13/40 [00:08<00:18,  1.46it/s] 35%|███▌      | 14/40 [00:09<00:17,  1.45it/s] 38%|███▊      | 15/40 [00:10<00:17,  1.45it/s] 40%|████      | 16/40 [00:11<00:16,  1.45it/s] 42%|████▎     | 17/40 [00:11<00:15,  1.45it/s] 45%|████▌     | 18/40 [00:12<00:15,  1.46it/s] 48%|████▊     | 19/40 [00:13<00:14,  1.45it/s] 50%|█████     | 20/40 [00:13<00:13,  1.46it/s] 52%|█████▎    | 21/40 [00:14<00:12,  1.47it/s] 55%|█████▌    | 22/40 [00:15<00:12,  1.46it/s] 57%|█████▊    | 23/40 [00:15<00:11,  1.46it/s] 60%|██████    | 24/40 [00:16<00:11,  1.45it/s] 62%|██████▎   | 25/40 [00:17<00:10,  1.45it/s] 65%|██████▌   | 26/40 [00:17<00:09,  1.46it/s] 68%|██████▊   | 27/40 [00:18<00:08,  1.46it/s] 70%|███████   | 28/40 [00:19<00:08,  1.46it/s] 72%|███████▎  | 29/40 [00:19<00:07,  1.46it/s] 75%|███████▌  | 30/40 [00:20<00:06,  1.47it/s] 78%|███████▊  | 31/40 [00:21<00:06,  1.47it/s] 80%|████████  | 32/40 [00:21<00:05,  1.47it/s] 82%|████████▎ | 33/40 [00:22<00:04,  1.46it/s] 85%|████████▌ | 34/40 [00:23<00:04,  1.47it/s] 88%|████████▊ | 35/40 [00:24<00:03,  1.46it/s] 90%|█████████ | 36/40 [00:24<00:02,  1.46it/s] 92%|█████████▎| 37/40 [00:25<00:02,  1.46it/s] 95%|█████████▌| 38/40 [00:26<00:01,  1.45it/s] 98%|█████████▊| 39/40 [00:26<00:00,  1.45it/s]100%|██████████| 40/40 [00:27<00:00,  1.60it/s]100%|██████████| 40/40 [00:27<00:00,  1.47it/s]
[32m2025-02-05 06:02:37.674[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    average  bleu@1  bleu@2  bleu@3  bleu@4  dist@1  dist@2  dist@3  dist@4  extreme  \
      .7754   .2982   .1112  .04335  .02263  .04436   .2923   .5654   .7288    .5968   
      f1  gen_loss  greedy  intra_dist@1  intra_dist@2  intra_dist@3  intra_dist@4  \
   .3529     4.948   .6682         .8646         .9605         .9477         .9108   
     ppl  rouge1  rouge2  rougeL  
   140.9   .3870  .09154   .3745[0m
[32m2025-02-05 06:02:37.680[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m163[0m - [1m[Conversation epoch 51][0m
[32m2025-02-05 06:02:37.680[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m164[0m - [1m[Train][0m
  0%|          | 0/92414 [00:00<?, ?it/s]100%|██████████| 92414/92414 [00:00<00:00, 999578.13it/s]
[32m2025-02-05 06:02:37.773[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/358 [00:00<?, ?it/s]  0%|          | 1/358 [00:00<00:36,  9.75it/s]  1%|          | 3/358 [00:00<00:35,  9.94it/s]  1%|          | 4/358 [00:00<00:35,  9.92it/s]  2%|▏         | 6/358 [00:00<00:35,  9.89it/s]  2%|▏         | 7/358 [00:00<00:35,  9.82it/s]  2%|▏         | 8/358 [00:00<00:35,  9.86it/s]  3%|▎         | 9/358 [00:00<00:35,  9.76it/s]  3%|▎         | 10/358 [00:01<00:35,  9.75it/s]  3%|▎         | 11/358 [00:01<00:35,  9.70it/s]  4%|▎         | 13/358 [00:01<00:34,  9.92it/s]  4%|▍         | 14/358 [00:01<00:34,  9.85it/s]  4%|▍         | 15/358 [00:01<00:35,  9.77it/s]  4%|▍         | 16/358 [00:01<00:35,  9.71it/s]  5%|▍         | 17/358 [00:01<00:35,  9.72it/s]  5%|▌         | 19/358 [00:01<00:34,  9.75it/s]  6%|▌         | 20/358 [00:02<00:34,  9.70it/s]  6%|▌         | 21/358 [00:02<00:34,  9.64it/s]  6%|▌         | 22/358 [00:02<00:34,  9.69it/s]  7%|▋         | 24/358 [00:02<00:34,  9.78it/s]  7%|▋         | 25/358 [00:02<00:34,  9.73it/s]  7%|▋         | 26/358 [00:02<00:34,  9.68it/s]  8%|▊         | 27/358 [00:02<00:34,  9.73it/s]  8%|▊         | 28/358 [00:02<00:34,  9.68it/s]  8%|▊         | 29/358 [00:02<00:34,  9.65it/s]  9%|▊         | 31/358 [00:03<00:33,  9.75it/s]  9%|▉         | 32/358 [00:03<00:33,  9.75it/s]  9%|▉         | 34/358 [00:03<00:32,  9.85it/s] 10%|█         | 36/358 [00:03<00:32,  9.85it/s] 10%|█         | 37/358 [00:03<00:32,  9.83it/s] 11%|█         | 38/358 [00:03<00:32,  9.79it/s] 11%|█         | 40/358 [00:04<00:31,  9.94it/s] 11%|█▏        | 41/358 [00:04<00:32,  9.86it/s] 12%|█▏        | 43/358 [00:04<00:31,  9.88it/s] 13%|█▎        | 45/358 [00:04<00:31,  9.98it/s] 13%|█▎        | 47/358 [00:04<00:31,  9.95it/s] 13%|█▎        | 48/358 [00:04<00:31,  9.94it/s] 14%|█▍        | 50/358 [00:05<00:31,  9.91it/s] 14%|█▍        | 51/358 [00:05<00:31,  9.84it/s] 15%|█▍        | 52/358 [00:05<00:31,  9.75it/s] 15%|█▍        | 53/358 [00:05<00:31,  9.70it/s] 15%|█▌        | 54/358 [00:05<00:31,  9.74it/s] 15%|█▌        | 55/358 [00:05<00:31,  9.69it/s] 16%|█▌        | 56/358 [00:05<00:31,  9.73it/s] 16%|█▌        | 57/358 [00:05<00:31,  9.69it/s] 16%|█▌        | 58/358 [00:05<00:31,  9.67it/s] 16%|█▋        | 59/358 [00:06<00:31,  9.64it/s] 17%|█▋        | 61/358 [00:06<00:30,  9.72it/s] 17%|█▋        | 62/358 [00:06<00:30,  9.65it/s] 18%|█▊        | 63/358 [00:06<00:30,  9.71it/s] 18%|█▊        | 64/358 [00:06<00:30,  9.66it/s] 18%|█▊        | 66/358 [00:06<00:30,  9.73it/s] 19%|█▊        | 67/358 [00:06<00:29,  9.71it/s] 19%|█▉        | 69/358 [00:07<00:29,  9.78it/s] 20%|█▉        | 70/358 [00:07<00:29,  9.73it/s] 20%|█▉        | 71/358 [00:07<00:29,  9.77it/s] 20%|██        | 72/358 [00:07<00:29,  9.72it/s] 20%|██        | 73/358 [00:07<00:29,  9.68it/s] 21%|██        | 74/358 [00:07<00:29,  9.65it/s] 21%|██        | 75/358 [00:07<00:29,  9.62it/s] 21%|██        | 76/358 [00:07<00:28,  9.73it/s] 22%|██▏       | 77/358 [00:07<00:29,  9.69it/s] 22%|██▏       | 79/358 [00:08<00:28,  9.70it/s] 23%|██▎       | 81/358 [00:08<00:28,  9.76it/s] 23%|██▎       | 83/358 [00:08<00:28,  9.78it/s] 23%|██▎       | 84/358 [00:08<00:28,  9.73it/s] 24%|██▎       | 85/358 [00:08<00:28,  9.69it/s] 24%|██▍       | 86/358 [00:08<00:28,  9.67it/s] 24%|██▍       | 87/358 [00:08<00:28,  9.65it/s] 25%|██▍       | 88/358 [00:09<00:27,  9.67it/s] 25%|██▌       | 90/358 [00:09<00:27,  9.91it/s] 26%|██▌       | 92/358 [00:09<00:26, 10.01it/s] 26%|██▌       | 93/358 [00:09<00:26,  9.97it/s] 26%|██▋       | 94/358 [00:09<00:26,  9.88it/s] 27%|██▋       | 96/358 [00:09<00:25, 10.16it/s] 27%|██▋       | 98/358 [00:10<00:25, 10.05it/s] 28%|██▊       | 99/358 [00:10<00:26,  9.96it/s] 28%|██▊       | 101/358 [00:10<00:25,  9.92it/s] 29%|██▉       | 103/358 [00:10<00:25,  9.91it/s] 29%|██▉       | 104/358 [00:10<00:25,  9.87it/s] 29%|██▉       | 105/358 [00:10<00:25,  9.79it/s] 30%|██▉       | 106/358 [00:10<00:25,  9.77it/s] 30%|███       | 108/358 [00:11<00:25,  9.80it/s] 30%|███       | 109/358 [00:11<00:25,  9.72it/s] 31%|███       | 110/358 [00:11<00:25,  9.70it/s] 31%|███       | 111/358 [00:11<00:25,  9.65it/s] 32%|███▏      | 113/358 [00:11<00:24,  9.92it/s] 32%|███▏      | 114/358 [00:11<00:24,  9.88it/s] 32%|███▏      | 115/358 [00:11<00:24,  9.78it/s] 32%|███▏      | 116/358 [00:11<00:24,  9.70it/s] 33%|███▎      | 117/358 [00:11<00:24,  9.67it/s] 33%|███▎      | 119/358 [00:12<00:24,  9.79it/s] 34%|███▍      | 121/358 [00:12<00:23,  9.99it/s] 34%|███▍      | 123/358 [00:12<00:23, 10.09it/s] 35%|███▍      | 125/358 [00:12<00:23, 10.06it/s] 35%|███▌      | 127/358 [00:12<00:23,  9.99it/s] 36%|███▌      | 128/358 [00:13<00:23,  9.95it/s] 36%|███▋      | 130/358 [00:13<00:22, 10.00it/s] 37%|███▋      | 131/358 [00:13<00:22,  9.90it/s] 37%|███▋      | 132/358 [00:13<00:22,  9.92it/s] 37%|███▋      | 134/358 [00:13<00:22,  9.94it/s] 38%|███▊      | 135/358 [00:13<00:22,  9.88it/s] 38%|███▊      | 137/358 [00:13<00:22,  9.97it/s] 39%|███▊      | 138/358 [00:14<00:22,  9.95it/s] 39%|███▉      | 139/358 [00:14<00:22,  9.86it/s] 39%|███▉      | 141/358 [00:14<00:21,  9.98it/s] 40%|███▉      | 142/358 [00:14<00:21,  9.91it/s] 40%|███▉      | 143/358 [00:14<00:21,  9.87it/s] 40%|████      | 144/358 [00:14<00:21,  9.78it/s] 41%|████      | 145/358 [00:14<00:21,  9.80it/s] 41%|████      | 146/358 [00:14<00:21,  9.74it/s] 41%|████      | 147/358 [00:14<00:21,  9.68it/s] 41%|████▏     | 148/358 [00:15<00:21,  9.71it/s] 42%|████▏     | 149/358 [00:15<00:21,  9.70it/s] 42%|████▏     | 150/358 [00:15<00:21,  9.66it/s] 42%|████▏     | 151/358 [00:15<00:22,  9.39it/s] 42%|████▏     | 152/358 [00:15<00:21,  9.44it/s] 43%|████▎     | 153/358 [00:15<00:21,  9.46it/s] 43%|████▎     | 154/358 [00:15<00:21,  9.55it/s] 43%|████▎     | 155/358 [00:15<00:21,  9.56it/s] 44%|████▎     | 156/358 [00:15<00:20,  9.68it/s] 44%|████▍     | 157/358 [00:16<00:20,  9.62it/s] 44%|████▍     | 158/358 [00:16<00:20,  9.71it/s] 44%|████▍     | 159/358 [00:16<00:20,  9.71it/s] 45%|████▍     | 160/358 [00:16<00:20,  9.71it/s] 45%|████▌     | 162/358 [00:16<00:19, 10.01it/s] 46%|████▌     | 164/358 [00:16<00:19, 10.01it/s] 46%|████▌     | 165/358 [00:16<00:19,  9.96it/s] 47%|████▋     | 167/358 [00:17<00:19,  9.91it/s] 47%|████▋     | 169/358 [00:17<00:19,  9.94it/s] 48%|████▊     | 171/358 [00:17<00:18,  9.93it/s] 48%|████▊     | 172/358 [00:17<00:18,  9.87it/s] 48%|████▊     | 173/358 [00:17<00:18,  9.81it/s] 49%|████▉     | 175/358 [00:17<00:18,  9.84it/s] 49%|████▉     | 176/358 [00:17<00:18,  9.85it/s] 49%|████▉     | 177/358 [00:18<00:18,  9.83it/s] 50%|█████     | 179/358 [00:18<00:18,  9.85it/s] 50%|█████     | 180/358 [00:18<00:18,  9.78it/s] 51%|█████     | 182/358 [00:18<00:17,  9.93it/s] 51%|█████     | 183/358 [00:18<00:17,  9.88it/s] 51%|█████▏    | 184/358 [00:18<00:17,  9.77it/s] 52%|█████▏    | 185/358 [00:18<00:17,  9.72it/s] 52%|█████▏    | 187/358 [00:19<00:17,  9.93it/s] 53%|█████▎    | 188/358 [00:19<00:17,  9.88it/s] 53%|█████▎    | 189/358 [00:19<00:17,  9.83it/s] 53%|█████▎    | 191/358 [00:19<00:17,  9.75it/s] 54%|█████▎    | 192/358 [00:19<00:17,  9.69it/s] 54%|█████▍    | 193/358 [00:19<00:17,  9.69it/s] 54%|█████▍    | 194/358 [00:19<00:16,  9.67it/s] 54%|█████▍    | 195/358 [00:19<00:16,  9.74it/s] 55%|█████▌    | 197/358 [00:20<00:16,  9.92it/s] 55%|█████▌    | 198/358 [00:20<00:16,  9.84it/s] 56%|█████▌    | 199/358 [00:20<00:16,  9.87it/s] 56%|█████▌    | 200/358 [00:20<00:16,  9.80it/s] 56%|█████▌    | 201/358 [00:20<00:16,  9.76it/s] 57%|█████▋    | 203/358 [00:20<00:15,  9.85it/s] 57%|█████▋    | 204/358 [00:20<00:15,  9.75it/s] 57%|█████▋    | 205/358 [00:20<00:15,  9.71it/s] 58%|█████▊    | 207/358 [00:21<00:15,  9.88it/s] 58%|█████▊    | 208/358 [00:21<00:15,  9.80it/s] 59%|█████▊    | 210/358 [00:21<00:15,  9.82it/s] 59%|█████▉    | 212/358 [00:21<00:14,  9.81it/s] 60%|█████▉    | 214/358 [00:21<00:14,  9.90it/s] 60%|██████    | 215/358 [00:21<00:14,  9.83it/s] 60%|██████    | 216/358 [00:22<00:14,  9.77it/s] 61%|██████    | 217/358 [00:22<00:14,  9.80it/s] 61%|██████    | 218/358 [00:22<00:14,  9.77it/s] 61%|██████    | 219/358 [00:22<00:14,  9.78it/s] 62%|██████▏   | 221/358 [00:22<00:13,  9.91it/s] 62%|██████▏   | 222/358 [00:22<00:13,  9.81it/s] 62%|██████▏   | 223/358 [00:22<00:13,  9.75it/s] 63%|██████▎   | 224/358 [00:22<00:13,  9.69it/s] 63%|██████▎   | 226/358 [00:23<00:13,  9.74it/s] 64%|██████▎   | 228/358 [00:23<00:13,  9.77it/s] 64%|██████▍   | 229/358 [00:23<00:13,  9.74it/s] 64%|██████▍   | 230/358 [00:23<00:13,  9.69it/s] 65%|██████▍   | 232/358 [00:23<00:12,  9.74it/s] 65%|██████▌   | 234/358 [00:23<00:12, 10.02it/s] 66%|██████▌   | 236/358 [00:24<00:12,  9.98it/s] 66%|██████▋   | 238/358 [00:24<00:11, 10.03it/s] 67%|██████▋   | 240/358 [00:24<00:11, 10.00it/s] 68%|██████▊   | 242/358 [00:24<00:11,  9.98it/s] 68%|██████▊   | 243/358 [00:24<00:11,  9.92it/s] 68%|██████▊   | 244/358 [00:24<00:11,  9.85it/s] 69%|██████▊   | 246/358 [00:25<00:11,  9.87it/s] 69%|██████▉   | 247/358 [00:25<00:11,  9.80it/s] 69%|██████▉   | 248/358 [00:25<00:11,  9.76it/s] 70%|██████▉   | 250/358 [00:25<00:10,  9.85it/s] 70%|███████   | 251/358 [00:25<00:10,  9.79it/s] 70%|███████   | 252/358 [00:25<00:10,  9.73it/s] 71%|███████   | 253/358 [00:25<00:10,  9.69it/s] 71%|███████   | 254/358 [00:25<00:10,  9.66it/s] 72%|███████▏  | 256/358 [00:26<00:10,  9.84it/s] 72%|███████▏  | 257/358 [00:26<00:10,  9.84it/s] 72%|███████▏  | 258/358 [00:26<00:10,  9.72it/s] 72%|███████▏  | 259/358 [00:26<00:10,  9.68it/s] 73%|███████▎  | 260/358 [00:26<00:10,  9.72it/s] 73%|███████▎  | 262/358 [00:26<00:09,  9.89it/s] 74%|███████▎  | 264/358 [00:26<00:09,  9.91it/s] 74%|███████▍  | 266/358 [00:27<00:09,  9.90it/s] 75%|███████▍  | 267/358 [00:27<00:09,  9.83it/s] 75%|███████▌  | 269/358 [00:27<00:08,  9.89it/s] 75%|███████▌  | 270/358 [00:27<00:08,  9.82it/s] 76%|███████▌  | 271/358 [00:27<00:08,  9.75it/s] 76%|███████▌  | 272/358 [00:27<00:08,  9.73it/s] 76%|███████▋  | 273/358 [00:27<00:08,  9.63it/s] 77%|███████▋  | 274/358 [00:27<00:08,  9.63it/s] 77%|███████▋  | 275/358 [00:28<00:08,  9.67it/s] 77%|███████▋  | 276/358 [00:28<00:08,  9.68it/s] 77%|███████▋  | 277/358 [00:28<00:08,  9.65it/s] 78%|███████▊  | 278/358 [00:28<00:08,  9.63it/s] 78%|███████▊  | 280/358 [00:28<00:07,  9.82it/s] 78%|███████▊  | 281/358 [00:28<00:07,  9.83it/s] 79%|███████▉  | 282/358 [00:28<00:07,  9.77it/s] 79%|███████▉  | 283/358 [00:28<00:07,  9.71it/s] 79%|███████▉  | 284/358 [00:28<00:07,  9.67it/s] 80%|███████▉  | 285/358 [00:29<00:07,  9.74it/s] 80%|███████▉  | 286/358 [00:29<00:07,  9.69it/s] 80%|████████  | 287/358 [00:29<00:07,  9.67it/s] 80%|████████  | 288/358 [00:29<00:07,  9.63it/s] 81%|████████  | 290/358 [00:29<00:06,  9.84it/s] 81%|████████▏ | 291/358 [00:29<00:06,  9.82it/s] 82%|████████▏ | 293/358 [00:29<00:06,  9.84it/s] 82%|████████▏ | 295/358 [00:30<00:06,  9.91it/s] 83%|████████▎ | 296/358 [00:30<00:06,  9.84it/s] 83%|████████▎ | 297/358 [00:30<00:06,  9.73it/s] 84%|████████▎ | 299/358 [00:30<00:05,  9.90it/s] 84%|████████▍ | 301/358 [00:30<00:05,  9.93it/s] 84%|████████▍ | 302/358 [00:30<00:05,  9.87it/s] 85%|████████▍ | 303/358 [00:30<00:05,  9.87it/s] 85%|████████▌ | 305/358 [00:31<00:05,  9.90it/s] 85%|████████▌ | 306/358 [00:31<00:05,  9.82it/s] 86%|████████▌ | 308/358 [00:31<00:05,  9.92it/s] 86%|████████▋ | 309/358 [00:31<00:04,  9.82it/s] 87%|████████▋ | 310/358 [00:31<00:04,  9.77it/s] 87%|████████▋ | 311/358 [00:31<00:04,  9.69it/s] 87%|████████▋ | 312/358 [00:31<00:04,  9.71it/s] 87%|████████▋ | 313/358 [00:31<00:04,  9.73it/s] 88%|████████▊ | 315/358 [00:32<00:04,  9.99it/s] 88%|████████▊ | 316/358 [00:32<00:04,  9.93it/s] 89%|████████▊ | 317/358 [00:32<00:04,  9.83it/s] 89%|████████▉ | 318/358 [00:32<00:04,  9.78it/s] 89%|████████▉ | 319/358 [00:32<00:04,  9.74it/s] 89%|████████▉ | 320/358 [00:32<00:03,  9.81it/s] 90%|████████▉ | 321/358 [00:32<00:03,  9.73it/s] 90%|████████▉ | 322/358 [00:32<00:03,  9.70it/s] 90%|█████████ | 323/358 [00:32<00:03,  9.65it/s] 91%|█████████ | 324/358 [00:33<00:03,  9.62it/s] 91%|█████████ | 325/358 [00:33<00:03,  9.60it/s] 91%|█████████▏| 327/358 [00:33<00:03,  9.96it/s] 92%|█████████▏| 329/358 [00:33<00:02, 10.07it/s] 92%|█████████▏| 330/358 [00:33<00:02,  9.96it/s] 93%|█████████▎| 332/358 [00:33<00:02, 10.05it/s] 93%|█████████▎| 334/358 [00:34<00:02,  9.96it/s] 94%|█████████▎| 335/358 [00:34<00:02,  9.83it/s] 94%|█████████▍| 337/358 [00:34<00:02,  9.91it/s] 95%|█████████▍| 339/358 [00:34<00:01, 10.11it/s] 95%|█████████▌| 341/358 [00:34<00:01, 10.06it/s] 96%|█████████▌| 343/358 [00:34<00:01,  9.90it/s] 96%|█████████▌| 344/358 [00:35<00:01,  9.84it/s] 96%|█████████▋| 345/358 [00:35<00:01,  9.86it/s] 97%|█████████▋| 347/358 [00:35<00:01, 10.04it/s] 97%|█████████▋| 348/358 [00:35<00:01,  9.94it/s] 97%|█████████▋| 349/358 [00:35<00:00,  9.86it/s] 98%|█████████▊| 350/358 [00:35<00:00,  9.79it/s] 98%|█████████▊| 351/358 [00:35<00:00,  9.74it/s] 99%|█████████▊| 353/358 [00:35<00:00,  9.92it/s] 99%|█████████▉| 354/358 [00:36<00:00,  9.90it/s] 99%|█████████▉| 355/358 [00:36<00:00,  9.82it/s]100%|█████████▉| 357/358 [00:36<00:00,  9.87it/s]100%|██████████| 358/358 [00:36<00:00,  9.83it/s]
[32m2025-02-05 06:03:14.217[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    gen_loss  grad clip ratio  grad norm   ppl
       1.921                1      2.406 6.831[0m
[32m2025-02-05 06:03:14.217[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m169[0m - [1m[Valid][0m
  0%|          | 0/10256 [00:00<?, ?it/s]100%|██████████| 10256/10256 [00:00<00:00, 928586.76it/s]
[32m2025-02-05 06:03:14.229[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:27,  1.41it/s]  5%|▌         | 2/40 [00:01<00:26,  1.43it/s]  8%|▊         | 3/40 [00:02<00:25,  1.44it/s] 10%|█         | 4/40 [00:02<00:24,  1.44it/s] 12%|█▎        | 5/40 [00:03<00:24,  1.43it/s] 15%|█▌        | 6/40 [00:04<00:23,  1.43it/s] 18%|█▊        | 7/40 [00:04<00:23,  1.43it/s] 20%|██        | 8/40 [00:05<00:22,  1.43it/s] 22%|██▎       | 9/40 [00:06<00:21,  1.44it/s] 25%|██▌       | 10/40 [00:06<00:20,  1.44it/s] 28%|██▊       | 11/40 [00:07<00:20,  1.44it/s] 30%|███       | 12/40 [00:08<00:19,  1.44it/s] 32%|███▎      | 13/40 [00:09<00:18,  1.44it/s] 35%|███▌      | 14/40 [00:09<00:18,  1.43it/s] 38%|███▊      | 15/40 [00:10<00:17,  1.44it/s] 40%|████      | 16/40 [00:11<00:16,  1.44it/s] 42%|████▎     | 17/40 [00:11<00:15,  1.44it/s] 45%|████▌     | 18/40 [00:12<00:15,  1.44it/s] 48%|████▊     | 19/40 [00:13<00:14,  1.44it/s] 50%|█████     | 20/40 [00:13<00:13,  1.45it/s] 52%|█████▎    | 21/40 [00:14<00:13,  1.45it/s] 55%|█████▌    | 22/40 [00:15<00:12,  1.44it/s] 57%|█████▊    | 23/40 [00:15<00:11,  1.45it/s] 60%|██████    | 24/40 [00:16<00:11,  1.44it/s] 62%|██████▎   | 25/40 [00:17<00:10,  1.44it/s] 65%|██████▌   | 26/40 [00:18<00:09,  1.45it/s] 68%|██████▊   | 27/40 [00:18<00:08,  1.45it/s] 70%|███████   | 28/40 [00:19<00:08,  1.44it/s] 72%|███████▎  | 29/40 [00:20<00:07,  1.44it/s] 75%|███████▌  | 30/40 [00:20<00:06,  1.45it/s] 78%|███████▊  | 31/40 [00:21<00:06,  1.44it/s] 80%|████████  | 32/40 [00:22<00:05,  1.45it/s] 82%|████████▎ | 33/40 [00:22<00:04,  1.45it/s] 85%|████████▌ | 34/40 [00:23<00:04,  1.45it/s] 88%|████████▊ | 35/40 [00:24<00:03,  1.44it/s] 90%|█████████ | 36/40 [00:24<00:02,  1.44it/s] 92%|█████████▎| 37/40 [00:25<00:02,  1.44it/s] 95%|█████████▌| 38/40 [00:26<00:01,  1.43it/s] 98%|█████████▊| 39/40 [00:27<00:00,  1.43it/s]100%|██████████| 40/40 [00:27<00:00,  1.58it/s]100%|██████████| 40/40 [00:27<00:00,  1.45it/s]
[32m2025-02-05 06:03:41.794[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    average  bleu@1  bleu@2  bleu@3  bleu@4  dist@1  dist@2  dist@3  dist@4  extreme  \
      .7798   .2961   .1108  .04149  .02169  .04302   .3038   .5899   .7653    .6014   
      f1  gen_loss  greedy  intra_dist@1  intra_dist@2  intra_dist@3  intra_dist@4  \
   .3497      4.97   .6651         .8591         .9642         .9573         .9263   
     ppl  rouge1  rouge2  rougeL  
   144.1   .3831  .09002   .3704[0m
[32m2025-02-05 06:03:41.800[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m163[0m - [1m[Conversation epoch 52][0m
[32m2025-02-05 06:03:41.800[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m164[0m - [1m[Train][0m
  0%|          | 0/92414 [00:00<?, ?it/s]100%|██████████| 92414/92414 [00:00<00:00, 1098833.48it/s]
[32m2025-02-05 06:03:41.885[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/358 [00:00<?, ?it/s]  0%|          | 1/358 [00:00<00:36,  9.77it/s]  1%|          | 3/358 [00:00<00:35,  9.94it/s]  1%|          | 4/358 [00:00<00:35,  9.92it/s]  2%|▏         | 6/358 [00:00<00:35,  9.88it/s]  2%|▏         | 7/358 [00:00<00:35,  9.81it/s]  2%|▏         | 8/358 [00:00<00:35,  9.86it/s]  3%|▎         | 9/358 [00:00<00:35,  9.76it/s]  3%|▎         | 10/358 [00:01<00:35,  9.75it/s]  3%|▎         | 11/358 [00:01<00:35,  9.70it/s]  4%|▎         | 13/358 [00:01<00:34,  9.92it/s]  4%|▍         | 14/358 [00:01<00:34,  9.84it/s]  4%|▍         | 15/358 [00:01<00:35,  9.77it/s]  4%|▍         | 16/358 [00:01<00:35,  9.70it/s]  5%|▍         | 17/358 [00:01<00:35,  9.72it/s]  5%|▌         | 18/358 [00:01<00:34,  9.80it/s]  5%|▌         | 19/358 [00:01<00:34,  9.73it/s]  6%|▌         | 20/358 [00:02<00:34,  9.67it/s]  6%|▌         | 21/358 [00:02<00:35,  9.60it/s]  6%|▌         | 22/358 [00:02<00:34,  9.67it/s]  7%|▋         | 24/358 [00:02<00:34,  9.77it/s]  7%|▋         | 25/358 [00:02<00:34,  9.72it/s]  7%|▋         | 26/358 [00:02<00:34,  9.67it/s]  8%|▊         | 27/358 [00:02<00:34,  9.73it/s]  8%|▊         | 28/358 [00:02<00:34,  9.68it/s]  8%|▊         | 29/358 [00:02<00:34,  9.65it/s]  9%|▊         | 31/358 [00:03<00:33,  9.75it/s]  9%|▉         | 32/358 [00:03<00:33,  9.75it/s]  9%|▉         | 34/358 [00:03<00:32,  9.85it/s] 10%|█         | 36/358 [00:03<00:32,  9.85it/s] 10%|█         | 37/358 [00:03<00:32,  9.83it/s] 11%|█         | 38/358 [00:03<00:32,  9.79it/s] 11%|█         | 40/358 [00:04<00:31,  9.94it/s] 11%|█▏        | 41/358 [00:04<00:32,  9.86it/s] 12%|█▏        | 43/358 [00:04<00:31,  9.88it/s] 13%|█▎        | 45/358 [00:04<00:31,  9.98it/s] 13%|█▎        | 47/358 [00:04<00:31,  9.96it/s] 13%|█▎        | 48/358 [00:04<00:31,  9.94it/s] 14%|█▍        | 50/358 [00:05<00:31,  9.92it/s] 14%|█▍        | 51/358 [00:05<00:31,  9.85it/s] 15%|█▍        | 52/358 [00:05<00:31,  9.76it/s] 15%|█▍        | 53/358 [00:05<00:31,  9.71it/s] 15%|█▌        | 54/358 [00:05<00:31,  9.75it/s] 15%|█▌        | 55/358 [00:05<00:31,  9.69it/s] 16%|█▌        | 56/358 [00:05<00:31,  9.73it/s] 16%|█▌        | 57/358 [00:05<00:31,  9.69it/s] 16%|█▌        | 58/358 [00:05<00:31,  9.67it/s] 16%|█▋        | 59/358 [00:06<00:31,  9.64it/s] 17%|█▋        | 61/358 [00:06<00:30,  9.72it/s] 17%|█▋        | 62/358 [00:06<00:30,  9.65it/s] 18%|█▊        | 63/358 [00:06<00:30,  9.71it/s] 18%|█▊        | 64/358 [00:06<00:30,  9.66it/s] 18%|█▊        | 66/358 [00:06<00:30,  9.73it/s] 19%|█▊        | 67/358 [00:06<00:29,  9.72it/s] 19%|█▉        | 69/358 [00:07<00:29,  9.78it/s] 20%|█▉        | 70/358 [00:07<00:29,  9.72it/s] 20%|█▉        | 71/358 [00:07<00:29,  9.77it/s] 20%|██        | 72/358 [00:07<00:29,  9.72it/s] 20%|██        | 73/358 [00:07<00:29,  9.69it/s] 21%|██        | 74/358 [00:07<00:29,  9.65it/s] 21%|██        | 75/358 [00:07<00:29,  9.62it/s] 21%|██        | 76/358 [00:07<00:28,  9.73it/s] 22%|██▏       | 77/358 [00:07<00:29,  9.69it/s] 22%|██▏       | 79/358 [00:08<00:28,  9.70it/s] 23%|██▎       | 81/358 [00:08<00:28,  9.76it/s] 23%|██▎       | 83/358 [00:08<00:28,  9.78it/s] 23%|██▎       | 84/358 [00:08<00:28,  9.73it/s] 24%|██▎       | 85/358 [00:08<00:28,  9.68it/s] 24%|██▍       | 86/358 [00:08<00:28,  9.67it/s] 24%|██▍       | 87/358 [00:08<00:28,  9.65it/s] 25%|██▍       | 88/358 [00:09<00:27,  9.67it/s] 25%|██▌       | 90/358 [00:09<00:27,  9.91it/s] 26%|██▌       | 92/358 [00:09<00:26, 10.01it/s] 26%|██▌       | 93/358 [00:09<00:26,  9.97it/s] 26%|██▋       | 94/358 [00:09<00:26,  9.88it/s] 27%|██▋       | 96/358 [00:09<00:25, 10.16it/s] 27%|██▋       | 98/358 [00:10<00:25, 10.05it/s] 28%|██▊       | 99/358 [00:10<00:26,  9.96it/s] 28%|██▊       | 101/358 [00:10<00:25,  9.93it/s] 29%|██▉       | 103/358 [00:10<00:25,  9.92it/s] 29%|██▉       | 104/358 [00:10<00:25,  9.87it/s] 29%|██▉       | 105/358 [00:10<00:25,  9.79it/s] 30%|██▉       | 106/358 [00:10<00:25,  9.78it/s] 30%|███       | 108/358 [00:11<00:25,  9.80it/s] 30%|███       | 109/358 [00:11<00:25,  9.72it/s] 31%|███       | 110/358 [00:11<00:25,  9.70it/s] 31%|███       | 111/358 [00:11<00:25,  9.65it/s] 32%|███▏      | 113/358 [00:11<00:24,  9.92it/s] 32%|███▏      | 114/358 [00:11<00:24,  9.88it/s] 32%|███▏      | 115/358 [00:11<00:24,  9.78it/s] 32%|███▏      | 116/358 [00:11<00:24,  9.70it/s] 33%|███▎      | 117/358 [00:11<00:24,  9.67it/s] 33%|███▎      | 119/358 [00:12<00:24,  9.79it/s] 34%|███▍      | 121/358 [00:12<00:23,  9.98it/s] 34%|███▍      | 123/358 [00:12<00:23, 10.08it/s] 35%|███▍      | 125/358 [00:12<00:23, 10.06it/s] 35%|███▌      | 127/358 [00:12<00:23,  9.99it/s] 36%|███▌      | 128/358 [00:13<00:23,  9.95it/s] 36%|███▋      | 130/358 [00:13<00:22, 10.00it/s] 37%|███▋      | 131/358 [00:13<00:22,  9.91it/s] 37%|███▋      | 132/358 [00:13<00:22,  9.92it/s] 37%|███▋      | 134/358 [00:13<00:22,  9.94it/s] 38%|███▊      | 135/358 [00:13<00:22,  9.88it/s] 38%|███▊      | 137/358 [00:13<00:22,  9.97it/s] 39%|███▊      | 138/358 [00:14<00:22,  9.95it/s] 39%|███▉      | 139/358 [00:14<00:22,  9.86it/s] 39%|███▉      | 141/358 [00:14<00:21,  9.98it/s] 40%|███▉      | 142/358 [00:14<00:21,  9.90it/s] 40%|███▉      | 143/358 [00:14<00:21,  9.87it/s] 40%|████      | 144/358 [00:14<00:21,  9.78it/s] 41%|████      | 145/358 [00:14<00:21,  9.80it/s] 41%|████      | 146/358 [00:14<00:21,  9.74it/s] 41%|████      | 147/358 [00:14<00:21,  9.68it/s] 41%|████▏     | 148/358 [00:15<00:21,  9.71it/s] 42%|████▏     | 149/358 [00:15<00:21,  9.69it/s] 42%|████▏     | 150/358 [00:15<00:21,  9.65it/s] 42%|████▏     | 151/358 [00:15<00:22,  9.39it/s] 42%|████▏     | 152/358 [00:15<00:21,  9.43it/s] 43%|████▎     | 153/358 [00:15<00:21,  9.45it/s] 43%|████▎     | 154/358 [00:15<00:21,  9.54it/s] 43%|████▎     | 155/358 [00:15<00:21,  9.55it/s] 44%|████▎     | 156/358 [00:15<00:20,  9.68it/s] 44%|████▍     | 157/358 [00:16<00:20,  9.62it/s] 44%|████▍     | 158/358 [00:16<00:20,  9.71it/s] 44%|████▍     | 159/358 [00:16<00:20,  9.70it/s] 45%|████▍     | 160/358 [00:16<00:20,  9.71it/s] 45%|████▌     | 162/358 [00:16<00:19, 10.01it/s] 46%|████▌     | 164/358 [00:16<00:19, 10.01it/s] 46%|████▌     | 165/358 [00:16<00:19,  9.97it/s] 47%|████▋     | 167/358 [00:17<00:19,  9.91it/s] 47%|████▋     | 169/358 [00:17<00:18,  9.95it/s] 48%|████▊     | 171/358 [00:17<00:18,  9.93it/s] 48%|████▊     | 172/358 [00:17<00:18,  9.88it/s] 48%|████▊     | 173/358 [00:17<00:18,  9.81it/s] 49%|████▉     | 175/358 [00:17<00:18,  9.84it/s] 49%|████▉     | 176/358 [00:17<00:18,  9.85it/s] 49%|████▉     | 177/358 [00:18<00:18,  9.84it/s] 50%|█████     | 179/358 [00:18<00:18,  9.86it/s] 50%|█████     | 180/358 [00:18<00:18,  9.79it/s] 51%|█████     | 182/358 [00:18<00:17,  9.94it/s] 51%|█████     | 183/358 [00:18<00:17,  9.90it/s] 51%|█████▏    | 184/358 [00:18<00:17,  9.79it/s] 52%|█████▏    | 185/358 [00:18<00:17,  9.73it/s] 52%|█████▏    | 187/358 [00:19<00:17,  9.95it/s] 53%|█████▎    | 188/358 [00:19<00:17,  9.89it/s] 53%|█████▎    | 189/358 [00:19<00:17,  9.84it/s] 53%|█████▎    | 191/358 [00:19<00:17,  9.75it/s] 54%|█████▎    | 192/358 [00:19<00:17,  9.70it/s] 54%|█████▍    | 193/358 [00:19<00:17,  9.70it/s] 54%|█████▍    | 194/358 [00:19<00:16,  9.67it/s] 54%|█████▍    | 195/358 [00:19<00:16,  9.72it/s] 55%|█████▌    | 197/358 [00:20<00:16,  9.90it/s] 55%|█████▌    | 198/358 [00:20<00:16,  9.83it/s] 56%|█████▌    | 199/358 [00:20<00:16,  9.86it/s] 56%|█████▌    | 200/358 [00:20<00:16,  9.80it/s] 56%|█████▌    | 201/358 [00:20<00:16,  9.76it/s] 57%|█████▋    | 203/358 [00:20<00:15,  9.85it/s] 57%|█████▋    | 204/358 [00:20<00:15,  9.75it/s] 57%|█████▋    | 205/358 [00:20<00:15,  9.71it/s] 58%|█████▊    | 207/358 [00:21<00:15,  9.87it/s] 58%|█████▊    | 208/358 [00:21<00:15,  9.81it/s] 59%|█████▊    | 210/358 [00:21<00:15,  9.82it/s] 59%|█████▉    | 212/358 [00:21<00:14,  9.82it/s] 60%|█████▉    | 214/358 [00:21<00:14,  9.89it/s] 60%|██████    | 215/358 [00:21<00:14,  9.83it/s] 60%|██████    | 216/358 [00:22<00:14,  9.76it/s] 61%|██████    | 217/358 [00:22<00:14,  9.80it/s] 61%|██████    | 218/358 [00:22<00:14,  9.77it/s] 61%|██████    | 219/358 [00:22<00:14,  9.77it/s] 62%|██████▏   | 221/358 [00:22<00:13,  9.90it/s] 62%|██████▏   | 222/358 [00:22<00:13,  9.80it/s] 62%|██████▏   | 223/358 [00:22<00:13,  9.74it/s] 63%|██████▎   | 224/358 [00:22<00:13,  9.69it/s] 63%|██████▎   | 226/358 [00:23<00:13,  9.73it/s] 64%|██████▎   | 228/358 [00:23<00:13,  9.76it/s] 64%|██████▍   | 229/358 [00:23<00:13,  9.73it/s] 64%|██████▍   | 230/358 [00:23<00:13,  9.68it/s] 65%|██████▍   | 232/358 [00:23<00:12,  9.73it/s] 65%|██████▌   | 234/358 [00:23<00:12, 10.02it/s] 66%|██████▌   | 236/358 [00:24<00:12,  9.98it/s] 66%|██████▋   | 238/358 [00:24<00:11, 10.03it/s] 67%|██████▋   | 240/358 [00:24<00:11, 10.00it/s] 68%|██████▊   | 242/358 [00:24<00:11,  9.98it/s] 68%|██████▊   | 243/358 [00:24<00:11,  9.91it/s] 68%|██████▊   | 244/358 [00:24<00:11,  9.85it/s] 69%|██████▊   | 246/358 [00:25<00:11,  9.87it/s] 69%|██████▉   | 247/358 [00:25<00:11,  9.80it/s] 69%|██████▉   | 248/358 [00:25<00:11,  9.75it/s] 70%|██████▉   | 250/358 [00:25<00:10,  9.84it/s] 70%|███████   | 251/358 [00:25<00:10,  9.78it/s] 70%|███████   | 252/358 [00:25<00:10,  9.72it/s] 71%|███████   | 253/358 [00:25<00:10,  9.68it/s] 71%|███████   | 254/358 [00:25<00:10,  9.66it/s] 72%|███████▏  | 256/358 [00:26<00:10,  9.84it/s] 72%|███████▏  | 257/358 [00:26<00:10,  9.84it/s] 72%|███████▏  | 258/358 [00:26<00:10,  9.71it/s] 72%|███████▏  | 259/358 [00:26<00:10,  9.68it/s] 73%|███████▎  | 260/358 [00:26<00:10,  9.71it/s] 73%|███████▎  | 262/358 [00:26<00:09,  9.89it/s] 74%|███████▎  | 264/358 [00:26<00:09,  9.91it/s] 74%|███████▍  | 266/358 [00:27<00:09,  9.90it/s] 75%|███████▍  | 267/358 [00:27<00:09,  9.84it/s] 75%|███████▌  | 269/358 [00:27<00:08,  9.90it/s] 75%|███████▌  | 270/358 [00:27<00:08,  9.83it/s] 76%|███████▌  | 271/358 [00:27<00:08,  9.75it/s] 76%|███████▌  | 272/358 [00:27<00:08,  9.73it/s] 76%|███████▋  | 273/358 [00:27<00:08,  9.64it/s] 77%|███████▋  | 274/358 [00:27<00:08,  9.63it/s] 77%|███████▋  | 275/358 [00:28<00:08,  9.67it/s] 77%|███████▋  | 276/358 [00:28<00:08,  9.68it/s] 77%|███████▋  | 277/358 [00:28<00:08,  9.65it/s] 78%|███████▊  | 278/358 [00:28<00:08,  9.63it/s] 78%|███████▊  | 280/358 [00:28<00:07,  9.82it/s] 78%|███████▊  | 281/358 [00:28<00:07,  9.83it/s] 79%|███████▉  | 282/358 [00:28<00:07,  9.77it/s] 79%|███████▉  | 283/358 [00:28<00:07,  9.71it/s] 79%|███████▉  | 284/358 [00:28<00:07,  9.67it/s] 80%|███████▉  | 285/358 [00:29<00:07,  9.74it/s] 80%|███████▉  | 286/358 [00:29<00:07,  9.69it/s] 80%|████████  | 287/358 [00:29<00:07,  9.67it/s] 80%|████████  | 288/358 [00:29<00:07,  9.63it/s] 81%|████████  | 290/358 [00:29<00:06,  9.84it/s] 81%|████████▏ | 291/358 [00:29<00:06,  9.83it/s] 82%|████████▏ | 293/358 [00:29<00:06,  9.84it/s] 82%|████████▏ | 295/358 [00:30<00:06,  9.91it/s] 83%|████████▎ | 296/358 [00:30<00:06,  9.85it/s] 83%|████████▎ | 297/358 [00:30<00:06,  9.74it/s] 84%|████████▎ | 299/358 [00:30<00:05,  9.90it/s] 84%|████████▍ | 301/358 [00:30<00:05,  9.94it/s] 84%|████████▍ | 302/358 [00:30<00:05,  9.87it/s] 85%|████████▍ | 303/358 [00:30<00:05,  9.88it/s] 85%|████████▌ | 305/358 [00:31<00:05,  9.91it/s] 85%|████████▌ | 306/358 [00:31<00:05,  9.83it/s] 86%|████████▌ | 308/358 [00:31<00:05,  9.93it/s] 86%|████████▋ | 309/358 [00:31<00:04,  9.82it/s] 87%|████████▋ | 310/358 [00:31<00:04,  9.77it/s] 87%|████████▋ | 311/358 [00:31<00:04,  9.69it/s] 87%|████████▋ | 312/358 [00:31<00:04,  9.71it/s] 87%|████████▋ | 313/358 [00:31<00:04,  9.72it/s] 88%|████████▊ | 315/358 [00:32<00:04,  9.98it/s] 88%|████████▊ | 316/358 [00:32<00:04,  9.93it/s] 89%|████████▊ | 317/358 [00:32<00:04,  9.85it/s] 89%|████████▉ | 318/358 [00:32<00:04,  9.80it/s] 89%|████████▉ | 319/358 [00:32<00:04,  9.75it/s] 89%|████████▉ | 320/358 [00:32<00:03,  9.81it/s] 90%|████████▉ | 321/358 [00:32<00:03,  9.74it/s] 90%|████████▉ | 322/358 [00:32<00:03,  9.70it/s] 90%|█████████ | 323/358 [00:32<00:03,  9.66it/s] 91%|█████████ | 324/358 [00:33<00:03,  9.63it/s] 91%|█████████ | 325/358 [00:33<00:03,  9.61it/s] 91%|█████████▏| 327/358 [00:33<00:03,  9.96it/s] 92%|█████████▏| 329/358 [00:33<00:02, 10.06it/s] 92%|█████████▏| 330/358 [00:33<00:02,  9.96it/s] 93%|█████████▎| 332/358 [00:33<00:02, 10.06it/s] 93%|█████████▎| 334/358 [00:34<00:02,  9.96it/s] 94%|█████████▎| 335/358 [00:34<00:02,  9.84it/s] 94%|█████████▍| 337/358 [00:34<00:02,  9.92it/s] 95%|█████████▍| 339/358 [00:34<00:01, 10.12it/s] 95%|█████████▌| 341/358 [00:34<00:01, 10.06it/s] 96%|█████████▌| 343/358 [00:34<00:01,  9.90it/s] 96%|█████████▌| 344/358 [00:35<00:01,  9.84it/s] 96%|█████████▋| 345/358 [00:35<00:01,  9.86it/s] 97%|█████████▋| 346/358 [00:35<00:01,  9.89it/s] 97%|█████████▋| 348/358 [00:35<00:01,  9.98it/s] 97%|█████████▋| 349/358 [00:35<00:00,  9.90it/s] 98%|█████████▊| 350/358 [00:35<00:00,  9.82it/s] 98%|█████████▊| 351/358 [00:35<00:00,  9.76it/s] 99%|█████████▊| 353/358 [00:35<00:00,  9.93it/s] 99%|█████████▉| 354/358 [00:36<00:00,  9.91it/s] 99%|█████████▉| 355/358 [00:36<00:00,  9.82it/s]100%|█████████▉| 357/358 [00:36<00:00,  9.88it/s]100%|██████████| 358/358 [00:36<00:00,  9.83it/s]
[32m2025-02-05 06:04:18.327[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    gen_loss  grad clip ratio  grad norm   ppl
       1.914                1       2.86 6.781[0m
[32m2025-02-05 06:04:18.327[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m169[0m - [1m[Valid][0m
  0%|          | 0/10256 [00:00<?, ?it/s]100%|██████████| 10256/10256 [00:00<00:00, 927585.59it/s]
[32m2025-02-05 06:04:18.338[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:27,  1.43it/s]  5%|▌         | 2/40 [00:01<00:26,  1.45it/s]  8%|▊         | 3/40 [00:02<00:25,  1.45it/s] 10%|█         | 4/40 [00:02<00:24,  1.46it/s] 12%|█▎        | 5/40 [00:03<00:24,  1.45it/s] 15%|█▌        | 6/40 [00:04<00:23,  1.45it/s] 18%|█▊        | 7/40 [00:04<00:22,  1.45it/s] 20%|██        | 8/40 [00:05<00:21,  1.46it/s] 22%|██▎       | 9/40 [00:06<00:21,  1.45it/s] 25%|██▌       | 10/40 [00:06<00:20,  1.46it/s] 28%|██▊       | 11/40 [00:07<00:19,  1.45it/s] 30%|███       | 12/40 [00:08<00:19,  1.45it/s] 32%|███▎      | 13/40 [00:08<00:18,  1.46it/s] 35%|███▌      | 14/40 [00:09<00:17,  1.45it/s] 38%|███▊      | 15/40 [00:10<00:17,  1.45it/s] 40%|████      | 16/40 [00:11<00:16,  1.45it/s] 42%|████▎     | 17/40 [00:11<00:15,  1.46it/s] 45%|████▌     | 18/40 [00:12<00:15,  1.46it/s] 48%|████▊     | 19/40 [00:13<00:14,  1.45it/s] 50%|█████     | 20/40 [00:13<00:13,  1.46it/s] 52%|█████▎    | 21/40 [00:14<00:12,  1.46it/s] 55%|█████▌    | 22/40 [00:15<00:12,  1.46it/s] 57%|█████▊    | 23/40 [00:15<00:11,  1.46it/s] 60%|██████    | 24/40 [00:16<00:10,  1.46it/s] 62%|██████▎   | 25/40 [00:17<00:10,  1.45it/s] 65%|██████▌   | 26/40 [00:17<00:09,  1.46it/s] 68%|██████▊   | 27/40 [00:18<00:08,  1.46it/s] 70%|███████   | 28/40 [00:19<00:08,  1.46it/s] 72%|███████▎  | 29/40 [00:19<00:07,  1.46it/s] 75%|███████▌  | 30/40 [00:20<00:06,  1.47it/s] 78%|███████▊  | 31/40 [00:21<00:06,  1.46it/s] 80%|████████  | 32/40 [00:21<00:05,  1.46it/s] 82%|████████▎ | 33/40 [00:22<00:04,  1.46it/s] 85%|████████▌ | 34/40 [00:23<00:04,  1.46it/s] 88%|████████▊ | 35/40 [00:24<00:03,  1.45it/s] 90%|█████████ | 36/40 [00:24<00:02,  1.45it/s] 92%|█████████▎| 37/40 [00:25<00:02,  1.45it/s] 95%|█████████▌| 38/40 [00:26<00:01,  1.44it/s] 98%|█████████▊| 39/40 [00:26<00:00,  1.44it/s]100%|██████████| 40/40 [00:27<00:00,  1.60it/s]100%|██████████| 40/40 [00:27<00:00,  1.47it/s]
[32m2025-02-05 06:04:45.639[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    average  bleu@1  bleu@2  bleu@3  bleu@4  dist@1  dist@2  dist@3  dist@4  extreme  \
      .7755   .2970   .1116  .04416  .02293  .04664   .3051   .5803   .7455    .5936   
      f1  gen_loss  greedy  intra_dist@1  intra_dist@2  intra_dist@3  intra_dist@4  \
   .3500     4.986   .6682         .8663         .9634         .9468         .9148   
     ppl  rouge1  rouge2  rougeL  
   146.4   .3848  .09198   .3726[0m
[32m2025-02-05 06:04:45.645[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m163[0m - [1m[Conversation epoch 53][0m
[32m2025-02-05 06:04:45.645[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m164[0m - [1m[Train][0m
  0%|          | 0/92414 [00:00<?, ?it/s]100%|██████████| 92414/92414 [00:00<00:00, 1116173.37it/s]
[32m2025-02-05 06:04:45.728[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/358 [00:00<?, ?it/s]  0%|          | 1/358 [00:00<00:36,  9.78it/s]  1%|          | 3/358 [00:00<00:35,  9.95it/s]  1%|          | 4/358 [00:00<00:35,  9.92it/s]  2%|▏         | 6/358 [00:00<00:35,  9.89it/s]  2%|▏         | 7/358 [00:00<00:35,  9.82it/s]  2%|▏         | 8/358 [00:00<00:35,  9.87it/s]  3%|▎         | 9/358 [00:00<00:35,  9.76it/s]  3%|▎         | 10/358 [00:01<00:35,  9.75it/s]  3%|▎         | 11/358 [00:01<00:35,  9.70it/s]  4%|▎         | 13/358 [00:01<00:34,  9.92it/s]  4%|▍         | 14/358 [00:01<00:34,  9.85it/s]  4%|▍         | 15/358 [00:01<00:35,  9.78it/s]  4%|▍         | 16/358 [00:01<00:35,  9.71it/s]  5%|▍         | 17/358 [00:01<00:35,  9.73it/s]  5%|▌         | 18/358 [00:01<00:34,  9.79it/s]  5%|▌         | 19/358 [00:01<00:34,  9.73it/s]  6%|▌         | 20/358 [00:02<00:34,  9.67it/s]  6%|▌         | 21/358 [00:02<00:35,  9.61it/s]  6%|▌         | 22/358 [00:02<00:34,  9.67it/s]  7%|▋         | 24/358 [00:02<00:34,  9.78it/s]  7%|▋         | 25/358 [00:02<00:34,  9.73it/s]  7%|▋         | 26/358 [00:02<00:34,  9.68it/s]  8%|▊         | 27/358 [00:02<00:34,  9.73it/s]  8%|▊         | 28/358 [00:02<00:34,  9.68it/s]  8%|▊         | 29/358 [00:02<00:34,  9.65it/s]  9%|▊         | 31/358 [00:03<00:33,  9.75it/s]  9%|▉         | 32/358 [00:03<00:33,  9.75it/s]  9%|▉         | 34/358 [00:03<00:32,  9.85it/s] 10%|█         | 36/358 [00:03<00:32,  9.85it/s] 10%|█         | 37/358 [00:03<00:32,  9.83it/s] 11%|█         | 38/358 [00:03<00:32,  9.79it/s] 11%|█         | 40/358 [00:04<00:31,  9.94it/s] 11%|█▏        | 41/358 [00:04<00:32,  9.86it/s] 12%|█▏        | 43/358 [00:04<00:31,  9.88it/s] 13%|█▎        | 45/358 [00:04<00:31,  9.98it/s] 13%|█▎        | 47/358 [00:04<00:31,  9.96it/s] 13%|█▎        | 48/358 [00:04<00:31,  9.95it/s] 14%|█▍        | 50/358 [00:05<00:31,  9.92it/s] 14%|█▍        | 51/358 [00:05<00:31,  9.85it/s] 15%|█▍        | 52/358 [00:05<00:31,  9.76it/s] 15%|█▍        | 53/358 [00:05<00:31,  9.71it/s] 15%|█▌        | 54/358 [00:05<00:31,  9.75it/s] 15%|█▌        | 55/358 [00:05<00:31,  9.70it/s] 16%|█▌        | 56/358 [00:05<00:31,  9.74it/s] 16%|█▌        | 57/358 [00:05<00:31,  9.70it/s] 16%|█▌        | 58/358 [00:05<00:31,  9.67it/s] 16%|█▋        | 59/358 [00:06<00:31,  9.64it/s] 17%|█▋        | 61/358 [00:06<00:30,  9.73it/s] 17%|█▋        | 62/358 [00:06<00:30,  9.65it/s] 18%|█▊        | 63/358 [00:06<00:30,  9.71it/s] 18%|█▊        | 64/358 [00:06<00:30,  9.67it/s] 18%|█▊        | 66/358 [00:06<00:29,  9.74it/s] 19%|█▊        | 67/358 [00:06<00:29,  9.72it/s] 19%|█▉        | 69/358 [00:07<00:29,  9.79it/s] 20%|█▉        | 70/358 [00:07<00:29,  9.73it/s] 20%|█▉        | 71/358 [00:07<00:29,  9.78it/s] 20%|██        | 72/358 [00:07<00:29,  9.72it/s] 20%|██        | 73/358 [00:07<00:29,  9.69it/s] 21%|██        | 74/358 [00:07<00:29,  9.66it/s] 21%|██        | 75/358 [00:07<00:29,  9.63it/s] 22%|██▏       | 77/358 [00:07<00:28,  9.71it/s] 22%|██▏       | 79/358 [00:08<00:28,  9.71it/s] 23%|██▎       | 81/358 [00:08<00:28,  9.76it/s] 23%|██▎       | 83/358 [00:08<00:28,  9.78it/s] 23%|██▎       | 84/358 [00:08<00:28,  9.74it/s] 24%|██▎       | 85/358 [00:08<00:28,  9.69it/s] 24%|██▍       | 86/358 [00:08<00:28,  9.68it/s] 24%|██▍       | 87/358 [00:08<00:28,  9.66it/s] 25%|██▍       | 88/358 [00:09<00:27,  9.68it/s] 25%|██▌       | 90/358 [00:09<00:27,  9.87it/s] 26%|██▌       | 92/358 [00:09<00:26,  9.97it/s] 26%|██▌       | 93/358 [00:09<00:26,  9.94it/s] 26%|██▋       | 94/358 [00:09<00:26,  9.84it/s] 27%|██▋       | 96/358 [00:09<00:25, 10.13it/s] 27%|██▋       | 98/358 [00:10<00:25, 10.03it/s] 28%|██▊       | 99/358 [00:10<00:26,  9.94it/s] 28%|██▊       | 101/358 [00:10<00:25,  9.91it/s] 29%|██▉       | 103/358 [00:10<00:25,  9.90it/s] 29%|██▉       | 104/358 [00:10<00:25,  9.86it/s] 29%|██▉       | 105/358 [00:10<00:25,  9.78it/s] 30%|██▉       | 106/358 [00:10<00:25,  9.76it/s] 30%|███       | 108/358 [00:11<00:25,  9.79it/s] 30%|███       | 109/358 [00:11<00:25,  9.71it/s] 31%|███       | 110/358 [00:11<00:25,  9.69it/s] 31%|███       | 111/358 [00:11<00:25,  9.64it/s] 32%|███▏      | 113/358 [00:11<00:24,  9.91it/s] 32%|███▏      | 114/358 [00:11<00:24,  9.87it/s] 32%|███▏      | 115/358 [00:11<00:24,  9.77it/s] 32%|███▏      | 116/358 [00:11<00:24,  9.69it/s] 33%|███▎      | 117/358 [00:11<00:24,  9.66it/s] 33%|███▎      | 119/358 [00:12<00:24,  9.78it/s] 34%|███▍      | 121/358 [00:12<00:23,  9.98it/s] 34%|███▍      | 123/358 [00:12<00:23, 10.07it/s] 35%|███▍      | 125/358 [00:12<00:23, 10.05it/s] 35%|███▌      | 126/358 [00:12<00:23, 10.01it/s] 35%|███▌      | 127/358 [00:12<00:23,  9.96it/s] 36%|███▌      | 128/358 [00:13<00:23,  9.92it/s] 36%|███▋      | 130/358 [00:13<00:22,  9.98it/s] 37%|███▋      | 131/358 [00:13<00:22,  9.88it/s] 37%|███▋      | 132/358 [00:13<00:22,  9.91it/s] 37%|███▋      | 134/358 [00:13<00:22,  9.93it/s] 38%|███▊      | 135/358 [00:13<00:22,  9.87it/s] 38%|███▊      | 137/358 [00:13<00:22,  9.96it/s] 39%|███▊      | 138/358 [00:14<00:22,  9.94it/s] 39%|███▉      | 139/358 [00:14<00:22,  9.85it/s] 39%|███▉      | 141/358 [00:14<00:21,  9.96it/s] 40%|███▉      | 142/358 [00:14<00:21,  9.88it/s] 40%|███▉      | 143/358 [00:14<00:21,  9.85it/s] 40%|████      | 144/358 [00:14<00:21,  9.77it/s] 41%|████      | 145/358 [00:14<00:21,  9.79it/s] 41%|████      | 146/358 [00:14<00:21,  9.73it/s] 41%|████      | 147/358 [00:14<00:21,  9.68it/s] 41%|████▏     | 148/358 [00:15<00:21,  9.71it/s] 42%|████▏     | 149/358 [00:15<00:21,  9.69it/s] 42%|████▏     | 150/358 [00:15<00:21,  9.65it/s] 42%|████▏     | 151/358 [00:15<00:22,  9.39it/s] 42%|████▏     | 152/358 [00:15<00:21,  9.43it/s] 43%|████▎     | 153/358 [00:15<00:21,  9.46it/s] 43%|████▎     | 154/358 [00:15<00:21,  9.55it/s] 43%|████▎     | 155/358 [00:15<00:21,  9.56it/s] 44%|████▎     | 156/358 [00:15<00:20,  9.68it/s] 44%|████▍     | 157/358 [00:16<00:20,  9.62it/s] 44%|████▍     | 158/358 [00:16<00:20,  9.71it/s] 44%|████▍     | 159/358 [00:16<00:20,  9.70it/s] 45%|████▍     | 160/358 [00:16<00:20,  9.71it/s] 45%|████▌     | 162/358 [00:16<00:19, 10.00it/s] 46%|████▌     | 164/358 [00:16<00:19, 10.01it/s] 46%|████▌     | 165/358 [00:16<00:19,  9.96it/s] 47%|████▋     | 167/358 [00:17<00:19,  9.91it/s] 47%|████▋     | 169/358 [00:17<00:19,  9.94it/s] 48%|████▊     | 171/358 [00:17<00:18,  9.92it/s] 48%|████▊     | 172/358 [00:17<00:18,  9.87it/s] 48%|████▊     | 173/358 [00:17<00:18,  9.81it/s] 49%|████▉     | 175/358 [00:17<00:18,  9.83it/s] 49%|████▉     | 176/358 [00:17<00:18,  9.85it/s] 49%|████▉     | 177/358 [00:18<00:18,  9.83it/s] 50%|█████     | 179/358 [00:18<00:18,  9.86it/s] 50%|█████     | 180/358 [00:18<00:18,  9.79it/s] 51%|█████     | 182/358 [00:18<00:17,  9.93it/s] 51%|█████     | 183/358 [00:18<00:17,  9.89it/s] 51%|█████▏    | 184/358 [00:18<00:17,  9.78it/s] 52%|█████▏    | 185/358 [00:18<00:17,  9.72it/s] 52%|█████▏    | 187/358 [00:19<00:17,  9.94it/s] 53%|█████▎    | 188/358 [00:19<00:17,  9.89it/s] 53%|█████▎    | 189/358 [00:19<00:17,  9.83it/s] 53%|█████▎    | 191/358 [00:19<00:17,  9.75it/s] 54%|█████▎    | 192/358 [00:19<00:17,  9.70it/s] 54%|█████▍    | 193/358 [00:19<00:17,  9.69it/s] 54%|█████▍    | 194/358 [00:19<00:16,  9.67it/s] 54%|█████▍    | 195/358 [00:19<00:16,  9.74it/s] 55%|█████▌    | 197/358 [00:20<00:16,  9.91it/s] 55%|█████▌    | 198/358 [00:20<00:16,  9.84it/s] 56%|█████▌    | 199/358 [00:20<00:16,  9.87it/s] 56%|█████▌    | 200/358 [00:20<00:16,  9.81it/s] 56%|█████▌    | 201/358 [00:20<00:16,  9.77it/s] 57%|█████▋    | 203/358 [00:20<00:15,  9.86it/s] 57%|█████▋    | 204/358 [00:20<00:15,  9.75it/s] 57%|█████▋    | 205/358 [00:20<00:15,  9.71it/s] 58%|█████▊    | 207/358 [00:21<00:15,  9.88it/s] 58%|█████▊    | 208/358 [00:21<00:15,  9.81it/s] 59%|█████▊    | 210/358 [00:21<00:15,  9.82it/s] 59%|█████▉    | 212/358 [00:21<00:14,  9.81it/s] 60%|█████▉    | 214/358 [00:21<00:14,  9.89it/s] 60%|██████    | 215/358 [00:21<00:14,  9.83it/s] 60%|██████    | 216/358 [00:22<00:14,  9.77it/s] 61%|██████    | 217/358 [00:22<00:14,  9.80it/s] 61%|██████    | 218/358 [00:22<00:14,  9.77it/s] 61%|██████    | 219/358 [00:22<00:14,  9.77it/s] 62%|██████▏   | 221/358 [00:22<00:13,  9.91it/s] 62%|██████▏   | 222/358 [00:22<00:13,  9.80it/s] 62%|██████▏   | 223/358 [00:22<00:13,  9.75it/s] 63%|██████▎   | 224/358 [00:22<00:13,  9.69it/s] 63%|██████▎   | 226/358 [00:23<00:13,  9.74it/s] 64%|██████▎   | 228/358 [00:23<00:13,  9.77it/s] 64%|██████▍   | 229/358 [00:23<00:13,  9.74it/s] 64%|██████▍   | 230/358 [00:23<00:13,  9.69it/s] 65%|██████▍   | 232/358 [00:23<00:12,  9.74it/s] 65%|██████▌   | 234/358 [00:23<00:12, 10.02it/s] 66%|██████▌   | 236/358 [00:24<00:12,  9.99it/s] 66%|██████▋   | 238/358 [00:24<00:11, 10.04it/s] 67%|██████▋   | 240/358 [00:24<00:11, 10.00it/s] 68%|██████▊   | 242/358 [00:24<00:11,  9.98it/s] 68%|██████▊   | 243/358 [00:24<00:11,  9.92it/s] 68%|██████▊   | 244/358 [00:24<00:11,  9.85it/s] 69%|██████▊   | 246/358 [00:25<00:11,  9.87it/s] 69%|██████▉   | 247/358 [00:25<00:11,  9.80it/s] 69%|██████▉   | 248/358 [00:25<00:11,  9.76it/s] 70%|██████▉   | 250/358 [00:25<00:10,  9.86it/s] 70%|███████   | 251/358 [00:25<00:10,  9.79it/s] 70%|███████   | 252/358 [00:25<00:10,  9.73it/s] 71%|███████   | 253/358 [00:25<00:10,  9.69it/s] 71%|███████   | 254/358 [00:25<00:10,  9.67it/s] 72%|███████▏  | 256/358 [00:26<00:10,  9.84it/s] 72%|███████▏  | 257/358 [00:26<00:10,  9.85it/s] 72%|███████▏  | 258/358 [00:26<00:10,  9.72it/s] 72%|███████▏  | 259/358 [00:26<00:10,  9.68it/s] 73%|███████▎  | 260/358 [00:26<00:10,  9.70it/s] 73%|███████▎  | 262/358 [00:26<00:09,  9.89it/s] 74%|███████▎  | 264/358 [00:26<00:09,  9.91it/s] 74%|███████▍  | 266/358 [00:27<00:09,  9.90it/s] 75%|███████▍  | 267/358 [00:27<00:09,  9.85it/s] 75%|███████▌  | 269/358 [00:27<00:08,  9.90it/s] 75%|███████▌  | 270/358 [00:27<00:08,  9.83it/s] 76%|███████▌  | 271/358 [00:27<00:08,  9.76it/s] 76%|███████▌  | 272/358 [00:27<00:08,  9.73it/s] 76%|███████▋  | 273/358 [00:27<00:08,  9.63it/s] 77%|███████▋  | 274/358 [00:27<00:08,  9.63it/s] 77%|███████▋  | 275/358 [00:28<00:08,  9.68it/s] 77%|███████▋  | 276/358 [00:28<00:08,  9.68it/s] 77%|███████▋  | 277/358 [00:28<00:08,  9.65it/s] 78%|███████▊  | 278/358 [00:28<00:08,  9.63it/s] 78%|███████▊  | 280/358 [00:28<00:07,  9.82it/s] 78%|███████▊  | 281/358 [00:28<00:07,  9.83it/s] 79%|███████▉  | 282/358 [00:28<00:07,  9.77it/s] 79%|███████▉  | 283/358 [00:28<00:07,  9.71it/s] 79%|███████▉  | 284/358 [00:28<00:07,  9.67it/s] 80%|███████▉  | 285/358 [00:29<00:07,  9.74it/s] 80%|███████▉  | 286/358 [00:29<00:07,  9.69it/s] 80%|████████  | 287/358 [00:29<00:07,  9.68it/s] 80%|████████  | 288/358 [00:29<00:07,  9.63it/s] 81%|████████  | 290/358 [00:29<00:06,  9.85it/s] 81%|████████▏ | 291/358 [00:29<00:06,  9.83it/s] 82%|████████▏ | 293/358 [00:29<00:06,  9.84it/s] 82%|████████▏ | 295/358 [00:30<00:06,  9.91it/s] 83%|████████▎ | 296/358 [00:30<00:06,  9.85it/s] 83%|████████▎ | 297/358 [00:30<00:06,  9.73it/s] 84%|████████▎ | 299/358 [00:30<00:05,  9.90it/s] 84%|████████▍ | 301/358 [00:30<00:05,  9.93it/s] 84%|████████▍ | 302/358 [00:30<00:05,  9.87it/s] 85%|████████▍ | 303/358 [00:30<00:05,  9.88it/s] 85%|████████▌ | 305/358 [00:31<00:05,  9.91it/s] 85%|████████▌ | 306/358 [00:31<00:05,  9.83it/s] 86%|████████▌ | 308/358 [00:31<00:05,  9.93it/s] 86%|████████▋ | 309/358 [00:31<00:04,  9.83it/s] 87%|████████▋ | 310/358 [00:31<00:04,  9.77it/s] 87%|████████▋ | 311/358 [00:31<00:04,  9.69it/s] 87%|████████▋ | 312/358 [00:31<00:04,  9.71it/s] 87%|████████▋ | 313/358 [00:31<00:04,  9.73it/s] 88%|████████▊ | 315/358 [00:32<00:04,  9.99it/s] 88%|████████▊ | 316/358 [00:32<00:04,  9.94it/s] 89%|████████▊ | 317/358 [00:32<00:04,  9.85it/s] 89%|████████▉ | 318/358 [00:32<00:04,  9.81it/s] 89%|████████▉ | 319/358 [00:32<00:03,  9.76it/s] 89%|████████▉ | 320/358 [00:32<00:03,  9.82it/s] 90%|████████▉ | 321/358 [00:32<00:03,  9.75it/s] 90%|████████▉ | 322/358 [00:32<00:03,  9.71it/s] 90%|█████████ | 323/358 [00:32<00:03,  9.66it/s] 91%|█████████ | 324/358 [00:33<00:03,  9.63it/s] 91%|█████████ | 325/358 [00:33<00:03,  9.61it/s] 91%|█████████▏| 327/358 [00:33<00:03,  9.97it/s] 92%|█████████▏| 329/358 [00:33<00:02, 10.07it/s] 92%|█████████▏| 330/358 [00:33<00:02,  9.96it/s] 93%|█████████▎| 332/358 [00:33<00:02, 10.06it/s] 93%|█████████▎| 334/358 [00:34<00:02,  9.97it/s] 94%|█████████▎| 335/358 [00:34<00:02,  9.85it/s] 94%|█████████▍| 337/358 [00:34<00:02,  9.92it/s] 95%|█████████▍| 339/358 [00:34<00:01, 10.12it/s] 95%|█████████▌| 341/358 [00:34<00:01, 10.06it/s] 96%|█████████▌| 343/358 [00:34<00:01,  9.90it/s] 96%|█████████▌| 344/358 [00:35<00:01,  9.85it/s] 96%|█████████▋| 345/358 [00:35<00:01,  9.87it/s] 97%|█████████▋| 347/358 [00:35<00:01, 10.04it/s] 97%|█████████▋| 348/358 [00:35<00:01,  9.94it/s] 97%|█████████▋| 349/358 [00:35<00:00,  9.87it/s] 98%|█████████▊| 350/358 [00:35<00:00,  9.79it/s] 98%|█████████▊| 351/358 [00:35<00:00,  9.75it/s] 99%|█████████▊| 353/358 [00:35<00:00,  9.93it/s] 99%|█████████▉| 354/358 [00:36<00:00,  9.91it/s] 99%|█████████▉| 355/358 [00:36<00:00,  9.82it/s]100%|█████████▉| 357/358 [00:36<00:00,  9.88it/s]100%|██████████| 358/358 [00:36<00:00,  9.83it/s]
[32m2025-02-05 06:05:22.165[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    gen_loss  grad clip ratio  grad norm   ppl
       1.908                1      2.547 6.741[0m
[32m2025-02-05 06:05:22.165[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m169[0m - [1m[Valid][0m
  0%|          | 0/10256 [00:00<?, ?it/s]100%|██████████| 10256/10256 [00:00<00:00, 990189.03it/s]
[32m2025-02-05 06:05:22.176[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:27,  1.43it/s]  5%|▌         | 2/40 [00:01<00:26,  1.45it/s]  8%|▊         | 3/40 [00:02<00:25,  1.45it/s] 10%|█         | 4/40 [00:02<00:24,  1.46it/s] 12%|█▎        | 5/40 [00:03<00:24,  1.45it/s] 15%|█▌        | 6/40 [00:04<00:23,  1.45it/s] 18%|█▊        | 7/40 [00:04<00:22,  1.45it/s] 20%|██        | 8/40 [00:05<00:22,  1.45it/s] 22%|██▎       | 9/40 [00:06<00:21,  1.45it/s] 25%|██▌       | 10/40 [00:06<00:20,  1.46it/s] 28%|██▊       | 11/40 [00:07<00:19,  1.46it/s] 30%|███       | 12/40 [00:08<00:19,  1.46it/s] 32%|███▎      | 13/40 [00:08<00:18,  1.46it/s] 35%|███▌      | 14/40 [00:09<00:17,  1.45it/s] 38%|███▊      | 15/40 [00:10<00:17,  1.45it/s] 40%|████      | 16/40 [00:11<00:16,  1.45it/s] 42%|████▎     | 17/40 [00:11<00:15,  1.45it/s] 45%|████▌     | 18/40 [00:12<00:15,  1.45it/s] 48%|████▊     | 19/40 [00:13<00:14,  1.45it/s] 50%|█████     | 20/40 [00:13<00:13,  1.46it/s] 52%|█████▎    | 21/40 [00:14<00:12,  1.46it/s] 55%|█████▌    | 22/40 [00:15<00:12,  1.46it/s] 57%|█████▊    | 23/40 [00:15<00:11,  1.45it/s] 60%|██████    | 24/40 [00:16<00:11,  1.45it/s] 62%|██████▎   | 25/40 [00:17<00:10,  1.45it/s] 65%|██████▌   | 26/40 [00:17<00:09,  1.46it/s] 68%|██████▊   | 27/40 [00:18<00:08,  1.46it/s] 70%|███████   | 28/40 [00:19<00:08,  1.46it/s] 72%|███████▎  | 29/40 [00:19<00:07,  1.46it/s] 75%|███████▌  | 30/40 [00:20<00:06,  1.46it/s] 78%|███████▊  | 31/40 [00:21<00:06,  1.46it/s] 80%|████████  | 32/40 [00:22<00:05,  1.46it/s] 82%|████████▎ | 33/40 [00:22<00:04,  1.45it/s] 85%|████████▌ | 34/40 [00:23<00:04,  1.46it/s] 88%|████████▊ | 35/40 [00:24<00:03,  1.45it/s] 90%|█████████ | 36/40 [00:24<00:02,  1.45it/s] 92%|█████████▎| 37/40 [00:25<00:02,  1.45it/s] 95%|█████████▌| 38/40 [00:26<00:01,  1.44it/s] 98%|█████████▊| 39/40 [00:26<00:00,  1.45it/s]100%|██████████| 40/40 [00:27<00:00,  1.59it/s]100%|██████████| 40/40 [00:27<00:00,  1.46it/s]
[32m2025-02-05 06:05:49.510[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    average  bleu@1  bleu@2  bleu@3  bleu@4  dist@1  dist@2  dist@3  dist@4  extreme  \
      .7780   .2919   .1096  .04308  .02025  .04566   .3139   .6057   .7741    .5932   
      f1  gen_loss  greedy  intra_dist@1  intra_dist@2  intra_dist@3  intra_dist@4  \
   .3483     5.036   .6661         .8676         .9673         .9534         .9198   
     ppl  rouge1  rouge2  rougeL  
   153.9   .3820  .09043   .3699[0m
[32m2025-02-05 06:05:49.516[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m163[0m - [1m[Conversation epoch 54][0m
[32m2025-02-05 06:05:49.516[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m164[0m - [1m[Train][0m
  0%|          | 0/92414 [00:00<?, ?it/s]100%|██████████| 92414/92414 [00:00<00:00, 1139563.92it/s]
[32m2025-02-05 06:05:49.598[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/358 [00:00<?, ?it/s]  0%|          | 1/358 [00:00<00:36,  9.78it/s]  1%|          | 3/358 [00:00<00:35,  9.95it/s]  1%|          | 4/358 [00:00<00:35,  9.92it/s]  2%|▏         | 6/358 [00:00<00:35,  9.88it/s]  2%|▏         | 7/358 [00:00<00:35,  9.82it/s]  2%|▏         | 8/358 [00:00<00:35,  9.87it/s]  3%|▎         | 9/358 [00:00<00:35,  9.77it/s]  3%|▎         | 10/358 [00:01<00:35,  9.76it/s]  3%|▎         | 11/358 [00:01<00:35,  9.70it/s]  4%|▎         | 13/358 [00:01<00:34,  9.93it/s]  4%|▍         | 14/358 [00:01<00:34,  9.85it/s]  4%|▍         | 15/358 [00:01<00:35,  9.78it/s]  4%|▍         | 16/358 [00:01<00:35,  9.71it/s]  5%|▍         | 17/358 [00:01<00:35,  9.73it/s]  5%|▌         | 19/358 [00:01<00:34,  9.76it/s]  6%|▌         | 20/358 [00:02<00:34,  9.70it/s]  6%|▌         | 21/358 [00:02<00:34,  9.64it/s]  6%|▌         | 22/358 [00:02<00:34,  9.70it/s]  7%|▋         | 24/358 [00:02<00:34,  9.78it/s]  7%|▋         | 25/358 [00:02<00:34,  9.73it/s]  7%|▋         | 26/358 [00:02<00:34,  9.68it/s]  8%|▊         | 27/358 [00:02<00:34,  9.72it/s]  8%|▊         | 28/358 [00:02<00:34,  9.67it/s]  8%|▊         | 29/358 [00:02<00:34,  9.64it/s]  9%|▊         | 31/358 [00:03<00:33,  9.74it/s]  9%|▉         | 32/358 [00:03<00:33,  9.74it/s]  9%|▉         | 34/358 [00:03<00:32,  9.84it/s] 10%|█         | 36/358 [00:03<00:32,  9.84it/s] 10%|█         | 37/358 [00:03<00:32,  9.82it/s] 11%|█         | 38/358 [00:03<00:32,  9.78it/s] 11%|█         | 40/358 [00:04<00:31,  9.94it/s] 11%|█▏        | 41/358 [00:04<00:32,  9.85it/s] 12%|█▏        | 43/358 [00:04<00:31,  9.88it/s] 13%|█▎        | 45/358 [00:04<00:31,  9.97it/s] 13%|█▎        | 47/358 [00:04<00:31,  9.95it/s] 13%|█▎        | 48/358 [00:04<00:31,  9.93it/s] 14%|█▍        | 50/358 [00:05<00:31,  9.91it/s] 14%|█▍        | 51/358 [00:05<00:31,  9.84it/s] 15%|█▍        | 52/358 [00:05<00:31,  9.75it/s] 15%|█▍        | 53/358 [00:05<00:31,  9.70it/s] 15%|█▌        | 54/358 [00:05<00:31,  9.74it/s] 15%|█▌        | 55/358 [00:05<00:31,  9.69it/s] 16%|█▌        | 56/358 [00:05<00:31,  9.73it/s] 16%|█▌        | 57/358 [00:05<00:31,  9.69it/s] 16%|█▌        | 58/358 [00:05<00:31,  9.67it/s] 16%|█▋        | 59/358 [00:06<00:31,  9.63it/s] 17%|█▋        | 61/358 [00:06<00:30,  9.72it/s] 17%|█▋        | 62/358 [00:06<00:30,  9.64it/s] 18%|█▊        | 63/358 [00:06<00:30,  9.71it/s] 18%|█▊        | 64/358 [00:06<00:30,  9.66it/s] 18%|█▊        | 66/358 [00:06<00:30,  9.73it/s] 19%|█▊        | 67/358 [00:06<00:29,  9.71it/s] 19%|█▉        | 69/358 [00:07<00:29,  9.77it/s] 20%|█▉        | 70/358 [00:07<00:29,  9.72it/s] 20%|█▉        | 71/358 [00:07<00:29,  9.77it/s] 20%|██        | 72/358 [00:07<00:29,  9.71it/s] 20%|██        | 73/358 [00:07<00:29,  9.68it/s] 21%|██        | 74/358 [00:07<00:29,  9.65it/s] 21%|██        | 75/358 [00:07<00:29,  9.62it/s] 21%|██        | 76/358 [00:07<00:29,  9.72it/s] 22%|██▏       | 77/358 [00:07<00:29,  9.69it/s] 22%|██▏       | 79/358 [00:08<00:28,  9.69it/s] 23%|██▎       | 81/358 [00:08<00:28,  9.75it/s] 23%|██▎       | 83/358 [00:08<00:28,  9.78it/s] 23%|██▎       | 84/358 [00:08<00:28,  9.73it/s] 24%|██▎       | 85/358 [00:08<00:28,  9.68it/s] 24%|██▍       | 86/358 [00:08<00:28,  9.67it/s] 24%|██▍       | 87/358 [00:08<00:28,  9.65it/s] 25%|██▍       | 88/358 [00:09<00:27,  9.67it/s] 25%|██▌       | 90/358 [00:09<00:27,  9.91it/s] 26%|██▌       | 92/358 [00:09<00:26, 10.01it/s] 26%|██▌       | 93/358 [00:09<00:26,  9.97it/s] 26%|██▋       | 94/358 [00:09<00:26,  9.88it/s] 27%|██▋       | 96/358 [00:09<00:25, 10.16it/s] 27%|██▋       | 98/358 [00:10<00:25, 10.05it/s] 28%|██▊       | 99/358 [00:10<00:26,  9.96it/s] 28%|██▊       | 101/358 [00:10<00:25,  9.93it/s] 29%|██▉       | 103/358 [00:10<00:25,  9.91it/s] 29%|██▉       | 104/358 [00:10<00:25,  9.87it/s] 29%|██▉       | 105/358 [00:10<00:25,  9.79it/s] 30%|██▉       | 106/358 [00:10<00:25,  9.77it/s] 30%|███       | 108/358 [00:11<00:25,  9.80it/s] 30%|███       | 109/358 [00:11<00:25,  9.72it/s] 31%|███       | 110/358 [00:11<00:25,  9.70it/s] 31%|███       | 111/358 [00:11<00:25,  9.65it/s] 32%|███▏      | 113/358 [00:11<00:24,  9.92it/s] 32%|███▏      | 114/358 [00:11<00:24,  9.87it/s] 32%|███▏      | 115/358 [00:11<00:24,  9.78it/s] 32%|███▏      | 116/358 [00:11<00:24,  9.69it/s] 33%|███▎      | 117/358 [00:11<00:24,  9.67it/s] 33%|███▎      | 119/358 [00:12<00:24,  9.78it/s] 34%|███▍      | 121/358 [00:12<00:23,  9.98it/s] 34%|███▍      | 123/358 [00:12<00:23, 10.08it/s] 35%|███▍      | 125/358 [00:12<00:23, 10.06it/s] 35%|███▌      | 127/358 [00:12<00:23,  9.99it/s] 36%|███▌      | 128/358 [00:13<00:23,  9.95it/s] 36%|███▋      | 130/358 [00:13<00:22,  9.99it/s] 37%|███▋      | 131/358 [00:13<00:22,  9.90it/s] 37%|███▋      | 132/358 [00:13<00:22,  9.92it/s] 37%|███▋      | 134/358 [00:13<00:22,  9.94it/s] 38%|███▊      | 135/358 [00:13<00:22,  9.88it/s] 38%|███▊      | 137/358 [00:13<00:22,  9.97it/s] 39%|███▊      | 138/358 [00:14<00:22,  9.95it/s] 39%|███▉      | 139/358 [00:14<00:22,  9.86it/s] 39%|███▉      | 141/358 [00:14<00:21,  9.98it/s] 40%|███▉      | 142/358 [00:14<00:21,  9.91it/s] 40%|███▉      | 143/358 [00:14<00:21,  9.87it/s] 40%|████      | 144/358 [00:14<00:21,  9.78it/s] 41%|████      | 145/358 [00:14<00:21,  9.80it/s] 41%|████      | 146/358 [00:14<00:21,  9.74it/s] 41%|████      | 147/358 [00:14<00:21,  9.68it/s] 41%|████▏     | 148/358 [00:15<00:21,  9.71it/s] 42%|████▏     | 149/358 [00:15<00:21,  9.69it/s] 42%|████▏     | 150/358 [00:15<00:21,  9.64it/s] 42%|████▏     | 151/358 [00:15<00:22,  9.38it/s] 42%|████▏     | 152/358 [00:15<00:21,  9.43it/s] 43%|████▎     | 153/358 [00:15<00:21,  9.45it/s] 43%|████▎     | 154/358 [00:15<00:21,  9.54it/s] 43%|████▎     | 155/358 [00:15<00:21,  9.56it/s] 44%|████▎     | 156/358 [00:15<00:20,  9.68it/s] 44%|████▍     | 157/358 [00:16<00:20,  9.62it/s] 44%|████▍     | 158/358 [00:16<00:20,  9.71it/s] 44%|████▍     | 159/358 [00:16<00:20,  9.70it/s] 45%|████▍     | 160/358 [00:16<00:20,  9.71it/s] 45%|████▌     | 162/358 [00:16<00:19, 10.01it/s] 46%|████▌     | 164/358 [00:16<00:19, 10.01it/s] 46%|████▌     | 165/358 [00:16<00:19,  9.97it/s] 47%|████▋     | 167/358 [00:17<00:19,  9.92it/s] 47%|████▋     | 169/358 [00:17<00:18,  9.96it/s] 48%|████▊     | 171/358 [00:17<00:18,  9.93it/s] 48%|████▊     | 172/358 [00:17<00:18,  9.88it/s] 48%|████▊     | 173/358 [00:17<00:18,  9.82it/s] 49%|████▉     | 175/358 [00:17<00:18,  9.84it/s] 49%|████▉     | 176/358 [00:17<00:18,  9.85it/s] 49%|████▉     | 177/358 [00:18<00:18,  9.84it/s] 50%|█████     | 179/358 [00:18<00:18,  9.86it/s] 50%|█████     | 180/358 [00:18<00:18,  9.79it/s] 51%|█████     | 182/358 [00:18<00:17,  9.94it/s] 51%|█████     | 183/358 [00:18<00:17,  9.90it/s] 51%|█████▏    | 184/358 [00:18<00:17,  9.78it/s] 52%|█████▏    | 185/358 [00:18<00:17,  9.73it/s] 52%|█████▏    | 187/358 [00:19<00:17,  9.94it/s] 53%|█████▎    | 188/358 [00:19<00:17,  9.89it/s] 53%|█████▎    | 189/358 [00:19<00:17,  9.83it/s] 53%|█████▎    | 191/358 [00:19<00:17,  9.75it/s] 54%|█████▎    | 192/358 [00:19<00:17,  9.70it/s] 54%|█████▍    | 193/358 [00:19<00:17,  9.70it/s] 54%|█████▍    | 194/358 [00:19<00:16,  9.67it/s] 54%|█████▍    | 195/358 [00:19<00:16,  9.75it/s] 55%|█████▌    | 197/358 [00:20<00:16,  9.92it/s] 55%|█████▌    | 198/358 [00:20<00:16,  9.84it/s] 56%|█████▌    | 199/358 [00:20<00:16,  9.87it/s] 56%|█████▌    | 200/358 [00:20<00:16,  9.81it/s] 56%|█████▌    | 201/358 [00:20<00:16,  9.77it/s] 57%|█████▋    | 203/358 [00:20<00:15,  9.86it/s] 57%|█████▋    | 204/358 [00:20<00:15,  9.75it/s] 57%|█████▋    | 205/358 [00:20<00:15,  9.70it/s] 58%|█████▊    | 207/358 [00:21<00:15,  9.88it/s] 58%|█████▊    | 208/358 [00:21<00:15,  9.81it/s] 59%|█████▊    | 210/358 [00:21<00:15,  9.82it/s] 59%|█████▉    | 212/358 [00:21<00:14,  9.82it/s] 60%|█████▉    | 214/358 [00:21<00:14,  9.89it/s] 60%|██████    | 215/358 [00:21<00:14,  9.83it/s] 60%|██████    | 216/358 [00:22<00:14,  9.77it/s] 61%|██████    | 217/358 [00:22<00:14,  9.80it/s] 61%|██████    | 218/358 [00:22<00:14,  9.78it/s] 61%|██████    | 219/358 [00:22<00:14,  9.78it/s] 62%|██████▏   | 221/358 [00:22<00:13,  9.91it/s] 62%|██████▏   | 222/358 [00:22<00:13,  9.81it/s] 62%|██████▏   | 223/358 [00:22<00:13,  9.75it/s] 63%|██████▎   | 224/358 [00:22<00:13,  9.69it/s] 63%|██████▎   | 226/358 [00:23<00:13,  9.74it/s] 64%|██████▎   | 228/358 [00:23<00:13,  9.77it/s] 64%|██████▍   | 229/358 [00:23<00:13,  9.74it/s] 64%|██████▍   | 230/358 [00:23<00:13,  9.69it/s] 65%|██████▍   | 232/358 [00:23<00:12,  9.74it/s] 65%|██████▌   | 234/358 [00:23<00:12, 10.02it/s] 66%|██████▌   | 236/358 [00:24<00:12,  9.98it/s] 66%|██████▋   | 238/358 [00:24<00:11, 10.03it/s] 67%|██████▋   | 240/358 [00:24<00:11, 10.00it/s] 68%|██████▊   | 242/358 [00:24<00:11,  9.98it/s] 68%|██████▊   | 243/358 [00:24<00:11,  9.91it/s] 68%|██████▊   | 244/358 [00:24<00:11,  9.85it/s] 69%|██████▊   | 246/358 [00:25<00:11,  9.87it/s] 69%|██████▉   | 247/358 [00:25<00:11,  9.80it/s] 69%|██████▉   | 248/358 [00:25<00:11,  9.75it/s] 70%|██████▉   | 250/358 [00:25<00:10,  9.85it/s] 70%|███████   | 251/358 [00:25<00:10,  9.79it/s] 70%|███████   | 252/358 [00:25<00:10,  9.73it/s] 71%|███████   | 253/358 [00:25<00:10,  9.69it/s] 71%|███████   | 254/358 [00:25<00:10,  9.66it/s] 72%|███████▏  | 256/358 [00:26<00:10,  9.84it/s] 72%|███████▏  | 257/358 [00:26<00:10,  9.84it/s] 72%|███████▏  | 258/358 [00:26<00:10,  9.72it/s] 72%|███████▏  | 259/358 [00:26<00:10,  9.68it/s] 73%|███████▎  | 260/358 [00:26<00:10,  9.72it/s] 73%|███████▎  | 262/358 [00:26<00:09,  9.90it/s] 74%|███████▎  | 264/358 [00:26<00:09,  9.92it/s] 74%|███████▍  | 266/358 [00:27<00:09,  9.91it/s] 75%|███████▍  | 267/358 [00:27<00:09,  9.85it/s] 75%|███████▌  | 269/358 [00:27<00:08,  9.90it/s] 75%|███████▌  | 270/358 [00:27<00:08,  9.82it/s] 76%|███████▌  | 271/358 [00:27<00:08,  9.75it/s] 76%|███████▌  | 272/358 [00:27<00:08,  9.73it/s] 76%|███████▋  | 273/358 [00:27<00:08,  9.63it/s] 77%|███████▋  | 274/358 [00:27<00:08,  9.63it/s] 77%|███████▋  | 275/358 [00:28<00:08,  9.68it/s] 77%|███████▋  | 276/358 [00:28<00:08,  9.68it/s] 77%|███████▋  | 277/358 [00:28<00:08,  9.65it/s] 78%|███████▊  | 278/358 [00:28<00:08,  9.63it/s] 78%|███████▊  | 280/358 [00:28<00:07,  9.82it/s] 78%|███████▊  | 281/358 [00:28<00:07,  9.83it/s] 79%|███████▉  | 282/358 [00:28<00:07,  9.77it/s] 79%|███████▉  | 283/358 [00:28<00:07,  9.71it/s] 79%|███████▉  | 284/358 [00:28<00:07,  9.68it/s] 80%|███████▉  | 285/358 [00:29<00:07,  9.74it/s] 80%|███████▉  | 286/358 [00:29<00:07,  9.70it/s] 80%|████████  | 287/358 [00:29<00:07,  9.67it/s] 80%|████████  | 288/358 [00:29<00:07,  9.63it/s] 81%|████████  | 289/358 [00:29<00:07,  9.74it/s] 81%|████████▏ | 291/358 [00:29<00:06,  9.85it/s] 82%|████████▏ | 293/358 [00:29<00:06,  9.85it/s] 82%|████████▏ | 295/358 [00:30<00:06,  9.92it/s] 83%|████████▎ | 296/358 [00:30<00:06,  9.85it/s] 83%|████████▎ | 297/358 [00:30<00:06,  9.75it/s] 84%|████████▎ | 299/358 [00:30<00:05,  9.90it/s] 84%|████████▍ | 301/358 [00:30<00:05,  9.94it/s] 84%|████████▍ | 302/358 [00:30<00:05,  9.87it/s] 85%|████████▍ | 303/358 [00:30<00:05,  9.88it/s] 85%|████████▌ | 305/358 [00:31<00:05,  9.91it/s] 85%|████████▌ | 306/358 [00:31<00:05,  9.83it/s] 86%|████████▌ | 308/358 [00:31<00:05,  9.93it/s] 86%|████████▋ | 309/358 [00:31<00:04,  9.83it/s] 87%|████████▋ | 310/358 [00:31<00:04,  9.77it/s] 87%|████████▋ | 311/358 [00:31<00:04,  9.69it/s] 87%|████████▋ | 312/358 [00:31<00:04,  9.71it/s] 87%|████████▋ | 313/358 [00:31<00:04,  9.73it/s] 88%|████████▊ | 315/358 [00:32<00:04,  9.99it/s] 88%|████████▊ | 316/358 [00:32<00:04,  9.94it/s] 89%|████████▊ | 317/358 [00:32<00:04,  9.85it/s] 89%|████████▉ | 318/358 [00:32<00:04,  9.81it/s] 89%|████████▉ | 319/358 [00:32<00:03,  9.76it/s] 89%|████████▉ | 320/358 [00:32<00:03,  9.82it/s] 90%|████████▉ | 321/358 [00:32<00:03,  9.75it/s] 90%|████████▉ | 322/358 [00:32<00:03,  9.71it/s] 90%|█████████ | 323/358 [00:32<00:03,  9.66it/s] 91%|█████████ | 324/358 [00:33<00:03,  9.63it/s] 91%|█████████ | 325/358 [00:33<00:03,  9.61it/s] 91%|█████████▏| 327/358 [00:33<00:03,  9.98it/s] 92%|█████████▏| 329/358 [00:33<00:02, 10.08it/s] 92%|█████████▏| 330/358 [00:33<00:02,  9.97it/s] 93%|█████████▎| 332/358 [00:33<00:02, 10.07it/s] 93%|█████████▎| 334/358 [00:34<00:02,  9.97it/s] 94%|█████████▎| 335/358 [00:34<00:02,  9.84it/s] 94%|█████████▍| 337/358 [00:34<00:02,  9.92it/s] 95%|█████████▍| 339/358 [00:34<00:01, 10.12it/s] 95%|█████████▌| 341/358 [00:34<00:01, 10.06it/s] 96%|█████████▌| 343/358 [00:34<00:01,  9.90it/s] 96%|█████████▌| 344/358 [00:35<00:01,  9.84it/s] 96%|█████████▋| 345/358 [00:35<00:01,  9.86it/s] 97%|█████████▋| 347/358 [00:35<00:01, 10.04it/s] 97%|█████████▋| 348/358 [00:35<00:01,  9.94it/s] 97%|█████████▋| 349/358 [00:35<00:00,  9.86it/s] 98%|█████████▊| 350/358 [00:35<00:00,  9.79it/s] 98%|█████████▊| 351/358 [00:35<00:00,  9.74it/s] 99%|█████████▊| 353/358 [00:35<00:00,  9.92it/s] 99%|█████████▉| 354/358 [00:36<00:00,  9.91it/s] 99%|█████████▉| 355/358 [00:36<00:00,  9.82it/s]100%|█████████▉| 357/358 [00:36<00:00,  9.87it/s]100%|██████████| 358/358 [00:36<00:00,  9.83it/s]
[32m2025-02-05 06:06:26.032[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    gen_loss  grad clip ratio  grad norm   ppl
       1.897                1       3.02 6.669[0m
[32m2025-02-05 06:06:26.032[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m169[0m - [1m[Valid][0m
  0%|          | 0/10256 [00:00<?, ?it/s]100%|██████████| 10256/10256 [00:00<00:00, 1041492.91it/s]
[32m2025-02-05 06:06:26.042[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:27,  1.43it/s]  5%|▌         | 2/40 [00:01<00:26,  1.44it/s]  8%|▊         | 3/40 [00:02<00:25,  1.45it/s] 10%|█         | 4/40 [00:02<00:24,  1.45it/s] 12%|█▎        | 5/40 [00:03<00:24,  1.44it/s] 15%|█▌        | 6/40 [00:04<00:23,  1.44it/s] 18%|█▊        | 7/40 [00:04<00:22,  1.44it/s] 20%|██        | 8/40 [00:05<00:22,  1.45it/s] 22%|██▎       | 9/40 [00:06<00:21,  1.45it/s] 25%|██▌       | 10/40 [00:06<00:20,  1.45it/s] 28%|██▊       | 11/40 [00:07<00:19,  1.45it/s] 30%|███       | 12/40 [00:08<00:19,  1.45it/s] 32%|███▎      | 13/40 [00:08<00:18,  1.46it/s] 35%|███▌      | 14/40 [00:09<00:17,  1.45it/s] 38%|███▊      | 15/40 [00:10<00:17,  1.45it/s] 40%|████      | 16/40 [00:11<00:16,  1.44it/s] 42%|████▎     | 17/40 [00:11<00:15,  1.45it/s] 45%|████▌     | 18/40 [00:12<00:15,  1.45it/s] 48%|████▊     | 19/40 [00:13<00:14,  1.45it/s] 50%|█████     | 20/40 [00:13<00:13,  1.46it/s] 52%|█████▎    | 21/40 [00:14<00:13,  1.46it/s] 55%|█████▌    | 22/40 [00:15<00:12,  1.45it/s] 57%|█████▊    | 23/40 [00:15<00:11,  1.45it/s] 60%|██████    | 24/40 [00:16<00:11,  1.45it/s] 62%|██████▎   | 25/40 [00:17<00:10,  1.44it/s] 65%|██████▌   | 26/40 [00:17<00:09,  1.45it/s] 68%|██████▊   | 27/40 [00:18<00:08,  1.45it/s] 70%|███████   | 28/40 [00:19<00:08,  1.45it/s] 72%|███████▎  | 29/40 [00:19<00:07,  1.45it/s] 75%|███████▌  | 30/40 [00:20<00:06,  1.46it/s] 78%|███████▊  | 31/40 [00:21<00:06,  1.45it/s] 80%|████████  | 32/40 [00:22<00:05,  1.46it/s] 82%|████████▎ | 33/40 [00:22<00:04,  1.45it/s] 85%|████████▌ | 34/40 [00:23<00:04,  1.45it/s] 88%|████████▊ | 35/40 [00:24<00:03,  1.45it/s] 90%|█████████ | 36/40 [00:24<00:02,  1.44it/s] 92%|█████████▎| 37/40 [00:25<00:02,  1.44it/s] 95%|█████████▌| 38/40 [00:26<00:01,  1.44it/s] 98%|█████████▊| 39/40 [00:26<00:00,  1.44it/s]100%|██████████| 40/40 [00:27<00:00,  1.59it/s]100%|██████████| 40/40 [00:27<00:00,  1.46it/s]
[32m2025-02-05 06:06:53.452[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    average  bleu@1  bleu@2  bleu@3  bleu@4  dist@1  dist@2  dist@3  dist@4  extreme  \
      .7807   .2956   .1091  .03918  .01811  .04734   .3258   .6316   .8115    .5965   
      f1  gen_loss  greedy  intra_dist@1  intra_dist@2  intra_dist@3  intra_dist@4  \
   .3515     5.055   .6675         .8726         .9787         .9618         .9295   
     ppl  rouge1  rouge2  rougeL  
   156.8   .3806  .08802   .3681[0m
[32m2025-02-05 06:06:53.460[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m163[0m - [1m[Conversation epoch 55][0m
[32m2025-02-05 06:06:53.460[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m164[0m - [1m[Train][0m
  0%|          | 0/92414 [00:00<?, ?it/s]100%|██████████| 92414/92414 [00:00<00:00, 999389.99it/s]
[32m2025-02-05 06:06:53.553[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/358 [00:00<?, ?it/s]  0%|          | 1/358 [00:00<00:36,  9.77it/s]  1%|          | 3/358 [00:00<00:35,  9.94it/s]  1%|          | 4/358 [00:00<00:35,  9.91it/s]  2%|▏         | 6/358 [00:00<00:35,  9.88it/s]  2%|▏         | 7/358 [00:00<00:35,  9.81it/s]  2%|▏         | 8/358 [00:00<00:35,  9.85it/s]  3%|▎         | 9/358 [00:00<00:35,  9.76it/s]  3%|▎         | 10/358 [00:01<00:35,  9.74it/s]  3%|▎         | 11/358 [00:01<00:35,  9.70it/s]  4%|▎         | 13/358 [00:01<00:34,  9.92it/s]  4%|▍         | 14/358 [00:01<00:34,  9.84it/s]  4%|▍         | 15/358 [00:01<00:35,  9.77it/s]  4%|▍         | 16/358 [00:01<00:35,  9.71it/s]  5%|▍         | 17/358 [00:01<00:35,  9.72it/s]  5%|▌         | 19/358 [00:01<00:34,  9.75it/s]  6%|▌         | 20/358 [00:02<00:34,  9.69it/s]  6%|▌         | 21/358 [00:02<00:35,  9.63it/s]  6%|▌         | 22/358 [00:02<00:34,  9.68it/s]  7%|▋         | 24/358 [00:02<00:34,  9.77it/s]  7%|▋         | 25/358 [00:02<00:34,  9.72it/s]  7%|▋         | 26/358 [00:02<00:34,  9.67it/s]  8%|▊         | 27/358 [00:02<00:34,  9.73it/s]  8%|▊         | 28/358 [00:02<00:34,  9.68it/s]  8%|▊         | 29/358 [00:02<00:34,  9.65it/s]  9%|▊         | 31/358 [00:03<00:33,  9.75it/s]  9%|▉         | 32/358 [00:03<00:33,  9.75it/s]  9%|▉         | 34/358 [00:03<00:32,  9.84it/s] 10%|█         | 36/358 [00:03<00:32,  9.84it/s] 10%|█         | 37/358 [00:03<00:32,  9.82it/s] 11%|█         | 38/358 [00:03<00:32,  9.78it/s] 11%|█         | 40/358 [00:04<00:31,  9.94it/s] 11%|█▏        | 41/358 [00:04<00:32,  9.85it/s] 12%|█▏        | 43/358 [00:04<00:31,  9.88it/s] 13%|█▎        | 45/358 [00:04<00:31,  9.98it/s] 13%|█▎        | 47/358 [00:04<00:31,  9.95it/s] 13%|█▎        | 48/358 [00:04<00:31,  9.94it/s] 14%|█▍        | 50/358 [00:05<00:31,  9.91it/s] 14%|█▍        | 51/358 [00:05<00:31,  9.84it/s] 15%|█▍        | 52/358 [00:05<00:31,  9.76it/s] 15%|█▍        | 53/358 [00:05<00:31,  9.71it/s] 15%|█▌        | 54/358 [00:05<00:31,  9.75it/s] 15%|█▌        | 55/358 [00:05<00:31,  9.70it/s] 16%|█▌        | 56/358 [00:05<00:31,  9.74it/s] 16%|█▌        | 57/358 [00:05<00:31,  9.70it/s] 16%|█▌        | 58/358 [00:05<00:31,  9.67it/s] 16%|█▋        | 59/358 [00:06<00:31,  9.64it/s] 17%|█▋        | 61/358 [00:06<00:30,  9.73it/s] 17%|█▋        | 62/358 [00:06<00:30,  9.65it/s] 18%|█▊        | 63/358 [00:06<00:30,  9.71it/s] 18%|█▊        | 64/358 [00:06<00:30,  9.67it/s] 18%|█▊        | 66/358 [00:06<00:29,  9.74it/s] 19%|█▊        | 67/358 [00:06<00:29,  9.72it/s] 19%|█▉        | 69/358 [00:07<00:29,  9.79it/s] 20%|█▉        | 70/358 [00:07<00:29,  9.73it/s] 20%|█▉        | 71/358 [00:07<00:29,  9.77it/s] 20%|██        | 72/358 [00:07<00:29,  9.72it/s] 20%|██        | 73/358 [00:07<00:29,  9.69it/s] 21%|██        | 74/358 [00:07<00:29,  9.65it/s] 21%|██        | 75/358 [00:07<00:29,  9.62it/s] 21%|██        | 76/358 [00:07<00:29,  9.72it/s] 22%|██▏       | 77/358 [00:07<00:28,  9.69it/s] 22%|██▏       | 79/358 [00:08<00:28,  9.70it/s] 23%|██▎       | 81/358 [00:08<00:28,  9.76it/s] 23%|██▎       | 83/358 [00:08<00:28,  9.78it/s] 23%|██▎       | 84/358 [00:08<00:28,  9.73it/s] 24%|██▎       | 85/358 [00:08<00:28,  9.69it/s] 24%|██▍       | 86/358 [00:08<00:28,  9.67it/s] 24%|██▍       | 87/358 [00:08<00:28,  9.65it/s] 25%|██▍       | 88/358 [00:09<00:27,  9.67it/s] 25%|██▌       | 90/358 [00:09<00:27,  9.91it/s] 26%|██▌       | 92/358 [00:09<00:26, 10.01it/s] 26%|██▌       | 93/358 [00:09<00:26,  9.98it/s] 26%|██▋       | 94/358 [00:09<00:26,  9.89it/s] 27%|██▋       | 96/358 [00:09<00:25, 10.17it/s] 27%|██▋       | 98/358 [00:10<00:25, 10.06it/s] 28%|██▊       | 100/358 [00:10<00:25, 10.01it/s] 28%|██▊       | 101/358 [00:10<00:25,  9.92it/s] 29%|██▉       | 103/358 [00:10<00:25,  9.91it/s] 29%|██▉       | 104/358 [00:10<00:25,  9.87it/s] 29%|██▉       | 105/358 [00:10<00:25,  9.79it/s] 30%|██▉       | 106/358 [00:10<00:25,  9.77it/s] 30%|███       | 108/358 [00:11<00:25,  9.80it/s] 30%|███       | 109/358 [00:11<00:25,  9.72it/s] 31%|███       | 110/358 [00:11<00:25,  9.70it/s] 31%|███       | 111/358 [00:11<00:25,  9.65it/s] 32%|███▏      | 113/358 [00:11<00:24,  9.92it/s] 32%|███▏      | 114/358 [00:11<00:24,  9.88it/s] 32%|███▏      | 115/358 [00:11<00:24,  9.78it/s] 32%|███▏      | 116/358 [00:11<00:24,  9.70it/s] 33%|███▎      | 117/358 [00:11<00:24,  9.67it/s] 33%|███▎      | 119/358 [00:12<00:24,  9.79it/s] 34%|███▍      | 121/358 [00:12<00:23,  9.99it/s] 34%|███▍      | 123/358 [00:12<00:23, 10.09it/s] 35%|███▍      | 125/358 [00:12<00:23, 10.06it/s] 35%|███▌      | 127/358 [00:12<00:23,  9.99it/s] 36%|███▌      | 128/358 [00:13<00:23,  9.95it/s] 36%|███▋      | 130/358 [00:13<00:22, 10.00it/s] 37%|███▋      | 131/358 [00:13<00:22,  9.90it/s] 37%|███▋      | 132/358 [00:13<00:22,  9.92it/s] 37%|███▋      | 134/358 [00:13<00:22,  9.94it/s] 38%|███▊      | 135/358 [00:13<00:22,  9.88it/s] 38%|███▊      | 137/358 [00:13<00:22,  9.96it/s] 39%|███▊      | 138/358 [00:14<00:22,  9.95it/s] 39%|███▉      | 139/358 [00:14<00:22,  9.86it/s] 39%|███▉      | 141/358 [00:14<00:21,  9.99it/s] 40%|███▉      | 142/358 [00:14<00:21,  9.91it/s] 40%|███▉      | 143/358 [00:14<00:21,  9.88it/s] 40%|████      | 144/358 [00:14<00:21,  9.79it/s] 41%|████      | 145/358 [00:14<00:21,  9.81it/s] 41%|████      | 146/358 [00:14<00:21,  9.75it/s] 41%|████      | 147/358 [00:14<00:21,  9.69it/s] 41%|████▏     | 148/358 [00:15<00:21,  9.72it/s] 42%|████▏     | 149/358 [00:15<00:21,  9.70it/s] 42%|████▏     | 150/358 [00:15<00:21,  9.66it/s] 42%|████▏     | 151/358 [00:15<00:22,  9.39it/s] 42%|████▏     | 152/358 [00:15<00:21,  9.44it/s] 43%|████▎     | 153/358 [00:15<00:21,  9.46it/s] 43%|████▎     | 154/358 [00:15<00:21,  9.55it/s] 43%|████▎     | 155/358 [00:15<00:21,  9.56it/s] 44%|████▎     | 156/358 [00:15<00:20,  9.69it/s] 44%|████▍     | 157/358 [00:16<00:20,  9.63it/s] 44%|████▍     | 158/358 [00:16<00:20,  9.71it/s] 44%|████▍     | 159/358 [00:16<00:20,  9.71it/s] 45%|████▍     | 160/358 [00:16<00:20,  9.72it/s] 45%|████▌     | 162/358 [00:16<00:19, 10.01it/s] 46%|████▌     | 164/358 [00:16<00:19, 10.01it/s] 46%|████▌     | 165/358 [00:16<00:19,  9.97it/s] 47%|████▋     | 167/358 [00:17<00:19,  9.91it/s] 47%|████▋     | 169/358 [00:17<00:18,  9.95it/s] 48%|████▊     | 171/358 [00:17<00:18,  9.93it/s] 48%|████▊     | 172/358 [00:17<00:18,  9.87it/s] 48%|████▊     | 173/358 [00:17<00:18,  9.81it/s] 49%|████▉     | 175/358 [00:17<00:18,  9.84it/s] 49%|████▉     | 176/358 [00:17<00:18,  9.85it/s] 49%|████▉     | 177/358 [00:18<00:18,  9.84it/s] 50%|█████     | 179/358 [00:18<00:18,  9.86it/s] 50%|█████     | 180/358 [00:18<00:18,  9.79it/s] 51%|█████     | 182/358 [00:18<00:17,  9.95it/s] 51%|█████     | 183/358 [00:18<00:17,  9.90it/s] 51%|█████▏    | 184/358 [00:18<00:17,  9.79it/s] 52%|█████▏    | 185/358 [00:18<00:17,  9.73it/s] 52%|█████▏    | 187/358 [00:19<00:17,  9.95it/s] 53%|█████▎    | 188/358 [00:19<00:17,  9.90it/s] 53%|█████▎    | 189/358 [00:19<00:17,  9.84it/s] 53%|█████▎    | 191/358 [00:19<00:17,  9.76it/s] 54%|█████▎    | 192/358 [00:19<00:17,  9.71it/s] 54%|█████▍    | 193/358 [00:19<00:17,  9.70it/s] 54%|█████▍    | 194/358 [00:19<00:16,  9.68it/s] 54%|█████▍    | 195/358 [00:19<00:16,  9.75it/s] 55%|█████▌    | 197/358 [00:20<00:16,  9.92it/s] 55%|█████▌    | 198/358 [00:20<00:16,  9.85it/s] 56%|█████▌    | 199/358 [00:20<00:16,  9.88it/s] 56%|█████▌    | 200/358 [00:20<00:16,  9.81it/s] 56%|█████▌    | 201/358 [00:20<00:16,  9.77it/s] 57%|█████▋    | 203/358 [00:20<00:15,  9.86it/s] 57%|█████▋    | 204/358 [00:20<00:15,  9.76it/s] 57%|█████▋    | 205/358 [00:20<00:15,  9.72it/s] 58%|█████▊    | 207/358 [00:21<00:15,  9.88it/s] 58%|█████▊    | 208/358 [00:21<00:15,  9.81it/s] 59%|█████▊    | 210/358 [00:21<00:15,  9.83it/s] 59%|█████▉    | 212/358 [00:21<00:14,  9.82it/s] 60%|█████▉    | 214/358 [00:21<00:14,  9.90it/s] 60%|██████    | 215/358 [00:21<00:14,  9.84it/s] 60%|██████    | 216/358 [00:22<00:14,  9.77it/s] 61%|██████    | 217/358 [00:22<00:14,  9.81it/s] 61%|██████    | 218/358 [00:22<00:14,  9.78it/s] 61%|██████    | 219/358 [00:22<00:14,  9.78it/s] 62%|██████▏   | 221/358 [00:22<00:13,  9.91it/s] 62%|██████▏   | 222/358 [00:22<00:13,  9.81it/s] 62%|██████▏   | 223/358 [00:22<00:13,  9.75it/s] 63%|██████▎   | 224/358 [00:22<00:13,  9.69it/s] 63%|██████▎   | 226/358 [00:23<00:13,  9.74it/s] 64%|██████▎   | 228/358 [00:23<00:13,  9.77it/s] 64%|██████▍   | 229/358 [00:23<00:13,  9.74it/s] 64%|██████▍   | 230/358 [00:23<00:13,  9.69it/s] 65%|██████▍   | 232/358 [00:23<00:12,  9.74it/s] 65%|██████▌   | 234/358 [00:23<00:12, 10.02it/s] 66%|██████▌   | 236/358 [00:24<00:12,  9.98it/s] 66%|██████▋   | 238/358 [00:24<00:11, 10.04it/s] 67%|██████▋   | 240/358 [00:24<00:11, 10.00it/s] 68%|██████▊   | 242/358 [00:24<00:11,  9.98it/s] 68%|██████▊   | 243/358 [00:24<00:11,  9.92it/s] 68%|██████▊   | 244/358 [00:24<00:11,  9.85it/s] 69%|██████▊   | 246/358 [00:25<00:11,  9.87it/s] 69%|██████▉   | 247/358 [00:25<00:11,  9.80it/s] 69%|██████▉   | 248/358 [00:25<00:11,  9.76it/s] 70%|██████▉   | 250/358 [00:25<00:10,  9.85it/s] 70%|███████   | 251/358 [00:25<00:10,  9.79it/s] 70%|███████   | 252/358 [00:25<00:10,  9.73it/s] 71%|███████   | 253/358 [00:25<00:10,  9.69it/s] 71%|███████   | 254/358 [00:25<00:10,  9.66it/s] 72%|███████▏  | 256/358 [00:26<00:10,  9.84it/s] 72%|███████▏  | 257/358 [00:26<00:10,  9.85it/s] 72%|███████▏  | 258/358 [00:26<00:10,  9.72it/s] 72%|███████▏  | 259/358 [00:26<00:10,  9.68it/s] 73%|███████▎  | 260/358 [00:26<00:10,  9.72it/s] 73%|███████▎  | 262/358 [00:26<00:09,  9.90it/s] 74%|███████▎  | 264/358 [00:26<00:09,  9.92it/s] 74%|███████▍  | 266/358 [00:27<00:09,  9.91it/s] 75%|███████▍  | 267/358 [00:27<00:09,  9.85it/s] 75%|███████▌  | 269/358 [00:27<00:08,  9.91it/s] 75%|███████▌  | 270/358 [00:27<00:08,  9.83it/s] 76%|███████▌  | 271/358 [00:27<00:08,  9.76it/s] 76%|███████▌  | 272/358 [00:27<00:08,  9.74it/s] 76%|███████▋  | 273/358 [00:27<00:08,  9.64it/s] 77%|███████▋  | 274/358 [00:27<00:08,  9.64it/s] 77%|███████▋  | 275/358 [00:28<00:08,  9.69it/s] 77%|███████▋  | 276/358 [00:28<00:08,  9.69it/s] 77%|███████▋  | 277/358 [00:28<00:08,  9.66it/s] 78%|███████▊  | 278/358 [00:28<00:08,  9.64it/s] 78%|███████▊  | 280/358 [00:28<00:07,  9.83it/s] 78%|███████▊  | 281/358 [00:28<00:07,  9.84it/s] 79%|███████▉  | 282/358 [00:28<00:07,  9.78it/s] 79%|███████▉  | 283/358 [00:28<00:07,  9.72it/s] 79%|███████▉  | 284/358 [00:28<00:07,  9.68it/s] 80%|███████▉  | 285/358 [00:29<00:07,  9.75it/s] 80%|███████▉  | 286/358 [00:29<00:07,  9.70it/s] 80%|████████  | 287/358 [00:29<00:07,  9.68it/s] 80%|████████  | 288/358 [00:29<00:07,  9.64it/s] 81%|████████  | 290/358 [00:29<00:06,  9.85it/s] 81%|████████▏ | 291/358 [00:29<00:06,  9.83it/s] 82%|████████▏ | 293/358 [00:29<00:06,  9.84it/s] 82%|████████▏ | 295/358 [00:30<00:06,  9.91it/s] 83%|████████▎ | 296/358 [00:30<00:06,  9.85it/s] 83%|████████▎ | 297/358 [00:30<00:06,  9.74it/s] 84%|████████▎ | 299/358 [00:30<00:05,  9.90it/s] 84%|████████▍ | 301/358 [00:30<00:05,  9.94it/s] 84%|████████▍ | 302/358 [00:30<00:05,  9.87it/s] 85%|████████▍ | 303/358 [00:30<00:05,  9.88it/s] 85%|████████▌ | 305/358 [00:31<00:05,  9.91it/s] 85%|████████▌ | 306/358 [00:31<00:05,  9.83it/s] 86%|████████▌ | 308/358 [00:31<00:05,  9.93it/s] 86%|████████▋ | 309/358 [00:31<00:04,  9.83it/s] 87%|████████▋ | 310/358 [00:31<00:04,  9.78it/s] 87%|████████▋ | 311/358 [00:31<00:04,  9.70it/s] 87%|████████▋ | 312/358 [00:31<00:04,  9.71it/s] 87%|████████▋ | 313/358 [00:31<00:04,  9.73it/s] 88%|████████▊ | 315/358 [00:32<00:04,  9.99it/s] 88%|████████▊ | 316/358 [00:32<00:04,  9.94it/s] 89%|████████▊ | 317/358 [00:32<00:04,  9.85it/s] 89%|████████▉ | 318/358 [00:32<00:04,  9.81it/s] 89%|████████▉ | 319/358 [00:32<00:03,  9.76it/s] 89%|████████▉ | 320/358 [00:32<00:03,  9.82it/s] 90%|████████▉ | 321/358 [00:32<00:03,  9.75it/s] 90%|████████▉ | 322/358 [00:32<00:03,  9.71it/s] 90%|█████████ | 323/358 [00:32<00:03,  9.66it/s] 91%|█████████ | 324/358 [00:33<00:03,  9.63it/s] 91%|█████████ | 325/358 [00:33<00:03,  9.62it/s] 91%|█████████▏| 327/358 [00:33<00:03,  9.98it/s] 92%|█████████▏| 329/358 [00:33<00:02, 10.08it/s] 92%|█████████▏| 330/358 [00:33<00:02,  9.96it/s] 93%|█████████▎| 332/358 [00:33<00:02, 10.07it/s] 93%|█████████▎| 334/358 [00:34<00:02,  9.97it/s] 94%|█████████▎| 335/358 [00:34<00:02,  9.84it/s] 94%|█████████▍| 337/358 [00:34<00:02,  9.92it/s] 95%|█████████▍| 339/358 [00:34<00:01, 10.12it/s] 95%|█████████▌| 341/358 [00:34<00:01, 10.07it/s] 96%|█████████▌| 343/358 [00:34<00:01,  9.91it/s] 96%|█████████▌| 344/358 [00:35<00:01,  9.85it/s] 96%|█████████▋| 345/358 [00:35<00:01,  9.87it/s] 97%|█████████▋| 347/358 [00:35<00:01, 10.05it/s] 97%|█████████▋| 348/358 [00:35<00:01,  9.95it/s] 97%|█████████▋| 349/358 [00:35<00:00,  9.87it/s] 98%|█████████▊| 350/358 [00:35<00:00,  9.80it/s] 98%|█████████▊| 351/358 [00:35<00:00,  9.75it/s] 99%|█████████▊| 353/358 [00:35<00:00,  9.93it/s] 99%|█████████▉| 354/358 [00:36<00:00,  9.92it/s] 99%|█████████▉| 355/358 [00:36<00:00,  9.83it/s]100%|█████████▉| 357/358 [00:36<00:00,  9.88it/s]100%|██████████| 358/358 [00:36<00:00,  9.83it/s]
[32m2025-02-05 06:07:29.971[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    gen_loss  grad clip ratio  grad norm   ppl
        1.89                1      2.515 6.619[0m
[32m2025-02-05 06:07:29.971[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m169[0m - [1m[Valid][0m
  0%|          | 0/10256 [00:00<?, ?it/s]100%|██████████| 10256/10256 [00:00<00:00, 1073648.03it/s]
[32m2025-02-05 06:07:29.981[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:27,  1.44it/s]  5%|▌         | 2/40 [00:01<00:26,  1.45it/s]  8%|▊         | 3/40 [00:02<00:25,  1.46it/s] 10%|█         | 4/40 [00:02<00:24,  1.45it/s] 12%|█▎        | 5/40 [00:03<00:24,  1.45it/s] 15%|█▌        | 6/40 [00:04<00:23,  1.44it/s] 18%|█▊        | 7/40 [00:04<00:22,  1.44it/s] 20%|██        | 8/40 [00:05<00:22,  1.45it/s] 22%|██▎       | 9/40 [00:06<00:21,  1.45it/s] 25%|██▌       | 10/40 [00:06<00:20,  1.45it/s] 28%|██▊       | 11/40 [00:07<00:19,  1.45it/s] 30%|███       | 12/40 [00:08<00:19,  1.46it/s] 32%|███▎      | 13/40 [00:08<00:18,  1.46it/s] 35%|███▌      | 14/40 [00:09<00:17,  1.45it/s] 38%|███▊      | 15/40 [00:10<00:17,  1.45it/s] 40%|████      | 16/40 [00:11<00:16,  1.44it/s] 42%|████▎     | 17/40 [00:11<00:15,  1.45it/s] 45%|████▌     | 18/40 [00:12<00:15,  1.45it/s] 48%|████▊     | 19/40 [00:13<00:14,  1.45it/s] 50%|█████     | 20/40 [00:13<00:13,  1.46it/s] 52%|█████▎    | 21/40 [00:14<00:13,  1.46it/s] 55%|█████▌    | 22/40 [00:15<00:12,  1.45it/s] 57%|█████▊    | 23/40 [00:15<00:11,  1.45it/s] 60%|██████    | 24/40 [00:16<00:11,  1.44it/s] 62%|██████▎   | 25/40 [00:17<00:10,  1.45it/s] 65%|██████▌   | 26/40 [00:17<00:09,  1.45it/s] 68%|██████▊   | 27/40 [00:18<00:08,  1.45it/s] 70%|███████   | 28/40 [00:19<00:08,  1.45it/s] 72%|███████▎  | 29/40 [00:19<00:07,  1.45it/s] 75%|███████▌  | 30/40 [00:20<00:06,  1.46it/s] 78%|███████▊  | 31/40 [00:21<00:06,  1.45it/s] 80%|████████  | 32/40 [00:22<00:05,  1.45it/s] 82%|████████▎ | 33/40 [00:22<00:04,  1.45it/s] 85%|████████▌ | 34/40 [00:23<00:04,  1.45it/s] 88%|████████▊ | 35/40 [00:24<00:03,  1.45it/s] 90%|█████████ | 36/40 [00:24<00:02,  1.44it/s] 92%|█████████▎| 37/40 [00:25<00:02,  1.45it/s] 95%|█████████▌| 38/40 [00:26<00:01,  1.45it/s] 98%|█████████▊| 39/40 [00:26<00:00,  1.44it/s]100%|██████████| 40/40 [00:27<00:00,  1.60it/s]100%|██████████| 40/40 [00:27<00:00,  1.46it/s]
[32m2025-02-05 06:07:57.360[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    average  bleu@1  bleu@2  bleu@3  bleu@4  dist@1  dist@2  dist@3  dist@4  extreme  \
      .7813   .3007   .1109  .04289  .02225  .04508   .3062   .5829   .7451    .6003   
      f1  gen_loss  greedy  intra_dist@1  intra_dist@2  intra_dist@3  intra_dist@4  \
   .3520     5.045   .6689         .8610         .9616         .9528         .9242   
     ppl  rouge1  rouge2  rougeL  
   155.2   .3854  .09026   .3732[0m
[32m2025-02-05 06:07:57.368[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m163[0m - [1m[Conversation epoch 56][0m
[32m2025-02-05 06:07:57.368[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m164[0m - [1m[Train][0m
  0%|          | 0/92414 [00:00<?, ?it/s]100%|██████████| 92414/92414 [00:00<00:00, 997941.39it/s]
[32m2025-02-05 06:07:57.461[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/358 [00:00<?, ?it/s]  0%|          | 1/358 [00:00<00:36,  9.75it/s]  1%|          | 3/358 [00:00<00:35,  9.93it/s]  1%|          | 4/358 [00:00<00:35,  9.91it/s]  2%|▏         | 6/358 [00:00<00:35,  9.88it/s]  2%|▏         | 7/358 [00:00<00:35,  9.81it/s]  2%|▏         | 8/358 [00:00<00:35,  9.86it/s]  3%|▎         | 9/358 [00:00<00:35,  9.75it/s]  3%|▎         | 10/358 [00:01<00:35,  9.74it/s]  3%|▎         | 11/358 [00:01<00:35,  9.69it/s]  4%|▎         | 13/358 [00:01<00:34,  9.92it/s]  4%|▍         | 14/358 [00:01<00:34,  9.85it/s]  4%|▍         | 15/358 [00:01<00:35,  9.77it/s]  4%|▍         | 16/358 [00:01<00:35,  9.71it/s]  5%|▍         | 17/358 [00:01<00:35,  9.73it/s]  5%|▌         | 19/358 [00:01<00:34,  9.75it/s]  6%|▌         | 20/358 [00:02<00:34,  9.70it/s]  6%|▌         | 21/358 [00:02<00:34,  9.64it/s]  6%|▌         | 22/358 [00:02<00:34,  9.69it/s]  7%|▋         | 24/358 [00:02<00:34,  9.78it/s]  7%|▋         | 25/358 [00:02<00:34,  9.73it/s]  7%|▋         | 26/358 [00:02<00:34,  9.68it/s]  8%|▊         | 27/358 [00:02<00:34,  9.73it/s]  8%|▊         | 28/358 [00:02<00:34,  9.69it/s]  8%|▊         | 29/358 [00:02<00:34,  9.65it/s]  9%|▊         | 31/358 [00:03<00:33,  9.75it/s]  9%|▉         | 32/358 [00:03<00:33,  9.75it/s]  9%|▉         | 34/358 [00:03<00:32,  9.85it/s] 10%|█         | 36/358 [00:03<00:32,  9.85it/s] 10%|█         | 37/358 [00:03<00:32,  9.83it/s] 11%|█         | 38/358 [00:03<00:32,  9.79it/s] 11%|█         | 40/358 [00:04<00:31,  9.94it/s] 11%|█▏        | 41/358 [00:04<00:32,  9.86it/s] 12%|█▏        | 43/358 [00:04<00:31,  9.89it/s] 13%|█▎        | 45/358 [00:04<00:31,  9.99it/s] 13%|█▎        | 47/358 [00:04<00:31,  9.96it/s] 13%|█▎        | 48/358 [00:04<00:31,  9.95it/s] 14%|█▍        | 50/358 [00:05<00:31,  9.92it/s] 14%|█▍        | 51/358 [00:05<00:31,  9.85it/s] 15%|█▍        | 52/358 [00:05<00:31,  9.76it/s] 15%|█▍        | 53/358 [00:05<00:31,  9.71it/s] 15%|█▌        | 54/358 [00:05<00:31,  9.75it/s] 15%|█▌        | 55/358 [00:05<00:31,  9.69it/s] 16%|█▌        | 56/358 [00:05<00:31,  9.74it/s] 16%|█▌        | 57/358 [00:05<00:31,  9.70it/s] 16%|█▌        | 58/358 [00:05<00:31,  9.67it/s] 16%|█▋        | 59/358 [00:06<00:30,  9.65it/s] 17%|█▋        | 61/358 [00:06<00:30,  9.73it/s] 17%|█▋        | 62/358 [00:06<00:30,  9.65it/s] 18%|█▊        | 63/358 [00:06<00:30,  9.72it/s] 18%|█▊        | 64/358 [00:06<00:30,  9.67it/s] 18%|█▊        | 66/358 [00:06<00:29,  9.74it/s] 19%|█▊        | 67/358 [00:06<00:29,  9.73it/s] 19%|█▉        | 69/358 [00:07<00:29,  9.79it/s] 20%|█▉        | 70/358 [00:07<00:29,  9.73it/s] 20%|█▉        | 71/358 [00:07<00:29,  9.77it/s] 20%|██        | 72/358 [00:07<00:29,  9.72it/s] 20%|██        | 73/358 [00:07<00:29,  9.69it/s] 21%|██        | 74/358 [00:07<00:29,  9.66it/s] 21%|██        | 75/358 [00:07<00:29,  9.63it/s] 22%|██▏       | 77/358 [00:07<00:28,  9.71it/s] 22%|██▏       | 79/358 [00:08<00:28,  9.71it/s] 23%|██▎       | 81/358 [00:08<00:28,  9.76it/s] 23%|██▎       | 83/358 [00:08<00:28,  9.78it/s] 23%|██▎       | 84/358 [00:08<00:28,  9.73it/s] 24%|██▎       | 85/358 [00:08<00:28,  9.69it/s] 24%|██▍       | 86/358 [00:08<00:28,  9.67it/s] 24%|██▍       | 87/358 [00:08<00:28,  9.65it/s] 25%|██▍       | 88/358 [00:09<00:27,  9.67it/s] 25%|██▌       | 90/358 [00:09<00:27,  9.91it/s] 26%|██▌       | 92/358 [00:09<00:26, 10.01it/s] 26%|██▌       | 93/358 [00:09<00:26,  9.97it/s] 26%|██▋       | 94/358 [00:09<00:26,  9.89it/s] 27%|██▋       | 96/358 [00:09<00:25, 10.17it/s] 27%|██▋       | 98/358 [00:10<00:25, 10.06it/s] 28%|██▊       | 100/358 [00:10<00:25, 10.01it/s] 28%|██▊       | 101/358 [00:10<00:25,  9.92it/s] 29%|██▉       | 103/358 [00:10<00:25,  9.91it/s] 29%|██▉       | 104/358 [00:10<00:25,  9.86it/s] 29%|██▉       | 105/358 [00:10<00:25,  9.78it/s] 30%|██▉       | 106/358 [00:10<00:25,  9.77it/s] 30%|███       | 108/358 [00:11<00:25,  9.80it/s] 30%|███       | 109/358 [00:11<00:25,  9.72it/s] 31%|███       | 110/358 [00:11<00:25,  9.70it/s] 31%|███       | 111/358 [00:11<00:25,  9.65it/s] 32%|███▏      | 113/358 [00:11<00:24,  9.92it/s] 32%|███▏      | 114/358 [00:11<00:24,  9.88it/s] 32%|███▏      | 115/358 [00:11<00:24,  9.78it/s] 32%|███▏      | 116/358 [00:11<00:24,  9.70it/s] 33%|███▎      | 117/358 [00:11<00:24,  9.67it/s] 33%|███▎      | 119/358 [00:12<00:24,  9.79it/s] 34%|███▍      | 121/358 [00:12<00:23,  9.99it/s] 34%|███▍      | 123/358 [00:12<00:23, 10.09it/s] 35%|███▍      | 125/358 [00:12<00:23, 10.07it/s] 35%|███▌      | 127/358 [00:12<00:23,  9.99it/s] 36%|███▌      | 128/358 [00:13<00:23,  9.95it/s] 36%|███▋      | 130/358 [00:13<00:22, 10.00it/s] 37%|███▋      | 131/358 [00:13<00:22,  9.91it/s] 37%|███▋      | 132/358 [00:13<00:22,  9.93it/s] 37%|███▋      | 134/358 [00:13<00:22,  9.95it/s] 38%|███▊      | 135/358 [00:13<00:22,  9.89it/s] 38%|███▊      | 137/358 [00:13<00:22,  9.97it/s] 39%|███▊      | 138/358 [00:14<00:22,  9.95it/s] 39%|███▉      | 139/358 [00:14<00:22,  9.86it/s] 39%|███▉      | 141/358 [00:14<00:21,  9.99it/s] 40%|███▉      | 142/358 [00:14<00:21,  9.91it/s] 40%|███▉      | 143/358 [00:14<00:21,  9.88it/s] 40%|████      | 144/358 [00:14<00:21,  9.79it/s] 41%|████      | 145/358 [00:14<00:21,  9.81it/s] 41%|████      | 146/358 [00:14<00:21,  9.75it/s] 41%|████      | 147/358 [00:14<00:21,  9.69it/s] 41%|████▏     | 148/358 [00:15<00:21,  9.72it/s] 42%|████▏     | 149/358 [00:15<00:21,  9.70it/s] 42%|████▏     | 150/358 [00:15<00:21,  9.66it/s] 42%|████▏     | 151/358 [00:15<00:22,  9.39it/s] 42%|████▏     | 152/358 [00:15<00:21,  9.43it/s] 43%|████▎     | 153/358 [00:15<00:21,  9.46it/s] 43%|████▎     | 154/358 [00:15<00:21,  9.55it/s] 43%|████▎     | 155/358 [00:15<00:21,  9.55it/s] 44%|████▎     | 156/358 [00:15<00:20,  9.68it/s] 44%|████▍     | 157/358 [00:16<00:20,  9.62it/s] 44%|████▍     | 158/358 [00:16<00:20,  9.71it/s] 44%|████▍     | 159/358 [00:16<00:20,  9.71it/s] 45%|████▍     | 160/358 [00:16<00:20,  9.72it/s] 45%|████▌     | 162/358 [00:16<00:19, 10.01it/s] 46%|████▌     | 164/358 [00:16<00:19, 10.01it/s] 46%|████▌     | 165/358 [00:16<00:19,  9.97it/s] 47%|████▋     | 167/358 [00:17<00:19,  9.91it/s] 47%|████▋     | 169/358 [00:17<00:18,  9.95it/s] 48%|████▊     | 171/358 [00:17<00:18,  9.94it/s] 48%|████▊     | 172/358 [00:17<00:18,  9.88it/s] 48%|████▊     | 173/358 [00:17<00:18,  9.82it/s] 49%|████▉     | 175/358 [00:17<00:18,  9.84it/s] 49%|████▉     | 176/358 [00:17<00:18,  9.86it/s] 49%|████▉     | 177/358 [00:18<00:18,  9.84it/s] 50%|█████     | 179/358 [00:18<00:18,  9.86it/s] 50%|█████     | 180/358 [00:18<00:18,  9.80it/s] 51%|█████     | 182/358 [00:18<00:17,  9.95it/s] 51%|█████     | 183/358 [00:18<00:17,  9.90it/s] 51%|█████▏    | 184/358 [00:18<00:17,  9.79it/s] 52%|█████▏    | 185/358 [00:18<00:17,  9.73it/s] 52%|█████▏    | 187/358 [00:19<00:17,  9.95it/s] 53%|█████▎    | 188/358 [00:19<00:17,  9.90it/s] 53%|█████▎    | 189/358 [00:19<00:17,  9.84it/s] 53%|█████▎    | 191/358 [00:19<00:17,  9.76it/s] 54%|█████▎    | 192/358 [00:19<00:17,  9.71it/s] 54%|█████▍    | 193/358 [00:19<00:17,  9.70it/s] 54%|█████▍    | 194/358 [00:19<00:16,  9.68it/s] 54%|█████▍    | 195/358 [00:19<00:16,  9.75it/s] 55%|█████▌    | 197/358 [00:20<00:16,  9.92it/s] 55%|█████▌    | 198/358 [00:20<00:16,  9.84it/s] 56%|█████▌    | 199/358 [00:20<00:16,  9.88it/s] 56%|█████▌    | 200/358 [00:20<00:16,  9.81it/s] 56%|█████▌    | 201/358 [00:20<00:16,  9.77it/s] 57%|█████▋    | 203/358 [00:20<00:15,  9.86it/s] 57%|█████▋    | 204/358 [00:20<00:15,  9.76it/s] 57%|█████▋    | 205/358 [00:20<00:15,  9.71it/s] 58%|█████▊    | 207/358 [00:21<00:15,  9.88it/s] 58%|█████▊    | 208/358 [00:21<00:15,  9.81it/s] 59%|█████▊    | 210/358 [00:21<00:15,  9.83it/s] 59%|█████▉    | 212/358 [00:21<00:14,  9.82it/s] 60%|█████▉    | 214/358 [00:21<00:14,  9.90it/s] 60%|██████    | 215/358 [00:21<00:14,  9.84it/s] 60%|██████    | 216/358 [00:22<00:14,  9.77it/s] 61%|██████    | 217/358 [00:22<00:14,  9.81it/s] 61%|██████    | 218/358 [00:22<00:14,  9.78it/s] 61%|██████    | 219/358 [00:22<00:14,  9.78it/s] 62%|██████▏   | 221/358 [00:22<00:13,  9.91it/s] 62%|██████▏   | 222/358 [00:22<00:13,  9.81it/s] 62%|██████▏   | 223/358 [00:22<00:13,  9.75it/s] 63%|██████▎   | 224/358 [00:22<00:13,  9.70it/s] 63%|██████▎   | 226/358 [00:23<00:13,  9.74it/s] 64%|██████▎   | 228/358 [00:23<00:13,  9.77it/s] 64%|██████▍   | 229/358 [00:23<00:13,  9.74it/s] 64%|██████▍   | 230/358 [00:23<00:13,  9.70it/s] 65%|██████▍   | 232/358 [00:23<00:12,  9.74it/s] 65%|██████▌   | 234/358 [00:23<00:12, 10.02it/s] 66%|██████▌   | 236/358 [00:24<00:12,  9.98it/s] 66%|██████▋   | 238/358 [00:24<00:11, 10.04it/s] 67%|██████▋   | 240/358 [00:24<00:11, 10.00it/s] 68%|██████▊   | 242/358 [00:24<00:11,  9.98it/s] 68%|██████▊   | 243/358 [00:24<00:11,  9.92it/s] 68%|██████▊   | 244/358 [00:24<00:11,  9.85it/s] 69%|██████▊   | 246/358 [00:25<00:11,  9.88it/s] 69%|██████▉   | 247/358 [00:25<00:11,  9.80it/s] 69%|██████▉   | 248/358 [00:25<00:11,  9.76it/s] 70%|██████▉   | 250/358 [00:25<00:10,  9.86it/s] 70%|███████   | 251/358 [00:25<00:10,  9.80it/s] 70%|███████   | 252/358 [00:25<00:10,  9.73it/s] 71%|███████   | 253/358 [00:25<00:10,  9.69it/s] 71%|███████   | 254/358 [00:25<00:10,  9.65it/s] 72%|███████▏  | 256/358 [00:26<00:10,  9.83it/s] 72%|███████▏  | 257/358 [00:26<00:10,  9.84it/s] 72%|███████▏  | 258/358 [00:26<00:10,  9.70it/s] 72%|███████▏  | 259/358 [00:26<00:10,  9.67it/s] 73%|███████▎  | 260/358 [00:26<00:10,  9.71it/s] 73%|███████▎  | 262/358 [00:26<00:09,  9.90it/s] 74%|███████▎  | 264/358 [00:26<00:09,  9.92it/s] 74%|███████▍  | 266/358 [00:27<00:09,  9.91it/s] 75%|███████▍  | 267/358 [00:27<00:09,  9.85it/s] 75%|███████▌  | 269/358 [00:27<00:08,  9.91it/s] 75%|███████▌  | 270/358 [00:27<00:08,  9.83it/s] 76%|███████▌  | 271/358 [00:27<00:08,  9.76it/s] 76%|███████▌  | 272/358 [00:27<00:08,  9.74it/s] 76%|███████▋  | 273/358 [00:27<00:08,  9.64it/s] 77%|███████▋  | 274/358 [00:27<00:08,  9.64it/s] 77%|███████▋  | 275/358 [00:28<00:08,  9.68it/s] 77%|███████▋  | 276/358 [00:28<00:08,  9.69it/s] 77%|███████▋  | 277/358 [00:28<00:08,  9.66it/s] 78%|███████▊  | 278/358 [00:28<00:08,  9.63it/s] 78%|███████▊  | 280/358 [00:28<00:07,  9.82it/s] 78%|███████▊  | 281/358 [00:28<00:07,  9.83it/s] 79%|███████▉  | 282/358 [00:28<00:07,  9.77it/s] 79%|███████▉  | 283/358 [00:28<00:07,  9.71it/s] 79%|███████▉  | 284/358 [00:28<00:07,  9.68it/s] 80%|███████▉  | 285/358 [00:29<00:07,  9.74it/s] 80%|███████▉  | 286/358 [00:29<00:07,  9.69it/s] 80%|████████  | 287/358 [00:29<00:07,  9.67it/s] 80%|████████  | 288/358 [00:29<00:07,  9.63it/s] 81%|████████  | 290/358 [00:29<00:06,  9.84it/s] 81%|████████▏ | 291/358 [00:29<00:06,  9.82it/s] 82%|████████▏ | 293/358 [00:29<00:06,  9.83it/s] 82%|████████▏ | 295/358 [00:30<00:06,  9.91it/s] 83%|████████▎ | 296/358 [00:30<00:06,  9.85it/s] 83%|████████▎ | 297/358 [00:30<00:06,  9.74it/s] 84%|████████▎ | 299/358 [00:30<00:05,  9.90it/s] 84%|████████▍ | 301/358 [00:30<00:05,  9.94it/s] 84%|████████▍ | 302/358 [00:30<00:05,  9.87it/s] 85%|████████▍ | 303/358 [00:30<00:05,  9.88it/s] 85%|████████▌ | 305/358 [00:31<00:05,  9.91it/s] 85%|████████▌ | 306/358 [00:31<00:05,  9.83it/s] 86%|████████▌ | 308/358 [00:31<00:05,  9.93it/s] 86%|████████▋ | 309/358 [00:31<00:04,  9.83it/s] 87%|████████▋ | 310/358 [00:31<00:04,  9.77it/s] 87%|████████▋ | 311/358 [00:31<00:04,  9.70it/s] 87%|████████▋ | 312/358 [00:31<00:04,  9.72it/s] 87%|████████▋ | 313/358 [00:31<00:04,  9.73it/s] 88%|████████▊ | 315/358 [00:32<00:04,  9.99it/s] 88%|████████▊ | 316/358 [00:32<00:04,  9.94it/s] 89%|████████▊ | 317/358 [00:32<00:04,  9.86it/s] 89%|████████▉ | 318/358 [00:32<00:04,  9.81it/s] 89%|████████▉ | 319/358 [00:32<00:03,  9.76it/s] 89%|████████▉ | 320/358 [00:32<00:03,  9.82it/s] 90%|████████▉ | 321/358 [00:32<00:03,  9.75it/s] 90%|████████▉ | 322/358 [00:32<00:03,  9.71it/s] 90%|█████████ | 323/358 [00:32<00:03,  9.67it/s] 91%|█████████ | 324/358 [00:33<00:03,  9.63it/s] 91%|█████████ | 325/358 [00:33<00:03,  9.62it/s] 91%|█████████▏| 327/358 [00:33<00:03,  9.98it/s] 92%|█████████▏| 329/358 [00:33<00:02, 10.08it/s] 92%|█████████▏| 330/358 [00:33<00:02,  9.96it/s] 93%|█████████▎| 332/358 [00:33<00:02, 10.07it/s] 93%|█████████▎| 334/358 [00:34<00:02,  9.97it/s] 94%|█████████▎| 335/358 [00:34<00:02,  9.85it/s] 94%|█████████▍| 337/358 [00:34<00:02,  9.92it/s] 95%|█████████▍| 339/358 [00:34<00:01, 10.13it/s] 95%|█████████▌| 341/358 [00:34<00:01, 10.07it/s] 96%|█████████▌| 343/358 [00:34<00:01,  9.91it/s] 96%|█████████▌| 344/358 [00:35<00:01,  9.85it/s] 96%|█████████▋| 345/358 [00:35<00:01,  9.87it/s] 97%|█████████▋| 347/358 [00:35<00:01, 10.05it/s] 97%|█████████▋| 348/358 [00:35<00:01,  9.95it/s] 97%|█████████▋| 349/358 [00:35<00:00,  9.87it/s] 98%|█████████▊| 350/358 [00:35<00:00,  9.80it/s] 98%|█████████▊| 351/358 [00:35<00:00,  9.75it/s] 99%|█████████▊| 353/358 [00:35<00:00,  9.93it/s] 99%|█████████▉| 354/358 [00:36<00:00,  9.91it/s] 99%|█████████▉| 355/358 [00:36<00:00,  9.83it/s]100%|█████████▉| 357/358 [00:36<00:00,  9.88it/s]100%|██████████| 358/358 [00:36<00:00,  9.83it/s]
[32m2025-02-05 06:08:33.878[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    gen_loss  grad clip ratio  grad norm   ppl
       1.883                1      2.949 6.573[0m
[32m2025-02-05 06:08:33.878[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m169[0m - [1m[Valid][0m
  0%|          | 0/10256 [00:00<?, ?it/s]100%|██████████| 10256/10256 [00:00<00:00, 1089308.23it/s]
[32m2025-02-05 06:08:33.888[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:27,  1.44it/s]  5%|▌         | 2/40 [00:01<00:25,  1.46it/s]  8%|▊         | 3/40 [00:02<00:25,  1.46it/s] 10%|█         | 4/40 [00:02<00:24,  1.46it/s] 12%|█▎        | 5/40 [00:03<00:24,  1.46it/s] 15%|█▌        | 6/40 [00:04<00:23,  1.45it/s] 18%|█▊        | 7/40 [00:04<00:22,  1.45it/s] 20%|██        | 8/40 [00:05<00:21,  1.46it/s] 22%|██▎       | 9/40 [00:06<00:21,  1.46it/s] 25%|██▌       | 10/40 [00:06<00:20,  1.46it/s] 28%|██▊       | 11/40 [00:07<00:19,  1.46it/s] 30%|███       | 12/40 [00:08<00:19,  1.46it/s] 32%|███▎      | 13/40 [00:08<00:18,  1.46it/s] 35%|███▌      | 14/40 [00:09<00:17,  1.45it/s] 38%|███▊      | 15/40 [00:10<00:17,  1.45it/s] 40%|████      | 16/40 [00:11<00:16,  1.45it/s] 42%|████▎     | 17/40 [00:11<00:15,  1.46it/s] 45%|████▌     | 18/40 [00:12<00:15,  1.46it/s] 48%|████▊     | 19/40 [00:13<00:14,  1.46it/s] 50%|█████     | 20/40 [00:13<00:13,  1.46it/s] 52%|█████▎    | 21/40 [00:14<00:12,  1.47it/s] 55%|█████▌    | 22/40 [00:15<00:12,  1.46it/s] 57%|█████▊    | 23/40 [00:15<00:11,  1.46it/s] 60%|██████    | 24/40 [00:16<00:11,  1.45it/s] 62%|██████▎   | 25/40 [00:17<00:10,  1.45it/s] 65%|██████▌   | 26/40 [00:17<00:09,  1.47it/s] 68%|██████▊   | 27/40 [00:18<00:08,  1.47it/s] 70%|███████   | 28/40 [00:19<00:08,  1.47it/s] 72%|███████▎  | 29/40 [00:19<00:07,  1.47it/s] 75%|███████▌  | 30/40 [00:20<00:06,  1.47it/s] 78%|███████▊  | 31/40 [00:21<00:06,  1.46it/s] 80%|████████  | 32/40 [00:21<00:05,  1.47it/s] 82%|████████▎ | 33/40 [00:22<00:04,  1.46it/s] 85%|████████▌ | 34/40 [00:23<00:04,  1.46it/s] 88%|████████▊ | 35/40 [00:23<00:03,  1.46it/s] 90%|█████████ | 36/40 [00:24<00:02,  1.45it/s] 92%|█████████▎| 37/40 [00:25<00:02,  1.46it/s] 95%|█████████▌| 38/40 [00:26<00:01,  1.45it/s] 98%|█████████▊| 39/40 [00:26<00:00,  1.45it/s]100%|██████████| 40/40 [00:27<00:00,  1.60it/s]100%|██████████| 40/40 [00:27<00:00,  1.47it/s]
[32m2025-02-05 06:09:01.127[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    average  bleu@1  bleu@2  bleu@3  bleu@4  dist@1  dist@2  dist@3  dist@4  extreme  \
      .7808   .2975   .1113  .04384  .02079  .04996   .3254   .6211   .7921    .5962   
      f1  gen_loss  greedy  intra_dist@1  intra_dist@2  intra_dist@3  intra_dist@4  \
   .3546     5.078   .6683         .8851         .9756         .9531         .9160   
     ppl  rouge1  rouge2  rougeL  
   160.5   .3864  .09274   .3741[0m
[32m2025-02-05 06:09:01.134[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m163[0m - [1m[Conversation epoch 57][0m
[32m2025-02-05 06:09:01.134[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m164[0m - [1m[Train][0m
  0%|          | 0/92414 [00:00<?, ?it/s]100%|██████████| 92414/92414 [00:00<00:00, 990649.47it/s]
[32m2025-02-05 06:09:01.227[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/358 [00:00<?, ?it/s]  0%|          | 1/358 [00:00<00:36,  9.76it/s]  1%|          | 3/358 [00:00<00:35,  9.94it/s]  1%|          | 4/358 [00:00<00:35,  9.92it/s]  2%|▏         | 6/358 [00:00<00:35,  9.88it/s]  2%|▏         | 7/358 [00:00<00:35,  9.82it/s]  2%|▏         | 8/358 [00:00<00:35,  9.87it/s]  3%|▎         | 9/358 [00:00<00:35,  9.77it/s]  3%|▎         | 10/358 [00:01<00:35,  9.76it/s]  3%|▎         | 11/358 [00:01<00:35,  9.71it/s]  4%|▎         | 13/358 [00:01<00:34,  9.93it/s]  4%|▍         | 14/358 [00:01<00:34,  9.86it/s]  4%|▍         | 15/358 [00:01<00:35,  9.78it/s]  4%|▍         | 16/358 [00:01<00:35,  9.71it/s]  5%|▍         | 17/358 [00:01<00:35,  9.73it/s]  5%|▌         | 19/358 [00:01<00:34,  9.75it/s]  6%|▌         | 20/358 [00:02<00:34,  9.70it/s]  6%|▌         | 21/358 [00:02<00:35,  9.63it/s]  6%|▌         | 22/358 [00:02<00:34,  9.68it/s]  7%|▋         | 24/358 [00:02<00:34,  9.78it/s]  7%|▋         | 25/358 [00:02<00:34,  9.73it/s]  7%|▋         | 26/358 [00:02<00:34,  9.68it/s]  8%|▊         | 27/358 [00:02<00:34,  9.73it/s]  8%|▊         | 28/358 [00:02<00:34,  9.69it/s]  8%|▊         | 29/358 [00:02<00:34,  9.65it/s]  9%|▊         | 31/358 [00:03<00:33,  9.75it/s]  9%|▉         | 32/358 [00:03<00:33,  9.75it/s]  9%|▉         | 34/358 [00:03<00:32,  9.85it/s] 10%|█         | 36/358 [00:03<00:32,  9.85it/s] 10%|█         | 37/358 [00:03<00:32,  9.82it/s] 11%|█         | 38/358 [00:03<00:32,  9.78it/s] 11%|█         | 40/358 [00:04<00:31,  9.94it/s] 11%|█▏        | 41/358 [00:04<00:32,  9.86it/s] 12%|█▏        | 43/358 [00:04<00:31,  9.89it/s] 13%|█▎        | 45/358 [00:04<00:31,  9.98it/s] 13%|█▎        | 47/358 [00:04<00:31,  9.96it/s] 13%|█▎        | 48/358 [00:04<00:31,  9.95it/s] 14%|█▍        | 50/358 [00:05<00:31,  9.91it/s] 14%|█▍        | 51/358 [00:05<00:31,  9.84it/s] 15%|█▍        | 52/358 [00:05<00:31,  9.75it/s] 15%|█▍        | 53/358 [00:05<00:31,  9.70it/s] 15%|█▌        | 54/358 [00:05<00:31,  9.75it/s] 15%|█▌        | 55/358 [00:05<00:31,  9.69it/s] 16%|█▌        | 56/358 [00:05<00:31,  9.73it/s] 16%|█▌        | 57/358 [00:05<00:31,  9.70it/s] 16%|█▌        | 58/358 [00:05<00:31,  9.67it/s] 16%|█▋        | 59/358 [00:06<00:31,  9.64it/s] 17%|█▋        | 61/358 [00:06<00:30,  9.73it/s] 17%|█▋        | 62/358 [00:06<00:30,  9.65it/s] 18%|█▊        | 63/358 [00:06<00:30,  9.72it/s] 18%|█▊        | 64/358 [00:06<00:30,  9.67it/s] 18%|█▊        | 66/358 [00:06<00:29,  9.74it/s] 19%|█▊        | 67/358 [00:06<00:29,  9.73it/s] 19%|█▉        | 69/358 [00:07<00:29,  9.79it/s] 20%|█▉        | 70/358 [00:07<00:29,  9.73it/s] 20%|█▉        | 71/358 [00:07<00:29,  9.78it/s] 20%|██        | 72/358 [00:07<00:29,  9.73it/s] 20%|██        | 73/358 [00:07<00:29,  9.69it/s] 21%|██        | 74/358 [00:07<00:29,  9.66it/s] 21%|██        | 75/358 [00:07<00:29,  9.63it/s] 21%|██        | 76/358 [00:07<00:28,  9.73it/s] 22%|██▏       | 77/358 [00:07<00:28,  9.70it/s] 22%|██▏       | 79/358 [00:08<00:28,  9.70it/s] 23%|██▎       | 81/358 [00:08<00:28,  9.76it/s] 23%|██▎       | 83/358 [00:08<00:28,  9.79it/s] 23%|██▎       | 84/358 [00:08<00:28,  9.74it/s] 24%|██▎       | 85/358 [00:08<00:28,  9.69it/s] 24%|██▍       | 86/358 [00:08<00:28,  9.68it/s] 24%|██▍       | 87/358 [00:08<00:28,  9.65it/s] 25%|██▍       | 88/358 [00:09<00:27,  9.68it/s] 25%|██▌       | 90/358 [00:09<00:27,  9.91it/s] 26%|██▌       | 92/358 [00:09<00:26, 10.01it/s] 26%|██▌       | 93/358 [00:09<00:26,  9.97it/s] 26%|██▋       | 94/358 [00:09<00:26,  9.89it/s] 27%|██▋       | 96/358 [00:09<00:25, 10.17it/s] 27%|██▋       | 98/358 [00:10<00:25, 10.06it/s] 28%|██▊       | 100/358 [00:10<00:25, 10.01it/s] 28%|██▊       | 101/358 [00:10<00:25,  9.92it/s] 29%|██▉       | 103/358 [00:10<00:25,  9.91it/s] 29%|██▉       | 104/358 [00:10<00:25,  9.87it/s] 29%|██▉       | 105/358 [00:10<00:25,  9.79it/s] 30%|██▉       | 106/358 [00:10<00:25,  9.77it/s] 30%|███       | 108/358 [00:11<00:25,  9.80it/s] 30%|███       | 109/358 [00:11<00:25,  9.72it/s] 31%|███       | 110/358 [00:11<00:25,  9.70it/s] 31%|███       | 111/358 [00:11<00:25,  9.65it/s] 32%|███▏      | 113/358 [00:11<00:24,  9.92it/s] 32%|███▏      | 114/358 [00:11<00:24,  9.88it/s] 32%|███▏      | 115/358 [00:11<00:24,  9.78it/s] 32%|███▏      | 116/358 [00:11<00:24,  9.70it/s] 33%|███▎      | 117/358 [00:11<00:24,  9.67it/s] 33%|███▎      | 119/358 [00:12<00:24,  9.79it/s] 34%|███▍      | 121/358 [00:12<00:23,  9.99it/s] 34%|███▍      | 123/358 [00:12<00:23, 10.09it/s] 35%|███▍      | 125/358 [00:12<00:23, 10.06it/s] 35%|███▌      | 127/358 [00:12<00:23,  9.99it/s] 36%|███▌      | 128/358 [00:13<00:23,  9.95it/s] 36%|███▋      | 130/358 [00:13<00:22, 10.00it/s] 37%|███▋      | 131/358 [00:13<00:22,  9.91it/s] 37%|███▋      | 132/358 [00:13<00:22,  9.92it/s] 37%|███▋      | 134/358 [00:13<00:22,  9.94it/s] 38%|███▊      | 135/358 [00:13<00:22,  9.88it/s] 38%|███▊      | 137/358 [00:13<00:22,  9.97it/s] 39%|███▊      | 138/358 [00:14<00:22,  9.95it/s] 39%|███▉      | 139/358 [00:14<00:22,  9.86it/s] 39%|███▉      | 141/358 [00:14<00:21,  9.99it/s] 40%|███▉      | 142/358 [00:14<00:21,  9.91it/s] 40%|███▉      | 143/358 [00:14<00:21,  9.88it/s] 40%|████      | 144/358 [00:14<00:21,  9.79it/s] 41%|████      | 145/358 [00:14<00:21,  9.81it/s] 41%|████      | 146/358 [00:14<00:21,  9.75it/s] 41%|████      | 147/358 [00:14<00:21,  9.69it/s] 41%|████▏     | 148/358 [00:15<00:21,  9.72it/s] 42%|████▏     | 149/358 [00:15<00:21,  9.70it/s] 42%|████▏     | 150/358 [00:15<00:21,  9.66it/s] 42%|████▏     | 151/358 [00:15<00:22,  9.39it/s] 42%|████▏     | 152/358 [00:15<00:21,  9.44it/s] 43%|████▎     | 153/358 [00:15<00:21,  9.46it/s] 43%|████▎     | 154/358 [00:15<00:21,  9.55it/s] 43%|████▎     | 155/358 [00:15<00:21,  9.56it/s] 44%|████▎     | 156/358 [00:15<00:20,  9.68it/s] 44%|████▍     | 157/358 [00:16<00:20,  9.62it/s] 44%|████▍     | 158/358 [00:16<00:20,  9.71it/s] 44%|████▍     | 159/358 [00:16<00:20,  9.70it/s] 45%|████▍     | 160/358 [00:16<00:20,  9.71it/s] 45%|████▌     | 162/358 [00:16<00:19, 10.01it/s] 46%|████▌     | 164/358 [00:16<00:19, 10.01it/s] 46%|████▌     | 165/358 [00:16<00:19,  9.97it/s] 47%|████▋     | 167/358 [00:17<00:19,  9.91it/s] 47%|████▋     | 169/358 [00:17<00:18,  9.95it/s] 48%|████▊     | 171/358 [00:17<00:18,  9.94it/s] 48%|████▊     | 172/358 [00:17<00:18,  9.88it/s] 48%|████▊     | 173/358 [00:17<00:18,  9.82it/s] 49%|████▉     | 175/358 [00:17<00:18,  9.84it/s] 49%|████▉     | 176/358 [00:17<00:18,  9.86it/s] 49%|████▉     | 177/358 [00:18<00:18,  9.84it/s] 50%|█████     | 179/358 [00:18<00:18,  9.87it/s] 50%|█████     | 180/358 [00:18<00:18,  9.80it/s] 51%|█████     | 182/358 [00:18<00:17,  9.95it/s] 51%|█████     | 183/358 [00:18<00:17,  9.90it/s] 51%|█████▏    | 184/358 [00:18<00:17,  9.79it/s] 52%|█████▏    | 185/358 [00:18<00:17,  9.74it/s] 52%|█████▏    | 187/358 [00:19<00:17,  9.95it/s] 53%|█████▎    | 188/358 [00:19<00:17,  9.90it/s] 53%|█████▎    | 189/358 [00:19<00:17,  9.84it/s] 53%|█████▎    | 191/358 [00:19<00:17,  9.76it/s] 54%|█████▎    | 192/358 [00:19<00:17,  9.71it/s] 54%|█████▍    | 193/358 [00:19<00:17,  9.70it/s] 54%|█████▍    | 194/358 [00:19<00:16,  9.68it/s] 54%|█████▍    | 195/358 [00:19<00:16,  9.75it/s] 55%|█████▌    | 197/358 [00:20<00:16,  9.92it/s] 55%|█████▌    | 198/358 [00:20<00:16,  9.85it/s] 56%|█████▌    | 199/358 [00:20<00:16,  9.88it/s] 56%|█████▌    | 200/358 [00:20<00:16,  9.82it/s] 56%|█████▌    | 201/358 [00:20<00:16,  9.77it/s] 57%|█████▋    | 203/358 [00:20<00:15,  9.87it/s] 57%|█████▋    | 204/358 [00:20<00:15,  9.76it/s] 57%|█████▋    | 205/358 [00:20<00:15,  9.71it/s] 58%|█████▊    | 207/358 [00:21<00:15,  9.88it/s] 58%|█████▊    | 208/358 [00:21<00:15,  9.81it/s] 59%|█████▊    | 210/358 [00:21<00:15,  9.83it/s] 59%|█████▉    | 212/358 [00:21<00:14,  9.82it/s] 60%|█████▉    | 214/358 [00:21<00:14,  9.90it/s] 60%|██████    | 215/358 [00:21<00:14,  9.83it/s] 60%|██████    | 216/358 [00:22<00:14,  9.77it/s] 61%|██████    | 217/358 [00:22<00:14,  9.81it/s] 61%|██████    | 218/358 [00:22<00:14,  9.78it/s] 61%|██████    | 219/358 [00:22<00:14,  9.78it/s] 62%|██████▏   | 221/358 [00:22<00:13,  9.91it/s] 62%|██████▏   | 222/358 [00:22<00:13,  9.81it/s] 62%|██████▏   | 223/358 [00:22<00:13,  9.75it/s] 63%|██████▎   | 224/358 [00:22<00:13,  9.70it/s] 63%|██████▎   | 226/358 [00:23<00:13,  9.74it/s] 64%|██████▎   | 228/358 [00:23<00:13,  9.76it/s] 64%|██████▍   | 229/358 [00:23<00:13,  9.74it/s] 64%|██████▍   | 230/358 [00:23<00:13,  9.69it/s] 65%|██████▍   | 232/358 [00:23<00:12,  9.74it/s] 65%|██████▌   | 234/358 [00:23<00:12, 10.03it/s] 66%|██████▌   | 236/358 [00:24<00:12,  9.99it/s] 66%|██████▋   | 238/358 [00:24<00:11, 10.04it/s] 67%|██████▋   | 240/358 [00:24<00:11, 10.00it/s] 68%|██████▊   | 242/358 [00:24<00:11,  9.98it/s] 68%|██████▊   | 243/358 [00:24<00:11,  9.92it/s] 68%|██████▊   | 244/358 [00:24<00:11,  9.85it/s] 69%|██████▊   | 246/358 [00:25<00:11,  9.88it/s] 69%|██████▉   | 247/358 [00:25<00:11,  9.80it/s] 69%|██████▉   | 248/358 [00:25<00:11,  9.76it/s] 70%|██████▉   | 250/358 [00:25<00:10,  9.86it/s] 70%|███████   | 251/358 [00:25<00:10,  9.80it/s] 70%|███████   | 252/358 [00:25<00:10,  9.73it/s] 71%|███████   | 253/358 [00:25<00:10,  9.69it/s] 71%|███████   | 254/358 [00:25<00:10,  9.66it/s] 72%|███████▏  | 256/358 [00:26<00:10,  9.84it/s] 72%|███████▏  | 257/358 [00:26<00:10,  9.84it/s] 72%|███████▏  | 258/358 [00:26<00:10,  9.72it/s] 72%|███████▏  | 259/358 [00:26<00:10,  9.68it/s] 73%|███████▎  | 260/358 [00:26<00:10,  9.72it/s] 73%|███████▎  | 262/358 [00:26<00:09,  9.90it/s] 74%|███████▎  | 264/358 [00:26<00:09,  9.92it/s] 74%|███████▍  | 266/358 [00:27<00:09,  9.91it/s] 75%|███████▍  | 267/358 [00:27<00:09,  9.85it/s] 75%|███████▌  | 269/358 [00:27<00:08,  9.91it/s] 75%|███████▌  | 270/358 [00:27<00:08,  9.84it/s] 76%|███████▌  | 271/358 [00:27<00:08,  9.76it/s] 76%|███████▌  | 272/358 [00:27<00:08,  9.74it/s] 76%|███████▋  | 273/358 [00:27<00:08,  9.64it/s] 77%|███████▋  | 274/358 [00:27<00:08,  9.64it/s] 77%|███████▋  | 275/358 [00:28<00:08,  9.69it/s] 77%|███████▋  | 276/358 [00:28<00:08,  9.69it/s] 77%|███████▋  | 277/358 [00:28<00:08,  9.66it/s] 78%|███████▊  | 278/358 [00:28<00:08,  9.64it/s] 78%|███████▊  | 280/358 [00:28<00:07,  9.83it/s] 78%|███████▊  | 281/358 [00:28<00:07,  9.84it/s] 79%|███████▉  | 282/358 [00:28<00:07,  9.78it/s] 79%|███████▉  | 283/358 [00:28<00:07,  9.72it/s] 79%|███████▉  | 284/358 [00:28<00:07,  9.68it/s] 80%|███████▉  | 285/358 [00:29<00:07,  9.75it/s] 80%|███████▉  | 286/358 [00:29<00:07,  9.70it/s] 80%|████████  | 287/358 [00:29<00:07,  9.68it/s] 80%|████████  | 288/358 [00:29<00:07,  9.64it/s] 81%|████████  | 290/358 [00:29<00:06,  9.85it/s] 81%|████████▏ | 291/358 [00:29<00:06,  9.83it/s] 82%|████████▏ | 293/358 [00:29<00:06,  9.84it/s] 82%|████████▏ | 295/358 [00:30<00:06,  9.91it/s] 83%|████████▎ | 296/358 [00:30<00:06,  9.85it/s] 83%|████████▎ | 297/358 [00:30<00:06,  9.75it/s] 84%|████████▎ | 299/358 [00:30<00:05,  9.90it/s] 84%|████████▍ | 301/358 [00:30<00:05,  9.94it/s] 84%|████████▍ | 302/358 [00:30<00:05,  9.87it/s] 85%|████████▍ | 303/358 [00:30<00:05,  9.88it/s] 85%|████████▌ | 305/358 [00:31<00:05,  9.91it/s] 85%|████████▌ | 306/358 [00:31<00:05,  9.83it/s] 86%|████████▌ | 308/358 [00:31<00:05,  9.94it/s] 86%|████████▋ | 309/358 [00:31<00:04,  9.83it/s] 87%|████████▋ | 310/358 [00:31<00:04,  9.78it/s] 87%|████████▋ | 311/358 [00:31<00:04,  9.70it/s] 87%|████████▋ | 312/358 [00:31<00:04,  9.72it/s] 87%|████████▋ | 313/358 [00:31<00:04,  9.74it/s] 88%|████████▊ | 315/358 [00:32<00:04, 10.00it/s] 88%|████████▊ | 316/358 [00:32<00:04,  9.95it/s] 89%|████████▊ | 317/358 [00:32<00:04,  9.86it/s] 89%|████████▉ | 318/358 [00:32<00:04,  9.81it/s] 89%|████████▉ | 319/358 [00:32<00:03,  9.76it/s] 89%|████████▉ | 320/358 [00:32<00:03,  9.82it/s] 90%|████████▉ | 321/358 [00:32<00:03,  9.75it/s] 90%|████████▉ | 322/358 [00:32<00:03,  9.71it/s] 90%|█████████ | 323/358 [00:32<00:03,  9.67it/s] 91%|█████████ | 324/358 [00:33<00:03,  9.64it/s] 91%|█████████ | 325/358 [00:33<00:03,  9.62it/s] 91%|█████████▏| 327/358 [00:33<00:03,  9.98it/s] 92%|█████████▏| 329/358 [00:33<00:02, 10.08it/s] 92%|█████████▏| 330/358 [00:33<00:02,  9.97it/s] 93%|█████████▎| 332/358 [00:33<00:02, 10.07it/s] 93%|█████████▎| 334/358 [00:34<00:02,  9.97it/s] 94%|█████████▎| 335/358 [00:34<00:02,  9.85it/s] 94%|█████████▍| 337/358 [00:34<00:02,  9.93it/s] 95%|█████████▍| 339/358 [00:34<00:01, 10.13it/s] 95%|█████████▌| 341/358 [00:34<00:01, 10.07it/s] 96%|█████████▌| 343/358 [00:34<00:01,  9.91it/s] 96%|█████████▌| 344/358 [00:35<00:01,  9.85it/s] 96%|█████████▋| 345/358 [00:35<00:01,  9.87it/s] 97%|█████████▋| 347/358 [00:35<00:01, 10.05it/s] 97%|█████████▋| 348/358 [00:35<00:01,  9.95it/s] 97%|█████████▋| 349/358 [00:35<00:00,  9.87it/s] 98%|█████████▊| 350/358 [00:35<00:00,  9.79it/s] 98%|█████████▊| 351/358 [00:35<00:00,  9.75it/s] 99%|█████████▊| 353/358 [00:35<00:00,  9.93it/s] 99%|█████████▉| 354/358 [00:36<00:00,  9.91it/s] 99%|█████████▉| 355/358 [00:36<00:00,  9.82it/s]100%|█████████▉| 357/358 [00:36<00:00,  9.88it/s]100%|██████████| 358/358 [00:36<00:00,  9.83it/s]
[32m2025-02-05 06:09:37.639[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    gen_loss  grad clip ratio  grad norm   ppl
       1.879                1      3.329 6.547[0m
[32m2025-02-05 06:09:37.640[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m169[0m - [1m[Valid][0m
  0%|          | 0/10256 [00:00<?, ?it/s]100%|██████████| 10256/10256 [00:00<00:00, 1086913.66it/s]
[32m2025-02-05 06:09:37.649[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:27,  1.44it/s]  5%|▌         | 2/40 [00:01<00:26,  1.45it/s]  8%|▊         | 3/40 [00:02<00:25,  1.45it/s] 10%|█         | 4/40 [00:02<00:24,  1.46it/s] 12%|█▎        | 5/40 [00:03<00:24,  1.45it/s] 15%|█▌        | 6/40 [00:04<00:23,  1.45it/s] 18%|█▊        | 7/40 [00:04<00:22,  1.45it/s] 20%|██        | 8/40 [00:05<00:21,  1.46it/s] 22%|██▎       | 9/40 [00:06<00:21,  1.45it/s] 25%|██▌       | 10/40 [00:06<00:20,  1.45it/s] 28%|██▊       | 11/40 [00:07<00:19,  1.45it/s] 30%|███       | 12/40 [00:08<00:19,  1.45it/s] 32%|███▎      | 13/40 [00:08<00:18,  1.45it/s] 35%|███▌      | 14/40 [00:09<00:17,  1.45it/s] 38%|███▊      | 15/40 [00:10<00:17,  1.45it/s] 40%|████      | 16/40 [00:11<00:16,  1.45it/s] 42%|████▎     | 17/40 [00:11<00:15,  1.45it/s] 45%|████▌     | 18/40 [00:12<00:15,  1.45it/s] 48%|████▊     | 19/40 [00:13<00:14,  1.45it/s] 50%|█████     | 20/40 [00:13<00:13,  1.46it/s] 52%|█████▎    | 21/40 [00:14<00:13,  1.46it/s] 55%|█████▌    | 22/40 [00:15<00:12,  1.45it/s] 57%|█████▊    | 23/40 [00:15<00:11,  1.45it/s] 60%|██████    | 24/40 [00:16<00:11,  1.45it/s] 62%|██████▎   | 25/40 [00:17<00:10,  1.44it/s] 65%|██████▌   | 26/40 [00:17<00:09,  1.45it/s] 68%|██████▊   | 27/40 [00:18<00:08,  1.45it/s] 70%|███████   | 28/40 [00:19<00:08,  1.45it/s] 72%|███████▎  | 29/40 [00:19<00:07,  1.46it/s] 75%|███████▌  | 30/40 [00:20<00:06,  1.46it/s] 78%|███████▊  | 31/40 [00:21<00:06,  1.46it/s] 80%|████████  | 32/40 [00:22<00:05,  1.46it/s] 82%|████████▎ | 33/40 [00:22<00:04,  1.46it/s] 85%|████████▌ | 34/40 [00:23<00:04,  1.46it/s] 88%|████████▊ | 35/40 [00:24<00:03,  1.46it/s] 90%|█████████ | 36/40 [00:24<00:02,  1.45it/s] 92%|█████████▎| 37/40 [00:25<00:02,  1.45it/s] 95%|█████████▌| 38/40 [00:26<00:01,  1.45it/s] 98%|█████████▊| 39/40 [00:26<00:00,  1.45it/s]100%|██████████| 40/40 [00:27<00:00,  1.60it/s]100%|██████████| 40/40 [00:27<00:00,  1.46it/s]
[32m2025-02-05 06:10:04.995[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    average  bleu@1  bleu@2  bleu@3  bleu@4  dist@1  dist@2  dist@3  dist@4  extreme  \
      .7831   .2986   .1094  .03986  .01982  .04364   .2953   .5739   .7363    .6021   
      f1  gen_loss  greedy  intra_dist@1  intra_dist@2  intra_dist@3  intra_dist@4  \
   .3517     5.106   .6688         .8649         .9642         .9538         .9234   
     ppl  rouge1  rouge2  rougeL  
   165.1   .3869  .08843   .3742[0m
[32m2025-02-05 06:10:05.002[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m163[0m - [1m[Conversation epoch 58][0m
[32m2025-02-05 06:10:05.002[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m164[0m - [1m[Train][0m
  0%|          | 0/92414 [00:00<?, ?it/s]100%|██████████| 92414/92414 [00:00<00:00, 998669.02it/s]
[32m2025-02-05 06:10:05.095[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/358 [00:00<?, ?it/s]  0%|          | 1/358 [00:00<00:36,  9.76it/s]  1%|          | 3/358 [00:00<00:35,  9.94it/s]  1%|          | 4/358 [00:00<00:35,  9.92it/s]  2%|▏         | 6/358 [00:00<00:35,  9.88it/s]  2%|▏         | 7/358 [00:00<00:35,  9.82it/s]  2%|▏         | 8/358 [00:00<00:35,  9.86it/s]  3%|▎         | 9/358 [00:00<00:35,  9.76it/s]  3%|▎         | 10/358 [00:01<00:35,  9.75it/s]  3%|▎         | 11/358 [00:01<00:35,  9.70it/s]  4%|▎         | 13/358 [00:01<00:34,  9.92it/s]  4%|▍         | 14/358 [00:01<00:34,  9.85it/s]  4%|▍         | 15/358 [00:01<00:35,  9.77it/s]  4%|▍         | 16/358 [00:01<00:35,  9.71it/s]  5%|▍         | 17/358 [00:01<00:35,  9.73it/s]  5%|▌         | 19/358 [00:01<00:34,  9.75it/s]  6%|▌         | 20/358 [00:02<00:34,  9.70it/s]  6%|▌         | 21/358 [00:02<00:34,  9.63it/s]  6%|▌         | 22/358 [00:02<00:34,  9.69it/s]  7%|▋         | 24/358 [00:02<00:34,  9.78it/s]  7%|▋         | 25/358 [00:02<00:34,  9.73it/s]  7%|▋         | 26/358 [00:02<00:34,  9.68it/s]  8%|▊         | 27/358 [00:02<00:34,  9.73it/s]  8%|▊         | 28/358 [00:02<00:34,  9.69it/s]  8%|▊         | 29/358 [00:02<00:34,  9.65it/s]  9%|▊         | 31/358 [00:03<00:33,  9.75it/s]  9%|▉         | 32/358 [00:03<00:33,  9.75it/s]  9%|▉         | 34/358 [00:03<00:32,  9.85it/s] 10%|█         | 36/358 [00:03<00:32,  9.85it/s] 10%|█         | 37/358 [00:03<00:32,  9.84it/s] 11%|█         | 38/358 [00:03<00:32,  9.79it/s] 11%|█         | 40/358 [00:04<00:31,  9.95it/s] 11%|█▏        | 41/358 [00:04<00:32,  9.86it/s] 12%|█▏        | 43/358 [00:04<00:31,  9.89it/s] 13%|█▎        | 45/358 [00:04<00:31,  9.98it/s] 13%|█▎        | 47/358 [00:04<00:31,  9.96it/s] 13%|█▎        | 48/358 [00:04<00:31,  9.94it/s] 14%|█▍        | 50/358 [00:05<00:31,  9.92it/s] 14%|█▍        | 51/358 [00:05<00:31,  9.85it/s] 15%|█▍        | 52/358 [00:05<00:31,  9.76it/s] 15%|█▍        | 53/358 [00:05<00:31,  9.71it/s] 15%|█▌        | 54/358 [00:05<00:31,  9.75it/s] 15%|█▌        | 55/358 [00:05<00:31,  9.70it/s] 16%|█▌        | 56/358 [00:05<00:30,  9.75it/s] 16%|█▌        | 57/358 [00:05<00:31,  9.71it/s] 16%|█▌        | 58/358 [00:05<00:30,  9.68it/s] 16%|█▋        | 59/358 [00:06<00:30,  9.65it/s] 17%|█▋        | 61/358 [00:06<00:30,  9.73it/s] 17%|█▋        | 62/358 [00:06<00:30,  9.65it/s] 18%|█▊        | 63/358 [00:06<00:30,  9.72it/s] 18%|█▊        | 64/358 [00:06<00:30,  9.67it/s] 18%|█▊        | 66/358 [00:06<00:29,  9.74it/s] 19%|█▊        | 67/358 [00:06<00:29,  9.73it/s] 19%|█▉        | 69/358 [00:07<00:29,  9.79it/s] 20%|█▉        | 70/358 [00:07<00:29,  9.74it/s] 20%|█▉        | 71/358 [00:07<00:29,  9.78it/s] 20%|██        | 72/358 [00:07<00:29,  9.73it/s] 20%|██        | 73/358 [00:07<00:29,  9.70it/s] 21%|██        | 74/358 [00:07<00:29,  9.67it/s] 21%|██        | 75/358 [00:07<00:29,  9.63it/s] 22%|██▏       | 77/358 [00:07<00:28,  9.71it/s] 22%|██▏       | 79/358 [00:08<00:28,  9.71it/s] 23%|██▎       | 81/358 [00:08<00:28,  9.76it/s] 23%|██▎       | 83/358 [00:08<00:28,  9.79it/s] 23%|██▎       | 84/358 [00:08<00:28,  9.74it/s] 24%|██▎       | 85/358 [00:08<00:28,  9.70it/s] 24%|██▍       | 86/358 [00:08<00:28,  9.68it/s] 24%|██▍       | 87/358 [00:08<00:28,  9.66it/s] 25%|██▍       | 88/358 [00:09<00:27,  9.68it/s] 25%|██▌       | 90/358 [00:09<00:27,  9.92it/s] 26%|██▌       | 92/358 [00:09<00:26, 10.01it/s] 26%|██▌       | 93/358 [00:09<00:26,  9.98it/s] 26%|██▋       | 94/358 [00:09<00:26,  9.89it/s] 27%|██▋       | 96/358 [00:09<00:25, 10.17it/s] 27%|██▋       | 98/358 [00:09<00:25, 10.06it/s] 28%|██▊       | 100/358 [00:10<00:25, 10.01it/s] 28%|██▊       | 101/358 [00:10<00:25,  9.92it/s] 29%|██▉       | 103/358 [00:10<00:25,  9.91it/s] 29%|██▉       | 104/358 [00:10<00:25,  9.87it/s] 29%|██▉       | 105/358 [00:10<00:25,  9.79it/s] 30%|██▉       | 106/358 [00:10<00:25,  9.78it/s] 30%|███       | 108/358 [00:11<00:25,  9.81it/s] 30%|███       | 109/358 [00:11<00:25,  9.73it/s] 31%|███       | 110/358 [00:11<00:25,  9.71it/s] 31%|███       | 111/358 [00:11<00:25,  9.66it/s] 32%|███▏      | 113/358 [00:11<00:24,  9.93it/s] 32%|███▏      | 114/358 [00:11<00:24,  9.88it/s] 32%|███▏      | 115/358 [00:11<00:24,  9.79it/s] 32%|███▏      | 116/358 [00:11<00:24,  9.70it/s] 33%|███▎      | 117/358 [00:11<00:24,  9.67it/s] 33%|███▎      | 119/358 [00:12<00:24,  9.79it/s] 34%|███▍      | 121/358 [00:12<00:23,  9.99it/s] 34%|███▍      | 123/358 [00:12<00:23, 10.09it/s] 35%|███▍      | 125/358 [00:12<00:23, 10.07it/s] 35%|███▌      | 127/358 [00:12<00:23,  9.99it/s] 36%|███▌      | 128/358 [00:13<00:23,  9.95it/s] 36%|███▋      | 130/358 [00:13<00:22, 10.00it/s] 37%|███▋      | 131/358 [00:13<00:22,  9.91it/s] 37%|███▋      | 132/358 [00:13<00:22,  9.93it/s] 37%|███▋      | 134/358 [00:13<00:22,  9.95it/s] 38%|███▊      | 135/358 [00:13<00:22,  9.88it/s] 38%|███▊      | 137/358 [00:13<00:22,  9.97it/s] 39%|███▊      | 138/358 [00:14<00:22,  9.95it/s] 39%|███▉      | 139/358 [00:14<00:22,  9.86it/s] 39%|███▉      | 141/358 [00:14<00:21,  9.99it/s] 40%|███▉      | 142/358 [00:14<00:21,  9.91it/s] 40%|███▉      | 143/358 [00:14<00:21,  9.88it/s] 40%|████      | 144/358 [00:14<00:21,  9.79it/s] 41%|████      | 145/358 [00:14<00:21,  9.81it/s] 41%|████      | 146/358 [00:14<00:21,  9.75it/s] 41%|████      | 147/358 [00:14<00:21,  9.69it/s] 41%|████▏     | 148/358 [00:15<00:21,  9.72it/s] 42%|████▏     | 149/358 [00:15<00:21,  9.70it/s] 42%|████▏     | 150/358 [00:15<00:21,  9.65it/s] 42%|████▏     | 151/358 [00:15<00:22,  9.39it/s] 42%|████▏     | 152/358 [00:15<00:21,  9.44it/s] 43%|████▎     | 153/358 [00:15<00:21,  9.46it/s] 43%|████▎     | 154/358 [00:15<00:21,  9.55it/s] 43%|████▎     | 155/358 [00:15<00:21,  9.56it/s] 44%|████▎     | 156/358 [00:15<00:20,  9.69it/s] 44%|████▍     | 157/358 [00:16<00:20,  9.62it/s] 44%|████▍     | 158/358 [00:16<00:20,  9.71it/s] 44%|████▍     | 159/358 [00:16<00:20,  9.71it/s] 45%|████▍     | 160/358 [00:16<00:20,  9.72it/s] 45%|████▌     | 162/358 [00:16<00:19, 10.01it/s] 46%|████▌     | 164/358 [00:16<00:19, 10.01it/s] 46%|████▌     | 165/358 [00:16<00:19,  9.97it/s] 47%|████▋     | 167/358 [00:17<00:19,  9.91it/s] 47%|████▋     | 169/358 [00:17<00:18,  9.95it/s] 48%|████▊     | 171/358 [00:17<00:18,  9.93it/s] 48%|████▊     | 172/358 [00:17<00:18,  9.88it/s] 48%|████▊     | 173/358 [00:17<00:18,  9.82it/s] 49%|████▉     | 175/358 [00:17<00:18,  9.84it/s] 49%|████▉     | 176/358 [00:17<00:18,  9.86it/s] 49%|████▉     | 177/358 [00:18<00:18,  9.84it/s] 50%|█████     | 179/358 [00:18<00:18,  9.87it/s] 50%|█████     | 180/358 [00:18<00:18,  9.80it/s] 51%|█████     | 182/358 [00:18<00:17,  9.94it/s] 51%|█████     | 183/358 [00:18<00:17,  9.89it/s] 51%|█████▏    | 184/358 [00:18<00:17,  9.79it/s] 52%|█████▏    | 185/358 [00:18<00:17,  9.73it/s] 52%|█████▏    | 187/358 [00:19<00:17,  9.95it/s] 53%|█████▎    | 188/358 [00:19<00:17,  9.90it/s] 53%|█████▎    | 189/358 [00:19<00:17,  9.84it/s] 53%|█████▎    | 190/358 [00:19<00:17,  9.88it/s] 53%|█████▎    | 191/358 [00:19<00:17,  9.71it/s] 54%|█████▎    | 192/358 [00:19<00:17,  9.66it/s] 54%|█████▍    | 193/358 [00:19<00:17,  9.67it/s] 54%|█████▍    | 194/358 [00:19<00:16,  9.65it/s] 54%|█████▍    | 195/358 [00:19<00:16,  9.73it/s] 55%|█████▌    | 197/358 [00:20<00:16,  9.92it/s] 55%|█████▌    | 198/358 [00:20<00:16,  9.84it/s] 56%|█████▌    | 199/358 [00:20<00:16,  9.88it/s] 56%|█████▌    | 200/358 [00:20<00:16,  9.81it/s] 56%|█████▌    | 201/358 [00:20<00:16,  9.77it/s] 57%|█████▋    | 203/358 [00:20<00:15,  9.86it/s] 57%|█████▋    | 204/358 [00:20<00:15,  9.76it/s] 57%|█████▋    | 205/358 [00:20<00:15,  9.71it/s] 58%|█████▊    | 207/358 [00:21<00:15,  9.88it/s] 58%|█████▊    | 208/358 [00:21<00:15,  9.82it/s] 59%|█████▊    | 210/358 [00:21<00:15,  9.83it/s] 59%|█████▉    | 212/358 [00:21<00:14,  9.82it/s] 60%|█████▉    | 214/358 [00:21<00:14,  9.90it/s] 60%|██████    | 215/358 [00:21<00:14,  9.84it/s] 60%|██████    | 216/358 [00:22<00:14,  9.77it/s] 61%|██████    | 217/358 [00:22<00:14,  9.81it/s] 61%|██████    | 218/358 [00:22<00:14,  9.78it/s] 61%|██████    | 219/358 [00:22<00:14,  9.78it/s] 62%|██████▏   | 221/358 [00:22<00:13,  9.91it/s] 62%|██████▏   | 222/358 [00:22<00:13,  9.81it/s] 62%|██████▏   | 223/358 [00:22<00:13,  9.75it/s] 63%|██████▎   | 224/358 [00:22<00:13,  9.70it/s] 63%|██████▎   | 226/358 [00:23<00:13,  9.74it/s] 64%|██████▎   | 228/358 [00:23<00:13,  9.77it/s] 64%|██████▍   | 229/358 [00:23<00:13,  9.75it/s] 64%|██████▍   | 230/358 [00:23<00:13,  9.70it/s] 65%|██████▍   | 232/358 [00:23<00:12,  9.74it/s] 65%|██████▌   | 234/358 [00:23<00:12, 10.03it/s] 66%|██████▌   | 236/358 [00:24<00:12,  9.98it/s] 66%|██████▋   | 238/358 [00:24<00:11, 10.04it/s] 67%|██████▋   | 240/358 [00:24<00:11, 10.00it/s] 68%|██████▊   | 242/358 [00:24<00:11,  9.98it/s] 68%|██████▊   | 243/358 [00:24<00:11,  9.92it/s] 68%|██████▊   | 244/358 [00:24<00:11,  9.85it/s] 69%|██████▊   | 246/358 [00:25<00:11,  9.88it/s] 69%|██████▉   | 247/358 [00:25<00:11,  9.81it/s] 69%|██████▉   | 248/358 [00:25<00:11,  9.76it/s] 70%|██████▉   | 250/358 [00:25<00:10,  9.86it/s] 70%|███████   | 251/358 [00:25<00:10,  9.80it/s] 70%|███████   | 252/358 [00:25<00:10,  9.72it/s] 71%|███████   | 253/358 [00:25<00:10,  9.68it/s] 71%|███████   | 254/358 [00:25<00:10,  9.66it/s] 72%|███████▏  | 256/358 [00:26<00:10,  9.84it/s] 72%|███████▏  | 257/358 [00:26<00:10,  9.84it/s] 72%|███████▏  | 258/358 [00:26<00:10,  9.72it/s] 72%|███████▏  | 259/358 [00:26<00:10,  9.68it/s] 73%|███████▎  | 260/358 [00:26<00:10,  9.72it/s] 73%|███████▎  | 262/358 [00:26<00:09,  9.90it/s] 74%|███████▎  | 264/358 [00:26<00:09,  9.92it/s] 74%|███████▍  | 266/358 [00:27<00:09,  9.91it/s] 75%|███████▍  | 267/358 [00:27<00:09,  9.85it/s] 75%|███████▌  | 269/358 [00:27<00:08,  9.91it/s] 75%|███████▌  | 270/358 [00:27<00:08,  9.83it/s] 76%|███████▌  | 271/358 [00:27<00:08,  9.76it/s] 76%|███████▌  | 272/358 [00:27<00:08,  9.74it/s] 76%|███████▋  | 273/358 [00:27<00:08,  9.64it/s] 77%|███████▋  | 274/358 [00:27<00:08,  9.64it/s] 77%|███████▋  | 275/358 [00:28<00:08,  9.69it/s] 77%|███████▋  | 276/358 [00:28<00:08,  9.69it/s] 77%|███████▋  | 277/358 [00:28<00:08,  9.67it/s] 78%|███████▊  | 278/358 [00:28<00:08,  9.64it/s] 78%|███████▊  | 280/358 [00:28<00:07,  9.83it/s] 78%|███████▊  | 281/358 [00:28<00:07,  9.84it/s] 79%|███████▉  | 282/358 [00:28<00:07,  9.78it/s] 79%|███████▉  | 283/358 [00:28<00:07,  9.72it/s] 79%|███████▉  | 284/358 [00:28<00:07,  9.68it/s] 80%|███████▉  | 285/358 [00:29<00:07,  9.74it/s] 80%|███████▉  | 286/358 [00:29<00:07,  9.70it/s] 80%|████████  | 287/358 [00:29<00:07,  9.68it/s] 80%|████████  | 288/358 [00:29<00:07,  9.64it/s] 81%|████████  | 290/358 [00:29<00:06,  9.85it/s] 81%|████████▏ | 291/358 [00:29<00:06,  9.83it/s] 82%|████████▏ | 293/358 [00:29<00:06,  9.85it/s] 82%|████████▏ | 295/358 [00:30<00:06,  9.92it/s] 83%|████████▎ | 296/358 [00:30<00:06,  9.86it/s] 83%|████████▎ | 297/358 [00:30<00:06,  9.75it/s] 84%|████████▎ | 299/358 [00:30<00:05,  9.91it/s] 84%|████████▍ | 301/358 [00:30<00:05,  9.94it/s] 84%|████████▍ | 302/358 [00:30<00:05,  9.88it/s] 85%|████████▍ | 303/358 [00:30<00:05,  9.89it/s] 85%|████████▌ | 305/358 [00:31<00:05,  9.91it/s] 85%|████████▌ | 306/358 [00:31<00:05,  9.84it/s] 86%|████████▌ | 308/358 [00:31<00:05,  9.94it/s] 86%|████████▋ | 309/358 [00:31<00:04,  9.84it/s] 87%|████████▋ | 310/358 [00:31<00:04,  9.77it/s] 87%|████████▋ | 311/358 [00:31<00:04,  9.70it/s] 87%|████████▋ | 312/358 [00:31<00:04,  9.72it/s] 87%|████████▋ | 313/358 [00:31<00:04,  9.73it/s] 88%|████████▊ | 315/358 [00:32<00:04, 10.00it/s] 88%|████████▊ | 316/358 [00:32<00:04,  9.94it/s] 89%|████████▊ | 317/358 [00:32<00:04,  9.86it/s] 89%|████████▉ | 318/358 [00:32<00:04,  9.81it/s] 89%|████████▉ | 319/358 [00:32<00:03,  9.76it/s] 89%|████████▉ | 320/358 [00:32<00:03,  9.82it/s] 90%|████████▉ | 321/358 [00:32<00:03,  9.75it/s] 90%|████████▉ | 322/358 [00:32<00:03,  9.71it/s] 90%|█████████ | 323/358 [00:32<00:03,  9.67it/s] 91%|█████████ | 324/358 [00:33<00:03,  9.64it/s] 91%|█████████ | 325/358 [00:33<00:03,  9.62it/s] 91%|█████████▏| 327/358 [00:33<00:03,  9.98it/s] 92%|█████████▏| 329/358 [00:33<00:02, 10.08it/s] 92%|█████████▏| 330/358 [00:33<00:02,  9.97it/s] 93%|█████████▎| 332/358 [00:33<00:02, 10.07it/s] 93%|█████████▎| 334/358 [00:34<00:02,  9.97it/s] 94%|█████████▎| 335/358 [00:34<00:02,  9.85it/s] 94%|█████████▍| 337/358 [00:34<00:02,  9.92it/s] 95%|█████████▍| 339/358 [00:34<00:01, 10.13it/s] 95%|█████████▌| 341/358 [00:34<00:01, 10.07it/s] 96%|█████████▌| 343/358 [00:34<00:01,  9.90it/s] 96%|█████████▌| 344/358 [00:35<00:01,  9.85it/s] 96%|█████████▋| 345/358 [00:35<00:01,  9.87it/s] 97%|█████████▋| 347/358 [00:35<00:01, 10.04it/s] 97%|█████████▋| 348/358 [00:35<00:01,  9.94it/s] 97%|█████████▋| 349/358 [00:35<00:00,  9.86it/s] 98%|█████████▊| 350/358 [00:35<00:00,  9.79it/s] 98%|█████████▊| 351/358 [00:35<00:00,  9.75it/s] 99%|█████████▊| 353/358 [00:35<00:00,  9.93it/s] 99%|█████████▉| 354/358 [00:36<00:00,  9.91it/s] 99%|█████████▉| 355/358 [00:36<00:00,  9.82it/s]100%|█████████▉| 357/358 [00:36<00:00,  9.86it/s]100%|██████████| 358/358 [00:36<00:00,  9.83it/s]
[32m2025-02-05 06:10:41.513[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    gen_loss  grad clip ratio  grad norm   ppl
       1.874                1      2.523 6.513[0m
[32m2025-02-05 06:10:41.513[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m169[0m - [1m[Valid][0m
  0%|          | 0/10256 [00:00<?, ?it/s]100%|██████████| 10256/10256 [00:00<00:00, 934111.79it/s]
[32m2025-02-05 06:10:41.524[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:27,  1.41it/s]  5%|▌         | 2/40 [00:01<00:26,  1.44it/s]  8%|▊         | 3/40 [00:02<00:25,  1.44it/s] 10%|█         | 4/40 [00:02<00:24,  1.44it/s] 12%|█▎        | 5/40 [00:03<00:24,  1.43it/s] 15%|█▌        | 6/40 [00:04<00:23,  1.43it/s] 18%|█▊        | 7/40 [00:04<00:22,  1.44it/s] 20%|██        | 8/40 [00:05<00:22,  1.44it/s] 22%|██▎       | 9/40 [00:06<00:21,  1.44it/s] 25%|██▌       | 10/40 [00:06<00:20,  1.45it/s] 28%|██▊       | 11/40 [00:07<00:19,  1.45it/s] 30%|███       | 12/40 [00:08<00:19,  1.45it/s] 32%|███▎      | 13/40 [00:09<00:18,  1.45it/s] 35%|███▌      | 14/40 [00:09<00:18,  1.44it/s] 38%|███▊      | 15/40 [00:10<00:17,  1.44it/s] 40%|████      | 16/40 [00:11<00:16,  1.44it/s] 42%|████▎     | 17/40 [00:11<00:15,  1.44it/s] 45%|████▌     | 18/40 [00:12<00:15,  1.45it/s] 48%|████▊     | 19/40 [00:13<00:14,  1.45it/s] 50%|█████     | 20/40 [00:13<00:13,  1.45it/s] 52%|█████▎    | 21/40 [00:14<00:13,  1.45it/s] 55%|█████▌    | 22/40 [00:15<00:12,  1.45it/s] 57%|█████▊    | 23/40 [00:15<00:11,  1.45it/s] 60%|██████    | 24/40 [00:16<00:11,  1.44it/s] 62%|██████▎   | 25/40 [00:17<00:10,  1.44it/s] 65%|██████▌   | 26/40 [00:17<00:09,  1.45it/s] 68%|██████▊   | 27/40 [00:18<00:08,  1.45it/s] 70%|███████   | 28/40 [00:19<00:08,  1.45it/s] 72%|███████▎  | 29/40 [00:20<00:07,  1.45it/s] 75%|███████▌  | 30/40 [00:20<00:06,  1.46it/s] 78%|███████▊  | 31/40 [00:21<00:06,  1.46it/s] 80%|████████  | 32/40 [00:22<00:05,  1.45it/s] 82%|████████▎ | 33/40 [00:22<00:04,  1.45it/s] 85%|████████▌ | 34/40 [00:23<00:04,  1.45it/s] 88%|████████▊ | 35/40 [00:24<00:03,  1.45it/s] 90%|█████████ | 36/40 [00:24<00:02,  1.44it/s] 92%|█████████▎| 37/40 [00:25<00:02,  1.45it/s] 95%|█████████▌| 38/40 [00:26<00:01,  1.44it/s] 98%|█████████▊| 39/40 [00:26<00:00,  1.45it/s]100%|██████████| 40/40 [00:27<00:00,  1.60it/s]100%|██████████| 40/40 [00:27<00:00,  1.46it/s]
[32m2025-02-05 06:11:08.977[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    average  bleu@1  bleu@2  bleu@3  bleu@4  dist@1  dist@2  dist@3  dist@4  extreme  \
      .7761   .2935   .1088  .04111  .02042  .04377   .2919   .5487   .6905    .5982   
      f1  gen_loss  greedy  intra_dist@1  intra_dist@2  intra_dist@3  intra_dist@4  \
   .3490     5.118   .6667         .8529         .9457         .9339         .8954   
    ppl  rouge1  rouge2  rougeL  
    167   .3863  .08945   .3743[0m
[32m2025-02-05 06:11:08.983[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m163[0m - [1m[Conversation epoch 59][0m
[32m2025-02-05 06:11:08.983[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m164[0m - [1m[Train][0m
  0%|          | 0/92414 [00:00<?, ?it/s]100%|██████████| 92414/92414 [00:00<00:00, 1066251.87it/s]
[32m2025-02-05 06:11:09.070[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/358 [00:00<?, ?it/s]  0%|          | 1/358 [00:00<00:36,  9.75it/s]  1%|          | 3/358 [00:00<00:35,  9.94it/s]  1%|          | 4/358 [00:00<00:35,  9.92it/s]  2%|▏         | 6/358 [00:00<00:35,  9.89it/s]  2%|▏         | 7/358 [00:00<00:35,  9.82it/s]  2%|▏         | 8/358 [00:00<00:35,  9.86it/s]  3%|▎         | 9/358 [00:00<00:35,  9.77it/s]  3%|▎         | 10/358 [00:01<00:35,  9.76it/s]  3%|▎         | 11/358 [00:01<00:35,  9.70it/s]  4%|▎         | 13/358 [00:01<00:34,  9.93it/s]  4%|▍         | 14/358 [00:01<00:34,  9.85it/s]  4%|▍         | 15/358 [00:01<00:35,  9.78it/s]  4%|▍         | 16/358 [00:01<00:35,  9.71it/s]  5%|▍         | 17/358 [00:01<00:35,  9.73it/s]  5%|▌         | 19/358 [00:01<00:34,  9.75it/s]  6%|▌         | 20/358 [00:02<00:34,  9.70it/s]  6%|▌         | 21/358 [00:02<00:34,  9.64it/s]  6%|▌         | 22/358 [00:02<00:34,  9.69it/s]  7%|▋         | 24/358 [00:02<00:34,  9.78it/s]  7%|▋         | 25/358 [00:02<00:34,  9.73it/s]  7%|▋         | 26/358 [00:02<00:34,  9.68it/s]  8%|▊         | 27/358 [00:02<00:34,  9.73it/s]  8%|▊         | 28/358 [00:02<00:34,  9.69it/s]  8%|▊         | 29/358 [00:02<00:34,  9.66it/s]  9%|▊         | 31/358 [00:03<00:33,  9.76it/s]  9%|▉         | 32/358 [00:03<00:33,  9.76it/s]  9%|▉         | 34/358 [00:03<00:32,  9.86it/s] 10%|█         | 36/358 [00:03<00:32,  9.85it/s] 10%|█         | 37/358 [00:03<00:32,  9.84it/s] 11%|█         | 38/358 [00:03<00:32,  9.79it/s] 11%|█         | 40/358 [00:04<00:31,  9.95it/s] 11%|█▏        | 41/358 [00:04<00:32,  9.86it/s] 12%|█▏        | 43/358 [00:04<00:31,  9.89it/s] 13%|█▎        | 45/358 [00:04<00:31,  9.99it/s] 13%|█▎        | 47/358 [00:04<00:31,  9.96it/s] 13%|█▎        | 48/358 [00:04<00:31,  9.95it/s] 14%|█▍        | 50/358 [00:05<00:31,  9.91it/s] 14%|█▍        | 51/358 [00:05<00:31,  9.85it/s] 15%|█▍        | 52/358 [00:05<00:31,  9.76it/s] 15%|█▍        | 53/358 [00:05<00:31,  9.71it/s] 15%|█▌        | 54/358 [00:05<00:31,  9.75it/s] 15%|█▌        | 55/358 [00:05<00:31,  9.70it/s] 16%|█▌        | 56/358 [00:05<00:31,  9.74it/s] 16%|█▌        | 57/358 [00:05<00:31,  9.70it/s] 16%|█▌        | 58/358 [00:05<00:30,  9.68it/s] 16%|█▋        | 59/358 [00:06<00:30,  9.65it/s] 17%|█▋        | 61/358 [00:06<00:30,  9.73it/s] 17%|█▋        | 62/358 [00:06<00:30,  9.65it/s] 18%|█▊        | 63/358 [00:06<00:30,  9.72it/s] 18%|█▊        | 64/358 [00:06<00:30,  9.67it/s] 18%|█▊        | 66/358 [00:06<00:29,  9.74it/s] 19%|█▊        | 67/358 [00:06<00:29,  9.72it/s] 19%|█▉        | 69/358 [00:07<00:29,  9.79it/s] 20%|█▉        | 70/358 [00:07<00:29,  9.74it/s] 20%|█▉        | 71/358 [00:07<00:29,  9.78it/s] 20%|██        | 72/358 [00:07<00:29,  9.73it/s] 20%|██        | 73/358 [00:07<00:29,  9.70it/s] 21%|██        | 74/358 [00:07<00:29,  9.66it/s] 21%|██        | 75/358 [00:07<00:29,  9.63it/s] 22%|██▏       | 77/358 [00:07<00:28,  9.71it/s] 22%|██▏       | 79/358 [00:08<00:28,  9.71it/s] 23%|██▎       | 81/358 [00:08<00:28,  9.76it/s] 23%|██▎       | 83/358 [00:08<00:28,  9.79it/s] 23%|██▎       | 84/358 [00:08<00:28,  9.74it/s] 24%|██▎       | 85/358 [00:08<00:28,  9.70it/s] 24%|██▍       | 86/358 [00:08<00:28,  9.68it/s] 24%|██▍       | 87/358 [00:08<00:28,  9.66it/s] 25%|██▍       | 88/358 [00:09<00:27,  9.68it/s] 25%|██▌       | 90/358 [00:09<00:27,  9.91it/s] 26%|██▌       | 92/358 [00:09<00:26, 10.01it/s] 26%|██▌       | 93/358 [00:09<00:26,  9.98it/s] 26%|██▋       | 94/358 [00:09<00:26,  9.89it/s] 27%|██▋       | 96/358 [00:09<00:25, 10.16it/s] 27%|██▋       | 98/358 [00:09<00:25, 10.05it/s] 28%|██▊       | 99/358 [00:10<00:25,  9.96it/s] 28%|██▊       | 101/358 [00:10<00:25,  9.93it/s] 29%|██▉       | 103/358 [00:10<00:25,  9.92it/s] 29%|██▉       | 104/358 [00:10<00:25,  9.87it/s] 29%|██▉       | 105/358 [00:10<00:25,  9.80it/s] 30%|██▉       | 106/358 [00:10<00:25,  9.78it/s] 30%|███       | 108/358 [00:11<00:25,  9.81it/s] 30%|███       | 109/358 [00:11<00:25,  9.73it/s] 31%|███       | 110/358 [00:11<00:25,  9.71it/s] 31%|███       | 111/358 [00:11<00:25,  9.66it/s] 32%|███▏      | 113/358 [00:11<00:24,  9.93it/s] 32%|███▏      | 114/358 [00:11<00:24,  9.88it/s] 32%|███▏      | 115/358 [00:11<00:24,  9.79it/s] 32%|███▏      | 116/358 [00:11<00:24,  9.70it/s] 33%|███▎      | 117/358 [00:11<00:24,  9.68it/s] 33%|███▎      | 119/358 [00:12<00:24,  9.79it/s] 34%|███▍      | 121/358 [00:12<00:23,  9.99it/s] 34%|███▍      | 123/358 [00:12<00:23, 10.09it/s] 35%|███▍      | 125/358 [00:12<00:23, 10.06it/s] 35%|███▌      | 127/358 [00:12<00:23,  9.99it/s] 36%|███▌      | 128/358 [00:13<00:23,  9.95it/s] 36%|███▋      | 130/358 [00:13<00:22, 10.00it/s] 37%|███▋      | 131/358 [00:13<00:22,  9.90it/s] 37%|███▋      | 132/358 [00:13<00:22,  9.92it/s] 37%|███▋      | 134/358 [00:13<00:22,  9.94it/s] 38%|███▊      | 135/358 [00:13<00:22,  9.88it/s] 38%|███▊      | 137/358 [00:13<00:22,  9.97it/s] 39%|███▊      | 138/358 [00:14<00:22,  9.95it/s] 39%|███▉      | 139/358 [00:14<00:22,  9.86it/s] 39%|███▉      | 141/358 [00:14<00:21,  9.99it/s] 40%|███▉      | 142/358 [00:14<00:21,  9.91it/s] 40%|███▉      | 143/358 [00:14<00:21,  9.88it/s] 40%|████      | 144/358 [00:14<00:21,  9.79it/s] 41%|████      | 145/358 [00:14<00:21,  9.81it/s] 41%|████      | 146/358 [00:14<00:21,  9.75it/s] 41%|████      | 147/358 [00:14<00:21,  9.69it/s] 41%|████▏     | 148/358 [00:15<00:21,  9.72it/s] 42%|████▏     | 149/358 [00:15<00:21,  9.70it/s] 42%|████▏     | 150/358 [00:15<00:21,  9.66it/s] 42%|████▏     | 151/358 [00:15<00:22,  9.39it/s] 42%|████▏     | 152/358 [00:15<00:21,  9.44it/s] 43%|████▎     | 153/358 [00:15<00:21,  9.46it/s] 43%|████▎     | 154/358 [00:15<00:21,  9.55it/s] 43%|████▎     | 155/358 [00:15<00:21,  9.56it/s] 44%|████▎     | 156/358 [00:15<00:20,  9.69it/s] 44%|████▍     | 157/358 [00:16<00:20,  9.63it/s] 44%|████▍     | 158/358 [00:16<00:20,  9.72it/s] 44%|████▍     | 159/358 [00:16<00:20,  9.71it/s] 45%|████▍     | 160/358 [00:16<00:20,  9.72it/s] 45%|████▌     | 162/358 [00:16<00:19, 10.01it/s] 46%|████▌     | 164/358 [00:16<00:19, 10.01it/s] 46%|████▌     | 165/358 [00:16<00:19,  9.97it/s] 47%|████▋     | 167/358 [00:17<00:19,  9.91it/s] 47%|████▋     | 169/358 [00:17<00:18,  9.95it/s] 48%|████▊     | 171/358 [00:17<00:18,  9.93it/s] 48%|████▊     | 172/358 [00:17<00:18,  9.88it/s] 48%|████▊     | 173/358 [00:17<00:18,  9.82it/s] 49%|████▉     | 175/358 [00:17<00:18,  9.84it/s] 49%|████▉     | 176/358 [00:17<00:18,  9.85it/s] 49%|████▉     | 177/358 [00:18<00:18,  9.84it/s] 50%|█████     | 179/358 [00:18<00:18,  9.86it/s] 50%|█████     | 180/358 [00:18<00:18,  9.80it/s] 51%|█████     | 182/358 [00:18<00:17,  9.94it/s] 51%|█████     | 183/358 [00:18<00:17,  9.90it/s] 51%|█████▏    | 184/358 [00:18<00:17,  9.78it/s] 52%|█████▏    | 185/358 [00:18<00:17,  9.73it/s] 52%|█████▏    | 187/358 [00:19<00:17,  9.95it/s] 53%|█████▎    | 188/358 [00:19<00:17,  9.90it/s] 53%|█████▎    | 189/358 [00:19<00:17,  9.84it/s] 53%|█████▎    | 191/358 [00:19<00:17,  9.76it/s] 54%|█████▎    | 192/358 [00:19<00:17,  9.71it/s] 54%|█████▍    | 193/358 [00:19<00:17,  9.70it/s] 54%|█████▍    | 194/358 [00:19<00:16,  9.68it/s] 54%|█████▍    | 195/358 [00:19<00:16,  9.75it/s] 55%|█████▌    | 197/358 [00:20<00:16,  9.92it/s] 55%|█████▌    | 198/358 [00:20<00:16,  9.85it/s] 56%|█████▌    | 199/358 [00:20<00:16,  9.88it/s] 56%|█████▌    | 200/358 [00:20<00:16,  9.81it/s] 56%|█████▌    | 201/358 [00:20<00:16,  9.77it/s] 57%|█████▋    | 203/358 [00:20<00:15,  9.86it/s] 57%|█████▋    | 204/358 [00:20<00:15,  9.76it/s] 57%|█████▋    | 205/358 [00:20<00:15,  9.71it/s] 58%|█████▊    | 207/358 [00:21<00:15,  9.88it/s] 58%|█████▊    | 208/358 [00:21<00:15,  9.81it/s] 59%|█████▊    | 210/358 [00:21<00:15,  9.83it/s] 59%|█████▉    | 212/358 [00:21<00:14,  9.83it/s] 60%|█████▉    | 214/358 [00:21<00:14,  9.90it/s] 60%|██████    | 215/358 [00:21<00:14,  9.84it/s] 60%|██████    | 216/358 [00:22<00:14,  9.77it/s] 61%|██████    | 217/358 [00:22<00:14,  9.81it/s] 61%|██████    | 218/358 [00:22<00:14,  9.78it/s] 61%|██████    | 219/358 [00:22<00:14,  9.78it/s] 62%|██████▏   | 221/358 [00:22<00:13,  9.91it/s] 62%|██████▏   | 222/358 [00:22<00:13,  9.81it/s] 62%|██████▏   | 223/358 [00:22<00:13,  9.76it/s] 63%|██████▎   | 224/358 [00:22<00:13,  9.70it/s] 63%|██████▎   | 226/358 [00:23<00:13,  9.75it/s] 64%|██████▎   | 228/358 [00:23<00:13,  9.77it/s] 64%|██████▍   | 229/358 [00:23<00:13,  9.74it/s] 64%|██████▍   | 230/358 [00:23<00:13,  9.70it/s] 65%|██████▍   | 232/358 [00:23<00:12,  9.74it/s] 65%|██████▌   | 234/358 [00:23<00:12, 10.03it/s] 66%|██████▌   | 236/358 [00:24<00:12,  9.99it/s] 66%|██████▋   | 238/358 [00:24<00:11, 10.04it/s] 67%|██████▋   | 240/358 [00:24<00:11, 10.00it/s] 68%|██████▊   | 242/358 [00:24<00:11,  9.98it/s] 68%|██████▊   | 243/358 [00:24<00:11,  9.92it/s] 68%|██████▊   | 244/358 [00:24<00:11,  9.85it/s] 69%|██████▊   | 246/358 [00:25<00:11,  9.88it/s] 69%|██████▉   | 247/358 [00:25<00:11,  9.81it/s] 69%|██████▉   | 248/358 [00:25<00:11,  9.76it/s] 70%|██████▉   | 250/358 [00:25<00:10,  9.86it/s] 70%|███████   | 251/358 [00:25<00:10,  9.80it/s] 70%|███████   | 252/358 [00:25<00:10,  9.73it/s] 71%|███████   | 253/358 [00:25<00:10,  9.69it/s] 71%|███████   | 254/358 [00:25<00:10,  9.66it/s] 72%|███████▏  | 256/358 [00:26<00:10,  9.84it/s] 72%|███████▏  | 257/358 [00:26<00:10,  9.85it/s] 72%|███████▏  | 258/358 [00:26<00:10,  9.72it/s] 72%|███████▏  | 259/358 [00:26<00:10,  9.69it/s] 73%|███████▎  | 260/358 [00:26<00:10,  9.72it/s] 73%|███████▎  | 262/358 [00:26<00:09,  9.90it/s] 74%|███████▎  | 264/358 [00:26<00:09,  9.92it/s] 74%|███████▍  | 266/358 [00:27<00:09,  9.91it/s] 75%|███████▍  | 267/358 [00:27<00:09,  9.85it/s] 75%|███████▌  | 269/358 [00:27<00:08,  9.91it/s] 75%|███████▌  | 270/358 [00:27<00:08,  9.84it/s] 76%|███████▌  | 271/358 [00:27<00:08,  9.76it/s] 76%|███████▌  | 272/358 [00:27<00:08,  9.74it/s] 76%|███████▋  | 273/358 [00:27<00:08,  9.64it/s] 77%|███████▋  | 274/358 [00:27<00:08,  9.64it/s] 77%|███████▋  | 275/358 [00:28<00:08,  9.68it/s] 77%|███████▋  | 276/358 [00:28<00:08,  9.69it/s] 77%|███████▋  | 277/358 [00:28<00:08,  9.66it/s] 78%|███████▊  | 278/358 [00:28<00:08,  9.56it/s] 78%|███████▊  | 280/358 [00:28<00:07,  9.78it/s] 78%|███████▊  | 281/358 [00:28<00:07,  9.79it/s] 79%|███████▉  | 282/358 [00:28<00:07,  9.74it/s] 79%|███████▉  | 283/358 [00:28<00:07,  9.69it/s] 79%|███████▉  | 284/358 [00:28<00:07,  9.66it/s] 80%|███████▉  | 285/358 [00:29<00:07,  9.73it/s] 80%|███████▉  | 286/358 [00:29<00:07,  9.69it/s] 80%|████████  | 287/358 [00:29<00:07,  9.67it/s] 80%|████████  | 288/358 [00:29<00:07,  9.63it/s] 81%|████████  | 290/358 [00:29<00:06,  9.85it/s] 81%|████████▏ | 291/358 [00:29<00:06,  9.83it/s] 82%|████████▏ | 293/358 [00:29<00:06,  9.84it/s] 82%|████████▏ | 295/358 [00:30<00:06,  9.91it/s] 83%|████████▎ | 296/358 [00:30<00:06,  9.85it/s] 83%|████████▎ | 297/358 [00:30<00:06,  9.74it/s] 84%|████████▎ | 299/358 [00:30<00:05,  9.90it/s] 84%|████████▍ | 301/358 [00:30<00:05,  9.93it/s] 84%|████████▍ | 302/358 [00:30<00:05,  9.87it/s] 85%|████████▍ | 303/358 [00:30<00:05,  9.88it/s] 85%|████████▌ | 305/358 [00:31<00:05,  9.91it/s] 85%|████████▌ | 306/358 [00:31<00:05,  9.83it/s] 86%|████████▌ | 308/358 [00:31<00:05,  9.93it/s] 86%|████████▋ | 309/358 [00:31<00:04,  9.82it/s] 87%|████████▋ | 310/358 [00:31<00:04,  9.77it/s] 87%|████████▋ | 311/358 [00:31<00:04,  9.69it/s] 87%|████████▋ | 312/358 [00:31<00:04,  9.71it/s] 87%|████████▋ | 313/358 [00:31<00:04,  9.73it/s] 88%|████████▊ | 315/358 [00:32<00:04,  9.99it/s] 88%|████████▊ | 316/358 [00:32<00:04,  9.94it/s] 89%|████████▊ | 317/358 [00:32<00:04,  9.85it/s] 89%|████████▉ | 318/358 [00:32<00:04,  9.81it/s] 89%|████████▉ | 319/358 [00:32<00:03,  9.76it/s] 89%|████████▉ | 320/358 [00:32<00:03,  9.82it/s] 90%|████████▉ | 321/358 [00:32<00:03,  9.75it/s] 90%|████████▉ | 322/358 [00:32<00:03,  9.71it/s] 90%|█████████ | 323/358 [00:32<00:03,  9.66it/s] 91%|█████████ | 324/358 [00:33<00:03,  9.64it/s] 91%|█████████ | 325/358 [00:33<00:03,  9.61it/s] 91%|█████████▏| 327/358 [00:33<00:03,  9.97it/s] 92%|█████████▏| 329/358 [00:33<00:02, 10.04it/s] 92%|█████████▏| 330/358 [00:33<00:02,  9.94it/s] 93%|█████████▎| 332/358 [00:33<00:02, 10.04it/s] 93%|█████████▎| 334/358 [00:34<00:02,  9.95it/s] 94%|█████████▎| 335/358 [00:34<00:02,  9.83it/s] 94%|█████████▍| 337/358 [00:34<00:02,  9.91it/s] 95%|█████████▍| 339/358 [00:34<00:01, 10.11it/s] 95%|█████████▌| 341/358 [00:34<00:01, 10.06it/s] 96%|█████████▌| 343/358 [00:34<00:01,  9.90it/s] 96%|█████████▌| 344/358 [00:35<00:01,  9.84it/s] 96%|█████████▋| 345/358 [00:35<00:01,  9.86it/s] 97%|█████████▋| 347/358 [00:35<00:01, 10.03it/s] 97%|█████████▋| 348/358 [00:35<00:01,  9.94it/s] 97%|█████████▋| 349/358 [00:35<00:00,  9.86it/s] 98%|█████████▊| 350/358 [00:35<00:00,  9.79it/s] 98%|█████████▊| 351/358 [00:35<00:00,  9.74it/s] 99%|█████████▊| 353/358 [00:35<00:00,  9.92it/s] 99%|█████████▉| 354/358 [00:36<00:00,  9.91it/s] 99%|█████████▉| 355/358 [00:36<00:00,  9.82it/s]100%|█████████▉| 357/358 [00:36<00:00,  9.87it/s]100%|██████████| 358/358 [00:36<00:00,  9.83it/s]
[32m2025-02-05 06:11:45.496[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    gen_loss  grad clip ratio  grad norm   ppl
       1.867                1      2.281 6.471[0m
[32m2025-02-05 06:11:45.497[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m169[0m - [1m[Valid][0m
  0%|          | 0/10256 [00:00<?, ?it/s]100%|██████████| 10256/10256 [00:00<00:00, 927845.69it/s]
[32m2025-02-05 06:11:45.508[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:27,  1.43it/s]  5%|▌         | 2/40 [00:01<00:26,  1.45it/s]  8%|▊         | 3/40 [00:02<00:25,  1.45it/s] 10%|█         | 4/40 [00:02<00:24,  1.45it/s] 12%|█▎        | 5/40 [00:03<00:24,  1.44it/s] 15%|█▌        | 6/40 [00:04<00:23,  1.44it/s] 18%|█▊        | 7/40 [00:04<00:22,  1.44it/s] 20%|██        | 8/40 [00:05<00:22,  1.45it/s] 22%|██▎       | 9/40 [00:06<00:21,  1.45it/s] 25%|██▌       | 10/40 [00:06<00:20,  1.46it/s] 28%|██▊       | 11/40 [00:07<00:19,  1.46it/s] 30%|███       | 12/40 [00:08<00:19,  1.46it/s] 32%|███▎      | 13/40 [00:08<00:18,  1.46it/s] 35%|███▌      | 14/40 [00:09<00:17,  1.46it/s] 38%|███▊      | 15/40 [00:10<00:17,  1.46it/s] 40%|████      | 16/40 [00:11<00:16,  1.45it/s] 42%|████▎     | 17/40 [00:11<00:15,  1.46it/s] 45%|████▌     | 18/40 [00:12<00:15,  1.46it/s] 48%|████▊     | 19/40 [00:13<00:14,  1.46it/s] 50%|█████     | 20/40 [00:13<00:13,  1.46it/s] 52%|█████▎    | 21/40 [00:14<00:12,  1.46it/s] 55%|█████▌    | 22/40 [00:15<00:12,  1.46it/s] 57%|█████▊    | 23/40 [00:15<00:11,  1.46it/s] 60%|██████    | 24/40 [00:16<00:10,  1.45it/s] 62%|██████▎   | 25/40 [00:17<00:10,  1.45it/s] 65%|██████▌   | 26/40 [00:17<00:09,  1.46it/s] 68%|██████▊   | 27/40 [00:18<00:08,  1.46it/s] 70%|███████   | 28/40 [00:19<00:08,  1.46it/s] 72%|███████▎  | 29/40 [00:19<00:07,  1.46it/s] 75%|███████▌  | 30/40 [00:20<00:06,  1.46it/s] 78%|███████▊  | 31/40 [00:21<00:06,  1.46it/s] 80%|████████  | 32/40 [00:21<00:05,  1.46it/s] 82%|████████▎ | 33/40 [00:22<00:04,  1.46it/s] 85%|████████▌ | 34/40 [00:23<00:04,  1.46it/s] 88%|████████▊ | 35/40 [00:24<00:03,  1.46it/s] 90%|█████████ | 36/40 [00:24<00:02,  1.45it/s] 92%|█████████▎| 37/40 [00:25<00:02,  1.46it/s] 95%|█████████▌| 38/40 [00:26<00:01,  1.45it/s] 98%|█████████▊| 39/40 [00:26<00:00,  1.45it/s]100%|██████████| 40/40 [00:27<00:00,  1.60it/s]100%|██████████| 40/40 [00:27<00:00,  1.47it/s]
[32m2025-02-05 06:12:12.793[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    average  bleu@1  bleu@2  bleu@3  bleu@4  dist@1  dist@2  dist@3  dist@4  extreme  \
      .7803   .2985   .1107  .04247  .02147  .04283   .2919   .5641   .7305    .5980   
      f1  gen_loss  greedy  intra_dist@1  intra_dist@2  intra_dist@3  intra_dist@4  \
   .3522     5.103   .6699         .8706         .9675         .9521         .9187   
     ppl  rouge1  rouge2  rougeL  
   164.5   .3852   .0900   .3734[0m
[32m2025-02-05 06:12:12.799[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m163[0m - [1m[Conversation epoch 60][0m
[32m2025-02-05 06:12:12.799[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m164[0m - [1m[Train][0m
  0%|          | 0/92414 [00:00<?, ?it/s]100%|██████████| 92414/92414 [00:00<00:00, 1089588.55it/s]
[32m2025-02-05 06:12:12.884[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/358 [00:00<?, ?it/s]  0%|          | 1/358 [00:00<00:36,  9.76it/s]  1%|          | 3/358 [00:00<00:35,  9.93it/s]  1%|          | 4/358 [00:00<00:35,  9.92it/s]  2%|▏         | 6/358 [00:00<00:35,  9.88it/s]  2%|▏         | 7/358 [00:00<00:35,  9.82it/s]  2%|▏         | 8/358 [00:00<00:35,  9.86it/s]  3%|▎         | 9/358 [00:00<00:35,  9.76it/s]  3%|▎         | 10/358 [00:01<00:35,  9.75it/s]  3%|▎         | 11/358 [00:01<00:35,  9.70it/s]  4%|▎         | 13/358 [00:01<00:34,  9.92it/s]  4%|▍         | 14/358 [00:01<00:34,  9.85it/s]  4%|▍         | 15/358 [00:01<00:35,  9.77it/s]  4%|▍         | 16/358 [00:01<00:35,  9.71it/s]  5%|▍         | 17/358 [00:01<00:35,  9.73it/s]  5%|▌         | 19/358 [00:01<00:34,  9.75it/s]  6%|▌         | 20/358 [00:02<00:34,  9.70it/s]  6%|▌         | 21/358 [00:02<00:34,  9.64it/s]  6%|▌         | 22/358 [00:02<00:34,  9.69it/s]  7%|▋         | 24/358 [00:02<00:34,  9.78it/s]  7%|▋         | 25/358 [00:02<00:34,  9.73it/s]  7%|▋         | 26/358 [00:02<00:34,  9.68it/s]  8%|▊         | 27/358 [00:02<00:34,  9.73it/s]  8%|▊         | 28/358 [00:02<00:34,  9.69it/s]  8%|▊         | 29/358 [00:02<00:34,  9.66it/s]  9%|▊         | 31/358 [00:03<00:33,  9.75it/s]  9%|▉         | 32/358 [00:03<00:33,  9.75it/s]  9%|▉         | 34/358 [00:03<00:32,  9.85it/s] 10%|█         | 36/358 [00:03<00:32,  9.85it/s] 10%|█         | 37/358 [00:03<00:32,  9.83it/s] 11%|█         | 38/358 [00:03<00:32,  9.79it/s] 11%|█         | 40/358 [00:04<00:31,  9.95it/s] 11%|█▏        | 41/358 [00:04<00:32,  9.86it/s] 12%|█▏        | 43/358 [00:04<00:31,  9.89it/s] 13%|█▎        | 45/358 [00:04<00:31,  9.98it/s] 13%|█▎        | 47/358 [00:04<00:31,  9.96it/s] 13%|█▎        | 48/358 [00:04<00:31,  9.95it/s] 14%|█▍        | 50/358 [00:05<00:31,  9.92it/s] 14%|█▍        | 51/358 [00:05<00:31,  9.85it/s] 15%|█▍        | 52/358 [00:05<00:31,  9.76it/s] 15%|█▍        | 53/358 [00:05<00:31,  9.71it/s] 15%|█▌        | 54/358 [00:05<00:31,  9.75it/s] 15%|█▌        | 55/358 [00:05<00:31,  9.69it/s] 16%|█▌        | 56/358 [00:05<00:31,  9.73it/s] 16%|█▌        | 57/358 [00:05<00:31,  9.69it/s] 16%|█▌        | 58/358 [00:05<00:31,  9.67it/s] 16%|█▋        | 59/358 [00:06<00:31,  9.64it/s] 17%|█▋        | 61/358 [00:06<00:30,  9.73it/s] 17%|█▋        | 62/358 [00:06<00:30,  9.65it/s] 18%|█▊        | 63/358 [00:06<00:30,  9.71it/s] 18%|█▊        | 64/358 [00:06<00:30,  9.66it/s] 18%|█▊        | 66/358 [00:06<00:29,  9.74it/s] 19%|█▊        | 67/358 [00:06<00:29,  9.72it/s] 19%|█▉        | 69/358 [00:07<00:29,  9.78it/s] 20%|█▉        | 70/358 [00:07<00:29,  9.73it/s] 20%|█▉        | 71/358 [00:07<00:29,  9.77it/s] 20%|██        | 72/358 [00:07<00:29,  9.72it/s] 20%|██        | 73/358 [00:07<00:29,  9.69it/s] 21%|██        | 74/358 [00:07<00:29,  9.66it/s] 21%|██        | 75/358 [00:07<00:29,  9.63it/s] 21%|██        | 76/358 [00:07<00:28,  9.73it/s] 22%|██▏       | 77/358 [00:07<00:28,  9.69it/s] 22%|██▏       | 79/358 [00:08<00:28,  9.70it/s] 23%|██▎       | 81/358 [00:08<00:28,  9.76it/s] 23%|██▎       | 83/358 [00:08<00:28,  9.79it/s] 23%|██▎       | 84/358 [00:08<00:28,  9.73it/s] 24%|██▎       | 85/358 [00:08<00:28,  9.69it/s] 24%|██▍       | 86/358 [00:08<00:28,  9.68it/s] 24%|██▍       | 87/358 [00:08<00:28,  9.66it/s] 25%|██▍       | 88/358 [00:09<00:27,  9.68it/s] 25%|██▌       | 90/358 [00:09<00:27,  9.91it/s] 26%|██▌       | 92/358 [00:09<00:26, 10.01it/s] 26%|██▌       | 93/358 [00:09<00:26,  9.97it/s] 26%|██▋       | 94/358 [00:09<00:26,  9.89it/s] 27%|██▋       | 96/358 [00:09<00:25, 10.16it/s] 27%|██▋       | 98/358 [00:10<00:25, 10.05it/s] 28%|██▊       | 99/358 [00:10<00:26,  9.96it/s] 28%|██▊       | 101/358 [00:10<00:25,  9.93it/s] 29%|██▉       | 103/358 [00:10<00:25,  9.92it/s] 29%|██▉       | 104/358 [00:10<00:25,  9.87it/s] 29%|██▉       | 105/358 [00:10<00:25,  9.79it/s] 30%|██▉       | 106/358 [00:10<00:25,  9.77it/s] 30%|███       | 108/358 [00:11<00:25,  9.80it/s] 30%|███       | 109/358 [00:11<00:25,  9.72it/s] 31%|███       | 110/358 [00:11<00:25,  9.70it/s] 31%|███       | 111/358 [00:11<00:25,  9.66it/s] 32%|███▏      | 113/358 [00:11<00:24,  9.92it/s] 32%|███▏      | 114/358 [00:11<00:24,  9.88it/s] 32%|███▏      | 115/358 [00:11<00:24,  9.79it/s] 32%|███▏      | 116/358 [00:11<00:24,  9.70it/s] 33%|███▎      | 117/358 [00:11<00:24,  9.67it/s] 33%|███▎      | 119/358 [00:12<00:24,  9.79it/s] 34%|███▍      | 121/358 [00:12<00:23,  9.99it/s] 34%|███▍      | 123/358 [00:12<00:23, 10.09it/s] 35%|███▍      | 125/358 [00:12<00:23, 10.07it/s] 35%|███▌      | 127/358 [00:12<00:23,  9.99it/s] 36%|███▌      | 128/358 [00:13<00:23,  9.95it/s] 36%|███▋      | 130/358 [00:13<00:22, 10.00it/s] 37%|███▋      | 131/358 [00:13<00:22,  9.91it/s] 37%|███▋      | 132/358 [00:13<00:22,  9.92it/s] 37%|███▋      | 134/358 [00:13<00:22,  9.94it/s] 38%|███▊      | 135/358 [00:13<00:22,  9.88it/s] 38%|███▊      | 137/358 [00:13<00:22,  9.97it/s] 39%|███▊      | 138/358 [00:14<00:22,  9.95it/s] 39%|███▉      | 139/358 [00:14<00:22,  9.86it/s] 39%|███▉      | 141/358 [00:14<00:21,  9.99it/s] 40%|███▉      | 142/358 [00:14<00:21,  9.91it/s] 40%|███▉      | 143/358 [00:14<00:21,  9.87it/s] 40%|████      | 144/358 [00:14<00:21,  9.79it/s] 41%|████      | 145/358 [00:14<00:21,  9.81it/s] 41%|████      | 146/358 [00:14<00:21,  9.74it/s] 41%|████      | 147/358 [00:14<00:21,  9.69it/s] 41%|████▏     | 148/358 [00:15<00:21,  9.71it/s] 42%|████▏     | 149/358 [00:15<00:21,  9.70it/s] 42%|████▏     | 150/358 [00:15<00:21,  9.65it/s] 42%|████▏     | 151/358 [00:15<00:22,  9.39it/s] 42%|████▏     | 152/358 [00:15<00:21,  9.44it/s] 43%|████▎     | 153/358 [00:15<00:21,  9.46it/s] 43%|████▎     | 154/358 [00:15<00:21,  9.55it/s] 43%|████▎     | 155/358 [00:15<00:21,  9.56it/s] 44%|████▎     | 156/358 [00:15<00:20,  9.69it/s] 44%|████▍     | 157/358 [00:16<00:20,  9.63it/s] 44%|████▍     | 158/358 [00:16<00:20,  9.71it/s] 44%|████▍     | 159/358 [00:16<00:20,  9.71it/s] 45%|████▍     | 160/358 [00:16<00:20,  9.72it/s] 45%|████▌     | 162/358 [00:16<00:19, 10.01it/s] 46%|████▌     | 164/358 [00:16<00:19, 10.01it/s] 46%|████▌     | 165/358 [00:16<00:19,  9.97it/s] 47%|████▋     | 167/358 [00:17<00:19,  9.91it/s] 47%|████▋     | 169/358 [00:17<00:18,  9.95it/s] 48%|████▊     | 171/358 [00:17<00:18,  9.93it/s] 48%|████▊     | 172/358 [00:17<00:18,  9.88it/s] 48%|████▊     | 173/358 [00:17<00:18,  9.82it/s] 49%|████▉     | 175/358 [00:17<00:18,  9.84it/s] 49%|████▉     | 176/358 [00:17<00:18,  9.85it/s] 49%|████▉     | 177/358 [00:18<00:18,  9.84it/s] 50%|█████     | 179/358 [00:18<00:18,  9.86it/s] 50%|█████     | 180/358 [00:18<00:18,  9.79it/s] 51%|█████     | 182/358 [00:18<00:17,  9.95it/s] 51%|█████     | 183/358 [00:18<00:17,  9.90it/s] 51%|█████▏    | 184/358 [00:18<00:17,  9.79it/s] 52%|█████▏    | 185/358 [00:18<00:17,  9.73it/s] 52%|█████▏    | 187/358 [00:19<00:17,  9.95it/s] 53%|█████▎    | 188/358 [00:19<00:17,  9.89it/s] 53%|█████▎    | 189/358 [00:19<00:17,  9.84it/s] 53%|█████▎    | 191/358 [00:19<00:17,  9.75it/s] 54%|█████▎    | 192/358 [00:19<00:17,  9.71it/s] 54%|█████▍    | 193/358 [00:19<00:17,  9.69it/s] 54%|█████▍    | 194/358 [00:19<00:16,  9.67it/s] 54%|█████▍    | 195/358 [00:19<00:16,  9.74it/s] 55%|█████▌    | 197/358 [00:20<00:16,  9.92it/s] 55%|█████▌    | 198/358 [00:20<00:16,  9.84it/s] 56%|█████▌    | 199/358 [00:20<00:16,  9.88it/s] 56%|█████▌    | 200/358 [00:20<00:16,  9.81it/s] 56%|█████▌    | 201/358 [00:20<00:16,  9.77it/s] 57%|█████▋    | 203/358 [00:20<00:15,  9.86it/s] 57%|█████▋    | 204/358 [00:20<00:15,  9.76it/s] 57%|█████▋    | 205/358 [00:20<00:15,  9.71it/s] 58%|█████▊    | 207/358 [00:21<00:15,  9.88it/s] 58%|█████▊    | 208/358 [00:21<00:15,  9.81it/s] 59%|█████▊    | 210/358 [00:21<00:15,  9.82it/s] 59%|█████▉    | 212/358 [00:21<00:14,  9.81it/s] 60%|█████▉    | 214/358 [00:21<00:14,  9.89it/s] 60%|██████    | 215/358 [00:21<00:14,  9.83it/s] 60%|██████    | 216/358 [00:22<00:14,  9.76it/s] 61%|██████    | 217/358 [00:22<00:14,  9.80it/s] 61%|██████    | 218/358 [00:22<00:14,  9.77it/s] 61%|██████    | 219/358 [00:22<00:14,  9.77it/s] 62%|██████▏   | 221/358 [00:22<00:13,  9.91it/s] 62%|██████▏   | 222/358 [00:22<00:13,  9.80it/s] 62%|██████▏   | 223/358 [00:22<00:13,  9.75it/s] 63%|██████▎   | 224/358 [00:22<00:13,  9.69it/s] 63%|██████▎   | 226/358 [00:23<00:13,  9.74it/s] 64%|██████▎   | 228/358 [00:23<00:13,  9.76it/s] 64%|██████▍   | 229/358 [00:23<00:13,  9.74it/s] 64%|██████▍   | 230/358 [00:23<00:13,  9.69it/s] 65%|██████▍   | 232/358 [00:23<00:12,  9.73it/s] 65%|██████▌   | 234/358 [00:23<00:12, 10.02it/s] 66%|██████▌   | 236/358 [00:24<00:12,  9.98it/s] 66%|██████▋   | 238/358 [00:24<00:11, 10.03it/s] 67%|██████▋   | 240/358 [00:24<00:11,  9.99it/s] 68%|██████▊   | 242/358 [00:24<00:11,  9.97it/s] 68%|██████▊   | 243/358 [00:24<00:11,  9.91it/s] 68%|██████▊   | 244/358 [00:24<00:11,  9.85it/s] 69%|██████▊   | 246/358 [00:25<00:11,  9.87it/s] 69%|██████▉   | 247/358 [00:25<00:11,  9.80it/s] 69%|██████▉   | 248/358 [00:25<00:11,  9.75it/s] 70%|██████▉   | 250/358 [00:25<00:10,  9.85it/s] 70%|███████   | 251/358 [00:25<00:10,  9.79it/s] 70%|███████   | 252/358 [00:25<00:10,  9.73it/s] 71%|███████   | 253/358 [00:25<00:10,  9.69it/s] 71%|███████   | 254/358 [00:25<00:10,  9.66it/s] 72%|███████▏  | 256/358 [00:26<00:10,  9.84it/s] 72%|███████▏  | 257/358 [00:26<00:10,  9.84it/s] 72%|███████▏  | 258/358 [00:26<00:10,  9.71it/s] 72%|███████▏  | 259/358 [00:26<00:10,  9.68it/s] 73%|███████▎  | 260/358 [00:26<00:10,  9.72it/s] 73%|███████▎  | 262/358 [00:26<00:09,  9.90it/s] 74%|███████▎  | 264/358 [00:26<00:09,  9.91it/s] 74%|███████▍  | 266/358 [00:27<00:09,  9.89it/s] 75%|███████▍  | 267/358 [00:27<00:09,  9.84it/s] 75%|███████▌  | 269/358 [00:27<00:08,  9.90it/s] 75%|███████▌  | 270/358 [00:27<00:08,  9.83it/s] 76%|███████▌  | 271/358 [00:27<00:08,  9.75it/s] 76%|███████▌  | 272/358 [00:27<00:08,  9.73it/s] 76%|███████▋  | 273/358 [00:27<00:08,  9.63it/s] 77%|███████▋  | 274/358 [00:27<00:08,  9.63it/s] 77%|███████▋  | 275/358 [00:28<00:08,  9.68it/s] 77%|███████▋  | 276/358 [00:28<00:08,  9.68it/s] 77%|███████▋  | 277/358 [00:28<00:08,  9.66it/s] 78%|███████▊  | 278/358 [00:28<00:08,  9.63it/s] 78%|███████▊  | 280/358 [00:28<00:07,  9.82it/s] 78%|███████▊  | 281/358 [00:28<00:07,  9.83it/s] 79%|███████▉  | 282/358 [00:28<00:07,  9.77it/s] 79%|███████▉  | 283/358 [00:28<00:07,  9.71it/s] 79%|███████▉  | 284/358 [00:28<00:07,  9.67it/s] 80%|███████▉  | 285/358 [00:29<00:07,  9.74it/s] 80%|███████▉  | 286/358 [00:29<00:07,  9.69it/s] 80%|████████  | 287/358 [00:29<00:07,  9.67it/s] 80%|████████  | 288/358 [00:29<00:07,  9.63it/s] 81%|████████  | 290/358 [00:29<00:06,  9.84it/s] 81%|████████▏ | 291/358 [00:29<00:06,  9.82it/s] 82%|████████▏ | 293/358 [00:29<00:06,  9.83it/s] 82%|████████▏ | 295/358 [00:30<00:06,  9.91it/s] 83%|████████▎ | 296/358 [00:30<00:06,  9.84it/s] 83%|████████▎ | 297/358 [00:30<00:06,  9.73it/s] 84%|████████▎ | 299/358 [00:30<00:05,  9.89it/s] 84%|████████▍ | 301/358 [00:30<00:05,  9.93it/s] 84%|████████▍ | 302/358 [00:30<00:05,  9.87it/s] 85%|████████▍ | 303/358 [00:30<00:05,  9.88it/s] 85%|████████▌ | 305/358 [00:31<00:05,  9.90it/s] 85%|████████▌ | 306/358 [00:31<00:05,  9.82it/s] 86%|████████▌ | 308/358 [00:31<00:05,  9.93it/s] 86%|████████▋ | 309/358 [00:31<00:04,  9.83it/s] 87%|████████▋ | 310/358 [00:31<00:04,  9.77it/s] 87%|████████▋ | 311/358 [00:31<00:04,  9.69it/s] 87%|████████▋ | 312/358 [00:31<00:04,  9.71it/s] 87%|████████▋ | 313/358 [00:31<00:04,  9.73it/s] 88%|████████▊ | 315/358 [00:32<00:04,  9.98it/s] 88%|████████▊ | 316/358 [00:32<00:04,  9.93it/s] 89%|████████▊ | 317/358 [00:32<00:04,  9.85it/s] 89%|████████▉ | 318/358 [00:32<00:04,  9.81it/s] 89%|████████▉ | 319/358 [00:32<00:03,  9.76it/s] 89%|████████▉ | 320/358 [00:32<00:03,  9.82it/s] 90%|████████▉ | 321/358 [00:32<00:03,  9.75it/s] 90%|████████▉ | 322/358 [00:32<00:03,  9.71it/s] 90%|█████████ | 323/358 [00:32<00:03,  9.66it/s] 91%|█████████ | 324/358 [00:33<00:03,  9.63it/s] 91%|█████████ | 325/358 [00:33<00:03,  9.61it/s] 91%|█████████▏| 327/358 [00:33<00:03,  9.97it/s] 92%|█████████▏| 329/358 [00:33<00:02, 10.07it/s] 92%|█████████▏| 330/358 [00:33<00:02,  9.96it/s] 93%|█████████▎| 332/358 [00:33<00:02, 10.06it/s] 93%|█████████▎| 334/358 [00:34<00:02,  9.96it/s] 94%|█████████▎| 335/358 [00:34<00:02,  9.84it/s] 94%|█████████▍| 337/358 [00:34<00:02,  9.92it/s] 95%|█████████▍| 339/358 [00:34<00:01, 10.12it/s] 95%|█████████▌| 341/358 [00:34<00:01, 10.06it/s] 96%|█████████▌| 343/358 [00:34<00:01,  9.90it/s] 96%|█████████▌| 344/358 [00:35<00:01,  9.84it/s] 96%|█████████▋| 345/358 [00:35<00:01,  9.86it/s] 97%|█████████▋| 347/358 [00:35<00:01, 10.04it/s] 97%|█████████▋| 348/358 [00:35<00:01,  9.94it/s] 97%|█████████▋| 349/358 [00:35<00:00,  9.86it/s] 98%|█████████▊| 350/358 [00:35<00:00,  9.79it/s] 98%|█████████▊| 351/358 [00:35<00:00,  9.75it/s] 99%|█████████▊| 353/358 [00:35<00:00,  9.92it/s] 99%|█████████▉| 354/358 [00:36<00:00,  9.90it/s] 99%|█████████▉| 355/358 [00:36<00:00,  9.81it/s]100%|█████████▉| 357/358 [00:36<00:00,  9.87it/s]100%|██████████| 358/358 [00:36<00:00,  9.83it/s]
[32m2025-02-05 06:12:49.317[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    gen_loss  grad clip ratio  grad norm   ppl
       1.859                1      2.788 6.415[0m
[32m2025-02-05 06:12:49.318[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m169[0m - [1m[Valid][0m
  0%|          | 0/10256 [00:00<?, ?it/s]100%|██████████| 10256/10256 [00:00<00:00, 920676.79it/s]
[32m2025-02-05 06:12:49.329[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:27,  1.41it/s]  5%|▌         | 2/40 [00:01<00:26,  1.44it/s]  8%|▊         | 3/40 [00:02<00:25,  1.44it/s] 10%|█         | 4/40 [00:02<00:24,  1.45it/s] 12%|█▎        | 5/40 [00:03<00:24,  1.43it/s] 15%|█▌        | 6/40 [00:04<00:23,  1.44it/s] 18%|█▊        | 7/40 [00:04<00:23,  1.43it/s] 20%|██        | 8/40 [00:05<00:22,  1.44it/s] 22%|██▎       | 9/40 [00:06<00:21,  1.45it/s] 25%|██▌       | 10/40 [00:06<00:20,  1.45it/s] 28%|██▊       | 11/40 [00:07<00:19,  1.45it/s] 30%|███       | 12/40 [00:08<00:19,  1.45it/s] 32%|███▎      | 13/40 [00:09<00:18,  1.45it/s] 35%|███▌      | 14/40 [00:09<00:18,  1.44it/s] 38%|███▊      | 15/40 [00:10<00:17,  1.44it/s] 40%|████      | 16/40 [00:11<00:16,  1.44it/s] 42%|████▎     | 17/40 [00:11<00:15,  1.45it/s] 45%|████▌     | 18/40 [00:12<00:15,  1.45it/s] 48%|████▊     | 19/40 [00:13<00:14,  1.44it/s] 50%|█████     | 20/40 [00:13<00:13,  1.45it/s] 52%|█████▎    | 21/40 [00:14<00:13,  1.46it/s] 55%|█████▌    | 22/40 [00:15<00:12,  1.45it/s] 57%|█████▊    | 23/40 [00:15<00:11,  1.45it/s] 60%|██████    | 24/40 [00:16<00:11,  1.44it/s] 62%|██████▎   | 25/40 [00:17<00:10,  1.44it/s] 65%|██████▌   | 26/40 [00:17<00:09,  1.45it/s] 68%|██████▊   | 27/40 [00:18<00:08,  1.45it/s] 70%|███████   | 28/40 [00:19<00:08,  1.44it/s] 72%|███████▎  | 29/40 [00:20<00:07,  1.45it/s] 75%|███████▌  | 30/40 [00:20<00:06,  1.45it/s] 78%|███████▊  | 31/40 [00:21<00:06,  1.45it/s] 80%|████████  | 32/40 [00:22<00:05,  1.45it/s] 82%|████████▎ | 33/40 [00:22<00:04,  1.45it/s] 85%|████████▌ | 34/40 [00:23<00:04,  1.45it/s] 88%|████████▊ | 35/40 [00:24<00:03,  1.45it/s] 90%|█████████ | 36/40 [00:24<00:02,  1.44it/s] 92%|█████████▎| 37/40 [00:25<00:02,  1.44it/s] 95%|█████████▌| 38/40 [00:26<00:01,  1.44it/s] 98%|█████████▊| 39/40 [00:26<00:00,  1.44it/s]100%|██████████| 40/40 [00:27<00:00,  1.59it/s]100%|██████████| 40/40 [00:27<00:00,  1.46it/s]
[32m2025-02-05 06:13:16.811[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    average  bleu@1  bleu@2  bleu@3  bleu@4  dist@1  dist@2  dist@3  dist@4  extreme  \
      .7770   .2949   .1079  .04043  .02027  .04205   .2959   .5748   .7344    .5958   
      f1  gen_loss  greedy  intra_dist@1  intra_dist@2  intra_dist@3  intra_dist@4  \
   .3475     5.118   .6676         .8559         .9594         .9441         .9150   
    ppl  rouge1  rouge2  rougeL  
    167   .3823  .08758   .3703[0m
[32m2025-02-05 06:13:16.817[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m163[0m - [1m[Conversation epoch 61][0m
[32m2025-02-05 06:13:16.817[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m164[0m - [1m[Train][0m
  0%|          | 0/92414 [00:00<?, ?it/s]100%|██████████| 92414/92414 [00:00<00:00, 1108280.99it/s]
[32m2025-02-05 06:13:16.901[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/358 [00:00<?, ?it/s]  0%|          | 1/358 [00:00<00:36,  9.78it/s]  1%|          | 3/358 [00:00<00:35,  9.94it/s]  1%|          | 4/358 [00:00<00:35,  9.92it/s]  2%|▏         | 6/358 [00:00<00:35,  9.89it/s]  2%|▏         | 7/358 [00:00<00:35,  9.82it/s]  2%|▏         | 8/358 [00:00<00:35,  9.86it/s]  3%|▎         | 9/358 [00:00<00:35,  9.77it/s]  3%|▎         | 10/358 [00:01<00:35,  9.76it/s]  3%|▎         | 11/358 [00:01<00:35,  9.70it/s]  4%|▎         | 13/358 [00:01<00:34,  9.92it/s]  4%|▍         | 14/358 [00:01<00:34,  9.85it/s]  4%|▍         | 15/358 [00:01<00:35,  9.77it/s]  4%|▍         | 16/358 [00:01<00:35,  9.71it/s]  5%|▍         | 17/358 [00:01<00:35,  9.73it/s]  5%|▌         | 19/358 [00:01<00:34,  9.75it/s]  6%|▌         | 20/358 [00:02<00:34,  9.70it/s]  6%|▌         | 21/358 [00:02<00:35,  9.63it/s]  6%|▌         | 22/358 [00:02<00:34,  9.68it/s]  7%|▋         | 24/358 [00:02<00:34,  9.77it/s]  7%|▋         | 25/358 [00:02<00:34,  9.73it/s]  7%|▋         | 26/358 [00:02<00:34,  9.68it/s]  8%|▊         | 27/358 [00:02<00:34,  9.73it/s]  8%|▊         | 28/358 [00:02<00:34,  9.69it/s]  8%|▊         | 29/358 [00:02<00:34,  9.65it/s]  9%|▊         | 31/358 [00:03<00:33,  9.75it/s]  9%|▉         | 32/358 [00:03<00:33,  9.75it/s]  9%|▉         | 34/358 [00:03<00:32,  9.85it/s] 10%|█         | 36/358 [00:03<00:32,  9.85it/s] 10%|█         | 37/358 [00:03<00:32,  9.83it/s] 11%|█         | 38/358 [00:03<00:32,  9.79it/s] 11%|█         | 40/358 [00:04<00:31,  9.95it/s] 11%|█▏        | 41/358 [00:04<00:32,  9.86it/s] 12%|█▏        | 43/358 [00:04<00:31,  9.89it/s] 13%|█▎        | 45/358 [00:04<00:31,  9.99it/s] 13%|█▎        | 47/358 [00:04<00:31,  9.96it/s] 13%|█▎        | 48/358 [00:04<00:31,  9.94it/s] 14%|█▍        | 50/358 [00:05<00:31,  9.92it/s] 14%|█▍        | 51/358 [00:05<00:31,  9.85it/s] 15%|█▍        | 52/358 [00:05<00:31,  9.76it/s] 15%|█▍        | 53/358 [00:05<00:31,  9.71it/s] 15%|█▌        | 54/358 [00:05<00:31,  9.75it/s] 15%|█▌        | 55/358 [00:05<00:31,  9.70it/s] 16%|█▌        | 56/358 [00:05<00:31,  9.74it/s] 16%|█▌        | 57/358 [00:05<00:31,  9.70it/s] 16%|█▌        | 58/358 [00:05<00:31,  9.67it/s] 16%|█▋        | 59/358 [00:06<00:31,  9.64it/s] 17%|█▋        | 61/358 [00:06<00:30,  9.72it/s] 17%|█▋        | 62/358 [00:06<00:30,  9.65it/s] 18%|█▊        | 63/358 [00:06<00:30,  9.71it/s] 18%|█▊        | 64/358 [00:06<00:30,  9.67it/s] 18%|█▊        | 66/358 [00:06<00:29,  9.74it/s] 19%|█▊        | 67/358 [00:06<00:29,  9.72it/s] 19%|█▉        | 69/358 [00:07<00:29,  9.78it/s] 20%|█▉        | 70/358 [00:07<00:29,  9.73it/s] 20%|█▉        | 71/358 [00:07<00:29,  9.77it/s] 20%|██        | 72/358 [00:07<00:29,  9.72it/s] 20%|██        | 73/358 [00:07<00:29,  9.69it/s] 21%|██        | 74/358 [00:07<00:29,  9.66it/s] 21%|██        | 75/358 [00:07<00:29,  9.63it/s] 21%|██        | 76/358 [00:07<00:28,  9.73it/s] 22%|██▏       | 77/358 [00:07<00:28,  9.69it/s] 22%|██▏       | 79/358 [00:08<00:28,  9.70it/s] 23%|██▎       | 81/358 [00:08<00:28,  9.76it/s] 23%|██▎       | 83/358 [00:08<00:28,  9.79it/s] 23%|██▎       | 84/358 [00:08<00:28,  9.74it/s] 24%|██▎       | 85/358 [00:08<00:28,  9.69it/s] 24%|██▍       | 86/358 [00:08<00:28,  9.67it/s] 24%|██▍       | 87/358 [00:08<00:28,  9.66it/s] 25%|██▍       | 88/358 [00:09<00:27,  9.68it/s] 25%|██▌       | 90/358 [00:09<00:27,  9.92it/s] 26%|██▌       | 92/358 [00:09<00:26, 10.01it/s] 26%|██▌       | 93/358 [00:09<00:26,  9.97it/s] 26%|██▋       | 94/358 [00:09<00:26,  9.89it/s] 27%|██▋       | 96/358 [00:09<00:25, 10.17it/s] 27%|██▋       | 98/358 [00:10<00:25, 10.06it/s] 28%|██▊       | 100/358 [00:10<00:25, 10.01it/s] 28%|██▊       | 101/358 [00:10<00:25,  9.92it/s] 29%|██▉       | 103/358 [00:10<00:25,  9.91it/s] 29%|██▉       | 104/358 [00:10<00:25,  9.87it/s] 29%|██▉       | 105/358 [00:10<00:25,  9.73it/s] 30%|██▉       | 106/358 [00:10<00:25,  9.72it/s] 30%|███       | 108/358 [00:11<00:25,  9.77it/s] 30%|███       | 109/358 [00:11<00:25,  9.69it/s] 31%|███       | 110/358 [00:11<00:25,  9.67it/s] 31%|███       | 111/358 [00:11<00:25,  9.63it/s] 32%|███▏      | 113/358 [00:11<00:24,  9.90it/s] 32%|███▏      | 114/358 [00:11<00:24,  9.86it/s] 32%|███▏      | 115/358 [00:11<00:24,  9.77it/s] 32%|███▏      | 116/358 [00:11<00:24,  9.69it/s] 33%|███▎      | 117/358 [00:11<00:24,  9.66it/s] 33%|███▎      | 119/358 [00:12<00:24,  9.78it/s] 34%|███▍      | 121/358 [00:12<00:23,  9.98it/s] 34%|███▍      | 123/358 [00:12<00:23, 10.08it/s] 35%|███▍      | 125/358 [00:12<00:23, 10.06it/s] 35%|███▌      | 127/358 [00:12<00:23,  9.99it/s] 36%|███▌      | 128/358 [00:13<00:23,  9.95it/s] 36%|███▋      | 130/358 [00:13<00:22, 10.00it/s] 37%|███▋      | 131/358 [00:13<00:22,  9.90it/s] 37%|███▋      | 132/358 [00:13<00:22,  9.92it/s] 37%|███▋      | 134/358 [00:13<00:22,  9.94it/s] 38%|███▊      | 135/358 [00:13<00:22,  9.88it/s] 38%|███▊      | 137/358 [00:13<00:22,  9.97it/s] 39%|███▊      | 138/358 [00:14<00:22,  9.90it/s] 39%|███▉      | 139/358 [00:14<00:22,  9.82it/s] 39%|███▉      | 141/358 [00:14<00:21,  9.96it/s] 40%|███▉      | 142/358 [00:14<00:21,  9.89it/s] 40%|███▉      | 143/358 [00:14<00:21,  9.86it/s] 40%|████      | 144/358 [00:14<00:21,  9.78it/s] 41%|████      | 145/358 [00:14<00:21,  9.80it/s] 41%|████      | 146/358 [00:14<00:21,  9.74it/s] 41%|████      | 147/358 [00:14<00:21,  9.68it/s] 41%|████▏     | 148/358 [00:15<00:21,  9.71it/s] 42%|████▏     | 149/358 [00:15<00:21,  9.70it/s] 42%|████▏     | 150/358 [00:15<00:21,  9.66it/s] 42%|████▏     | 151/358 [00:15<00:22,  9.39it/s] 42%|████▏     | 152/358 [00:15<00:21,  9.44it/s] 43%|████▎     | 153/358 [00:15<00:21,  9.46it/s] 43%|████▎     | 154/358 [00:15<00:21,  9.55it/s] 43%|████▎     | 155/358 [00:15<00:21,  9.56it/s] 44%|████▎     | 156/358 [00:15<00:20,  9.64it/s] 44%|████▍     | 157/358 [00:16<00:20,  9.59it/s] 44%|████▍     | 158/358 [00:16<00:20,  9.69it/s] 44%|████▍     | 159/358 [00:16<00:20,  9.69it/s] 45%|████▍     | 160/358 [00:16<00:20,  9.70it/s] 45%|████▌     | 162/358 [00:16<00:19, 10.00it/s] 46%|████▌     | 164/358 [00:16<00:19, 10.00it/s] 46%|████▌     | 165/358 [00:16<00:19,  9.96it/s] 47%|████▋     | 167/358 [00:17<00:19,  9.91it/s] 47%|████▋     | 169/358 [00:17<00:19,  9.95it/s] 48%|████▊     | 171/358 [00:17<00:18,  9.93it/s] 48%|████▊     | 172/358 [00:17<00:18,  9.88it/s] 48%|████▊     | 173/358 [00:17<00:18,  9.81it/s] 49%|████▉     | 175/358 [00:17<00:18,  9.84it/s] 49%|████▉     | 176/358 [00:17<00:18,  9.84it/s] 49%|████▉     | 177/358 [00:18<00:18,  9.83it/s] 50%|█████     | 179/358 [00:18<00:18,  9.86it/s] 50%|█████     | 180/358 [00:18<00:18,  9.79it/s] 51%|█████     | 182/358 [00:18<00:17,  9.94it/s] 51%|█████     | 183/358 [00:18<00:17,  9.89it/s] 51%|█████▏    | 184/358 [00:18<00:17,  9.79it/s] 52%|█████▏    | 185/358 [00:18<00:17,  9.73it/s] 52%|█████▏    | 187/358 [00:19<00:17,  9.95it/s] 53%|█████▎    | 188/358 [00:19<00:17,  9.89it/s] 53%|█████▎    | 189/358 [00:19<00:17,  9.83it/s] 53%|█████▎    | 191/358 [00:19<00:17,  9.75it/s] 54%|█████▎    | 192/358 [00:19<00:17,  9.70it/s] 54%|█████▍    | 193/358 [00:19<00:17,  9.69it/s] 54%|█████▍    | 194/358 [00:19<00:16,  9.68it/s] 54%|█████▍    | 195/358 [00:19<00:16,  9.74it/s] 55%|█████▌    | 197/358 [00:20<00:16,  9.92it/s] 55%|█████▌    | 198/358 [00:20<00:16,  9.84it/s] 56%|█████▌    | 199/358 [00:20<00:16,  9.88it/s] 56%|█████▌    | 200/358 [00:20<00:16,  9.81it/s] 56%|█████▌    | 201/358 [00:20<00:16,  9.77it/s] 57%|█████▋    | 203/358 [00:20<00:15,  9.86it/s] 57%|█████▋    | 204/358 [00:20<00:15,  9.75it/s] 57%|█████▋    | 205/358 [00:20<00:15,  9.71it/s] 58%|█████▊    | 207/358 [00:21<00:15,  9.87it/s] 58%|█████▊    | 208/358 [00:21<00:15,  9.80it/s] 59%|█████▊    | 210/358 [00:21<00:15,  9.82it/s] 59%|█████▉    | 212/358 [00:21<00:14,  9.81it/s] 60%|█████▉    | 214/358 [00:21<00:14,  9.89it/s] 60%|██████    | 215/358 [00:21<00:14,  9.83it/s] 60%|██████    | 216/358 [00:22<00:14,  9.77it/s] 61%|██████    | 217/358 [00:22<00:14,  9.80it/s] 61%|██████    | 218/358 [00:22<00:14,  9.77it/s] 61%|██████    | 219/358 [00:22<00:14,  9.78it/s] 62%|██████▏   | 221/358 [00:22<00:13,  9.91it/s] 62%|██████▏   | 222/358 [00:22<00:13,  9.80it/s] 62%|██████▏   | 223/358 [00:22<00:13,  9.74it/s] 63%|██████▎   | 224/358 [00:22<00:13,  9.69it/s] 63%|██████▎   | 225/358 [00:22<00:13,  9.77it/s] 63%|██████▎   | 226/358 [00:23<00:13,  9.72it/s] 64%|██████▎   | 228/358 [00:23<00:13,  9.76it/s] 64%|██████▍   | 229/358 [00:23<00:13,  9.73it/s] 64%|██████▍   | 230/358 [00:23<00:13,  9.68it/s] 65%|██████▍   | 232/358 [00:23<00:12,  9.73it/s] 65%|██████▌   | 234/358 [00:23<00:12, 10.03it/s] 66%|██████▌   | 236/358 [00:24<00:12,  9.99it/s] 66%|██████▋   | 238/358 [00:24<00:11, 10.04it/s] 67%|██████▋   | 240/358 [00:24<00:11, 10.00it/s] 68%|██████▊   | 242/358 [00:24<00:11,  9.98it/s] 68%|██████▊   | 243/358 [00:24<00:11,  9.91it/s] 68%|██████▊   | 244/358 [00:24<00:11,  9.85it/s] 69%|██████▊   | 246/358 [00:25<00:11,  9.87it/s] 69%|██████▉   | 247/358 [00:25<00:11,  9.80it/s] 69%|██████▉   | 248/358 [00:25<00:11,  9.76it/s] 70%|██████▉   | 250/358 [00:25<00:10,  9.85it/s] 70%|███████   | 251/358 [00:25<00:10,  9.79it/s] 70%|███████   | 252/358 [00:25<00:10,  9.72it/s] 71%|███████   | 253/358 [00:25<00:10,  9.68it/s] 71%|███████   | 254/358 [00:25<00:10,  9.66it/s] 72%|███████▏  | 256/358 [00:26<00:10,  9.83it/s] 72%|███████▏  | 257/358 [00:26<00:10,  9.84it/s] 72%|███████▏  | 258/358 [00:26<00:10,  9.71it/s] 72%|███████▏  | 259/358 [00:26<00:10,  9.68it/s] 73%|███████▎  | 260/358 [00:26<00:10,  9.71it/s] 73%|███████▎  | 262/358 [00:26<00:09,  9.89it/s] 74%|███████▎  | 264/358 [00:26<00:09,  9.92it/s] 74%|███████▍  | 266/358 [00:27<00:09,  9.91it/s] 75%|███████▍  | 267/358 [00:27<00:09,  9.85it/s] 75%|███████▌  | 269/358 [00:27<00:08,  9.90it/s] 75%|███████▌  | 270/358 [00:27<00:08,  9.83it/s] 76%|███████▌  | 271/358 [00:27<00:08,  9.75it/s] 76%|███████▌  | 272/358 [00:27<00:08,  9.73it/s] 76%|███████▋  | 273/358 [00:27<00:08,  9.63it/s] 77%|███████▋  | 274/358 [00:27<00:08,  9.63it/s] 77%|███████▋  | 275/358 [00:28<00:08,  9.68it/s] 77%|███████▋  | 276/358 [00:28<00:08,  9.68it/s] 77%|███████▋  | 277/358 [00:28<00:08,  9.66it/s] 78%|███████▊  | 278/358 [00:28<00:08,  9.64it/s] 78%|███████▊  | 280/358 [00:28<00:07,  9.83it/s] 78%|███████▊  | 281/358 [00:28<00:07,  9.84it/s] 79%|███████▉  | 282/358 [00:28<00:07,  9.77it/s] 79%|███████▉  | 283/358 [00:28<00:07,  9.71it/s] 79%|███████▉  | 284/358 [00:28<00:07,  9.67it/s] 80%|███████▉  | 285/358 [00:29<00:07,  9.74it/s] 80%|███████▉  | 286/358 [00:29<00:07,  9.70it/s] 80%|████████  | 287/358 [00:29<00:07,  9.68it/s] 80%|████████  | 288/358 [00:29<00:07,  9.64it/s] 81%|████████  | 290/358 [00:29<00:06,  9.85it/s] 81%|████████▏ | 291/358 [00:29<00:06,  9.83it/s] 82%|████████▏ | 293/358 [00:29<00:06,  9.84it/s] 82%|████████▏ | 295/358 [00:30<00:06,  9.91it/s] 83%|████████▎ | 296/358 [00:30<00:06,  9.85it/s] 83%|████████▎ | 297/358 [00:30<00:06,  9.74it/s] 84%|████████▎ | 299/358 [00:30<00:05,  9.90it/s] 84%|████████▍ | 301/358 [00:30<00:05,  9.94it/s] 84%|████████▍ | 302/358 [00:30<00:05,  9.87it/s] 85%|████████▍ | 303/358 [00:30<00:05,  9.88it/s] 85%|████████▌ | 305/358 [00:31<00:05,  9.91it/s] 85%|████████▌ | 306/358 [00:31<00:05,  9.83it/s] 86%|████████▌ | 308/358 [00:31<00:05,  9.93it/s] 86%|████████▋ | 309/358 [00:31<00:04,  9.83it/s] 87%|████████▋ | 310/358 [00:31<00:04,  9.77it/s] 87%|████████▋ | 311/358 [00:31<00:04,  9.69it/s] 87%|████████▋ | 312/358 [00:31<00:04,  9.70it/s] 87%|████████▋ | 313/358 [00:31<00:04,  9.73it/s] 88%|████████▊ | 315/358 [00:32<00:04,  9.99it/s] 88%|████████▊ | 316/358 [00:32<00:04,  9.94it/s] 89%|████████▊ | 317/358 [00:32<00:04,  9.86it/s] 89%|████████▉ | 318/358 [00:32<00:04,  9.81it/s] 89%|████████▉ | 319/358 [00:32<00:03,  9.76it/s] 89%|████████▉ | 320/358 [00:32<00:03,  9.82it/s] 90%|████████▉ | 321/358 [00:32<00:03,  9.75it/s] 90%|████████▉ | 322/358 [00:32<00:03,  9.71it/s] 90%|█████████ | 323/358 [00:32<00:03,  9.66it/s] 91%|█████████ | 324/358 [00:33<00:03,  9.63it/s] 91%|█████████ | 325/358 [00:33<00:03,  9.61it/s] 91%|█████████▏| 327/358 [00:33<00:03,  9.97it/s] 92%|█████████▏| 329/358 [00:33<00:02, 10.07it/s] 92%|█████████▏| 330/358 [00:33<00:02,  9.96it/s] 93%|█████████▎| 332/358 [00:33<00:02, 10.06it/s] 93%|█████████▎| 334/358 [00:34<00:02,  9.96it/s] 94%|█████████▎| 335/358 [00:34<00:02,  9.84it/s] 94%|█████████▍| 337/358 [00:34<00:02,  9.92it/s] 95%|█████████▍| 339/358 [00:34<00:01, 10.12it/s] 95%|█████████▌| 341/358 [00:34<00:01, 10.06it/s] 96%|█████████▌| 343/358 [00:34<00:01,  9.90it/s] 96%|█████████▌| 344/358 [00:35<00:01,  9.85it/s] 96%|█████████▋| 345/358 [00:35<00:01,  9.86it/s] 97%|█████████▋| 347/358 [00:35<00:01, 10.04it/s] 97%|█████████▋| 348/358 [00:35<00:01,  9.94it/s] 97%|█████████▋| 349/358 [00:35<00:00,  9.86it/s] 98%|█████████▊| 350/358 [00:35<00:00,  9.78it/s] 98%|█████████▊| 351/358 [00:35<00:00,  9.74it/s] 99%|█████████▊| 353/358 [00:35<00:00,  9.92it/s] 99%|█████████▉| 354/358 [00:36<00:00,  9.90it/s] 99%|█████████▉| 355/358 [00:36<00:00,  9.82it/s]100%|█████████▉| 357/358 [00:36<00:00,  9.87it/s]100%|██████████| 358/358 [00:36<00:00,  9.83it/s]
[32m2025-02-05 06:13:53.339[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    gen_loss  grad clip ratio  grad norm   ppl
       1.855                1      2.527 6.395[0m
[32m2025-02-05 06:13:53.339[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m169[0m - [1m[Valid][0m
  0%|          | 0/10256 [00:00<?, ?it/s]100%|██████████| 10256/10256 [00:00<00:00, 957780.19it/s]
[32m2025-02-05 06:13:53.350[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:27,  1.43it/s]  5%|▌         | 2/40 [00:01<00:26,  1.45it/s]  8%|▊         | 3/40 [00:02<00:25,  1.45it/s] 10%|█         | 4/40 [00:02<00:24,  1.46it/s] 12%|█▎        | 5/40 [00:03<00:24,  1.45it/s] 15%|█▌        | 6/40 [00:04<00:23,  1.45it/s] 18%|█▊        | 7/40 [00:04<00:22,  1.46it/s] 20%|██        | 8/40 [00:05<00:21,  1.46it/s] 22%|██▎       | 9/40 [00:06<00:21,  1.46it/s] 25%|██▌       | 10/40 [00:06<00:20,  1.46it/s] 28%|██▊       | 11/40 [00:07<00:19,  1.46it/s] 30%|███       | 12/40 [00:08<00:19,  1.46it/s] 32%|███▎      | 13/40 [00:08<00:18,  1.46it/s] 35%|███▌      | 14/40 [00:09<00:17,  1.45it/s] 38%|███▊      | 15/40 [00:10<00:17,  1.46it/s] 40%|████      | 16/40 [00:10<00:16,  1.45it/s] 42%|████▎     | 17/40 [00:11<00:15,  1.46it/s] 45%|████▌     | 18/40 [00:12<00:15,  1.46it/s] 48%|████▊     | 19/40 [00:13<00:14,  1.46it/s] 50%|█████     | 20/40 [00:13<00:13,  1.46it/s] 52%|█████▎    | 21/40 [00:14<00:12,  1.47it/s] 55%|█████▌    | 22/40 [00:15<00:12,  1.46it/s] 57%|█████▊    | 23/40 [00:15<00:11,  1.47it/s] 60%|██████    | 24/40 [00:16<00:10,  1.46it/s] 62%|██████▎   | 25/40 [00:17<00:10,  1.46it/s] 65%|██████▌   | 26/40 [00:17<00:09,  1.46it/s] 68%|██████▊   | 27/40 [00:18<00:08,  1.47it/s] 70%|███████   | 28/40 [00:19<00:08,  1.46it/s] 72%|███████▎  | 29/40 [00:19<00:07,  1.46it/s] 75%|███████▌  | 30/40 [00:20<00:06,  1.47it/s] 78%|███████▊  | 31/40 [00:21<00:06,  1.46it/s] 80%|████████  | 32/40 [00:21<00:05,  1.46it/s] 82%|████████▎ | 33/40 [00:22<00:04,  1.46it/s] 85%|████████▌ | 34/40 [00:23<00:04,  1.46it/s] 88%|████████▊ | 35/40 [00:23<00:03,  1.46it/s] 90%|█████████ | 36/40 [00:24<00:02,  1.46it/s] 92%|█████████▎| 37/40 [00:25<00:02,  1.46it/s] 95%|█████████▌| 38/40 [00:26<00:01,  1.45it/s] 98%|█████████▊| 39/40 [00:26<00:00,  1.45it/s]100%|██████████| 40/40 [00:27<00:00,  1.60it/s]100%|██████████| 40/40 [00:27<00:00,  1.47it/s]
[32m2025-02-05 06:14:20.548[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    average  bleu@1  bleu@2  bleu@3  bleu@4  dist@1  dist@2  dist@3  dist@4  extreme  \
      .7730   .2923   .1040  .03685  .01709  .04497   .2972   .5550   .7097    .5952   
      f1  gen_loss  greedy  intra_dist@1  intra_dist@2  intra_dist@3  intra_dist@4  \
   .3466     5.163   .6669         .8655         .9594         .9429         .9007   
     ppl  rouge1  rouge2  rougeL  
   174.8   .3810  .08471   .3692[0m
[32m2025-02-05 06:14:20.554[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m163[0m - [1m[Conversation epoch 62][0m
[32m2025-02-05 06:14:20.554[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m164[0m - [1m[Train][0m
  0%|          | 0/92414 [00:00<?, ?it/s]100%|██████████| 92414/92414 [00:00<00:00, 1133694.48it/s]
[32m2025-02-05 06:14:20.636[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/358 [00:00<?, ?it/s]  0%|          | 1/358 [00:00<00:36,  9.78it/s]  1%|          | 3/358 [00:00<00:35,  9.94it/s]  1%|          | 4/358 [00:00<00:35,  9.92it/s]  2%|▏         | 6/358 [00:00<00:35,  9.89it/s]  2%|▏         | 7/358 [00:00<00:35,  9.82it/s]  2%|▏         | 8/358 [00:00<00:35,  9.86it/s]  3%|▎         | 9/358 [00:00<00:35,  9.76it/s]  3%|▎         | 10/358 [00:01<00:35,  9.76it/s]  3%|▎         | 11/358 [00:01<00:35,  9.70it/s]  4%|▎         | 13/358 [00:01<00:34,  9.92it/s]  4%|▍         | 14/358 [00:01<00:34,  9.85it/s]  4%|▍         | 15/358 [00:01<00:35,  9.78it/s]  4%|▍         | 16/358 [00:01<00:35,  9.71it/s]  5%|▍         | 17/358 [00:01<00:35,  9.72it/s]  5%|▌         | 18/358 [00:01<00:34,  9.80it/s]  5%|▌         | 19/358 [00:01<00:34,  9.73it/s]  6%|▌         | 20/358 [00:02<00:34,  9.68it/s]  6%|▌         | 21/358 [00:02<00:35,  9.61it/s]  6%|▌         | 22/358 [00:02<00:34,  9.68it/s]  7%|▋         | 24/358 [00:02<00:34,  9.78it/s]  7%|▋         | 25/358 [00:02<00:34,  9.73it/s]  7%|▋         | 26/358 [00:02<00:34,  9.68it/s]  8%|▊         | 27/358 [00:02<00:34,  9.73it/s]  8%|▊         | 28/358 [00:02<00:34,  9.69it/s]  8%|▊         | 29/358 [00:02<00:34,  9.65it/s]  9%|▊         | 31/358 [00:03<00:33,  9.75it/s]  9%|▉         | 32/358 [00:03<00:33,  9.75it/s]  9%|▉         | 34/358 [00:03<00:32,  9.85it/s] 10%|█         | 36/358 [00:03<00:32,  9.85it/s] 10%|█         | 37/358 [00:03<00:32,  9.83it/s] 11%|█         | 38/358 [00:03<00:32,  9.79it/s] 11%|█         | 40/358 [00:04<00:32,  9.91it/s] 11%|█▏        | 41/358 [00:04<00:32,  9.82it/s] 12%|█▏        | 43/358 [00:04<00:31,  9.86it/s] 13%|█▎        | 45/358 [00:04<00:31,  9.96it/s] 13%|█▎        | 47/358 [00:04<00:31,  9.94it/s] 13%|█▎        | 48/358 [00:04<00:31,  9.93it/s] 14%|█▍        | 50/358 [00:05<00:31,  9.90it/s] 14%|█▍        | 51/358 [00:05<00:31,  9.84it/s] 15%|█▍        | 52/358 [00:05<00:31,  9.75it/s] 15%|█▍        | 53/358 [00:05<00:31,  9.70it/s] 15%|█▌        | 54/358 [00:05<00:31,  9.74it/s] 15%|█▌        | 55/358 [00:05<00:31,  9.69it/s] 16%|█▌        | 56/358 [00:05<00:31,  9.73it/s] 16%|█▌        | 57/358 [00:05<00:31,  9.69it/s] 16%|█▌        | 58/358 [00:05<00:31,  9.67it/s] 16%|█▋        | 59/358 [00:06<00:31,  9.64it/s] 17%|█▋        | 61/358 [00:06<00:30,  9.72it/s] 17%|█▋        | 62/358 [00:06<00:30,  9.64it/s] 18%|█▊        | 63/358 [00:06<00:30,  9.71it/s] 18%|█▊        | 64/358 [00:06<00:30,  9.66it/s] 18%|█▊        | 66/358 [00:06<00:30,  9.73it/s] 19%|█▊        | 67/358 [00:06<00:29,  9.71it/s] 19%|█▉        | 69/358 [00:07<00:29,  9.77it/s] 20%|█▉        | 70/358 [00:07<00:29,  9.72it/s] 20%|█▉        | 71/358 [00:07<00:29,  9.77it/s] 20%|██        | 72/358 [00:07<00:29,  9.72it/s] 20%|██        | 73/358 [00:07<00:29,  9.68it/s] 21%|██        | 74/358 [00:07<00:29,  9.65it/s] 21%|██        | 75/358 [00:07<00:29,  9.62it/s] 21%|██        | 76/358 [00:07<00:29,  9.72it/s] 22%|██▏       | 77/358 [00:07<00:29,  9.69it/s] 22%|██▏       | 79/358 [00:08<00:28,  9.69it/s] 23%|██▎       | 81/358 [00:08<00:28,  9.75it/s] 23%|██▎       | 83/358 [00:08<00:28,  9.78it/s] 23%|██▎       | 84/358 [00:08<00:28,  9.73it/s] 24%|██▎       | 85/358 [00:08<00:28,  9.68it/s] 24%|██▍       | 86/358 [00:08<00:28,  9.67it/s] 24%|██▍       | 87/358 [00:08<00:28,  9.65it/s] 25%|██▍       | 88/358 [00:09<00:27,  9.67it/s] 25%|██▌       | 90/358 [00:09<00:27,  9.91it/s] 26%|██▌       | 92/358 [00:09<00:26, 10.01it/s] 26%|██▌       | 93/358 [00:09<00:26,  9.97it/s] 26%|██▋       | 94/358 [00:09<00:26,  9.87it/s] 27%|██▋       | 96/358 [00:09<00:25, 10.14it/s] 27%|██▋       | 98/358 [00:10<00:25, 10.04it/s] 28%|██▊       | 99/358 [00:10<00:26,  9.95it/s] 28%|██▊       | 101/358 [00:10<00:25,  9.92it/s] 29%|██▉       | 103/358 [00:10<00:25,  9.91it/s] 29%|██▉       | 104/358 [00:10<00:25,  9.86it/s] 29%|██▉       | 105/358 [00:10<00:25,  9.79it/s] 30%|██▉       | 106/358 [00:10<00:25,  9.77it/s] 30%|███       | 108/358 [00:11<00:25,  9.80it/s] 30%|███       | 109/358 [00:11<00:25,  9.72it/s] 31%|███       | 110/358 [00:11<00:25,  9.70it/s] 31%|███       | 111/358 [00:11<00:25,  9.65it/s] 32%|███▏      | 113/358 [00:11<00:24,  9.91it/s] 32%|███▏      | 114/358 [00:11<00:24,  9.87it/s] 32%|███▏      | 115/358 [00:11<00:24,  9.78it/s] 32%|███▏      | 116/358 [00:11<00:24,  9.69it/s] 33%|███▎      | 117/358 [00:11<00:24,  9.66it/s] 33%|███▎      | 119/358 [00:12<00:24,  9.78it/s] 34%|███▍      | 121/358 [00:12<00:23,  9.98it/s] 34%|███▍      | 123/358 [00:12<00:23, 10.08it/s] 35%|███▍      | 125/358 [00:12<00:23, 10.06it/s] 35%|███▌      | 127/358 [00:12<00:23,  9.99it/s] 36%|███▌      | 128/358 [00:13<00:23,  9.95it/s] 36%|███▋      | 130/358 [00:13<00:22,  9.99it/s] 37%|███▋      | 131/358 [00:13<00:22,  9.90it/s] 37%|███▋      | 132/358 [00:13<00:22,  9.92it/s] 37%|███▋      | 134/358 [00:13<00:22,  9.94it/s] 38%|███▊      | 135/358 [00:13<00:22,  9.88it/s] 38%|███▊      | 137/358 [00:13<00:22,  9.97it/s] 39%|███▊      | 138/358 [00:14<00:22,  9.95it/s] 39%|███▉      | 139/358 [00:14<00:22,  9.86it/s] 39%|███▉      | 141/358 [00:14<00:21,  9.99it/s] 40%|███▉      | 142/358 [00:14<00:21,  9.91it/s] 40%|███▉      | 143/358 [00:14<00:21,  9.87it/s] 40%|████      | 144/358 [00:14<00:21,  9.79it/s] 41%|████      | 145/358 [00:14<00:21,  9.81it/s] 41%|████      | 146/358 [00:14<00:21,  9.74it/s] 41%|████      | 147/358 [00:14<00:21,  9.68it/s] 41%|████▏     | 148/358 [00:15<00:21,  9.71it/s] 42%|████▏     | 149/358 [00:15<00:21,  9.69it/s] 42%|████▏     | 150/358 [00:15<00:21,  9.66it/s] 42%|████▏     | 151/358 [00:15<00:22,  9.39it/s] 42%|████▏     | 152/358 [00:15<00:21,  9.44it/s] 43%|████▎     | 153/358 [00:15<00:21,  9.46it/s] 43%|████▎     | 154/358 [00:15<00:21,  9.55it/s] 43%|████▎     | 155/358 [00:15<00:21,  9.56it/s] 44%|████▎     | 156/358 [00:15<00:20,  9.68it/s] 44%|████▍     | 157/358 [00:16<00:20,  9.62it/s] 44%|████▍     | 158/358 [00:16<00:20,  9.71it/s] 44%|████▍     | 159/358 [00:16<00:20,  9.70it/s] 45%|████▍     | 160/358 [00:16<00:20,  9.71it/s] 45%|████▌     | 162/358 [00:16<00:19, 10.00it/s] 46%|████▌     | 164/358 [00:16<00:19, 10.00it/s] 46%|████▌     | 165/358 [00:16<00:19,  9.96it/s] 47%|████▋     | 167/358 [00:17<00:19,  9.91it/s] 47%|████▋     | 169/358 [00:17<00:19,  9.95it/s] 48%|████▊     | 171/358 [00:17<00:18,  9.93it/s] 48%|████▊     | 172/358 [00:17<00:18,  9.88it/s] 48%|████▊     | 173/358 [00:17<00:18,  9.81it/s] 49%|████▉     | 175/358 [00:17<00:18,  9.84it/s] 49%|████▉     | 176/358 [00:17<00:18,  9.85it/s] 49%|████▉     | 177/358 [00:18<00:18,  9.84it/s] 50%|█████     | 179/358 [00:18<00:18,  9.86it/s] 50%|█████     | 180/358 [00:18<00:18,  9.79it/s] 51%|█████     | 182/358 [00:18<00:17,  9.94it/s] 51%|█████     | 183/358 [00:18<00:17,  9.90it/s] 51%|█████▏    | 184/358 [00:18<00:17,  9.78it/s] 52%|█████▏    | 185/358 [00:18<00:17,  9.73it/s] 52%|█████▏    | 187/358 [00:19<00:17,  9.94it/s] 53%|█████▎    | 188/358 [00:19<00:17,  9.89it/s] 53%|█████▎    | 189/358 [00:19<00:17,  9.83it/s] 53%|█████▎    | 191/358 [00:19<00:17,  9.75it/s] 54%|█████▎    | 192/358 [00:19<00:17,  9.70it/s] 54%|█████▍    | 193/358 [00:19<00:17,  9.70it/s] 54%|█████▍    | 194/358 [00:19<00:16,  9.67it/s] 54%|█████▍    | 195/358 [00:19<00:16,  9.74it/s] 55%|█████▌    | 197/358 [00:20<00:16,  9.91it/s] 55%|█████▌    | 198/358 [00:20<00:16,  9.84it/s] 56%|█████▌    | 199/358 [00:20<00:16,  9.87it/s] 56%|█████▌    | 200/358 [00:20<00:16,  9.81it/s] 56%|█████▌    | 201/358 [00:20<00:16,  9.77it/s] 57%|█████▋    | 203/358 [00:20<00:15,  9.86it/s] 57%|█████▋    | 204/358 [00:20<00:15,  9.75it/s] 57%|█████▋    | 205/358 [00:20<00:15,  9.71it/s] 58%|█████▊    | 207/358 [00:21<00:15,  9.88it/s] 58%|█████▊    | 208/358 [00:21<00:15,  9.81it/s] 59%|█████▊    | 210/358 [00:21<00:15,  9.82it/s] 59%|█████▉    | 212/358 [00:21<00:14,  9.82it/s] 60%|█████▉    | 214/358 [00:21<00:14,  9.89it/s] 60%|██████    | 215/358 [00:21<00:14,  9.83it/s] 60%|██████    | 216/358 [00:22<00:14,  9.77it/s] 61%|██████    | 217/358 [00:22<00:14,  9.80it/s] 61%|██████    | 218/358 [00:22<00:14,  9.77it/s] 61%|██████    | 219/358 [00:22<00:14,  9.77it/s] 62%|██████▏   | 221/358 [00:22<00:13,  9.91it/s] 62%|██████▏   | 222/358 [00:22<00:13,  9.80it/s] 62%|██████▏   | 223/358 [00:22<00:13,  9.75it/s] 63%|██████▎   | 224/358 [00:22<00:13,  9.69it/s] 63%|██████▎   | 226/358 [00:23<00:13,  9.74it/s] 64%|██████▎   | 228/358 [00:23<00:13,  9.76it/s] 64%|██████▍   | 229/358 [00:23<00:13,  9.74it/s] 64%|██████▍   | 230/358 [00:23<00:13,  9.69it/s] 65%|██████▍   | 232/358 [00:23<00:12,  9.74it/s] 65%|██████▌   | 234/358 [00:23<00:12, 10.02it/s] 66%|██████▌   | 236/358 [00:24<00:12,  9.98it/s] 66%|██████▋   | 238/358 [00:24<00:11, 10.03it/s] 67%|██████▋   | 240/358 [00:24<00:11, 10.00it/s] 68%|██████▊   | 242/358 [00:24<00:11,  9.98it/s] 68%|██████▊   | 243/358 [00:24<00:11,  9.91it/s] 68%|██████▊   | 244/358 [00:24<00:11,  9.85it/s] 69%|██████▊   | 246/358 [00:25<00:11,  9.87it/s] 69%|██████▉   | 247/358 [00:25<00:11,  9.80it/s] 69%|██████▉   | 248/358 [00:25<00:11,  9.76it/s] 70%|██████▉   | 250/358 [00:25<00:10,  9.85it/s] 70%|███████   | 251/358 [00:25<00:10,  9.79it/s] 70%|███████   | 252/358 [00:25<00:10,  9.73it/s] 71%|███████   | 253/358 [00:25<00:10,  9.69it/s] 71%|███████   | 254/358 [00:25<00:10,  9.66it/s] 72%|███████▏  | 256/358 [00:26<00:10,  9.84it/s] 72%|███████▏  | 257/358 [00:26<00:10,  9.84it/s] 72%|███████▏  | 258/358 [00:26<00:10,  9.71it/s] 72%|███████▏  | 259/358 [00:26<00:10,  9.68it/s] 73%|███████▎  | 260/358 [00:26<00:10,  9.72it/s] 73%|███████▎  | 262/358 [00:26<00:09,  9.90it/s] 74%|███████▎  | 264/358 [00:26<00:09,  9.92it/s] 74%|███████▍  | 266/358 [00:27<00:09,  9.91it/s] 75%|███████▍  | 267/358 [00:27<00:09,  9.85it/s] 75%|███████▌  | 269/358 [00:27<00:08,  9.90it/s] 75%|███████▌  | 270/358 [00:27<00:08,  9.83it/s] 76%|███████▌  | 271/358 [00:27<00:08,  9.76it/s] 76%|███████▌  | 272/358 [00:27<00:08,  9.74it/s] 76%|███████▋  | 273/358 [00:27<00:08,  9.64it/s] 77%|███████▋  | 274/358 [00:27<00:08,  9.63it/s] 77%|███████▋  | 275/358 [00:28<00:08,  9.68it/s] 77%|███████▋  | 276/358 [00:28<00:08,  9.68it/s] 77%|███████▋  | 277/358 [00:28<00:08,  9.66it/s] 78%|███████▊  | 278/358 [00:28<00:08,  9.63it/s] 78%|███████▊  | 280/358 [00:28<00:07,  9.82it/s] 78%|███████▊  | 281/358 [00:28<00:07,  9.83it/s] 79%|███████▉  | 282/358 [00:28<00:07,  9.77it/s] 79%|███████▉  | 283/358 [00:28<00:07,  9.71it/s] 79%|███████▉  | 284/358 [00:28<00:07,  9.67it/s] 80%|███████▉  | 285/358 [00:29<00:07,  9.74it/s] 80%|███████▉  | 286/358 [00:29<00:07,  9.69it/s] 80%|████████  | 287/358 [00:29<00:07,  9.67it/s] 80%|████████  | 288/358 [00:29<00:07,  9.63it/s] 81%|████████  | 290/358 [00:29<00:06,  9.85it/s] 81%|████████▏ | 291/358 [00:29<00:06,  9.83it/s] 82%|████████▏ | 293/358 [00:29<00:06,  9.84it/s] 82%|████████▏ | 295/358 [00:30<00:06,  9.91it/s] 83%|████████▎ | 296/358 [00:30<00:06,  9.85it/s] 83%|████████▎ | 297/358 [00:30<00:06,  9.74it/s] 84%|████████▎ | 299/358 [00:30<00:05,  9.90it/s] 84%|████████▍ | 301/358 [00:30<00:05,  9.94it/s] 84%|████████▍ | 302/358 [00:30<00:05,  9.87it/s] 85%|████████▍ | 303/358 [00:30<00:05,  9.88it/s] 85%|████████▌ | 305/358 [00:31<00:05,  9.91it/s] 85%|████████▌ | 306/358 [00:31<00:05,  9.83it/s] 86%|████████▌ | 308/358 [00:31<00:05,  9.93it/s] 86%|████████▋ | 309/358 [00:31<00:04,  9.83it/s] 87%|████████▋ | 310/358 [00:31<00:04,  9.77it/s] 87%|████████▋ | 311/358 [00:31<00:04,  9.69it/s] 87%|████████▋ | 312/358 [00:31<00:04,  9.71it/s] 87%|████████▋ | 313/358 [00:31<00:04,  9.73it/s] 88%|████████▊ | 315/358 [00:32<00:04,  9.99it/s] 88%|████████▊ | 316/358 [00:32<00:04,  9.94it/s] 89%|████████▊ | 317/358 [00:32<00:04,  9.85it/s] 89%|████████▉ | 318/358 [00:32<00:04,  9.81it/s] 89%|████████▉ | 319/358 [00:32<00:03,  9.75it/s] 89%|████████▉ | 320/358 [00:32<00:03,  9.82it/s] 90%|████████▉ | 321/358 [00:32<00:03,  9.74it/s] 90%|████████▉ | 322/358 [00:32<00:03,  9.71it/s] 90%|█████████ | 323/358 [00:32<00:03,  9.66it/s] 91%|█████████ | 324/358 [00:33<00:03,  9.63it/s] 91%|█████████ | 325/358 [00:33<00:03,  9.61it/s] 91%|█████████▏| 327/358 [00:33<00:03,  9.97it/s] 92%|█████████▏| 329/358 [00:33<00:02, 10.07it/s] 92%|█████████▏| 330/358 [00:33<00:02,  9.96it/s] 93%|█████████▎| 332/358 [00:33<00:02, 10.06it/s] 93%|█████████▎| 334/358 [00:34<00:02,  9.96it/s] 94%|█████████▎| 335/358 [00:34<00:02,  9.84it/s] 94%|█████████▍| 337/358 [00:34<00:02,  9.92it/s] 95%|█████████▍| 339/358 [00:34<00:01, 10.12it/s] 95%|█████████▌| 341/358 [00:34<00:01, 10.07it/s] 96%|█████████▌| 343/358 [00:34<00:01,  9.90it/s] 96%|█████████▌| 344/358 [00:35<00:01,  9.84it/s] 96%|█████████▋| 345/358 [00:35<00:01,  9.86it/s] 97%|█████████▋| 347/358 [00:35<00:01, 10.03it/s] 97%|█████████▋| 348/358 [00:35<00:01,  9.94it/s] 97%|█████████▋| 349/358 [00:35<00:00,  9.86it/s] 98%|█████████▊| 350/358 [00:35<00:00,  9.79it/s] 98%|█████████▊| 351/358 [00:35<00:00,  9.74it/s] 99%|█████████▊| 353/358 [00:35<00:00,  9.92it/s] 99%|█████████▉| 354/358 [00:36<00:00,  9.90it/s] 99%|█████████▉| 355/358 [00:36<00:00,  9.81it/s]100%|█████████▉| 357/358 [00:36<00:00,  9.87it/s]100%|██████████| 358/358 [00:36<00:00,  9.83it/s]
[32m2025-02-05 06:14:57.073[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    gen_loss  grad clip ratio  grad norm   ppl
       1.847                1       5.53 6.342[0m
[32m2025-02-05 06:14:57.073[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m169[0m - [1m[Valid][0m
  0%|          | 0/10256 [00:00<?, ?it/s]100%|██████████| 10256/10256 [00:00<00:00, 1042679.41it/s]
[32m2025-02-05 06:14:57.083[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:27,  1.41it/s]  5%|▌         | 2/40 [00:01<00:26,  1.44it/s]  8%|▊         | 3/40 [00:02<00:25,  1.44it/s] 10%|█         | 4/40 [00:02<00:24,  1.45it/s] 12%|█▎        | 5/40 [00:03<00:24,  1.44it/s] 15%|█▌        | 6/40 [00:04<00:23,  1.44it/s] 18%|█▊        | 7/40 [00:04<00:22,  1.44it/s] 20%|██        | 8/40 [00:05<00:22,  1.45it/s] 22%|██▎       | 9/40 [00:06<00:21,  1.45it/s] 25%|██▌       | 10/40 [00:06<00:20,  1.45it/s] 28%|██▊       | 11/40 [00:07<00:19,  1.45it/s] 30%|███       | 12/40 [00:08<00:19,  1.45it/s] 32%|███▎      | 13/40 [00:08<00:18,  1.45it/s] 35%|███▌      | 14/40 [00:09<00:18,  1.44it/s] 38%|███▊      | 15/40 [00:10<00:17,  1.44it/s] 40%|████      | 16/40 [00:11<00:16,  1.44it/s] 42%|████▎     | 17/40 [00:11<00:15,  1.45it/s] 45%|████▌     | 18/40 [00:12<00:15,  1.45it/s] 48%|████▊     | 19/40 [00:13<00:14,  1.45it/s] 50%|█████     | 20/40 [00:13<00:13,  1.46it/s] 52%|█████▎    | 21/40 [00:14<00:13,  1.46it/s] 55%|█████▌    | 22/40 [00:15<00:12,  1.46it/s] 57%|█████▊    | 23/40 [00:15<00:11,  1.45it/s] 60%|██████    | 24/40 [00:16<00:11,  1.45it/s] 62%|██████▎   | 25/40 [00:17<00:10,  1.44it/s] 65%|██████▌   | 26/40 [00:18<00:11,  1.22it/s] 68%|██████▊   | 27/40 [00:19<00:10,  1.28it/s] 70%|███████   | 28/40 [00:19<00:09,  1.33it/s] 72%|███████▎  | 29/40 [00:20<00:08,  1.37it/s] 75%|███████▌  | 30/40 [00:21<00:07,  1.40it/s] 78%|███████▊  | 31/40 [00:21<00:06,  1.41it/s] 80%|████████  | 32/40 [00:22<00:05,  1.43it/s] 82%|████████▎ | 33/40 [00:23<00:04,  1.43it/s] 85%|████████▌ | 34/40 [00:23<00:04,  1.45it/s] 88%|████████▊ | 35/40 [00:24<00:03,  1.45it/s] 90%|█████████ | 36/40 [00:25<00:02,  1.44it/s] 92%|█████████▎| 37/40 [00:25<00:02,  1.44it/s] 95%|█████████▌| 38/40 [00:26<00:01,  1.44it/s] 98%|█████████▊| 39/40 [00:27<00:00,  1.44it/s]100%|██████████| 40/40 [00:27<00:00,  1.59it/s]100%|██████████| 40/40 [00:27<00:00,  1.44it/s]
[32m2025-02-05 06:15:24.920[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    average  bleu@1  bleu@2  bleu@3  bleu@4  dist@1  dist@2  dist@3  dist@4  extreme  \
      .7742   .2903   .1045  .03829  .01901  .04414   .2944   .5577   .7196    .5965   
      f1  gen_loss  greedy  intra_dist@1  intra_dist@2  intra_dist@3  intra_dist@4  \
   .3454     5.184   .6649         .8575         .9570         .9474         .9144   
     ppl  rouge1  rouge2  rougeL  
   178.4   .3799   .0853   .3687[0m
[32m2025-02-05 06:15:24.928[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m163[0m - [1m[Conversation epoch 63][0m
[32m2025-02-05 06:15:24.928[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m164[0m - [1m[Train][0m
  0%|          | 0/92414 [00:00<?, ?it/s]100%|██████████| 92414/92414 [00:00<00:00, 1040344.01it/s]
[32m2025-02-05 06:15:25.017[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/358 [00:00<?, ?it/s]  0%|          | 1/358 [00:00<00:36,  9.77it/s]  1%|          | 3/358 [00:00<00:35,  9.94it/s]  1%|          | 4/358 [00:00<00:35,  9.92it/s]  2%|▏         | 6/358 [00:00<00:35,  9.88it/s]  2%|▏         | 7/358 [00:00<00:35,  9.82it/s]  2%|▏         | 8/358 [00:00<00:35,  9.86it/s]  3%|▎         | 9/358 [00:00<00:35,  9.77it/s]  3%|▎         | 10/358 [00:01<00:35,  9.76it/s]  3%|▎         | 11/358 [00:01<00:35,  9.71it/s]  4%|▎         | 13/358 [00:01<00:34,  9.92it/s]  4%|▍         | 14/358 [00:01<00:34,  9.85it/s]  4%|▍         | 15/358 [00:01<00:35,  9.78it/s]  4%|▍         | 16/358 [00:01<00:35,  9.71it/s]  5%|▍         | 17/358 [00:01<00:35,  9.72it/s]  5%|▌         | 19/358 [00:01<00:34,  9.75it/s]  6%|▌         | 20/358 [00:02<00:34,  9.70it/s]  6%|▌         | 21/358 [00:02<00:35,  9.63it/s]  6%|▌         | 22/358 [00:02<00:34,  9.67it/s]  7%|▋         | 24/358 [00:02<00:34,  9.77it/s]  7%|▋         | 25/358 [00:02<00:34,  9.72it/s]  7%|▋         | 26/358 [00:02<00:34,  9.68it/s]  8%|▊         | 27/358 [00:02<00:34,  9.73it/s]  8%|▊         | 28/358 [00:02<00:34,  9.68it/s]  8%|▊         | 29/358 [00:02<00:34,  9.65it/s]  9%|▊         | 31/358 [00:03<00:33,  9.75it/s]  9%|▉         | 32/358 [00:03<00:33,  9.75it/s]  9%|▉         | 34/358 [00:03<00:32,  9.86it/s] 10%|█         | 36/358 [00:03<00:32,  9.85it/s] 10%|█         | 37/358 [00:03<00:32,  9.83it/s] 11%|█         | 38/358 [00:03<00:32,  9.79it/s] 11%|█         | 40/358 [00:04<00:31,  9.95it/s] 11%|█▏        | 41/358 [00:04<00:32,  9.86it/s] 12%|█▏        | 43/358 [00:04<00:31,  9.89it/s] 13%|█▎        | 45/358 [00:04<00:31,  9.98it/s] 13%|█▎        | 47/358 [00:04<00:31,  9.96it/s] 13%|█▎        | 48/358 [00:04<00:31,  9.95it/s] 14%|█▍        | 50/358 [00:05<00:31,  9.92it/s] 14%|█▍        | 51/358 [00:05<00:31,  9.85it/s] 15%|█▍        | 52/358 [00:05<00:31,  9.76it/s] 15%|█▍        | 53/358 [00:05<00:31,  9.71it/s] 15%|█▌        | 54/358 [00:05<00:31,  9.75it/s] 15%|█▌        | 55/358 [00:05<00:31,  9.70it/s] 16%|█▌        | 56/358 [00:05<00:31,  9.74it/s] 16%|█▌        | 57/358 [00:05<00:31,  9.70it/s] 16%|█▌        | 58/358 [00:05<00:31,  9.68it/s] 16%|█▋        | 59/358 [00:06<00:31,  9.64it/s] 17%|█▋        | 61/358 [00:06<00:30,  9.73it/s] 17%|█▋        | 62/358 [00:06<00:30,  9.65it/s] 18%|█▊        | 63/358 [00:06<00:30,  9.72it/s] 18%|█▊        | 64/358 [00:06<00:30,  9.67it/s] 18%|█▊        | 66/358 [00:06<00:29,  9.74it/s] 19%|█▊        | 67/358 [00:06<00:29,  9.72it/s] 19%|█▉        | 69/358 [00:07<00:29,  9.79it/s] 20%|█▉        | 70/358 [00:07<00:29,  9.73it/s] 20%|█▉        | 71/358 [00:07<00:29,  9.78it/s] 20%|██        | 72/358 [00:07<00:29,  9.73it/s] 20%|██        | 73/358 [00:07<00:29,  9.70it/s] 21%|██        | 74/358 [00:07<00:29,  9.66it/s] 21%|██        | 75/358 [00:07<00:29,  9.63it/s] 21%|██        | 76/358 [00:07<00:28,  9.73it/s] 22%|██▏       | 77/358 [00:07<00:28,  9.70it/s] 22%|██▏       | 79/358 [00:08<00:28,  9.70it/s] 23%|██▎       | 81/358 [00:08<00:28,  9.76it/s] 23%|██▎       | 83/358 [00:08<00:28,  9.79it/s] 23%|██▎       | 84/358 [00:08<00:28,  9.74it/s] 24%|██▎       | 85/358 [00:08<00:28,  9.69it/s] 24%|██▍       | 86/358 [00:08<00:28,  9.68it/s] 24%|██▍       | 87/358 [00:08<00:28,  9.66it/s] 25%|██▍       | 88/358 [00:09<00:27,  9.68it/s] 25%|██▌       | 90/358 [00:09<00:27,  9.91it/s] 26%|██▌       | 92/358 [00:09<00:26, 10.02it/s] 26%|██▌       | 93/358 [00:09<00:26,  9.98it/s] 26%|██▋       | 94/358 [00:09<00:26,  9.89it/s] 27%|██▋       | 96/358 [00:09<00:25, 10.17it/s] 27%|██▋       | 98/358 [00:09<00:25, 10.06it/s] 28%|██▊       | 100/358 [00:10<00:25, 10.01it/s] 28%|██▊       | 101/358 [00:10<00:25,  9.92it/s] 29%|██▉       | 103/358 [00:10<00:25,  9.92it/s] 29%|██▉       | 104/358 [00:10<00:25,  9.87it/s] 29%|██▉       | 105/358 [00:10<00:25,  9.79it/s] 30%|██▉       | 106/358 [00:10<00:25,  9.78it/s] 30%|███       | 108/358 [00:11<00:25,  9.81it/s] 30%|███       | 109/358 [00:11<00:25,  9.73it/s] 31%|███       | 110/358 [00:11<00:25,  9.71it/s] 31%|███       | 111/358 [00:11<00:25,  9.66it/s] 32%|███▏      | 113/358 [00:11<00:24,  9.93it/s] 32%|███▏      | 114/358 [00:11<00:24,  9.89it/s] 32%|███▏      | 115/358 [00:11<00:24,  9.79it/s] 32%|███▏      | 116/358 [00:11<00:24,  9.70it/s] 33%|███▎      | 117/358 [00:11<00:24,  9.68it/s] 33%|███▎      | 119/358 [00:12<00:24,  9.80it/s] 34%|███▍      | 121/358 [00:12<00:23,  9.99it/s] 34%|███▍      | 123/358 [00:12<00:23, 10.09it/s] 35%|███▍      | 125/358 [00:12<00:23, 10.07it/s] 35%|███▌      | 127/358 [00:12<00:23, 10.00it/s] 36%|███▌      | 128/358 [00:13<00:23,  9.96it/s] 36%|███▋      | 130/358 [00:13<00:22, 10.01it/s] 37%|███▋      | 131/358 [00:13<00:22,  9.92it/s] 37%|███▋      | 132/358 [00:13<00:22,  9.93it/s] 37%|███▋      | 134/358 [00:13<00:22,  9.95it/s] 38%|███▊      | 135/358 [00:13<00:22,  9.89it/s] 38%|███▊      | 137/358 [00:13<00:22,  9.98it/s] 39%|███▊      | 138/358 [00:14<00:22,  9.96it/s] 39%|███▉      | 139/358 [00:14<00:22,  9.87it/s] 39%|███▉      | 141/358 [00:14<00:21, 10.00it/s] 40%|███▉      | 142/358 [00:14<00:21,  9.92it/s] 40%|███▉      | 143/358 [00:14<00:21,  9.89it/s] 40%|████      | 144/358 [00:14<00:21,  9.80it/s] 41%|████      | 145/358 [00:14<00:21,  9.82it/s] 41%|████      | 146/358 [00:14<00:21,  9.76it/s] 41%|████      | 147/358 [00:14<00:21,  9.70it/s] 41%|████▏     | 148/358 [00:15<00:21,  9.72it/s] 42%|████▏     | 149/358 [00:15<00:21,  9.71it/s] 42%|████▏     | 150/358 [00:15<00:21,  9.66it/s] 42%|████▏     | 151/358 [00:15<00:22,  9.40it/s] 42%|████▏     | 152/358 [00:15<00:21,  9.44it/s] 43%|████▎     | 153/358 [00:15<00:21,  9.46it/s] 43%|████▎     | 154/358 [00:15<00:21,  9.56it/s] 43%|████▎     | 155/358 [00:15<00:21,  9.57it/s] 44%|████▎     | 156/358 [00:15<00:20,  9.69it/s] 44%|████▍     | 157/358 [00:16<00:20,  9.63it/s] 44%|████▍     | 158/358 [00:16<00:20,  9.72it/s] 44%|████▍     | 159/358 [00:16<00:20,  9.71it/s] 45%|████▍     | 160/358 [00:16<00:20,  9.72it/s] 45%|████▌     | 162/358 [00:16<00:19, 10.02it/s] 46%|████▌     | 164/358 [00:16<00:19, 10.02it/s] 46%|████▌     | 165/358 [00:16<00:19,  9.97it/s] 47%|████▋     | 167/358 [00:17<00:19,  9.92it/s] 47%|████▋     | 169/358 [00:17<00:18,  9.96it/s] 48%|████▊     | 171/358 [00:17<00:18,  9.94it/s] 48%|████▊     | 172/358 [00:17<00:18,  9.89it/s] 48%|████▊     | 173/358 [00:17<00:18,  9.82it/s] 49%|████▉     | 175/358 [00:17<00:18,  9.84it/s] 49%|████▉     | 176/358 [00:17<00:18,  9.85it/s] 49%|████▉     | 177/358 [00:18<00:18,  9.84it/s] 50%|█████     | 179/358 [00:18<00:18,  9.87it/s] 50%|█████     | 180/358 [00:18<00:18,  9.80it/s] 51%|█████     | 182/358 [00:18<00:17,  9.96it/s] 51%|█████     | 183/358 [00:18<00:17,  9.91it/s] 51%|█████▏    | 184/358 [00:18<00:17,  9.79it/s] 52%|█████▏    | 185/358 [00:18<00:17,  9.74it/s] 52%|█████▏    | 187/358 [00:19<00:17,  9.95it/s] 53%|█████▎    | 188/358 [00:19<00:17,  9.90it/s] 53%|█████▎    | 189/358 [00:19<00:17,  9.84it/s] 53%|█████▎    | 191/358 [00:19<00:17,  9.76it/s] 54%|█████▎    | 192/358 [00:19<00:17,  9.71it/s] 54%|█████▍    | 193/358 [00:19<00:17,  9.70it/s] 54%|█████▍    | 194/358 [00:19<00:16,  9.68it/s] 54%|█████▍    | 195/358 [00:19<00:16,  9.75it/s] 55%|█████▌    | 197/358 [00:20<00:16,  9.93it/s] 55%|█████▌    | 198/358 [00:20<00:16,  9.85it/s] 56%|█████▌    | 199/358 [00:20<00:16,  9.88it/s] 56%|█████▌    | 200/358 [00:20<00:16,  9.81it/s] 56%|█████▌    | 201/358 [00:20<00:16,  9.77it/s] 57%|█████▋    | 203/358 [00:20<00:15,  9.86it/s] 57%|█████▋    | 204/358 [00:20<00:15,  9.76it/s] 57%|█████▋    | 205/358 [00:20<00:15,  9.72it/s] 58%|█████▊    | 207/358 [00:21<00:15,  9.89it/s] 58%|█████▊    | 208/358 [00:21<00:15,  9.81it/s] 59%|█████▊    | 210/358 [00:21<00:15,  9.83it/s] 59%|█████▉    | 212/358 [00:21<00:14,  9.82it/s] 60%|█████▉    | 214/358 [00:21<00:14,  9.90it/s] 60%|██████    | 215/358 [00:21<00:14,  9.84it/s] 60%|██████    | 216/358 [00:22<00:14,  9.78it/s] 61%|██████    | 217/358 [00:22<00:14,  9.81it/s] 61%|██████    | 218/358 [00:22<00:14,  9.78it/s] 61%|██████    | 219/358 [00:22<00:14,  9.79it/s] 62%|██████▏   | 221/358 [00:22<00:13,  9.92it/s] 62%|██████▏   | 222/358 [00:22<00:13,  9.81it/s] 62%|██████▏   | 223/358 [00:22<00:13,  9.76it/s] 63%|██████▎   | 224/358 [00:22<00:13,  9.70it/s] 63%|██████▎   | 226/358 [00:23<00:13,  9.75it/s] 64%|██████▎   | 228/358 [00:23<00:13,  9.77it/s] 64%|██████▍   | 229/358 [00:23<00:13,  9.75it/s] 64%|██████▍   | 230/358 [00:23<00:13,  9.70it/s] 65%|██████▍   | 232/358 [00:23<00:12,  9.75it/s] 65%|██████▌   | 234/358 [00:23<00:12, 10.03it/s] 66%|██████▌   | 236/358 [00:24<00:12, 10.00it/s] 66%|██████▋   | 238/358 [00:24<00:11, 10.05it/s] 67%|██████▋   | 240/358 [00:24<00:11, 10.01it/s] 68%|██████▊   | 242/358 [00:24<00:11,  9.99it/s] 68%|██████▊   | 243/358 [00:24<00:11,  9.93it/s] 68%|██████▊   | 244/358 [00:24<00:11,  9.86it/s] 69%|██████▊   | 246/358 [00:25<00:11,  9.88it/s] 69%|██████▉   | 247/358 [00:25<00:11,  9.81it/s] 69%|██████▉   | 248/358 [00:25<00:11,  9.77it/s] 70%|██████▉   | 250/358 [00:25<00:10,  9.86it/s] 70%|███████   | 251/358 [00:25<00:10,  9.80it/s] 70%|███████   | 252/358 [00:25<00:10,  9.74it/s] 71%|███████   | 253/358 [00:25<00:10,  9.70it/s] 71%|███████   | 254/358 [00:25<00:10,  9.67it/s] 72%|███████▏  | 256/358 [00:26<00:10,  9.85it/s] 72%|███████▏  | 257/358 [00:26<00:10,  9.85it/s] 72%|███████▏  | 258/358 [00:26<00:10,  9.73it/s] 72%|███████▏  | 259/358 [00:26<00:10,  9.69it/s] 73%|███████▎  | 260/358 [00:26<00:10,  9.72it/s] 73%|███████▎  | 262/358 [00:26<00:09,  9.91it/s] 74%|███████▎  | 264/358 [00:26<00:09,  9.93it/s] 74%|███████▍  | 266/358 [00:27<00:09,  9.92it/s] 75%|███████▍  | 267/358 [00:27<00:09,  9.86it/s] 75%|███████▌  | 269/358 [00:27<00:08,  9.91it/s] 75%|███████▌  | 270/358 [00:27<00:08,  9.84it/s] 76%|███████▌  | 271/358 [00:27<00:08,  9.77it/s] 76%|███████▌  | 272/358 [00:27<00:08,  9.75it/s] 76%|███████▋  | 273/358 [00:27<00:08,  9.65it/s] 77%|███████▋  | 274/358 [00:27<00:08,  9.64it/s] 77%|███████▋  | 275/358 [00:28<00:08,  9.69it/s] 77%|███████▋  | 276/358 [00:28<00:08,  9.69it/s] 77%|███████▋  | 277/358 [00:28<00:08,  9.67it/s] 78%|███████▊  | 278/358 [00:28<00:08,  9.64it/s] 78%|███████▊  | 280/358 [00:28<00:07,  9.83it/s] 78%|███████▊  | 281/358 [00:28<00:07,  9.84it/s] 79%|███████▉  | 282/358 [00:28<00:07,  9.78it/s] 79%|███████▉  | 283/358 [00:28<00:07,  9.72it/s] 79%|███████▉  | 284/358 [00:28<00:07,  9.68it/s] 80%|███████▉  | 285/358 [00:29<00:07,  9.75it/s] 80%|███████▉  | 286/358 [00:29<00:07,  9.71it/s] 80%|████████  | 287/358 [00:29<00:07,  9.68it/s] 80%|████████  | 288/358 [00:29<00:07,  9.64it/s] 81%|████████  | 290/358 [00:29<00:06,  9.86it/s] 81%|████████▏ | 291/358 [00:29<00:06,  9.84it/s] 82%|████████▏ | 293/358 [00:29<00:06,  9.85it/s] 82%|████████▏ | 295/358 [00:30<00:06,  9.93it/s] 83%|████████▎ | 296/358 [00:30<00:06,  9.86it/s] 83%|████████▎ | 297/358 [00:30<00:06,  9.75it/s] 84%|████████▎ | 299/358 [00:30<00:05,  9.91it/s] 84%|████████▍ | 301/358 [00:30<00:05,  9.95it/s] 84%|████████▍ | 302/358 [00:30<00:05,  9.88it/s] 85%|████████▍ | 303/358 [00:30<00:05,  9.89it/s] 85%|████████▌ | 305/358 [00:31<00:05,  9.92it/s] 85%|████████▌ | 306/358 [00:31<00:05,  9.84it/s] 86%|████████▌ | 308/358 [00:31<00:05,  9.94it/s] 86%|████████▋ | 309/358 [00:31<00:04,  9.83it/s] 87%|████████▋ | 310/358 [00:31<00:04,  9.78it/s] 87%|████████▋ | 311/358 [00:31<00:04,  9.70it/s] 87%|████████▋ | 312/358 [00:31<00:04,  9.72it/s] 87%|████████▋ | 313/358 [00:31<00:04,  9.74it/s] 88%|████████▊ | 315/358 [00:32<00:04, 10.00it/s] 88%|████████▊ | 316/358 [00:32<00:04,  9.95it/s] 89%|████████▊ | 317/358 [00:32<00:04,  9.86it/s] 89%|████████▉ | 318/358 [00:32<00:04,  9.81it/s] 89%|████████▉ | 319/358 [00:32<00:03,  9.77it/s] 89%|████████▉ | 320/358 [00:32<00:03,  9.83it/s] 90%|████████▉ | 321/358 [00:32<00:03,  9.75it/s] 90%|████████▉ | 322/358 [00:32<00:03,  9.71it/s] 90%|█████████ | 323/358 [00:32<00:03,  9.67it/s] 91%|█████████ | 324/358 [00:33<00:03,  9.63it/s] 91%|█████████ | 325/358 [00:33<00:03,  9.61it/s] 91%|█████████▏| 327/358 [00:33<00:03,  9.98it/s] 92%|█████████▏| 329/358 [00:33<00:02, 10.08it/s] 92%|█████████▏| 330/358 [00:33<00:02,  9.97it/s] 93%|█████████▎| 332/358 [00:33<00:02, 10.07it/s] 93%|█████████▎| 334/358 [00:33<00:02,  9.97it/s] 94%|█████████▎| 335/358 [00:34<00:02,  9.85it/s] 94%|█████████▍| 337/358 [00:34<00:02,  9.92it/s] 95%|█████████▍| 339/358 [00:34<00:01, 10.12it/s] 95%|█████████▌| 341/358 [00:34<00:01, 10.07it/s] 96%|█████████▌| 343/358 [00:34<00:01,  9.91it/s] 96%|█████████▌| 344/358 [00:35<00:01,  9.85it/s] 96%|█████████▋| 345/358 [00:35<00:01,  9.87it/s] 97%|█████████▋| 347/358 [00:35<00:01, 10.05it/s] 97%|█████████▋| 349/358 [00:35<00:00,  9.89it/s] 98%|█████████▊| 350/358 [00:35<00:00,  9.83it/s] 98%|█████████▊| 351/358 [00:35<00:00,  9.78it/s] 99%|█████████▊| 353/358 [00:35<00:00,  9.93it/s] 99%|█████████▉| 354/358 [00:36<00:00,  9.91it/s] 99%|█████████▉| 355/358 [00:36<00:00,  9.83it/s]100%|█████████▉| 357/358 [00:36<00:00,  9.88it/s]100%|██████████| 358/358 [00:36<00:00,  9.84it/s]
[32m2025-02-05 06:16:01.416[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    gen_loss  grad clip ratio  grad norm   ppl
        1.84                1      2.243 6.299[0m
[32m2025-02-05 06:16:01.417[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m169[0m - [1m[Valid][0m
  0%|          | 0/10256 [00:00<?, ?it/s]100%|██████████| 10256/10256 [00:00<00:00, 1106142.66it/s]
[32m2025-02-05 06:16:01.426[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:27,  1.43it/s]  5%|▌         | 2/40 [00:01<00:26,  1.45it/s]  8%|▊         | 3/40 [00:02<00:25,  1.45it/s] 10%|█         | 4/40 [00:02<00:24,  1.46it/s] 12%|█▎        | 5/40 [00:03<00:24,  1.45it/s] 15%|█▌        | 6/40 [00:04<00:23,  1.45it/s] 18%|█▊        | 7/40 [00:04<00:22,  1.45it/s] 20%|██        | 8/40 [00:05<00:22,  1.45it/s] 22%|██▎       | 9/40 [00:06<00:21,  1.45it/s] 25%|██▌       | 10/40 [00:06<00:20,  1.45it/s] 28%|██▊       | 11/40 [00:07<00:19,  1.45it/s] 30%|███       | 12/40 [00:08<00:19,  1.45it/s] 32%|███▎      | 13/40 [00:08<00:18,  1.45it/s] 35%|███▌      | 14/40 [00:09<00:18,  1.44it/s] 38%|███▊      | 15/40 [00:10<00:17,  1.45it/s] 40%|████      | 16/40 [00:11<00:16,  1.45it/s] 42%|████▎     | 17/40 [00:11<00:15,  1.45it/s] 45%|████▌     | 18/40 [00:12<00:15,  1.45it/s] 48%|████▊     | 19/40 [00:13<00:14,  1.45it/s] 50%|█████     | 20/40 [00:13<00:13,  1.46it/s] 52%|█████▎    | 21/40 [00:14<00:12,  1.46it/s] 55%|█████▌    | 22/40 [00:15<00:12,  1.46it/s] 57%|█████▊    | 23/40 [00:15<00:11,  1.46it/s] 60%|██████    | 24/40 [00:16<00:11,  1.45it/s] 62%|██████▎   | 25/40 [00:17<00:10,  1.45it/s] 65%|██████▌   | 26/40 [00:17<00:09,  1.46it/s] 68%|██████▊   | 27/40 [00:18<00:08,  1.45it/s] 70%|███████   | 28/40 [00:19<00:08,  1.45it/s] 72%|███████▎  | 29/40 [00:19<00:07,  1.45it/s] 75%|███████▌  | 30/40 [00:20<00:06,  1.45it/s] 78%|███████▊  | 31/40 [00:21<00:06,  1.45it/s] 80%|████████  | 32/40 [00:22<00:05,  1.45it/s] 82%|████████▎ | 33/40 [00:22<00:04,  1.45it/s] 85%|████████▌ | 34/40 [00:23<00:04,  1.45it/s] 88%|████████▊ | 35/40 [00:24<00:03,  1.45it/s] 90%|█████████ | 36/40 [00:24<00:02,  1.44it/s] 92%|█████████▎| 37/40 [00:25<00:02,  1.44it/s] 95%|█████████▌| 38/40 [00:26<00:01,  1.44it/s] 98%|█████████▊| 39/40 [00:26<00:00,  1.44it/s]100%|██████████| 40/40 [00:27<00:00,  1.59it/s]100%|██████████| 40/40 [00:27<00:00,  1.46it/s]
[32m2025-02-05 06:16:28.811[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    average  bleu@1  bleu@2  bleu@3  bleu@4  dist@1  dist@2  dist@3  dist@4  extreme  \
      .7774   .2909   .1028  .03828  .01878  .04239   .2915   .5572   .7113    .5947   
      f1  gen_loss  greedy  intra_dist@1  intra_dist@2  intra_dist@3  intra_dist@4  \
   .3460      5.19   .6650         .8567         .9538         .9407         .9090   
     ppl  rouge1  rouge2  rougeL  
   179.5   .3804  .08343   .3675[0m
[32m2025-02-05 06:16:28.818[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m163[0m - [1m[Conversation epoch 64][0m
[32m2025-02-05 06:16:28.818[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m164[0m - [1m[Train][0m
  0%|          | 0/92414 [00:00<?, ?it/s]100%|██████████| 92414/92414 [00:00<00:00, 1000506.97it/s]
[32m2025-02-05 06:16:28.911[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/358 [00:00<?, ?it/s]  0%|          | 1/358 [00:00<00:36,  9.76it/s]  1%|          | 3/358 [00:00<00:35,  9.94it/s]  1%|          | 4/358 [00:00<00:35,  9.92it/s]  2%|▏         | 6/358 [00:00<00:35,  9.88it/s]  2%|▏         | 7/358 [00:00<00:35,  9.81it/s]  2%|▏         | 8/358 [00:00<00:35,  9.86it/s]  3%|▎         | 9/358 [00:00<00:35,  9.76it/s]  3%|▎         | 10/358 [00:01<00:35,  9.75it/s]  3%|▎         | 11/358 [00:01<00:35,  9.70it/s]  4%|▎         | 13/358 [00:01<00:34,  9.92it/s]  4%|▍         | 14/358 [00:01<00:34,  9.85it/s]  4%|▍         | 15/358 [00:01<00:35,  9.78it/s]  4%|▍         | 16/358 [00:01<00:35,  9.71it/s]  5%|▍         | 17/358 [00:01<00:35,  9.73it/s]  5%|▌         | 19/358 [00:01<00:34,  9.75it/s]  6%|▌         | 20/358 [00:02<00:34,  9.70it/s]  6%|▌         | 21/358 [00:02<00:34,  9.63it/s]  6%|▌         | 22/358 [00:02<00:34,  9.69it/s]  7%|▋         | 24/358 [00:02<00:34,  9.78it/s]  7%|▋         | 25/358 [00:02<00:34,  9.73it/s]  7%|▋         | 26/358 [00:02<00:34,  9.68it/s]  8%|▊         | 27/358 [00:02<00:34,  9.73it/s]  8%|▊         | 28/358 [00:02<00:34,  9.69it/s]  8%|▊         | 29/358 [00:02<00:34,  9.65it/s]  9%|▊         | 31/358 [00:03<00:33,  9.75it/s]  9%|▉         | 32/358 [00:03<00:33,  9.75it/s]  9%|▉         | 34/358 [00:03<00:32,  9.85it/s] 10%|█         | 36/358 [00:03<00:32,  9.85it/s] 10%|█         | 37/358 [00:03<00:32,  9.83it/s] 11%|█         | 38/358 [00:03<00:32,  9.79it/s] 11%|█         | 40/358 [00:04<00:31,  9.95it/s] 11%|█▏        | 41/358 [00:04<00:32,  9.86it/s] 12%|█▏        | 43/358 [00:04<00:31,  9.89it/s] 13%|█▎        | 45/358 [00:04<00:31,  9.98it/s] 13%|█▎        | 47/358 [00:04<00:31,  9.96it/s] 13%|█▎        | 48/358 [00:04<00:31,  9.95it/s] 14%|█▍        | 50/358 [00:05<00:31,  9.92it/s] 14%|█▍        | 51/358 [00:05<00:31,  9.85it/s] 15%|█▍        | 52/358 [00:05<00:31,  9.76it/s] 15%|█▍        | 53/358 [00:05<00:31,  9.71it/s] 15%|█▌        | 54/358 [00:05<00:31,  9.75it/s] 15%|█▌        | 55/358 [00:05<00:31,  9.70it/s] 16%|█▌        | 56/358 [00:05<00:30,  9.74it/s] 16%|█▌        | 57/358 [00:05<00:31,  9.70it/s] 16%|█▌        | 58/358 [00:05<00:31,  9.68it/s] 16%|█▋        | 59/358 [00:06<00:30,  9.65it/s] 17%|█▋        | 61/358 [00:06<00:30,  9.73it/s] 17%|█▋        | 62/358 [00:06<00:30,  9.65it/s] 18%|█▊        | 63/358 [00:06<00:30,  9.72it/s] 18%|█▊        | 64/358 [00:06<00:30,  9.67it/s] 18%|█▊        | 66/358 [00:06<00:29,  9.74it/s] 19%|█▊        | 67/358 [00:06<00:29,  9.73it/s] 19%|█▉        | 69/358 [00:07<00:29,  9.79it/s] 20%|█▉        | 70/358 [00:07<00:29,  9.73it/s] 20%|█▉        | 71/358 [00:07<00:29,  9.78it/s] 20%|██        | 72/358 [00:07<00:29,  9.72it/s] 20%|██        | 73/358 [00:07<00:29,  9.69it/s] 21%|██        | 74/358 [00:07<00:29,  9.66it/s] 21%|██        | 75/358 [00:07<00:29,  9.63it/s] 21%|██        | 76/358 [00:07<00:28,  9.73it/s] 22%|██▏       | 77/358 [00:07<00:28,  9.70it/s] 22%|██▏       | 79/358 [00:08<00:28,  9.70it/s] 23%|██▎       | 81/358 [00:08<00:28,  9.76it/s] 23%|██▎       | 83/358 [00:08<00:28,  9.79it/s] 23%|██▎       | 84/358 [00:08<00:28,  9.74it/s] 24%|██▎       | 85/358 [00:08<00:28,  9.69it/s] 24%|██▍       | 86/358 [00:08<00:28,  9.68it/s] 24%|██▍       | 87/358 [00:08<00:28,  9.66it/s] 25%|██▍       | 88/358 [00:09<00:27,  9.68it/s] 25%|██▌       | 90/358 [00:09<00:27,  9.92it/s] 26%|██▌       | 92/358 [00:09<00:26, 10.00it/s] 26%|██▌       | 93/358 [00:09<00:26,  9.97it/s] 26%|██▋       | 94/358 [00:09<00:26,  9.88it/s] 27%|██▋       | 96/358 [00:09<00:25, 10.16it/s] 27%|██▋       | 98/358 [00:09<00:25, 10.05it/s] 28%|██▊       | 99/358 [00:10<00:25,  9.96it/s] 28%|██▊       | 101/358 [00:10<00:25,  9.93it/s] 29%|██▉       | 103/358 [00:10<00:25,  9.92it/s] 29%|██▉       | 104/358 [00:10<00:25,  9.88it/s] 29%|██▉       | 105/358 [00:10<00:25,  9.80it/s] 30%|██▉       | 106/358 [00:10<00:25,  9.78it/s] 30%|███       | 108/358 [00:11<00:25,  9.81it/s] 30%|███       | 109/358 [00:11<00:25,  9.72it/s] 31%|███       | 110/358 [00:11<00:25,  9.71it/s] 31%|███       | 111/358 [00:11<00:25,  9.66it/s] 32%|███▏      | 113/358 [00:11<00:24,  9.92it/s] 32%|███▏      | 114/358 [00:11<00:24,  9.88it/s] 32%|███▏      | 115/358 [00:11<00:24,  9.79it/s] 32%|███▏      | 116/358 [00:11<00:24,  9.70it/s] 33%|███▎      | 117/358 [00:11<00:24,  9.67it/s] 33%|███▎      | 119/358 [00:12<00:24,  9.79it/s] 34%|███▍      | 121/358 [00:12<00:23,  9.99it/s] 34%|███▍      | 123/358 [00:12<00:23, 10.09it/s] 35%|███▍      | 125/358 [00:12<00:23, 10.07it/s] 35%|███▌      | 127/358 [00:12<00:23,  9.99it/s] 36%|███▌      | 128/358 [00:13<00:23,  9.95it/s] 36%|███▋      | 130/358 [00:13<00:22, 10.00it/s] 37%|███▋      | 131/358 [00:13<00:22,  9.91it/s] 37%|███▋      | 132/358 [00:13<00:22,  9.93it/s] 37%|███▋      | 134/358 [00:13<00:22,  9.95it/s] 38%|███▊      | 135/358 [00:13<00:22,  9.88it/s] 38%|███▊      | 137/358 [00:13<00:22,  9.97it/s] 39%|███▊      | 138/358 [00:14<00:22,  9.95it/s] 39%|███▉      | 139/358 [00:14<00:22,  9.86it/s] 39%|███▉      | 141/358 [00:14<00:21,  9.99it/s] 40%|███▉      | 142/358 [00:14<00:21,  9.91it/s] 40%|███▉      | 143/358 [00:14<00:21,  9.88it/s] 40%|████      | 144/358 [00:14<00:21,  9.79it/s] 41%|████      | 145/358 [00:14<00:21,  9.81it/s] 41%|████      | 146/358 [00:14<00:21,  9.75it/s] 41%|████      | 147/358 [00:14<00:21,  9.69it/s] 41%|████▏     | 148/358 [00:15<00:21,  9.72it/s] 42%|████▏     | 149/358 [00:15<00:21,  9.70it/s] 42%|████▏     | 150/358 [00:15<00:21,  9.66it/s] 42%|████▏     | 151/358 [00:15<00:22,  9.39it/s] 42%|████▏     | 152/358 [00:15<00:21,  9.44it/s] 43%|████▎     | 153/358 [00:15<00:21,  9.45it/s] 43%|████▎     | 154/358 [00:15<00:21,  9.54it/s] 43%|████▎     | 155/358 [00:15<00:21,  9.56it/s] 44%|████▎     | 156/358 [00:15<00:20,  9.68it/s] 44%|████▍     | 157/358 [00:16<00:20,  9.62it/s] 44%|████▍     | 158/358 [00:16<00:20,  9.71it/s] 44%|████▍     | 159/358 [00:16<00:20,  9.71it/s] 45%|████▍     | 160/358 [00:16<00:20,  9.72it/s] 45%|████▌     | 162/358 [00:16<00:19, 10.01it/s] 46%|████▌     | 164/358 [00:16<00:19, 10.01it/s] 46%|████▌     | 165/358 [00:16<00:19,  9.97it/s] 47%|████▋     | 167/358 [00:17<00:19,  9.92it/s] 47%|████▋     | 169/358 [00:17<00:18,  9.95it/s] 48%|████▊     | 171/358 [00:17<00:18,  9.94it/s] 48%|████▊     | 172/358 [00:17<00:18,  9.88it/s] 48%|████▊     | 173/358 [00:17<00:18,  9.82it/s] 49%|████▉     | 175/358 [00:17<00:18,  9.84it/s] 49%|████▉     | 176/358 [00:17<00:18,  9.86it/s] 49%|████▉     | 177/358 [00:18<00:18,  9.84it/s] 50%|█████     | 179/358 [00:18<00:18,  9.87it/s] 50%|█████     | 180/358 [00:18<00:18,  9.79it/s] 51%|█████     | 182/358 [00:18<00:17,  9.95it/s] 51%|█████     | 183/358 [00:18<00:17,  9.90it/s] 51%|█████▏    | 184/358 [00:18<00:17,  9.79it/s] 52%|█████▏    | 185/358 [00:18<00:17,  9.74it/s] 52%|█████▏    | 187/358 [00:19<00:17,  9.95it/s] 53%|█████▎    | 188/358 [00:19<00:17,  9.90it/s] 53%|█████▎    | 189/358 [00:19<00:17,  9.84it/s] 53%|█████▎    | 191/358 [00:19<00:17,  9.76it/s] 54%|█████▎    | 192/358 [00:19<00:17,  9.71it/s] 54%|█████▍    | 193/358 [00:19<00:17,  9.70it/s] 54%|█████▍    | 194/358 [00:19<00:16,  9.68it/s] 54%|█████▍    | 195/358 [00:19<00:16,  9.75it/s] 55%|█████▌    | 197/358 [00:20<00:16,  9.93it/s] 55%|█████▌    | 198/358 [00:20<00:16,  9.85it/s] 56%|█████▌    | 199/358 [00:20<00:16,  9.88it/s] 56%|█████▌    | 200/358 [00:20<00:16,  9.82it/s] 56%|█████▌    | 201/358 [00:20<00:16,  9.78it/s] 57%|█████▋    | 203/358 [00:20<00:15,  9.87it/s] 57%|█████▋    | 204/358 [00:20<00:15,  9.76it/s] 57%|█████▋    | 205/358 [00:20<00:15,  9.72it/s] 58%|█████▊    | 207/358 [00:21<00:15,  9.88it/s] 58%|█████▊    | 208/358 [00:21<00:15,  9.81it/s] 59%|█████▊    | 210/358 [00:21<00:15,  9.83it/s] 59%|█████▉    | 212/358 [00:21<00:14,  9.82it/s] 60%|█████▉    | 214/358 [00:21<00:14,  9.90it/s] 60%|██████    | 215/358 [00:21<00:14,  9.84it/s] 60%|██████    | 216/358 [00:22<00:14,  9.77it/s] 61%|██████    | 217/358 [00:22<00:14,  9.81it/s] 61%|██████    | 218/358 [00:22<00:14,  9.78it/s] 61%|██████    | 219/358 [00:22<00:14,  9.78it/s] 62%|██████▏   | 221/358 [00:22<00:13,  9.91it/s] 62%|██████▏   | 222/358 [00:22<00:13,  9.81it/s] 62%|██████▏   | 223/358 [00:22<00:13,  9.75it/s] 63%|██████▎   | 224/358 [00:22<00:13,  9.70it/s] 63%|██████▎   | 226/358 [00:23<00:13,  9.74it/s] 64%|██████▎   | 228/358 [00:23<00:13,  9.77it/s] 64%|██████▍   | 229/358 [00:23<00:13,  9.75it/s] 64%|██████▍   | 230/358 [00:23<00:13,  9.70it/s] 65%|██████▍   | 232/358 [00:23<00:12,  9.74it/s] 65%|██████▌   | 234/358 [00:23<00:12, 10.03it/s] 66%|██████▌   | 236/358 [00:24<00:12,  9.99it/s] 66%|██████▋   | 238/358 [00:24<00:11, 10.04it/s] 67%|██████▋   | 240/358 [00:24<00:11, 10.00it/s] 68%|██████▊   | 242/358 [00:24<00:11,  9.98it/s] 68%|██████▊   | 243/358 [00:24<00:11,  9.92it/s] 68%|██████▊   | 244/358 [00:24<00:11,  9.86it/s] 69%|██████▊   | 246/358 [00:25<00:11,  9.88it/s] 69%|██████▉   | 247/358 [00:25<00:11,  9.81it/s] 69%|██████▉   | 248/358 [00:25<00:11,  9.76it/s] 70%|██████▉   | 250/358 [00:25<00:10,  9.86it/s] 70%|███████   | 251/358 [00:25<00:10,  9.80it/s] 70%|███████   | 252/358 [00:25<00:10,  9.73it/s] 71%|███████   | 253/358 [00:25<00:10,  9.69it/s] 71%|███████   | 254/358 [00:25<00:10,  9.66it/s] 72%|███████▏  | 256/358 [00:26<00:10,  9.84it/s] 72%|███████▏  | 257/358 [00:26<00:10,  9.85it/s] 72%|███████▏  | 258/358 [00:26<00:10,  9.72it/s] 72%|███████▏  | 259/358 [00:26<00:10,  9.69it/s] 73%|███████▎  | 260/358 [00:26<00:10,  9.72it/s] 73%|███████▎  | 262/358 [00:26<00:09,  9.90it/s] 74%|███████▎  | 264/358 [00:26<00:09,  9.92it/s] 74%|███████▍  | 266/358 [00:27<00:09,  9.91it/s] 75%|███████▍  | 267/358 [00:27<00:09,  9.85it/s] 75%|███████▌  | 269/358 [00:27<00:08,  9.90it/s] 75%|███████▌  | 270/358 [00:27<00:08,  9.83it/s] 76%|███████▌  | 271/358 [00:27<00:08,  9.76it/s] 76%|███████▌  | 272/358 [00:27<00:08,  9.73it/s] 76%|███████▋  | 273/358 [00:27<00:08,  9.63it/s] 77%|███████▋  | 274/358 [00:27<00:08,  9.63it/s] 77%|███████▋  | 275/358 [00:28<00:08,  9.68it/s] 77%|███████▋  | 276/358 [00:28<00:08,  9.69it/s] 77%|███████▋  | 277/358 [00:28<00:08,  9.65it/s] 78%|███████▊  | 278/358 [00:28<00:08,  9.63it/s] 78%|███████▊  | 280/358 [00:28<00:07,  9.83it/s] 78%|███████▊  | 281/358 [00:28<00:07,  9.84it/s] 79%|███████▉  | 282/358 [00:28<00:07,  9.78it/s] 79%|███████▉  | 283/358 [00:28<00:07,  9.72it/s] 79%|███████▉  | 284/358 [00:28<00:07,  9.68it/s] 80%|███████▉  | 285/358 [00:29<00:07,  9.75it/s] 80%|███████▉  | 286/358 [00:29<00:07,  9.70it/s] 80%|████████  | 287/358 [00:29<00:07,  9.68it/s] 80%|████████  | 288/358 [00:29<00:07,  9.64it/s] 81%|████████  | 290/358 [00:29<00:06,  9.85it/s] 81%|████████▏ | 291/358 [00:29<00:06,  9.83it/s] 82%|████████▏ | 293/358 [00:29<00:06,  9.84it/s] 82%|████████▏ | 295/358 [00:30<00:06,  9.92it/s] 83%|████████▎ | 296/358 [00:30<00:06,  9.85it/s] 83%|████████▎ | 297/358 [00:30<00:06,  9.74it/s] 84%|████████▎ | 299/358 [00:30<00:05,  9.90it/s] 84%|████████▍ | 301/358 [00:30<00:05,  9.94it/s] 84%|████████▍ | 302/358 [00:30<00:05,  9.87it/s] 85%|████████▍ | 303/358 [00:30<00:05,  9.88it/s] 85%|████████▌ | 305/358 [00:31<00:05,  9.91it/s] 85%|████████▌ | 306/358 [00:31<00:05,  9.83it/s] 86%|████████▌ | 308/358 [00:31<00:05,  9.94it/s] 86%|████████▋ | 309/358 [00:31<00:04,  9.83it/s] 87%|████████▋ | 310/358 [00:31<00:04,  9.78it/s] 87%|████████▋ | 311/358 [00:31<00:04,  9.70it/s] 87%|████████▋ | 312/358 [00:31<00:04,  9.72it/s] 87%|████████▋ | 313/358 [00:31<00:04,  9.74it/s] 88%|████████▊ | 315/358 [00:32<00:04, 10.00it/s] 88%|████████▊ | 316/358 [00:32<00:04,  9.95it/s] 89%|████████▊ | 317/358 [00:32<00:04,  9.86it/s] 89%|████████▉ | 318/358 [00:32<00:04,  9.82it/s] 89%|████████▉ | 319/358 [00:32<00:03,  9.77it/s] 89%|████████▉ | 320/358 [00:32<00:03,  9.83it/s] 90%|████████▉ | 321/358 [00:32<00:03,  9.75it/s] 90%|████████▉ | 322/358 [00:32<00:03,  9.71it/s] 90%|█████████ | 323/358 [00:32<00:03,  9.66it/s] 91%|█████████ | 324/358 [00:33<00:03,  9.63it/s] 91%|█████████ | 325/358 [00:33<00:03,  9.61it/s] 91%|█████████▏| 327/358 [00:33<00:03,  9.97it/s] 92%|█████████▏| 329/358 [00:33<00:02, 10.08it/s] 92%|█████████▏| 330/358 [00:33<00:02,  9.97it/s] 93%|█████████▎| 332/358 [00:33<00:02, 10.07it/s] 93%|█████████▎| 334/358 [00:34<00:02,  9.97it/s] 94%|█████████▎| 335/358 [00:34<00:02,  9.85it/s] 94%|█████████▍| 337/358 [00:34<00:02,  9.93it/s] 95%|█████████▍| 339/358 [00:34<00:01, 10.13it/s] 95%|█████████▌| 341/358 [00:34<00:01, 10.07it/s] 96%|█████████▌| 343/358 [00:34<00:01,  9.91it/s] 96%|█████████▌| 344/358 [00:35<00:01,  9.85it/s] 96%|█████████▋| 345/358 [00:35<00:01,  9.87it/s] 97%|█████████▋| 347/358 [00:35<00:01, 10.05it/s] 97%|█████████▋| 349/358 [00:35<00:00,  9.89it/s] 98%|█████████▊| 350/358 [00:35<00:00,  9.83it/s] 98%|█████████▊| 351/358 [00:35<00:00,  9.78it/s] 99%|█████████▊| 353/358 [00:35<00:00,  9.94it/s] 99%|█████████▉| 354/358 [00:36<00:00,  9.92it/s] 99%|█████████▉| 355/358 [00:36<00:00,  9.84it/s]100%|█████████▉| 357/358 [00:36<00:00,  9.89it/s]100%|██████████| 358/358 [00:36<00:00,  9.83it/s]
[32m2025-02-05 06:17:05.319[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    gen_loss  grad clip ratio  grad norm   ppl
       1.837                1      2.508 6.278[0m
[32m2025-02-05 06:17:05.319[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m169[0m - [1m[Valid][0m
  0%|          | 0/10256 [00:00<?, ?it/s]100%|██████████| 10256/10256 [00:00<00:00, 1109022.94it/s]
[32m2025-02-05 06:17:05.329[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:27,  1.44it/s]  5%|▌         | 2/40 [00:01<00:26,  1.46it/s]  8%|▊         | 3/40 [00:02<00:25,  1.46it/s] 10%|█         | 4/40 [00:02<00:24,  1.46it/s] 12%|█▎        | 5/40 [00:03<00:24,  1.45it/s] 15%|█▌        | 6/40 [00:04<00:23,  1.45it/s] 18%|█▊        | 7/40 [00:04<00:22,  1.45it/s] 20%|██        | 8/40 [00:05<00:21,  1.46it/s] 22%|██▎       | 9/40 [00:06<00:21,  1.46it/s] 25%|██▌       | 10/40 [00:06<00:20,  1.46it/s] 28%|██▊       | 11/40 [00:07<00:19,  1.46it/s] 30%|███       | 12/40 [00:08<00:19,  1.46it/s] 32%|███▎      | 13/40 [00:08<00:18,  1.46it/s] 35%|███▌      | 14/40 [00:09<00:17,  1.45it/s] 38%|███▊      | 15/40 [00:10<00:17,  1.45it/s] 40%|████      | 16/40 [00:10<00:16,  1.45it/s] 42%|████▎     | 17/40 [00:11<00:15,  1.46it/s] 45%|████▌     | 18/40 [00:12<00:15,  1.45it/s] 48%|████▊     | 19/40 [00:13<00:14,  1.45it/s] 50%|█████     | 20/40 [00:13<00:13,  1.46it/s] 52%|█████▎    | 21/40 [00:14<00:12,  1.46it/s] 55%|█████▌    | 22/40 [00:15<00:12,  1.46it/s] 57%|█████▊    | 23/40 [00:15<00:11,  1.46it/s] 60%|██████    | 24/40 [00:16<00:11,  1.45it/s] 62%|██████▎   | 25/40 [00:17<00:10,  1.45it/s] 65%|██████▌   | 26/40 [00:17<00:09,  1.46it/s] 68%|██████▊   | 27/40 [00:18<00:08,  1.46it/s] 70%|███████   | 28/40 [00:19<00:08,  1.46it/s] 72%|███████▎  | 29/40 [00:19<00:07,  1.46it/s] 75%|███████▌  | 30/40 [00:20<00:06,  1.47it/s] 78%|███████▊  | 31/40 [00:21<00:06,  1.46it/s] 80%|████████  | 32/40 [00:21<00:05,  1.46it/s] 82%|████████▎ | 33/40 [00:22<00:04,  1.46it/s] 85%|████████▌ | 34/40 [00:23<00:04,  1.46it/s] 88%|████████▊ | 35/40 [00:24<00:03,  1.46it/s] 90%|█████████ | 36/40 [00:24<00:02,  1.45it/s] 92%|█████████▎| 37/40 [00:25<00:02,  1.46it/s] 95%|█████████▌| 38/40 [00:26<00:01,  1.45it/s] 98%|█████████▊| 39/40 [00:26<00:00,  1.45it/s]100%|██████████| 40/40 [00:27<00:00,  1.60it/s]100%|██████████| 40/40 [00:27<00:00,  1.47it/s]
[32m2025-02-05 06:17:32.611[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    average  bleu@1  bleu@2  bleu@3  bleu@4  dist@1  dist@2  dist@3  dist@4  extreme  \
      .7821   .2996   .1076  .03868  .01942  .04612   .3152   .6087   .7819    .5968   
      f1  gen_loss  greedy  intra_dist@1  intra_dist@2  intra_dist@3  intra_dist@4  \
   .3513     5.175   .6687         .8700         .9732         .9631         .9230   
     ppl  rouge1  rouge2  rougeL  
   176.9   .3829  .08634   .3710[0m
[32m2025-02-05 06:17:32.618[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m163[0m - [1m[Conversation epoch 65][0m
[32m2025-02-05 06:17:32.618[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m164[0m - [1m[Train][0m
  0%|          | 0/92414 [00:00<?, ?it/s]100%|██████████| 92414/92414 [00:00<00:00, 1001608.34it/s]
[32m2025-02-05 06:17:32.710[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/358 [00:00<?, ?it/s]  0%|          | 1/358 [00:00<00:36,  9.75it/s]  1%|          | 3/358 [00:00<00:35,  9.94it/s]  1%|          | 4/358 [00:00<00:35,  9.92it/s]  2%|▏         | 6/358 [00:00<00:35,  9.89it/s]  2%|▏         | 7/358 [00:00<00:35,  9.82it/s]  2%|▏         | 8/358 [00:00<00:35,  9.86it/s]  3%|▎         | 9/358 [00:00<00:35,  9.76it/s]  3%|▎         | 10/358 [00:01<00:35,  9.76it/s]  3%|▎         | 11/358 [00:01<00:35,  9.71it/s]  4%|▎         | 13/358 [00:01<00:34,  9.93it/s]  4%|▍         | 14/358 [00:01<00:34,  9.85it/s]  4%|▍         | 15/358 [00:01<00:35,  9.78it/s]  4%|▍         | 16/358 [00:01<00:35,  9.71it/s]  5%|▍         | 17/358 [00:01<00:35,  9.73it/s]  5%|▌         | 19/358 [00:01<00:34,  9.76it/s]  6%|▌         | 20/358 [00:02<00:34,  9.71it/s]  6%|▌         | 21/358 [00:02<00:34,  9.64it/s]  6%|▌         | 22/358 [00:02<00:34,  9.70it/s]  7%|▋         | 24/358 [00:02<00:34,  9.78it/s]  7%|▋         | 25/358 [00:02<00:34,  9.73it/s]  7%|▋         | 26/358 [00:02<00:34,  9.68it/s]  8%|▊         | 27/358 [00:02<00:34,  9.73it/s]  8%|▊         | 28/358 [00:02<00:34,  9.69it/s]  8%|▊         | 29/358 [00:02<00:34,  9.65it/s]  9%|▊         | 31/358 [00:03<00:33,  9.75it/s]  9%|▉         | 32/358 [00:03<00:33,  9.75it/s]  9%|▉         | 34/358 [00:03<00:32,  9.85it/s] 10%|█         | 36/358 [00:03<00:32,  9.85it/s] 10%|█         | 37/358 [00:03<00:32,  9.83it/s] 11%|█         | 38/358 [00:03<00:32,  9.79it/s] 11%|█         | 40/358 [00:04<00:31,  9.95it/s] 11%|█▏        | 41/358 [00:04<00:32,  9.87it/s] 12%|█▏        | 43/358 [00:04<00:31,  9.89it/s] 13%|█▎        | 45/358 [00:04<00:31,  9.99it/s] 13%|█▎        | 47/358 [00:04<00:31,  9.96it/s] 13%|█▎        | 48/358 [00:04<00:31,  9.95it/s] 14%|█▍        | 50/358 [00:05<00:31,  9.91it/s] 14%|█▍        | 51/358 [00:05<00:31,  9.85it/s] 15%|█▍        | 52/358 [00:05<00:31,  9.76it/s] 15%|█▍        | 53/358 [00:05<00:31,  9.71it/s] 15%|█▌        | 54/358 [00:05<00:31,  9.75it/s] 15%|█▌        | 55/358 [00:05<00:31,  9.70it/s] 16%|█▌        | 56/358 [00:05<00:31,  9.74it/s] 16%|█▌        | 57/358 [00:05<00:31,  9.70it/s] 16%|█▌        | 58/358 [00:05<00:31,  9.68it/s] 16%|█▋        | 59/358 [00:06<00:30,  9.65it/s] 17%|█▋        | 61/358 [00:06<00:30,  9.73it/s] 17%|█▋        | 62/358 [00:06<00:30,  9.65it/s] 18%|█▊        | 63/358 [00:06<00:30,  9.72it/s] 18%|█▊        | 64/358 [00:06<00:30,  9.67it/s] 18%|█▊        | 66/358 [00:06<00:29,  9.74it/s] 19%|█▊        | 67/358 [00:06<00:29,  9.73it/s] 19%|█▉        | 69/358 [00:07<00:29,  9.79it/s] 20%|█▉        | 70/358 [00:07<00:29,  9.74it/s] 20%|█▉        | 71/358 [00:07<00:29,  9.78it/s] 20%|██        | 72/358 [00:07<00:29,  9.73it/s] 20%|██        | 73/358 [00:07<00:29,  9.70it/s] 21%|██        | 74/358 [00:07<00:29,  9.66it/s] 21%|██        | 75/358 [00:07<00:29,  9.63it/s] 22%|██▏       | 77/358 [00:07<00:28,  9.71it/s] 22%|██▏       | 79/358 [00:08<00:28,  9.71it/s] 23%|██▎       | 81/358 [00:08<00:28,  9.76it/s] 23%|██▎       | 83/358 [00:08<00:28,  9.79it/s] 23%|██▎       | 84/358 [00:08<00:28,  9.74it/s] 24%|██▎       | 85/358 [00:08<00:28,  9.70it/s] 24%|██▍       | 86/358 [00:08<00:28,  9.68it/s] 24%|██▍       | 87/358 [00:08<00:28,  9.66it/s] 25%|██▍       | 88/358 [00:09<00:27,  9.68it/s] 25%|██▌       | 90/358 [00:09<00:27,  9.92it/s] 26%|██▌       | 92/358 [00:09<00:26, 10.02it/s] 26%|██▌       | 93/358 [00:09<00:26,  9.98it/s] 26%|██▋       | 94/358 [00:09<00:26,  9.89it/s] 27%|██▋       | 96/358 [00:09<00:25, 10.17it/s] 27%|██▋       | 98/358 [00:09<00:25, 10.06it/s] 28%|██▊       | 100/358 [00:10<00:25, 10.01it/s] 28%|██▊       | 101/358 [00:10<00:25,  9.92it/s] 29%|██▉       | 103/358 [00:10<00:25,  9.91it/s] 29%|██▉       | 104/358 [00:10<00:25,  9.87it/s] 29%|██▉       | 105/358 [00:10<00:25,  9.79it/s] 30%|██▉       | 106/358 [00:10<00:25,  9.77it/s] 30%|███       | 108/358 [00:11<00:25,  9.81it/s] 30%|███       | 109/358 [00:11<00:25,  9.72it/s] 31%|███       | 110/358 [00:11<00:25,  9.70it/s] 31%|███       | 111/358 [00:11<00:25,  9.66it/s] 32%|███▏      | 113/358 [00:11<00:24,  9.92it/s] 32%|███▏      | 114/358 [00:11<00:24,  9.88it/s] 32%|███▏      | 115/358 [00:11<00:24,  9.79it/s] 32%|███▏      | 116/358 [00:11<00:24,  9.70it/s] 33%|███▎      | 117/358 [00:11<00:24,  9.67it/s] 33%|███▎      | 119/358 [00:12<00:24,  9.79it/s] 34%|███▍      | 121/358 [00:12<00:23,  9.99it/s] 34%|███▍      | 123/358 [00:12<00:23, 10.09it/s] 35%|███▍      | 125/358 [00:12<00:23, 10.07it/s] 35%|███▌      | 127/358 [00:12<00:23, 10.00it/s] 36%|███▌      | 128/358 [00:13<00:23,  9.95it/s] 36%|███▋      | 130/358 [00:13<00:22, 10.00it/s] 37%|███▋      | 131/358 [00:13<00:22,  9.91it/s] 37%|███▋      | 132/358 [00:13<00:22,  9.93it/s] 37%|███▋      | 134/358 [00:13<00:22,  9.95it/s] 38%|███▊      | 135/358 [00:13<00:22,  9.89it/s] 38%|███▊      | 137/358 [00:13<00:22,  9.97it/s] 39%|███▊      | 138/358 [00:14<00:22,  9.95it/s] 39%|███▉      | 139/358 [00:14<00:22,  9.86it/s] 39%|███▉      | 141/358 [00:14<00:21,  9.99it/s] 40%|███▉      | 142/358 [00:14<00:21,  9.91it/s] 40%|███▉      | 143/358 [00:14<00:21,  9.88it/s] 40%|████      | 144/358 [00:14<00:21,  9.79it/s] 41%|████      | 145/358 [00:14<00:21,  9.81it/s] 41%|████      | 146/358 [00:14<00:21,  9.75it/s] 41%|████      | 147/358 [00:14<00:21,  9.69it/s] 41%|████▏     | 148/358 [00:15<00:21,  9.72it/s] 42%|████▏     | 149/358 [00:15<00:21,  9.70it/s] 42%|████▏     | 150/358 [00:15<00:21,  9.66it/s] 42%|████▏     | 151/358 [00:15<00:22,  9.40it/s] 42%|████▏     | 152/358 [00:15<00:21,  9.44it/s] 43%|████▎     | 153/358 [00:15<00:21,  9.46it/s] 43%|████▎     | 154/358 [00:15<00:21,  9.55it/s] 43%|████▎     | 155/358 [00:15<00:21,  9.57it/s] 44%|████▍     | 157/358 [00:16<00:20,  9.65it/s] 44%|████▍     | 158/358 [00:16<00:20,  9.72it/s] 44%|████▍     | 159/358 [00:16<00:20,  9.71it/s] 45%|████▍     | 160/358 [00:16<00:20,  9.72it/s] 45%|████▌     | 162/358 [00:16<00:19, 10.00it/s] 46%|████▌     | 164/358 [00:16<00:19, 10.00it/s] 46%|████▌     | 165/358 [00:16<00:19,  9.96it/s] 47%|████▋     | 167/358 [00:17<00:19,  9.91it/s] 47%|████▋     | 169/358 [00:17<00:18,  9.95it/s] 48%|████▊     | 171/358 [00:17<00:18,  9.94it/s] 48%|████▊     | 172/358 [00:17<00:18,  9.88it/s] 48%|████▊     | 173/358 [00:17<00:18,  9.82it/s] 49%|████▉     | 175/358 [00:17<00:18,  9.85it/s] 49%|████▉     | 176/358 [00:17<00:18,  9.86it/s] 49%|████▉     | 177/358 [00:18<00:18,  9.85it/s] 50%|█████     | 179/358 [00:18<00:18,  9.87it/s] 50%|█████     | 180/358 [00:18<00:18,  9.79it/s] 51%|█████     | 182/358 [00:18<00:17,  9.95it/s] 51%|█████     | 183/358 [00:18<00:17,  9.90it/s] 51%|█████▏    | 184/358 [00:18<00:17,  9.79it/s] 52%|█████▏    | 185/358 [00:18<00:17,  9.73it/s] 52%|█████▏    | 187/358 [00:19<00:17,  9.95it/s] 53%|█████▎    | 188/358 [00:19<00:17,  9.90it/s] 53%|█████▎    | 189/358 [00:19<00:17,  9.84it/s] 53%|█████▎    | 191/358 [00:19<00:17,  9.76it/s] 54%|█████▎    | 192/358 [00:19<00:17,  9.71it/s] 54%|█████▍    | 193/358 [00:19<00:17,  9.70it/s] 54%|█████▍    | 194/358 [00:19<00:16,  9.68it/s] 54%|█████▍    | 195/358 [00:19<00:16,  9.75it/s] 55%|█████▌    | 197/358 [00:20<00:16,  9.92it/s] 55%|█████▌    | 198/358 [00:20<00:16,  9.85it/s] 56%|█████▌    | 199/358 [00:20<00:16,  9.88it/s] 56%|█████▌    | 200/358 [00:20<00:16,  9.82it/s] 56%|█████▌    | 201/358 [00:20<00:16,  9.78it/s] 57%|█████▋    | 203/358 [00:20<00:15,  9.86it/s] 57%|█████▋    | 204/358 [00:20<00:15,  9.76it/s] 57%|█████▋    | 205/358 [00:20<00:15,  9.72it/s] 58%|█████▊    | 207/358 [00:21<00:15,  9.88it/s] 58%|█████▊    | 208/358 [00:21<00:15,  9.81it/s] 59%|█████▊    | 210/358 [00:21<00:15,  9.83it/s] 59%|█████▉    | 212/358 [00:21<00:14,  9.82it/s] 60%|█████▉    | 214/358 [00:21<00:14,  9.90it/s] 60%|██████    | 215/358 [00:21<00:14,  9.84it/s] 60%|██████    | 216/358 [00:22<00:14,  9.77it/s] 61%|██████    | 217/358 [00:22<00:14,  9.81it/s] 61%|██████    | 218/358 [00:22<00:14,  9.78it/s] 61%|██████    | 219/358 [00:22<00:14,  9.78it/s] 62%|██████▏   | 221/358 [00:22<00:13,  9.92it/s] 62%|██████▏   | 222/358 [00:22<00:13,  9.81it/s] 62%|██████▏   | 223/358 [00:22<00:13,  9.76it/s] 63%|██████▎   | 224/358 [00:22<00:13,  9.70it/s] 63%|██████▎   | 226/358 [00:23<00:13,  9.74it/s] 64%|██████▎   | 228/358 [00:23<00:13,  9.77it/s] 64%|██████▍   | 229/358 [00:23<00:13,  9.74it/s] 64%|██████▍   | 230/358 [00:23<00:13,  9.69it/s] 65%|██████▍   | 232/358 [00:23<00:12,  9.75it/s] 65%|██████▌   | 234/358 [00:23<00:12, 10.03it/s] 66%|██████▌   | 236/358 [00:24<00:12,  9.99it/s] 66%|██████▋   | 238/358 [00:24<00:11, 10.04it/s] 67%|██████▋   | 240/358 [00:24<00:11, 10.00it/s] 68%|██████▊   | 242/358 [00:24<00:11,  9.98it/s] 68%|██████▊   | 243/358 [00:24<00:11,  9.92it/s] 68%|██████▊   | 244/358 [00:24<00:11,  9.86it/s] 69%|██████▊   | 246/358 [00:25<00:11,  9.88it/s] 69%|██████▉   | 247/358 [00:25<00:11,  9.80it/s] 69%|██████▉   | 248/358 [00:25<00:11,  9.76it/s] 70%|██████▉   | 250/358 [00:25<00:10,  9.86it/s] 70%|███████   | 251/358 [00:25<00:10,  9.80it/s] 70%|███████   | 252/358 [00:25<00:10,  9.73it/s] 71%|███████   | 253/358 [00:25<00:10,  9.69it/s] 71%|███████   | 254/358 [00:25<00:10,  9.66it/s] 72%|███████▏  | 256/358 [00:26<00:10,  9.84it/s] 72%|███████▏  | 257/358 [00:26<00:10,  9.85it/s] 72%|███████▏  | 258/358 [00:26<00:10,  9.72it/s] 72%|███████▏  | 259/358 [00:26<00:10,  9.69it/s] 73%|███████▎  | 260/358 [00:26<00:10,  9.72it/s] 73%|███████▎  | 262/358 [00:26<00:09,  9.90it/s] 74%|███████▎  | 264/358 [00:26<00:09,  9.92it/s] 74%|███████▍  | 266/358 [00:27<00:09,  9.91it/s] 75%|███████▍  | 267/358 [00:27<00:09,  9.85it/s] 75%|███████▌  | 269/358 [00:27<00:08,  9.91it/s] 75%|███████▌  | 270/358 [00:27<00:08,  9.84it/s] 76%|███████▌  | 271/358 [00:27<00:08,  9.77it/s] 76%|███████▌  | 272/358 [00:27<00:08,  9.74it/s] 76%|███████▋  | 273/358 [00:27<00:08,  9.64it/s] 77%|███████▋  | 274/358 [00:27<00:08,  9.64it/s] 77%|███████▋  | 275/358 [00:28<00:08,  9.69it/s] 77%|███████▋  | 276/358 [00:28<00:08,  9.69it/s] 77%|███████▋  | 277/358 [00:28<00:08,  9.66it/s] 78%|███████▊  | 278/358 [00:28<00:08,  9.64it/s] 78%|███████▊  | 280/358 [00:28<00:07,  9.83it/s] 78%|███████▊  | 281/358 [00:28<00:07,  9.84it/s] 79%|███████▉  | 282/358 [00:28<00:07,  9.78it/s] 79%|███████▉  | 283/358 [00:28<00:07,  9.72it/s] 79%|███████▉  | 284/358 [00:28<00:07,  9.68it/s] 80%|███████▉  | 285/358 [00:29<00:07,  9.75it/s] 80%|███████▉  | 286/358 [00:29<00:07,  9.70it/s] 80%|████████  | 287/358 [00:29<00:07,  9.68it/s] 80%|████████  | 288/358 [00:29<00:07,  9.64it/s] 81%|████████  | 290/358 [00:29<00:06,  9.85it/s] 81%|████████▏ | 291/358 [00:29<00:06,  9.84it/s] 82%|████████▏ | 293/358 [00:29<00:06,  9.85it/s] 82%|████████▏ | 295/358 [00:30<00:06,  9.92it/s] 83%|████████▎ | 296/358 [00:30<00:06,  9.85it/s] 83%|████████▎ | 297/358 [00:30<00:06,  9.74it/s] 84%|████████▎ | 299/358 [00:30<00:05,  9.90it/s] 84%|████████▍ | 301/358 [00:30<00:05,  9.94it/s] 84%|████████▍ | 302/358 [00:30<00:05,  9.88it/s] 85%|████████▍ | 303/358 [00:30<00:05,  9.88it/s] 85%|████████▌ | 305/358 [00:31<00:05,  9.91it/s] 85%|████████▌ | 306/358 [00:31<00:05,  9.84it/s] 86%|████████▌ | 308/358 [00:31<00:05,  9.93it/s] 86%|████████▋ | 309/358 [00:31<00:04,  9.83it/s] 87%|████████▋ | 310/358 [00:31<00:04,  9.78it/s] 87%|████████▋ | 311/358 [00:31<00:04,  9.70it/s] 87%|████████▋ | 312/358 [00:31<00:04,  9.72it/s] 87%|████████▋ | 313/358 [00:31<00:04,  9.74it/s] 88%|████████▊ | 315/358 [00:32<00:04,  9.99it/s] 88%|████████▊ | 316/358 [00:32<00:04,  9.94it/s] 89%|████████▊ | 317/358 [00:32<00:04,  9.86it/s] 89%|████████▉ | 318/358 [00:32<00:04,  9.82it/s] 89%|████████▉ | 319/358 [00:32<00:03,  9.77it/s] 89%|████████▉ | 320/358 [00:32<00:03,  9.83it/s] 90%|████████▉ | 321/358 [00:32<00:03,  9.75it/s] 90%|████████▉ | 322/358 [00:32<00:03,  9.72it/s] 90%|█████████ | 323/358 [00:32<00:03,  9.66it/s] 91%|█████████ | 324/358 [00:33<00:03,  9.64it/s] 91%|█████████ | 325/358 [00:33<00:03,  9.62it/s] 91%|█████████▏| 327/358 [00:33<00:03,  9.98it/s] 92%|█████████▏| 329/358 [00:33<00:02, 10.08it/s] 92%|█████████▏| 330/358 [00:33<00:02,  9.97it/s] 93%|█████████▎| 332/358 [00:33<00:02, 10.07it/s] 93%|█████████▎| 334/358 [00:34<00:02,  9.97it/s] 94%|█████████▎| 335/358 [00:34<00:02,  9.85it/s] 94%|█████████▍| 337/358 [00:34<00:02,  9.93it/s] 95%|█████████▍| 339/358 [00:34<00:01, 10.13it/s] 95%|█████████▌| 341/358 [00:34<00:01, 10.07it/s] 96%|█████████▌| 343/358 [00:34<00:01,  9.90it/s] 96%|█████████▌| 344/358 [00:35<00:01,  9.85it/s] 96%|█████████▋| 345/358 [00:35<00:01,  9.87it/s] 97%|█████████▋| 347/358 [00:35<00:01, 10.04it/s] 97%|█████████▋| 348/358 [00:35<00:01,  9.95it/s] 97%|█████████▋| 349/358 [00:35<00:00,  9.87it/s] 98%|█████████▊| 350/358 [00:35<00:00,  9.79it/s] 98%|█████████▊| 351/358 [00:35<00:00,  9.75it/s] 99%|█████████▊| 353/358 [00:35<00:00,  9.93it/s] 99%|█████████▉| 354/358 [00:36<00:00,  9.91it/s] 99%|█████████▉| 355/358 [00:36<00:00,  9.82it/s]100%|█████████▉| 357/358 [00:36<00:00,  9.88it/s]100%|██████████| 358/358 [00:36<00:00,  9.84it/s]
[32m2025-02-05 06:18:09.113[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    gen_loss  grad clip ratio  grad norm   ppl
       1.832                1       2.59 6.249[0m
[32m2025-02-05 06:18:09.114[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m169[0m - [1m[Valid][0m
  0%|          | 0/10256 [00:00<?, ?it/s]100%|██████████| 10256/10256 [00:00<00:00, 1118510.15it/s]
[32m2025-02-05 06:18:09.123[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:26,  1.46it/s]  5%|▌         | 2/40 [00:01<00:25,  1.47it/s]  8%|▊         | 3/40 [00:02<00:25,  1.48it/s] 10%|█         | 4/40 [00:02<00:24,  1.48it/s] 12%|█▎        | 5/40 [00:03<00:23,  1.47it/s] 15%|█▌        | 6/40 [00:04<00:23,  1.47it/s] 18%|█▊        | 7/40 [00:04<00:22,  1.47it/s] 20%|██        | 8/40 [00:05<00:21,  1.47it/s] 22%|██▎       | 9/40 [00:06<00:21,  1.47it/s] 25%|██▌       | 10/40 [00:06<00:20,  1.48it/s] 28%|██▊       | 11/40 [00:07<00:19,  1.48it/s] 30%|███       | 12/40 [00:08<00:18,  1.47it/s] 32%|███▎      | 13/40 [00:08<00:18,  1.47it/s] 35%|███▌      | 14/40 [00:09<00:17,  1.46it/s] 38%|███▊      | 15/40 [00:10<00:17,  1.47it/s] 40%|████      | 16/40 [00:10<00:16,  1.46it/s] 42%|████▎     | 17/40 [00:11<00:15,  1.47it/s] 45%|████▌     | 18/40 [00:12<00:14,  1.47it/s] 48%|████▊     | 19/40 [00:12<00:14,  1.47it/s] 50%|█████     | 20/40 [00:13<00:13,  1.47it/s] 52%|█████▎    | 21/40 [00:14<00:12,  1.48it/s] 55%|█████▌    | 22/40 [00:14<00:12,  1.47it/s] 57%|█████▊    | 23/40 [00:15<00:11,  1.47it/s] 60%|██████    | 24/40 [00:16<00:10,  1.47it/s] 62%|██████▎   | 25/40 [00:16<00:10,  1.47it/s] 65%|██████▌   | 26/40 [00:17<00:09,  1.48it/s] 68%|██████▊   | 27/40 [00:18<00:08,  1.47it/s] 70%|███████   | 28/40 [00:19<00:08,  1.48it/s] 72%|███████▎  | 29/40 [00:19<00:07,  1.47it/s] 75%|███████▌  | 30/40 [00:20<00:06,  1.48it/s] 78%|███████▊  | 31/40 [00:21<00:06,  1.48it/s] 80%|████████  | 32/40 [00:21<00:05,  1.48it/s] 82%|████████▎ | 33/40 [00:22<00:04,  1.47it/s] 85%|████████▌ | 34/40 [00:23<00:04,  1.47it/s] 88%|████████▊ | 35/40 [00:23<00:03,  1.47it/s] 90%|█████████ | 36/40 [00:24<00:02,  1.46it/s] 92%|█████████▎| 37/40 [00:25<00:02,  1.46it/s] 95%|█████████▌| 38/40 [00:25<00:01,  1.45it/s] 98%|█████████▊| 39/40 [00:26<00:00,  1.45it/s]100%|██████████| 40/40 [00:27<00:00,  1.61it/s]100%|██████████| 40/40 [00:27<00:00,  1.48it/s]
[32m2025-02-05 06:18:36.138[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    average  bleu@1  bleu@2  bleu@3  bleu@4  dist@1  dist@2  dist@3  dist@4  extreme  \
      .7804   .2985   .1087  .03966  .01915  .04893   .3211   .6092   .7798    .5984   
      f1  gen_loss  greedy  intra_dist@1  intra_dist@2  intra_dist@3  intra_dist@4  \
   .3555     5.209   .6687         .8817         .9764         .9616         .9191   
    ppl  rouge1  rouge2  rougeL  
    183   .3844  .08804   .3726[0m
[32m2025-02-05 06:18:36.143[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m163[0m - [1m[Conversation epoch 66][0m
[32m2025-02-05 06:18:36.143[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m164[0m - [1m[Train][0m
  0%|          | 0/92414 [00:00<?, ?it/s]100%|██████████| 92414/92414 [00:00<00:00, 997705.07it/s]
[32m2025-02-05 06:18:36.236[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/358 [00:00<?, ?it/s]  0%|          | 1/358 [00:00<00:36,  9.75it/s]  1%|          | 3/358 [00:00<00:35,  9.94it/s]  1%|          | 4/358 [00:00<00:35,  9.92it/s]  2%|▏         | 6/358 [00:00<00:35,  9.88it/s]  2%|▏         | 7/358 [00:00<00:35,  9.82it/s]  2%|▏         | 8/358 [00:00<00:35,  9.86it/s]  3%|▎         | 9/358 [00:00<00:35,  9.76it/s]  3%|▎         | 10/358 [00:01<00:35,  9.75it/s]  3%|▎         | 11/358 [00:01<00:35,  9.70it/s]  4%|▎         | 13/358 [00:01<00:34,  9.92it/s]  4%|▍         | 14/358 [00:01<00:34,  9.85it/s]  4%|▍         | 15/358 [00:01<00:35,  9.78it/s]  4%|▍         | 16/358 [00:01<00:35,  9.71it/s]  5%|▍         | 17/358 [00:01<00:35,  9.73it/s]  5%|▌         | 19/358 [00:01<00:34,  9.75it/s]  6%|▌         | 20/358 [00:02<00:34,  9.70it/s]  6%|▌         | 21/358 [00:02<00:34,  9.64it/s]  6%|▌         | 22/358 [00:02<00:34,  9.69it/s]  7%|▋         | 24/358 [00:02<00:34,  9.78it/s]  7%|▋         | 25/358 [00:02<00:34,  9.73it/s]  7%|▋         | 26/358 [00:02<00:34,  9.68it/s]  8%|▊         | 27/358 [00:02<00:33,  9.74it/s]  8%|▊         | 28/358 [00:02<00:34,  9.69it/s]  8%|▊         | 29/358 [00:02<00:34,  9.66it/s]  9%|▊         | 31/358 [00:03<00:33,  9.76it/s]  9%|▉         | 32/358 [00:03<00:33,  9.76it/s]  9%|▉         | 34/358 [00:03<00:32,  9.86it/s] 10%|█         | 36/358 [00:03<00:32,  9.85it/s] 10%|█         | 37/358 [00:03<00:32,  9.84it/s] 11%|█         | 38/358 [00:03<00:32,  9.79it/s] 11%|█         | 40/358 [00:04<00:31,  9.95it/s] 11%|█▏        | 41/358 [00:04<00:32,  9.86it/s] 12%|█▏        | 43/358 [00:04<00:31,  9.89it/s] 13%|█▎        | 45/358 [00:04<00:31,  9.99it/s] 13%|█▎        | 47/358 [00:04<00:31,  9.96it/s] 13%|█▎        | 48/358 [00:04<00:31,  9.95it/s] 14%|█▍        | 50/358 [00:05<00:31,  9.92it/s] 14%|█▍        | 51/358 [00:05<00:31,  9.85it/s] 15%|█▍        | 52/358 [00:05<00:31,  9.76it/s] 15%|█▍        | 53/358 [00:05<00:31,  9.71it/s] 15%|█▌        | 54/358 [00:05<00:31,  9.75it/s] 15%|█▌        | 55/358 [00:05<00:31,  9.70it/s] 16%|█▌        | 56/358 [00:05<00:30,  9.74it/s] 16%|█▌        | 57/358 [00:05<00:31,  9.71it/s] 16%|█▌        | 58/358 [00:05<00:30,  9.68it/s] 16%|█▋        | 59/358 [00:06<00:30,  9.65it/s] 17%|█▋        | 61/358 [00:06<00:30,  9.74it/s] 17%|█▋        | 62/358 [00:06<00:30,  9.66it/s] 18%|█▊        | 63/358 [00:06<00:30,  9.72it/s] 18%|█▊        | 64/358 [00:06<00:30,  9.67it/s] 18%|█▊        | 66/358 [00:06<00:29,  9.74it/s] 19%|█▊        | 67/358 [00:06<00:29,  9.73it/s] 19%|█▉        | 69/358 [00:07<00:29,  9.79it/s] 20%|█▉        | 70/358 [00:07<00:29,  9.73it/s] 20%|█▉        | 71/358 [00:07<00:29,  9.78it/s] 20%|██        | 72/358 [00:07<00:29,  9.73it/s] 20%|██        | 73/358 [00:07<00:29,  9.70it/s] 21%|██        | 74/358 [00:07<00:29,  9.66it/s] 21%|██        | 75/358 [00:07<00:29,  9.63it/s] 21%|██        | 76/358 [00:07<00:28,  9.73it/s] 22%|██▏       | 77/358 [00:07<00:28,  9.70it/s] 22%|██▏       | 79/358 [00:08<00:28,  9.70it/s] 23%|██▎       | 81/358 [00:08<00:28,  9.76it/s] 23%|██▎       | 83/358 [00:08<00:28,  9.78it/s] 23%|██▎       | 84/358 [00:08<00:28,  9.73it/s] 24%|██▎       | 85/358 [00:08<00:28,  9.68it/s] 24%|██▍       | 86/358 [00:08<00:28,  9.67it/s] 24%|██▍       | 87/358 [00:08<00:28,  9.65it/s] 25%|██▍       | 88/358 [00:09<00:27,  9.67it/s] 25%|██▌       | 90/358 [00:09<00:27,  9.91it/s] 26%|██▌       | 92/358 [00:09<00:26, 10.01it/s] 26%|██▌       | 93/358 [00:09<00:26,  9.98it/s] 26%|██▋       | 94/358 [00:09<00:26,  9.89it/s] 27%|██▋       | 96/358 [00:09<00:25, 10.17it/s] 27%|██▋       | 98/358 [00:09<00:25, 10.06it/s] 28%|██▊       | 100/358 [00:10<00:25, 10.01it/s] 28%|██▊       | 101/358 [00:10<00:25,  9.92it/s] 29%|██▉       | 103/358 [00:10<00:25,  9.91it/s] 29%|██▉       | 104/358 [00:10<00:25,  9.86it/s] 29%|██▉       | 105/358 [00:10<00:25,  9.79it/s] 30%|██▉       | 106/358 [00:10<00:25,  9.77it/s] 30%|███       | 108/358 [00:11<00:25,  9.80it/s] 30%|███       | 109/358 [00:11<00:25,  9.72it/s] 31%|███       | 110/358 [00:11<00:25,  9.70it/s] 31%|███       | 111/358 [00:11<00:25,  9.66it/s] 32%|███▏      | 113/358 [00:11<00:24,  9.92it/s] 32%|███▏      | 114/358 [00:11<00:24,  9.88it/s] 32%|███▏      | 115/358 [00:11<00:24,  9.79it/s] 32%|███▏      | 116/358 [00:11<00:24,  9.70it/s] 33%|███▎      | 117/358 [00:11<00:24,  9.67it/s] 33%|███▎      | 119/358 [00:12<00:24,  9.79it/s] 34%|███▍      | 121/358 [00:12<00:23,  9.99it/s] 34%|███▍      | 123/358 [00:12<00:23, 10.09it/s] 35%|███▍      | 125/358 [00:12<00:23, 10.07it/s] 35%|███▌      | 127/358 [00:12<00:23, 10.00it/s] 36%|███▌      | 128/358 [00:13<00:23,  9.96it/s] 36%|███▋      | 130/358 [00:13<00:22, 10.00it/s] 37%|███▋      | 131/358 [00:13<00:22,  9.91it/s] 37%|███▋      | 132/358 [00:13<00:22,  9.93it/s] 37%|███▋      | 134/358 [00:13<00:22,  9.95it/s] 38%|███▊      | 135/358 [00:13<00:22,  9.89it/s] 38%|███▊      | 137/358 [00:13<00:22,  9.97it/s] 39%|███▊      | 138/358 [00:14<00:22,  9.95it/s] 39%|███▉      | 139/358 [00:14<00:22,  9.87it/s] 39%|███▉      | 141/358 [00:14<00:21,  9.99it/s] 40%|███▉      | 142/358 [00:14<00:21,  9.92it/s] 40%|███▉      | 143/358 [00:14<00:21,  9.88it/s] 40%|████      | 144/358 [00:14<00:21,  9.80it/s] 41%|████      | 145/358 [00:14<00:21,  9.82it/s] 41%|████      | 146/358 [00:14<00:21,  9.75it/s] 41%|████      | 147/358 [00:14<00:21,  9.69it/s] 41%|████▏     | 148/358 [00:15<00:21,  9.72it/s] 42%|████▏     | 149/358 [00:15<00:21,  9.70it/s] 42%|████▏     | 150/358 [00:15<00:21,  9.66it/s] 42%|████▏     | 151/358 [00:15<00:22,  9.39it/s] 42%|████▏     | 152/358 [00:15<00:21,  9.44it/s] 43%|████▎     | 153/358 [00:15<00:21,  9.46it/s] 43%|████▎     | 154/358 [00:15<00:21,  9.55it/s] 43%|████▎     | 155/358 [00:15<00:21,  9.56it/s] 44%|████▎     | 156/358 [00:15<00:20,  9.68it/s] 44%|████▍     | 157/358 [00:16<00:20,  9.63it/s] 44%|████▍     | 158/358 [00:16<00:20,  9.71it/s] 44%|████▍     | 159/358 [00:16<00:20,  9.71it/s] 45%|████▍     | 160/358 [00:16<00:20,  9.72it/s] 45%|████▌     | 162/358 [00:16<00:19, 10.01it/s] 46%|████▌     | 164/358 [00:16<00:19, 10.01it/s] 46%|████▌     | 165/358 [00:16<00:19,  9.97it/s] 47%|████▋     | 167/358 [00:17<00:19,  9.92it/s] 47%|████▋     | 169/358 [00:17<00:18,  9.96it/s] 48%|████▊     | 171/358 [00:17<00:18,  9.94it/s] 48%|████▊     | 172/358 [00:17<00:18,  9.89it/s] 48%|████▊     | 173/358 [00:17<00:18,  9.82it/s] 49%|████▉     | 175/358 [00:17<00:18,  9.85it/s] 49%|████▉     | 176/358 [00:17<00:18,  9.86it/s] 49%|████▉     | 177/358 [00:18<00:18,  9.84it/s] 50%|█████     | 179/358 [00:18<00:18,  9.87it/s] 50%|█████     | 180/358 [00:18<00:18,  9.80it/s] 51%|█████     | 182/358 [00:18<00:17,  9.95it/s] 51%|█████     | 183/358 [00:18<00:17,  9.90it/s] 51%|█████▏    | 184/358 [00:18<00:17,  9.79it/s] 52%|█████▏    | 185/358 [00:18<00:17,  9.73it/s] 52%|█████▏    | 187/358 [00:19<00:17,  9.95it/s] 53%|█████▎    | 188/358 [00:19<00:17,  9.90it/s] 53%|█████▎    | 189/358 [00:19<00:17,  9.84it/s] 53%|█████▎    | 191/358 [00:19<00:17,  9.76it/s] 54%|█████▎    | 192/358 [00:19<00:17,  9.71it/s] 54%|█████▍    | 193/358 [00:19<00:17,  9.70it/s] 54%|█████▍    | 194/358 [00:19<00:16,  9.68it/s] 54%|█████▍    | 195/358 [00:19<00:16,  9.75it/s] 55%|█████▌    | 197/358 [00:20<00:16,  9.92it/s] 55%|█████▌    | 198/358 [00:20<00:16,  9.85it/s] 56%|█████▌    | 199/358 [00:20<00:16,  9.88it/s] 56%|█████▌    | 200/358 [00:20<00:16,  9.81it/s] 56%|█████▌    | 201/358 [00:20<00:16,  9.77it/s] 57%|█████▋    | 203/358 [00:20<00:15,  9.86it/s] 57%|█████▋    | 204/358 [00:20<00:15,  9.75it/s] 57%|█████▋    | 205/358 [00:20<00:15,  9.71it/s] 58%|█████▊    | 207/358 [00:21<00:15,  9.88it/s] 58%|█████▊    | 208/358 [00:21<00:15,  9.81it/s] 59%|█████▊    | 210/358 [00:21<00:15,  9.83it/s] 59%|█████▉    | 212/358 [00:21<00:14,  9.82it/s] 60%|█████▉    | 214/358 [00:21<00:14,  9.90it/s] 60%|██████    | 215/358 [00:21<00:14,  9.83it/s] 60%|██████    | 216/358 [00:22<00:14,  9.77it/s] 61%|██████    | 217/358 [00:22<00:14,  9.81it/s] 61%|██████    | 218/358 [00:22<00:14,  9.78it/s] 61%|██████    | 219/358 [00:22<00:14,  9.78it/s] 62%|██████▏   | 221/358 [00:22<00:13,  9.91it/s] 62%|██████▏   | 222/358 [00:22<00:13,  9.81it/s] 62%|██████▏   | 223/358 [00:22<00:13,  9.75it/s] 63%|██████▎   | 224/358 [00:22<00:13,  9.69it/s] 63%|██████▎   | 226/358 [00:23<00:13,  9.74it/s] 64%|██████▎   | 228/358 [00:23<00:13,  9.77it/s] 64%|██████▍   | 229/358 [00:23<00:13,  9.74it/s] 64%|██████▍   | 230/358 [00:23<00:13,  9.69it/s] 65%|██████▍   | 232/358 [00:23<00:12,  9.74it/s] 65%|██████▌   | 234/358 [00:23<00:12, 10.02it/s] 66%|██████▌   | 236/358 [00:24<00:12,  9.99it/s] 66%|██████▋   | 238/358 [00:24<00:11, 10.04it/s] 67%|██████▋   | 240/358 [00:24<00:11, 10.00it/s] 68%|██████▊   | 242/358 [00:24<00:11,  9.98it/s] 68%|██████▊   | 243/358 [00:24<00:11,  9.92it/s] 68%|██████▊   | 244/358 [00:24<00:11,  9.85it/s] 69%|██████▊   | 246/358 [00:25<00:11,  9.88it/s] 69%|██████▉   | 247/358 [00:25<00:11,  9.80it/s] 69%|██████▉   | 248/358 [00:25<00:11,  9.76it/s] 70%|██████▉   | 250/358 [00:25<00:10,  9.86it/s] 70%|███████   | 251/358 [00:25<00:10,  9.80it/s] 70%|███████   | 252/358 [00:25<00:10,  9.73it/s] 71%|███████   | 253/358 [00:25<00:10,  9.70it/s] 71%|███████   | 254/358 [00:25<00:10,  9.67it/s] 72%|███████▏  | 256/358 [00:26<00:10,  9.85it/s] 72%|███████▏  | 257/358 [00:26<00:10,  9.85it/s] 72%|███████▏  | 258/358 [00:26<00:10,  9.72it/s] 72%|███████▏  | 259/358 [00:26<00:10,  9.69it/s] 73%|███████▎  | 260/358 [00:26<00:10,  9.72it/s] 73%|███████▎  | 262/358 [00:26<00:09,  9.90it/s] 74%|███████▎  | 264/358 [00:26<00:09,  9.92it/s] 74%|███████▍  | 266/358 [00:27<00:09,  9.91it/s] 75%|███████▍  | 267/358 [00:27<00:09,  9.85it/s] 75%|███████▌  | 269/358 [00:27<00:08,  9.91it/s] 75%|███████▌  | 270/358 [00:27<00:08,  9.84it/s] 76%|███████▌  | 271/358 [00:27<00:08,  9.76it/s] 76%|███████▌  | 272/358 [00:27<00:08,  9.74it/s] 76%|███████▋  | 273/358 [00:27<00:08,  9.64it/s] 77%|███████▋  | 274/358 [00:27<00:08,  9.64it/s] 77%|███████▋  | 275/358 [00:28<00:08,  9.69it/s] 77%|███████▋  | 276/358 [00:28<00:08,  9.69it/s] 77%|███████▋  | 277/358 [00:28<00:08,  9.66it/s] 78%|███████▊  | 278/358 [00:28<00:08,  9.64it/s] 78%|███████▊  | 280/358 [00:28<00:07,  9.83it/s] 78%|███████▊  | 281/358 [00:28<00:07,  9.84it/s] 79%|███████▉  | 282/358 [00:28<00:07,  9.77it/s] 79%|███████▉  | 283/358 [00:28<00:07,  9.71it/s] 79%|███████▉  | 284/358 [00:28<00:07,  9.68it/s] 80%|███████▉  | 285/358 [00:29<00:07,  9.74it/s] 80%|███████▉  | 286/358 [00:29<00:07,  9.70it/s] 80%|████████  | 287/358 [00:29<00:07,  9.68it/s] 80%|████████  | 288/358 [00:29<00:07,  9.64it/s] 81%|████████  | 290/358 [00:29<00:06,  9.85it/s] 81%|████████▏ | 291/358 [00:29<00:06,  9.84it/s] 82%|████████▏ | 293/358 [00:29<00:06,  9.85it/s] 82%|████████▏ | 295/358 [00:30<00:06,  9.92it/s] 83%|████████▎ | 296/358 [00:30<00:06,  9.86it/s] 83%|████████▎ | 297/358 [00:30<00:06,  9.74it/s] 84%|████████▎ | 299/358 [00:30<00:05,  9.90it/s] 84%|████████▍ | 301/358 [00:30<00:05,  9.94it/s] 84%|████████▍ | 302/358 [00:30<00:05,  9.88it/s] 85%|████████▍ | 303/358 [00:30<00:05,  9.88it/s] 85%|████████▌ | 305/358 [00:31<00:05,  9.91it/s] 85%|████████▌ | 306/358 [00:31<00:05,  9.83it/s] 86%|████████▌ | 308/358 [00:31<00:05,  9.93it/s] 86%|████████▋ | 309/358 [00:31<00:04,  9.83it/s] 87%|████████▋ | 310/358 [00:31<00:04,  9.78it/s] 87%|████████▋ | 311/358 [00:31<00:04,  9.70it/s] 87%|████████▋ | 312/358 [00:31<00:04,  9.72it/s] 87%|████████▋ | 313/358 [00:31<00:04,  9.74it/s] 88%|████████▊ | 315/358 [00:32<00:04, 10.00it/s] 88%|████████▊ | 316/358 [00:32<00:04,  9.94it/s] 89%|████████▊ | 317/358 [00:32<00:04,  9.86it/s] 89%|████████▉ | 318/358 [00:32<00:04,  9.81it/s] 89%|████████▉ | 319/358 [00:32<00:03,  9.77it/s] 89%|████████▉ | 320/358 [00:32<00:03,  9.83it/s] 90%|████████▉ | 321/358 [00:32<00:03,  9.76it/s] 90%|████████▉ | 322/358 [00:32<00:03,  9.72it/s] 90%|█████████ | 323/358 [00:32<00:03,  9.67it/s] 91%|█████████ | 324/358 [00:33<00:03,  9.64it/s] 91%|█████████ | 325/358 [00:33<00:03,  9.62it/s] 91%|█████████▏| 327/358 [00:33<00:03,  9.98it/s] 92%|█████████▏| 329/358 [00:33<00:02, 10.08it/s] 92%|█████████▏| 330/358 [00:33<00:02,  9.97it/s] 93%|█████████▎| 332/358 [00:33<00:02, 10.07it/s] 93%|█████████▎| 334/358 [00:34<00:02,  9.97it/s] 94%|█████████▎| 335/358 [00:34<00:02,  9.85it/s] 94%|█████████▍| 337/358 [00:34<00:02,  9.93it/s] 95%|█████████▍| 339/358 [00:34<00:01, 10.13it/s] 95%|█████████▌| 341/358 [00:34<00:01, 10.07it/s] 96%|█████████▌| 343/358 [00:34<00:01,  9.91it/s] 96%|█████████▌| 344/358 [00:35<00:01,  9.85it/s] 96%|█████████▋| 345/358 [00:35<00:01,  9.87it/s] 97%|█████████▋| 347/358 [00:35<00:01, 10.05it/s] 97%|█████████▋| 348/358 [00:35<00:01,  9.95it/s] 97%|█████████▋| 349/358 [00:35<00:00,  9.87it/s] 98%|█████████▊| 350/358 [00:35<00:00,  9.79it/s] 98%|█████████▊| 351/358 [00:35<00:00,  9.75it/s] 99%|█████████▊| 353/358 [00:35<00:00,  9.93it/s] 99%|█████████▉| 354/358 [00:36<00:00,  9.91it/s] 99%|█████████▉| 355/358 [00:36<00:00,  9.83it/s]100%|█████████▉| 357/358 [00:36<00:00,  9.88it/s]100%|██████████| 358/358 [00:36<00:00,  9.84it/s]
[32m2025-02-05 06:19:12.642[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    gen_loss  grad clip ratio  grad norm   ppl
       1.826                1      2.685 6.208[0m
[32m2025-02-05 06:19:12.642[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m169[0m - [1m[Valid][0m
  0%|          | 0/10256 [00:00<?, ?it/s]100%|██████████| 10256/10256 [00:00<00:00, 1139909.95it/s]
[32m2025-02-05 06:19:12.652[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:27,  1.43it/s]  5%|▌         | 2/40 [00:01<00:26,  1.45it/s]  8%|▊         | 3/40 [00:02<00:25,  1.45it/s] 10%|█         | 4/40 [00:02<00:24,  1.45it/s] 12%|█▎        | 5/40 [00:03<00:24,  1.44it/s] 15%|█▌        | 6/40 [00:04<00:23,  1.44it/s] 18%|█▊        | 7/40 [00:04<00:22,  1.44it/s] 20%|██        | 8/40 [00:05<00:22,  1.44it/s] 22%|██▎       | 9/40 [00:06<00:21,  1.44it/s] 25%|██▌       | 10/40 [00:06<00:20,  1.44it/s] 28%|██▊       | 11/40 [00:07<00:20,  1.45it/s] 30%|███       | 12/40 [00:08<00:19,  1.45it/s] 32%|███▎      | 13/40 [00:08<00:18,  1.45it/s] 35%|███▌      | 14/40 [00:09<00:18,  1.44it/s] 38%|███▊      | 15/40 [00:10<00:17,  1.44it/s] 40%|████      | 16/40 [00:11<00:16,  1.44it/s] 42%|████▎     | 17/40 [00:11<00:15,  1.45it/s] 45%|████▌     | 18/40 [00:12<00:15,  1.45it/s] 48%|████▊     | 19/40 [00:13<00:14,  1.45it/s] 50%|█████     | 20/40 [00:13<00:13,  1.46it/s] 52%|█████▎    | 21/40 [00:14<00:12,  1.46it/s] 55%|█████▌    | 22/40 [00:15<00:12,  1.45it/s] 57%|█████▊    | 23/40 [00:15<00:11,  1.45it/s] 60%|██████    | 24/40 [00:16<00:11,  1.45it/s] 62%|██████▎   | 25/40 [00:17<00:10,  1.44it/s] 65%|██████▌   | 26/40 [00:17<00:09,  1.45it/s] 68%|██████▊   | 27/40 [00:18<00:08,  1.45it/s] 70%|███████   | 28/40 [00:19<00:08,  1.45it/s] 72%|███████▎  | 29/40 [00:20<00:07,  1.45it/s] 75%|███████▌  | 30/40 [00:20<00:06,  1.46it/s] 78%|███████▊  | 31/40 [00:21<00:06,  1.46it/s] 80%|████████  | 32/40 [00:22<00:05,  1.46it/s] 82%|████████▎ | 33/40 [00:22<00:04,  1.45it/s] 85%|████████▌ | 34/40 [00:23<00:04,  1.46it/s] 88%|████████▊ | 35/40 [00:24<00:03,  1.45it/s] 90%|█████████ | 36/40 [00:24<00:02,  1.44it/s] 92%|█████████▎| 37/40 [00:25<00:02,  1.45it/s] 95%|█████████▌| 38/40 [00:26<00:01,  1.44it/s] 98%|█████████▊| 39/40 [00:26<00:00,  1.44it/s]100%|██████████| 40/40 [00:27<00:00,  1.59it/s]100%|██████████| 40/40 [00:27<00:00,  1.46it/s]
[32m2025-02-05 06:19:40.076[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    average  bleu@1  bleu@2  bleu@3  bleu@4  dist@1  dist@2  dist@3  dist@4  extreme  \
      .7821   .2954   .1052  .03757  .01965  .04323   .2978   .5716   .7413    .6014   
      f1  gen_loss  greedy  intra_dist@1  intra_dist@2  intra_dist@3  intra_dist@4  \
   .3485     5.238   .6682         .8607         .9651         .9599         .9272   
     ppl  rouge1  rouge2  rougeL  
   188.2   .3819  .08476   .3692[0m
[32m2025-02-05 06:19:40.082[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m163[0m - [1m[Conversation epoch 67][0m
[32m2025-02-05 06:19:40.082[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m164[0m - [1m[Train][0m
  0%|          | 0/92414 [00:00<?, ?it/s]100%|██████████| 92414/92414 [00:00<00:00, 1004609.26it/s]
[32m2025-02-05 06:19:40.175[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/358 [00:00<?, ?it/s]  0%|          | 1/358 [00:00<00:36,  9.77it/s]  1%|          | 3/358 [00:00<00:35,  9.95it/s]  1%|          | 4/358 [00:00<00:35,  9.92it/s]  2%|▏         | 6/358 [00:00<00:35,  9.88it/s]  2%|▏         | 7/358 [00:00<00:35,  9.82it/s]  2%|▏         | 8/358 [00:00<00:35,  9.86it/s]  3%|▎         | 9/358 [00:00<00:35,  9.77it/s]  3%|▎         | 10/358 [00:01<00:35,  9.76it/s]  3%|▎         | 11/358 [00:01<00:35,  9.71it/s]  4%|▎         | 13/358 [00:01<00:34,  9.93it/s]  4%|▍         | 14/358 [00:01<00:34,  9.85it/s]  4%|▍         | 15/358 [00:01<00:35,  9.78it/s]  4%|▍         | 16/358 [00:01<00:35,  9.72it/s]  5%|▍         | 17/358 [00:01<00:35,  9.73it/s]  5%|▌         | 19/358 [00:01<00:34,  9.76it/s]  6%|▌         | 20/358 [00:02<00:34,  9.70it/s]  6%|▌         | 21/358 [00:02<00:34,  9.64it/s]  6%|▌         | 22/358 [00:02<00:34,  9.69it/s]  7%|▋         | 24/358 [00:02<00:34,  9.78it/s]  7%|▋         | 25/358 [00:02<00:34,  9.73it/s]  7%|▋         | 26/358 [00:02<00:34,  9.68it/s]  8%|▊         | 27/358 [00:02<00:34,  9.73it/s]  8%|▊         | 28/358 [00:02<00:34,  9.69it/s]  8%|▊         | 29/358 [00:02<00:34,  9.66it/s]  9%|▊         | 31/358 [00:03<00:33,  9.76it/s]  9%|▉         | 32/358 [00:03<00:33,  9.76it/s]  9%|▉         | 34/358 [00:03<00:32,  9.86it/s] 10%|█         | 36/358 [00:03<00:32,  9.85it/s] 10%|█         | 37/358 [00:03<00:32,  9.83it/s] 11%|█         | 38/358 [00:03<00:32,  9.79it/s] 11%|█         | 40/358 [00:04<00:31,  9.95it/s] 11%|█▏        | 41/358 [00:04<00:32,  9.86it/s] 12%|█▏        | 43/358 [00:04<00:31,  9.89it/s] 13%|█▎        | 45/358 [00:04<00:31,  9.98it/s] 13%|█▎        | 47/358 [00:04<00:31,  9.95it/s] 13%|█▎        | 48/358 [00:04<00:31,  9.94it/s] 14%|█▍        | 50/358 [00:05<00:31,  9.92it/s] 14%|█▍        | 51/358 [00:05<00:31,  9.85it/s] 15%|█▍        | 52/358 [00:05<00:31,  9.76it/s] 15%|█▍        | 53/358 [00:05<00:31,  9.71it/s] 15%|█▌        | 54/358 [00:05<00:31,  9.75it/s] 15%|█▌        | 55/358 [00:05<00:31,  9.70it/s] 16%|█▌        | 56/358 [00:05<00:31,  9.74it/s] 16%|█▌        | 57/358 [00:05<00:31,  9.70it/s] 16%|█▌        | 58/358 [00:05<00:31,  9.67it/s] 16%|█▋        | 59/358 [00:06<00:30,  9.65it/s] 17%|█▋        | 61/358 [00:06<00:30,  9.73it/s] 17%|█▋        | 62/358 [00:06<00:30,  9.65it/s] 18%|█▊        | 63/358 [00:06<00:30,  9.71it/s] 18%|█▊        | 64/358 [00:06<00:30,  9.66it/s] 18%|█▊        | 66/358 [00:06<00:29,  9.74it/s] 19%|█▊        | 67/358 [00:06<00:29,  9.72it/s] 19%|█▉        | 69/358 [00:07<00:29,  9.78it/s] 20%|█▉        | 70/358 [00:07<00:29,  9.73it/s] 20%|█▉        | 71/358 [00:07<00:29,  9.78it/s] 20%|██        | 72/358 [00:07<00:29,  9.72it/s] 20%|██        | 73/358 [00:07<00:29,  9.69it/s] 21%|██        | 74/358 [00:07<00:29,  9.66it/s] 21%|██        | 75/358 [00:07<00:29,  9.62it/s] 22%|██▏       | 77/358 [00:07<00:28,  9.71it/s] 22%|██▏       | 79/358 [00:08<00:28,  9.71it/s] 23%|██▎       | 81/358 [00:08<00:28,  9.76it/s] 23%|██▎       | 83/358 [00:08<00:28,  9.79it/s] 23%|██▎       | 84/358 [00:08<00:28,  9.74it/s] 24%|██▎       | 85/358 [00:08<00:28,  9.70it/s] 24%|██▍       | 86/358 [00:08<00:28,  9.68it/s] 24%|██▍       | 87/358 [00:08<00:28,  9.66it/s] 25%|██▍       | 88/358 [00:09<00:27,  9.68it/s] 25%|██▌       | 90/358 [00:09<00:27,  9.91it/s] 26%|██▌       | 92/358 [00:09<00:26, 10.01it/s] 26%|██▌       | 93/358 [00:09<00:26,  9.98it/s] 26%|██▋       | 94/358 [00:09<00:26,  9.89it/s] 27%|██▋       | 96/358 [00:09<00:25, 10.17it/s] 27%|██▋       | 98/358 [00:09<00:25, 10.06it/s] 28%|██▊       | 100/358 [00:10<00:25, 10.01it/s] 28%|██▊       | 101/358 [00:10<00:25,  9.92it/s] 29%|██▉       | 103/358 [00:10<00:25,  9.91it/s] 29%|██▉       | 104/358 [00:10<00:25,  9.87it/s] 29%|██▉       | 105/358 [00:10<00:25,  9.79it/s] 30%|██▉       | 106/358 [00:10<00:25,  9.77it/s] 30%|███       | 108/358 [00:11<00:25,  9.80it/s] 30%|███       | 109/358 [00:11<00:25,  9.72it/s] 31%|███       | 110/358 [00:11<00:25,  9.70it/s] 31%|███       | 111/358 [00:11<00:25,  9.66it/s] 32%|███▏      | 113/358 [00:11<00:24,  9.93it/s] 32%|███▏      | 114/358 [00:11<00:24,  9.88it/s] 32%|███▏      | 115/358 [00:11<00:24,  9.79it/s] 32%|███▏      | 116/358 [00:11<00:24,  9.70it/s] 33%|███▎      | 117/358 [00:11<00:24,  9.68it/s] 33%|███▎      | 119/358 [00:12<00:24,  9.80it/s] 34%|███▍      | 121/358 [00:12<00:23,  9.99it/s] 34%|███▍      | 123/358 [00:12<00:23, 10.09it/s] 35%|███▍      | 125/358 [00:12<00:23, 10.07it/s] 35%|███▌      | 127/358 [00:12<00:23,  9.99it/s] 36%|███▌      | 128/358 [00:13<00:23,  9.95it/s] 36%|███▋      | 130/358 [00:13<00:22, 10.00it/s] 37%|███▋      | 131/358 [00:13<00:22,  9.91it/s] 37%|███▋      | 132/358 [00:13<00:22,  9.93it/s] 37%|███▋      | 134/358 [00:13<00:22,  9.95it/s] 38%|███▊      | 135/358 [00:13<00:22,  9.89it/s] 38%|███▊      | 137/358 [00:13<00:22,  9.98it/s] 39%|███▊      | 138/358 [00:14<00:22,  9.96it/s] 39%|███▉      | 139/358 [00:14<00:22,  9.87it/s] 39%|███▉      | 141/358 [00:14<00:21,  9.99it/s] 40%|███▉      | 142/358 [00:14<00:21,  9.91it/s] 40%|███▉      | 143/358 [00:14<00:21,  9.88it/s] 40%|████      | 144/358 [00:14<00:21,  9.79it/s] 41%|████      | 145/358 [00:14<00:21,  9.81it/s] 41%|████      | 146/358 [00:14<00:21,  9.74it/s] 41%|████      | 147/358 [00:14<00:21,  9.68it/s] 41%|████▏     | 148/358 [00:15<00:21,  9.71it/s] 42%|████▏     | 149/358 [00:15<00:21,  9.70it/s] 42%|████▏     | 150/358 [00:15<00:21,  9.66it/s] 42%|████▏     | 151/358 [00:15<00:22,  9.35it/s] 42%|████▏     | 152/358 [00:15<00:21,  9.41it/s] 43%|████▎     | 153/358 [00:15<00:21,  9.44it/s] 43%|████▎     | 154/358 [00:15<00:21,  9.54it/s] 43%|████▎     | 155/358 [00:15<00:21,  9.55it/s] 44%|████▎     | 156/358 [00:15<00:20,  9.68it/s] 44%|████▍     | 157/358 [00:16<00:20,  9.62it/s] 44%|████▍     | 158/358 [00:16<00:20,  9.71it/s] 44%|████▍     | 159/358 [00:16<00:20,  9.71it/s] 45%|████▍     | 160/358 [00:16<00:20,  9.72it/s] 45%|████▌     | 162/358 [00:16<00:19, 10.01it/s] 46%|████▌     | 164/358 [00:16<00:19, 10.01it/s] 46%|████▌     | 165/358 [00:16<00:19,  9.97it/s] 47%|████▋     | 167/358 [00:17<00:19,  9.91it/s] 47%|████▋     | 169/358 [00:17<00:18,  9.95it/s] 48%|████▊     | 171/358 [00:17<00:18,  9.93it/s] 48%|████▊     | 172/358 [00:17<00:18,  9.88it/s] 48%|████▊     | 173/358 [00:17<00:18,  9.82it/s] 49%|████▉     | 175/358 [00:17<00:18,  9.84it/s] 49%|████▉     | 176/358 [00:17<00:18,  9.86it/s] 49%|████▉     | 177/358 [00:18<00:18,  9.84it/s] 50%|█████     | 179/358 [00:18<00:18,  9.87it/s] 50%|█████     | 180/358 [00:18<00:18,  9.80it/s] 51%|█████     | 182/358 [00:18<00:17,  9.95it/s] 51%|█████     | 183/358 [00:18<00:17,  9.90it/s] 51%|█████▏    | 184/358 [00:18<00:17,  9.79it/s] 52%|█████▏    | 185/358 [00:18<00:17,  9.72it/s] 52%|█████▏    | 187/358 [00:19<00:17,  9.94it/s] 53%|█████▎    | 188/358 [00:19<00:17,  9.89it/s] 53%|█████▎    | 189/358 [00:19<00:17,  9.83it/s] 53%|█████▎    | 191/358 [00:19<00:17,  9.76it/s] 54%|█████▎    | 192/358 [00:19<00:17,  9.71it/s] 54%|█████▍    | 193/358 [00:19<00:17,  9.70it/s] 54%|█████▍    | 194/358 [00:19<00:16,  9.68it/s] 54%|█████▍    | 195/358 [00:19<00:16,  9.75it/s] 55%|█████▌    | 197/358 [00:20<00:16,  9.93it/s] 55%|█████▌    | 198/358 [00:20<00:16,  9.85it/s] 56%|█████▌    | 199/358 [00:20<00:16,  9.88it/s] 56%|█████▌    | 200/358 [00:20<00:16,  9.82it/s] 56%|█████▌    | 201/358 [00:20<00:16,  9.78it/s] 57%|█████▋    | 203/358 [00:20<00:15,  9.87it/s] 57%|█████▋    | 204/358 [00:20<00:15,  9.76it/s] 57%|█████▋    | 205/358 [00:20<00:15,  9.72it/s] 58%|█████▊    | 207/358 [00:21<00:15,  9.88it/s] 58%|█████▊    | 208/358 [00:21<00:15,  9.81it/s] 59%|█████▊    | 210/358 [00:21<00:15,  9.83it/s] 59%|█████▉    | 212/358 [00:21<00:14,  9.82it/s] 60%|█████▉    | 214/358 [00:21<00:14,  9.90it/s] 60%|██████    | 215/358 [00:21<00:14,  9.84it/s] 60%|██████    | 216/358 [00:22<00:14,  9.77it/s] 61%|██████    | 217/358 [00:22<00:14,  9.81it/s] 61%|██████    | 218/358 [00:22<00:14,  9.78it/s] 61%|██████    | 219/358 [00:22<00:14,  9.78it/s] 62%|██████▏   | 221/358 [00:22<00:13,  9.91it/s] 62%|██████▏   | 222/358 [00:22<00:13,  9.81it/s] 62%|██████▏   | 223/358 [00:22<00:13,  9.76it/s] 63%|██████▎   | 224/358 [00:22<00:13,  9.70it/s] 63%|██████▎   | 226/358 [00:23<00:13,  9.75it/s] 64%|██████▎   | 228/358 [00:23<00:13,  9.77it/s] 64%|██████▍   | 229/358 [00:23<00:13,  9.74it/s] 64%|██████▍   | 230/358 [00:23<00:13,  9.69it/s] 65%|██████▍   | 232/358 [00:23<00:12,  9.74it/s] 65%|██████▌   | 234/358 [00:23<00:12, 10.02it/s] 66%|██████▌   | 236/358 [00:24<00:12,  9.99it/s] 66%|██████▋   | 238/358 [00:24<00:11, 10.04it/s] 67%|██████▋   | 240/358 [00:24<00:11, 10.00it/s] 68%|██████▊   | 242/358 [00:24<00:11,  9.98it/s] 68%|██████▊   | 243/358 [00:24<00:11,  9.92it/s] 68%|██████▊   | 244/358 [00:24<00:11,  9.86it/s] 69%|██████▊   | 246/358 [00:25<00:11,  9.88it/s] 69%|██████▉   | 247/358 [00:25<00:11,  9.81it/s] 69%|██████▉   | 248/358 [00:25<00:11,  9.76it/s] 70%|██████▉   | 250/358 [00:25<00:10,  9.86it/s] 70%|███████   | 251/358 [00:25<00:10,  9.79it/s] 70%|███████   | 252/358 [00:25<00:10,  9.73it/s] 71%|███████   | 253/358 [00:25<00:10,  9.69it/s] 71%|███████   | 254/358 [00:25<00:10,  9.67it/s] 72%|███████▏  | 256/358 [00:26<00:10,  9.84it/s] 72%|███████▏  | 257/358 [00:26<00:10,  9.85it/s] 72%|███████▏  | 258/358 [00:26<00:10,  9.71it/s] 72%|███████▏  | 259/358 [00:26<00:10,  9.68it/s] 73%|███████▎  | 260/358 [00:26<00:10,  9.72it/s] 73%|███████▎  | 262/358 [00:26<00:09,  9.90it/s] 74%|███████▎  | 264/358 [00:26<00:09,  9.92it/s] 74%|███████▍  | 266/358 [00:27<00:09,  9.91it/s] 75%|███████▍  | 267/358 [00:27<00:09,  9.85it/s] 75%|███████▌  | 269/358 [00:27<00:08,  9.91it/s] 75%|███████▌  | 270/358 [00:27<00:08,  9.84it/s] 76%|███████▌  | 271/358 [00:27<00:08,  9.77it/s] 76%|███████▌  | 272/358 [00:27<00:08,  9.74it/s] 76%|███████▋  | 273/358 [00:27<00:08,  9.64it/s] 77%|███████▋  | 274/358 [00:27<00:08,  9.64it/s] 77%|███████▋  | 275/358 [00:28<00:08,  9.69it/s] 77%|███████▋  | 276/358 [00:28<00:08,  9.69it/s] 77%|███████▋  | 277/358 [00:28<00:08,  9.67it/s] 78%|███████▊  | 278/358 [00:28<00:08,  9.64it/s] 78%|███████▊  | 280/358 [00:28<00:07,  9.83it/s] 78%|███████▊  | 281/358 [00:28<00:07,  9.84it/s] 79%|███████▉  | 282/358 [00:28<00:07,  9.78it/s] 79%|███████▉  | 283/358 [00:28<00:07,  9.72it/s] 79%|███████▉  | 284/358 [00:28<00:07,  9.68it/s] 80%|███████▉  | 285/358 [00:29<00:07,  9.75it/s] 80%|███████▉  | 286/358 [00:29<00:07,  9.71it/s] 80%|████████  | 287/358 [00:29<00:07,  9.68it/s] 80%|████████  | 288/358 [00:29<00:07,  9.64it/s] 81%|████████  | 290/358 [00:29<00:06,  9.85it/s] 81%|████████▏ | 291/358 [00:29<00:06,  9.84it/s] 82%|████████▏ | 293/358 [00:29<00:06,  9.85it/s] 82%|████████▏ | 295/358 [00:30<00:06,  9.92it/s] 83%|████████▎ | 296/358 [00:30<00:06,  9.85it/s] 83%|████████▎ | 297/358 [00:30<00:06,  9.74it/s] 84%|████████▎ | 299/358 [00:30<00:05,  9.91it/s] 84%|████████▍ | 301/358 [00:30<00:05,  9.94it/s] 84%|████████▍ | 302/358 [00:30<00:05,  9.88it/s] 85%|████████▍ | 303/358 [00:30<00:05,  9.89it/s] 85%|████████▌ | 305/358 [00:31<00:05,  9.91it/s] 85%|████████▌ | 306/358 [00:31<00:05,  9.83it/s] 86%|████████▌ | 308/358 [00:31<00:05,  9.93it/s] 86%|████████▋ | 309/358 [00:31<00:04,  9.83it/s] 87%|████████▋ | 310/358 [00:31<00:04,  9.78it/s] 87%|████████▋ | 311/358 [00:31<00:04,  9.70it/s] 87%|████████▋ | 312/358 [00:31<00:04,  9.72it/s] 87%|████████▋ | 313/358 [00:31<00:04,  9.74it/s] 88%|████████▊ | 315/358 [00:32<00:04, 10.00it/s] 88%|████████▊ | 316/358 [00:32<00:04,  9.94it/s] 89%|████████▊ | 317/358 [00:32<00:04,  9.86it/s] 89%|████████▉ | 318/358 [00:32<00:04,  9.81it/s] 89%|████████▉ | 319/358 [00:32<00:03,  9.76it/s] 89%|████████▉ | 320/358 [00:32<00:03,  9.82it/s] 90%|████████▉ | 321/358 [00:32<00:03,  9.75it/s] 90%|████████▉ | 322/358 [00:32<00:03,  9.71it/s] 90%|█████████ | 323/358 [00:32<00:03,  9.65it/s] 91%|█████████ | 324/358 [00:33<00:03,  9.62it/s] 91%|█████████ | 325/358 [00:33<00:03,  9.61it/s] 91%|█████████▏| 327/358 [00:33<00:03,  9.97it/s] 92%|█████████▏| 329/358 [00:33<00:02, 10.07it/s] 92%|█████████▏| 330/358 [00:33<00:02,  9.96it/s] 93%|█████████▎| 332/358 [00:33<00:02, 10.06it/s] 93%|█████████▎| 334/358 [00:34<00:02,  9.96it/s] 94%|█████████▎| 335/358 [00:34<00:02,  9.84it/s] 94%|█████████▍| 337/358 [00:34<00:02,  9.92it/s] 95%|█████████▍| 339/358 [00:34<00:01, 10.12it/s] 95%|█████████▌| 341/358 [00:34<00:01, 10.06it/s] 96%|█████████▌| 343/358 [00:34<00:01,  9.90it/s] 96%|█████████▌| 344/358 [00:35<00:01,  9.85it/s] 96%|█████████▋| 345/358 [00:35<00:01,  9.87it/s] 97%|█████████▋| 347/358 [00:35<00:01, 10.04it/s] 97%|█████████▋| 348/358 [00:35<00:01,  9.94it/s] 97%|█████████▋| 349/358 [00:35<00:00,  9.80it/s] 98%|█████████▊| 350/358 [00:35<00:00,  9.74it/s] 98%|█████████▊| 351/358 [00:35<00:00,  9.71it/s] 99%|█████████▊| 353/358 [00:35<00:00,  9.91it/s] 99%|█████████▉| 354/358 [00:36<00:00,  9.89it/s] 99%|█████████▉| 355/358 [00:36<00:00,  9.81it/s]100%|█████████▉| 357/358 [00:36<00:00,  9.87it/s]100%|██████████| 358/358 [00:36<00:00,  9.83it/s]
[32m2025-02-05 06:20:16.596[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    gen_loss  grad clip ratio  grad norm   ppl
       1.822                1      2.396 6.186[0m
[32m2025-02-05 06:20:16.596[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m169[0m - [1m[Valid][0m
  0%|          | 0/10256 [00:00<?, ?it/s]100%|██████████| 10256/10256 [00:00<00:00, 930072.47it/s]
[32m2025-02-05 06:20:16.607[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:27,  1.43it/s]  5%|▌         | 2/40 [00:01<00:26,  1.45it/s]  8%|▊         | 3/40 [00:02<00:25,  1.46it/s] 10%|█         | 4/40 [00:02<00:24,  1.46it/s] 12%|█▎        | 5/40 [00:03<00:24,  1.45it/s] 15%|█▌        | 6/40 [00:04<00:23,  1.44it/s] 18%|█▊        | 7/40 [00:04<00:22,  1.44it/s] 20%|██        | 8/40 [00:05<00:21,  1.45it/s] 22%|██▎       | 9/40 [00:06<00:21,  1.45it/s] 25%|██▌       | 10/40 [00:06<00:20,  1.46it/s] 28%|██▊       | 11/40 [00:07<00:19,  1.46it/s] 30%|███       | 12/40 [00:08<00:19,  1.46it/s] 32%|███▎      | 13/40 [00:08<00:18,  1.46it/s] 35%|███▌      | 14/40 [00:09<00:17,  1.45it/s] 38%|███▊      | 15/40 [00:10<00:17,  1.45it/s] 40%|████      | 16/40 [00:11<00:16,  1.44it/s] 42%|████▎     | 17/40 [00:11<00:15,  1.45it/s] 45%|████▌     | 18/40 [00:12<00:15,  1.45it/s] 48%|████▊     | 19/40 [00:13<00:14,  1.45it/s] 50%|█████     | 20/40 [00:13<00:13,  1.46it/s] 52%|█████▎    | 21/40 [00:14<00:13,  1.46it/s] 55%|█████▌    | 22/40 [00:15<00:12,  1.46it/s] 57%|█████▊    | 23/40 [00:15<00:11,  1.46it/s] 60%|██████    | 24/40 [00:16<00:11,  1.45it/s] 62%|██████▎   | 25/40 [00:17<00:10,  1.45it/s] 65%|██████▌   | 26/40 [00:17<00:09,  1.46it/s] 68%|██████▊   | 27/40 [00:18<00:08,  1.46it/s] 70%|███████   | 28/40 [00:19<00:08,  1.46it/s] 72%|███████▎  | 29/40 [00:19<00:07,  1.46it/s] 75%|███████▌  | 30/40 [00:20<00:06,  1.46it/s] 78%|███████▊  | 31/40 [00:21<00:06,  1.46it/s] 80%|████████  | 32/40 [00:22<00:05,  1.46it/s] 82%|████████▎ | 33/40 [00:22<00:04,  1.45it/s] 85%|████████▌ | 34/40 [00:23<00:04,  1.46it/s] 88%|████████▊ | 35/40 [00:24<00:03,  1.45it/s] 90%|█████████ | 36/40 [00:24<00:02,  1.45it/s] 92%|█████████▎| 37/40 [00:25<00:02,  1.45it/s] 95%|█████████▌| 38/40 [00:26<00:01,  1.44it/s] 98%|█████████▊| 39/40 [00:26<00:00,  1.44it/s]100%|██████████| 40/40 [00:27<00:00,  1.59it/s]100%|██████████| 40/40 [00:27<00:00,  1.46it/s]
[32m2025-02-05 06:20:43.943[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    average  bleu@1  bleu@2  bleu@3  bleu@4  dist@1  dist@2  dist@3  dist@4  extreme  \
      .7794   .2897   .1022  .03438  .01661  .04446   .3144   .5977   .7650    .5950   
      f1  gen_loss  greedy  intra_dist@1  intra_dist@2  intra_dist@3  intra_dist@4  \
   .3447     5.193   .6647         .8644         .9680         .9532         .9236   
     ppl  rouge1  rouge2  rougeL  
   179.9   .3755  .08198   .3639[0m
[32m2025-02-05 06:20:43.950[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m163[0m - [1m[Conversation epoch 68][0m
[32m2025-02-05 06:20:43.950[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m164[0m - [1m[Train][0m
  0%|          | 0/92414 [00:00<?, ?it/s]100%|██████████| 92414/92414 [00:00<00:00, 1085059.11it/s]
[32m2025-02-05 06:20:44.035[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/358 [00:00<?, ?it/s]  0%|          | 1/358 [00:00<00:36,  9.77it/s]  1%|          | 3/358 [00:00<00:35,  9.94it/s]  1%|          | 4/358 [00:00<00:35,  9.92it/s]  2%|▏         | 6/358 [00:00<00:35,  9.88it/s]  2%|▏         | 7/358 [00:00<00:35,  9.82it/s]  2%|▏         | 8/358 [00:00<00:35,  9.86it/s]  3%|▎         | 9/358 [00:00<00:35,  9.77it/s]  3%|▎         | 10/358 [00:01<00:35,  9.75it/s]  3%|▎         | 11/358 [00:01<00:35,  9.70it/s]  4%|▎         | 13/358 [00:01<00:34,  9.93it/s]  4%|▍         | 14/358 [00:01<00:34,  9.85it/s]  4%|▍         | 15/358 [00:01<00:35,  9.77it/s]  4%|▍         | 16/358 [00:01<00:35,  9.71it/s]  5%|▍         | 17/358 [00:01<00:35,  9.73it/s]  5%|▌         | 19/358 [00:01<00:34,  9.75it/s]  6%|▌         | 20/358 [00:02<00:34,  9.70it/s]  6%|▌         | 21/358 [00:02<00:34,  9.63it/s]  6%|▌         | 22/358 [00:02<00:34,  9.69it/s]  7%|▋         | 24/358 [00:02<00:34,  9.78it/s]  7%|▋         | 25/358 [00:02<00:34,  9.73it/s]  7%|▋         | 26/358 [00:02<00:34,  9.68it/s]  8%|▊         | 27/358 [00:02<00:33,  9.74it/s]  8%|▊         | 28/358 [00:02<00:34,  9.69it/s]  8%|▊         | 29/358 [00:02<00:34,  9.66it/s]  9%|▊         | 31/358 [00:03<00:33,  9.76it/s]  9%|▉         | 32/358 [00:03<00:33,  9.76it/s]  9%|▉         | 34/358 [00:03<00:32,  9.85it/s] 10%|█         | 36/358 [00:03<00:32,  9.85it/s] 10%|█         | 37/358 [00:03<00:32,  9.84it/s] 11%|█         | 38/358 [00:03<00:32,  9.79it/s] 11%|█         | 40/358 [00:04<00:31,  9.95it/s] 11%|█▏        | 41/358 [00:04<00:32,  9.86it/s] 12%|█▏        | 43/358 [00:04<00:31,  9.88it/s] 13%|█▎        | 45/358 [00:04<00:31,  9.98it/s] 13%|█▎        | 47/358 [00:04<00:31,  9.95it/s] 13%|█▎        | 48/358 [00:04<00:31,  9.94it/s] 14%|█▍        | 50/358 [00:05<00:31,  9.92it/s] 14%|█▍        | 51/358 [00:05<00:31,  9.85it/s] 15%|█▍        | 52/358 [00:05<00:31,  9.76it/s] 15%|█▍        | 53/358 [00:05<00:31,  9.71it/s] 15%|█▌        | 54/358 [00:05<00:31,  9.75it/s] 15%|█▌        | 55/358 [00:05<00:31,  9.70it/s] 16%|█▌        | 56/358 [00:05<00:30,  9.74it/s] 16%|█▌        | 57/358 [00:05<00:31,  9.70it/s] 16%|█▌        | 58/358 [00:05<00:30,  9.68it/s] 16%|█▋        | 59/358 [00:06<00:30,  9.65it/s] 17%|█▋        | 61/358 [00:06<00:30,  9.73it/s] 17%|█▋        | 62/358 [00:06<00:30,  9.65it/s] 18%|█▊        | 63/358 [00:06<00:30,  9.72it/s] 18%|█▊        | 64/358 [00:06<00:30,  9.67it/s] 18%|█▊        | 66/358 [00:06<00:30,  9.73it/s] 19%|█▊        | 67/358 [00:06<00:29,  9.72it/s] 19%|█▉        | 69/358 [00:07<00:29,  9.79it/s] 20%|█▉        | 70/358 [00:07<00:29,  9.73it/s] 20%|█▉        | 71/358 [00:07<00:29,  9.78it/s] 20%|██        | 72/358 [00:07<00:29,  9.73it/s] 20%|██        | 73/358 [00:07<00:29,  9.69it/s] 21%|██        | 74/358 [00:07<00:29,  9.66it/s] 21%|██        | 75/358 [00:07<00:29,  9.63it/s] 21%|██        | 76/358 [00:07<00:28,  9.73it/s] 22%|██▏       | 77/358 [00:07<00:28,  9.69it/s] 22%|██▏       | 79/358 [00:08<00:28,  9.71it/s] 23%|██▎       | 81/358 [00:08<00:28,  9.77it/s] 23%|██▎       | 83/358 [00:08<00:28,  9.79it/s] 23%|██▎       | 84/358 [00:08<00:28,  9.74it/s] 24%|██▎       | 85/358 [00:08<00:28,  9.69it/s] 24%|██▍       | 86/358 [00:08<00:28,  9.67it/s] 24%|██▍       | 87/358 [00:08<00:28,  9.66it/s] 25%|██▍       | 88/358 [00:09<00:27,  9.68it/s] 25%|██▌       | 90/358 [00:09<00:27,  9.91it/s] 26%|██▌       | 92/358 [00:09<00:26, 10.01it/s] 26%|██▌       | 93/358 [00:09<00:26,  9.98it/s] 26%|██▋       | 94/358 [00:09<00:26,  9.89it/s] 27%|██▋       | 96/358 [00:09<00:25, 10.17it/s] 27%|██▋       | 98/358 [00:09<00:25, 10.06it/s] 28%|██▊       | 100/358 [00:10<00:25, 10.01it/s] 28%|██▊       | 101/358 [00:10<00:25,  9.92it/s] 29%|██▉       | 103/358 [00:10<00:25,  9.91it/s] 29%|██▉       | 104/358 [00:10<00:25,  9.86it/s] 29%|██▉       | 105/358 [00:10<00:25,  9.79it/s] 30%|██▉       | 106/358 [00:10<00:25,  9.77it/s] 30%|███       | 108/358 [00:11<00:25,  9.81it/s] 30%|███       | 109/358 [00:11<00:25,  9.72it/s] 31%|███       | 110/358 [00:11<00:25,  9.70it/s] 31%|███       | 111/358 [00:11<00:25,  9.66it/s] 32%|███▏      | 113/358 [00:11<00:24,  9.92it/s] 32%|███▏      | 114/358 [00:11<00:24,  9.88it/s] 32%|███▏      | 115/358 [00:11<00:24,  9.78it/s] 32%|███▏      | 116/358 [00:11<00:24,  9.70it/s] 33%|███▎      | 117/358 [00:11<00:24,  9.67it/s] 33%|███▎      | 119/358 [00:12<00:24,  9.79it/s] 34%|███▍      | 121/358 [00:12<00:23,  9.99it/s] 34%|███▍      | 123/358 [00:12<00:23, 10.09it/s] 35%|███▍      | 125/358 [00:12<00:23, 10.06it/s] 35%|███▌      | 127/358 [00:12<00:23,  9.99it/s] 36%|███▌      | 128/358 [00:13<00:23,  9.95it/s] 36%|███▋      | 130/358 [00:13<00:22, 10.00it/s] 37%|███▋      | 131/358 [00:13<00:22,  9.91it/s] 37%|███▋      | 132/358 [00:13<00:22,  9.93it/s] 37%|███▋      | 134/358 [00:13<00:22,  9.95it/s] 38%|███▊      | 135/358 [00:13<00:22,  9.88it/s] 38%|███▊      | 137/358 [00:13<00:22,  9.97it/s] 39%|███▊      | 138/358 [00:14<00:22,  9.95it/s] 39%|███▉      | 139/358 [00:14<00:22,  9.87it/s] 39%|███▉      | 141/358 [00:14<00:21,  9.99it/s] 40%|███▉      | 142/358 [00:14<00:21,  9.91it/s] 40%|███▉      | 143/358 [00:14<00:21,  9.87it/s] 40%|████      | 144/358 [00:14<00:21,  9.79it/s] 41%|████      | 145/358 [00:14<00:21,  9.81it/s] 41%|████      | 146/358 [00:14<00:21,  9.75it/s] 41%|████      | 147/358 [00:14<00:21,  9.69it/s] 41%|████▏     | 148/358 [00:15<00:21,  9.72it/s] 42%|████▏     | 149/358 [00:15<00:21,  9.70it/s] 42%|████▏     | 150/358 [00:15<00:21,  9.66it/s] 42%|████▏     | 151/358 [00:15<00:22,  9.39it/s] 42%|████▏     | 152/358 [00:15<00:21,  9.44it/s] 43%|████▎     | 153/358 [00:15<00:21,  9.46it/s] 43%|████▎     | 154/358 [00:15<00:21,  9.55it/s] 43%|████▎     | 155/358 [00:15<00:21,  9.56it/s] 44%|████▎     | 156/358 [00:15<00:20,  9.68it/s] 44%|████▍     | 157/358 [00:16<00:20,  9.62it/s] 44%|████▍     | 158/358 [00:16<00:20,  9.71it/s] 44%|████▍     | 159/358 [00:16<00:20,  9.71it/s] 45%|████▍     | 160/358 [00:16<00:20,  9.72it/s] 45%|████▌     | 162/358 [00:16<00:19, 10.01it/s] 46%|████▌     | 164/358 [00:16<00:19, 10.01it/s] 46%|████▌     | 165/358 [00:16<00:19,  9.97it/s] 47%|████▋     | 167/358 [00:17<00:19,  9.91it/s] 47%|████▋     | 169/358 [00:17<00:18,  9.95it/s] 48%|████▊     | 171/358 [00:17<00:18,  9.93it/s] 48%|████▊     | 172/358 [00:17<00:18,  9.88it/s] 48%|████▊     | 173/358 [00:17<00:18,  9.82it/s] 49%|████▉     | 175/358 [00:17<00:18,  9.84it/s] 49%|████▉     | 176/358 [00:17<00:18,  9.85it/s] 49%|████▉     | 177/358 [00:18<00:18,  9.84it/s] 50%|█████     | 179/358 [00:18<00:18,  9.87it/s] 50%|█████     | 180/358 [00:18<00:18,  9.79it/s] 51%|█████     | 182/358 [00:18<00:17,  9.95it/s] 51%|█████     | 183/358 [00:18<00:17,  9.90it/s] 51%|█████▏    | 184/358 [00:18<00:17,  9.79it/s] 52%|█████▏    | 185/358 [00:18<00:17,  9.74it/s] 52%|█████▏    | 187/358 [00:19<00:17,  9.95it/s] 53%|█████▎    | 188/358 [00:19<00:17,  9.90it/s] 53%|█████▎    | 189/358 [00:19<00:17,  9.84it/s] 53%|█████▎    | 191/358 [00:19<00:17,  9.76it/s] 54%|█████▎    | 192/358 [00:19<00:17,  9.70it/s] 54%|█████▍    | 193/358 [00:19<00:17,  9.70it/s] 54%|█████▍    | 194/358 [00:19<00:16,  9.67it/s] 54%|█████▍    | 195/358 [00:19<00:16,  9.75it/s] 55%|█████▌    | 197/358 [00:20<00:16,  9.92it/s] 55%|█████▌    | 198/358 [00:20<00:16,  9.85it/s] 56%|█████▌    | 199/358 [00:20<00:16,  9.88it/s] 56%|█████▌    | 200/358 [00:20<00:16,  9.81it/s] 56%|█████▌    | 201/358 [00:20<00:16,  9.77it/s] 57%|█████▋    | 203/358 [00:20<00:15,  9.86it/s] 57%|█████▋    | 204/358 [00:20<00:15,  9.76it/s] 57%|█████▋    | 205/358 [00:20<00:15,  9.71it/s] 58%|█████▊    | 207/358 [00:21<00:15,  9.88it/s] 58%|█████▊    | 208/358 [00:21<00:15,  9.81it/s] 59%|█████▊    | 210/358 [00:21<00:15,  9.83it/s] 59%|█████▉    | 212/358 [00:21<00:14,  9.82it/s] 60%|█████▉    | 214/358 [00:21<00:14,  9.90it/s] 60%|██████    | 215/358 [00:21<00:14,  9.84it/s] 60%|██████    | 216/358 [00:22<00:14,  9.78it/s] 61%|██████    | 217/358 [00:22<00:14,  9.81it/s] 61%|██████    | 218/358 [00:22<00:14,  9.78it/s] 61%|██████    | 219/358 [00:22<00:14,  9.78it/s] 62%|██████▏   | 221/358 [00:22<00:13,  9.92it/s] 62%|██████▏   | 222/358 [00:22<00:13,  9.81it/s] 62%|██████▏   | 223/358 [00:22<00:13,  9.76it/s] 63%|██████▎   | 224/358 [00:22<00:13,  9.69it/s] 63%|██████▎   | 225/358 [00:22<00:13,  9.76it/s] 63%|██████▎   | 226/358 [00:23<00:13,  9.71it/s] 64%|██████▎   | 228/358 [00:23<00:13,  9.76it/s] 64%|██████▍   | 229/358 [00:23<00:13,  9.73it/s] 64%|██████▍   | 230/358 [00:23<00:13,  9.68it/s] 65%|██████▍   | 232/358 [00:23<00:12,  9.73it/s] 65%|██████▌   | 234/358 [00:23<00:12, 10.03it/s] 66%|██████▌   | 236/358 [00:24<00:12,  9.98it/s] 66%|██████▋   | 238/358 [00:24<00:11, 10.03it/s] 67%|██████▋   | 240/358 [00:24<00:11, 10.00it/s] 68%|██████▊   | 242/358 [00:24<00:11,  9.98it/s] 68%|██████▊   | 243/358 [00:24<00:11,  9.91it/s] 68%|██████▊   | 244/358 [00:24<00:11,  9.85it/s] 69%|██████▊   | 246/358 [00:25<00:11,  9.87it/s] 69%|██████▉   | 247/358 [00:25<00:11,  9.80it/s] 69%|██████▉   | 248/358 [00:25<00:11,  9.76it/s] 70%|██████▉   | 250/358 [00:25<00:10,  9.86it/s] 70%|███████   | 251/358 [00:25<00:10,  9.79it/s] 70%|███████   | 252/358 [00:25<00:10,  9.72it/s] 71%|███████   | 253/358 [00:25<00:10,  9.68it/s] 71%|███████   | 254/358 [00:25<00:10,  9.66it/s] 72%|███████▏  | 256/358 [00:26<00:10,  9.84it/s] 72%|███████▏  | 257/358 [00:26<00:10,  9.84it/s] 72%|███████▏  | 258/358 [00:26<00:10,  9.72it/s] 72%|███████▏  | 259/358 [00:26<00:10,  9.68it/s] 73%|███████▎  | 260/358 [00:26<00:10,  9.71it/s] 73%|███████▎  | 262/358 [00:26<00:09,  9.90it/s] 74%|███████▎  | 264/358 [00:26<00:09,  9.92it/s] 74%|███████▍  | 266/358 [00:27<00:09,  9.91it/s] 75%|███████▍  | 267/358 [00:27<00:09,  9.85it/s] 75%|███████▌  | 269/358 [00:27<00:08,  9.91it/s] 75%|███████▌  | 270/358 [00:27<00:08,  9.83it/s] 76%|███████▌  | 271/358 [00:27<00:08,  9.76it/s] 76%|███████▌  | 272/358 [00:27<00:08,  9.74it/s] 76%|███████▋  | 273/358 [00:27<00:08,  9.64it/s] 77%|███████▋  | 274/358 [00:27<00:08,  9.64it/s] 77%|███████▋  | 275/358 [00:28<00:08,  9.68it/s] 77%|███████▋  | 276/358 [00:28<00:08,  9.69it/s] 77%|███████▋  | 277/358 [00:28<00:08,  9.65it/s] 78%|███████▊  | 278/358 [00:28<00:08,  9.61it/s] 78%|███████▊  | 280/358 [00:28<00:07,  9.81it/s] 78%|███████▊  | 281/358 [00:28<00:07,  9.82it/s] 79%|███████▉  | 282/358 [00:28<00:07,  9.76it/s] 79%|███████▉  | 283/358 [00:28<00:07,  9.70it/s] 79%|███████▉  | 284/358 [00:28<00:07,  9.67it/s] 80%|███████▉  | 285/358 [00:29<00:07,  9.74it/s] 80%|███████▉  | 286/358 [00:29<00:07,  9.69it/s] 80%|████████  | 287/358 [00:29<00:07,  9.67it/s] 80%|████████  | 288/358 [00:29<00:07,  9.63it/s] 81%|████████  | 290/358 [00:29<00:06,  9.85it/s] 81%|████████▏ | 291/358 [00:29<00:06,  9.83it/s] 82%|████████▏ | 293/358 [00:29<00:06,  9.84it/s] 82%|████████▏ | 295/358 [00:30<00:06,  9.91it/s] 83%|████████▎ | 296/358 [00:30<00:06,  9.85it/s] 83%|████████▎ | 297/358 [00:30<00:06,  9.74it/s] 84%|████████▎ | 299/358 [00:30<00:05,  9.90it/s] 84%|████████▍ | 301/358 [00:30<00:05,  9.94it/s] 84%|████████▍ | 302/358 [00:30<00:05,  9.87it/s] 85%|████████▍ | 303/358 [00:30<00:05,  9.88it/s] 85%|████████▌ | 305/358 [00:31<00:05,  9.91it/s] 85%|████████▌ | 306/358 [00:31<00:05,  9.83it/s] 86%|████████▌ | 308/358 [00:31<00:05,  9.93it/s] 86%|████████▋ | 309/358 [00:31<00:04,  9.83it/s] 87%|████████▋ | 310/358 [00:31<00:04,  9.77it/s] 87%|████████▋ | 311/358 [00:31<00:04,  9.69it/s] 87%|████████▋ | 312/358 [00:31<00:04,  9.71it/s] 87%|████████▋ | 313/358 [00:31<00:04,  9.73it/s] 88%|████████▊ | 315/358 [00:32<00:04,  9.99it/s] 88%|████████▊ | 316/358 [00:32<00:04,  9.94it/s] 89%|████████▊ | 317/358 [00:32<00:04,  9.86it/s] 89%|████████▉ | 318/358 [00:32<00:04,  9.81it/s] 89%|████████▉ | 319/358 [00:32<00:03,  9.76it/s] 89%|████████▉ | 320/358 [00:32<00:03,  9.82it/s] 90%|████████▉ | 321/358 [00:32<00:03,  9.75it/s] 90%|████████▉ | 322/358 [00:32<00:03,  9.70it/s] 90%|█████████ | 323/358 [00:32<00:03,  9.66it/s] 91%|█████████ | 324/358 [00:33<00:03,  9.63it/s] 91%|█████████ | 325/358 [00:33<00:03,  9.61it/s] 91%|█████████▏| 327/358 [00:33<00:03,  9.98it/s] 92%|█████████▏| 329/358 [00:33<00:02, 10.07it/s] 92%|█████████▏| 330/358 [00:33<00:02,  9.96it/s] 93%|█████████▎| 332/358 [00:33<00:02, 10.06it/s] 93%|█████████▎| 334/358 [00:34<00:02,  9.97it/s] 94%|█████████▎| 335/358 [00:34<00:02,  9.84it/s] 94%|█████████▍| 337/358 [00:34<00:02,  9.92it/s] 95%|█████████▍| 339/358 [00:34<00:01, 10.12it/s] 95%|█████████▌| 341/358 [00:34<00:01, 10.06it/s] 96%|█████████▌| 343/358 [00:34<00:01,  9.90it/s] 96%|█████████▌| 344/358 [00:35<00:01,  9.84it/s] 96%|█████████▋| 345/358 [00:35<00:01,  9.86it/s] 97%|█████████▋| 347/358 [00:35<00:01, 10.04it/s] 97%|█████████▋| 348/358 [00:35<00:01,  9.94it/s] 97%|█████████▋| 349/358 [00:35<00:00,  9.86it/s] 98%|█████████▊| 350/358 [00:35<00:00,  9.79it/s] 98%|█████████▊| 351/358 [00:35<00:00,  9.75it/s] 99%|█████████▊| 353/358 [00:35<00:00,  9.93it/s] 99%|█████████▉| 354/358 [00:36<00:00,  9.91it/s] 99%|█████████▉| 355/358 [00:36<00:00,  9.82it/s]100%|█████████▉| 357/358 [00:36<00:00,  9.88it/s]100%|██████████| 358/358 [00:36<00:00,  9.83it/s]
[32m2025-02-05 06:21:20.459[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    gen_loss  grad clip ratio  grad norm   ppl
       1.815                1      4.356 6.142[0m
[32m2025-02-05 06:21:20.460[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m169[0m - [1m[Valid][0m
  0%|          | 0/10256 [00:00<?, ?it/s]100%|██████████| 10256/10256 [00:00<00:00, 932128.15it/s]
[32m2025-02-05 06:21:20.471[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:27,  1.42it/s]  5%|▌         | 2/40 [00:01<00:26,  1.44it/s]  8%|▊         | 3/40 [00:02<00:25,  1.45it/s] 10%|█         | 4/40 [00:02<00:24,  1.45it/s] 12%|█▎        | 5/40 [00:03<00:24,  1.44it/s] 15%|█▌        | 6/40 [00:04<00:23,  1.44it/s] 18%|█▊        | 7/40 [00:04<00:23,  1.43it/s] 20%|██        | 8/40 [00:05<00:22,  1.44it/s] 22%|██▎       | 9/40 [00:06<00:21,  1.45it/s] 25%|██▌       | 10/40 [00:06<00:20,  1.45it/s] 28%|██▊       | 11/40 [00:07<00:20,  1.45it/s] 30%|███       | 12/40 [00:08<00:19,  1.45it/s] 32%|███▎      | 13/40 [00:08<00:18,  1.45it/s] 35%|███▌      | 14/40 [00:09<00:18,  1.44it/s] 38%|███▊      | 15/40 [00:10<00:17,  1.44it/s] 40%|████      | 16/40 [00:11<00:16,  1.44it/s] 42%|████▎     | 17/40 [00:11<00:15,  1.45it/s] 45%|████▌     | 18/40 [00:12<00:15,  1.45it/s] 48%|████▊     | 19/40 [00:13<00:14,  1.44it/s] 50%|█████     | 20/40 [00:13<00:13,  1.45it/s] 52%|█████▎    | 21/40 [00:14<00:13,  1.46it/s] 55%|█████▌    | 22/40 [00:15<00:12,  1.45it/s] 57%|█████▊    | 23/40 [00:15<00:11,  1.45it/s] 60%|██████    | 24/40 [00:16<00:11,  1.44it/s] 62%|██████▎   | 25/40 [00:17<00:10,  1.44it/s] 65%|██████▌   | 26/40 [00:17<00:09,  1.45it/s] 68%|██████▊   | 27/40 [00:18<00:08,  1.45it/s] 70%|███████   | 28/40 [00:19<00:08,  1.45it/s] 72%|███████▎  | 29/40 [00:20<00:07,  1.45it/s] 75%|███████▌  | 30/40 [00:20<00:06,  1.45it/s] 78%|███████▊  | 31/40 [00:21<00:06,  1.45it/s] 80%|████████  | 32/40 [00:22<00:05,  1.45it/s] 82%|████████▎ | 33/40 [00:22<00:04,  1.45it/s] 85%|████████▌ | 34/40 [00:23<00:04,  1.45it/s] 88%|████████▊ | 35/40 [00:24<00:03,  1.45it/s] 90%|█████████ | 36/40 [00:24<00:02,  1.44it/s] 92%|█████████▎| 37/40 [00:25<00:02,  1.45it/s] 95%|█████████▌| 38/40 [00:26<00:01,  1.44it/s] 98%|█████████▊| 39/40 [00:26<00:00,  1.44it/s]100%|██████████| 40/40 [00:27<00:00,  1.59it/s]100%|██████████| 40/40 [00:27<00:00,  1.46it/s]
[32m2025-02-05 06:21:47.928[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    average  bleu@1  bleu@2  bleu@3  bleu@4  dist@1  dist@2  dist@3  dist@4  extreme  \
      .7738   .2964   .1080  .03946  .01866  .04452   .3084   .5787   .7395    .5928   
      f1  gen_loss  greedy  intra_dist@1  intra_dist@2  intra_dist@3  intra_dist@4  \
   .3461      5.22   .6662         .8544         .9579         .9457         .9160   
    ppl  rouge1  rouge2  rougeL  
    185   .3825  .08704   .3701[0m
[32m2025-02-05 06:21:47.935[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m163[0m - [1m[Conversation epoch 69][0m
[32m2025-02-05 06:21:47.935[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m164[0m - [1m[Train][0m
  0%|          | 0/92414 [00:00<?, ?it/s]100%|██████████| 92414/92414 [00:00<00:00, 1106758.86it/s]
[32m2025-02-05 06:21:48.019[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/358 [00:00<?, ?it/s]  0%|          | 1/358 [00:00<00:36,  9.78it/s]  1%|          | 3/358 [00:00<00:35,  9.95it/s]  1%|          | 4/358 [00:00<00:35,  9.93it/s]  2%|▏         | 6/358 [00:00<00:35,  9.89it/s]  2%|▏         | 7/358 [00:00<00:35,  9.82it/s]  2%|▏         | 8/358 [00:00<00:35,  9.87it/s]  3%|▎         | 9/358 [00:00<00:35,  9.77it/s]  3%|▎         | 10/358 [00:01<00:35,  9.76it/s]  3%|▎         | 11/358 [00:01<00:35,  9.70it/s]  4%|▎         | 13/358 [00:01<00:34,  9.93it/s]  4%|▍         | 14/358 [00:01<00:34,  9.85it/s]  4%|▍         | 15/358 [00:01<00:35,  9.78it/s]  4%|▍         | 16/358 [00:01<00:35,  9.72it/s]  5%|▍         | 17/358 [00:01<00:35,  9.73it/s]  5%|▌         | 19/358 [00:01<00:34,  9.76it/s]  6%|▌         | 20/358 [00:02<00:34,  9.70it/s]  6%|▌         | 21/358 [00:02<00:34,  9.64it/s]  6%|▌         | 22/358 [00:02<00:34,  9.69it/s]  7%|▋         | 24/358 [00:02<00:34,  9.78it/s]  7%|▋         | 25/358 [00:02<00:34,  9.73it/s]  7%|▋         | 26/358 [00:02<00:34,  9.68it/s]  8%|▊         | 27/358 [00:02<00:33,  9.74it/s]  8%|▊         | 28/358 [00:02<00:34,  9.69it/s]  8%|▊         | 29/358 [00:02<00:34,  9.66it/s]  9%|▊         | 31/358 [00:03<00:33,  9.76it/s]  9%|▉         | 32/358 [00:03<00:33,  9.76it/s]  9%|▉         | 34/358 [00:03<00:32,  9.86it/s] 10%|█         | 36/358 [00:03<00:32,  9.85it/s] 10%|█         | 37/358 [00:03<00:32,  9.84it/s] 11%|█         | 38/358 [00:03<00:32,  9.79it/s] 11%|█         | 40/358 [00:04<00:31,  9.95it/s] 11%|█▏        | 41/358 [00:04<00:32,  9.86it/s] 12%|█▏        | 43/358 [00:04<00:31,  9.89it/s] 13%|█▎        | 45/358 [00:04<00:31,  9.99it/s] 13%|█▎        | 47/358 [00:04<00:31,  9.96it/s] 13%|█▎        | 48/358 [00:04<00:31,  9.95it/s] 14%|█▍        | 50/358 [00:05<00:31,  9.92it/s] 14%|█▍        | 51/358 [00:05<00:31,  9.86it/s] 15%|█▍        | 52/358 [00:05<00:31,  9.77it/s] 15%|█▍        | 53/358 [00:05<00:31,  9.71it/s] 15%|█▌        | 54/358 [00:05<00:31,  9.75it/s] 15%|█▌        | 55/358 [00:05<00:31,  9.70it/s] 16%|█▌        | 56/358 [00:05<00:30,  9.74it/s] 16%|█▌        | 57/358 [00:05<00:31,  9.70it/s] 16%|█▌        | 58/358 [00:05<00:30,  9.68it/s] 16%|█▋        | 59/358 [00:06<00:30,  9.65it/s] 17%|█▋        | 61/358 [00:06<00:30,  9.73it/s] 17%|█▋        | 62/358 [00:06<00:30,  9.66it/s] 18%|█▊        | 63/358 [00:06<00:30,  9.72it/s] 18%|█▊        | 64/358 [00:06<00:30,  9.67it/s] 18%|█▊        | 66/358 [00:06<00:29,  9.74it/s] 19%|█▊        | 67/358 [00:06<00:29,  9.73it/s] 19%|█▉        | 69/358 [00:07<00:29,  9.79it/s] 20%|█▉        | 70/358 [00:07<00:29,  9.73it/s] 20%|█▉        | 71/358 [00:07<00:29,  9.78it/s] 20%|██        | 72/358 [00:07<00:29,  9.73it/s] 20%|██        | 73/358 [00:07<00:29,  9.69it/s] 21%|██        | 74/358 [00:07<00:29,  9.65it/s] 21%|██        | 75/358 [00:07<00:29,  9.62it/s] 21%|██        | 76/358 [00:07<00:28,  9.73it/s] 22%|██▏       | 77/358 [00:07<00:28,  9.69it/s] 22%|██▏       | 79/358 [00:08<00:28,  9.70it/s] 23%|██▎       | 81/358 [00:08<00:28,  9.76it/s] 23%|██▎       | 83/358 [00:08<00:28,  9.78it/s] 23%|██▎       | 84/358 [00:08<00:28,  9.73it/s] 24%|██▎       | 85/358 [00:08<00:28,  9.69it/s] 24%|██▍       | 86/358 [00:08<00:28,  9.67it/s] 24%|██▍       | 87/358 [00:08<00:28,  9.66it/s] 25%|██▍       | 88/358 [00:09<00:27,  9.67it/s] 25%|██▌       | 90/358 [00:09<00:27,  9.91it/s] 26%|██▌       | 92/358 [00:09<00:26, 10.01it/s] 26%|██▌       | 93/358 [00:09<00:26,  9.97it/s] 26%|██▋       | 94/358 [00:09<00:26,  9.89it/s] 27%|██▋       | 96/358 [00:09<00:25, 10.16it/s] 27%|██▋       | 98/358 [00:09<00:25, 10.05it/s] 28%|██▊       | 99/358 [00:10<00:26,  9.96it/s] 28%|██▊       | 101/358 [00:10<00:25,  9.93it/s] 29%|██▉       | 103/358 [00:10<00:25,  9.92it/s] 29%|██▉       | 104/358 [00:10<00:25,  9.87it/s] 29%|██▉       | 105/358 [00:10<00:25,  9.79it/s] 30%|██▉       | 106/358 [00:10<00:25,  9.78it/s] 30%|███       | 108/358 [00:11<00:25,  9.81it/s] 30%|███       | 109/358 [00:11<00:25,  9.72it/s] 31%|███       | 110/358 [00:11<00:25,  9.71it/s] 31%|███       | 111/358 [00:11<00:25,  9.66it/s] 32%|███▏      | 113/358 [00:11<00:24,  9.93it/s] 32%|███▏      | 114/358 [00:11<00:24,  9.88it/s] 32%|███▏      | 115/358 [00:11<00:24,  9.79it/s] 32%|███▏      | 116/358 [00:11<00:24,  9.70it/s] 33%|███▎      | 117/358 [00:11<00:24,  9.68it/s] 33%|███▎      | 119/358 [00:12<00:24,  9.79it/s] 34%|███▍      | 121/358 [00:12<00:23,  9.99it/s] 34%|███▍      | 123/358 [00:12<00:23, 10.09it/s] 35%|███▍      | 125/358 [00:12<00:23, 10.07it/s] 35%|███▌      | 127/358 [00:12<00:23,  9.99it/s] 36%|███▌      | 128/358 [00:13<00:23,  9.95it/s] 36%|███▋      | 130/358 [00:13<00:22, 10.00it/s] 37%|███▋      | 131/358 [00:13<00:22,  9.91it/s] 37%|███▋      | 132/358 [00:13<00:22,  9.93it/s] 37%|███▋      | 134/358 [00:13<00:22,  9.95it/s] 38%|███▊      | 135/358 [00:13<00:22,  9.88it/s] 38%|███▊      | 137/358 [00:13<00:22,  9.97it/s] 39%|███▊      | 138/358 [00:14<00:22,  9.95it/s] 39%|███▉      | 139/358 [00:14<00:22,  9.87it/s] 39%|███▉      | 141/358 [00:14<00:21,  9.99it/s] 40%|███▉      | 142/358 [00:14<00:21,  9.91it/s] 40%|███▉      | 143/358 [00:14<00:21,  9.88it/s] 40%|████      | 144/358 [00:14<00:21,  9.79it/s] 41%|████      | 145/358 [00:14<00:21,  9.81it/s] 41%|████      | 146/358 [00:14<00:21,  9.74it/s] 41%|████      | 147/358 [00:14<00:21,  9.68it/s] 41%|████▏     | 148/358 [00:15<00:21,  9.71it/s] 42%|████▏     | 149/358 [00:15<00:21,  9.69it/s] 42%|████▏     | 150/358 [00:15<00:21,  9.65it/s] 42%|████▏     | 151/358 [00:15<00:22,  9.39it/s] 42%|████▏     | 152/358 [00:15<00:21,  9.43it/s] 43%|████▎     | 153/358 [00:15<00:21,  9.45it/s] 43%|████▎     | 154/358 [00:15<00:21,  9.53it/s] 43%|████▎     | 155/358 [00:15<00:21,  9.54it/s] 44%|████▎     | 156/358 [00:15<00:20,  9.67it/s] 44%|████▍     | 157/358 [00:16<00:20,  9.61it/s] 44%|████▍     | 158/358 [00:16<00:20,  9.70it/s] 44%|████▍     | 159/358 [00:16<00:20,  9.70it/s] 45%|████▍     | 160/358 [00:16<00:20,  9.71it/s] 45%|████▌     | 162/358 [00:16<00:19, 10.00it/s] 46%|████▌     | 164/358 [00:16<00:19, 10.00it/s] 46%|████▌     | 165/358 [00:16<00:19,  9.96it/s] 47%|████▋     | 167/358 [00:17<00:19,  9.91it/s] 47%|████▋     | 169/358 [00:17<00:18,  9.95it/s] 48%|████▊     | 171/358 [00:17<00:18,  9.93it/s] 48%|████▊     | 172/358 [00:17<00:18,  9.88it/s] 48%|████▊     | 173/358 [00:17<00:18,  9.82it/s] 49%|████▉     | 175/358 [00:17<00:18,  9.84it/s] 49%|████▉     | 176/358 [00:17<00:18,  9.79it/s] 49%|████▉     | 177/358 [00:18<00:18,  9.79it/s] 50%|█████     | 179/358 [00:18<00:18,  9.83it/s] 50%|█████     | 180/358 [00:18<00:18,  9.77it/s] 51%|█████     | 182/358 [00:18<00:17,  9.93it/s] 51%|█████     | 183/358 [00:18<00:17,  9.88it/s] 51%|█████▏    | 184/358 [00:18<00:17,  9.77it/s] 52%|█████▏    | 185/358 [00:18<00:17,  9.72it/s] 52%|█████▏    | 187/358 [00:19<00:17,  9.94it/s] 53%|█████▎    | 188/358 [00:19<00:17,  9.89it/s] 53%|█████▎    | 189/358 [00:19<00:17,  9.83it/s] 53%|█████▎    | 191/358 [00:19<00:17,  9.75it/s] 54%|█████▎    | 192/358 [00:19<00:17,  9.70it/s] 54%|█████▍    | 193/358 [00:19<00:17,  9.70it/s] 54%|█████▍    | 194/358 [00:19<00:16,  9.67it/s] 54%|█████▍    | 195/358 [00:19<00:16,  9.74it/s] 55%|█████▌    | 197/358 [00:20<00:16,  9.92it/s] 55%|█████▌    | 198/358 [00:20<00:16,  9.85it/s] 56%|█████▌    | 199/358 [00:20<00:16,  9.88it/s] 56%|█████▌    | 200/358 [00:20<00:16,  9.81it/s] 56%|█████▌    | 201/358 [00:20<00:16,  9.77it/s] 57%|█████▋    | 203/358 [00:20<00:15,  9.86it/s] 57%|█████▋    | 204/358 [00:20<00:15,  9.76it/s] 57%|█████▋    | 205/358 [00:20<00:15,  9.70it/s] 58%|█████▊    | 207/358 [00:21<00:15,  9.87it/s] 58%|█████▊    | 208/358 [00:21<00:15,  9.80it/s] 59%|█████▊    | 210/358 [00:21<00:15,  9.82it/s] 59%|█████▉    | 212/358 [00:21<00:14,  9.81it/s] 60%|█████▉    | 214/358 [00:21<00:14,  9.90it/s] 60%|██████    | 215/358 [00:21<00:14,  9.83it/s] 60%|██████    | 216/358 [00:22<00:14,  9.76it/s] 61%|██████    | 217/358 [00:22<00:14,  9.80it/s] 61%|██████    | 218/358 [00:22<00:14,  9.77it/s] 61%|██████    | 219/358 [00:22<00:14,  9.77it/s] 62%|██████▏   | 221/358 [00:22<00:13,  9.91it/s] 62%|██████▏   | 222/358 [00:22<00:13,  9.80it/s] 62%|██████▏   | 223/358 [00:22<00:13,  9.75it/s] 63%|██████▎   | 224/358 [00:22<00:13,  9.70it/s] 63%|██████▎   | 225/358 [00:22<00:13,  9.78it/s] 63%|██████▎   | 226/358 [00:23<00:13,  9.72it/s] 64%|██████▎   | 228/358 [00:23<00:13,  9.76it/s] 64%|██████▍   | 229/358 [00:23<00:13,  9.73it/s] 64%|██████▍   | 230/358 [00:23<00:13,  9.68it/s] 65%|██████▍   | 232/358 [00:23<00:12,  9.74it/s] 65%|██████▌   | 234/358 [00:23<00:12, 10.03it/s] 66%|██████▌   | 236/358 [00:24<00:12,  9.99it/s] 66%|██████▋   | 238/358 [00:24<00:11, 10.04it/s] 67%|██████▋   | 240/358 [00:24<00:11, 10.00it/s] 68%|██████▊   | 242/358 [00:24<00:11,  9.98it/s] 68%|██████▊   | 243/358 [00:24<00:11,  9.92it/s] 68%|██████▊   | 244/358 [00:24<00:11,  9.85it/s] 69%|██████▊   | 246/358 [00:25<00:11,  9.87it/s] 69%|██████▉   | 247/358 [00:25<00:11,  9.80it/s] 69%|██████▉   | 248/358 [00:25<00:11,  9.76it/s] 70%|██████▉   | 250/358 [00:25<00:10,  9.86it/s] 70%|███████   | 251/358 [00:25<00:10,  9.80it/s] 70%|███████   | 252/358 [00:25<00:10,  9.73it/s] 71%|███████   | 253/358 [00:25<00:10,  9.69it/s] 71%|███████   | 254/358 [00:25<00:10,  9.66it/s] 72%|███████▏  | 256/358 [00:26<00:10,  9.84it/s] 72%|███████▏  | 257/358 [00:26<00:10,  9.84it/s] 72%|███████▏  | 258/358 [00:26<00:10,  9.71it/s] 72%|███████▏  | 259/358 [00:26<00:10,  9.68it/s] 73%|███████▎  | 260/358 [00:26<00:10,  9.72it/s] 73%|███████▎  | 262/358 [00:26<00:09,  9.89it/s] 74%|███████▎  | 264/358 [00:26<00:09,  9.92it/s] 74%|███████▍  | 266/358 [00:27<00:09,  9.91it/s] 75%|███████▍  | 267/358 [00:27<00:09,  9.84it/s] 75%|███████▌  | 269/358 [00:27<00:08,  9.90it/s] 75%|███████▌  | 270/358 [00:27<00:08,  9.83it/s] 76%|███████▌  | 271/358 [00:27<00:08,  9.75it/s] 76%|███████▌  | 272/358 [00:27<00:08,  9.73it/s] 76%|███████▋  | 273/358 [00:27<00:08,  9.63it/s] 77%|███████▋  | 274/358 [00:27<00:08,  9.63it/s] 77%|███████▋  | 275/358 [00:28<00:08,  9.68it/s] 77%|███████▋  | 276/358 [00:28<00:08,  9.68it/s] 77%|███████▋  | 277/358 [00:28<00:08,  9.66it/s] 78%|███████▊  | 278/358 [00:28<00:08,  9.63it/s] 78%|███████▊  | 280/358 [00:28<00:07,  9.83it/s] 78%|███████▊  | 281/358 [00:28<00:07,  9.83it/s] 79%|███████▉  | 282/358 [00:28<00:07,  9.78it/s] 79%|███████▉  | 283/358 [00:28<00:07,  9.71it/s] 79%|███████▉  | 284/358 [00:28<00:07,  9.68it/s] 80%|███████▉  | 285/358 [00:29<00:07,  9.74it/s] 80%|███████▉  | 286/358 [00:29<00:07,  9.70it/s] 80%|████████  | 287/358 [00:29<00:07,  9.68it/s] 80%|████████  | 288/358 [00:29<00:07,  9.63it/s] 81%|████████  | 290/358 [00:29<00:06,  9.85it/s] 81%|████████▏ | 291/358 [00:29<00:06,  9.83it/s] 82%|████████▏ | 293/358 [00:29<00:06,  9.84it/s] 82%|████████▏ | 295/358 [00:30<00:06,  9.91it/s] 83%|████████▎ | 296/358 [00:30<00:06,  9.85it/s] 83%|████████▎ | 297/358 [00:30<00:06,  9.74it/s] 84%|████████▎ | 299/358 [00:30<00:05,  9.90it/s] 84%|████████▍ | 301/358 [00:30<00:05,  9.94it/s] 84%|████████▍ | 302/358 [00:30<00:05,  9.87it/s] 85%|████████▍ | 303/358 [00:30<00:05,  9.88it/s] 85%|████████▌ | 305/358 [00:31<00:05,  9.91it/s] 85%|████████▌ | 306/358 [00:31<00:05,  9.83it/s] 86%|████████▌ | 308/358 [00:31<00:05,  9.93it/s] 86%|████████▋ | 309/358 [00:31<00:04,  9.83it/s] 87%|████████▋ | 310/358 [00:31<00:04,  9.77it/s] 87%|████████▋ | 311/358 [00:31<00:04,  9.69it/s] 87%|████████▋ | 312/358 [00:31<00:04,  9.71it/s] 87%|████████▋ | 313/358 [00:31<00:04,  9.73it/s] 88%|████████▊ | 315/358 [00:32<00:04,  9.99it/s] 88%|████████▊ | 316/358 [00:32<00:04,  9.94it/s] 89%|████████▊ | 317/358 [00:32<00:04,  9.86it/s] 89%|████████▉ | 318/358 [00:32<00:04,  9.81it/s] 89%|████████▉ | 319/358 [00:32<00:03,  9.76it/s] 89%|████████▉ | 320/358 [00:32<00:03,  9.82it/s] 90%|████████▉ | 321/358 [00:32<00:03,  9.75it/s] 90%|████████▉ | 322/358 [00:32<00:03,  9.71it/s] 90%|█████████ | 323/358 [00:32<00:03,  9.66it/s] 91%|█████████ | 324/358 [00:33<00:03,  9.63it/s] 91%|█████████ | 325/358 [00:33<00:03,  9.61it/s] 91%|█████████▏| 327/358 [00:33<00:03,  9.97it/s] 92%|█████████▏| 329/358 [00:33<00:02, 10.07it/s] 92%|█████████▏| 330/358 [00:33<00:02,  9.96it/s] 93%|█████████▎| 332/358 [00:33<00:02, 10.06it/s] 93%|█████████▎| 334/358 [00:34<00:02,  9.96it/s] 94%|█████████▎| 335/358 [00:34<00:02,  9.84it/s] 94%|█████████▍| 337/358 [00:34<00:02,  9.92it/s] 95%|█████████▍| 339/358 [00:34<00:01, 10.12it/s] 95%|█████████▌| 341/358 [00:34<00:01, 10.06it/s] 96%|█████████▌| 343/358 [00:34<00:01,  9.90it/s] 96%|█████████▌| 344/358 [00:35<00:01,  9.85it/s] 96%|█████████▋| 345/358 [00:35<00:01,  9.86it/s] 97%|█████████▋| 347/358 [00:35<00:01, 10.04it/s] 97%|█████████▋| 348/358 [00:35<00:01,  9.94it/s] 97%|█████████▋| 349/358 [00:35<00:00,  9.86it/s] 98%|█████████▊| 350/358 [00:35<00:00,  9.79it/s] 98%|█████████▊| 351/358 [00:35<00:00,  9.74it/s] 99%|█████████▊| 353/358 [00:35<00:00,  9.92it/s] 99%|█████████▉| 354/358 [00:36<00:00,  9.91it/s] 99%|█████████▉| 355/358 [00:36<00:00,  9.82it/s]100%|█████████▉| 357/358 [00:36<00:00,  9.87it/s]100%|██████████| 358/358 [00:36<00:00,  9.83it/s]
[32m2025-02-05 06:22:24.447[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    gen_loss  grad clip ratio  grad norm   ppl
       1.804                1      2.234 6.073[0m
[32m2025-02-05 06:22:24.448[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m169[0m - [1m[Valid][0m
  0%|          | 0/10256 [00:00<?, ?it/s]100%|██████████| 10256/10256 [00:00<00:00, 922809.86it/s]
[32m2025-02-05 06:22:24.459[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:27,  1.43it/s]  5%|▌         | 2/40 [00:01<00:26,  1.45it/s]  8%|▊         | 3/40 [00:02<00:25,  1.45it/s] 10%|█         | 4/40 [00:02<00:24,  1.45it/s] 12%|█▎        | 5/40 [00:03<00:24,  1.45it/s] 15%|█▌        | 6/40 [00:04<00:23,  1.45it/s] 18%|█▊        | 7/40 [00:04<00:22,  1.44it/s] 20%|██        | 8/40 [00:05<00:22,  1.45it/s] 22%|██▎       | 9/40 [00:06<00:21,  1.46it/s] 25%|██▌       | 10/40 [00:06<00:20,  1.46it/s] 28%|██▊       | 11/40 [00:07<00:19,  1.46it/s] 30%|███       | 12/40 [00:08<00:19,  1.46it/s] 32%|███▎      | 13/40 [00:08<00:18,  1.46it/s] 35%|███▌      | 14/40 [00:09<00:17,  1.45it/s] 38%|███▊      | 15/40 [00:10<00:17,  1.45it/s] 40%|████      | 16/40 [00:11<00:16,  1.45it/s] 42%|████▎     | 17/40 [00:11<00:15,  1.46it/s] 45%|████▌     | 18/40 [00:12<00:15,  1.45it/s] 48%|████▊     | 19/40 [00:13<00:14,  1.45it/s] 50%|█████     | 20/40 [00:13<00:13,  1.46it/s] 52%|█████▎    | 21/40 [00:14<00:12,  1.46it/s] 55%|█████▌    | 22/40 [00:15<00:12,  1.46it/s] 57%|█████▊    | 23/40 [00:15<00:11,  1.46it/s] 60%|██████    | 24/40 [00:16<00:11,  1.45it/s] 62%|██████▎   | 25/40 [00:17<00:10,  1.45it/s] 65%|██████▌   | 26/40 [00:17<00:09,  1.46it/s] 68%|██████▊   | 27/40 [00:18<00:08,  1.45it/s] 70%|███████   | 28/40 [00:19<00:08,  1.45it/s] 72%|███████▎  | 29/40 [00:19<00:07,  1.45it/s] 75%|███████▌  | 30/40 [00:20<00:06,  1.46it/s] 78%|███████▊  | 31/40 [00:21<00:06,  1.45it/s] 80%|████████  | 32/40 [00:22<00:05,  1.46it/s] 82%|████████▎ | 33/40 [00:22<00:04,  1.45it/s] 85%|████████▌ | 34/40 [00:23<00:04,  1.45it/s] 88%|████████▊ | 35/40 [00:24<00:03,  1.45it/s] 90%|█████████ | 36/40 [00:24<00:02,  1.45it/s] 92%|█████████▎| 37/40 [00:25<00:02,  1.45it/s] 95%|█████████▌| 38/40 [00:26<00:01,  1.45it/s] 98%|█████████▊| 39/40 [00:26<00:00,  1.44it/s]100%|██████████| 40/40 [00:27<00:00,  1.59it/s]100%|██████████| 40/40 [00:27<00:00,  1.46it/s]
[32m2025-02-05 06:22:51.793[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    average  bleu@1  bleu@2  bleu@3  bleu@4  dist@1  dist@2  dist@3  dist@4  extreme  \
      .7759   .3038   .1103  .04043  .02144  .04333   .3026   .5731   .7242    .5953   
      f1  gen_loss  greedy  intra_dist@1  intra_dist@2  intra_dist@3  intra_dist@4  \
   .3505     5.225   .6686         .8572         .9542         .9407         .9134   
     ppl  rouge1  rouge2  rougeL  
   185.9   .3869  .08848   .3742[0m
[32m2025-02-05 06:22:51.799[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m163[0m - [1m[Conversation epoch 70][0m
[32m2025-02-05 06:22:51.799[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m164[0m - [1m[Train][0m
  0%|          | 0/92414 [00:00<?, ?it/s]100%|██████████| 92414/92414 [00:00<00:00, 1123244.00it/s]
[32m2025-02-05 06:22:51.882[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/358 [00:00<?, ?it/s]  0%|          | 1/358 [00:00<00:36,  9.77it/s]  1%|          | 3/358 [00:00<00:35,  9.95it/s]  1%|          | 4/358 [00:00<00:35,  9.92it/s]  2%|▏         | 6/358 [00:00<00:35,  9.88it/s]  2%|▏         | 7/358 [00:00<00:35,  9.82it/s]  2%|▏         | 8/358 [00:00<00:35,  9.86it/s]  3%|▎         | 9/358 [00:00<00:35,  9.76it/s]  3%|▎         | 10/358 [00:01<00:35,  9.75it/s]  3%|▎         | 11/358 [00:01<00:35,  9.70it/s]  4%|▎         | 13/358 [00:01<00:34,  9.92it/s]  4%|▍         | 14/358 [00:01<00:34,  9.85it/s]  4%|▍         | 15/358 [00:01<00:35,  9.77it/s]  4%|▍         | 16/358 [00:01<00:35,  9.71it/s]  5%|▍         | 17/358 [00:01<00:35,  9.72it/s]  5%|▌         | 19/358 [00:01<00:34,  9.75it/s]  6%|▌         | 20/358 [00:02<00:34,  9.70it/s]  6%|▌         | 21/358 [00:02<00:34,  9.64it/s]  6%|▌         | 22/358 [00:02<00:34,  9.69it/s]  7%|▋         | 24/358 [00:02<00:34,  9.78it/s]  7%|▋         | 25/358 [00:02<00:34,  9.73it/s]  7%|▋         | 26/358 [00:02<00:34,  9.67it/s]  8%|▊         | 27/358 [00:02<00:34,  9.73it/s]  8%|▊         | 28/358 [00:02<00:34,  9.68it/s]  8%|▊         | 29/358 [00:02<00:34,  9.65it/s]  9%|▊         | 31/358 [00:03<00:33,  9.76it/s]  9%|▉         | 32/358 [00:03<00:33,  9.75it/s]  9%|▉         | 34/358 [00:03<00:32,  9.85it/s] 10%|█         | 36/358 [00:03<00:32,  9.84it/s] 10%|█         | 37/358 [00:03<00:32,  9.82it/s] 11%|█         | 38/358 [00:03<00:32,  9.78it/s] 11%|█         | 40/358 [00:04<00:31,  9.94it/s] 11%|█▏        | 41/358 [00:04<00:32,  9.86it/s] 12%|█▏        | 43/358 [00:04<00:31,  9.89it/s] 13%|█▎        | 45/358 [00:04<00:31,  9.98it/s] 13%|█▎        | 47/358 [00:04<00:31,  9.95it/s] 13%|█▎        | 48/358 [00:04<00:31,  9.94it/s] 14%|█▍        | 50/358 [00:05<00:31,  9.91it/s] 14%|█▍        | 51/358 [00:05<00:31,  9.85it/s] 15%|█▍        | 52/358 [00:05<00:31,  9.76it/s] 15%|█▍        | 53/358 [00:05<00:31,  9.71it/s] 15%|█▌        | 54/358 [00:05<00:31,  9.75it/s] 15%|█▌        | 55/358 [00:05<00:31,  9.70it/s] 16%|█▌        | 56/358 [00:05<00:30,  9.74it/s] 16%|█▌        | 57/358 [00:05<00:31,  9.70it/s] 16%|█▌        | 58/358 [00:05<00:31,  9.67it/s] 16%|█▋        | 59/358 [00:06<00:31,  9.64it/s] 17%|█▋        | 61/358 [00:06<00:30,  9.73it/s] 17%|█▋        | 62/358 [00:06<00:30,  9.65it/s] 18%|█▊        | 63/358 [00:06<00:30,  9.72it/s] 18%|█▊        | 64/358 [00:06<00:30,  9.67it/s] 18%|█▊        | 66/358 [00:06<00:29,  9.74it/s] 19%|█▊        | 67/358 [00:06<00:29,  9.72it/s] 19%|█▉        | 69/358 [00:07<00:29,  9.79it/s] 20%|█▉        | 70/358 [00:07<00:29,  9.73it/s] 20%|█▉        | 71/358 [00:07<00:29,  9.78it/s] 20%|██        | 72/358 [00:07<00:29,  9.72it/s] 20%|██        | 73/358 [00:07<00:29,  9.69it/s] 21%|██        | 74/358 [00:07<00:29,  9.66it/s] 21%|██        | 75/358 [00:07<00:29,  9.63it/s] 21%|██        | 76/358 [00:07<00:28,  9.73it/s] 22%|██▏       | 77/358 [00:07<00:28,  9.70it/s] 22%|██▏       | 79/358 [00:08<00:28,  9.70it/s] 23%|██▎       | 81/358 [00:08<00:28,  9.75it/s] 23%|██▎       | 83/358 [00:08<00:28,  9.78it/s] 23%|██▎       | 84/358 [00:08<00:28,  9.72it/s] 24%|██▎       | 85/358 [00:08<00:28,  9.68it/s] 24%|██▍       | 86/358 [00:08<00:28,  9.67it/s] 24%|██▍       | 87/358 [00:08<00:28,  9.65it/s] 25%|██▍       | 88/358 [00:09<00:27,  9.67it/s] 25%|██▌       | 90/358 [00:09<00:27,  9.91it/s] 26%|██▌       | 92/358 [00:09<00:26, 10.01it/s] 26%|██▌       | 93/358 [00:09<00:26,  9.97it/s] 26%|██▋       | 94/358 [00:09<00:26,  9.88it/s] 27%|██▋       | 96/358 [00:09<00:25, 10.16it/s] 27%|██▋       | 98/358 [00:10<00:25, 10.05it/s] 28%|██▊       | 99/358 [00:10<00:26,  9.96it/s] 28%|██▊       | 101/358 [00:10<00:25,  9.93it/s] 29%|██▉       | 103/358 [00:10<00:25,  9.91it/s] 29%|██▉       | 104/358 [00:10<00:25,  9.86it/s] 29%|██▉       | 105/358 [00:10<00:25,  9.79it/s] 30%|██▉       | 106/358 [00:10<00:25,  9.77it/s] 30%|███       | 108/358 [00:11<00:25,  9.79it/s] 30%|███       | 109/358 [00:11<00:25,  9.71it/s] 31%|███       | 110/358 [00:11<00:25,  9.70it/s] 31%|███       | 111/358 [00:11<00:25,  9.65it/s] 32%|███▏      | 113/358 [00:11<00:24,  9.91it/s] 32%|███▏      | 114/358 [00:11<00:24,  9.87it/s] 32%|███▏      | 115/358 [00:11<00:24,  9.78it/s] 32%|███▏      | 116/358 [00:11<00:24,  9.69it/s] 33%|███▎      | 117/358 [00:11<00:24,  9.66it/s] 33%|███▎      | 119/358 [00:12<00:24,  9.78it/s] 34%|███▍      | 121/358 [00:12<00:23,  9.98it/s] 34%|███▍      | 123/358 [00:12<00:23, 10.08it/s] 35%|███▍      | 125/358 [00:12<00:23, 10.06it/s] 35%|███▌      | 127/358 [00:12<00:23,  9.99it/s] 36%|███▌      | 128/358 [00:13<00:23,  9.94it/s] 36%|███▋      | 130/358 [00:13<00:22,  9.99it/s] 37%|███▋      | 131/358 [00:13<00:22,  9.90it/s] 37%|███▋      | 132/358 [00:13<00:22,  9.92it/s] 37%|███▋      | 134/358 [00:13<00:22,  9.93it/s] 38%|███▊      | 135/358 [00:13<00:22,  9.86it/s] 38%|███▊      | 137/358 [00:13<00:22,  9.95it/s] 39%|███▊      | 138/358 [00:14<00:22,  9.94it/s] 39%|███▉      | 139/358 [00:14<00:22,  9.86it/s] 39%|███▉      | 141/358 [00:14<00:21,  9.98it/s] 40%|███▉      | 142/358 [00:14<00:21,  9.90it/s] 40%|███▉      | 143/358 [00:14<00:21,  9.87it/s] 40%|████      | 144/358 [00:14<00:21,  9.78it/s] 41%|████      | 145/358 [00:14<00:21,  9.81it/s] 41%|████      | 146/358 [00:14<00:21,  9.74it/s] 41%|████      | 147/358 [00:14<00:21,  9.69it/s] 41%|████▏     | 148/358 [00:15<00:21,  9.71it/s] 42%|████▏     | 149/358 [00:15<00:21,  9.69it/s] 42%|████▏     | 150/358 [00:15<00:21,  9.65it/s] 42%|████▏     | 151/358 [00:15<00:22,  9.39it/s] 42%|████▏     | 152/358 [00:15<00:21,  9.43it/s] 43%|████▎     | 153/358 [00:15<00:21,  9.45it/s] 43%|████▎     | 154/358 [00:15<00:21,  9.54it/s] 43%|████▎     | 155/358 [00:15<00:21,  9.55it/s] 44%|████▎     | 156/358 [00:15<00:20,  9.68it/s] 44%|████▍     | 157/358 [00:16<00:20,  9.62it/s] 44%|████▍     | 158/358 [00:16<00:20,  9.70it/s] 44%|████▍     | 159/358 [00:16<00:20,  9.70it/s] 45%|████▍     | 160/358 [00:16<00:20,  9.71it/s] 45%|████▌     | 162/358 [00:16<00:19, 10.00it/s] 46%|████▌     | 164/358 [00:16<00:19, 10.00it/s] 46%|████▌     | 165/358 [00:16<00:19,  9.96it/s] 47%|████▋     | 167/358 [00:17<00:19,  9.90it/s] 47%|████▋     | 169/358 [00:17<00:19,  9.94it/s] 48%|████▊     | 171/358 [00:17<00:18,  9.93it/s] 48%|████▊     | 172/358 [00:17<00:18,  9.87it/s] 48%|████▊     | 173/358 [00:17<00:18,  9.81it/s] 49%|████▉     | 175/358 [00:17<00:18,  9.84it/s] 49%|████▉     | 176/358 [00:17<00:18,  9.85it/s] 49%|████▉     | 177/358 [00:18<00:18,  9.84it/s] 50%|█████     | 179/358 [00:18<00:18,  9.86it/s] 50%|█████     | 180/358 [00:18<00:18,  9.79it/s] 51%|█████     | 182/358 [00:18<00:17,  9.94it/s] 51%|█████     | 183/358 [00:18<00:17,  9.89it/s] 51%|█████▏    | 184/358 [00:18<00:17,  9.78it/s] 52%|█████▏    | 185/358 [00:18<00:17,  9.73it/s] 52%|█████▏    | 187/358 [00:19<00:17,  9.94it/s] 53%|█████▎    | 188/358 [00:19<00:17,  9.89it/s] 53%|█████▎    | 189/358 [00:19<00:17,  9.83it/s] 53%|█████▎    | 191/358 [00:19<00:17,  9.75it/s] 54%|█████▎    | 192/358 [00:19<00:17,  9.70it/s] 54%|█████▍    | 193/358 [00:19<00:17,  9.70it/s] 54%|█████▍    | 194/358 [00:19<00:16,  9.67it/s] 54%|█████▍    | 195/358 [00:19<00:16,  9.74it/s] 55%|█████▌    | 197/358 [00:20<00:16,  9.92it/s] 55%|█████▌    | 198/358 [00:20<00:16,  9.84it/s] 56%|█████▌    | 199/358 [00:20<00:16,  9.87it/s] 56%|█████▌    | 200/358 [00:20<00:16,  9.81it/s] 56%|█████▌    | 201/358 [00:20<00:16,  9.77it/s] 57%|█████▋    | 203/358 [00:20<00:15,  9.86it/s] 57%|█████▋    | 204/358 [00:20<00:15,  9.75it/s] 57%|█████▋    | 205/358 [00:20<00:15,  9.71it/s] 58%|█████▊    | 207/358 [00:21<00:15,  9.88it/s] 58%|█████▊    | 208/358 [00:21<00:15,  9.81it/s] 59%|█████▊    | 210/358 [00:21<00:15,  9.82it/s] 59%|█████▉    | 212/358 [00:21<00:14,  9.82it/s] 60%|█████▉    | 214/358 [00:21<00:14,  9.90it/s] 60%|██████    | 215/358 [00:21<00:14,  9.83it/s] 60%|██████    | 216/358 [00:22<00:14,  9.77it/s] 61%|██████    | 217/358 [00:22<00:14,  9.80it/s] 61%|██████    | 218/358 [00:22<00:14,  9.77it/s] 61%|██████    | 219/358 [00:22<00:14,  9.78it/s] 62%|██████▏   | 221/358 [00:22<00:13,  9.90it/s] 62%|██████▏   | 222/358 [00:22<00:13,  9.80it/s] 62%|██████▏   | 223/358 [00:22<00:13,  9.75it/s] 63%|██████▎   | 224/358 [00:22<00:13,  9.69it/s] 63%|██████▎   | 226/358 [00:23<00:13,  9.74it/s] 64%|██████▎   | 228/358 [00:23<00:13,  9.77it/s] 64%|██████▍   | 229/358 [00:23<00:13,  9.74it/s] 64%|██████▍   | 230/358 [00:23<00:13,  9.69it/s] 65%|██████▍   | 232/358 [00:23<00:12,  9.74it/s] 65%|██████▌   | 234/358 [00:23<00:12, 10.02it/s] 66%|██████▌   | 236/358 [00:24<00:12,  9.98it/s] 66%|██████▋   | 238/358 [00:24<00:11, 10.04it/s] 67%|██████▋   | 240/358 [00:24<00:11, 10.00it/s] 68%|██████▊   | 242/358 [00:24<00:11,  9.98it/s] 68%|██████▊   | 243/358 [00:24<00:11,  9.91it/s] 68%|██████▊   | 244/358 [00:24<00:11,  9.85it/s] 69%|██████▊   | 246/358 [00:25<00:11,  9.87it/s] 69%|██████▉   | 247/358 [00:25<00:11,  9.80it/s] 69%|██████▉   | 248/358 [00:25<00:11,  9.76it/s] 70%|██████▉   | 250/358 [00:25<00:10,  9.85it/s] 70%|███████   | 251/358 [00:25<00:10,  9.79it/s] 70%|███████   | 252/358 [00:25<00:10,  9.73it/s] 71%|███████   | 253/358 [00:25<00:10,  9.69it/s] 71%|███████   | 254/358 [00:25<00:10,  9.66it/s] 72%|███████▏  | 256/358 [00:26<00:10,  9.83it/s] 72%|███████▏  | 257/358 [00:26<00:10,  9.84it/s] 72%|███████▏  | 258/358 [00:26<00:10,  9.71it/s] 72%|███████▏  | 259/358 [00:26<00:10,  9.68it/s] 73%|███████▎  | 260/358 [00:26<00:10,  9.72it/s] 73%|███████▎  | 262/358 [00:26<00:09,  9.89it/s] 74%|███████▎  | 264/358 [00:26<00:09,  9.91it/s] 74%|███████▍  | 266/358 [00:27<00:09,  9.91it/s] 75%|███████▍  | 267/358 [00:27<00:09,  9.84it/s] 75%|███████▌  | 269/358 [00:27<00:08,  9.90it/s] 75%|███████▌  | 270/358 [00:27<00:08,  9.83it/s] 76%|███████▌  | 271/358 [00:27<00:08,  9.76it/s] 76%|███████▌  | 272/358 [00:27<00:08,  9.74it/s] 76%|███████▋  | 273/358 [00:27<00:08,  9.64it/s] 77%|███████▋  | 274/358 [00:27<00:08,  9.63it/s] 77%|███████▋  | 275/358 [00:28<00:08,  9.68it/s] 77%|███████▋  | 276/358 [00:28<00:08,  9.68it/s] 77%|███████▋  | 277/358 [00:28<00:08,  9.65it/s] 78%|███████▊  | 278/358 [00:28<00:08,  9.63it/s] 78%|███████▊  | 280/358 [00:28<00:07,  9.82it/s] 78%|███████▊  | 281/358 [00:28<00:07,  9.83it/s] 79%|███████▉  | 282/358 [00:28<00:07,  9.77it/s] 79%|███████▉  | 283/358 [00:28<00:07,  9.70it/s] 79%|███████▉  | 284/358 [00:28<00:07,  9.67it/s] 80%|███████▉  | 285/358 [00:29<00:07,  9.73it/s] 80%|███████▉  | 286/358 [00:29<00:07,  9.69it/s] 80%|████████  | 287/358 [00:29<00:07,  9.67it/s] 80%|████████  | 288/358 [00:29<00:07,  9.63it/s] 81%|████████  | 290/358 [00:29<00:06,  9.85it/s] 81%|████████▏ | 291/358 [00:29<00:06,  9.83it/s] 82%|████████▏ | 293/358 [00:29<00:06,  9.84it/s] 82%|████████▏ | 295/358 [00:30<00:06,  9.92it/s] 83%|████████▎ | 296/358 [00:30<00:06,  9.85it/s] 83%|████████▎ | 297/358 [00:30<00:06,  9.74it/s] 84%|████████▎ | 299/358 [00:30<00:05,  9.90it/s] 84%|████████▍ | 301/358 [00:30<00:05,  9.94it/s] 84%|████████▍ | 302/358 [00:30<00:05,  9.87it/s] 85%|████████▍ | 303/358 [00:30<00:05,  9.88it/s] 85%|████████▌ | 305/358 [00:31<00:05,  9.91it/s] 85%|████████▌ | 306/358 [00:31<00:05,  9.83it/s] 86%|████████▌ | 308/358 [00:31<00:05,  9.93it/s] 86%|████████▋ | 309/358 [00:31<00:04,  9.83it/s] 87%|████████▋ | 310/358 [00:31<00:04,  9.77it/s] 87%|████████▋ | 311/358 [00:31<00:04,  9.69it/s] 87%|████████▋ | 312/358 [00:31<00:04,  9.71it/s] 87%|████████▋ | 313/358 [00:31<00:04,  9.73it/s] 88%|████████▊ | 315/358 [00:32<00:04,  9.99it/s] 88%|████████▊ | 316/358 [00:32<00:04,  9.94it/s] 89%|████████▊ | 317/358 [00:32<00:04,  9.86it/s] 89%|████████▉ | 318/358 [00:32<00:04,  9.81it/s] 89%|████████▉ | 319/358 [00:32<00:03,  9.76it/s] 89%|████████▉ | 320/358 [00:32<00:03,  9.82it/s] 90%|████████▉ | 321/358 [00:32<00:03,  9.75it/s] 90%|████████▉ | 322/358 [00:32<00:03,  9.71it/s] 90%|█████████ | 323/358 [00:32<00:03,  9.66it/s] 91%|█████████ | 324/358 [00:33<00:03,  9.63it/s] 91%|█████████ | 325/358 [00:33<00:03,  9.61it/s] 91%|█████████▏| 327/358 [00:33<00:03,  9.97it/s] 92%|█████████▏| 329/358 [00:33<00:02, 10.07it/s] 92%|█████████▏| 330/358 [00:33<00:02,  9.96it/s] 93%|█████████▎| 332/358 [00:33<00:02, 10.06it/s] 93%|█████████▎| 334/358 [00:34<00:02,  9.96it/s] 94%|█████████▎| 335/358 [00:34<00:02,  9.84it/s] 94%|█████████▍| 337/358 [00:34<00:02,  9.92it/s] 95%|█████████▍| 339/358 [00:34<00:01, 10.12it/s] 95%|█████████▌| 341/358 [00:34<00:01, 10.06it/s] 96%|█████████▌| 343/358 [00:34<00:01,  9.90it/s] 96%|█████████▌| 344/358 [00:35<00:01,  9.84it/s] 96%|█████████▋| 345/358 [00:35<00:01,  9.86it/s] 97%|█████████▋| 347/358 [00:35<00:01, 10.04it/s] 97%|█████████▋| 348/358 [00:35<00:01,  9.94it/s] 97%|█████████▋| 349/358 [00:35<00:00,  9.86it/s] 98%|█████████▊| 350/358 [00:35<00:00,  9.79it/s] 98%|█████████▊| 351/358 [00:35<00:00,  9.75it/s] 99%|█████████▊| 353/358 [00:35<00:00,  9.93it/s] 99%|█████████▉| 354/358 [00:36<00:00,  9.91it/s] 99%|█████████▉| 355/358 [00:36<00:00,  9.82it/s]100%|█████████▉| 357/358 [00:36<00:00,  9.88it/s]100%|██████████| 358/358 [00:36<00:00,  9.83it/s]
[32m2025-02-05 06:23:28.315[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    gen_loss  grad clip ratio  grad norm  ppl
       1.802                1      2.322 6.06[0m
[32m2025-02-05 06:23:28.315[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m169[0m - [1m[Valid][0m
  0%|          | 0/10256 [00:00<?, ?it/s]100%|██████████| 10256/10256 [00:00<00:00, 1011564.53it/s]
[32m2025-02-05 06:23:28.326[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:27,  1.43it/s]  5%|▌         | 2/40 [00:01<00:26,  1.45it/s]  8%|▊         | 3/40 [00:02<00:25,  1.46it/s] 10%|█         | 4/40 [00:02<00:24,  1.46it/s] 12%|█▎        | 5/40 [00:03<00:24,  1.45it/s] 15%|█▌        | 6/40 [00:04<00:23,  1.45it/s] 18%|█▊        | 7/40 [00:04<00:22,  1.45it/s] 20%|██        | 8/40 [00:05<00:22,  1.45it/s] 22%|██▎       | 9/40 [00:06<00:21,  1.45it/s] 25%|██▌       | 10/40 [00:06<00:20,  1.46it/s] 28%|██▊       | 11/40 [00:07<00:19,  1.46it/s] 30%|███       | 12/40 [00:08<00:19,  1.45it/s] 32%|███▎      | 13/40 [00:08<00:18,  1.46it/s] 35%|███▌      | 14/40 [00:09<00:17,  1.45it/s] 38%|███▊      | 15/40 [00:10<00:17,  1.45it/s] 40%|████      | 16/40 [00:11<00:16,  1.45it/s] 42%|████▎     | 17/40 [00:11<00:15,  1.46it/s] 45%|████▌     | 18/40 [00:12<00:15,  1.46it/s] 48%|████▊     | 19/40 [00:13<00:14,  1.46it/s] 50%|█████     | 20/40 [00:13<00:13,  1.46it/s] 52%|█████▎    | 21/40 [00:14<00:12,  1.46it/s] 55%|█████▌    | 22/40 [00:15<00:12,  1.46it/s] 57%|█████▊    | 23/40 [00:15<00:11,  1.46it/s] 60%|██████    | 24/40 [00:16<00:11,  1.45it/s] 62%|██████▎   | 25/40 [00:17<00:10,  1.45it/s] 65%|██████▌   | 26/40 [00:17<00:09,  1.46it/s] 68%|██████▊   | 27/40 [00:18<00:08,  1.46it/s] 70%|███████   | 28/40 [00:19<00:08,  1.46it/s] 72%|███████▎  | 29/40 [00:19<00:07,  1.46it/s] 75%|███████▌  | 30/40 [00:20<00:06,  1.46it/s] 78%|███████▊  | 31/40 [00:21<00:06,  1.46it/s] 80%|████████  | 32/40 [00:21<00:05,  1.46it/s] 82%|████████▎ | 33/40 [00:22<00:04,  1.45it/s] 85%|████████▌ | 34/40 [00:23<00:04,  1.46it/s] 88%|████████▊ | 35/40 [00:24<00:03,  1.46it/s] 90%|█████████ | 36/40 [00:24<00:02,  1.45it/s] 92%|█████████▎| 37/40 [00:25<00:02,  1.45it/s] 95%|█████████▌| 38/40 [00:26<00:01,  1.44it/s] 98%|█████████▊| 39/40 [00:26<00:00,  1.44it/s]100%|██████████| 40/40 [00:27<00:00,  1.60it/s]100%|██████████| 40/40 [00:27<00:00,  1.47it/s]
[32m2025-02-05 06:23:55.627[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    average  bleu@1  bleu@2  bleu@3  bleu@4  dist@1  dist@2  dist@3  dist@4  extreme  \
      .7848   .3017   .1102  .04152  .02083  .04432   .3079   .5983   .7739    .6011   
      f1  gen_loss  greedy  intra_dist@1  intra_dist@2  intra_dist@3  intra_dist@4  \
   .3560     5.245   .6705         .8709         .9741         .9627         .9258   
     ppl  rouge1  rouge2  rougeL  
   189.5   .3872   .0891   .3748[0m
[32m2025-02-05 06:23:55.633[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m163[0m - [1m[Conversation epoch 71][0m
[32m2025-02-05 06:23:55.633[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m164[0m - [1m[Train][0m
  0%|          | 0/92414 [00:00<?, ?it/s]100%|██████████| 92414/92414 [00:00<00:00, 986574.79it/s]
[32m2025-02-05 06:23:55.727[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/358 [00:00<?, ?it/s]  0%|          | 1/358 [00:00<00:36,  9.76it/s]  1%|          | 3/358 [00:00<00:35,  9.93it/s]  1%|          | 4/358 [00:00<00:35,  9.91it/s]  2%|▏         | 6/358 [00:00<00:35,  9.87it/s]  2%|▏         | 7/358 [00:00<00:35,  9.81it/s]  2%|▏         | 8/358 [00:00<00:35,  9.85it/s]  3%|▎         | 9/358 [00:00<00:35,  9.75it/s]  3%|▎         | 10/358 [00:01<00:35,  9.74it/s]  3%|▎         | 11/358 [00:01<00:35,  9.70it/s]  4%|▎         | 13/358 [00:01<00:34,  9.92it/s]  4%|▍         | 14/358 [00:01<00:34,  9.85it/s]  4%|▍         | 15/358 [00:01<00:35,  9.77it/s]  4%|▍         | 16/358 [00:01<00:35,  9.71it/s]  5%|▍         | 17/358 [00:01<00:35,  9.73it/s]  5%|▌         | 18/358 [00:01<00:34,  9.80it/s]  5%|▌         | 19/358 [00:01<00:34,  9.73it/s]  6%|▌         | 20/358 [00:02<00:34,  9.68it/s]  6%|▌         | 21/358 [00:02<00:35,  9.61it/s]  6%|▌         | 22/358 [00:02<00:34,  9.67it/s]  7%|▋         | 24/358 [00:02<00:34,  9.77it/s]  7%|▋         | 25/358 [00:02<00:34,  9.72it/s]  7%|▋         | 26/358 [00:02<00:34,  9.67it/s]  8%|▊         | 27/358 [00:02<00:34,  9.73it/s]  8%|▊         | 28/358 [00:02<00:34,  9.68it/s]  8%|▊         | 29/358 [00:02<00:34,  9.65it/s]  9%|▊         | 31/358 [00:03<00:33,  9.75it/s]  9%|▉         | 32/358 [00:03<00:33,  9.75it/s]  9%|▉         | 34/358 [00:03<00:32,  9.85it/s] 10%|█         | 36/358 [00:03<00:32,  9.84it/s] 10%|█         | 37/358 [00:03<00:32,  9.81it/s] 11%|█         | 38/358 [00:03<00:32,  9.77it/s] 11%|█         | 40/358 [00:04<00:32,  9.94it/s] 11%|█▏        | 41/358 [00:04<00:32,  9.85it/s] 12%|█▏        | 43/358 [00:04<00:31,  9.88it/s] 13%|█▎        | 45/358 [00:04<00:31,  9.98it/s] 13%|█▎        | 47/358 [00:04<00:31,  9.95it/s] 13%|█▎        | 48/358 [00:04<00:31,  9.94it/s] 14%|█▍        | 50/358 [00:05<00:31,  9.90it/s] 14%|█▍        | 51/358 [00:05<00:31,  9.84it/s] 15%|█▍        | 52/358 [00:05<00:31,  9.75it/s] 15%|█▍        | 53/358 [00:05<00:31,  9.70it/s] 15%|█▌        | 54/358 [00:05<00:31,  9.74it/s] 15%|█▌        | 55/358 [00:05<00:31,  9.69it/s] 16%|█▌        | 56/358 [00:05<00:31,  9.73it/s] 16%|█▌        | 57/358 [00:05<00:31,  9.69it/s] 16%|█▌        | 58/358 [00:05<00:31,  9.67it/s] 16%|█▋        | 59/358 [00:06<00:31,  9.64it/s] 17%|█▋        | 61/358 [00:06<00:30,  9.72it/s] 17%|█▋        | 62/358 [00:06<00:30,  9.65it/s] 18%|█▊        | 63/358 [00:06<00:30,  9.71it/s] 18%|█▊        | 64/358 [00:06<00:30,  9.67it/s] 18%|█▊        | 66/358 [00:06<00:29,  9.74it/s] 19%|█▊        | 67/358 [00:06<00:29,  9.72it/s] 19%|█▉        | 69/358 [00:07<00:29,  9.79it/s] 20%|█▉        | 70/358 [00:07<00:29,  9.74it/s] 20%|█▉        | 71/358 [00:07<00:29,  9.78it/s] 20%|██        | 72/358 [00:07<00:29,  9.73it/s] 20%|██        | 73/358 [00:07<00:29,  9.69it/s] 21%|██        | 74/358 [00:07<00:29,  9.66it/s] 21%|██        | 75/358 [00:07<00:29,  9.62it/s] 22%|██▏       | 77/358 [00:07<00:28,  9.71it/s] 22%|██▏       | 79/358 [00:08<00:28,  9.71it/s] 23%|██▎       | 81/358 [00:08<00:28,  9.76it/s] 23%|██▎       | 83/358 [00:08<00:28,  9.79it/s] 23%|██▎       | 84/358 [00:08<00:28,  9.74it/s] 24%|██▎       | 85/358 [00:08<00:28,  9.69it/s] 24%|██▍       | 86/358 [00:08<00:28,  9.68it/s] 24%|██▍       | 87/358 [00:08<00:28,  9.66it/s] 25%|██▍       | 88/358 [00:09<00:27,  9.68it/s] 25%|██▌       | 90/358 [00:09<00:27,  9.91it/s] 26%|██▌       | 92/358 [00:09<00:26, 10.01it/s] 26%|██▌       | 93/358 [00:09<00:26,  9.97it/s] 26%|██▋       | 94/358 [00:09<00:26,  9.89it/s] 27%|██▋       | 96/358 [00:09<00:25, 10.17it/s] 27%|██▋       | 98/358 [00:10<00:25, 10.06it/s] 28%|██▊       | 100/358 [00:10<00:25, 10.01it/s] 28%|██▊       | 101/358 [00:10<00:25,  9.92it/s] 29%|██▉       | 103/358 [00:10<00:25,  9.91it/s] 29%|██▉       | 104/358 [00:10<00:25,  9.86it/s] 29%|██▉       | 105/358 [00:10<00:25,  9.79it/s] 30%|██▉       | 106/358 [00:10<00:25,  9.77it/s] 30%|███       | 108/358 [00:11<00:25,  9.80it/s] 30%|███       | 109/358 [00:11<00:25,  9.72it/s] 31%|███       | 110/358 [00:11<00:25,  9.70it/s] 31%|███       | 111/358 [00:11<00:25,  9.65it/s] 32%|███▏      | 113/358 [00:11<00:24,  9.92it/s] 32%|███▏      | 114/358 [00:11<00:24,  9.88it/s] 32%|███▏      | 115/358 [00:11<00:24,  9.78it/s] 32%|███▏      | 116/358 [00:11<00:24,  9.70it/s] 33%|███▎      | 117/358 [00:11<00:24,  9.67it/s] 33%|███▎      | 119/358 [00:12<00:24,  9.79it/s] 34%|███▍      | 121/358 [00:12<00:23,  9.99it/s] 34%|███▍      | 123/358 [00:12<00:23, 10.09it/s] 35%|███▍      | 125/358 [00:12<00:23, 10.06it/s] 35%|███▌      | 127/358 [00:12<00:23,  9.99it/s] 36%|███▌      | 128/358 [00:13<00:23,  9.95it/s] 36%|███▋      | 130/358 [00:13<00:22, 10.00it/s] 37%|███▋      | 131/358 [00:13<00:22,  9.91it/s] 37%|███▋      | 132/358 [00:13<00:22,  9.93it/s] 37%|███▋      | 134/358 [00:13<00:22,  9.95it/s] 38%|███▊      | 135/358 [00:13<00:22,  9.89it/s] 38%|███▊      | 137/358 [00:13<00:22,  9.97it/s] 39%|███▊      | 138/358 [00:14<00:22,  9.95it/s] 39%|███▉      | 139/358 [00:14<00:22,  9.87it/s] 39%|███▉      | 141/358 [00:14<00:21,  9.98it/s] 40%|███▉      | 142/358 [00:14<00:21,  9.91it/s] 40%|███▉      | 143/358 [00:14<00:21,  9.87it/s] 40%|████      | 144/358 [00:14<00:21,  9.78it/s] 41%|████      | 145/358 [00:14<00:21,  9.81it/s] 41%|████      | 146/358 [00:14<00:21,  9.75it/s] 41%|████      | 147/358 [00:14<00:21,  9.68it/s] 41%|████▏     | 148/358 [00:15<00:21,  9.71it/s] 42%|████▏     | 149/358 [00:15<00:21,  9.69it/s] 42%|████▏     | 150/358 [00:15<00:21,  9.65it/s] 42%|████▏     | 151/358 [00:15<00:22,  9.39it/s] 42%|████▏     | 152/358 [00:15<00:21,  9.43it/s] 43%|████▎     | 153/358 [00:15<00:21,  9.46it/s] 43%|████▎     | 154/358 [00:15<00:21,  9.55it/s] 43%|████▎     | 155/358 [00:15<00:21,  9.56it/s] 44%|████▎     | 156/358 [00:15<00:20,  9.68it/s] 44%|████▍     | 157/358 [00:16<00:20,  9.62it/s] 44%|████▍     | 158/358 [00:16<00:20,  9.71it/s] 44%|████▍     | 159/358 [00:16<00:20,  9.71it/s] 45%|████▍     | 160/358 [00:16<00:20,  9.71it/s] 45%|████▌     | 162/358 [00:16<00:19, 10.01it/s] 46%|████▌     | 164/358 [00:16<00:19, 10.01it/s] 46%|████▌     | 165/358 [00:16<00:19,  9.97it/s] 47%|████▋     | 167/358 [00:17<00:19,  9.91it/s] 47%|████▋     | 169/358 [00:17<00:18,  9.95it/s] 48%|████▊     | 171/358 [00:17<00:18,  9.93it/s] 48%|████▊     | 172/358 [00:17<00:18,  9.88it/s] 48%|████▊     | 173/358 [00:17<00:18,  9.82it/s] 49%|████▉     | 175/358 [00:17<00:18,  9.84it/s] 49%|████▉     | 176/358 [00:17<00:18,  9.86it/s] 49%|████▉     | 177/358 [00:18<00:18,  9.84it/s] 50%|█████     | 179/358 [00:18<00:18,  9.86it/s] 50%|█████     | 180/358 [00:18<00:18,  9.79it/s] 51%|█████     | 182/358 [00:18<00:17,  9.95it/s] 51%|█████     | 183/358 [00:18<00:17,  9.90it/s] 51%|█████▏    | 184/358 [00:18<00:17,  9.79it/s] 52%|█████▏    | 185/358 [00:18<00:17,  9.74it/s] 52%|█████▏    | 187/358 [00:19<00:17,  9.95it/s] 53%|█████▎    | 188/358 [00:19<00:17,  9.90it/s] 53%|█████▎    | 189/358 [00:19<00:17,  9.84it/s] 53%|█████▎    | 191/358 [00:19<00:17,  9.76it/s] 54%|█████▎    | 192/358 [00:19<00:17,  9.70it/s] 54%|█████▍    | 193/358 [00:19<00:17,  9.70it/s] 54%|█████▍    | 194/358 [00:19<00:16,  9.68it/s] 54%|█████▍    | 195/358 [00:19<00:16,  9.75it/s] 55%|█████▌    | 197/358 [00:20<00:16,  9.92it/s] 55%|█████▌    | 198/358 [00:20<00:16,  9.85it/s] 56%|█████▌    | 199/358 [00:20<00:16,  9.88it/s] 56%|█████▌    | 200/358 [00:20<00:16,  9.81it/s] 56%|█████▌    | 201/358 [00:20<00:16,  9.77it/s] 57%|█████▋    | 203/358 [00:20<00:15,  9.87it/s] 57%|█████▋    | 204/358 [00:20<00:15,  9.76it/s] 57%|█████▋    | 205/358 [00:20<00:15,  9.71it/s] 58%|█████▊    | 207/358 [00:21<00:15,  9.88it/s] 58%|█████▊    | 208/358 [00:21<00:15,  9.81it/s] 59%|█████▊    | 210/358 [00:21<00:15,  9.83it/s] 59%|█████▉    | 212/358 [00:21<00:14,  9.82it/s] 60%|█████▉    | 214/358 [00:21<00:14,  9.90it/s] 60%|██████    | 215/358 [00:21<00:14,  9.84it/s] 60%|██████    | 216/358 [00:22<00:14,  9.77it/s] 61%|██████    | 217/358 [00:22<00:14,  9.81it/s] 61%|██████    | 218/358 [00:22<00:14,  9.78it/s] 61%|██████    | 219/358 [00:22<00:14,  9.78it/s] 62%|██████▏   | 221/358 [00:22<00:13,  9.91it/s] 62%|██████▏   | 222/358 [00:22<00:13,  9.81it/s] 62%|██████▏   | 223/358 [00:22<00:13,  9.75it/s] 63%|██████▎   | 224/358 [00:22<00:13,  9.70it/s] 63%|██████▎   | 226/358 [00:23<00:13,  9.74it/s] 64%|██████▎   | 228/358 [00:23<00:13,  9.77it/s] 64%|██████▍   | 229/358 [00:23<00:13,  9.75it/s] 64%|██████▍   | 230/358 [00:23<00:13,  9.70it/s] 65%|██████▍   | 232/358 [00:23<00:12,  9.74it/s] 65%|██████▌   | 234/358 [00:23<00:12, 10.03it/s] 66%|██████▌   | 236/358 [00:24<00:12,  9.99it/s] 66%|██████▋   | 238/358 [00:24<00:11, 10.04it/s] 67%|██████▋   | 240/358 [00:24<00:11, 10.01it/s] 68%|██████▊   | 242/358 [00:24<00:11,  9.98it/s] 68%|██████▊   | 243/358 [00:24<00:11,  9.92it/s] 68%|██████▊   | 244/358 [00:24<00:11,  9.86it/s] 69%|██████▊   | 246/358 [00:25<00:11,  9.88it/s] 69%|██████▉   | 247/358 [00:25<00:11,  9.81it/s] 69%|██████▉   | 248/358 [00:25<00:11,  9.76it/s] 70%|██████▉   | 250/358 [00:25<00:10,  9.86it/s] 70%|███████   | 251/358 [00:25<00:10,  9.79it/s] 70%|███████   | 252/358 [00:25<00:10,  9.73it/s] 71%|███████   | 253/358 [00:25<00:10,  9.69it/s] 71%|███████   | 254/358 [00:25<00:10,  9.66it/s] 72%|███████▏  | 256/358 [00:26<00:10,  9.84it/s] 72%|███████▏  | 257/358 [00:26<00:10,  9.85it/s] 72%|███████▏  | 258/358 [00:26<00:10,  9.72it/s] 72%|███████▏  | 259/358 [00:26<00:10,  9.68it/s] 73%|███████▎  | 260/358 [00:26<00:10,  9.72it/s] 73%|███████▎  | 262/358 [00:26<00:09,  9.90it/s] 74%|███████▎  | 264/358 [00:26<00:09,  9.92it/s] 74%|███████▍  | 266/358 [00:27<00:09,  9.91it/s] 75%|███████▍  | 267/358 [00:27<00:09,  9.85it/s] 75%|███████▌  | 269/358 [00:27<00:08,  9.91it/s] 75%|███████▌  | 270/358 [00:27<00:08,  9.84it/s] 76%|███████▌  | 271/358 [00:27<00:08,  9.76it/s] 76%|███████▌  | 272/358 [00:27<00:08,  9.74it/s] 76%|███████▋  | 273/358 [00:27<00:08,  9.64it/s] 77%|███████▋  | 274/358 [00:27<00:08,  9.64it/s] 77%|███████▋  | 275/358 [00:28<00:08,  9.68it/s] 77%|███████▋  | 276/358 [00:28<00:08,  9.69it/s] 77%|███████▋  | 277/358 [00:28<00:08,  9.65it/s] 78%|███████▊  | 278/358 [00:28<00:08,  9.63it/s] 78%|███████▊  | 280/358 [00:28<00:07,  9.83it/s] 78%|███████▊  | 281/358 [00:28<00:07,  9.84it/s] 79%|███████▉  | 282/358 [00:28<00:07,  9.78it/s] 79%|███████▉  | 283/358 [00:28<00:07,  9.71it/s] 79%|███████▉  | 284/358 [00:28<00:07,  9.67it/s] 80%|███████▉  | 285/358 [00:29<00:07,  9.74it/s] 80%|███████▉  | 286/358 [00:29<00:07,  9.70it/s] 80%|████████  | 287/358 [00:29<00:07,  9.68it/s] 80%|████████  | 288/358 [00:29<00:07,  9.64it/s] 81%|████████  | 290/358 [00:29<00:06,  9.85it/s] 81%|████████▏ | 291/358 [00:29<00:06,  9.83it/s] 82%|████████▏ | 293/358 [00:29<00:06,  9.84it/s] 82%|████████▏ | 295/358 [00:30<00:06,  9.91it/s] 83%|████████▎ | 296/358 [00:30<00:06,  9.85it/s] 83%|████████▎ | 297/358 [00:30<00:06,  9.75it/s] 84%|████████▎ | 299/358 [00:30<00:05,  9.91it/s] 84%|████████▍ | 301/358 [00:30<00:05,  9.94it/s] 84%|████████▍ | 302/358 [00:30<00:05,  9.88it/s] 85%|████████▍ | 303/358 [00:30<00:05,  9.88it/s] 85%|████████▌ | 305/358 [00:31<00:05,  9.91it/s] 85%|████████▌ | 306/358 [00:31<00:05,  9.83it/s] 86%|████████▌ | 308/358 [00:31<00:05,  9.93it/s] 86%|████████▋ | 309/358 [00:31<00:04,  9.83it/s] 87%|████████▋ | 310/358 [00:31<00:04,  9.77it/s] 87%|████████▋ | 311/358 [00:31<00:04,  9.70it/s] 87%|████████▋ | 312/358 [00:31<00:04,  9.71it/s] 87%|████████▋ | 313/358 [00:31<00:04,  9.73it/s] 88%|████████▊ | 315/358 [00:32<00:04,  9.99it/s] 88%|████████▊ | 316/358 [00:32<00:04,  9.94it/s] 89%|████████▊ | 317/358 [00:32<00:04,  9.86it/s] 89%|████████▉ | 318/358 [00:32<00:04,  9.81it/s] 89%|████████▉ | 319/358 [00:32<00:03,  9.76it/s] 89%|████████▉ | 320/358 [00:32<00:03,  9.82it/s] 90%|████████▉ | 321/358 [00:32<00:03,  9.75it/s] 90%|████████▉ | 322/358 [00:32<00:03,  9.71it/s] 90%|█████████ | 323/358 [00:32<00:03,  9.67it/s] 91%|█████████ | 324/358 [00:33<00:03,  9.63it/s] 91%|█████████ | 325/358 [00:33<00:03,  9.61it/s] 91%|█████████▏| 327/358 [00:33<00:03,  9.98it/s] 92%|█████████▏| 329/358 [00:33<00:02, 10.08it/s] 92%|█████████▏| 330/358 [00:33<00:02,  9.96it/s] 93%|█████████▎| 332/358 [00:33<00:02, 10.07it/s] 93%|█████████▎| 334/358 [00:34<00:02,  9.97it/s] 94%|█████████▎| 335/358 [00:34<00:02,  9.85it/s] 94%|█████████▍| 337/358 [00:34<00:02,  9.93it/s] 95%|█████████▍| 339/358 [00:34<00:01, 10.13it/s] 95%|█████████▌| 341/358 [00:34<00:01, 10.07it/s] 96%|█████████▌| 343/358 [00:34<00:01,  9.91it/s] 96%|█████████▌| 344/358 [00:35<00:01,  9.85it/s] 96%|█████████▋| 345/358 [00:35<00:01,  9.87it/s] 97%|█████████▋| 347/358 [00:35<00:01, 10.05it/s] 97%|█████████▋| 349/358 [00:35<00:00,  9.89it/s] 98%|█████████▊| 350/358 [00:35<00:00,  9.83it/s] 98%|█████████▊| 351/358 [00:35<00:00,  9.78it/s] 99%|█████████▊| 353/358 [00:35<00:00,  9.93it/s] 99%|█████████▉| 354/358 [00:36<00:00,  9.92it/s] 99%|█████████▉| 355/358 [00:36<00:00,  9.83it/s]100%|█████████▉| 357/358 [00:36<00:00,  9.88it/s]100%|██████████| 358/358 [00:36<00:00,  9.83it/s]
[32m2025-02-05 06:24:32.144[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    gen_loss  grad clip ratio  grad norm   ppl
       1.792                1      2.306 6.004[0m
[32m2025-02-05 06:24:32.144[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m169[0m - [1m[Valid][0m
  0%|          | 0/10256 [00:00<?, ?it/s]100%|██████████| 10256/10256 [00:00<00:00, 1054617.22it/s]
[32m2025-02-05 06:24:32.154[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:27,  1.42it/s]  5%|▌         | 2/40 [00:01<00:26,  1.44it/s]  8%|▊         | 3/40 [00:02<00:25,  1.45it/s] 10%|█         | 4/40 [00:02<00:24,  1.45it/s] 12%|█▎        | 5/40 [00:03<00:24,  1.44it/s] 15%|█▌        | 6/40 [00:04<00:23,  1.44it/s] 18%|█▊        | 7/40 [00:04<00:22,  1.44it/s] 20%|██        | 8/40 [00:05<00:22,  1.45it/s] 22%|██▎       | 9/40 [00:06<00:21,  1.45it/s] 25%|██▌       | 10/40 [00:06<00:20,  1.45it/s] 28%|██▊       | 11/40 [00:07<00:19,  1.45it/s] 30%|███       | 12/40 [00:08<00:19,  1.45it/s] 32%|███▎      | 13/40 [00:08<00:18,  1.45it/s] 35%|███▌      | 14/40 [00:09<00:18,  1.44it/s] 38%|███▊      | 15/40 [00:10<00:17,  1.45it/s] 40%|████      | 16/40 [00:11<00:16,  1.44it/s] 42%|████▎     | 17/40 [00:11<00:15,  1.45it/s] 45%|████▌     | 18/40 [00:12<00:15,  1.45it/s] 48%|████▊     | 19/40 [00:13<00:14,  1.45it/s] 50%|█████     | 20/40 [00:13<00:13,  1.46it/s] 52%|█████▎    | 21/40 [00:14<00:12,  1.46it/s] 55%|█████▌    | 22/40 [00:15<00:12,  1.46it/s] 57%|█████▊    | 23/40 [00:15<00:11,  1.46it/s] 60%|██████    | 24/40 [00:16<00:11,  1.45it/s] 62%|██████▎   | 25/40 [00:17<00:10,  1.45it/s] 65%|██████▌   | 26/40 [00:17<00:09,  1.46it/s] 68%|██████▊   | 27/40 [00:18<00:08,  1.46it/s] 70%|███████   | 28/40 [00:19<00:08,  1.46it/s] 72%|███████▎  | 29/40 [00:19<00:07,  1.46it/s] 75%|███████▌  | 30/40 [00:20<00:06,  1.46it/s] 78%|███████▊  | 31/40 [00:21<00:06,  1.45it/s] 80%|████████  | 32/40 [00:22<00:05,  1.46it/s] 82%|████████▎ | 33/40 [00:22<00:04,  1.45it/s] 85%|████████▌ | 34/40 [00:23<00:04,  1.45it/s] 88%|████████▊ | 35/40 [00:24<00:03,  1.45it/s] 90%|█████████ | 36/40 [00:24<00:02,  1.44it/s] 92%|█████████▎| 37/40 [00:25<00:02,  1.45it/s] 95%|█████████▌| 38/40 [00:26<00:01,  1.44it/s] 98%|█████████▊| 39/40 [00:26<00:00,  1.44it/s]100%|██████████| 40/40 [00:27<00:00,  1.60it/s]100%|██████████| 40/40 [00:27<00:00,  1.46it/s]
[32m2025-02-05 06:24:59.537[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    average  bleu@1  bleu@2  bleu@3  bleu@4  dist@1  dist@2  dist@3  dist@4  extreme  \
      .7791   .2961   .1092  .04176  .02095   .0466   .3241   .6088   .7775    .5961   
      f1  gen_loss  greedy  intra_dist@1  intra_dist@2  intra_dist@3  intra_dist@4  \
   .3501     5.232   .6663         .8713         .9691         .9526         .9185   
     ppl  rouge1  rouge2  rougeL  
   187.2   .3807   .0890   .3695[0m
[32m2025-02-05 06:24:59.544[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m163[0m - [1m[Conversation epoch 72][0m
[32m2025-02-05 06:24:59.544[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m164[0m - [1m[Train][0m
  0%|          | 0/92414 [00:00<?, ?it/s]100%|██████████| 92414/92414 [00:00<00:00, 994247.63it/s]
[32m2025-02-05 06:24:59.638[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/358 [00:00<?, ?it/s]  0%|          | 1/358 [00:00<00:36,  9.75it/s]  1%|          | 3/358 [00:00<00:35,  9.93it/s]  1%|          | 4/358 [00:00<00:35,  9.91it/s]  2%|▏         | 6/358 [00:00<00:35,  9.88it/s]  2%|▏         | 7/358 [00:00<00:35,  9.81it/s]  2%|▏         | 8/358 [00:00<00:35,  9.86it/s]  3%|▎         | 9/358 [00:00<00:35,  9.76it/s]  3%|▎         | 10/358 [00:01<00:35,  9.75it/s]  3%|▎         | 11/358 [00:01<00:35,  9.70it/s]  4%|▎         | 13/358 [00:01<00:34,  9.92it/s]  4%|▍         | 14/358 [00:01<00:34,  9.85it/s]  4%|▍         | 15/358 [00:01<00:35,  9.77it/s]  4%|▍         | 16/358 [00:01<00:35,  9.71it/s]  5%|▍         | 17/358 [00:01<00:35,  9.73it/s]  5%|▌         | 18/358 [00:01<00:34,  9.80it/s]  5%|▌         | 19/358 [00:01<00:34,  9.73it/s]  6%|▌         | 20/358 [00:02<00:34,  9.68it/s]  6%|▌         | 21/358 [00:02<00:35,  9.61it/s]  6%|▌         | 22/358 [00:02<00:34,  9.68it/s]  7%|▋         | 24/358 [00:02<00:34,  9.77it/s]  7%|▋         | 25/358 [00:02<00:34,  9.72it/s]  7%|▋         | 26/358 [00:02<00:34,  9.67it/s]  8%|▊         | 27/358 [00:02<00:34,  9.73it/s]  8%|▊         | 28/358 [00:02<00:34,  9.68it/s]  8%|▊         | 29/358 [00:02<00:34,  9.65it/s]  9%|▊         | 31/358 [00:03<00:33,  9.75it/s]  9%|▉         | 32/358 [00:03<00:33,  9.75it/s]  9%|▉         | 34/358 [00:03<00:32,  9.85it/s] 10%|█         | 36/358 [00:03<00:32,  9.85it/s] 10%|█         | 37/358 [00:03<00:32,  9.83it/s] 11%|█         | 38/358 [00:03<00:32,  9.79it/s] 11%|█         | 40/358 [00:04<00:31,  9.95it/s] 11%|█▏        | 41/358 [00:04<00:32,  9.86it/s] 12%|█▏        | 43/358 [00:04<00:31,  9.88it/s] 13%|█▎        | 45/358 [00:04<00:31,  9.98it/s] 13%|█▎        | 47/358 [00:04<00:31,  9.96it/s] 13%|█▎        | 48/358 [00:04<00:31,  9.94it/s] 14%|█▍        | 50/358 [00:05<00:31,  9.92it/s] 14%|█▍        | 51/358 [00:05<00:31,  9.85it/s] 15%|█▍        | 52/358 [00:05<00:31,  9.76it/s] 15%|█▍        | 53/358 [00:05<00:31,  9.71it/s] 15%|█▌        | 54/358 [00:05<00:31,  9.75it/s] 15%|█▌        | 55/358 [00:05<00:31,  9.70it/s] 16%|█▌        | 56/358 [00:05<00:31,  9.74it/s] 16%|█▌        | 57/358 [00:05<00:31,  9.70it/s] 16%|█▌        | 58/358 [00:05<00:31,  9.68it/s] 16%|█▋        | 59/358 [00:06<00:31,  9.64it/s] 17%|█▋        | 61/358 [00:06<00:30,  9.73it/s] 17%|█▋        | 62/358 [00:06<00:30,  9.65it/s] 18%|█▊        | 63/358 [00:06<00:30,  9.72it/s] 18%|█▊        | 64/358 [00:06<00:30,  9.67it/s] 18%|█▊        | 66/358 [00:06<00:29,  9.74it/s] 19%|█▊        | 67/358 [00:06<00:29,  9.73it/s] 19%|█▉        | 69/358 [00:07<00:29,  9.79it/s] 20%|█▉        | 70/358 [00:07<00:29,  9.73it/s] 20%|█▉        | 71/358 [00:07<00:29,  9.78it/s] 20%|██        | 72/358 [00:07<00:29,  9.73it/s] 20%|██        | 73/358 [00:07<00:29,  9.69it/s] 21%|██        | 74/358 [00:07<00:29,  9.66it/s] 21%|██        | 75/358 [00:07<00:29,  9.63it/s] 22%|██▏       | 77/358 [00:07<00:28,  9.71it/s] 22%|██▏       | 79/358 [00:08<00:28,  9.71it/s] 23%|██▎       | 81/358 [00:08<00:28,  9.76it/s] 23%|██▎       | 83/358 [00:08<00:28,  9.78it/s] 23%|██▎       | 84/358 [00:08<00:28,  9.74it/s] 24%|██▎       | 85/358 [00:08<00:28,  9.69it/s] 24%|██▍       | 86/358 [00:08<00:28,  9.68it/s] 24%|██▍       | 87/358 [00:08<00:28,  9.66it/s] 25%|██▍       | 88/358 [00:09<00:27,  9.67it/s] 25%|██▌       | 90/358 [00:09<00:27,  9.91it/s] 26%|██▌       | 92/358 [00:09<00:26, 10.00it/s] 26%|██▌       | 93/358 [00:09<00:26,  9.97it/s] 26%|██▋       | 94/358 [00:09<00:26,  9.88it/s] 27%|██▋       | 96/358 [00:09<00:25, 10.16it/s] 27%|██▋       | 98/358 [00:10<00:25, 10.05it/s] 28%|██▊       | 100/358 [00:10<00:25, 10.01it/s] 28%|██▊       | 101/358 [00:10<00:25,  9.92it/s] 29%|██▉       | 103/358 [00:10<00:25,  9.91it/s] 29%|██▉       | 104/358 [00:10<00:25,  9.86it/s] 29%|██▉       | 105/358 [00:10<00:25,  9.79it/s] 30%|██▉       | 106/358 [00:10<00:25,  9.77it/s] 30%|███       | 108/358 [00:11<00:25,  9.80it/s] 30%|███       | 109/358 [00:11<00:25,  9.72it/s] 31%|███       | 110/358 [00:11<00:25,  9.70it/s] 31%|███       | 111/358 [00:11<00:25,  9.65it/s] 32%|███▏      | 113/358 [00:11<00:24,  9.92it/s] 32%|███▏      | 114/358 [00:11<00:24,  9.88it/s] 32%|███▏      | 115/358 [00:11<00:24,  9.79it/s] 32%|███▏      | 116/358 [00:11<00:24,  9.70it/s] 33%|███▎      | 117/358 [00:11<00:24,  9.67it/s] 33%|███▎      | 119/358 [00:12<00:24,  9.79it/s] 34%|███▍      | 121/358 [00:12<00:23,  9.98it/s] 34%|███▍      | 123/358 [00:12<00:23, 10.09it/s] 35%|███▍      | 125/358 [00:12<00:23, 10.06it/s] 35%|███▌      | 127/358 [00:12<00:23,  9.99it/s] 36%|███▌      | 128/358 [00:13<00:23,  9.95it/s] 36%|███▋      | 130/358 [00:13<00:22, 10.00it/s] 37%|███▋      | 131/358 [00:13<00:22,  9.91it/s] 37%|███▋      | 132/358 [00:13<00:22,  9.92it/s] 37%|███▋      | 134/358 [00:13<00:22,  9.95it/s] 38%|███▊      | 135/358 [00:13<00:22,  9.89it/s] 38%|███▊      | 137/358 [00:13<00:22,  9.97it/s] 39%|███▊      | 138/358 [00:14<00:22,  9.95it/s] 39%|███▉      | 139/358 [00:14<00:22,  9.86it/s] 39%|███▉      | 141/358 [00:14<00:21,  9.99it/s] 40%|███▉      | 142/358 [00:14<00:21,  9.91it/s] 40%|███▉      | 143/358 [00:14<00:21,  9.87it/s] 40%|████      | 144/358 [00:14<00:21,  9.79it/s] 41%|████      | 145/358 [00:14<00:21,  9.81it/s] 41%|████      | 146/358 [00:14<00:21,  9.75it/s] 41%|████      | 147/358 [00:14<00:21,  9.69it/s] 41%|████▏     | 148/358 [00:15<00:21,  9.72it/s] 42%|████▏     | 149/358 [00:15<00:21,  9.70it/s] 42%|████▏     | 150/358 [00:15<00:21,  9.66it/s] 42%|████▏     | 151/358 [00:15<00:22,  9.39it/s] 42%|████▏     | 152/358 [00:15<00:21,  9.44it/s] 43%|████▎     | 153/358 [00:15<00:21,  9.46it/s] 43%|████▎     | 154/358 [00:15<00:21,  9.55it/s] 43%|████▎     | 155/358 [00:15<00:21,  9.56it/s] 44%|████▎     | 156/358 [00:15<00:20,  9.68it/s] 44%|████▍     | 157/358 [00:16<00:20,  9.63it/s] 44%|████▍     | 158/358 [00:16<00:20,  9.71it/s] 44%|████▍     | 159/358 [00:16<00:20,  9.70it/s] 45%|████▍     | 160/358 [00:16<00:20,  9.71it/s] 45%|████▌     | 162/358 [00:16<00:19, 10.01it/s] 46%|████▌     | 164/358 [00:16<00:19, 10.01it/s] 46%|████▌     | 165/358 [00:16<00:19,  9.97it/s] 47%|████▋     | 167/358 [00:17<00:19,  9.92it/s] 47%|████▋     | 169/358 [00:17<00:18,  9.95it/s] 48%|████▊     | 171/358 [00:17<00:18,  9.93it/s] 48%|████▊     | 172/358 [00:17<00:18,  9.88it/s] 48%|████▊     | 173/358 [00:17<00:18,  9.82it/s] 49%|████▉     | 175/358 [00:17<00:18,  9.84it/s] 49%|████▉     | 176/358 [00:17<00:18,  9.85it/s] 49%|████▉     | 177/358 [00:18<00:18,  9.84it/s] 50%|█████     | 179/358 [00:18<00:18,  9.87it/s] 50%|█████     | 180/358 [00:18<00:18,  9.79it/s] 51%|█████     | 182/358 [00:18<00:17,  9.95it/s] 51%|█████     | 183/358 [00:18<00:17,  9.90it/s] 51%|█████▏    | 184/358 [00:18<00:17,  9.79it/s] 52%|█████▏    | 185/358 [00:18<00:17,  9.74it/s] 52%|█████▏    | 187/358 [00:19<00:17,  9.95it/s] 53%|█████▎    | 188/358 [00:19<00:17,  9.89it/s] 53%|█████▎    | 189/358 [00:19<00:17,  9.82it/s] 53%|█████▎    | 191/358 [00:19<00:17,  9.75it/s] 54%|█████▎    | 192/358 [00:19<00:17,  9.70it/s] 54%|█████▍    | 193/358 [00:19<00:17,  9.69it/s] 54%|█████▍    | 194/358 [00:19<00:16,  9.67it/s] 54%|█████▍    | 195/358 [00:19<00:16,  9.74it/s] 55%|█████▌    | 197/358 [00:20<00:16,  9.92it/s] 55%|█████▌    | 198/358 [00:20<00:16,  9.84it/s] 56%|█████▌    | 199/358 [00:20<00:16,  9.87it/s] 56%|█████▌    | 200/358 [00:20<00:16,  9.80it/s] 56%|█████▌    | 201/358 [00:20<00:16,  9.76it/s] 57%|█████▋    | 203/358 [00:20<00:15,  9.85it/s] 57%|█████▋    | 204/358 [00:20<00:15,  9.75it/s] 57%|█████▋    | 205/358 [00:20<00:15,  9.71it/s] 58%|█████▊    | 207/358 [00:21<00:15,  9.88it/s] 58%|█████▊    | 208/358 [00:21<00:15,  9.81it/s] 59%|█████▊    | 210/358 [00:21<00:15,  9.82it/s] 59%|█████▉    | 212/358 [00:21<00:14,  9.82it/s] 60%|█████▉    | 214/358 [00:21<00:14,  9.90it/s] 60%|██████    | 215/358 [00:21<00:14,  9.84it/s] 60%|██████    | 216/358 [00:22<00:14,  9.77it/s] 61%|██████    | 217/358 [00:22<00:14,  9.81it/s] 61%|██████    | 218/358 [00:22<00:14,  9.78it/s] 61%|██████    | 219/358 [00:22<00:14,  9.78it/s] 62%|██████▏   | 221/358 [00:22<00:13,  9.91it/s] 62%|██████▏   | 222/358 [00:22<00:13,  9.81it/s] 62%|██████▏   | 223/358 [00:22<00:13,  9.75it/s] 63%|██████▎   | 224/358 [00:22<00:13,  9.70it/s] 63%|██████▎   | 226/358 [00:23<00:13,  9.74it/s] 64%|██████▎   | 228/358 [00:23<00:13,  9.77it/s] 64%|██████▍   | 229/358 [00:23<00:13,  9.75it/s] 64%|██████▍   | 230/358 [00:23<00:13,  9.69it/s] 65%|██████▍   | 232/358 [00:23<00:12,  9.75it/s] 65%|██████▌   | 234/358 [00:23<00:12, 10.02it/s] 66%|██████▌   | 236/358 [00:24<00:12,  9.99it/s] 66%|██████▋   | 238/358 [00:24<00:11, 10.04it/s] 67%|██████▋   | 240/358 [00:24<00:11, 10.00it/s] 68%|██████▊   | 242/358 [00:24<00:11,  9.98it/s] 68%|██████▊   | 243/358 [00:24<00:11,  9.92it/s] 68%|██████▊   | 244/358 [00:24<00:11,  9.85it/s] 69%|██████▊   | 246/358 [00:25<00:11,  9.88it/s] 69%|██████▉   | 247/358 [00:25<00:11,  9.80it/s] 69%|██████▉   | 248/358 [00:25<00:11,  9.76it/s] 70%|██████▉   | 250/358 [00:25<00:10,  9.86it/s] 70%|███████   | 251/358 [00:25<00:10,  9.79it/s] 70%|███████   | 252/358 [00:25<00:10,  9.73it/s] 71%|███████   | 253/358 [00:25<00:10,  9.69it/s] 71%|███████   | 254/358 [00:25<00:10,  9.66it/s] 72%|███████▏  | 256/358 [00:26<00:10,  9.84it/s] 72%|███████▏  | 257/358 [00:26<00:10,  9.84it/s] 72%|███████▏  | 258/358 [00:26<00:10,  9.72it/s] 72%|███████▏  | 259/358 [00:26<00:10,  9.68it/s] 73%|███████▎  | 260/358 [00:26<00:10,  9.72it/s] 73%|███████▎  | 262/358 [00:26<00:09,  9.90it/s] 74%|███████▎  | 264/358 [00:26<00:09,  9.92it/s] 74%|███████▍  | 266/358 [00:27<00:09,  9.91it/s] 75%|███████▍  | 267/358 [00:27<00:09,  9.85it/s] 75%|███████▌  | 269/358 [00:27<00:08,  9.91it/s] 75%|███████▌  | 270/358 [00:27<00:08,  9.84it/s] 76%|███████▌  | 271/358 [00:27<00:08,  9.76it/s] 76%|███████▌  | 272/358 [00:27<00:08,  9.74it/s] 76%|███████▋  | 273/358 [00:27<00:08,  9.64it/s] 77%|███████▋  | 274/358 [00:27<00:08,  9.64it/s] 77%|███████▋  | 275/358 [00:28<00:08,  9.69it/s] 77%|███████▋  | 276/358 [00:28<00:08,  9.69it/s] 77%|███████▋  | 277/358 [00:28<00:08,  9.66it/s] 78%|███████▊  | 278/358 [00:28<00:08,  9.64it/s] 78%|███████▊  | 280/358 [00:28<00:07,  9.83it/s] 78%|███████▊  | 281/358 [00:28<00:07,  9.84it/s] 79%|███████▉  | 282/358 [00:28<00:07,  9.78it/s] 79%|███████▉  | 283/358 [00:28<00:07,  9.71it/s] 79%|███████▉  | 284/358 [00:28<00:07,  9.68it/s] 80%|███████▉  | 285/358 [00:29<00:07,  9.74it/s] 80%|███████▉  | 286/358 [00:29<00:07,  9.70it/s] 80%|████████  | 287/358 [00:29<00:07,  9.68it/s] 80%|████████  | 288/358 [00:29<00:07,  9.64it/s] 81%|████████  | 290/358 [00:29<00:06,  9.85it/s] 81%|████████▏ | 291/358 [00:29<00:06,  9.83it/s] 82%|████████▏ | 293/358 [00:29<00:06,  9.84it/s] 82%|████████▏ | 295/358 [00:30<00:06,  9.92it/s] 83%|████████▎ | 296/358 [00:30<00:06,  9.85it/s] 83%|████████▎ | 297/358 [00:30<00:06,  9.74it/s] 84%|████████▎ | 299/358 [00:30<00:05,  9.91it/s] 84%|████████▍ | 301/358 [00:30<00:05,  9.94it/s] 84%|████████▍ | 302/358 [00:30<00:05,  9.88it/s] 85%|████████▍ | 303/358 [00:30<00:05,  9.88it/s] 85%|████████▌ | 305/358 [00:31<00:05,  9.91it/s] 85%|████████▌ | 306/358 [00:31<00:05,  9.83it/s] 86%|████████▌ | 308/358 [00:31<00:05,  9.93it/s] 86%|████████▋ | 309/358 [00:31<00:04,  9.83it/s] 87%|████████▋ | 310/358 [00:31<00:04,  9.78it/s] 87%|████████▋ | 311/358 [00:31<00:04,  9.70it/s] 87%|████████▋ | 312/358 [00:31<00:04,  9.72it/s] 87%|████████▋ | 313/358 [00:31<00:04,  9.73it/s] 88%|████████▊ | 315/358 [00:32<00:04,  9.99it/s] 88%|████████▊ | 316/358 [00:32<00:04,  9.94it/s] 89%|████████▊ | 317/358 [00:32<00:04,  9.86it/s] 89%|████████▉ | 318/358 [00:32<00:04,  9.81it/s] 89%|████████▉ | 319/358 [00:32<00:03,  9.76it/s] 89%|████████▉ | 320/358 [00:32<00:03,  9.82it/s] 90%|████████▉ | 321/358 [00:32<00:03,  9.75it/s] 90%|████████▉ | 322/358 [00:32<00:03,  9.72it/s] 90%|█████████ | 323/358 [00:32<00:03,  9.67it/s] 91%|█████████ | 324/358 [00:33<00:03,  9.64it/s] 91%|█████████ | 325/358 [00:33<00:03,  9.62it/s] 91%|█████████▏| 327/358 [00:33<00:03,  9.98it/s] 92%|█████████▏| 329/358 [00:33<00:02, 10.08it/s] 92%|█████████▏| 330/358 [00:33<00:02,  9.96it/s] 93%|█████████▎| 332/358 [00:33<00:02, 10.06it/s] 93%|█████████▎| 334/358 [00:34<00:02,  9.97it/s] 94%|█████████▎| 335/358 [00:34<00:02,  9.84it/s] 94%|█████████▍| 337/358 [00:34<00:02,  9.92it/s] 95%|█████████▍| 339/358 [00:34<00:01, 10.12it/s] 95%|█████████▌| 341/358 [00:34<00:01, 10.07it/s] 96%|█████████▌| 343/358 [00:34<00:01,  9.90it/s] 96%|█████████▌| 344/358 [00:35<00:01,  9.84it/s] 96%|█████████▋| 345/358 [00:35<00:01,  9.86it/s] 97%|█████████▋| 347/358 [00:35<00:01, 10.04it/s] 97%|█████████▋| 348/358 [00:35<00:01,  9.94it/s] 97%|█████████▋| 349/358 [00:35<00:00,  9.87it/s] 98%|█████████▊| 350/358 [00:35<00:00,  9.80it/s] 98%|█████████▊| 351/358 [00:35<00:00,  9.75it/s] 99%|█████████▊| 353/358 [00:35<00:00,  9.93it/s] 99%|█████████▉| 354/358 [00:36<00:00,  9.92it/s] 99%|█████████▉| 355/358 [00:36<00:00,  9.83it/s]100%|█████████▉| 357/358 [00:36<00:00,  9.88it/s]100%|██████████| 358/358 [00:36<00:00,  9.83it/s]
[32m2025-02-05 06:25:36.052[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    gen_loss  grad clip ratio  grad norm   ppl
       1.785                1      3.536 5.959[0m
[32m2025-02-05 06:25:36.052[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m169[0m - [1m[Valid][0m
  0%|          | 0/10256 [00:00<?, ?it/s]100%|██████████| 10256/10256 [00:00<00:00, 1086941.12it/s]
[32m2025-02-05 06:25:36.062[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:27,  1.43it/s]  5%|▌         | 2/40 [00:01<00:26,  1.44it/s]  8%|▊         | 3/40 [00:02<00:25,  1.45it/s] 10%|█         | 4/40 [00:02<00:24,  1.45it/s] 12%|█▎        | 5/40 [00:03<00:24,  1.44it/s] 15%|█▌        | 6/40 [00:04<00:23,  1.44it/s] 18%|█▊        | 7/40 [00:04<00:23,  1.43it/s] 20%|██        | 8/40 [00:05<00:22,  1.44it/s] 22%|██▎       | 9/40 [00:06<00:21,  1.44it/s] 25%|██▌       | 10/40 [00:06<00:20,  1.44it/s] 28%|██▊       | 11/40 [00:07<00:20,  1.44it/s] 30%|███       | 12/40 [00:08<00:19,  1.44it/s] 32%|███▎      | 13/40 [00:09<00:18,  1.45it/s] 35%|███▌      | 14/40 [00:09<00:18,  1.44it/s] 38%|███▊      | 15/40 [00:10<00:17,  1.44it/s] 40%|████      | 16/40 [00:11<00:16,  1.44it/s] 42%|████▎     | 17/40 [00:11<00:15,  1.45it/s] 45%|████▌     | 18/40 [00:12<00:15,  1.45it/s] 48%|████▊     | 19/40 [00:13<00:14,  1.44it/s] 50%|█████     | 20/40 [00:13<00:13,  1.45it/s] 52%|█████▎    | 21/40 [00:14<00:13,  1.45it/s] 55%|█████▌    | 22/40 [00:15<00:12,  1.44it/s] 57%|█████▊    | 23/40 [00:15<00:11,  1.45it/s] 60%|██████    | 24/40 [00:16<00:11,  1.43it/s] 62%|██████▎   | 25/40 [00:17<00:10,  1.44it/s] 65%|██████▌   | 26/40 [00:18<00:09,  1.45it/s] 68%|██████▊   | 27/40 [00:18<00:08,  1.45it/s] 70%|███████   | 28/40 [00:19<00:08,  1.45it/s] 72%|███████▎  | 29/40 [00:20<00:07,  1.45it/s] 75%|███████▌  | 30/40 [00:20<00:06,  1.45it/s] 78%|███████▊  | 31/40 [00:21<00:06,  1.44it/s] 80%|████████  | 32/40 [00:22<00:05,  1.45it/s] 82%|████████▎ | 33/40 [00:22<00:04,  1.44it/s] 85%|████████▌ | 34/40 [00:23<00:04,  1.44it/s] 88%|████████▊ | 35/40 [00:24<00:03,  1.44it/s] 90%|█████████ | 36/40 [00:24<00:02,  1.43it/s] 92%|█████████▎| 37/40 [00:25<00:02,  1.44it/s] 95%|█████████▌| 38/40 [00:26<00:01,  1.43it/s] 98%|█████████▊| 39/40 [00:27<00:00,  1.43it/s]100%|██████████| 40/40 [00:27<00:00,  1.58it/s]100%|██████████| 40/40 [00:27<00:00,  1.45it/s]
[32m2025-02-05 06:26:03.602[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    average  bleu@1  bleu@2  bleu@3  bleu@4  dist@1  dist@2  dist@3  dist@4  extreme  \
      .7815   .2959   .1116  .04515  .02344  .04558   .3174   .6099   .7821    .6009   
      f1  gen_loss  greedy  intra_dist@1  intra_dist@2  intra_dist@3  intra_dist@4  \
   .3492     5.312   .6645         .8642         .9694         .9557         .9291   
     ppl  rouge1  rouge2  rougeL  
   202.8   .3815   .0909   .3690[0m
[32m2025-02-05 06:26:03.610[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m163[0m - [1m[Conversation epoch 73][0m
[32m2025-02-05 06:26:03.610[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m164[0m - [1m[Train][0m
  0%|          | 0/92414 [00:00<?, ?it/s]100%|██████████| 92414/92414 [00:00<00:00, 1001965.64it/s]
[32m2025-02-05 06:26:03.702[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/358 [00:00<?, ?it/s]  0%|          | 1/358 [00:00<00:36,  9.76it/s]  1%|          | 3/358 [00:00<00:35,  9.94it/s]  1%|          | 4/358 [00:00<00:35,  9.92it/s]  2%|▏         | 6/358 [00:00<00:35,  9.88it/s]  2%|▏         | 7/358 [00:00<00:35,  9.82it/s]  2%|▏         | 8/358 [00:00<00:35,  9.86it/s]  3%|▎         | 9/358 [00:00<00:35,  9.77it/s]  3%|▎         | 10/358 [00:01<00:35,  9.76it/s]  3%|▎         | 11/358 [00:01<00:35,  9.70it/s]  4%|▎         | 13/358 [00:01<00:34,  9.92it/s]  4%|▍         | 14/358 [00:01<00:34,  9.85it/s]  4%|▍         | 15/358 [00:01<00:35,  9.77it/s]  4%|▍         | 16/358 [00:01<00:35,  9.70it/s]  5%|▍         | 17/358 [00:01<00:35,  9.72it/s]  5%|▌         | 18/358 [00:01<00:34,  9.80it/s]  5%|▌         | 19/358 [00:01<00:34,  9.73it/s]  6%|▌         | 20/358 [00:02<00:34,  9.68it/s]  6%|▌         | 21/358 [00:02<00:35,  9.60it/s]  6%|▌         | 22/358 [00:02<00:34,  9.67it/s]  7%|▋         | 24/358 [00:02<00:34,  9.78it/s]  7%|▋         | 25/358 [00:02<00:34,  9.72it/s]  7%|▋         | 26/358 [00:02<00:34,  9.67it/s]  8%|▊         | 27/358 [00:02<00:34,  9.73it/s]  8%|▊         | 28/358 [00:02<00:34,  9.69it/s]  8%|▊         | 29/358 [00:02<00:34,  9.65it/s]  9%|▊         | 31/358 [00:03<00:33,  9.75it/s]  9%|▉         | 32/358 [00:03<00:33,  9.75it/s]  9%|▉         | 34/358 [00:03<00:32,  9.85it/s] 10%|█         | 36/358 [00:03<00:32,  9.85it/s] 10%|█         | 37/358 [00:03<00:32,  9.83it/s] 11%|█         | 38/358 [00:03<00:32,  9.79it/s] 11%|█         | 40/358 [00:04<00:31,  9.95it/s] 11%|█▏        | 41/358 [00:04<00:32,  9.86it/s] 12%|█▏        | 43/358 [00:04<00:31,  9.89it/s] 13%|█▎        | 45/358 [00:04<00:31,  9.99it/s] 13%|█▎        | 47/358 [00:04<00:31,  9.96it/s] 13%|█▎        | 48/358 [00:04<00:31,  9.95it/s] 14%|█▍        | 50/358 [00:05<00:31,  9.92it/s] 14%|█▍        | 51/358 [00:05<00:31,  9.85it/s] 15%|█▍        | 52/358 [00:05<00:31,  9.76it/s] 15%|█▍        | 53/358 [00:05<00:31,  9.71it/s] 15%|█▌        | 54/358 [00:05<00:31,  9.75it/s] 15%|█▌        | 55/358 [00:05<00:31,  9.70it/s] 16%|█▌        | 56/358 [00:05<00:31,  9.74it/s] 16%|█▌        | 57/358 [00:05<00:31,  9.70it/s] 16%|█▌        | 58/358 [00:05<00:31,  9.67it/s] 16%|█▋        | 59/358 [00:06<00:31,  9.64it/s] 17%|█▋        | 61/358 [00:06<00:30,  9.73it/s] 17%|█▋        | 62/358 [00:06<00:30,  9.65it/s] 18%|█▊        | 63/358 [00:06<00:30,  9.72it/s] 18%|█▊        | 64/358 [00:06<00:30,  9.67it/s] 18%|█▊        | 66/358 [00:06<00:29,  9.73it/s] 19%|█▊        | 67/358 [00:06<00:29,  9.72it/s] 19%|█▉        | 69/358 [00:07<00:29,  9.78it/s] 20%|█▉        | 70/358 [00:07<00:29,  9.73it/s] 20%|█▉        | 71/358 [00:07<00:29,  9.78it/s] 20%|██        | 72/358 [00:07<00:29,  9.72it/s] 20%|██        | 73/358 [00:07<00:29,  9.69it/s] 21%|██        | 74/358 [00:07<00:29,  9.66it/s] 21%|██        | 75/358 [00:07<00:29,  9.63it/s] 21%|██        | 76/358 [00:07<00:28,  9.73it/s] 22%|██▏       | 77/358 [00:07<00:28,  9.70it/s] 22%|██▏       | 79/358 [00:08<00:28,  9.70it/s] 23%|██▎       | 81/358 [00:08<00:28,  9.76it/s] 23%|██▎       | 83/358 [00:08<00:28,  9.79it/s] 23%|██▎       | 84/358 [00:08<00:28,  9.74it/s] 24%|██▎       | 85/358 [00:08<00:28,  9.69it/s] 24%|██▍       | 86/358 [00:08<00:28,  9.68it/s] 24%|██▍       | 87/358 [00:08<00:28,  9.66it/s] 25%|██▍       | 88/358 [00:09<00:27,  9.68it/s] 25%|██▌       | 90/358 [00:09<00:27,  9.91it/s] 26%|██▌       | 92/358 [00:09<00:26, 10.01it/s] 26%|██▌       | 93/358 [00:09<00:26,  9.97it/s] 26%|██▋       | 94/358 [00:09<00:26,  9.89it/s] 27%|██▋       | 96/358 [00:09<00:25, 10.17it/s] 27%|██▋       | 98/358 [00:09<00:25, 10.06it/s] 28%|██▊       | 100/358 [00:10<00:25, 10.01it/s] 28%|██▊       | 101/358 [00:10<00:25,  9.92it/s] 29%|██▉       | 103/358 [00:10<00:25,  9.91it/s] 29%|██▉       | 104/358 [00:10<00:25,  9.86it/s] 29%|██▉       | 105/358 [00:10<00:25,  9.78it/s] 30%|██▉       | 106/358 [00:10<00:25,  9.77it/s] 30%|███       | 108/358 [00:11<00:25,  9.80it/s] 30%|███       | 109/358 [00:11<00:25,  9.72it/s] 31%|███       | 110/358 [00:11<00:25,  9.70it/s] 31%|███       | 111/358 [00:11<00:25,  9.65it/s] 32%|███▏      | 113/358 [00:11<00:24,  9.92it/s] 32%|███▏      | 114/358 [00:11<00:24,  9.88it/s] 32%|███▏      | 115/358 [00:11<00:24,  9.78it/s] 32%|███▏      | 116/358 [00:11<00:24,  9.70it/s] 33%|███▎      | 117/358 [00:11<00:24,  9.67it/s] 33%|███▎      | 119/358 [00:12<00:24,  9.79it/s] 34%|███▍      | 121/358 [00:12<00:23,  9.99it/s] 34%|███▍      | 123/358 [00:12<00:23, 10.09it/s] 35%|███▍      | 125/358 [00:12<00:23, 10.07it/s] 35%|███▌      | 127/358 [00:12<00:23,  9.99it/s] 36%|███▌      | 128/358 [00:13<00:23,  9.95it/s] 36%|███▋      | 130/358 [00:13<00:22, 10.00it/s] 37%|███▋      | 131/358 [00:13<00:22,  9.91it/s] 37%|███▋      | 132/358 [00:13<00:22,  9.93it/s] 37%|███▋      | 134/358 [00:13<00:22,  9.95it/s] 38%|███▊      | 135/358 [00:13<00:22,  9.88it/s] 38%|███▊      | 137/358 [00:13<00:22,  9.97it/s] 39%|███▊      | 138/358 [00:14<00:22,  9.95it/s] 39%|███▉      | 139/358 [00:14<00:22,  9.87it/s] 39%|███▉      | 141/358 [00:14<00:21,  9.99it/s] 40%|███▉      | 142/358 [00:14<00:21,  9.91it/s] 40%|███▉      | 143/358 [00:14<00:21,  9.88it/s] 40%|████      | 144/358 [00:14<00:21,  9.79it/s] 41%|████      | 145/358 [00:14<00:21,  9.81it/s] 41%|████      | 146/358 [00:14<00:21,  9.74it/s] 41%|████      | 147/358 [00:14<00:21,  9.69it/s] 41%|████▏     | 148/358 [00:15<00:21,  9.71it/s] 42%|████▏     | 149/358 [00:15<00:21,  9.70it/s] 42%|████▏     | 150/358 [00:15<00:21,  9.66it/s] 42%|████▏     | 151/358 [00:15<00:22,  9.39it/s] 42%|████▏     | 152/358 [00:15<00:21,  9.44it/s] 43%|████▎     | 153/358 [00:15<00:21,  9.46it/s] 43%|████▎     | 154/358 [00:15<00:21,  9.55it/s] 43%|████▎     | 155/358 [00:15<00:21,  9.56it/s] 44%|████▎     | 156/358 [00:15<00:20,  9.69it/s] 44%|████▍     | 157/358 [00:16<00:20,  9.63it/s] 44%|████▍     | 158/358 [00:16<00:20,  9.71it/s] 44%|████▍     | 159/358 [00:16<00:20,  9.71it/s] 45%|████▍     | 160/358 [00:16<00:20,  9.72it/s] 45%|████▌     | 162/358 [00:16<00:19, 10.01it/s] 46%|████▌     | 164/358 [00:16<00:19, 10.01it/s] 46%|████▌     | 165/358 [00:16<00:19,  9.97it/s] 47%|████▋     | 167/358 [00:17<00:19,  9.91it/s] 47%|████▋     | 169/358 [00:17<00:18,  9.95it/s] 48%|████▊     | 171/358 [00:17<00:18,  9.93it/s] 48%|████▊     | 172/358 [00:17<00:18,  9.88it/s] 48%|████▊     | 173/358 [00:17<00:18,  9.82it/s] 49%|████▉     | 175/358 [00:17<00:18,  9.84it/s] 49%|████▉     | 176/358 [00:17<00:18,  9.86it/s] 49%|████▉     | 177/358 [00:18<00:18,  9.84it/s] 50%|█████     | 179/358 [00:18<00:18,  9.87it/s] 50%|█████     | 180/358 [00:18<00:18,  9.80it/s] 51%|█████     | 182/358 [00:18<00:17,  9.95it/s] 51%|█████     | 183/358 [00:18<00:17,  9.90it/s] 51%|█████▏    | 184/358 [00:18<00:17,  9.79it/s] 52%|█████▏    | 185/358 [00:18<00:17,  9.74it/s] 52%|█████▏    | 187/358 [00:19<00:17,  9.95it/s] 53%|█████▎    | 188/358 [00:19<00:17,  9.90it/s] 53%|█████▎    | 189/358 [00:19<00:17,  9.84it/s] 53%|█████▎    | 191/358 [00:19<00:17,  9.76it/s] 54%|█████▎    | 192/358 [00:19<00:17,  9.70it/s] 54%|█████▍    | 193/358 [00:19<00:17,  9.70it/s] 54%|█████▍    | 194/358 [00:19<00:16,  9.68it/s] 54%|█████▍    | 195/358 [00:19<00:16,  9.75it/s] 55%|█████▌    | 197/358 [00:20<00:16,  9.92it/s] 55%|█████▌    | 198/358 [00:20<00:16,  9.85it/s] 56%|█████▌    | 199/358 [00:20<00:16,  9.88it/s] 56%|█████▌    | 200/358 [00:20<00:16,  9.81it/s] 56%|█████▌    | 201/358 [00:20<00:16,  9.77it/s] 57%|█████▋    | 203/358 [00:20<00:15,  9.86it/s] 57%|█████▋    | 204/358 [00:20<00:15,  9.75it/s] 57%|█████▋    | 205/358 [00:20<00:15,  9.71it/s] 58%|█████▊    | 207/358 [00:21<00:15,  9.88it/s] 58%|█████▊    | 208/358 [00:21<00:15,  9.81it/s] 59%|█████▊    | 210/358 [00:21<00:15,  9.83it/s] 59%|█████▉    | 212/358 [00:21<00:14,  9.82it/s] 60%|█████▉    | 214/358 [00:21<00:14,  9.90it/s] 60%|██████    | 215/358 [00:21<00:14,  9.84it/s] 60%|██████    | 216/358 [00:22<00:14,  9.77it/s] 61%|██████    | 217/358 [00:22<00:14,  9.80it/s] 61%|██████    | 218/358 [00:22<00:14,  9.77it/s] 61%|██████    | 219/358 [00:22<00:14,  9.78it/s] 62%|██████▏   | 221/358 [00:22<00:13,  9.91it/s] 62%|██████▏   | 222/358 [00:22<00:13,  9.81it/s] 62%|██████▏   | 223/358 [00:22<00:13,  9.75it/s] 63%|██████▎   | 224/358 [00:22<00:13,  9.70it/s] 63%|██████▎   | 226/358 [00:23<00:13,  9.74it/s] 64%|██████▎   | 228/358 [00:23<00:13,  9.77it/s] 64%|██████▍   | 229/358 [00:23<00:13,  9.75it/s] 64%|██████▍   | 230/358 [00:23<00:13,  9.70it/s] 65%|██████▍   | 232/358 [00:23<00:12,  9.74it/s] 65%|██████▌   | 234/358 [00:23<00:12, 10.03it/s] 66%|██████▌   | 236/358 [00:24<00:12,  9.99it/s] 66%|██████▋   | 238/358 [00:24<00:11, 10.04it/s] 67%|██████▋   | 240/358 [00:24<00:11, 10.00it/s] 68%|██████▊   | 242/358 [00:24<00:11,  9.98it/s] 68%|██████▊   | 243/358 [00:24<00:11,  9.92it/s] 68%|██████▊   | 244/358 [00:24<00:11,  9.85it/s] 69%|██████▊   | 246/358 [00:25<00:11,  9.87it/s] 69%|██████▉   | 247/358 [00:25<00:11,  9.80it/s] 69%|██████▉   | 248/358 [00:25<00:11,  9.76it/s] 70%|██████▉   | 250/358 [00:25<00:10,  9.86it/s] 70%|███████   | 251/358 [00:25<00:10,  9.79it/s] 70%|███████   | 252/358 [00:25<00:10,  9.73it/s] 71%|███████   | 253/358 [00:25<00:10,  9.69it/s] 71%|███████   | 254/358 [00:25<00:10,  9.67it/s] 72%|███████▏  | 256/358 [00:26<00:10,  9.85it/s] 72%|███████▏  | 257/358 [00:26<00:10,  9.85it/s] 72%|███████▏  | 258/358 [00:26<00:10,  9.72it/s] 72%|███████▏  | 259/358 [00:26<00:10,  9.68it/s] 73%|███████▎  | 260/358 [00:26<00:10,  9.72it/s] 73%|███████▎  | 262/358 [00:26<00:09,  9.90it/s] 74%|███████▎  | 264/358 [00:26<00:09,  9.92it/s] 74%|███████▍  | 266/358 [00:27<00:09,  9.91it/s] 75%|███████▍  | 267/358 [00:27<00:09,  9.85it/s] 75%|███████▌  | 269/358 [00:27<00:08,  9.91it/s] 75%|███████▌  | 270/358 [00:27<00:08,  9.83it/s] 76%|███████▌  | 271/358 [00:27<00:08,  9.76it/s] 76%|███████▌  | 272/358 [00:27<00:08,  9.74it/s] 76%|███████▋  | 273/358 [00:27<00:08,  9.64it/s] 77%|███████▋  | 274/358 [00:27<00:08,  9.64it/s] 77%|███████▋  | 275/358 [00:28<00:08,  9.69it/s] 77%|███████▋  | 276/358 [00:28<00:08,  9.69it/s] 77%|███████▋  | 277/358 [00:28<00:08,  9.66it/s] 78%|███████▊  | 278/358 [00:28<00:08,  9.64it/s] 78%|███████▊  | 280/358 [00:28<00:07,  9.83it/s] 78%|███████▊  | 281/358 [00:28<00:07,  9.84it/s] 79%|███████▉  | 282/358 [00:28<00:07,  9.78it/s] 79%|███████▉  | 283/358 [00:28<00:07,  9.72it/s] 79%|███████▉  | 284/358 [00:28<00:07,  9.68it/s] 80%|███████▉  | 285/358 [00:29<00:07,  9.75it/s] 80%|███████▉  | 286/358 [00:29<00:07,  9.70it/s] 80%|████████  | 287/358 [00:29<00:07,  9.68it/s] 80%|████████  | 288/358 [00:29<00:07,  9.64it/s] 81%|████████  | 290/358 [00:29<00:06,  9.85it/s] 81%|████████▏ | 291/358 [00:29<00:06,  9.83it/s] 82%|████████▏ | 293/358 [00:29<00:06,  9.84it/s] 82%|████████▏ | 295/358 [00:30<00:06,  9.92it/s] 83%|████████▎ | 296/358 [00:30<00:06,  9.85it/s] 83%|████████▎ | 297/358 [00:30<00:06,  9.74it/s] 84%|████████▎ | 299/358 [00:30<00:05,  9.90it/s] 84%|████████▍ | 301/358 [00:30<00:05,  9.94it/s] 84%|████████▍ | 302/358 [00:30<00:05,  9.87it/s] 85%|████████▍ | 303/358 [00:30<00:05,  9.88it/s] 85%|████████▌ | 305/358 [00:31<00:05,  9.91it/s] 85%|████████▌ | 306/358 [00:31<00:05,  9.83it/s] 86%|████████▌ | 308/358 [00:31<00:05,  9.93it/s] 86%|████████▋ | 309/358 [00:31<00:04,  9.83it/s] 87%|████████▋ | 310/358 [00:31<00:04,  9.77it/s] 87%|████████▋ | 311/358 [00:31<00:04,  9.70it/s] 87%|████████▋ | 312/358 [00:31<00:04,  9.71it/s] 87%|████████▋ | 313/358 [00:31<00:04,  9.73it/s] 88%|████████▊ | 315/358 [00:32<00:04,  9.98it/s] 88%|████████▊ | 316/358 [00:32<00:04,  9.93it/s] 89%|████████▊ | 317/358 [00:32<00:04,  9.85it/s] 89%|████████▉ | 318/358 [00:32<00:04,  9.80it/s] 89%|████████▉ | 319/358 [00:32<00:03,  9.76it/s] 89%|████████▉ | 320/358 [00:32<00:03,  9.82it/s] 90%|████████▉ | 321/358 [00:32<00:03,  9.74it/s] 90%|████████▉ | 322/358 [00:32<00:03,  9.71it/s] 90%|█████████ | 323/358 [00:32<00:03,  9.66it/s] 91%|█████████ | 324/358 [00:33<00:03,  9.64it/s] 91%|█████████ | 325/358 [00:33<00:03,  9.61it/s] 91%|█████████▏| 327/358 [00:33<00:03,  9.98it/s] 92%|█████████▏| 329/358 [00:33<00:02, 10.07it/s] 92%|█████████▏| 330/358 [00:33<00:02,  9.96it/s] 93%|█████████▎| 332/358 [00:33<00:02, 10.06it/s] 93%|█████████▎| 334/358 [00:34<00:02,  9.97it/s] 94%|█████████▎| 335/358 [00:34<00:02,  9.84it/s] 94%|█████████▍| 337/358 [00:34<00:02,  9.92it/s] 95%|█████████▍| 339/358 [00:34<00:01, 10.12it/s] 95%|█████████▌| 341/358 [00:34<00:01, 10.07it/s] 96%|█████████▌| 343/358 [00:34<00:01,  9.91it/s] 96%|█████████▌| 344/358 [00:35<00:01,  9.85it/s] 96%|█████████▋| 345/358 [00:35<00:01,  9.87it/s] 97%|█████████▋| 347/358 [00:35<00:01, 10.05it/s] 97%|█████████▋| 348/358 [00:35<00:01,  9.94it/s] 97%|█████████▋| 349/358 [00:35<00:00,  9.87it/s] 98%|█████████▊| 350/358 [00:35<00:00,  9.79it/s] 98%|█████████▊| 351/358 [00:35<00:00,  9.75it/s] 99%|█████████▊| 353/358 [00:35<00:00,  9.92it/s] 99%|█████████▉| 354/358 [00:36<00:00,  9.90it/s] 99%|█████████▉| 355/358 [00:36<00:00,  9.81it/s]100%|█████████▉| 357/358 [00:36<00:00,  9.87it/s]100%|██████████| 358/358 [00:36<00:00,  9.83it/s]
[32m2025-02-05 06:26:40.116[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    gen_loss  grad clip ratio  grad norm   ppl
       1.783                1      2.998 5.946[0m
[32m2025-02-05 06:26:40.116[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m169[0m - [1m[Valid][0m
  0%|          | 0/10256 [00:00<?, ?it/s]100%|██████████| 10256/10256 [00:00<00:00, 1112407.08it/s]
[32m2025-02-05 06:26:40.126[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:27,  1.44it/s]  5%|▌         | 2/40 [00:01<00:26,  1.45it/s]  8%|▊         | 3/40 [00:02<00:25,  1.46it/s] 10%|█         | 4/40 [00:02<00:24,  1.46it/s] 12%|█▎        | 5/40 [00:03<00:24,  1.45it/s] 15%|█▌        | 6/40 [00:04<00:23,  1.45it/s] 18%|█▊        | 7/40 [00:04<00:22,  1.45it/s] 20%|██        | 8/40 [00:05<00:21,  1.46it/s] 22%|██▎       | 9/40 [00:06<00:21,  1.46it/s] 25%|██▌       | 10/40 [00:06<00:20,  1.46it/s] 28%|██▊       | 11/40 [00:07<00:19,  1.46it/s] 30%|███       | 12/40 [00:08<00:19,  1.46it/s] 32%|███▎      | 13/40 [00:08<00:18,  1.46it/s] 35%|███▌      | 14/40 [00:09<00:17,  1.45it/s] 38%|███▊      | 15/40 [00:10<00:17,  1.45it/s] 40%|████      | 16/40 [00:10<00:16,  1.45it/s] 42%|████▎     | 17/40 [00:11<00:15,  1.45it/s] 45%|████▌     | 18/40 [00:12<00:15,  1.46it/s] 48%|████▊     | 19/40 [00:13<00:14,  1.45it/s] 50%|█████     | 20/40 [00:13<00:13,  1.46it/s] 52%|█████▎    | 21/40 [00:14<00:12,  1.46it/s] 55%|█████▌    | 22/40 [00:15<00:12,  1.46it/s] 57%|█████▊    | 23/40 [00:15<00:11,  1.46it/s] 60%|██████    | 24/40 [00:16<00:10,  1.46it/s] 62%|██████▎   | 25/40 [00:17<00:10,  1.45it/s] 65%|██████▌   | 26/40 [00:17<00:09,  1.46it/s] 68%|██████▊   | 27/40 [00:18<00:08,  1.46it/s] 70%|███████   | 28/40 [00:19<00:08,  1.46it/s] 72%|███████▎  | 29/40 [00:19<00:07,  1.46it/s] 75%|███████▌  | 30/40 [00:20<00:06,  1.47it/s] 78%|███████▊  | 31/40 [00:21<00:06,  1.46it/s] 80%|████████  | 32/40 [00:21<00:05,  1.46it/s] 82%|████████▎ | 33/40 [00:22<00:04,  1.46it/s] 85%|████████▌ | 34/40 [00:23<00:04,  1.46it/s] 88%|████████▊ | 35/40 [00:24<00:03,  1.46it/s] 90%|█████████ | 36/40 [00:24<00:02,  1.45it/s] 92%|█████████▎| 37/40 [00:25<00:02,  1.45it/s] 95%|█████████▌| 38/40 [00:26<00:01,  1.45it/s] 98%|█████████▊| 39/40 [00:26<00:00,  1.45it/s]100%|██████████| 40/40 [00:27<00:00,  1.60it/s]100%|██████████| 40/40 [00:27<00:00,  1.47it/s]
[32m2025-02-05 06:27:07.389[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    average  bleu@1  bleu@2  bleu@3  bleu@4  dist@1  dist@2  dist@3  dist@4  extreme  \
      .7792   .2978   .1120  .04174  .01997  .04367   .2970   .5707   .7331    .5988   
      f1  gen_loss  greedy  intra_dist@1  intra_dist@2  intra_dist@3  intra_dist@4  \
   .3503      5.28   .6697         .8645         .9614         .9457         .9115   
     ppl  rouge1  rouge2  rougeL  
   196.3   .3862  .09153   .3742[0m
[32m2025-02-05 06:27:07.396[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m163[0m - [1m[Conversation epoch 74][0m
[32m2025-02-05 06:27:07.396[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m164[0m - [1m[Train][0m
  0%|          | 0/92414 [00:00<?, ?it/s]100%|██████████| 92414/92414 [00:00<00:00, 998620.14it/s]
[32m2025-02-05 06:27:07.489[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/358 [00:00<?, ?it/s]  0%|          | 1/358 [00:00<00:36,  9.75it/s]  1%|          | 3/358 [00:00<00:35,  9.93it/s]  1%|          | 4/358 [00:00<00:35,  9.91it/s]  2%|▏         | 6/358 [00:00<00:35,  9.87it/s]  2%|▏         | 7/358 [00:00<00:35,  9.81it/s]  2%|▏         | 8/358 [00:00<00:35,  9.86it/s]  3%|▎         | 9/358 [00:00<00:35,  9.76it/s]  3%|▎         | 10/358 [00:01<00:35,  9.75it/s]  3%|▎         | 11/358 [00:01<00:35,  9.70it/s]  4%|▎         | 13/358 [00:01<00:34,  9.92it/s]  4%|▍         | 14/358 [00:01<00:34,  9.84it/s]  4%|▍         | 15/358 [00:01<00:35,  9.77it/s]  4%|▍         | 16/358 [00:01<00:35,  9.70it/s]  5%|▍         | 17/358 [00:01<00:35,  9.72it/s]  5%|▌         | 19/358 [00:01<00:34,  9.75it/s]  6%|▌         | 20/358 [00:02<00:34,  9.70it/s]  6%|▌         | 21/358 [00:02<00:34,  9.63it/s]  6%|▌         | 22/358 [00:02<00:34,  9.69it/s]  7%|▋         | 24/358 [00:02<00:34,  9.78it/s]  7%|▋         | 25/358 [00:02<00:34,  9.73it/s]  7%|▋         | 26/358 [00:02<00:34,  9.68it/s]  8%|▊         | 27/358 [00:02<00:34,  9.73it/s]  8%|▊         | 28/358 [00:02<00:34,  9.69it/s]  8%|▊         | 29/358 [00:02<00:34,  9.65it/s]  9%|▊         | 31/358 [00:03<00:33,  9.75it/s]  9%|▉         | 32/358 [00:03<00:33,  9.75it/s]  9%|▉         | 34/358 [00:03<00:32,  9.85it/s] 10%|█         | 36/358 [00:03<00:32,  9.85it/s] 10%|█         | 37/358 [00:03<00:32,  9.83it/s] 11%|█         | 38/358 [00:03<00:32,  9.79it/s] 11%|█         | 40/358 [00:04<00:31,  9.95it/s] 11%|█▏        | 41/358 [00:04<00:32,  9.87it/s] 12%|█▏        | 43/358 [00:04<00:31,  9.89it/s] 13%|█▎        | 45/358 [00:04<00:31,  9.99it/s] 13%|█▎        | 47/358 [00:04<00:31,  9.96it/s] 13%|█▎        | 48/358 [00:04<00:31,  9.95it/s] 14%|█▍        | 50/358 [00:05<00:31,  9.92it/s] 14%|█▍        | 51/358 [00:05<00:31,  9.85it/s] 15%|█▍        | 52/358 [00:05<00:31,  9.76it/s] 15%|█▍        | 53/358 [00:05<00:31,  9.71it/s] 15%|█▌        | 54/358 [00:05<00:31,  9.75it/s] 15%|█▌        | 55/358 [00:05<00:31,  9.70it/s] 16%|█▌        | 56/358 [00:05<00:31,  9.74it/s] 16%|█▌        | 57/358 [00:05<00:31,  9.70it/s] 16%|█▌        | 58/358 [00:05<00:31,  9.67it/s] 16%|█▋        | 59/358 [00:06<00:31,  9.64it/s] 17%|█▋        | 61/358 [00:06<00:30,  9.73it/s] 17%|█▋        | 62/358 [00:06<00:30,  9.65it/s] 18%|█▊        | 63/358 [00:06<00:30,  9.71it/s] 18%|█▊        | 64/358 [00:06<00:30,  9.67it/s] 18%|█▊        | 66/358 [00:06<00:29,  9.74it/s] 19%|█▊        | 67/358 [00:06<00:29,  9.72it/s] 19%|█▉        | 69/358 [00:07<00:29,  9.79it/s] 20%|█▉        | 70/358 [00:07<00:29,  9.73it/s] 20%|█▉        | 71/358 [00:07<00:29,  9.78it/s] 20%|██        | 72/358 [00:07<00:29,  9.73it/s] 20%|██        | 73/358 [00:07<00:29,  9.69it/s] 21%|██        | 74/358 [00:07<00:29,  9.66it/s] 21%|██        | 75/358 [00:07<00:29,  9.63it/s] 21%|██        | 76/358 [00:07<00:28,  9.73it/s] 22%|██▏       | 77/358 [00:07<00:28,  9.69it/s] 22%|██▏       | 79/358 [00:08<00:28,  9.70it/s] 23%|██▎       | 81/358 [00:08<00:28,  9.76it/s] 23%|██▎       | 83/358 [00:08<00:28,  9.79it/s] 23%|██▎       | 84/358 [00:08<00:28,  9.74it/s] 24%|██▎       | 85/358 [00:08<00:28,  9.69it/s] 24%|██▍       | 86/358 [00:08<00:28,  9.68it/s] 24%|██▍       | 87/358 [00:08<00:28,  9.66it/s] 25%|██▍       | 88/358 [00:09<00:27,  9.67it/s] 25%|██▌       | 90/358 [00:09<00:27,  9.91it/s] 26%|██▌       | 92/358 [00:09<00:26, 10.01it/s] 26%|██▌       | 93/358 [00:09<00:26,  9.97it/s] 26%|██▋       | 94/358 [00:09<00:26,  9.88it/s] 27%|██▋       | 96/358 [00:09<00:25, 10.17it/s] 27%|██▋       | 98/358 [00:10<00:25, 10.05it/s] 28%|██▊       | 99/358 [00:10<00:26,  9.96it/s] 28%|██▊       | 101/358 [00:10<00:25,  9.93it/s] 29%|██▉       | 103/358 [00:10<00:25,  9.92it/s] 29%|██▉       | 104/358 [00:10<00:25,  9.87it/s] 29%|██▉       | 105/358 [00:10<00:25,  9.79it/s] 30%|██▉       | 106/358 [00:10<00:25,  9.78it/s] 30%|███       | 108/358 [00:11<00:25,  9.81it/s] 30%|███       | 109/358 [00:11<00:25,  9.71it/s] 31%|███       | 110/358 [00:11<00:25,  9.70it/s] 31%|███       | 111/358 [00:11<00:25,  9.65it/s] 32%|███▏      | 113/358 [00:11<00:24,  9.92it/s] 32%|███▏      | 114/358 [00:11<00:24,  9.88it/s] 32%|███▏      | 115/358 [00:11<00:24,  9.78it/s] 32%|███▏      | 116/358 [00:11<00:24,  9.70it/s] 33%|███▎      | 117/358 [00:11<00:24,  9.67it/s] 33%|███▎      | 119/358 [00:12<00:24,  9.79it/s] 34%|███▍      | 121/358 [00:12<00:23,  9.99it/s] 34%|███▍      | 123/358 [00:12<00:23, 10.09it/s] 35%|███▍      | 125/358 [00:12<00:23, 10.07it/s] 35%|███▌      | 127/358 [00:12<00:23,  9.99it/s] 36%|███▌      | 128/358 [00:13<00:23,  9.95it/s] 36%|███▋      | 130/358 [00:13<00:22, 10.00it/s] 37%|███▋      | 131/358 [00:13<00:22,  9.91it/s] 37%|███▋      | 132/358 [00:13<00:22,  9.93it/s] 37%|███▋      | 134/358 [00:13<00:22,  9.94it/s] 38%|███▊      | 135/358 [00:13<00:22,  9.88it/s] 38%|███▊      | 137/358 [00:13<00:22,  9.97it/s] 39%|███▊      | 138/358 [00:14<00:22,  9.95it/s] 39%|███▉      | 139/358 [00:14<00:22,  9.87it/s] 39%|███▉      | 141/358 [00:14<00:21,  9.99it/s] 40%|███▉      | 142/358 [00:14<00:21,  9.91it/s] 40%|███▉      | 143/358 [00:14<00:21,  9.87it/s] 40%|████      | 144/358 [00:14<00:21,  9.79it/s] 41%|████      | 145/358 [00:14<00:21,  9.81it/s] 41%|████      | 146/358 [00:14<00:21,  9.75it/s] 41%|████      | 147/358 [00:14<00:21,  9.69it/s] 41%|████▏     | 148/358 [00:15<00:21,  9.72it/s] 42%|████▏     | 149/358 [00:15<00:21,  9.70it/s] 42%|████▏     | 150/358 [00:15<00:21,  9.66it/s] 42%|████▏     | 151/358 [00:15<00:22,  9.39it/s] 42%|████▏     | 152/358 [00:15<00:21,  9.44it/s] 43%|████▎     | 153/358 [00:15<00:21,  9.46it/s] 43%|████▎     | 154/358 [00:15<00:21,  9.55it/s] 43%|████▎     | 155/358 [00:15<00:21,  9.56it/s] 44%|████▎     | 156/358 [00:15<00:20,  9.69it/s] 44%|████▍     | 157/358 [00:16<00:20,  9.63it/s] 44%|████▍     | 158/358 [00:16<00:20,  9.71it/s] 44%|████▍     | 159/358 [00:16<00:20,  9.71it/s] 45%|████▍     | 160/358 [00:16<00:20,  9.72it/s] 45%|████▌     | 162/358 [00:16<00:19, 10.01it/s] 46%|████▌     | 164/358 [00:16<00:19, 10.00it/s] 46%|████▌     | 165/358 [00:16<00:19,  9.96it/s] 47%|████▋     | 167/358 [00:17<00:19,  9.91it/s] 47%|████▋     | 169/358 [00:17<00:18,  9.95it/s] 48%|████▊     | 171/358 [00:17<00:18,  9.93it/s] 48%|████▊     | 172/358 [00:17<00:18,  9.88it/s] 48%|████▊     | 173/358 [00:17<00:18,  9.82it/s] 49%|████▉     | 175/358 [00:17<00:18,  9.84it/s] 49%|████▉     | 176/358 [00:17<00:18,  9.85it/s] 49%|████▉     | 177/358 [00:18<00:18,  9.84it/s] 50%|█████     | 179/358 [00:18<00:18,  9.87it/s] 50%|█████     | 180/358 [00:18<00:18,  9.80it/s] 51%|█████     | 182/358 [00:18<00:17,  9.94it/s] 51%|█████     | 183/358 [00:18<00:17,  9.90it/s] 51%|█████▏    | 184/358 [00:18<00:17,  9.79it/s] 52%|█████▏    | 185/358 [00:18<00:17,  9.73it/s] 52%|█████▏    | 187/358 [00:19<00:17,  9.95it/s] 53%|█████▎    | 188/358 [00:19<00:17,  9.90it/s] 53%|█████▎    | 189/358 [00:19<00:17,  9.84it/s] 53%|█████▎    | 191/358 [00:19<00:17,  9.76it/s] 54%|█████▎    | 192/358 [00:19<00:17,  9.70it/s] 54%|█████▍    | 193/358 [00:19<00:17,  9.70it/s] 54%|█████▍    | 194/358 [00:19<00:16,  9.68it/s] 54%|█████▍    | 195/358 [00:19<00:16,  9.74it/s] 55%|█████▌    | 197/358 [00:20<00:16,  9.92it/s] 55%|█████▌    | 198/358 [00:20<00:16,  9.84it/s] 56%|█████▌    | 199/358 [00:20<00:16,  9.88it/s] 56%|█████▌    | 200/358 [00:20<00:16,  9.81it/s] 56%|█████▌    | 201/358 [00:20<00:16,  9.77it/s] 57%|█████▋    | 203/358 [00:20<00:15,  9.86it/s] 57%|█████▋    | 204/358 [00:20<00:15,  9.75it/s] 57%|█████▋    | 205/358 [00:20<00:15,  9.71it/s] 58%|█████▊    | 207/358 [00:21<00:15,  9.88it/s] 58%|█████▊    | 208/358 [00:21<00:15,  9.81it/s] 59%|█████▊    | 210/358 [00:21<00:15,  9.83it/s] 59%|█████▉    | 212/358 [00:21<00:14,  9.82it/s] 60%|█████▉    | 214/358 [00:21<00:14,  9.90it/s] 60%|██████    | 215/358 [00:21<00:14,  9.84it/s] 60%|██████    | 216/358 [00:22<00:14,  9.77it/s] 61%|██████    | 217/358 [00:22<00:14,  9.81it/s] 61%|██████    | 218/358 [00:22<00:14,  9.78it/s] 61%|██████    | 219/358 [00:22<00:14,  9.78it/s] 62%|██████▏   | 221/358 [00:22<00:13,  9.92it/s] 62%|██████▏   | 222/358 [00:22<00:13,  9.81it/s] 62%|██████▏   | 223/358 [00:22<00:13,  9.76it/s] 63%|██████▎   | 224/358 [00:22<00:13,  9.69it/s] 63%|██████▎   | 225/358 [00:22<00:13,  9.77it/s] 63%|██████▎   | 226/358 [00:23<00:13,  9.72it/s] 64%|██████▎   | 228/358 [00:23<00:13,  9.75it/s] 64%|██████▍   | 229/358 [00:23<00:13,  9.73it/s] 64%|██████▍   | 230/358 [00:23<00:13,  9.68it/s] 65%|██████▍   | 232/358 [00:23<00:12,  9.74it/s] 65%|██████▌   | 234/358 [00:23<00:12, 10.03it/s] 66%|██████▌   | 236/358 [00:24<00:12,  9.99it/s] 66%|██████▋   | 238/358 [00:24<00:11, 10.05it/s] 67%|██████▋   | 240/358 [00:24<00:11, 10.01it/s] 68%|██████▊   | 242/358 [00:24<00:11,  9.98it/s] 68%|██████▊   | 243/358 [00:24<00:11,  9.91it/s] 68%|██████▊   | 244/358 [00:24<00:11,  9.85it/s] 69%|██████▊   | 246/358 [00:25<00:11,  9.87it/s] 69%|██████▉   | 247/358 [00:25<00:11,  9.80it/s] 69%|██████▉   | 248/358 [00:25<00:11,  9.76it/s] 70%|██████▉   | 250/358 [00:25<00:10,  9.86it/s] 70%|███████   | 251/358 [00:25<00:10,  9.80it/s] 70%|███████   | 252/358 [00:25<00:10,  9.73it/s] 71%|███████   | 253/358 [00:25<00:10,  9.69it/s] 71%|███████   | 254/358 [00:25<00:10,  9.66it/s] 72%|███████▏  | 256/358 [00:26<00:10,  9.84it/s] 72%|███████▏  | 257/358 [00:26<00:10,  9.85it/s] 72%|███████▏  | 258/358 [00:26<00:10,  9.72it/s] 72%|███████▏  | 259/358 [00:26<00:10,  9.68it/s] 73%|███████▎  | 260/358 [00:26<00:10,  9.72it/s] 73%|███████▎  | 262/358 [00:26<00:09,  9.90it/s] 74%|███████▎  | 264/358 [00:26<00:09,  9.92it/s] 74%|███████▍  | 266/358 [00:27<00:09,  9.91it/s] 75%|███████▍  | 267/358 [00:27<00:09,  9.85it/s] 75%|███████▌  | 269/358 [00:27<00:08,  9.91it/s] 75%|███████▌  | 270/358 [00:27<00:08,  9.84it/s] 76%|███████▌  | 271/358 [00:27<00:08,  9.76it/s] 76%|███████▌  | 272/358 [00:27<00:08,  9.74it/s] 76%|███████▋  | 273/358 [00:27<00:08,  9.64it/s] 77%|███████▋  | 274/358 [00:27<00:08,  9.64it/s] 77%|███████▋  | 275/358 [00:28<00:08,  9.69it/s] 77%|███████▋  | 276/358 [00:28<00:08,  9.69it/s] 77%|███████▋  | 277/358 [00:28<00:08,  9.66it/s] 78%|███████▊  | 278/358 [00:28<00:08,  9.64it/s] 78%|███████▊  | 280/358 [00:28<00:07,  9.83it/s] 78%|███████▊  | 281/358 [00:28<00:07,  9.84it/s] 79%|███████▉  | 282/358 [00:28<00:07,  9.78it/s] 79%|███████▉  | 283/358 [00:28<00:07,  9.72it/s] 79%|███████▉  | 284/358 [00:28<00:07,  9.68it/s] 80%|███████▉  | 285/358 [00:29<00:07,  9.75it/s] 80%|███████▉  | 286/358 [00:29<00:07,  9.71it/s] 80%|████████  | 287/358 [00:29<00:07,  9.68it/s] 80%|████████  | 288/358 [00:29<00:07,  9.64it/s] 81%|████████  | 290/358 [00:29<00:06,  9.85it/s] 81%|████████▏ | 291/358 [00:29<00:06,  9.84it/s] 82%|████████▏ | 293/358 [00:29<00:06,  9.85it/s] 82%|████████▏ | 295/358 [00:30<00:06,  9.92it/s] 83%|████████▎ | 296/358 [00:30<00:06,  9.86it/s] 83%|████████▎ | 297/358 [00:30<00:06,  9.75it/s] 84%|████████▎ | 299/358 [00:30<00:05,  9.91it/s] 84%|████████▍ | 301/358 [00:30<00:05,  9.94it/s] 84%|████████▍ | 302/358 [00:30<00:05,  9.88it/s] 85%|████████▍ | 303/358 [00:30<00:05,  9.89it/s] 85%|████████▌ | 305/358 [00:31<00:05,  9.91it/s] 85%|████████▌ | 306/358 [00:31<00:05,  9.84it/s] 86%|████████▌ | 308/358 [00:31<00:05,  9.94it/s] 86%|████████▋ | 309/358 [00:31<00:04,  9.84it/s] 87%|████████▋ | 310/358 [00:31<00:04,  9.78it/s] 87%|████████▋ | 311/358 [00:31<00:04,  9.70it/s] 87%|████████▋ | 312/358 [00:31<00:04,  9.72it/s] 87%|████████▋ | 313/358 [00:31<00:04,  9.74it/s] 88%|████████▊ | 315/358 [00:32<00:04, 10.00it/s] 88%|████████▊ | 316/358 [00:32<00:04,  9.94it/s] 89%|████████▊ | 317/358 [00:32<00:04,  9.86it/s] 89%|████████▉ | 318/358 [00:32<00:04,  9.81it/s] 89%|████████▉ | 319/358 [00:32<00:03,  9.76it/s] 89%|████████▉ | 320/358 [00:32<00:03,  9.82it/s] 90%|████████▉ | 321/358 [00:32<00:03,  9.74it/s] 90%|████████▉ | 322/358 [00:32<00:03,  9.71it/s] 90%|█████████ | 323/358 [00:32<00:03,  9.66it/s] 91%|█████████ | 324/358 [00:33<00:03,  9.63it/s] 91%|█████████ | 325/358 [00:33<00:03,  9.61it/s] 91%|█████████▏| 327/358 [00:33<00:03,  9.98it/s] 92%|█████████▏| 329/358 [00:33<00:02, 10.07it/s] 92%|█████████▏| 330/358 [00:33<00:02,  9.96it/s] 93%|█████████▎| 332/358 [00:33<00:02, 10.05it/s] 93%|█████████▎| 334/358 [00:34<00:02,  9.96it/s] 94%|█████████▎| 335/358 [00:34<00:02,  9.84it/s] 94%|█████████▍| 337/358 [00:34<00:02,  9.92it/s] 95%|█████████▍| 339/358 [00:34<00:01, 10.11it/s] 95%|█████████▌| 341/358 [00:34<00:01, 10.06it/s] 96%|█████████▌| 343/358 [00:34<00:01,  9.89it/s] 96%|█████████▌| 344/358 [00:35<00:01,  9.83it/s] 96%|█████████▋| 345/358 [00:35<00:01,  9.85it/s] 97%|█████████▋| 347/358 [00:35<00:01, 10.03it/s] 97%|█████████▋| 348/358 [00:35<00:01,  9.93it/s] 97%|█████████▋| 349/358 [00:35<00:00,  9.86it/s] 98%|█████████▊| 350/358 [00:35<00:00,  9.78it/s] 98%|█████████▊| 351/358 [00:35<00:00,  9.74it/s] 99%|█████████▊| 353/358 [00:35<00:00,  9.92it/s] 99%|█████████▉| 354/358 [00:36<00:00,  9.90it/s] 99%|█████████▉| 355/358 [00:36<00:00,  9.82it/s]100%|█████████▉| 357/358 [00:36<00:00,  9.88it/s]100%|██████████| 358/358 [00:36<00:00,  9.83it/s]
[32m2025-02-05 06:27:43.906[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    gen_loss  grad clip ratio  grad norm   ppl
       1.783                1      2.735 5.945[0m
[32m2025-02-05 06:27:43.907[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m169[0m - [1m[Valid][0m
  0%|          | 0/10256 [00:00<?, ?it/s]100%|██████████| 10256/10256 [00:00<00:00, 1121572.24it/s]
[32m2025-02-05 06:27:43.916[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:27,  1.43it/s]  5%|▌         | 2/40 [00:01<00:26,  1.45it/s]  8%|▊         | 3/40 [00:02<00:25,  1.46it/s] 10%|█         | 4/40 [00:02<00:24,  1.46it/s] 12%|█▎        | 5/40 [00:03<00:24,  1.45it/s] 15%|█▌        | 6/40 [00:04<00:23,  1.45it/s] 18%|█▊        | 7/40 [00:04<00:22,  1.45it/s] 20%|██        | 8/40 [00:05<00:22,  1.45it/s] 22%|██▎       | 9/40 [00:06<00:21,  1.45it/s] 25%|██▌       | 10/40 [00:06<00:20,  1.45it/s] 28%|██▊       | 11/40 [00:07<00:19,  1.45it/s] 30%|███       | 12/40 [00:08<00:19,  1.45it/s] 32%|███▎      | 13/40 [00:08<00:18,  1.45it/s] 35%|███▌      | 14/40 [00:09<00:18,  1.44it/s] 38%|███▊      | 15/40 [00:10<00:17,  1.45it/s] 40%|████      | 16/40 [00:11<00:16,  1.45it/s] 42%|████▎     | 17/40 [00:11<00:15,  1.45it/s] 45%|████▌     | 18/40 [00:12<00:15,  1.45it/s] 48%|████▊     | 19/40 [00:13<00:14,  1.45it/s] 50%|█████     | 20/40 [00:13<00:13,  1.45it/s] 52%|█████▎    | 21/40 [00:14<00:13,  1.46it/s] 55%|█████▌    | 22/40 [00:15<00:12,  1.45it/s] 57%|█████▊    | 23/40 [00:15<00:11,  1.46it/s] 60%|██████    | 24/40 [00:16<00:11,  1.45it/s] 62%|██████▎   | 25/40 [00:17<00:10,  1.45it/s] 65%|██████▌   | 26/40 [00:17<00:09,  1.46it/s] 68%|██████▊   | 27/40 [00:18<00:08,  1.46it/s] 70%|███████   | 28/40 [00:19<00:08,  1.46it/s] 72%|███████▎  | 29/40 [00:19<00:07,  1.46it/s] 75%|███████▌  | 30/40 [00:20<00:06,  1.47it/s] 78%|███████▊  | 31/40 [00:21<00:06,  1.46it/s] 80%|████████  | 32/40 [00:22<00:05,  1.46it/s] 82%|████████▎ | 33/40 [00:22<00:04,  1.46it/s] 85%|████████▌ | 34/40 [00:23<00:04,  1.46it/s] 88%|████████▊ | 35/40 [00:24<00:03,  1.46it/s] 90%|█████████ | 36/40 [00:24<00:02,  1.45it/s] 92%|█████████▎| 37/40 [00:25<00:02,  1.45it/s] 95%|█████████▌| 38/40 [00:26<00:01,  1.45it/s] 98%|█████████▊| 39/40 [00:26<00:00,  1.45it/s]100%|██████████| 40/40 [00:27<00:00,  1.60it/s]100%|██████████| 40/40 [00:27<00:00,  1.46it/s]
[32m2025-02-05 06:28:11.241[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    average  bleu@1  bleu@2  bleu@3  bleu@4  dist@1  dist@2  dist@3  dist@4  extreme  \
      .7775   .2984   .1106  .04261  .02153  .04408   .2973   .5631   .7241    .5960   
      f1  gen_loss  greedy  intra_dist@1  intra_dist@2  intra_dist@3  intra_dist@4  \
   .3520     5.264   .6691         .8614         .9587         .9422         .9072   
     ppl  rouge1  rouge2  rougeL  
   193.2   .3879  .09126   .3754[0m
[32m2025-02-05 06:28:11.247[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m163[0m - [1m[Conversation epoch 75][0m
[32m2025-02-05 06:28:11.247[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m164[0m - [1m[Train][0m
  0%|          | 0/92414 [00:00<?, ?it/s]100%|██████████| 92414/92414 [00:00<00:00, 995575.56it/s]
[32m2025-02-05 06:28:11.341[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/358 [00:00<?, ?it/s]  0%|          | 1/358 [00:00<00:36,  9.75it/s]  1%|          | 3/358 [00:00<00:35,  9.94it/s]  1%|          | 4/358 [00:00<00:35,  9.92it/s]  2%|▏         | 6/358 [00:00<00:35,  9.89it/s]  2%|▏         | 7/358 [00:00<00:35,  9.82it/s]  2%|▏         | 8/358 [00:00<00:35,  9.87it/s]  3%|▎         | 9/358 [00:00<00:35,  9.77it/s]  3%|▎         | 10/358 [00:01<00:35,  9.75it/s]  3%|▎         | 11/358 [00:01<00:35,  9.70it/s]  4%|▎         | 13/358 [00:01<00:34,  9.92it/s]  4%|▍         | 14/358 [00:01<00:34,  9.85it/s]  4%|▍         | 15/358 [00:01<00:35,  9.78it/s]  4%|▍         | 16/358 [00:01<00:35,  9.71it/s]  5%|▍         | 17/358 [00:01<00:35,  9.73it/s]  5%|▌         | 19/358 [00:01<00:34,  9.76it/s]  6%|▌         | 20/358 [00:02<00:34,  9.70it/s]  6%|▌         | 21/358 [00:02<00:34,  9.64it/s]  6%|▌         | 22/358 [00:02<00:34,  9.69it/s]  7%|▋         | 24/358 [00:02<00:34,  9.78it/s]  7%|▋         | 25/358 [00:02<00:34,  9.73it/s]  7%|▋         | 26/358 [00:02<00:34,  9.68it/s]  8%|▊         | 27/358 [00:02<00:34,  9.73it/s]  8%|▊         | 28/358 [00:02<00:34,  9.68it/s]  8%|▊         | 29/358 [00:02<00:34,  9.65it/s]  9%|▊         | 31/358 [00:03<00:33,  9.75it/s]  9%|▉         | 32/358 [00:03<00:33,  9.75it/s]  9%|▉         | 34/358 [00:03<00:32,  9.86it/s] 10%|█         | 36/358 [00:03<00:32,  9.85it/s] 10%|█         | 37/358 [00:03<00:32,  9.84it/s] 11%|█         | 38/358 [00:03<00:32,  9.79it/s] 11%|█         | 40/358 [00:04<00:31,  9.95it/s] 11%|█▏        | 41/358 [00:04<00:32,  9.86it/s] 12%|█▏        | 43/358 [00:04<00:31,  9.89it/s] 13%|█▎        | 45/358 [00:04<00:31,  9.99it/s] 13%|█▎        | 47/358 [00:04<00:31,  9.96it/s] 13%|█▎        | 48/358 [00:04<00:31,  9.95it/s] 14%|█▍        | 50/358 [00:05<00:31,  9.92it/s] 14%|█▍        | 51/358 [00:05<00:31,  9.85it/s] 15%|█▍        | 52/358 [00:05<00:31,  9.76it/s] 15%|█▍        | 53/358 [00:05<00:31,  9.71it/s] 15%|█▌        | 54/358 [00:05<00:31,  9.75it/s] 15%|█▌        | 55/358 [00:05<00:31,  9.70it/s] 16%|█▌        | 56/358 [00:05<00:30,  9.74it/s] 16%|█▌        | 57/358 [00:05<00:31,  9.71it/s] 16%|█▌        | 58/358 [00:05<00:30,  9.68it/s] 16%|█▋        | 59/358 [00:06<00:30,  9.65it/s] 17%|█▋        | 61/358 [00:06<00:30,  9.73it/s] 17%|█▋        | 62/358 [00:06<00:30,  9.65it/s] 18%|█▊        | 63/358 [00:06<00:30,  9.72it/s] 18%|█▊        | 64/358 [00:06<00:30,  9.67it/s] 18%|█▊        | 66/358 [00:06<00:29,  9.74it/s] 19%|█▊        | 67/358 [00:06<00:29,  9.72it/s] 19%|█▉        | 69/358 [00:07<00:29,  9.79it/s] 20%|█▉        | 70/358 [00:07<00:29,  9.74it/s] 20%|█▉        | 71/358 [00:07<00:29,  9.78it/s] 20%|██        | 72/358 [00:07<00:29,  9.73it/s] 20%|██        | 73/358 [00:07<00:29,  9.70it/s] 21%|██        | 74/358 [00:07<00:29,  9.66it/s] 21%|██        | 75/358 [00:07<00:29,  9.63it/s] 22%|██▏       | 77/358 [00:07<00:28,  9.71it/s] 22%|██▏       | 79/358 [00:08<00:28,  9.71it/s] 23%|██▎       | 81/358 [00:08<00:28,  9.76it/s] 23%|██▎       | 83/358 [00:08<00:28,  9.79it/s] 23%|██▎       | 84/358 [00:08<00:28,  9.74it/s] 24%|██▎       | 85/358 [00:08<00:28,  9.70it/s] 24%|██▍       | 86/358 [00:08<00:28,  9.68it/s] 24%|██▍       | 87/358 [00:08<00:28,  9.66it/s] 25%|██▍       | 88/358 [00:09<00:27,  9.68it/s] 25%|██▌       | 90/358 [00:09<00:27,  9.91it/s] 26%|██▌       | 92/358 [00:09<00:26, 10.00it/s] 26%|██▌       | 93/358 [00:09<00:26,  9.97it/s] 26%|██▋       | 94/358 [00:09<00:26,  9.89it/s] 27%|██▋       | 96/358 [00:09<00:25, 10.16it/s] 27%|██▋       | 98/358 [00:09<00:25, 10.06it/s] 28%|██▊       | 100/358 [00:10<00:25, 10.01it/s] 28%|██▊       | 101/358 [00:10<00:25,  9.92it/s] 29%|██▉       | 103/358 [00:10<00:25,  9.91it/s] 29%|██▉       | 104/358 [00:10<00:25,  9.86it/s] 29%|██▉       | 105/358 [00:10<00:25,  9.79it/s] 30%|██▉       | 106/358 [00:10<00:25,  9.77it/s] 30%|███       | 108/358 [00:11<00:25,  9.80it/s] 30%|███       | 109/358 [00:11<00:25,  9.72it/s] 31%|███       | 110/358 [00:11<00:25,  9.70it/s] 31%|███       | 111/358 [00:11<00:25,  9.66it/s] 32%|███▏      | 113/358 [00:11<00:24,  9.92it/s] 32%|███▏      | 114/358 [00:11<00:24,  9.88it/s] 32%|███▏      | 115/358 [00:11<00:24,  9.79it/s] 32%|███▏      | 116/358 [00:11<00:24,  9.70it/s] 33%|███▎      | 117/358 [00:11<00:24,  9.68it/s] 33%|███▎      | 119/358 [00:12<00:24,  9.79it/s] 34%|███▍      | 121/358 [00:12<00:23,  9.99it/s] 34%|███▍      | 123/358 [00:12<00:23, 10.09it/s] 35%|███▍      | 125/358 [00:12<00:23, 10.06it/s] 35%|███▌      | 127/358 [00:12<00:23,  9.99it/s] 36%|███▌      | 128/358 [00:13<00:23,  9.95it/s] 36%|███▋      | 130/358 [00:13<00:22, 10.00it/s] 37%|███▋      | 131/358 [00:13<00:22,  9.91it/s] 37%|███▋      | 132/358 [00:13<00:22,  9.93it/s] 37%|███▋      | 134/358 [00:13<00:22,  9.95it/s] 38%|███▊      | 135/358 [00:13<00:22,  9.89it/s] 38%|███▊      | 137/358 [00:13<00:22,  9.97it/s] 39%|███▊      | 138/358 [00:14<00:22,  9.96it/s] 39%|███▉      | 139/358 [00:14<00:22,  9.87it/s] 39%|███▉      | 141/358 [00:14<00:21,  9.99it/s] 40%|███▉      | 142/358 [00:14<00:21,  9.91it/s] 40%|███▉      | 143/358 [00:14<00:21,  9.88it/s] 40%|████      | 144/358 [00:14<00:21,  9.80it/s] 41%|████      | 145/358 [00:14<00:21,  9.81it/s] 41%|████      | 146/358 [00:14<00:21,  9.75it/s] 41%|████      | 147/358 [00:14<00:21,  9.69it/s] 41%|████▏     | 148/358 [00:15<00:21,  9.72it/s] 42%|████▏     | 149/358 [00:15<00:21,  9.70it/s] 42%|████▏     | 150/358 [00:15<00:21,  9.66it/s] 42%|████▏     | 151/358 [00:15<00:22,  9.39it/s] 42%|████▏     | 152/358 [00:15<00:21,  9.44it/s] 43%|████▎     | 153/358 [00:15<00:21,  9.46it/s] 43%|████▎     | 154/358 [00:15<00:21,  9.55it/s] 43%|████▎     | 155/358 [00:15<00:21,  9.56it/s] 44%|████▎     | 156/358 [00:15<00:20,  9.68it/s] 44%|████▍     | 157/358 [00:16<00:20,  9.62it/s] 44%|████▍     | 158/358 [00:16<00:20,  9.71it/s] 44%|████▍     | 159/358 [00:16<00:20,  9.71it/s] 45%|████▍     | 160/358 [00:16<00:20,  9.72it/s] 45%|████▌     | 162/358 [00:16<00:19, 10.01it/s] 46%|████▌     | 164/358 [00:16<00:19, 10.01it/s] 46%|████▌     | 165/358 [00:16<00:19,  9.97it/s] 47%|████▋     | 167/358 [00:17<00:19,  9.91it/s] 47%|████▋     | 169/358 [00:17<00:18,  9.95it/s] 48%|████▊     | 171/358 [00:17<00:18,  9.93it/s] 48%|████▊     | 172/358 [00:17<00:18,  9.88it/s] 48%|████▊     | 173/358 [00:17<00:18,  9.82it/s] 49%|████▉     | 175/358 [00:17<00:18,  9.84it/s] 49%|████▉     | 176/358 [00:17<00:18,  9.86it/s] 49%|████▉     | 177/358 [00:18<00:18,  9.84it/s] 50%|█████     | 179/358 [00:18<00:18,  9.87it/s] 50%|█████     | 180/358 [00:18<00:18,  9.79it/s] 51%|█████     | 182/358 [00:18<00:17,  9.95it/s] 51%|█████     | 183/358 [00:18<00:17,  9.90it/s] 51%|█████▏    | 184/358 [00:18<00:17,  9.79it/s] 52%|█████▏    | 185/358 [00:18<00:17,  9.73it/s] 52%|█████▏    | 187/358 [00:19<00:17,  9.95it/s] 53%|█████▎    | 188/358 [00:19<00:17,  9.90it/s] 53%|█████▎    | 189/358 [00:19<00:17,  9.84it/s] 53%|█████▎    | 190/358 [00:19<00:17,  9.88it/s] 53%|█████▎    | 191/358 [00:19<00:17,  9.71it/s] 54%|█████▎    | 192/358 [00:19<00:17,  9.66it/s] 54%|█████▍    | 193/358 [00:19<00:17,  9.67it/s] 54%|█████▍    | 194/358 [00:19<00:16,  9.66it/s] 54%|█████▍    | 195/358 [00:19<00:16,  9.74it/s] 55%|█████▌    | 197/358 [00:20<00:16,  9.93it/s] 55%|█████▌    | 198/358 [00:20<00:16,  9.85it/s] 56%|█████▌    | 199/358 [00:20<00:16,  9.88it/s] 56%|█████▌    | 200/358 [00:20<00:16,  9.81it/s] 56%|█████▌    | 201/358 [00:20<00:16,  9.77it/s] 57%|█████▋    | 203/358 [00:20<00:15,  9.86it/s] 57%|█████▋    | 204/358 [00:20<00:15,  9.76it/s] 57%|█████▋    | 205/358 [00:20<00:15,  9.71it/s] 58%|█████▊    | 207/358 [00:21<00:15,  9.88it/s] 58%|█████▊    | 208/358 [00:21<00:15,  9.81it/s] 59%|█████▊    | 210/358 [00:21<00:15,  9.83it/s] 59%|█████▉    | 212/358 [00:21<00:14,  9.82it/s] 60%|█████▉    | 214/358 [00:21<00:14,  9.90it/s] 60%|██████    | 215/358 [00:21<00:14,  9.84it/s] 60%|██████    | 216/358 [00:22<00:14,  9.77it/s] 61%|██████    | 217/358 [00:22<00:14,  9.81it/s] 61%|██████    | 218/358 [00:22<00:14,  9.78it/s] 61%|██████    | 219/358 [00:22<00:14,  9.78it/s] 62%|██████▏   | 221/358 [00:22<00:13,  9.91it/s] 62%|██████▏   | 222/358 [00:22<00:13,  9.81it/s] 62%|██████▏   | 223/358 [00:22<00:13,  9.75it/s] 63%|██████▎   | 224/358 [00:22<00:13,  9.70it/s] 63%|██████▎   | 226/358 [00:23<00:13,  9.74it/s] 64%|██████▎   | 228/358 [00:23<00:13,  9.77it/s] 64%|██████▍   | 229/358 [00:23<00:13,  9.74it/s] 64%|██████▍   | 230/358 [00:23<00:13,  9.69it/s] 65%|██████▍   | 232/358 [00:23<00:12,  9.74it/s] 65%|██████▌   | 234/358 [00:23<00:12, 10.03it/s] 66%|██████▌   | 236/358 [00:24<00:12,  9.99it/s] 66%|██████▋   | 238/358 [00:24<00:11, 10.04it/s] 67%|██████▋   | 240/358 [00:24<00:11, 10.00it/s] 68%|██████▊   | 242/358 [00:24<00:11,  9.98it/s] 68%|██████▊   | 243/358 [00:24<00:11,  9.92it/s] 68%|██████▊   | 244/358 [00:24<00:11,  9.86it/s] 69%|██████▊   | 246/358 [00:25<00:11,  9.88it/s] 69%|██████▉   | 247/358 [00:25<00:11,  9.80it/s] 69%|██████▉   | 248/358 [00:25<00:11,  9.76it/s] 70%|██████▉   | 250/358 [00:25<00:10,  9.86it/s] 70%|███████   | 251/358 [00:25<00:10,  9.80it/s] 70%|███████   | 252/358 [00:25<00:10,  9.74it/s] 71%|███████   | 253/358 [00:25<00:10,  9.70it/s] 71%|███████   | 254/358 [00:25<00:10,  9.67it/s] 72%|███████▏  | 256/358 [00:26<00:10,  9.85it/s] 72%|███████▏  | 257/358 [00:26<00:10,  9.85it/s] 72%|███████▏  | 258/358 [00:26<00:10,  9.72it/s] 72%|███████▏  | 259/358 [00:26<00:10,  9.68it/s] 73%|███████▎  | 260/358 [00:26<00:10,  9.72it/s] 73%|███████▎  | 262/358 [00:26<00:09,  9.90it/s] 74%|███████▎  | 264/358 [00:26<00:09,  9.92it/s] 74%|███████▍  | 266/358 [00:27<00:09,  9.91it/s] 75%|███████▍  | 267/358 [00:27<00:09,  9.85it/s] 75%|███████▌  | 269/358 [00:27<00:08,  9.91it/s] 75%|███████▌  | 270/358 [00:27<00:08,  9.84it/s] 76%|███████▌  | 271/358 [00:27<00:08,  9.76it/s] 76%|███████▌  | 272/358 [00:27<00:08,  9.74it/s] 76%|███████▋  | 273/358 [00:27<00:08,  9.64it/s] 77%|███████▋  | 274/358 [00:27<00:08,  9.64it/s] 77%|███████▋  | 275/358 [00:28<00:08,  9.69it/s] 77%|███████▋  | 276/358 [00:28<00:08,  9.69it/s] 77%|███████▋  | 277/358 [00:28<00:08,  9.66it/s] 78%|███████▊  | 278/358 [00:28<00:08,  9.64it/s] 78%|███████▊  | 280/358 [00:28<00:07,  9.83it/s] 78%|███████▊  | 281/358 [00:28<00:07,  9.84it/s] 79%|███████▉  | 282/358 [00:28<00:07,  9.78it/s] 79%|███████▉  | 283/358 [00:28<00:07,  9.71it/s] 79%|███████▉  | 284/358 [00:28<00:07,  9.68it/s] 80%|███████▉  | 285/358 [00:29<00:07,  9.75it/s] 80%|███████▉  | 286/358 [00:29<00:07,  9.70it/s] 80%|████████  | 287/358 [00:29<00:07,  9.68it/s] 80%|████████  | 288/358 [00:29<00:07,  9.64it/s] 81%|████████  | 290/358 [00:29<00:06,  9.85it/s] 81%|████████▏ | 291/358 [00:29<00:06,  9.83it/s] 82%|████████▏ | 293/358 [00:29<00:06,  9.84it/s] 82%|████████▏ | 295/358 [00:30<00:06,  9.92it/s] 83%|████████▎ | 296/358 [00:30<00:06,  9.85it/s] 83%|████████▎ | 297/358 [00:30<00:06,  9.74it/s] 84%|████████▎ | 299/358 [00:30<00:05,  9.90it/s] 84%|████████▍ | 301/358 [00:30<00:05,  9.94it/s] 84%|████████▍ | 302/358 [00:30<00:05,  9.87it/s] 85%|████████▍ | 303/358 [00:30<00:05,  9.88it/s] 85%|████████▌ | 305/358 [00:31<00:05,  9.90it/s] 85%|████████▌ | 306/358 [00:31<00:05,  9.83it/s] 86%|████████▌ | 308/358 [00:31<00:05,  9.93it/s] 86%|████████▋ | 309/358 [00:31<00:04,  9.82it/s] 87%|████████▋ | 310/358 [00:31<00:04,  9.77it/s] 87%|████████▋ | 311/358 [00:31<00:04,  9.69it/s] 87%|████████▋ | 312/358 [00:31<00:04,  9.71it/s] 87%|████████▋ | 313/358 [00:31<00:04,  9.73it/s] 88%|████████▊ | 315/358 [00:32<00:04,  9.99it/s] 88%|████████▊ | 316/358 [00:32<00:04,  9.94it/s] 89%|████████▊ | 317/358 [00:32<00:04,  9.86it/s] 89%|████████▉ | 318/358 [00:32<00:04,  9.81it/s] 89%|████████▉ | 319/358 [00:32<00:03,  9.76it/s] 89%|████████▉ | 320/358 [00:32<00:03,  9.82it/s] 90%|████████▉ | 321/358 [00:32<00:03,  9.75it/s] 90%|████████▉ | 322/358 [00:32<00:03,  9.71it/s] 90%|█████████ | 323/358 [00:32<00:03,  9.67it/s] 91%|█████████ | 324/358 [00:33<00:03,  9.64it/s] 91%|█████████ | 325/358 [00:33<00:03,  9.62it/s] 91%|█████████▏| 327/358 [00:33<00:03,  9.98it/s] 92%|█████████▏| 329/358 [00:33<00:02, 10.08it/s] 92%|█████████▏| 330/358 [00:33<00:02,  9.96it/s] 93%|█████████▎| 332/358 [00:33<00:02, 10.06it/s] 93%|█████████▎| 334/358 [00:34<00:02,  9.97it/s] 94%|█████████▎| 335/358 [00:34<00:02,  9.85it/s] 94%|█████████▍| 337/358 [00:34<00:02,  9.91it/s] 95%|█████████▍| 339/358 [00:34<00:01, 10.11it/s] 95%|█████████▌| 341/358 [00:34<00:01, 10.06it/s] 96%|█████████▌| 343/358 [00:34<00:01,  9.90it/s] 96%|█████████▌| 344/358 [00:35<00:01,  9.84it/s] 96%|█████████▋| 345/358 [00:35<00:01,  9.86it/s] 97%|█████████▋| 347/358 [00:35<00:01, 10.04it/s] 97%|█████████▋| 348/358 [00:35<00:01,  9.94it/s] 97%|█████████▋| 349/358 [00:35<00:00,  9.86it/s] 98%|█████████▊| 350/358 [00:35<00:00,  9.79it/s] 98%|█████████▊| 351/358 [00:35<00:00,  9.75it/s] 99%|█████████▊| 353/358 [00:35<00:00,  9.93it/s] 99%|█████████▉| 354/358 [00:36<00:00,  9.91it/s] 99%|█████████▉| 355/358 [00:36<00:00,  9.82it/s]100%|█████████▉| 357/358 [00:36<00:00,  9.88it/s]100%|██████████| 358/358 [00:36<00:00,  9.83it/s]
[32m2025-02-05 06:28:47.759[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    gen_loss  grad clip ratio  grad norm   ppl
       1.773                1      2.641 5.891[0m
[32m2025-02-05 06:28:47.759[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m169[0m - [1m[Valid][0m
  0%|          | 0/10256 [00:00<?, ?it/s]100%|██████████| 10256/10256 [00:00<00:00, 944572.62it/s]
[32m2025-02-05 06:28:47.770[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:27,  1.41it/s]  5%|▌         | 2/40 [00:01<00:26,  1.43it/s]  8%|▊         | 3/40 [00:02<00:25,  1.42it/s] 10%|█         | 4/40 [00:02<00:25,  1.43it/s] 12%|█▎        | 5/40 [00:03<00:24,  1.42it/s] 15%|█▌        | 6/40 [00:04<00:23,  1.43it/s] 18%|█▊        | 7/40 [00:04<00:23,  1.42it/s] 20%|██        | 8/40 [00:05<00:22,  1.43it/s] 22%|██▎       | 9/40 [00:06<00:21,  1.43it/s] 25%|██▌       | 10/40 [00:06<00:20,  1.43it/s] 28%|██▊       | 11/40 [00:07<00:20,  1.43it/s] 30%|███       | 12/40 [00:08<00:19,  1.44it/s] 32%|███▎      | 13/40 [00:09<00:18,  1.44it/s] 35%|███▌      | 14/40 [00:09<00:18,  1.43it/s] 38%|███▊      | 15/40 [00:10<00:17,  1.43it/s] 40%|████      | 16/40 [00:11<00:16,  1.43it/s] 42%|████▎     | 17/40 [00:11<00:16,  1.44it/s] 45%|████▌     | 18/40 [00:12<00:15,  1.43it/s] 48%|████▊     | 19/40 [00:13<00:14,  1.43it/s] 50%|█████     | 20/40 [00:13<00:13,  1.44it/s] 52%|█████▎    | 21/40 [00:14<00:13,  1.44it/s] 55%|█████▌    | 22/40 [00:15<00:12,  1.43it/s] 57%|█████▊    | 23/40 [00:16<00:11,  1.44it/s] 60%|██████    | 24/40 [00:16<00:11,  1.43it/s] 62%|██████▎   | 25/40 [00:17<00:10,  1.43it/s] 65%|██████▌   | 26/40 [00:18<00:09,  1.44it/s] 68%|██████▊   | 27/40 [00:18<00:09,  1.44it/s] 70%|███████   | 28/40 [00:19<00:08,  1.44it/s] 72%|███████▎  | 29/40 [00:20<00:07,  1.44it/s] 75%|███████▌  | 30/40 [00:20<00:06,  1.44it/s] 78%|███████▊  | 31/40 [00:21<00:06,  1.44it/s] 80%|████████  | 32/40 [00:22<00:05,  1.44it/s] 82%|████████▎ | 33/40 [00:23<00:04,  1.43it/s] 85%|████████▌ | 34/40 [00:23<00:04,  1.44it/s] 88%|████████▊ | 35/40 [00:24<00:03,  1.44it/s] 90%|█████████ | 36/40 [00:25<00:02,  1.43it/s] 92%|█████████▎| 37/40 [00:25<00:02,  1.43it/s] 95%|█████████▌| 38/40 [00:26<00:01,  1.43it/s] 98%|█████████▊| 39/40 [00:27<00:00,  1.43it/s]100%|██████████| 40/40 [00:27<00:00,  1.58it/s]100%|██████████| 40/40 [00:27<00:00,  1.44it/s]
[32m2025-02-05 06:29:15.473[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    average  bleu@1  bleu@2  bleu@3  bleu@4  dist@1  dist@2  dist@3  dist@4  extreme  \
      .7774   .2936   .1117  .04497  .02324  .04171   .3023   .5797   .7442    .5981   
      f1  gen_loss  greedy  intra_dist@1  intra_dist@2  intra_dist@3  intra_dist@4  \
   .3453     5.279   .6629         .8477         .9533         .9493         .9250   
     ppl  rouge1  rouge2  rougeL  
   196.2   .3825  .09128   .3697[0m
[32m2025-02-05 06:29:15.507[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m163[0m - [1m[Conversation epoch 76][0m
[32m2025-02-05 06:29:15.507[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m164[0m - [1m[Train][0m
  0%|          | 0/92414 [00:00<?, ?it/s]100%|██████████| 92414/92414 [00:00<00:00, 1080675.62it/s]
[32m2025-02-05 06:29:15.593[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/358 [00:00<?, ?it/s]  0%|          | 1/358 [00:00<00:36,  9.76it/s]  1%|          | 3/358 [00:00<00:35,  9.94it/s]  1%|          | 4/358 [00:00<00:35,  9.92it/s]  2%|▏         | 6/358 [00:00<00:35,  9.88it/s]  2%|▏         | 7/358 [00:00<00:35,  9.82it/s]  2%|▏         | 8/358 [00:00<00:35,  9.86it/s]  3%|▎         | 9/358 [00:00<00:35,  9.77it/s]  3%|▎         | 10/358 [00:01<00:35,  9.76it/s]  3%|▎         | 11/358 [00:01<00:35,  9.71it/s]  4%|▎         | 13/358 [00:01<00:34,  9.93it/s]  4%|▍         | 14/358 [00:01<00:34,  9.86it/s]  4%|▍         | 15/358 [00:01<00:35,  9.78it/s]  4%|▍         | 16/358 [00:01<00:35,  9.72it/s]  5%|▍         | 17/358 [00:01<00:35,  9.74it/s]  5%|▌         | 18/358 [00:01<00:34,  9.81it/s]  5%|▌         | 19/358 [00:01<00:34,  9.74it/s]  6%|▌         | 20/358 [00:02<00:34,  9.68it/s]  6%|▌         | 21/358 [00:02<00:35,  9.61it/s]  6%|▌         | 22/358 [00:02<00:34,  9.68it/s]  7%|▋         | 24/358 [00:02<00:34,  9.78it/s]  7%|▋         | 25/358 [00:02<00:34,  9.73it/s]  7%|▋         | 26/358 [00:02<00:34,  9.68it/s]  8%|▊         | 27/358 [00:02<00:33,  9.74it/s]  8%|▊         | 28/358 [00:02<00:34,  9.69it/s]  8%|▊         | 29/358 [00:02<00:34,  9.66it/s]  9%|▊         | 31/358 [00:03<00:33,  9.76it/s]  9%|▉         | 32/358 [00:03<00:33,  9.76it/s]  9%|▉         | 34/358 [00:03<00:32,  9.86it/s] 10%|█         | 36/358 [00:03<00:32,  9.86it/s] 10%|█         | 37/358 [00:03<00:32,  9.84it/s] 11%|█         | 38/358 [00:03<00:32,  9.79it/s] 11%|█         | 40/358 [00:04<00:31,  9.95it/s] 11%|█▏        | 41/358 [00:04<00:32,  9.86it/s] 12%|█▏        | 43/358 [00:04<00:31,  9.89it/s] 13%|█▎        | 45/358 [00:04<00:31,  9.99it/s] 13%|█▎        | 47/358 [00:04<00:31,  9.96it/s] 13%|█▎        | 48/358 [00:04<00:31,  9.95it/s] 14%|█▍        | 50/358 [00:05<00:31,  9.92it/s] 14%|█▍        | 51/358 [00:05<00:31,  9.85it/s] 15%|█▍        | 52/358 [00:05<00:31,  9.76it/s] 15%|█▍        | 53/358 [00:05<00:31,  9.71it/s] 15%|█▌        | 54/358 [00:05<00:31,  9.76it/s] 15%|█▌        | 55/358 [00:05<00:31,  9.70it/s] 16%|█▌        | 56/358 [00:05<00:30,  9.75it/s] 16%|█▌        | 57/358 [00:05<00:31,  9.71it/s] 16%|█▌        | 58/358 [00:05<00:30,  9.68it/s] 16%|█▋        | 59/358 [00:06<00:30,  9.65it/s] 17%|█▋        | 61/358 [00:06<00:30,  9.74it/s] 17%|█▋        | 62/358 [00:06<00:30,  9.66it/s] 18%|█▊        | 63/358 [00:06<00:30,  9.72it/s] 18%|█▊        | 64/358 [00:06<00:30,  9.68it/s] 18%|█▊        | 66/358 [00:06<00:29,  9.74it/s] 19%|█▊        | 67/358 [00:06<00:29,  9.73it/s] 19%|█▉        | 69/358 [00:07<00:29,  9.79it/s] 20%|█▉        | 70/358 [00:07<00:29,  9.74it/s] 20%|█▉        | 71/358 [00:07<00:29,  9.78it/s] 20%|██        | 72/358 [00:07<00:29,  9.73it/s] 20%|██        | 73/358 [00:07<00:29,  9.70it/s] 21%|██        | 74/358 [00:07<00:29,  9.66it/s] 21%|██        | 75/358 [00:07<00:29,  9.63it/s] 22%|██▏       | 77/358 [00:07<00:28,  9.71it/s] 22%|██▏       | 79/358 [00:08<00:28,  9.72it/s] 23%|██▎       | 81/358 [00:08<00:28,  9.77it/s] 23%|██▎       | 83/358 [00:08<00:28,  9.79it/s] 23%|██▎       | 84/358 [00:08<00:28,  9.74it/s] 24%|██▎       | 85/358 [00:08<00:28,  9.70it/s] 24%|██▍       | 86/358 [00:08<00:28,  9.68it/s] 24%|██▍       | 87/358 [00:08<00:28,  9.66it/s] 25%|██▍       | 88/358 [00:09<00:27,  9.68it/s] 25%|██▌       | 90/358 [00:09<00:27,  9.92it/s] 26%|██▌       | 92/358 [00:09<00:26, 10.01it/s] 26%|██▌       | 93/358 [00:09<00:26,  9.98it/s] 26%|██▋       | 94/358 [00:09<00:26,  9.89it/s] 27%|██▋       | 96/358 [00:09<00:25, 10.17it/s] 27%|██▋       | 98/358 [00:09<00:25, 10.06it/s] 28%|██▊       | 100/358 [00:10<00:25, 10.01it/s] 28%|██▊       | 101/358 [00:10<00:25,  9.91it/s] 29%|██▉       | 103/358 [00:10<00:25,  9.91it/s] 29%|██▉       | 104/358 [00:10<00:25,  9.86it/s] 29%|██▉       | 105/358 [00:10<00:25,  9.79it/s] 30%|██▉       | 106/358 [00:10<00:25,  9.77it/s] 30%|███       | 108/358 [00:11<00:25,  9.81it/s] 30%|███       | 109/358 [00:11<00:25,  9.72it/s] 31%|███       | 110/358 [00:11<00:25,  9.70it/s] 31%|███       | 111/358 [00:11<00:25,  9.66it/s] 32%|███▏      | 113/358 [00:11<00:24,  9.93it/s] 32%|███▏      | 114/358 [00:11<00:24,  9.89it/s] 32%|███▏      | 115/358 [00:11<00:24,  9.79it/s] 32%|███▏      | 116/358 [00:11<00:24,  9.71it/s] 33%|███▎      | 117/358 [00:11<00:24,  9.68it/s] 33%|███▎      | 119/358 [00:12<00:24,  9.80it/s] 34%|███▍      | 121/358 [00:12<00:23, 10.00it/s] 34%|███▍      | 123/358 [00:12<00:23, 10.10it/s] 35%|███▍      | 125/358 [00:12<00:23, 10.08it/s] 35%|███▌      | 127/358 [00:12<00:23, 10.00it/s] 36%|███▌      | 128/358 [00:13<00:23,  9.96it/s] 36%|███▋      | 130/358 [00:13<00:22, 10.01it/s] 37%|███▋      | 131/358 [00:13<00:22,  9.92it/s] 37%|███▋      | 132/358 [00:13<00:22,  9.93it/s] 37%|███▋      | 134/358 [00:13<00:22,  9.95it/s] 38%|███▊      | 135/358 [00:13<00:22,  9.89it/s] 38%|███▊      | 137/358 [00:13<00:22,  9.98it/s] 39%|███▊      | 138/358 [00:14<00:22,  9.95it/s] 39%|███▉      | 139/358 [00:14<00:22,  9.87it/s] 39%|███▉      | 141/358 [00:14<00:21,  9.99it/s] 40%|███▉      | 142/358 [00:14<00:21,  9.92it/s] 40%|███▉      | 143/358 [00:14<00:21,  9.88it/s] 40%|████      | 144/358 [00:14<00:21,  9.79it/s] 41%|████      | 145/358 [00:14<00:21,  9.82it/s] 41%|████      | 146/358 [00:14<00:21,  9.75it/s] 41%|████      | 147/358 [00:14<00:21,  9.69it/s] 41%|████▏     | 148/358 [00:15<00:21,  9.72it/s] 42%|████▏     | 149/358 [00:15<00:21,  9.71it/s] 42%|████▏     | 150/358 [00:15<00:21,  9.66it/s] 42%|████▏     | 151/358 [00:15<00:22,  9.39it/s] 42%|████▏     | 152/358 [00:15<00:21,  9.44it/s] 43%|████▎     | 153/358 [00:15<00:21,  9.46it/s] 43%|████▎     | 154/358 [00:15<00:21,  9.55it/s] 43%|████▎     | 155/358 [00:15<00:21,  9.57it/s] 44%|████▎     | 156/358 [00:15<00:20,  9.69it/s] 44%|████▍     | 157/358 [00:16<00:20,  9.63it/s] 44%|████▍     | 158/358 [00:16<00:20,  9.72it/s] 44%|████▍     | 159/358 [00:16<00:20,  9.71it/s] 45%|████▍     | 160/358 [00:16<00:20,  9.72it/s] 45%|████▌     | 162/358 [00:16<00:19, 10.01it/s] 46%|████▌     | 164/358 [00:16<00:19, 10.02it/s] 46%|████▌     | 165/358 [00:16<00:19,  9.98it/s] 47%|████▋     | 167/358 [00:17<00:19,  9.92it/s] 47%|████▋     | 169/358 [00:17<00:18,  9.95it/s] 48%|████▊     | 171/358 [00:17<00:18,  9.94it/s] 48%|████▊     | 172/358 [00:17<00:18,  9.89it/s] 48%|████▊     | 173/358 [00:17<00:18,  9.82it/s] 49%|████▉     | 175/358 [00:17<00:18,  9.85it/s] 49%|████▉     | 176/358 [00:17<00:18,  9.86it/s] 49%|████▉     | 177/358 [00:18<00:18,  9.85it/s] 50%|█████     | 179/358 [00:18<00:18,  9.87it/s] 50%|█████     | 180/358 [00:18<00:18,  9.80it/s] 51%|█████     | 182/358 [00:18<00:17,  9.95it/s] 51%|█████     | 183/358 [00:18<00:17,  9.90it/s] 51%|█████▏    | 184/358 [00:18<00:17,  9.80it/s] 52%|█████▏    | 185/358 [00:18<00:17,  9.74it/s] 52%|█████▏    | 187/358 [00:19<00:17,  9.96it/s] 53%|█████▎    | 188/358 [00:19<00:17,  9.90it/s] 53%|█████▎    | 189/358 [00:19<00:17,  9.84it/s] 53%|█████▎    | 191/358 [00:19<00:17,  9.76it/s] 54%|█████▎    | 192/358 [00:19<00:17,  9.71it/s] 54%|█████▍    | 193/358 [00:19<00:16,  9.71it/s] 54%|█████▍    | 194/358 [00:19<00:16,  9.68it/s] 54%|█████▍    | 195/358 [00:19<00:16,  9.75it/s] 55%|█████▌    | 197/358 [00:20<00:16,  9.93it/s] 55%|█████▌    | 198/358 [00:20<00:16,  9.85it/s] 56%|█████▌    | 199/358 [00:20<00:16,  9.88it/s] 56%|█████▌    | 200/358 [00:20<00:16,  9.82it/s] 56%|█████▌    | 201/358 [00:20<00:16,  9.78it/s] 57%|█████▋    | 203/358 [00:20<00:15,  9.87it/s] 57%|█████▋    | 204/358 [00:20<00:15,  9.76it/s] 57%|█████▋    | 205/358 [00:20<00:15,  9.72it/s] 58%|█████▊    | 207/358 [00:21<00:15,  9.89it/s] 58%|█████▊    | 208/358 [00:21<00:15,  9.82it/s] 59%|█████▊    | 210/358 [00:21<00:15,  9.83it/s] 59%|█████▉    | 212/358 [00:21<00:14,  9.83it/s] 60%|█████▉    | 214/358 [00:21<00:14,  9.91it/s] 60%|██████    | 215/358 [00:21<00:14,  9.84it/s] 60%|██████    | 216/358 [00:21<00:14,  9.78it/s] 61%|██████    | 217/358 [00:22<00:14,  9.81it/s] 61%|██████    | 218/358 [00:22<00:14,  9.78it/s] 61%|██████    | 219/358 [00:22<00:14,  9.78it/s] 62%|██████▏   | 221/358 [00:22<00:13,  9.91it/s] 62%|██████▏   | 222/358 [00:22<00:13,  9.81it/s] 62%|██████▏   | 223/358 [00:22<00:13,  9.76it/s] 63%|██████▎   | 224/358 [00:22<00:13,  9.70it/s] 63%|██████▎   | 226/358 [00:23<00:13,  9.75it/s] 64%|██████▎   | 228/358 [00:23<00:13,  9.78it/s] 64%|██████▍   | 229/358 [00:23<00:13,  9.75it/s] 64%|██████▍   | 230/358 [00:23<00:13,  9.70it/s] 65%|██████▍   | 232/358 [00:23<00:12,  9.75it/s] 65%|██████▌   | 234/358 [00:23<00:12, 10.03it/s] 66%|██████▌   | 236/358 [00:24<00:12,  9.99it/s] 66%|██████▋   | 238/358 [00:24<00:11, 10.05it/s] 67%|██████▋   | 240/358 [00:24<00:11, 10.00it/s] 68%|██████▊   | 242/358 [00:24<00:11,  9.98it/s] 68%|██████▊   | 243/358 [00:24<00:11,  9.92it/s] 68%|██████▊   | 244/358 [00:24<00:11,  9.85it/s] 69%|██████▊   | 246/358 [00:25<00:11,  9.87it/s] 69%|██████▉   | 247/358 [00:25<00:11,  9.80it/s] 69%|██████▉   | 248/358 [00:25<00:11,  9.76it/s] 70%|██████▉   | 250/358 [00:25<00:10,  9.86it/s] 70%|███████   | 251/358 [00:25<00:10,  9.80it/s] 70%|███████   | 252/358 [00:25<00:10,  9.73it/s] 71%|███████   | 253/358 [00:25<00:10,  9.69it/s] 71%|███████   | 254/358 [00:25<00:10,  9.66it/s] 72%|███████▏  | 256/358 [00:26<00:10,  9.84it/s] 72%|███████▏  | 257/358 [00:26<00:10,  9.85it/s] 72%|███████▏  | 258/358 [00:26<00:10,  9.72it/s] 72%|███████▏  | 259/358 [00:26<00:10,  9.68it/s] 73%|███████▎  | 260/358 [00:26<00:10,  9.72it/s] 73%|███████▎  | 262/358 [00:26<00:09,  9.90it/s] 74%|███████▎  | 264/358 [00:26<00:09,  9.92it/s] 74%|███████▍  | 266/358 [00:27<00:09,  9.90it/s] 75%|███████▍  | 267/358 [00:27<00:09,  9.84it/s] 75%|███████▌  | 269/358 [00:27<00:08,  9.90it/s] 75%|███████▌  | 270/358 [00:27<00:08,  9.83it/s] 76%|███████▌  | 271/358 [00:27<00:08,  9.76it/s] 76%|███████▌  | 272/358 [00:27<00:08,  9.74it/s] 76%|███████▋  | 273/358 [00:27<00:08,  9.64it/s] 77%|███████▋  | 274/358 [00:27<00:08,  9.64it/s] 77%|███████▋  | 275/358 [00:28<00:08,  9.68it/s] 77%|███████▋  | 276/358 [00:28<00:08,  9.69it/s] 77%|███████▋  | 277/358 [00:28<00:08,  9.66it/s] 78%|███████▊  | 278/358 [00:28<00:08,  9.63it/s] 78%|███████▊  | 280/358 [00:28<00:07,  9.82it/s] 78%|███████▊  | 281/358 [00:28<00:07,  9.83it/s] 79%|███████▉  | 282/358 [00:28<00:07,  9.78it/s] 79%|███████▉  | 283/358 [00:28<00:07,  9.72it/s] 79%|███████▉  | 284/358 [00:28<00:07,  9.68it/s] 80%|███████▉  | 285/358 [00:29<00:07,  9.74it/s] 80%|███████▉  | 286/358 [00:29<00:07,  9.70it/s] 80%|████████  | 287/358 [00:29<00:07,  9.68it/s] 80%|████████  | 288/358 [00:29<00:07,  9.64it/s] 81%|████████  | 290/358 [00:29<00:06,  9.85it/s] 81%|████████▏ | 291/358 [00:29<00:06,  9.82it/s] 82%|████████▏ | 293/358 [00:29<00:06,  9.83it/s] 82%|████████▏ | 295/358 [00:30<00:06,  9.91it/s] 83%|████████▎ | 296/358 [00:30<00:06,  9.85it/s] 83%|████████▎ | 297/358 [00:30<00:06,  9.74it/s] 84%|████████▎ | 299/358 [00:30<00:05,  9.90it/s] 84%|████████▍ | 301/358 [00:30<00:05,  9.94it/s] 84%|████████▍ | 302/358 [00:30<00:05,  9.87it/s] 85%|████████▍ | 303/358 [00:30<00:05,  9.88it/s] 85%|████████▌ | 305/358 [00:31<00:05,  9.91it/s] 85%|████████▌ | 306/358 [00:31<00:05,  9.83it/s] 86%|████████▌ | 308/358 [00:31<00:05,  9.94it/s] 86%|████████▋ | 309/358 [00:31<00:04,  9.84it/s] 87%|████████▋ | 310/358 [00:31<00:04,  9.77it/s] 87%|████████▋ | 311/358 [00:31<00:04,  9.70it/s] 87%|████████▋ | 312/358 [00:31<00:04,  9.72it/s] 87%|████████▋ | 313/358 [00:31<00:04,  9.73it/s] 88%|████████▊ | 315/358 [00:32<00:04,  9.99it/s] 88%|████████▊ | 316/358 [00:32<00:04,  9.94it/s] 89%|████████▊ | 317/358 [00:32<00:04,  9.86it/s] 89%|████████▉ | 318/358 [00:32<00:04,  9.81it/s] 89%|████████▉ | 319/358 [00:32<00:03,  9.76it/s] 89%|████████▉ | 320/358 [00:32<00:03,  9.82it/s] 90%|████████▉ | 321/358 [00:32<00:03,  9.75it/s] 90%|████████▉ | 322/358 [00:32<00:03,  9.71it/s] 90%|█████████ | 323/358 [00:32<00:03,  9.67it/s] 91%|█████████ | 324/358 [00:33<00:03,  9.63it/s] 91%|█████████ | 325/358 [00:33<00:03,  9.62it/s] 91%|█████████▏| 327/358 [00:33<00:03,  9.98it/s] 92%|█████████▏| 329/358 [00:33<00:02, 10.08it/s] 92%|█████████▏| 330/358 [00:33<00:02,  9.97it/s] 93%|█████████▎| 332/358 [00:33<00:02, 10.07it/s] 93%|█████████▎| 334/358 [00:34<00:02,  9.97it/s] 94%|█████████▎| 335/358 [00:34<00:02,  9.85it/s] 94%|█████████▍| 337/358 [00:34<00:02,  9.92it/s] 95%|█████████▍| 339/358 [00:34<00:01, 10.12it/s] 95%|█████████▌| 341/358 [00:34<00:01, 10.07it/s] 96%|█████████▌| 343/358 [00:34<00:01,  9.91it/s] 96%|█████████▌| 344/358 [00:35<00:01,  9.85it/s] 96%|█████████▋| 345/358 [00:35<00:01,  9.87it/s] 97%|█████████▋| 347/358 [00:35<00:01, 10.05it/s] 97%|█████████▋| 349/358 [00:35<00:00,  9.89it/s] 98%|█████████▊| 350/358 [00:35<00:00,  9.83it/s] 98%|█████████▊| 351/358 [00:35<00:00,  9.78it/s] 99%|█████████▊| 353/358 [00:35<00:00,  9.93it/s] 99%|█████████▉| 354/358 [00:36<00:00,  9.92it/s] 99%|█████████▉| 355/358 [00:36<00:00,  9.83it/s]100%|█████████▉| 357/358 [00:36<00:00,  9.88it/s]100%|██████████| 358/358 [00:36<00:00,  9.84it/s]
[32m2025-02-05 06:29:52.000[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    gen_loss  grad clip ratio  grad norm   ppl
       1.775                1      5.233 5.898[0m
[32m2025-02-05 06:29:52.001[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m169[0m - [1m[Valid][0m
  0%|          | 0/10256 [00:00<?, ?it/s]100%|██████████| 10256/10256 [00:00<00:00, 931139.48it/s]
[32m2025-02-05 06:29:52.012[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:27,  1.43it/s]  5%|▌         | 2/40 [00:01<00:26,  1.45it/s]  8%|▊         | 3/40 [00:02<00:25,  1.45it/s] 10%|█         | 4/40 [00:02<00:24,  1.46it/s] 12%|█▎        | 5/40 [00:03<00:24,  1.45it/s] 15%|█▌        | 6/40 [00:04<00:23,  1.45it/s] 18%|█▊        | 7/40 [00:04<00:22,  1.45it/s] 20%|██        | 8/40 [00:05<00:22,  1.45it/s] 22%|██▎       | 9/40 [00:06<00:21,  1.45it/s] 25%|██▌       | 10/40 [00:06<00:20,  1.45it/s] 28%|██▊       | 11/40 [00:07<00:19,  1.45it/s] 30%|███       | 12/40 [00:08<00:19,  1.45it/s] 32%|███▎      | 13/40 [00:08<00:18,  1.45it/s] 35%|███▌      | 14/40 [00:09<00:18,  1.44it/s] 38%|███▊      | 15/40 [00:10<00:17,  1.44it/s] 40%|████      | 16/40 [00:11<00:16,  1.44it/s] 42%|████▎     | 17/40 [00:11<00:15,  1.45it/s] 45%|████▌     | 18/40 [00:12<00:15,  1.45it/s] 48%|████▊     | 19/40 [00:13<00:14,  1.45it/s] 50%|█████     | 20/40 [00:13<00:13,  1.46it/s] 52%|█████▎    | 21/40 [00:14<00:12,  1.46it/s] 55%|█████▌    | 22/40 [00:15<00:12,  1.46it/s] 57%|█████▊    | 23/40 [00:15<00:11,  1.46it/s] 60%|██████    | 24/40 [00:16<00:11,  1.45it/s] 62%|██████▎   | 25/40 [00:17<00:10,  1.45it/s] 65%|██████▌   | 26/40 [00:17<00:09,  1.46it/s] 68%|██████▊   | 27/40 [00:18<00:08,  1.46it/s] 70%|███████   | 28/40 [00:19<00:08,  1.45it/s] 72%|███████▎  | 29/40 [00:19<00:07,  1.45it/s] 75%|███████▌  | 30/40 [00:20<00:06,  1.46it/s] 78%|███████▊  | 31/40 [00:21<00:06,  1.45it/s] 80%|████████  | 32/40 [00:22<00:05,  1.46it/s] 82%|████████▎ | 33/40 [00:22<00:04,  1.45it/s] 85%|████████▌ | 34/40 [00:23<00:04,  1.45it/s] 88%|████████▊ | 35/40 [00:24<00:03,  1.45it/s] 90%|█████████ | 36/40 [00:24<00:02,  1.45it/s] 92%|█████████▎| 37/40 [00:25<00:02,  1.45it/s] 95%|█████████▌| 38/40 [00:26<00:01,  1.44it/s] 98%|█████████▊| 39/40 [00:26<00:00,  1.45it/s]100%|██████████| 40/40 [00:27<00:00,  1.60it/s]100%|██████████| 40/40 [00:27<00:00,  1.46it/s]
[32m2025-02-05 06:30:19.362[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    average  bleu@1  bleu@2  bleu@3  bleu@4  dist@1  dist@2  dist@3  dist@4  extreme  \
      .7831   .2999   .1106  .04073  .01959  .04415   .3077   .5885   .7590    .6008   
      f1  gen_loss  greedy  intra_dist@1  intra_dist@2  intra_dist@3  intra_dist@4  \
   .3521     5.311   .6690         .8718         .9699         .9593         .9197   
     ppl  rouge1  rouge2  rougeL  
   202.5   .3865   .0900   .3740[0m
[32m2025-02-05 06:30:19.368[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m163[0m - [1m[Conversation epoch 77][0m
[32m2025-02-05 06:30:19.369[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m164[0m - [1m[Train][0m
  0%|          | 0/92414 [00:00<?, ?it/s]100%|██████████| 92414/92414 [00:00<00:00, 1106455.57it/s]
[32m2025-02-05 06:30:19.452[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/358 [00:00<?, ?it/s]  0%|          | 1/358 [00:00<00:36,  9.78it/s]  1%|          | 3/358 [00:00<00:35,  9.95it/s]  1%|          | 4/358 [00:00<00:35,  9.92it/s]  2%|▏         | 6/358 [00:00<00:35,  9.88it/s]  2%|▏         | 7/358 [00:00<00:35,  9.82it/s]  2%|▏         | 8/358 [00:00<00:35,  9.86it/s]  3%|▎         | 9/358 [00:00<00:35,  9.76it/s]  3%|▎         | 10/358 [00:01<00:35,  9.75it/s]  3%|▎         | 11/358 [00:01<00:35,  9.71it/s]  4%|▎         | 13/358 [00:01<00:34,  9.93it/s]  4%|▍         | 14/358 [00:01<00:34,  9.86it/s]  4%|▍         | 15/358 [00:01<00:35,  9.78it/s]  4%|▍         | 16/358 [00:01<00:35,  9.72it/s]  5%|▍         | 17/358 [00:01<00:35,  9.73it/s]  5%|▌         | 19/358 [00:01<00:34,  9.76it/s]  6%|▌         | 20/358 [00:02<00:34,  9.71it/s]  6%|▌         | 21/358 [00:02<00:34,  9.64it/s]  6%|▌         | 22/358 [00:02<00:34,  9.69it/s]  7%|▋         | 24/358 [00:02<00:34,  9.78it/s]  7%|▋         | 25/358 [00:02<00:34,  9.73it/s]  7%|▋         | 26/358 [00:02<00:34,  9.68it/s]  8%|▊         | 27/358 [00:02<00:34,  9.73it/s]  8%|▊         | 28/358 [00:02<00:34,  9.69it/s]  8%|▊         | 29/358 [00:02<00:34,  9.65it/s]  9%|▊         | 31/358 [00:03<00:33,  9.75it/s]  9%|▉         | 32/358 [00:03<00:33,  9.75it/s]  9%|▉         | 34/358 [00:03<00:32,  9.86it/s] 10%|█         | 36/358 [00:03<00:32,  9.86it/s] 10%|█         | 37/358 [00:03<00:32,  9.84it/s] 11%|█         | 38/358 [00:03<00:32,  9.80it/s] 11%|█         | 40/358 [00:04<00:31,  9.96it/s] 11%|█▏        | 41/358 [00:04<00:32,  9.87it/s] 12%|█▏        | 43/358 [00:04<00:31,  9.89it/s] 13%|█▎        | 45/358 [00:04<00:31,  9.99it/s] 13%|█▎        | 47/358 [00:04<00:31,  9.97it/s] 13%|█▎        | 48/358 [00:04<00:31,  9.96it/s] 14%|█▍        | 50/358 [00:05<00:31,  9.92it/s] 14%|█▍        | 51/358 [00:05<00:31,  9.85it/s] 15%|█▍        | 52/358 [00:05<00:31,  9.76it/s] 15%|█▍        | 53/358 [00:05<00:31,  9.71it/s] 15%|█▌        | 54/358 [00:05<00:31,  9.75it/s] 15%|█▌        | 55/358 [00:05<00:31,  9.70it/s] 16%|█▌        | 56/358 [00:05<00:31,  9.74it/s] 16%|█▌        | 57/358 [00:05<00:31,  9.70it/s] 16%|█▌        | 58/358 [00:05<00:31,  9.68it/s] 16%|█▋        | 59/358 [00:06<00:30,  9.65it/s] 17%|█▋        | 61/358 [00:06<00:30,  9.73it/s] 17%|█▋        | 62/358 [00:06<00:30,  9.66it/s] 18%|█▊        | 63/358 [00:06<00:30,  9.72it/s] 18%|█▊        | 64/358 [00:06<00:30,  9.67it/s] 18%|█▊        | 66/358 [00:06<00:29,  9.74it/s] 19%|█▊        | 67/358 [00:06<00:29,  9.73it/s] 19%|█▉        | 69/358 [00:07<00:29,  9.79it/s] 20%|█▉        | 70/358 [00:07<00:29,  9.73it/s] 20%|█▉        | 71/358 [00:07<00:29,  9.78it/s] 20%|██        | 72/358 [00:07<00:29,  9.73it/s] 20%|██        | 73/358 [00:07<00:29,  9.69it/s] 21%|██        | 74/358 [00:07<00:29,  9.66it/s] 21%|██        | 75/358 [00:07<00:29,  9.63it/s] 21%|██        | 76/358 [00:07<00:28,  9.73it/s] 22%|██▏       | 77/358 [00:07<00:28,  9.70it/s] 22%|██▏       | 79/358 [00:08<00:28,  9.71it/s] 23%|██▎       | 81/358 [00:08<00:28,  9.77it/s] 23%|██▎       | 83/358 [00:08<00:28,  9.79it/s] 23%|██▎       | 84/358 [00:08<00:28,  9.74it/s] 24%|██▎       | 85/358 [00:08<00:28,  9.69it/s] 24%|██▍       | 86/358 [00:08<00:28,  9.68it/s] 24%|██▍       | 87/358 [00:08<00:28,  9.65it/s] 25%|██▍       | 88/358 [00:09<00:27,  9.67it/s] 25%|██▌       | 90/358 [00:09<00:27,  9.91it/s] 26%|██▌       | 92/358 [00:09<00:26, 10.01it/s] 26%|██▌       | 93/358 [00:09<00:26,  9.98it/s] 26%|██▋       | 94/358 [00:09<00:26,  9.89it/s] 27%|██▋       | 96/358 [00:09<00:25, 10.17it/s] 27%|██▋       | 98/358 [00:09<00:25, 10.06it/s] 28%|██▊       | 100/358 [00:10<00:25, 10.01it/s] 28%|██▊       | 101/358 [00:10<00:25,  9.92it/s] 29%|██▉       | 103/358 [00:10<00:25,  9.92it/s] 29%|██▉       | 104/358 [00:10<00:25,  9.87it/s] 29%|██▉       | 105/358 [00:10<00:25,  9.80it/s] 30%|██▉       | 106/358 [00:10<00:25,  9.78it/s] 30%|███       | 108/358 [00:11<00:25,  9.81it/s] 30%|███       | 109/358 [00:11<00:25,  9.72it/s] 31%|███       | 110/358 [00:11<00:25,  9.71it/s] 31%|███       | 111/358 [00:11<00:25,  9.66it/s] 32%|███▏      | 113/358 [00:11<00:24,  9.93it/s] 32%|███▏      | 114/358 [00:11<00:24,  9.89it/s] 32%|███▏      | 115/358 [00:11<00:24,  9.79it/s] 32%|███▏      | 116/358 [00:11<00:24,  9.71it/s] 33%|███▎      | 117/358 [00:11<00:24,  9.67it/s] 33%|███▎      | 119/358 [00:12<00:24,  9.80it/s] 34%|███▍      | 121/358 [00:12<00:23,  9.99it/s] 34%|███▍      | 123/358 [00:12<00:23, 10.09it/s] 35%|███▍      | 125/358 [00:12<00:23, 10.07it/s] 35%|███▌      | 127/358 [00:12<00:23, 10.00it/s] 36%|███▌      | 128/358 [00:13<00:23,  9.96it/s] 36%|███▋      | 130/358 [00:13<00:22, 10.01it/s] 37%|███▋      | 131/358 [00:13<00:22,  9.91it/s] 37%|███▋      | 132/358 [00:13<00:22,  9.93it/s] 37%|███▋      | 134/358 [00:13<00:22,  9.95it/s] 38%|███▊      | 135/358 [00:13<00:22,  9.89it/s] 38%|███▊      | 137/358 [00:13<00:22,  9.98it/s] 39%|███▊      | 138/358 [00:14<00:22,  9.96it/s] 39%|███▉      | 139/358 [00:14<00:22,  9.87it/s] 39%|███▉      | 141/358 [00:14<00:21, 10.00it/s] 40%|███▉      | 142/358 [00:14<00:21,  9.92it/s] 40%|███▉      | 143/358 [00:14<00:21,  9.88it/s] 40%|████      | 144/358 [00:14<00:21,  9.80it/s] 41%|████      | 145/358 [00:14<00:21,  9.82it/s] 41%|████      | 146/358 [00:14<00:21,  9.75it/s] 41%|████      | 147/358 [00:14<00:21,  9.69it/s] 41%|████▏     | 148/358 [00:15<00:21,  9.72it/s] 42%|████▏     | 149/358 [00:15<00:21,  9.70it/s] 42%|████▏     | 150/358 [00:15<00:21,  9.66it/s] 42%|████▏     | 151/358 [00:15<00:22,  9.40it/s] 42%|████▏     | 152/358 [00:15<00:21,  9.44it/s] 43%|████▎     | 153/358 [00:15<00:21,  9.46it/s] 43%|████▎     | 154/358 [00:15<00:21,  9.55it/s] 43%|████▎     | 155/358 [00:15<00:21,  9.57it/s] 44%|████▎     | 156/358 [00:15<00:20,  9.69it/s] 44%|████▍     | 157/358 [00:16<00:20,  9.63it/s] 44%|████▍     | 158/358 [00:16<00:20,  9.72it/s] 44%|████▍     | 159/358 [00:16<00:20,  9.71it/s] 45%|████▍     | 160/358 [00:16<00:20,  9.72it/s] 45%|████▌     | 162/358 [00:16<00:19, 10.02it/s] 46%|████▌     | 164/358 [00:16<00:19, 10.02it/s] 46%|████▌     | 165/358 [00:16<00:19,  9.97it/s] 47%|████▋     | 167/358 [00:17<00:19,  9.91it/s] 47%|████▋     | 169/358 [00:17<00:19,  9.94it/s] 48%|████▊     | 171/358 [00:17<00:18,  9.93it/s] 48%|████▊     | 172/358 [00:17<00:18,  9.88it/s] 48%|████▊     | 173/358 [00:17<00:18,  9.81it/s] 49%|████▉     | 175/358 [00:17<00:18,  9.84it/s] 49%|████▉     | 176/358 [00:17<00:18,  9.85it/s] 49%|████▉     | 177/358 [00:18<00:18,  9.84it/s] 50%|█████     | 179/358 [00:18<00:18,  9.87it/s] 50%|█████     | 180/358 [00:18<00:18,  9.80it/s] 51%|█████     | 182/358 [00:18<00:17,  9.94it/s] 51%|█████     | 183/358 [00:18<00:17,  9.90it/s] 51%|█████▏    | 184/358 [00:18<00:17,  9.78it/s] 52%|█████▏    | 185/358 [00:18<00:17,  9.73it/s] 52%|█████▏    | 187/358 [00:19<00:17,  9.95it/s] 53%|█████▎    | 188/358 [00:19<00:17,  9.82it/s] 53%|█████▎    | 189/358 [00:19<00:17,  9.78it/s] 53%|█████▎    | 191/358 [00:19<00:17,  9.72it/s] 54%|█████▎    | 192/358 [00:19<00:17,  9.68it/s] 54%|█████▍    | 193/358 [00:19<00:17,  9.68it/s] 54%|█████▍    | 194/358 [00:19<00:16,  9.67it/s] 54%|█████▍    | 195/358 [00:19<00:16,  9.74it/s] 55%|█████▌    | 197/358 [00:20<00:16,  9.92it/s] 55%|█████▌    | 198/358 [00:20<00:16,  9.84it/s] 56%|█████▌    | 199/358 [00:20<00:16,  9.88it/s] 56%|█████▌    | 200/358 [00:20<00:16,  9.81it/s] 56%|█████▌    | 201/358 [00:20<00:16,  9.77it/s] 57%|█████▋    | 203/358 [00:20<00:15,  9.87it/s] 57%|█████▋    | 204/358 [00:20<00:15,  9.76it/s] 57%|█████▋    | 205/358 [00:20<00:15,  9.72it/s] 58%|█████▊    | 207/358 [00:21<00:15,  9.88it/s] 58%|█████▊    | 208/358 [00:21<00:15,  9.81it/s] 59%|█████▊    | 210/358 [00:21<00:15,  9.83it/s] 59%|█████▉    | 212/358 [00:21<00:14,  9.82it/s] 60%|█████▉    | 214/358 [00:21<00:14,  9.90it/s] 60%|██████    | 215/358 [00:21<00:14,  9.84it/s] 60%|██████    | 216/358 [00:22<00:14,  9.77it/s] 61%|██████    | 217/358 [00:22<00:14,  9.81it/s] 61%|██████    | 218/358 [00:22<00:14,  9.78it/s] 61%|██████    | 219/358 [00:22<00:14,  9.77it/s] 62%|██████▏   | 221/358 [00:22<00:13,  9.90it/s] 62%|██████▏   | 222/358 [00:22<00:13,  9.80it/s] 62%|██████▏   | 223/358 [00:22<00:13,  9.75it/s] 63%|██████▎   | 224/358 [00:22<00:13,  9.69it/s] 63%|██████▎   | 225/358 [00:22<00:13,  9.77it/s] 63%|██████▎   | 226/358 [00:23<00:13,  9.72it/s] 64%|██████▎   | 228/358 [00:23<00:13,  9.76it/s] 64%|██████▍   | 229/358 [00:23<00:13,  9.74it/s] 64%|██████▍   | 230/358 [00:23<00:13,  9.68it/s] 65%|██████▍   | 232/358 [00:23<00:12,  9.74it/s] 65%|██████▌   | 234/358 [00:23<00:12, 10.03it/s] 66%|██████▌   | 236/358 [00:24<00:12,  9.99it/s] 66%|██████▋   | 238/358 [00:24<00:11, 10.04it/s] 67%|██████▋   | 240/358 [00:24<00:11, 10.00it/s] 68%|██████▊   | 242/358 [00:24<00:11,  9.98it/s] 68%|██████▊   | 243/358 [00:24<00:11,  9.92it/s] 68%|██████▊   | 244/358 [00:24<00:11,  9.85it/s] 69%|██████▊   | 246/358 [00:25<00:11,  9.88it/s] 69%|██████▉   | 247/358 [00:25<00:11,  9.80it/s] 69%|██████▉   | 248/358 [00:25<00:11,  9.75it/s] 70%|██████▉   | 250/358 [00:25<00:10,  9.85it/s] 70%|███████   | 251/358 [00:25<00:10,  9.79it/s] 70%|███████   | 252/358 [00:25<00:10,  9.73it/s] 71%|███████   | 253/358 [00:25<00:10,  9.69it/s] 71%|███████   | 254/358 [00:25<00:10,  9.66it/s] 72%|███████▏  | 256/358 [00:26<00:10,  9.83it/s] 72%|███████▏  | 257/358 [00:26<00:10,  9.83it/s] 72%|███████▏  | 258/358 [00:26<00:10,  9.71it/s] 72%|███████▏  | 259/358 [00:26<00:10,  9.67it/s] 73%|███████▎  | 260/358 [00:26<00:10,  9.71it/s] 73%|███████▎  | 262/358 [00:26<00:09,  9.90it/s] 74%|███████▎  | 264/358 [00:26<00:09,  9.92it/s] 74%|███████▍  | 266/358 [00:27<00:09,  9.91it/s] 75%|███████▍  | 267/358 [00:27<00:09,  9.85it/s] 75%|███████▌  | 269/358 [00:27<00:08,  9.90it/s] 75%|███████▌  | 270/358 [00:27<00:08,  9.83it/s] 76%|███████▌  | 271/358 [00:27<00:08,  9.76it/s] 76%|███████▌  | 272/358 [00:27<00:08,  9.74it/s] 76%|███████▋  | 273/358 [00:27<00:08,  9.64it/s] 77%|███████▋  | 274/358 [00:27<00:08,  9.64it/s] 77%|███████▋  | 275/358 [00:28<00:08,  9.69it/s] 77%|███████▋  | 276/358 [00:28<00:08,  9.69it/s] 77%|███████▋  | 277/358 [00:28<00:08,  9.66it/s] 78%|███████▊  | 278/358 [00:28<00:08,  9.64it/s] 78%|███████▊  | 280/358 [00:28<00:07,  9.83it/s] 78%|███████▊  | 281/358 [00:28<00:07,  9.84it/s] 79%|███████▉  | 282/358 [00:28<00:07,  9.77it/s] 79%|███████▉  | 283/358 [00:28<00:07,  9.71it/s] 79%|███████▉  | 284/358 [00:28<00:07,  9.67it/s] 80%|███████▉  | 285/358 [00:29<00:07,  9.74it/s] 80%|███████▉  | 286/358 [00:29<00:07,  9.69it/s] 80%|████████  | 287/358 [00:29<00:07,  9.67it/s] 80%|████████  | 288/358 [00:29<00:07,  9.63it/s] 81%|████████  | 290/358 [00:29<00:06,  9.84it/s] 81%|████████▏ | 291/358 [00:29<00:06,  9.83it/s] 82%|████████▏ | 293/358 [00:29<00:06,  9.84it/s] 82%|████████▏ | 295/358 [00:30<00:06,  9.91it/s] 83%|████████▎ | 296/358 [00:30<00:06,  9.84it/s] 83%|████████▎ | 297/358 [00:30<00:06,  9.74it/s] 84%|████████▎ | 299/358 [00:30<00:05,  9.90it/s] 84%|████████▍ | 301/358 [00:30<00:05,  9.94it/s] 84%|████████▍ | 302/358 [00:30<00:05,  9.87it/s] 85%|████████▍ | 303/358 [00:30<00:05,  9.88it/s] 85%|████████▌ | 305/358 [00:31<00:05,  9.91it/s] 85%|████████▌ | 306/358 [00:31<00:05,  9.83it/s] 86%|████████▌ | 308/358 [00:31<00:05,  9.93it/s] 86%|████████▋ | 309/358 [00:31<00:04,  9.83it/s] 87%|████████▋ | 310/358 [00:31<00:04,  9.78it/s] 87%|████████▋ | 311/358 [00:31<00:04,  9.70it/s] 87%|████████▋ | 312/358 [00:31<00:04,  9.72it/s] 87%|████████▋ | 313/358 [00:31<00:04,  9.74it/s] 88%|████████▊ | 315/358 [00:32<00:04, 10.00it/s] 88%|████████▊ | 316/358 [00:32<00:04,  9.95it/s] 89%|████████▊ | 317/358 [00:32<00:04,  9.86it/s] 89%|████████▉ | 318/358 [00:32<00:04,  9.81it/s] 89%|████████▉ | 319/358 [00:32<00:03,  9.77it/s] 89%|████████▉ | 320/358 [00:32<00:03,  9.82it/s] 90%|████████▉ | 321/358 [00:32<00:03,  9.75it/s] 90%|████████▉ | 322/358 [00:32<00:03,  9.71it/s] 90%|█████████ | 323/358 [00:32<00:03,  9.66it/s] 91%|█████████ | 324/358 [00:33<00:03,  9.63it/s] 91%|█████████ | 325/358 [00:33<00:03,  9.61it/s] 91%|█████████▏| 327/358 [00:33<00:03,  9.98it/s] 92%|█████████▏| 329/358 [00:33<00:02, 10.08it/s] 92%|█████████▏| 330/358 [00:33<00:02,  9.97it/s] 93%|█████████▎| 332/358 [00:33<00:02, 10.06it/s] 93%|█████████▎| 334/358 [00:34<00:02,  9.97it/s] 94%|█████████▎| 335/358 [00:34<00:02,  9.85it/s] 94%|█████████▍| 337/358 [00:34<00:02,  9.92it/s] 95%|█████████▍| 339/358 [00:34<00:01, 10.12it/s] 95%|█████████▌| 341/358 [00:34<00:01, 10.07it/s] 96%|█████████▌| 343/358 [00:34<00:01,  9.91it/s] 96%|█████████▌| 344/358 [00:35<00:01,  9.85it/s] 96%|█████████▋| 345/358 [00:35<00:01,  9.87it/s] 97%|█████████▋| 347/358 [00:35<00:01, 10.04it/s] 97%|█████████▋| 348/358 [00:35<00:01,  9.94it/s] 97%|█████████▋| 349/358 [00:35<00:00,  9.87it/s] 98%|█████████▊| 350/358 [00:35<00:00,  9.79it/s] 98%|█████████▊| 351/358 [00:35<00:00,  9.75it/s] 99%|█████████▊| 353/358 [00:35<00:00,  9.93it/s] 99%|█████████▉| 354/358 [00:36<00:00,  9.91it/s] 99%|█████████▉| 355/358 [00:36<00:00,  9.82it/s]100%|█████████▉| 357/358 [00:36<00:00,  9.88it/s]100%|██████████| 358/358 [00:36<00:00,  9.83it/s]
[32m2025-02-05 06:30:55.870[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    gen_loss  grad clip ratio  grad norm   ppl
       1.762                1      2.657 5.825[0m
[32m2025-02-05 06:30:55.871[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m169[0m - [1m[Valid][0m
  0%|          | 0/10256 [00:00<?, ?it/s]100%|██████████| 10256/10256 [00:00<00:00, 923384.32it/s]
[32m2025-02-05 06:30:55.882[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:27,  1.42it/s]  5%|▌         | 2/40 [00:01<00:26,  1.44it/s]  8%|▊         | 3/40 [00:02<00:25,  1.45it/s] 10%|█         | 4/40 [00:02<00:24,  1.45it/s] 12%|█▎        | 5/40 [00:03<00:24,  1.44it/s] 15%|█▌        | 6/40 [00:04<00:23,  1.44it/s] 18%|█▊        | 7/40 [00:04<00:22,  1.44it/s] 20%|██        | 8/40 [00:05<00:22,  1.45it/s] 22%|██▎       | 9/40 [00:06<00:21,  1.45it/s] 25%|██▌       | 10/40 [00:06<00:20,  1.46it/s] 28%|██▊       | 11/40 [00:07<00:19,  1.46it/s] 30%|███       | 12/40 [00:08<00:19,  1.46it/s] 32%|███▎      | 13/40 [00:08<00:18,  1.46it/s] 35%|███▌      | 14/40 [00:09<00:18,  1.44it/s] 38%|███▊      | 15/40 [00:10<00:17,  1.44it/s] 40%|████      | 16/40 [00:11<00:16,  1.45it/s] 42%|████▎     | 17/40 [00:11<00:15,  1.46it/s] 45%|████▌     | 18/40 [00:12<00:15,  1.45it/s] 48%|████▊     | 19/40 [00:13<00:14,  1.45it/s] 50%|█████     | 20/40 [00:13<00:13,  1.46it/s] 52%|█████▎    | 21/40 [00:14<00:13,  1.46it/s] 55%|█████▌    | 22/40 [00:15<00:12,  1.45it/s] 57%|█████▊    | 23/40 [00:15<00:11,  1.45it/s] 60%|██████    | 24/40 [00:16<00:11,  1.44it/s] 62%|██████▎   | 25/40 [00:17<00:10,  1.44it/s] 65%|██████▌   | 26/40 [00:17<00:09,  1.45it/s] 68%|██████▊   | 27/40 [00:18<00:08,  1.45it/s] 70%|███████   | 28/40 [00:19<00:08,  1.45it/s] 72%|███████▎  | 29/40 [00:19<00:07,  1.45it/s] 75%|███████▌  | 30/40 [00:20<00:06,  1.46it/s] 78%|███████▊  | 31/40 [00:21<00:06,  1.45it/s] 80%|████████  | 32/40 [00:22<00:05,  1.46it/s] 82%|████████▎ | 33/40 [00:22<00:04,  1.45it/s] 85%|████████▌ | 34/40 [00:23<00:04,  1.46it/s] 88%|████████▊ | 35/40 [00:24<00:03,  1.45it/s] 90%|█████████ | 36/40 [00:24<00:02,  1.45it/s] 92%|█████████▎| 37/40 [00:25<00:02,  1.45it/s] 95%|█████████▌| 38/40 [00:26<00:01,  1.44it/s] 98%|█████████▊| 39/40 [00:26<00:00,  1.44it/s]100%|██████████| 40/40 [00:27<00:00,  1.60it/s]100%|██████████| 40/40 [00:27<00:00,  1.46it/s]
[32m2025-02-05 06:31:23.238[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    average  bleu@1  bleu@2  bleu@3  bleu@4  dist@1  dist@2  dist@3  dist@4  extreme  \
      .7797   .2983   .1107  .04524  .02194   .0454   .3247   .6146   .7813    .5950   
      f1  gen_loss  greedy  intra_dist@1  intra_dist@2  intra_dist@3  intra_dist@4  \
   .3509     5.314   .6663         .8752         .9694         .9552         .9190   
     ppl  rouge1  rouge2  rougeL  
   203.1   .3851  .09112   .3729[0m
[32m2025-02-05 06:31:23.245[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m163[0m - [1m[Conversation epoch 78][0m
[32m2025-02-05 06:31:23.245[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m164[0m - [1m[Train][0m
  0%|          | 0/92414 [00:00<?, ?it/s]100%|██████████| 92414/92414 [00:00<00:00, 1120027.54it/s]
[32m2025-02-05 06:31:23.328[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/358 [00:00<?, ?it/s]  0%|          | 1/358 [00:00<00:36,  9.78it/s]  1%|          | 3/358 [00:00<00:35,  9.95it/s]  1%|          | 4/358 [00:00<00:35,  9.93it/s]  2%|▏         | 6/358 [00:00<00:35,  9.89it/s]  2%|▏         | 7/358 [00:00<00:35,  9.82it/s]  2%|▏         | 8/358 [00:00<00:35,  9.86it/s]  3%|▎         | 9/358 [00:00<00:35,  9.76it/s]  3%|▎         | 10/358 [00:01<00:35,  9.75it/s]  3%|▎         | 11/358 [00:01<00:35,  9.70it/s]  4%|▎         | 13/358 [00:01<00:34,  9.92it/s]  4%|▍         | 14/358 [00:01<00:34,  9.85it/s]  4%|▍         | 15/358 [00:01<00:35,  9.78it/s]  4%|▍         | 16/358 [00:01<00:35,  9.71it/s]  5%|▍         | 17/358 [00:01<00:35,  9.73it/s]  5%|▌         | 19/358 [00:01<00:34,  9.75it/s]  6%|▌         | 20/358 [00:02<00:34,  9.70it/s]  6%|▌         | 21/358 [00:02<00:34,  9.64it/s]  6%|▌         | 22/358 [00:02<00:34,  9.69it/s]  7%|▋         | 24/358 [00:02<00:34,  9.78it/s]  7%|▋         | 25/358 [00:02<00:34,  9.73it/s]  7%|▋         | 26/358 [00:02<00:34,  9.68it/s]  8%|▊         | 27/358 [00:02<00:34,  9.73it/s]  8%|▊         | 28/358 [00:02<00:34,  9.69it/s]  8%|▊         | 29/358 [00:02<00:34,  9.65it/s]  9%|▊         | 31/358 [00:03<00:33,  9.76it/s]  9%|▉         | 32/358 [00:03<00:33,  9.76it/s]  9%|▉         | 34/358 [00:03<00:32,  9.86it/s] 10%|█         | 36/358 [00:03<00:32,  9.85it/s] 10%|█         | 37/358 [00:03<00:32,  9.83it/s] 11%|█         | 38/358 [00:03<00:32,  9.79it/s] 11%|█         | 40/358 [00:04<00:31,  9.95it/s] 11%|█▏        | 41/358 [00:04<00:32,  9.86it/s] 12%|█▏        | 43/358 [00:04<00:31,  9.89it/s] 13%|█▎        | 45/358 [00:04<00:31,  9.99it/s] 13%|█▎        | 47/358 [00:04<00:31,  9.96it/s] 13%|█▎        | 48/358 [00:04<00:31,  9.95it/s] 14%|█▍        | 50/358 [00:05<00:31,  9.92it/s] 14%|█▍        | 51/358 [00:05<00:31,  9.85it/s] 15%|█▍        | 52/358 [00:05<00:31,  9.76it/s] 15%|█▍        | 53/358 [00:05<00:31,  9.71it/s] 15%|█▌        | 54/358 [00:05<00:31,  9.76it/s] 15%|█▌        | 55/358 [00:05<00:31,  9.70it/s] 16%|█▌        | 56/358 [00:05<00:30,  9.74it/s] 16%|█▌        | 57/358 [00:05<00:31,  9.70it/s] 16%|█▌        | 58/358 [00:05<00:31,  9.68it/s] 16%|█▋        | 59/358 [00:06<00:30,  9.65it/s] 17%|█▋        | 61/358 [00:06<00:30,  9.73it/s] 17%|█▋        | 62/358 [00:06<00:30,  9.66it/s] 18%|█▊        | 63/358 [00:06<00:30,  9.72it/s] 18%|█▊        | 64/358 [00:06<00:30,  9.67it/s] 18%|█▊        | 66/358 [00:06<00:29,  9.74it/s] 19%|█▊        | 67/358 [00:06<00:29,  9.72it/s] 19%|█▉        | 69/358 [00:07<00:29,  9.77it/s] 20%|█▉        | 70/358 [00:07<00:29,  9.72it/s] 20%|█▉        | 71/358 [00:07<00:29,  9.76it/s] 20%|██        | 72/358 [00:07<00:29,  9.71it/s] 20%|██        | 73/358 [00:07<00:29,  9.68it/s] 21%|██        | 74/358 [00:07<00:29,  9.65it/s] 21%|██        | 75/358 [00:07<00:29,  9.62it/s] 21%|██        | 76/358 [00:07<00:29,  9.72it/s] 22%|██▏       | 77/358 [00:07<00:29,  9.69it/s] 22%|██▏       | 79/358 [00:08<00:28,  9.69it/s] 23%|██▎       | 81/358 [00:08<00:28,  9.75it/s] 23%|██▎       | 83/358 [00:08<00:28,  9.78it/s] 23%|██▎       | 84/358 [00:08<00:28,  9.72it/s] 24%|██▎       | 85/358 [00:08<00:28,  9.68it/s] 24%|██▍       | 86/358 [00:08<00:28,  9.67it/s] 24%|██▍       | 87/358 [00:08<00:28,  9.65it/s] 25%|██▍       | 88/358 [00:09<00:27,  9.67it/s] 25%|██▌       | 90/358 [00:09<00:27,  9.91it/s] 26%|██▌       | 92/358 [00:09<00:26, 10.01it/s] 26%|██▌       | 93/358 [00:09<00:26,  9.97it/s] 26%|██▋       | 94/358 [00:09<00:26,  9.88it/s] 27%|██▋       | 96/358 [00:09<00:25, 10.16it/s] 27%|██▋       | 98/358 [00:10<00:25, 10.05it/s] 28%|██▊       | 99/358 [00:10<00:26,  9.96it/s] 28%|██▊       | 101/358 [00:10<00:25,  9.93it/s] 29%|██▉       | 103/358 [00:10<00:25,  9.91it/s] 29%|██▉       | 104/358 [00:10<00:25,  9.87it/s] 29%|██▉       | 105/358 [00:10<00:25,  9.79it/s] 30%|██▉       | 106/358 [00:10<00:25,  9.77it/s] 30%|███       | 108/358 [00:11<00:25,  9.80it/s] 30%|███       | 109/358 [00:11<00:25,  9.72it/s] 31%|███       | 110/358 [00:11<00:25,  9.70it/s] 31%|███       | 111/358 [00:11<00:25,  9.65it/s] 32%|███▏      | 113/358 [00:11<00:24,  9.91it/s] 32%|███▏      | 114/358 [00:11<00:24,  9.87it/s] 32%|███▏      | 115/358 [00:11<00:24,  9.78it/s] 32%|███▏      | 116/358 [00:11<00:24,  9.69it/s] 33%|███▎      | 117/358 [00:11<00:24,  9.67it/s] 33%|███▎      | 119/358 [00:12<00:24,  9.79it/s] 34%|███▍      | 121/358 [00:12<00:23,  9.98it/s] 34%|███▍      | 123/358 [00:12<00:23, 10.07it/s] 35%|███▍      | 125/358 [00:12<00:23, 10.05it/s] 35%|███▌      | 127/358 [00:12<00:23,  9.99it/s] 36%|███▌      | 128/358 [00:13<00:23,  9.95it/s] 36%|███▋      | 130/358 [00:13<00:22, 10.00it/s] 37%|███▋      | 131/358 [00:13<00:22,  9.91it/s] 37%|███▋      | 132/358 [00:13<00:22,  9.92it/s] 37%|███▋      | 134/358 [00:13<00:22,  9.94it/s] 38%|███▊      | 135/358 [00:13<00:22,  9.88it/s] 38%|███▊      | 137/358 [00:13<00:22,  9.97it/s] 39%|███▊      | 138/358 [00:14<00:22,  9.95it/s] 39%|███▉      | 139/358 [00:14<00:22,  9.86it/s] 39%|███▉      | 141/358 [00:14<00:21,  9.99it/s] 40%|███▉      | 142/358 [00:14<00:21,  9.91it/s] 40%|███▉      | 143/358 [00:14<00:21,  9.88it/s] 40%|████      | 144/358 [00:14<00:21,  9.79it/s] 41%|████      | 145/358 [00:14<00:21,  9.81it/s] 41%|████      | 146/358 [00:14<00:21,  9.74it/s] 41%|████      | 147/358 [00:14<00:21,  9.69it/s] 41%|████▏     | 148/358 [00:15<00:21,  9.71it/s] 42%|████▏     | 149/358 [00:15<00:21,  9.69it/s] 42%|████▏     | 150/358 [00:15<00:21,  9.65it/s] 42%|████▏     | 151/358 [00:15<00:22,  9.39it/s] 42%|████▏     | 152/358 [00:15<00:21,  9.44it/s] 43%|████▎     | 153/358 [00:15<00:21,  9.45it/s] 43%|████▎     | 154/358 [00:15<00:21,  9.54it/s] 43%|████▎     | 155/358 [00:15<00:21,  9.55it/s] 44%|████▎     | 156/358 [00:15<00:20,  9.68it/s] 44%|████▍     | 157/358 [00:16<00:20,  9.62it/s] 44%|████▍     | 158/358 [00:16<00:20,  9.71it/s] 44%|████▍     | 159/358 [00:16<00:20,  9.70it/s] 45%|████▍     | 160/358 [00:16<00:20,  9.71it/s] 45%|████▌     | 162/358 [00:16<00:19, 10.01it/s] 46%|████▌     | 164/358 [00:16<00:19, 10.00it/s] 46%|████▌     | 165/358 [00:16<00:19,  9.96it/s] 47%|████▋     | 167/358 [00:17<00:19,  9.91it/s] 47%|████▋     | 169/358 [00:17<00:18,  9.95it/s] 48%|████▊     | 171/358 [00:17<00:18,  9.93it/s] 48%|████▊     | 172/358 [00:17<00:18,  9.88it/s] 48%|████▊     | 173/358 [00:17<00:18,  9.82it/s] 49%|████▉     | 175/358 [00:17<00:18,  9.84it/s] 49%|████▉     | 176/358 [00:17<00:18,  9.85it/s] 49%|████▉     | 177/358 [00:18<00:18,  9.84it/s] 50%|█████     | 179/358 [00:18<00:18,  9.86it/s] 50%|█████     | 180/358 [00:18<00:18,  9.79it/s] 51%|█████     | 182/358 [00:18<00:17,  9.95it/s] 51%|█████     | 183/358 [00:18<00:17,  9.90it/s] 51%|█████▏    | 184/358 [00:18<00:17,  9.79it/s] 52%|█████▏    | 185/358 [00:18<00:17,  9.73it/s] 52%|█████▏    | 187/358 [00:19<00:17,  9.95it/s] 53%|█████▎    | 188/358 [00:19<00:17,  9.89it/s] 53%|█████▎    | 189/358 [00:19<00:17,  9.83it/s] 53%|█████▎    | 191/358 [00:19<00:17,  9.75it/s] 54%|█████▎    | 192/358 [00:19<00:17,  9.70it/s] 54%|█████▍    | 193/358 [00:19<00:17,  9.69it/s] 54%|█████▍    | 194/358 [00:19<00:16,  9.67it/s] 54%|█████▍    | 195/358 [00:19<00:16,  9.74it/s] 55%|█████▌    | 197/358 [00:20<00:16,  9.92it/s] 55%|█████▌    | 198/358 [00:20<00:16,  9.85it/s] 56%|█████▌    | 199/358 [00:20<00:16,  9.88it/s] 56%|█████▌    | 200/358 [00:20<00:16,  9.81it/s] 56%|█████▌    | 201/358 [00:20<00:16,  9.77it/s] 57%|█████▋    | 203/358 [00:20<00:15,  9.86it/s] 57%|█████▋    | 204/358 [00:20<00:15,  9.75it/s] 57%|█████▋    | 205/358 [00:20<00:15,  9.71it/s] 58%|█████▊    | 207/358 [00:21<00:15,  9.87it/s] 58%|█████▊    | 208/358 [00:21<00:15,  9.80it/s] 59%|█████▊    | 210/358 [00:21<00:15,  9.82it/s] 59%|█████▉    | 212/358 [00:21<00:14,  9.81it/s] 60%|█████▉    | 214/358 [00:21<00:14,  9.90it/s] 60%|██████    | 215/358 [00:21<00:14,  9.83it/s] 60%|██████    | 216/358 [00:22<00:14,  9.77it/s] 61%|██████    | 217/358 [00:22<00:14,  9.81it/s] 61%|██████    | 218/358 [00:22<00:14,  9.78it/s] 61%|██████    | 219/358 [00:22<00:14,  9.78it/s] 62%|██████▏   | 221/358 [00:22<00:13,  9.91it/s] 62%|██████▏   | 222/358 [00:22<00:13,  9.81it/s] 62%|██████▏   | 223/358 [00:22<00:13,  9.75it/s] 63%|██████▎   | 224/358 [00:22<00:13,  9.69it/s] 63%|██████▎   | 225/358 [00:22<00:13,  9.78it/s] 63%|██████▎   | 226/358 [00:23<00:13,  9.72it/s] 64%|██████▎   | 228/358 [00:23<00:13,  9.77it/s] 64%|██████▍   | 229/358 [00:23<00:13,  9.73it/s] 64%|██████▍   | 230/358 [00:23<00:13,  9.68it/s] 65%|██████▍   | 232/358 [00:23<00:12,  9.74it/s] 65%|██████▌   | 234/358 [00:23<00:12, 10.02it/s] 66%|██████▌   | 236/358 [00:24<00:12,  9.98it/s] 66%|██████▋   | 238/358 [00:24<00:11, 10.04it/s] 67%|██████▋   | 240/358 [00:24<00:11, 10.00it/s] 68%|██████▊   | 242/358 [00:24<00:11,  9.98it/s] 68%|██████▊   | 243/358 [00:24<00:11,  9.92it/s] 68%|██████▊   | 244/358 [00:24<00:11,  9.85it/s] 69%|██████▊   | 246/358 [00:25<00:11,  9.88it/s] 69%|██████▉   | 247/358 [00:25<00:11,  9.80it/s] 69%|██████▉   | 248/358 [00:25<00:11,  9.76it/s] 70%|██████▉   | 250/358 [00:25<00:10,  9.85it/s] 70%|███████   | 251/358 [00:25<00:10,  9.79it/s] 70%|███████   | 252/358 [00:25<00:10,  9.73it/s] 71%|███████   | 253/358 [00:25<00:10,  9.69it/s] 71%|███████   | 254/358 [00:25<00:10,  9.66it/s] 72%|███████▏  | 256/358 [00:26<00:10,  9.84it/s] 72%|███████▏  | 257/358 [00:26<00:10,  9.84it/s] 72%|███████▏  | 258/358 [00:26<00:10,  9.72it/s] 72%|███████▏  | 259/358 [00:26<00:10,  9.68it/s] 73%|███████▎  | 260/358 [00:26<00:10,  9.72it/s] 73%|███████▎  | 262/358 [00:26<00:09,  9.90it/s] 74%|███████▎  | 264/358 [00:26<00:09,  9.92it/s] 74%|███████▍  | 266/358 [00:27<00:09,  9.91it/s] 75%|███████▍  | 267/358 [00:27<00:09,  9.85it/s] 75%|███████▌  | 269/358 [00:27<00:08,  9.90it/s] 75%|███████▌  | 270/358 [00:27<00:08,  9.83it/s] 76%|███████▌  | 271/358 [00:27<00:08,  9.76it/s] 76%|███████▌  | 272/358 [00:27<00:08,  9.74it/s] 76%|███████▋  | 273/358 [00:27<00:08,  9.64it/s] 77%|███████▋  | 274/358 [00:27<00:08,  9.64it/s] 77%|███████▋  | 275/358 [00:28<00:08,  9.68it/s] 77%|███████▋  | 276/358 [00:28<00:08,  9.69it/s] 77%|███████▋  | 277/358 [00:28<00:08,  9.66it/s] 78%|███████▊  | 278/358 [00:28<00:08,  9.64it/s] 78%|███████▊  | 280/358 [00:28<00:07,  9.83it/s] 78%|███████▊  | 281/358 [00:28<00:07,  9.84it/s] 79%|███████▉  | 282/358 [00:28<00:07,  9.78it/s] 79%|███████▉  | 283/358 [00:28<00:07,  9.72it/s] 79%|███████▉  | 284/358 [00:28<00:07,  9.68it/s] 80%|███████▉  | 285/358 [00:29<00:07,  9.74it/s] 80%|███████▉  | 286/358 [00:29<00:07,  9.70it/s] 80%|████████  | 287/358 [00:29<00:07,  9.67it/s] 80%|████████  | 288/358 [00:29<00:07,  9.64it/s] 81%|████████  | 290/358 [00:29<00:06,  9.85it/s] 81%|████████▏ | 291/358 [00:29<00:06,  9.83it/s] 82%|████████▏ | 293/358 [00:29<00:06,  9.84it/s] 82%|████████▏ | 295/358 [00:30<00:06,  9.91it/s] 83%|████████▎ | 296/358 [00:30<00:06,  9.85it/s] 83%|████████▎ | 297/358 [00:30<00:06,  9.74it/s] 84%|████████▎ | 299/358 [00:30<00:05,  9.90it/s] 84%|████████▍ | 301/358 [00:30<00:05,  9.94it/s] 84%|████████▍ | 302/358 [00:30<00:05,  9.87it/s] 85%|████████▍ | 303/358 [00:30<00:05,  9.88it/s] 85%|████████▌ | 305/358 [00:31<00:05,  9.91it/s] 85%|████████▌ | 306/358 [00:31<00:05,  9.83it/s] 86%|████████▌ | 308/358 [00:31<00:05,  9.93it/s] 86%|████████▋ | 309/358 [00:31<00:04,  9.83it/s] 87%|████████▋ | 310/358 [00:31<00:04,  9.77it/s] 87%|████████▋ | 311/358 [00:31<00:04,  9.70it/s] 87%|████████▋ | 312/358 [00:31<00:04,  9.72it/s] 87%|████████▋ | 313/358 [00:31<00:04,  9.73it/s] 88%|████████▊ | 315/358 [00:32<00:04,  9.99it/s] 88%|████████▊ | 316/358 [00:32<00:04,  9.94it/s] 89%|████████▊ | 317/358 [00:32<00:04,  9.86it/s] 89%|████████▉ | 318/358 [00:32<00:04,  9.81it/s] 89%|████████▉ | 319/358 [00:32<00:03,  9.76it/s] 89%|████████▉ | 320/358 [00:32<00:03,  9.82it/s] 90%|████████▉ | 321/358 [00:32<00:03,  9.75it/s] 90%|████████▉ | 322/358 [00:32<00:03,  9.71it/s] 90%|█████████ | 323/358 [00:32<00:03,  9.66it/s] 91%|█████████ | 324/358 [00:33<00:03,  9.63it/s] 91%|█████████ | 325/358 [00:33<00:03,  9.61it/s] 91%|█████████▏| 327/358 [00:33<00:03,  9.97it/s] 92%|█████████▏| 329/358 [00:33<00:02, 10.07it/s] 92%|█████████▏| 330/358 [00:33<00:02,  9.96it/s] 93%|█████████▎| 332/358 [00:33<00:02, 10.06it/s] 93%|█████████▎| 334/358 [00:34<00:02,  9.96it/s] 94%|█████████▎| 335/358 [00:34<00:02,  9.84it/s] 94%|█████████▍| 337/358 [00:34<00:02,  9.92it/s] 95%|█████████▍| 339/358 [00:34<00:01, 10.12it/s] 95%|█████████▌| 341/358 [00:34<00:01, 10.06it/s] 96%|█████████▌| 343/358 [00:34<00:01,  9.90it/s] 96%|█████████▌| 344/358 [00:35<00:01,  9.84it/s] 96%|█████████▋| 345/358 [00:35<00:01,  9.86it/s] 97%|█████████▋| 347/358 [00:35<00:01, 10.04it/s] 97%|█████████▋| 348/358 [00:35<00:01,  9.94it/s] 97%|█████████▋| 349/358 [00:35<00:00,  9.86it/s] 98%|█████████▊| 350/358 [00:35<00:00,  9.79it/s] 98%|█████████▊| 351/358 [00:35<00:00,  9.74it/s] 99%|█████████▊| 353/358 [00:35<00:00,  9.92it/s] 99%|█████████▉| 354/358 [00:36<00:00,  9.91it/s] 99%|█████████▉| 355/358 [00:36<00:00,  9.82it/s]100%|█████████▉| 357/358 [00:36<00:00,  9.88it/s]100%|██████████| 358/358 [00:36<00:00,  9.83it/s]
[32m2025-02-05 06:31:59.755[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    gen_loss  grad clip ratio  grad norm   ppl
       1.757                1      3.471 5.798[0m
[32m2025-02-05 06:31:59.755[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m169[0m - [1m[Valid][0m
  0%|          | 0/10256 [00:00<?, ?it/s]100%|██████████| 10256/10256 [00:00<00:00, 1049445.76it/s]
[32m2025-02-05 06:31:59.765[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:27,  1.42it/s]  5%|▌         | 2/40 [00:01<00:26,  1.43it/s]  8%|▊         | 3/40 [00:02<00:25,  1.43it/s] 10%|█         | 4/40 [00:02<00:24,  1.44it/s] 12%|█▎        | 5/40 [00:03<00:24,  1.43it/s] 15%|█▌        | 6/40 [00:04<00:23,  1.43it/s] 18%|█▊        | 7/40 [00:04<00:23,  1.43it/s] 20%|██        | 8/40 [00:05<00:22,  1.44it/s] 22%|██▎       | 9/40 [00:06<00:21,  1.44it/s] 25%|██▌       | 10/40 [00:06<00:20,  1.44it/s] 28%|██▊       | 11/40 [00:07<00:20,  1.44it/s] 30%|███       | 12/40 [00:08<00:19,  1.44it/s] 32%|███▎      | 13/40 [00:09<00:18,  1.45it/s] 35%|███▌      | 14/40 [00:09<00:18,  1.43it/s] 38%|███▊      | 15/40 [00:10<00:17,  1.44it/s] 40%|████      | 16/40 [00:11<00:16,  1.44it/s] 42%|████▎     | 17/40 [00:11<00:15,  1.44it/s] 45%|████▌     | 18/40 [00:12<00:15,  1.44it/s] 48%|████▊     | 19/40 [00:13<00:14,  1.44it/s] 50%|█████     | 20/40 [00:13<00:13,  1.45it/s] 52%|█████▎    | 21/40 [00:14<00:13,  1.45it/s] 55%|█████▌    | 22/40 [00:15<00:12,  1.44it/s] 57%|█████▊    | 23/40 [00:15<00:11,  1.45it/s] 60%|██████    | 24/40 [00:16<00:11,  1.44it/s] 62%|██████▎   | 25/40 [00:17<00:10,  1.44it/s] 65%|██████▌   | 26/40 [00:18<00:09,  1.45it/s] 68%|██████▊   | 27/40 [00:18<00:08,  1.45it/s] 70%|███████   | 28/40 [00:19<00:08,  1.44it/s] 72%|███████▎  | 29/40 [00:20<00:07,  1.44it/s] 75%|███████▌  | 30/40 [00:20<00:06,  1.45it/s] 78%|███████▊  | 31/40 [00:21<00:06,  1.44it/s] 80%|████████  | 32/40 [00:22<00:05,  1.45it/s] 82%|████████▎ | 33/40 [00:22<00:04,  1.45it/s] 85%|████████▌ | 34/40 [00:23<00:04,  1.45it/s] 88%|████████▊ | 35/40 [00:24<00:03,  1.45it/s] 90%|█████████ | 36/40 [00:24<00:02,  1.44it/s] 92%|█████████▎| 37/40 [00:25<00:02,  1.45it/s] 95%|█████████▌| 38/40 [00:26<00:01,  1.44it/s] 98%|█████████▊| 39/40 [00:27<00:00,  1.43it/s]100%|██████████| 40/40 [00:27<00:00,  1.58it/s]100%|██████████| 40/40 [00:27<00:00,  1.45it/s]
[32m2025-02-05 06:32:27.313[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    average  bleu@1  bleu@2  bleu@3  bleu@4  dist@1  dist@2  dist@3  dist@4  extreme  \
      .7797   .2977   .1134   .0454   .0237  .04223   .2980   .5765   .7329    .5996   
      f1  gen_loss  greedy  intra_dist@1  intra_dist@2  intra_dist@3  intra_dist@4  \
   .3504     5.258   .6665         .8597         .9561         .9477         .9192   
     ppl  rouge1  rouge2  rougeL  
   192.1   .3871  .09297   .3745[0m
[32m2025-02-05 06:32:27.321[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m163[0m - [1m[Conversation epoch 79][0m
[32m2025-02-05 06:32:27.321[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m164[0m - [1m[Train][0m
  0%|          | 0/92414 [00:00<?, ?it/s]100%|██████████| 92414/92414 [00:00<00:00, 999044.83it/s]
[32m2025-02-05 06:32:27.414[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/358 [00:00<?, ?it/s]  0%|          | 1/358 [00:00<00:36,  9.75it/s]  1%|          | 3/358 [00:00<00:35,  9.93it/s]  1%|          | 4/358 [00:00<00:35,  9.91it/s]  2%|▏         | 6/358 [00:00<00:35,  9.88it/s]  2%|▏         | 7/358 [00:00<00:35,  9.82it/s]  2%|▏         | 8/358 [00:00<00:35,  9.86it/s]  3%|▎         | 9/358 [00:00<00:35,  9.76it/s]  3%|▎         | 10/358 [00:01<00:35,  9.75it/s]  3%|▎         | 11/358 [00:01<00:35,  9.70it/s]  4%|▎         | 13/358 [00:01<00:34,  9.92it/s]  4%|▍         | 14/358 [00:01<00:34,  9.85it/s]  4%|▍         | 15/358 [00:01<00:35,  9.77it/s]  4%|▍         | 16/358 [00:01<00:35,  9.63it/s]  5%|▍         | 17/358 [00:01<00:35,  9.66it/s]  5%|▌         | 19/358 [00:01<00:34,  9.72it/s]  6%|▌         | 20/358 [00:02<00:34,  9.68it/s]  6%|▌         | 21/358 [00:02<00:35,  9.61it/s]  6%|▌         | 22/358 [00:02<00:34,  9.67it/s]  7%|▋         | 24/358 [00:02<00:34,  9.77it/s]  7%|▋         | 25/358 [00:02<00:34,  9.72it/s]  7%|▋         | 26/358 [00:02<00:34,  9.67it/s]  8%|▊         | 27/358 [00:02<00:34,  9.73it/s]  8%|▊         | 28/358 [00:02<00:34,  9.69it/s]  8%|▊         | 29/358 [00:02<00:34,  9.65it/s]  9%|▊         | 31/358 [00:03<00:33,  9.76it/s]  9%|▉         | 32/358 [00:03<00:33,  9.75it/s]  9%|▉         | 34/358 [00:03<00:32,  9.85it/s] 10%|█         | 36/358 [00:03<00:32,  9.85it/s] 10%|█         | 37/358 [00:03<00:32,  9.83it/s] 11%|█         | 38/358 [00:03<00:32,  9.78it/s] 11%|█         | 40/358 [00:04<00:31,  9.95it/s] 11%|█▏        | 41/358 [00:04<00:32,  9.86it/s] 12%|█▏        | 43/358 [00:04<00:31,  9.89it/s] 13%|█▎        | 45/358 [00:04<00:31,  9.99it/s] 13%|█▎        | 47/358 [00:04<00:31,  9.96it/s] 13%|█▎        | 48/358 [00:04<00:31,  9.95it/s] 14%|█▍        | 50/358 [00:05<00:31,  9.90it/s] 14%|█▍        | 51/358 [00:05<00:31,  9.83it/s] 15%|█▍        | 52/358 [00:05<00:31,  9.74it/s] 15%|█▍        | 53/358 [00:05<00:31,  9.70it/s] 15%|█▌        | 54/358 [00:05<00:31,  9.74it/s] 15%|█▌        | 55/358 [00:05<00:31,  9.69it/s] 16%|█▌        | 56/358 [00:05<00:31,  9.74it/s] 16%|█▌        | 57/358 [00:05<00:31,  9.70it/s] 16%|█▌        | 58/358 [00:05<00:31,  9.68it/s] 16%|█▋        | 59/358 [00:06<00:31,  9.64it/s] 17%|█▋        | 61/358 [00:06<00:30,  9.73it/s] 17%|█▋        | 62/358 [00:06<00:30,  9.65it/s] 18%|█▊        | 63/358 [00:06<00:30,  9.72it/s] 18%|█▊        | 64/358 [00:06<00:30,  9.67it/s] 18%|█▊        | 66/358 [00:06<00:29,  9.74it/s] 19%|█▊        | 67/358 [00:06<00:29,  9.72it/s] 19%|█▉        | 69/358 [00:07<00:29,  9.78it/s] 20%|█▉        | 70/358 [00:07<00:29,  9.73it/s] 20%|█▉        | 71/358 [00:07<00:29,  9.77it/s] 20%|██        | 72/358 [00:07<00:29,  9.72it/s] 20%|██        | 73/358 [00:07<00:29,  9.69it/s] 21%|██        | 74/358 [00:07<00:29,  9.66it/s] 21%|██        | 75/358 [00:07<00:29,  9.63it/s] 22%|██▏       | 77/358 [00:07<00:28,  9.71it/s] 22%|██▏       | 79/358 [00:08<00:28,  9.71it/s] 23%|██▎       | 81/358 [00:08<00:28,  9.76it/s] 23%|██▎       | 83/358 [00:08<00:28,  9.78it/s] 23%|██▎       | 84/358 [00:08<00:28,  9.74it/s] 24%|██▎       | 85/358 [00:08<00:28,  9.70it/s] 24%|██▍       | 86/358 [00:08<00:28,  9.68it/s] 24%|██▍       | 87/358 [00:08<00:28,  9.66it/s] 25%|██▍       | 88/358 [00:09<00:27,  9.68it/s] 25%|██▌       | 90/358 [00:09<00:27,  9.91it/s] 26%|██▌       | 92/358 [00:09<00:26, 10.01it/s] 26%|██▌       | 93/358 [00:09<00:26,  9.98it/s] 26%|██▋       | 94/358 [00:09<00:26,  9.89it/s] 27%|██▋       | 96/358 [00:09<00:25, 10.17it/s] 27%|██▋       | 98/358 [00:10<00:25, 10.06it/s] 28%|██▊       | 100/358 [00:10<00:25, 10.01it/s] 28%|██▊       | 101/358 [00:10<00:25,  9.92it/s] 29%|██▉       | 103/358 [00:10<00:25,  9.91it/s] 29%|██▉       | 104/358 [00:10<00:25,  9.87it/s] 29%|██▉       | 105/358 [00:10<00:25,  9.79it/s] 30%|██▉       | 106/358 [00:10<00:25,  9.77it/s] 30%|███       | 108/358 [00:11<00:25,  9.80it/s] 30%|███       | 109/358 [00:11<00:25,  9.72it/s] 31%|███       | 110/358 [00:11<00:25,  9.70it/s] 31%|███       | 111/358 [00:11<00:25,  9.65it/s] 32%|███▏      | 113/358 [00:11<00:24,  9.93it/s] 32%|███▏      | 114/358 [00:11<00:24,  9.88it/s] 32%|███▏      | 115/358 [00:11<00:24,  9.79it/s] 32%|███▏      | 116/358 [00:11<00:24,  9.71it/s] 33%|███▎      | 117/358 [00:11<00:24,  9.68it/s] 33%|███▎      | 119/358 [00:12<00:24,  9.80it/s] 34%|███▍      | 121/358 [00:12<00:23, 10.00it/s] 34%|███▍      | 123/358 [00:12<00:23, 10.09it/s] 35%|███▍      | 125/358 [00:12<00:23, 10.07it/s] 35%|███▌      | 127/358 [00:12<00:23,  9.99it/s] 36%|███▌      | 128/358 [00:13<00:23,  9.95it/s] 36%|███▋      | 130/358 [00:13<00:22, 10.00it/s] 37%|███▋      | 131/358 [00:13<00:22,  9.91it/s] 37%|███▋      | 132/358 [00:13<00:22,  9.93it/s] 37%|███▋      | 134/358 [00:13<00:22,  9.95it/s] 38%|███▊      | 135/358 [00:13<00:22,  9.89it/s] 38%|███▊      | 137/358 [00:13<00:22,  9.97it/s] 39%|███▊      | 138/358 [00:14<00:22,  9.95it/s] 39%|███▉      | 139/358 [00:14<00:22,  9.87it/s] 39%|███▉      | 141/358 [00:14<00:21,  9.99it/s] 40%|███▉      | 142/358 [00:14<00:21,  9.91it/s] 40%|███▉      | 143/358 [00:14<00:21,  9.88it/s] 40%|████      | 144/358 [00:14<00:21,  9.79it/s] 41%|████      | 145/358 [00:14<00:21,  9.81it/s] 41%|████      | 146/358 [00:14<00:21,  9.75it/s] 41%|████      | 147/358 [00:14<00:21,  9.69it/s] 41%|████▏     | 148/358 [00:15<00:21,  9.72it/s] 42%|████▏     | 149/358 [00:15<00:21,  9.70it/s] 42%|████▏     | 150/358 [00:15<00:21,  9.66it/s] 42%|████▏     | 151/358 [00:15<00:22,  9.39it/s] 42%|████▏     | 152/358 [00:15<00:21,  9.43it/s] 43%|████▎     | 153/358 [00:15<00:21,  9.46it/s] 43%|████▎     | 154/358 [00:15<00:21,  9.55it/s] 43%|████▎     | 155/358 [00:15<00:21,  9.56it/s] 44%|████▎     | 156/358 [00:15<00:20,  9.68it/s] 44%|████▍     | 157/358 [00:16<00:20,  9.62it/s] 44%|████▍     | 158/358 [00:16<00:20,  9.71it/s] 44%|████▍     | 159/358 [00:16<00:20,  9.70it/s] 45%|████▍     | 160/358 [00:16<00:20,  9.71it/s] 45%|████▌     | 162/358 [00:16<00:19, 10.01it/s] 46%|████▌     | 164/358 [00:16<00:19, 10.01it/s] 46%|████▌     | 165/358 [00:16<00:19,  9.97it/s] 47%|████▋     | 167/358 [00:17<00:19,  9.91it/s] 47%|████▋     | 169/358 [00:17<00:18,  9.95it/s] 48%|████▊     | 171/358 [00:17<00:18,  9.94it/s] 48%|████▊     | 172/358 [00:17<00:18,  9.88it/s] 48%|████▊     | 173/358 [00:17<00:18,  9.82it/s] 49%|████▉     | 175/358 [00:17<00:18,  9.85it/s] 49%|████▉     | 176/358 [00:17<00:18,  9.86it/s] 49%|████▉     | 177/358 [00:18<00:18,  9.85it/s] 50%|█████     | 179/358 [00:18<00:18,  9.87it/s] 50%|█████     | 180/358 [00:18<00:18,  9.80it/s] 51%|█████     | 182/358 [00:18<00:17,  9.95it/s] 51%|█████     | 183/358 [00:18<00:17,  9.90it/s] 51%|█████▏    | 184/358 [00:18<00:17,  9.79it/s] 52%|█████▏    | 185/358 [00:18<00:17,  9.74it/s] 52%|█████▏    | 187/358 [00:19<00:17,  9.95it/s] 53%|█████▎    | 188/358 [00:19<00:17,  9.90it/s] 53%|█████▎    | 189/358 [00:19<00:17,  9.84it/s] 53%|█████▎    | 191/358 [00:19<00:17,  9.76it/s] 54%|█████▎    | 192/358 [00:19<00:17,  9.71it/s] 54%|█████▍    | 193/358 [00:19<00:17,  9.70it/s] 54%|█████▍    | 194/358 [00:19<00:16,  9.68it/s] 54%|█████▍    | 195/358 [00:19<00:16,  9.75it/s] 55%|█████▌    | 197/358 [00:20<00:16,  9.92it/s] 55%|█████▌    | 198/358 [00:20<00:16,  9.85it/s] 56%|█████▌    | 199/358 [00:20<00:16,  9.88it/s] 56%|█████▌    | 200/358 [00:20<00:16,  9.81it/s] 56%|█████▌    | 201/358 [00:20<00:16,  9.77it/s] 57%|█████▋    | 203/358 [00:20<00:15,  9.86it/s] 57%|█████▋    | 204/358 [00:20<00:15,  9.76it/s] 57%|█████▋    | 205/358 [00:20<00:15,  9.72it/s] 58%|█████▊    | 207/358 [00:21<00:15,  9.88it/s] 58%|█████▊    | 208/358 [00:21<00:15,  9.81it/s] 59%|█████▊    | 210/358 [00:21<00:15,  9.83it/s] 59%|█████▉    | 212/358 [00:21<00:14,  9.82it/s] 60%|█████▉    | 214/358 [00:21<00:14,  9.90it/s] 60%|██████    | 215/358 [00:21<00:14,  9.84it/s] 60%|██████    | 216/358 [00:22<00:14,  9.77it/s] 61%|██████    | 217/358 [00:22<00:14,  9.81it/s] 61%|██████    | 218/358 [00:22<00:14,  9.78it/s] 61%|██████    | 219/358 [00:22<00:14,  9.78it/s] 62%|██████▏   | 221/358 [00:22<00:13,  9.92it/s] 62%|██████▏   | 222/358 [00:22<00:13,  9.81it/s] 62%|██████▏   | 223/358 [00:22<00:13,  9.76it/s] 63%|██████▎   | 224/358 [00:22<00:13,  9.70it/s] 63%|██████▎   | 226/358 [00:23<00:13,  9.75it/s] 64%|██████▎   | 228/358 [00:23<00:13,  9.77it/s] 64%|██████▍   | 229/358 [00:23<00:13,  9.75it/s] 64%|██████▍   | 230/358 [00:23<00:13,  9.70it/s] 65%|██████▍   | 232/358 [00:23<00:12,  9.74it/s] 65%|██████▌   | 234/358 [00:23<00:12, 10.02it/s] 66%|██████▌   | 236/358 [00:24<00:12,  9.99it/s] 66%|██████▋   | 238/358 [00:24<00:11, 10.04it/s] 67%|██████▋   | 240/358 [00:24<00:11, 10.00it/s] 68%|██████▊   | 242/358 [00:24<00:11,  9.98it/s] 68%|██████▊   | 243/358 [00:24<00:11,  9.92it/s] 68%|██████▊   | 244/358 [00:24<00:11,  9.85it/s] 69%|██████▊   | 246/358 [00:25<00:11,  9.88it/s] 69%|██████▉   | 247/358 [00:25<00:11,  9.81it/s] 69%|██████▉   | 248/358 [00:25<00:11,  9.76it/s] 70%|██████▉   | 250/358 [00:25<00:10,  9.86it/s] 70%|███████   | 251/358 [00:25<00:10,  9.79it/s] 70%|███████   | 252/358 [00:25<00:10,  9.73it/s] 71%|███████   | 253/358 [00:25<00:10,  9.69it/s] 71%|███████   | 254/358 [00:25<00:10,  9.66it/s] 72%|███████▏  | 256/358 [00:26<00:10,  9.84it/s] 72%|███████▏  | 257/358 [00:26<00:10,  9.85it/s] 72%|███████▏  | 258/358 [00:26<00:10,  9.72it/s] 72%|███████▏  | 259/358 [00:26<00:10,  9.69it/s] 73%|███████▎  | 260/358 [00:26<00:10,  9.72it/s] 73%|███████▎  | 262/358 [00:26<00:09,  9.90it/s] 74%|███████▎  | 264/358 [00:26<00:09,  9.92it/s] 74%|███████▍  | 266/358 [00:27<00:09,  9.92it/s] 75%|███████▍  | 267/358 [00:27<00:09,  9.85it/s] 75%|███████▌  | 269/358 [00:27<00:08,  9.91it/s] 75%|███████▌  | 270/358 [00:27<00:08,  9.84it/s] 76%|███████▌  | 271/358 [00:27<00:08,  9.77it/s] 76%|███████▌  | 272/358 [00:27<00:08,  9.75it/s] 76%|███████▋  | 273/358 [00:27<00:08,  9.64it/s] 77%|███████▋  | 274/358 [00:27<00:08,  9.64it/s] 77%|███████▋  | 275/358 [00:28<00:08,  9.69it/s] 77%|███████▋  | 276/358 [00:28<00:08,  9.69it/s] 77%|███████▋  | 277/358 [00:28<00:08,  9.66it/s] 78%|███████▊  | 278/358 [00:28<00:08,  9.64it/s] 78%|███████▊  | 280/358 [00:28<00:07,  9.83it/s] 78%|███████▊  | 281/358 [00:28<00:07,  9.84it/s] 79%|███████▉  | 282/358 [00:28<00:07,  9.78it/s] 79%|███████▉  | 283/358 [00:28<00:07,  9.71it/s] 79%|███████▉  | 284/358 [00:28<00:07,  9.68it/s] 80%|███████▉  | 285/358 [00:29<00:07,  9.74it/s] 80%|███████▉  | 286/358 [00:29<00:07,  9.70it/s] 80%|████████  | 287/358 [00:29<00:07,  9.68it/s] 80%|████████  | 288/358 [00:29<00:07,  9.63it/s] 81%|████████  | 290/358 [00:29<00:06,  9.85it/s] 81%|████████▏ | 291/358 [00:29<00:06,  9.83it/s] 82%|████████▏ | 293/358 [00:29<00:06,  9.84it/s] 82%|████████▏ | 295/358 [00:30<00:06,  9.92it/s] 83%|████████▎ | 296/358 [00:30<00:06,  9.86it/s] 83%|████████▎ | 297/358 [00:30<00:06,  9.75it/s] 84%|████████▎ | 299/358 [00:30<00:05,  9.91it/s] 84%|████████▍ | 301/358 [00:30<00:05,  9.94it/s] 84%|████████▍ | 302/358 [00:30<00:05,  9.88it/s] 85%|████████▍ | 303/358 [00:30<00:05,  9.88it/s] 85%|████████▌ | 305/358 [00:31<00:05,  9.91it/s] 85%|████████▌ | 306/358 [00:31<00:05,  9.83it/s] 86%|████████▌ | 308/358 [00:31<00:05,  9.93it/s] 86%|████████▋ | 309/358 [00:31<00:04,  9.83it/s] 87%|████████▋ | 310/358 [00:31<00:04,  9.77it/s] 87%|████████▋ | 311/358 [00:31<00:04,  9.70it/s] 87%|████████▋ | 312/358 [00:31<00:04,  9.72it/s] 87%|████████▋ | 313/358 [00:31<00:04,  9.74it/s] 88%|████████▊ | 315/358 [00:32<00:04, 10.00it/s] 88%|████████▊ | 316/358 [00:32<00:04,  9.95it/s] 89%|████████▊ | 317/358 [00:32<00:04,  9.86it/s] 89%|████████▉ | 318/358 [00:32<00:04,  9.81it/s] 89%|████████▉ | 319/358 [00:32<00:03,  9.76it/s] 89%|████████▉ | 320/358 [00:32<00:03,  9.82it/s] 90%|████████▉ | 321/358 [00:32<00:03,  9.75it/s] 90%|████████▉ | 322/358 [00:32<00:03,  9.71it/s] 90%|█████████ | 323/358 [00:32<00:03,  9.67it/s] 91%|█████████ | 324/358 [00:33<00:03,  9.64it/s] 91%|█████████ | 325/358 [00:33<00:03,  9.62it/s] 91%|█████████▏| 327/358 [00:33<00:03,  9.98it/s] 92%|█████████▏| 329/358 [00:33<00:02, 10.08it/s] 92%|█████████▏| 330/358 [00:33<00:02,  9.97it/s] 93%|█████████▎| 332/358 [00:33<00:02, 10.07it/s] 93%|█████████▎| 334/358 [00:34<00:02,  9.97it/s] 94%|█████████▎| 335/358 [00:34<00:02,  9.85it/s] 94%|█████████▍| 337/358 [00:34<00:02,  9.92it/s] 95%|█████████▍| 339/358 [00:34<00:01, 10.13it/s] 95%|█████████▌| 341/358 [00:34<00:01, 10.07it/s] 96%|█████████▌| 343/358 [00:34<00:01,  9.91it/s] 96%|█████████▌| 344/358 [00:35<00:01,  9.85it/s] 96%|█████████▋| 345/358 [00:35<00:01,  9.87it/s] 97%|█████████▋| 347/358 [00:35<00:01, 10.05it/s] 97%|█████████▋| 349/358 [00:35<00:00,  9.89it/s] 98%|█████████▊| 350/358 [00:35<00:00,  9.83it/s] 98%|█████████▊| 351/358 [00:35<00:00,  9.78it/s] 99%|█████████▊| 353/358 [00:35<00:00,  9.94it/s] 99%|█████████▉| 354/358 [00:36<00:00,  9.92it/s] 99%|█████████▉| 355/358 [00:36<00:00,  9.83it/s]100%|█████████▉| 357/358 [00:36<00:00,  9.88it/s]100%|██████████| 358/358 [00:36<00:00,  9.83it/s]
[32m2025-02-05 06:33:03.827[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    gen_loss  grad clip ratio  grad norm   ppl
       1.752                1      2.934 5.767[0m
[32m2025-02-05 06:33:03.828[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m169[0m - [1m[Valid][0m
  0%|          | 0/10256 [00:00<?, ?it/s]100%|██████████| 10256/10256 [00:00<00:00, 1050342.62it/s]
[32m2025-02-05 06:33:03.838[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:27,  1.41it/s]  5%|▌         | 2/40 [00:01<00:26,  1.43it/s]  8%|▊         | 3/40 [00:02<00:25,  1.44it/s] 10%|█         | 4/40 [00:02<00:25,  1.44it/s] 12%|█▎        | 5/40 [00:03<00:24,  1.43it/s] 15%|█▌        | 6/40 [00:04<00:23,  1.43it/s] 18%|█▊        | 7/40 [00:04<00:23,  1.43it/s] 20%|██        | 8/40 [00:05<00:22,  1.44it/s] 22%|██▎       | 9/40 [00:06<00:21,  1.44it/s] 25%|██▌       | 10/40 [00:06<00:20,  1.45it/s] 28%|██▊       | 11/40 [00:07<00:20,  1.44it/s] 30%|███       | 12/40 [00:08<00:19,  1.44it/s] 32%|███▎      | 13/40 [00:09<00:18,  1.44it/s] 35%|███▌      | 14/40 [00:09<00:18,  1.44it/s] 38%|███▊      | 15/40 [00:10<00:17,  1.44it/s] 40%|████      | 16/40 [00:11<00:16,  1.44it/s] 42%|████▎     | 17/40 [00:11<00:15,  1.44it/s] 45%|████▌     | 18/40 [00:12<00:15,  1.45it/s] 48%|████▊     | 19/40 [00:13<00:14,  1.44it/s] 50%|█████     | 20/40 [00:13<00:13,  1.45it/s] 52%|█████▎    | 21/40 [00:14<00:13,  1.45it/s] 55%|█████▌    | 22/40 [00:15<00:12,  1.45it/s] 57%|█████▊    | 23/40 [00:15<00:11,  1.45it/s] 60%|██████    | 24/40 [00:16<00:11,  1.44it/s] 62%|██████▎   | 25/40 [00:17<00:10,  1.44it/s] 65%|██████▌   | 26/40 [00:18<00:09,  1.45it/s] 68%|██████▊   | 27/40 [00:18<00:08,  1.45it/s] 70%|███████   | 28/40 [00:19<00:08,  1.45it/s] 72%|███████▎  | 29/40 [00:20<00:07,  1.45it/s] 75%|███████▌  | 30/40 [00:20<00:06,  1.45it/s] 78%|███████▊  | 31/40 [00:21<00:06,  1.45it/s] 80%|████████  | 32/40 [00:22<00:05,  1.45it/s] 82%|████████▎ | 33/40 [00:22<00:04,  1.45it/s] 85%|████████▌ | 34/40 [00:23<00:04,  1.44it/s] 88%|████████▊ | 35/40 [00:24<00:03,  1.44it/s] 90%|█████████ | 36/40 [00:24<00:02,  1.43it/s] 92%|█████████▎| 37/40 [00:25<00:02,  1.44it/s] 95%|█████████▌| 38/40 [00:26<00:01,  1.43it/s] 98%|█████████▊| 39/40 [00:27<00:00,  1.43it/s]100%|██████████| 40/40 [00:27<00:00,  1.58it/s]100%|██████████| 40/40 [00:27<00:00,  1.45it/s]
[32m2025-02-05 06:33:31.376[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    average  bleu@1  bleu@2  bleu@3  bleu@4  dist@1  dist@2  dist@3  dist@4  extreme  \
      .7836   .3039   .1155  .04579  .02341  .04035   .2836   .5485   .7031    .6020   
      f1  gen_loss  greedy  intra_dist@1  intra_dist@2  intra_dist@3  intra_dist@4  \
   .3532     5.359   .6718         .8543         .9569         .9513         .9239   
     ppl  rouge1  rouge2  rougeL  
   212.6   .3934  .09412   .3802[0m
[32m2025-02-05 06:33:31.384[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m163[0m - [1m[Conversation epoch 80][0m
[32m2025-02-05 06:33:31.384[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m164[0m - [1m[Train][0m
  0%|          | 0/92414 [00:00<?, ?it/s]100%|██████████| 92414/92414 [00:00<00:00, 998226.66it/s]
[32m2025-02-05 06:33:31.477[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/358 [00:00<?, ?it/s]  0%|          | 1/358 [00:00<00:36,  9.76it/s]  1%|          | 3/358 [00:00<00:35,  9.94it/s]  1%|          | 4/358 [00:00<00:35,  9.91it/s]  2%|▏         | 6/358 [00:00<00:35,  9.88it/s]  2%|▏         | 7/358 [00:00<00:35,  9.81it/s]  2%|▏         | 8/358 [00:00<00:35,  9.86it/s]  3%|▎         | 9/358 [00:00<00:35,  9.76it/s]  3%|▎         | 10/358 [00:01<00:35,  9.75it/s]  3%|▎         | 11/358 [00:01<00:35,  9.70it/s]  4%|▎         | 13/358 [00:01<00:34,  9.92it/s]  4%|▍         | 14/358 [00:01<00:34,  9.85it/s]  4%|▍         | 15/358 [00:01<00:35,  9.77it/s]  4%|▍         | 16/358 [00:01<00:35,  9.71it/s]  5%|▍         | 17/358 [00:01<00:35,  9.73it/s]  5%|▌         | 19/358 [00:01<00:34,  9.75it/s]  6%|▌         | 20/358 [00:02<00:34,  9.70it/s]  6%|▌         | 21/358 [00:02<00:34,  9.64it/s]  6%|▌         | 22/358 [00:02<00:34,  9.69it/s]  7%|▋         | 24/358 [00:02<00:34,  9.78it/s]  7%|▋         | 25/358 [00:02<00:34,  9.73it/s]  7%|▋         | 26/358 [00:02<00:34,  9.68it/s]  8%|▊         | 27/358 [00:02<00:34,  9.73it/s]  8%|▊         | 28/358 [00:02<00:34,  9.68it/s]  8%|▊         | 29/358 [00:02<00:34,  9.65it/s]  9%|▊         | 31/358 [00:03<00:33,  9.75it/s]  9%|▉         | 32/358 [00:03<00:33,  9.75it/s]  9%|▉         | 34/358 [00:03<00:32,  9.85it/s] 10%|█         | 36/358 [00:03<00:32,  9.85it/s] 10%|█         | 37/358 [00:03<00:32,  9.83it/s] 11%|█         | 38/358 [00:03<00:32,  9.79it/s] 11%|█         | 40/358 [00:04<00:31,  9.95it/s] 11%|█▏        | 41/358 [00:04<00:32,  9.86it/s] 12%|█▏        | 43/358 [00:04<00:31,  9.89it/s] 13%|█▎        | 45/358 [00:04<00:31,  9.98it/s] 13%|█▎        | 47/358 [00:04<00:31,  9.96it/s] 13%|█▎        | 48/358 [00:04<00:31,  9.94it/s] 14%|█▍        | 50/358 [00:05<00:31,  9.92it/s] 14%|█▍        | 51/358 [00:05<00:31,  9.85it/s] 15%|█▍        | 52/358 [00:05<00:31,  9.76it/s] 15%|█▍        | 53/358 [00:05<00:31,  9.70it/s] 15%|█▌        | 54/358 [00:05<00:31,  9.75it/s] 15%|█▌        | 55/358 [00:05<00:31,  9.69it/s] 16%|█▌        | 56/358 [00:05<00:31,  9.74it/s] 16%|█▌        | 57/358 [00:05<00:31,  9.70it/s] 16%|█▌        | 58/358 [00:05<00:31,  9.67it/s] 16%|█▋        | 59/358 [00:06<00:30,  9.65it/s] 17%|█▋        | 61/358 [00:06<00:30,  9.73it/s] 17%|█▋        | 62/358 [00:06<00:30,  9.65it/s] 18%|█▊        | 63/358 [00:06<00:30,  9.72it/s] 18%|█▊        | 64/358 [00:06<00:30,  9.67it/s] 18%|█▊        | 66/358 [00:06<00:29,  9.74it/s] 19%|█▊        | 67/358 [00:06<00:29,  9.72it/s] 19%|█▉        | 69/358 [00:07<00:29,  9.79it/s] 20%|█▉        | 70/358 [00:07<00:29,  9.73it/s] 20%|█▉        | 71/358 [00:07<00:29,  9.78it/s] 20%|██        | 72/358 [00:07<00:29,  9.73it/s] 20%|██        | 73/358 [00:07<00:29,  9.70it/s] 21%|██        | 74/358 [00:07<00:29,  9.66it/s] 21%|██        | 75/358 [00:07<00:29,  9.63it/s] 22%|██▏       | 77/358 [00:07<00:28,  9.71it/s] 22%|██▏       | 79/358 [00:08<00:28,  9.71it/s] 23%|██▎       | 81/358 [00:08<00:28,  9.76it/s] 23%|██▎       | 83/358 [00:08<00:28,  9.79it/s] 23%|██▎       | 84/358 [00:08<00:28,  9.74it/s] 24%|██▎       | 85/358 [00:08<00:28,  9.69it/s] 24%|██▍       | 86/358 [00:08<00:28,  9.68it/s] 24%|██▍       | 87/358 [00:08<00:28,  9.66it/s] 25%|██▍       | 88/358 [00:09<00:27,  9.68it/s] 25%|██▌       | 90/358 [00:09<00:27,  9.91it/s] 26%|██▌       | 92/358 [00:09<00:26, 10.01it/s] 26%|██▌       | 93/358 [00:09<00:26,  9.98it/s] 26%|██▋       | 94/358 [00:09<00:26,  9.89it/s] 27%|██▋       | 96/358 [00:09<00:25, 10.17it/s] 27%|██▋       | 98/358 [00:09<00:25, 10.06it/s] 28%|██▊       | 100/358 [00:10<00:25, 10.01it/s] 28%|██▊       | 101/358 [00:10<00:25,  9.92it/s] 29%|██▉       | 103/358 [00:10<00:25,  9.91it/s] 29%|██▉       | 104/358 [00:10<00:25,  9.87it/s] 29%|██▉       | 105/358 [00:10<00:25,  9.79it/s] 30%|██▉       | 106/358 [00:10<00:25,  9.77it/s] 30%|███       | 108/358 [00:11<00:25,  9.80it/s] 30%|███       | 109/358 [00:11<00:25,  9.71it/s] 31%|███       | 110/358 [00:11<00:25,  9.70it/s] 31%|███       | 111/358 [00:11<00:25,  9.65it/s] 32%|███▏      | 113/358 [00:11<00:24,  9.92it/s] 32%|███▏      | 114/358 [00:11<00:24,  9.88it/s] 32%|███▏      | 115/358 [00:11<00:24,  9.78it/s] 32%|███▏      | 116/358 [00:11<00:24,  9.70it/s] 33%|███▎      | 117/358 [00:11<00:24,  9.67it/s] 33%|███▎      | 119/358 [00:12<00:24,  9.79it/s] 34%|███▍      | 121/358 [00:12<00:23,  9.99it/s] 34%|███▍      | 123/358 [00:12<00:23, 10.09it/s] 35%|███▍      | 125/358 [00:12<00:23, 10.07it/s] 35%|███▌      | 127/358 [00:12<00:23,  9.99it/s] 36%|███▌      | 128/358 [00:13<00:23,  9.95it/s] 36%|███▋      | 130/358 [00:13<00:22, 10.00it/s] 37%|███▋      | 131/358 [00:13<00:22,  9.91it/s] 37%|███▋      | 132/358 [00:13<00:22,  9.93it/s] 37%|███▋      | 134/358 [00:13<00:22,  9.94it/s] 38%|███▊      | 135/358 [00:13<00:22,  9.88it/s] 38%|███▊      | 137/358 [00:13<00:22,  9.97it/s] 39%|███▊      | 138/358 [00:14<00:22,  9.95it/s] 39%|███▉      | 139/358 [00:14<00:22,  9.86it/s] 39%|███▉      | 141/358 [00:14<00:21,  9.99it/s] 40%|███▉      | 142/358 [00:14<00:21,  9.91it/s] 40%|███▉      | 143/358 [00:14<00:21,  9.88it/s] 40%|████      | 144/358 [00:14<00:21,  9.79it/s] 41%|████      | 145/358 [00:14<00:21,  9.81it/s] 41%|████      | 146/358 [00:14<00:21,  9.75it/s] 41%|████      | 147/358 [00:14<00:21,  9.69it/s] 41%|████▏     | 148/358 [00:15<00:21,  9.72it/s] 42%|████▏     | 149/358 [00:15<00:21,  9.70it/s] 42%|████▏     | 150/358 [00:15<00:21,  9.66it/s] 42%|████▏     | 151/358 [00:15<00:22,  9.39it/s] 42%|████▏     | 152/358 [00:15<00:21,  9.44it/s] 43%|████▎     | 153/358 [00:15<00:21,  9.46it/s] 43%|████▎     | 154/358 [00:15<00:21,  9.55it/s] 43%|████▎     | 155/358 [00:15<00:21,  9.56it/s] 44%|████▎     | 156/358 [00:15<00:20,  9.68it/s] 44%|████▍     | 157/358 [00:16<00:20,  9.63it/s] 44%|████▍     | 158/358 [00:16<00:20,  9.71it/s] 44%|████▍     | 159/358 [00:16<00:20,  9.71it/s] 45%|████▍     | 160/358 [00:16<00:20,  9.72it/s] 45%|████▌     | 162/358 [00:16<00:19, 10.01it/s] 46%|████▌     | 164/358 [00:16<00:19, 10.01it/s] 46%|████▌     | 165/358 [00:16<00:19,  9.97it/s] 47%|████▋     | 167/358 [00:17<00:19,  9.92it/s] 47%|████▋     | 169/358 [00:17<00:18,  9.95it/s] 48%|████▊     | 171/358 [00:17<00:18,  9.92it/s] 48%|████▊     | 172/358 [00:17<00:18,  9.87it/s] 48%|████▊     | 173/358 [00:17<00:18,  9.80it/s] 49%|████▉     | 175/358 [00:17<00:18,  9.83it/s] 49%|████▉     | 176/358 [00:17<00:18,  9.84it/s] 49%|████▉     | 177/358 [00:18<00:18,  9.83it/s] 50%|█████     | 179/358 [00:18<00:18,  9.85it/s] 50%|█████     | 180/358 [00:18<00:18,  9.78it/s] 51%|█████     | 182/358 [00:18<00:17,  9.93it/s] 51%|█████     | 183/358 [00:18<00:17,  9.88it/s] 51%|█████▏    | 184/358 [00:18<00:17,  9.77it/s] 52%|█████▏    | 185/358 [00:18<00:17,  9.72it/s] 52%|█████▏    | 187/358 [00:19<00:17,  9.94it/s] 53%|█████▎    | 188/358 [00:19<00:17,  9.89it/s] 53%|█████▎    | 189/358 [00:19<00:17,  9.83it/s] 53%|█████▎    | 191/358 [00:19<00:17,  9.75it/s] 54%|█████▎    | 192/358 [00:19<00:17,  9.70it/s] 54%|█████▍    | 193/358 [00:19<00:17,  9.70it/s] 54%|█████▍    | 194/358 [00:19<00:16,  9.68it/s] 54%|█████▍    | 195/358 [00:19<00:16,  9.74it/s] 55%|█████▌    | 197/358 [00:20<00:16,  9.92it/s] 55%|█████▌    | 198/358 [00:20<00:16,  9.85it/s] 56%|█████▌    | 199/358 [00:20<00:16,  9.88it/s] 56%|█████▌    | 200/358 [00:20<00:16,  9.81it/s] 56%|█████▌    | 201/358 [00:20<00:16,  9.77it/s] 57%|█████▋    | 203/358 [00:20<00:15,  9.86it/s] 57%|█████▋    | 204/358 [00:20<00:15,  9.76it/s] 57%|█████▋    | 205/358 [00:20<00:15,  9.71it/s] 58%|█████▊    | 207/358 [00:21<00:15,  9.88it/s] 58%|█████▊    | 208/358 [00:21<00:15,  9.82it/s] 59%|█████▊    | 210/358 [00:21<00:15,  9.83it/s] 59%|█████▉    | 212/358 [00:21<00:14,  9.82it/s] 60%|█████▉    | 214/358 [00:21<00:14,  9.90it/s] 60%|██████    | 215/358 [00:21<00:14,  9.84it/s] 60%|██████    | 216/358 [00:22<00:14,  9.77it/s] 61%|██████    | 217/358 [00:22<00:14,  9.81it/s] 61%|██████    | 218/358 [00:22<00:14,  9.78it/s] 61%|██████    | 219/358 [00:22<00:14,  9.78it/s] 62%|██████▏   | 221/358 [00:22<00:13,  9.91it/s] 62%|██████▏   | 222/358 [00:22<00:13,  9.81it/s] 62%|██████▏   | 223/358 [00:22<00:13,  9.75it/s] 63%|██████▎   | 224/358 [00:22<00:13,  9.69it/s] 63%|██████▎   | 226/358 [00:23<00:13,  9.74it/s] 64%|██████▎   | 228/358 [00:23<00:13,  9.77it/s] 64%|██████▍   | 229/358 [00:23<00:13,  9.74it/s] 64%|██████▍   | 230/358 [00:23<00:13,  9.69it/s] 65%|██████▍   | 232/358 [00:23<00:12,  9.74it/s] 65%|██████▌   | 234/358 [00:23<00:12, 10.03it/s] 66%|██████▌   | 236/358 [00:24<00:12,  9.98it/s] 66%|██████▋   | 238/358 [00:24<00:11, 10.04it/s] 67%|██████▋   | 240/358 [00:24<00:11, 10.00it/s] 68%|██████▊   | 242/358 [00:24<00:11,  9.98it/s] 68%|██████▊   | 243/358 [00:24<00:11,  9.92it/s] 68%|██████▊   | 244/358 [00:24<00:11,  9.85it/s] 69%|██████▊   | 246/358 [00:25<00:11,  9.87it/s] 69%|██████▉   | 247/358 [00:25<00:11,  9.80it/s] 69%|██████▉   | 248/358 [00:25<00:11,  9.76it/s] 70%|██████▉   | 250/358 [00:25<00:10,  9.86it/s] 70%|███████   | 251/358 [00:25<00:10,  9.80it/s] 70%|███████   | 252/358 [00:25<00:10,  9.73it/s] 71%|███████   | 253/358 [00:25<00:10,  9.69it/s] 71%|███████   | 254/358 [00:25<00:10,  9.67it/s] 72%|███████▏  | 256/358 [00:26<00:10,  9.84it/s] 72%|███████▏  | 257/358 [00:26<00:10,  9.85it/s] 72%|███████▏  | 258/358 [00:26<00:10,  9.72it/s] 72%|███████▏  | 259/358 [00:26<00:10,  9.68it/s] 73%|███████▎  | 260/358 [00:26<00:10,  9.72it/s] 73%|███████▎  | 262/358 [00:26<00:09,  9.90it/s] 74%|███████▎  | 264/358 [00:26<00:09,  9.92it/s] 74%|███████▍  | 266/358 [00:27<00:09,  9.91it/s] 75%|███████▍  | 267/358 [00:27<00:09,  9.85it/s] 75%|███████▌  | 269/358 [00:27<00:08,  9.90it/s] 75%|███████▌  | 270/358 [00:27<00:08,  9.83it/s] 76%|███████▌  | 271/358 [00:27<00:08,  9.76it/s] 76%|███████▌  | 272/358 [00:27<00:08,  9.74it/s] 76%|███████▋  | 273/358 [00:27<00:08,  9.64it/s] 77%|███████▋  | 274/358 [00:27<00:08,  9.63it/s] 77%|███████▋  | 275/358 [00:28<00:08,  9.68it/s] 77%|███████▋  | 276/358 [00:28<00:08,  9.69it/s] 77%|███████▋  | 277/358 [00:28<00:08,  9.66it/s] 78%|███████▊  | 278/358 [00:28<00:08,  9.64it/s] 78%|███████▊  | 280/358 [00:28<00:07,  9.83it/s] 78%|███████▊  | 281/358 [00:28<00:07,  9.84it/s] 79%|███████▉  | 282/358 [00:28<00:07,  9.78it/s] 79%|███████▉  | 283/358 [00:28<00:07,  9.72it/s] 79%|███████▉  | 284/358 [00:28<00:07,  9.68it/s] 80%|███████▉  | 285/358 [00:29<00:07,  9.75it/s] 80%|███████▉  | 286/358 [00:29<00:07,  9.70it/s] 80%|████████  | 287/358 [00:29<00:07,  9.68it/s] 80%|████████  | 288/358 [00:29<00:07,  9.64it/s] 81%|████████  | 290/358 [00:29<00:06,  9.85it/s] 81%|████████▏ | 291/358 [00:29<00:06,  9.83it/s] 82%|████████▏ | 293/358 [00:29<00:06,  9.84it/s] 82%|████████▏ | 295/358 [00:30<00:06,  9.91it/s] 83%|████████▎ | 296/358 [00:30<00:06,  9.85it/s] 83%|████████▎ | 297/358 [00:30<00:06,  9.74it/s] 84%|████████▎ | 299/358 [00:30<00:05,  9.91it/s] 84%|████████▍ | 301/358 [00:30<00:05,  9.94it/s] 84%|████████▍ | 302/358 [00:30<00:05,  9.88it/s] 85%|████████▍ | 303/358 [00:30<00:05,  9.88it/s] 85%|████████▌ | 305/358 [00:31<00:05,  9.91it/s] 85%|████████▌ | 306/358 [00:31<00:05,  9.83it/s] 86%|████████▌ | 308/358 [00:31<00:05,  9.93it/s] 86%|████████▋ | 309/358 [00:31<00:04,  9.83it/s] 87%|████████▋ | 310/358 [00:31<00:04,  9.78it/s] 87%|████████▋ | 311/358 [00:31<00:04,  9.70it/s] 87%|████████▋ | 312/358 [00:31<00:04,  9.71it/s] 87%|████████▋ | 313/358 [00:31<00:04,  9.74it/s] 88%|████████▊ | 315/358 [00:32<00:04,  9.99it/s] 88%|████████▊ | 316/358 [00:32<00:04,  9.94it/s] 89%|████████▊ | 317/358 [00:32<00:04,  9.86it/s] 89%|████████▉ | 318/358 [00:32<00:04,  9.81it/s] 89%|████████▉ | 319/358 [00:32<00:03,  9.77it/s] 89%|████████▉ | 320/358 [00:32<00:03,  9.82it/s] 90%|████████▉ | 321/358 [00:32<00:03,  9.75it/s] 90%|████████▉ | 322/358 [00:32<00:03,  9.71it/s] 90%|█████████ | 323/358 [00:32<00:03,  9.66it/s] 91%|█████████ | 324/358 [00:33<00:03,  9.63it/s] 91%|█████████ | 325/358 [00:33<00:03,  9.62it/s] 91%|█████████▏| 327/358 [00:33<00:03,  9.97it/s] 92%|█████████▏| 329/358 [00:33<00:02, 10.08it/s] 92%|█████████▏| 330/358 [00:33<00:02,  9.96it/s] 93%|█████████▎| 332/358 [00:33<00:02, 10.06it/s] 93%|█████████▎| 334/358 [00:34<00:02,  9.97it/s] 94%|█████████▎| 335/358 [00:34<00:02,  9.84it/s] 94%|█████████▍| 337/358 [00:34<00:02,  9.93it/s] 95%|█████████▍| 339/358 [00:34<00:01, 10.12it/s] 95%|█████████▌| 341/358 [00:34<00:01, 10.07it/s] 96%|█████████▌| 343/358 [00:34<00:01,  9.90it/s] 96%|█████████▌| 344/358 [00:35<00:01,  9.84it/s] 96%|█████████▋| 345/358 [00:35<00:01,  9.86it/s] 97%|█████████▋| 347/358 [00:35<00:01, 10.04it/s] 97%|█████████▋| 348/358 [00:35<00:01,  9.95it/s] 97%|█████████▋| 349/358 [00:35<00:00,  9.87it/s] 98%|█████████▊| 350/358 [00:35<00:00,  9.80it/s] 98%|█████████▊| 351/358 [00:35<00:00,  9.75it/s] 99%|█████████▊| 353/358 [00:35<00:00,  9.93it/s] 99%|█████████▉| 354/358 [00:36<00:00,  9.91it/s] 99%|█████████▉| 355/358 [00:36<00:00,  9.83it/s]100%|█████████▉| 357/358 [00:36<00:00,  9.88it/s]100%|██████████| 358/358 [00:36<00:00,  9.83it/s]
[32m2025-02-05 06:34:07.892[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    gen_loss  grad clip ratio  grad norm   ppl
       1.749                1      4.138 5.746[0m
[32m2025-02-05 06:34:07.892[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m169[0m - [1m[Valid][0m
  0%|          | 0/10256 [00:00<?, ?it/s]100%|██████████| 10256/10256 [00:00<00:00, 1087793.19it/s]
[32m2025-02-05 06:34:07.902[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:27,  1.44it/s]  5%|▌         | 2/40 [00:01<00:26,  1.45it/s]  8%|▊         | 3/40 [00:02<00:25,  1.45it/s] 10%|█         | 4/40 [00:02<00:24,  1.46it/s] 12%|█▎        | 5/40 [00:03<00:24,  1.45it/s] 15%|█▌        | 6/40 [00:04<00:23,  1.45it/s] 18%|█▊        | 7/40 [00:04<00:22,  1.44it/s] 20%|██        | 8/40 [00:05<00:22,  1.45it/s] 22%|██▎       | 9/40 [00:06<00:21,  1.45it/s] 25%|██▌       | 10/40 [00:06<00:20,  1.46it/s] 28%|██▊       | 11/40 [00:07<00:19,  1.46it/s] 30%|███       | 12/40 [00:08<00:19,  1.46it/s] 32%|███▎      | 13/40 [00:08<00:18,  1.46it/s] 35%|███▌      | 14/40 [00:09<00:17,  1.45it/s] 38%|███▊      | 15/40 [00:10<00:17,  1.45it/s] 40%|████      | 16/40 [00:11<00:16,  1.45it/s] 42%|████▎     | 17/40 [00:11<00:15,  1.46it/s] 45%|████▌     | 18/40 [00:12<00:15,  1.46it/s] 48%|████▊     | 19/40 [00:13<00:14,  1.45it/s] 50%|█████     | 20/40 [00:13<00:13,  1.46it/s] 52%|█████▎    | 21/40 [00:14<00:12,  1.47it/s] 55%|█████▌    | 22/40 [00:15<00:12,  1.46it/s] 57%|█████▊    | 23/40 [00:15<00:11,  1.46it/s] 60%|██████    | 24/40 [00:16<00:11,  1.45it/s] 62%|██████▎   | 25/40 [00:17<00:10,  1.45it/s] 65%|██████▌   | 26/40 [00:17<00:09,  1.46it/s] 68%|██████▊   | 27/40 [00:18<00:08,  1.46it/s] 70%|███████   | 28/40 [00:19<00:08,  1.46it/s] 72%|███████▎  | 29/40 [00:19<00:07,  1.46it/s] 75%|███████▌  | 30/40 [00:20<00:06,  1.46it/s] 78%|███████▊  | 31/40 [00:21<00:06,  1.46it/s] 80%|████████  | 32/40 [00:21<00:05,  1.46it/s] 82%|████████▎ | 33/40 [00:22<00:04,  1.45it/s] 85%|████████▌ | 34/40 [00:23<00:04,  1.46it/s] 88%|████████▊ | 35/40 [00:24<00:03,  1.46it/s] 90%|█████████ | 36/40 [00:24<00:02,  1.45it/s] 92%|█████████▎| 37/40 [00:25<00:02,  1.45it/s] 95%|█████████▌| 38/40 [00:26<00:01,  1.44it/s] 98%|█████████▊| 39/40 [00:26<00:00,  1.44it/s]100%|██████████| 40/40 [00:27<00:00,  1.60it/s]100%|██████████| 40/40 [00:27<00:00,  1.47it/s]
[32m2025-02-05 06:34:35.207[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    average  bleu@1  bleu@2  bleu@3  bleu@4  dist@1  dist@2  dist@3  dist@4  extreme  \
      .7816   .3021   .1150  .04505  .02197  .04414   .3060   .5900   .7582    .6011   
      f1  gen_loss  greedy  intra_dist@1  intra_dist@2  intra_dist@3  intra_dist@4  \
   .3555     5.294   .6710         .8679         .9666         .9530         .9196   
     ppl  rouge1  rouge2  rougeL  
   199.1   .3891  .09402   .3767[0m
[32m2025-02-05 06:34:35.214[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m163[0m - [1m[Conversation epoch 81][0m
[32m2025-02-05 06:34:35.214[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m164[0m - [1m[Train][0m
  0%|          | 0/92414 [00:00<?, ?it/s]100%|██████████| 92414/92414 [00:00<00:00, 997363.63it/s]
[32m2025-02-05 06:34:35.307[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/358 [00:00<?, ?it/s]  0%|          | 1/358 [00:00<00:36,  9.76it/s]  1%|          | 3/358 [00:00<00:35,  9.95it/s]  1%|          | 4/358 [00:00<00:35,  9.92it/s]  2%|▏         | 6/358 [00:00<00:35,  9.89it/s]  2%|▏         | 7/358 [00:00<00:35,  9.82it/s]  2%|▏         | 8/358 [00:00<00:35,  9.86it/s]  3%|▎         | 9/358 [00:00<00:35,  9.76it/s]  3%|▎         | 10/358 [00:01<00:35,  9.76it/s]  3%|▎         | 11/358 [00:01<00:35,  9.70it/s]  4%|▎         | 13/358 [00:01<00:34,  9.92it/s]  4%|▍         | 14/358 [00:01<00:34,  9.85it/s]  4%|▍         | 15/358 [00:01<00:35,  9.77it/s]  4%|▍         | 16/358 [00:01<00:35,  9.71it/s]  5%|▍         | 17/358 [00:01<00:35,  9.72it/s]  5%|▌         | 19/358 [00:01<00:34,  9.75it/s]  6%|▌         | 20/358 [00:02<00:34,  9.70it/s]  6%|▌         | 21/358 [00:02<00:34,  9.63it/s]  6%|▌         | 22/358 [00:02<00:34,  9.69it/s]  7%|▋         | 24/358 [00:02<00:34,  9.78it/s]  7%|▋         | 25/358 [00:02<00:34,  9.73it/s]  7%|▋         | 26/358 [00:02<00:34,  9.68it/s]  8%|▊         | 27/358 [00:02<00:34,  9.73it/s]  8%|▊         | 28/358 [00:02<00:34,  9.69it/s]  8%|▊         | 29/358 [00:02<00:34,  9.65it/s]  9%|▊         | 31/358 [00:03<00:33,  9.75it/s]  9%|▉         | 32/358 [00:03<00:33,  9.75it/s]  9%|▉         | 34/358 [00:03<00:32,  9.85it/s] 10%|█         | 36/358 [00:03<00:32,  9.84it/s] 10%|█         | 37/358 [00:03<00:32,  9.83it/s] 11%|█         | 38/358 [00:03<00:32,  9.79it/s] 11%|█         | 40/358 [00:04<00:31,  9.95it/s] 11%|█▏        | 41/358 [00:04<00:32,  9.86it/s] 12%|█▏        | 43/358 [00:04<00:31,  9.89it/s] 13%|█▎        | 45/358 [00:04<00:31,  9.98it/s] 13%|█▎        | 47/358 [00:04<00:31,  9.96it/s] 13%|█▎        | 48/358 [00:04<00:31,  9.95it/s] 14%|█▍        | 50/358 [00:05<00:31,  9.92it/s] 14%|█▍        | 51/358 [00:05<00:31,  9.85it/s] 15%|█▍        | 52/358 [00:05<00:31,  9.76it/s] 15%|█▍        | 53/358 [00:05<00:31,  9.71it/s] 15%|█▌        | 54/358 [00:05<00:31,  9.75it/s] 15%|█▌        | 55/358 [00:05<00:31,  9.70it/s] 16%|█▌        | 56/358 [00:05<00:31,  9.74it/s] 16%|█▌        | 57/358 [00:05<00:31,  9.70it/s] 16%|█▌        | 58/358 [00:05<00:31,  9.68it/s] 16%|█▋        | 59/358 [00:06<00:30,  9.65it/s] 17%|█▋        | 61/358 [00:06<00:30,  9.73it/s] 17%|█▋        | 62/358 [00:06<00:30,  9.65it/s] 18%|█▊        | 63/358 [00:06<00:30,  9.72it/s] 18%|█▊        | 64/358 [00:06<00:30,  9.67it/s] 18%|█▊        | 66/358 [00:06<00:29,  9.74it/s] 19%|█▊        | 67/358 [00:06<00:29,  9.72it/s] 19%|█▉        | 69/358 [00:07<00:29,  9.79it/s] 20%|█▉        | 70/358 [00:07<00:29,  9.73it/s] 20%|█▉        | 71/358 [00:07<00:29,  9.78it/s] 20%|██        | 72/358 [00:07<00:29,  9.73it/s] 20%|██        | 73/358 [00:07<00:29,  9.69it/s] 21%|██        | 74/358 [00:07<00:29,  9.66it/s] 21%|██        | 75/358 [00:07<00:29,  9.62it/s] 22%|██▏       | 77/358 [00:07<00:28,  9.71it/s] 22%|██▏       | 79/358 [00:08<00:28,  9.71it/s] 23%|██▎       | 81/358 [00:08<00:28,  9.76it/s] 23%|██▎       | 83/358 [00:08<00:28,  9.78it/s] 23%|██▎       | 84/358 [00:08<00:28,  9.74it/s] 24%|██▎       | 85/358 [00:08<00:28,  9.69it/s] 24%|██▍       | 86/358 [00:08<00:28,  9.68it/s] 24%|██▍       | 87/358 [00:08<00:28,  9.66it/s] 25%|██▍       | 88/358 [00:09<00:27,  9.67it/s] 25%|██▌       | 90/358 [00:09<00:27,  9.91it/s] 26%|██▌       | 92/358 [00:09<00:26, 10.01it/s] 26%|██▌       | 93/358 [00:09<00:26,  9.97it/s] 26%|██▋       | 94/358 [00:09<00:26,  9.89it/s] 27%|██▋       | 96/358 [00:09<00:25, 10.17it/s] 27%|██▋       | 98/358 [00:09<00:25, 10.06it/s] 28%|██▊       | 100/358 [00:10<00:25, 10.00it/s] 28%|██▊       | 101/358 [00:10<00:25,  9.91it/s] 29%|██▉       | 103/358 [00:10<00:25,  9.91it/s] 29%|██▉       | 104/358 [00:10<00:25,  9.86it/s] 29%|██▉       | 105/358 [00:10<00:25,  9.79it/s] 30%|██▉       | 106/358 [00:10<00:25,  9.77it/s] 30%|███       | 108/358 [00:11<00:25,  9.80it/s] 30%|███       | 109/358 [00:11<00:25,  9.72it/s] 31%|███       | 110/358 [00:11<00:25,  9.70it/s] 31%|███       | 111/358 [00:11<00:25,  9.66it/s] 32%|███▏      | 113/358 [00:11<00:24,  9.93it/s] 32%|███▏      | 114/358 [00:11<00:24,  9.88it/s] 32%|███▏      | 115/358 [00:11<00:24,  9.79it/s] 32%|███▏      | 116/358 [00:11<00:24,  9.70it/s] 33%|███▎      | 117/358 [00:11<00:24,  9.67it/s] 33%|███▎      | 119/358 [00:12<00:24,  9.79it/s] 34%|███▍      | 121/358 [00:12<00:23,  9.99it/s] 34%|███▍      | 123/358 [00:12<00:23, 10.09it/s] 35%|███▍      | 125/358 [00:12<00:23, 10.07it/s] 35%|███▌      | 127/358 [00:12<00:23, 10.00it/s] 36%|███▌      | 128/358 [00:13<00:23,  9.95it/s] 36%|███▋      | 130/358 [00:13<00:22, 10.00it/s] 37%|███▋      | 131/358 [00:13<00:22,  9.91it/s] 37%|███▋      | 132/358 [00:13<00:22,  9.93it/s] 37%|███▋      | 134/358 [00:13<00:22,  9.94it/s] 38%|███▊      | 135/358 [00:13<00:22,  9.88it/s] 38%|███▊      | 137/358 [00:13<00:22,  9.97it/s] 39%|███▊      | 138/358 [00:14<00:22,  9.95it/s] 39%|███▉      | 139/358 [00:14<00:22,  9.86it/s] 39%|███▉      | 141/358 [00:14<00:21,  9.98it/s] 40%|███▉      | 142/358 [00:14<00:21,  9.91it/s] 40%|███▉      | 143/358 [00:14<00:21,  9.87it/s] 40%|████      | 144/358 [00:14<00:21,  9.79it/s] 41%|████      | 145/358 [00:14<00:21,  9.81it/s] 41%|████      | 146/358 [00:14<00:21,  9.75it/s] 41%|████      | 147/358 [00:14<00:21,  9.69it/s] 41%|████▏     | 148/358 [00:15<00:21,  9.71it/s] 42%|████▏     | 149/358 [00:15<00:21,  9.69it/s] 42%|████▏     | 150/358 [00:15<00:21,  9.65it/s] 42%|████▏     | 151/358 [00:15<00:22,  9.39it/s] 42%|████▏     | 152/358 [00:15<00:21,  9.44it/s] 43%|████▎     | 153/358 [00:15<00:21,  9.46it/s] 43%|████▎     | 154/358 [00:15<00:21,  9.55it/s] 43%|████▎     | 155/358 [00:15<00:21,  9.56it/s] 44%|████▎     | 156/358 [00:15<00:20,  9.69it/s] 44%|████▍     | 157/358 [00:16<00:20,  9.63it/s] 44%|████▍     | 158/358 [00:16<00:20,  9.72it/s] 44%|████▍     | 159/358 [00:16<00:20,  9.71it/s] 45%|████▍     | 160/358 [00:16<00:20,  9.71it/s] 45%|████▌     | 162/358 [00:16<00:19, 10.01it/s] 46%|████▌     | 164/358 [00:16<00:19, 10.01it/s] 46%|████▌     | 165/358 [00:16<00:19,  9.97it/s] 47%|████▋     | 167/358 [00:17<00:19,  9.91it/s] 47%|████▋     | 169/358 [00:17<00:18,  9.96it/s] 48%|████▊     | 171/358 [00:17<00:18,  9.94it/s] 48%|████▊     | 172/358 [00:17<00:18,  9.88it/s] 48%|████▊     | 173/358 [00:17<00:18,  9.82it/s] 49%|████▉     | 175/358 [00:17<00:18,  9.84it/s] 49%|████▉     | 176/358 [00:17<00:18,  9.86it/s] 49%|████▉     | 177/358 [00:18<00:18,  9.84it/s] 50%|█████     | 179/358 [00:18<00:18,  9.87it/s] 50%|█████     | 180/358 [00:18<00:18,  9.79it/s] 51%|█████     | 182/358 [00:18<00:17,  9.94it/s] 51%|█████     | 183/358 [00:18<00:17,  9.90it/s] 51%|█████▏    | 184/358 [00:18<00:17,  9.79it/s] 52%|█████▏    | 185/358 [00:18<00:17,  9.73it/s] 52%|█████▏    | 187/358 [00:19<00:17,  9.95it/s] 53%|█████▎    | 188/358 [00:19<00:17,  9.90it/s] 53%|█████▎    | 189/358 [00:19<00:17,  9.84it/s] 53%|█████▎    | 191/358 [00:19<00:17,  9.75it/s] 54%|█████▎    | 192/358 [00:19<00:17,  9.70it/s] 54%|█████▍    | 193/358 [00:19<00:17,  9.69it/s] 54%|█████▍    | 194/358 [00:19<00:16,  9.68it/s] 54%|█████▍    | 195/358 [00:19<00:16,  9.74it/s] 55%|█████▌    | 197/358 [00:20<00:16,  9.92it/s] 55%|█████▌    | 198/358 [00:20<00:16,  9.84it/s] 56%|█████▌    | 199/358 [00:20<00:16,  9.88it/s] 56%|█████▌    | 200/358 [00:20<00:16,  9.81it/s] 56%|█████▌    | 201/358 [00:20<00:16,  9.77it/s] 57%|█████▋    | 203/358 [00:20<00:15,  9.86it/s] 57%|█████▋    | 204/358 [00:20<00:15,  9.76it/s] 57%|█████▋    | 205/358 [00:20<00:15,  9.72it/s] 58%|█████▊    | 207/358 [00:21<00:15,  9.88it/s] 58%|█████▊    | 208/358 [00:21<00:15,  9.81it/s] 59%|█████▊    | 210/358 [00:21<00:15,  9.83it/s] 59%|█████▉    | 212/358 [00:21<00:14,  9.82it/s] 60%|█████▉    | 214/358 [00:21<00:14,  9.90it/s] 60%|██████    | 215/358 [00:21<00:14,  9.83it/s] 60%|██████    | 216/358 [00:22<00:14,  9.77it/s] 61%|██████    | 217/358 [00:22<00:14,  9.81it/s] 61%|██████    | 218/358 [00:22<00:14,  9.78it/s] 61%|██████    | 219/358 [00:22<00:14,  9.78it/s] 62%|██████▏   | 221/358 [00:22<00:13,  9.92it/s] 62%|██████▏   | 222/358 [00:22<00:13,  9.81it/s] 62%|██████▏   | 223/358 [00:22<00:13,  9.76it/s] 63%|██████▎   | 224/358 [00:22<00:13,  9.69it/s] 63%|██████▎   | 226/358 [00:23<00:13,  9.74it/s] 64%|██████▎   | 228/358 [00:23<00:13,  9.77it/s] 64%|██████▍   | 229/358 [00:23<00:13,  9.75it/s] 64%|██████▍   | 230/358 [00:23<00:13,  9.69it/s] 65%|██████▍   | 232/358 [00:23<00:12,  9.74it/s] 65%|██████▌   | 234/358 [00:23<00:12, 10.03it/s] 66%|██████▌   | 236/358 [00:24<00:12,  9.99it/s] 66%|██████▋   | 238/358 [00:24<00:11, 10.04it/s] 67%|██████▋   | 240/358 [00:24<00:11, 10.01it/s] 68%|██████▊   | 242/358 [00:24<00:11,  9.99it/s] 68%|██████▊   | 243/358 [00:24<00:11,  9.92it/s] 68%|██████▊   | 244/358 [00:24<00:11,  9.86it/s] 69%|██████▊   | 246/358 [00:25<00:11,  9.88it/s] 69%|██████▉   | 247/358 [00:25<00:11,  9.81it/s] 69%|██████▉   | 248/358 [00:25<00:11,  9.76it/s] 70%|██████▉   | 250/358 [00:25<00:10,  9.86it/s] 70%|███████   | 251/358 [00:25<00:10,  9.80it/s] 70%|███████   | 252/358 [00:25<00:10,  9.73it/s] 71%|███████   | 253/358 [00:25<00:10,  9.69it/s] 71%|███████   | 254/358 [00:25<00:10,  9.67it/s] 72%|███████▏  | 256/358 [00:26<00:10,  9.84it/s] 72%|███████▏  | 257/358 [00:26<00:10,  9.85it/s] 72%|███████▏  | 258/358 [00:26<00:10,  9.72it/s] 72%|███████▏  | 259/358 [00:26<00:10,  9.69it/s] 73%|███████▎  | 260/358 [00:26<00:10,  9.72it/s] 73%|███████▎  | 262/358 [00:26<00:09,  9.90it/s] 74%|███████▎  | 264/358 [00:26<00:09,  9.92it/s] 74%|███████▍  | 266/358 [00:27<00:09,  9.92it/s] 75%|███████▍  | 267/358 [00:27<00:09,  9.86it/s] 75%|███████▌  | 269/358 [00:27<00:08,  9.91it/s] 75%|███████▌  | 270/358 [00:27<00:08,  9.84it/s] 76%|███████▌  | 271/358 [00:27<00:08,  9.76it/s] 76%|███████▌  | 272/358 [00:27<00:08,  9.74it/s] 76%|███████▋  | 273/358 [00:27<00:08,  9.64it/s] 77%|███████▋  | 274/358 [00:27<00:08,  9.64it/s] 77%|███████▋  | 275/358 [00:28<00:08,  9.69it/s] 77%|███████▋  | 276/358 [00:28<00:08,  9.69it/s] 77%|███████▋  | 277/358 [00:28<00:08,  9.66it/s] 78%|███████▊  | 278/358 [00:28<00:08,  9.63it/s] 78%|███████▊  | 280/358 [00:28<00:07,  9.83it/s] 78%|███████▊  | 281/358 [00:28<00:07,  9.84it/s] 79%|███████▉  | 282/358 [00:28<00:07,  9.78it/s] 79%|███████▉  | 283/358 [00:28<00:07,  9.72it/s] 79%|███████▉  | 284/358 [00:28<00:07,  9.68it/s] 80%|███████▉  | 285/358 [00:29<00:07,  9.75it/s] 80%|███████▉  | 286/358 [00:29<00:07,  9.70it/s] 80%|████████  | 287/358 [00:29<00:07,  9.67it/s] 80%|████████  | 288/358 [00:29<00:07,  9.63it/s] 81%|████████  | 290/358 [00:29<00:06,  9.85it/s] 81%|████████▏ | 291/358 [00:29<00:06,  9.83it/s] 82%|████████▏ | 293/358 [00:29<00:06,  9.84it/s] 82%|████████▏ | 295/358 [00:30<00:06,  9.91it/s] 83%|████████▎ | 296/358 [00:30<00:06,  9.85it/s] 83%|████████▎ | 297/358 [00:30<00:06,  9.74it/s] 84%|████████▎ | 299/358 [00:30<00:05,  9.90it/s] 84%|████████▍ | 301/358 [00:30<00:05,  9.94it/s] 84%|████████▍ | 302/358 [00:30<00:05,  9.88it/s] 85%|████████▍ | 303/358 [00:30<00:05,  9.88it/s] 85%|████████▌ | 305/358 [00:31<00:05,  9.91it/s] 85%|████████▌ | 306/358 [00:31<00:05,  9.83it/s] 86%|████████▌ | 308/358 [00:31<00:05,  9.93it/s] 86%|████████▋ | 309/358 [00:31<00:04,  9.83it/s] 87%|████████▋ | 310/358 [00:31<00:04,  9.77it/s] 87%|████████▋ | 311/358 [00:31<00:04,  9.70it/s] 87%|████████▋ | 312/358 [00:31<00:04,  9.71it/s] 87%|████████▋ | 313/358 [00:31<00:04,  9.73it/s] 88%|████████▊ | 315/358 [00:32<00:04,  9.99it/s] 88%|████████▊ | 316/358 [00:32<00:04,  9.94it/s] 89%|████████▊ | 317/358 [00:32<00:04,  9.86it/s] 89%|████████▉ | 318/358 [00:32<00:04,  9.81it/s] 89%|████████▉ | 319/358 [00:32<00:03,  9.76it/s] 89%|████████▉ | 320/358 [00:32<00:03,  9.83it/s] 90%|████████▉ | 321/358 [00:32<00:03,  9.75it/s] 90%|████████▉ | 322/358 [00:32<00:03,  9.71it/s] 90%|█████████ | 323/358 [00:32<00:03,  9.67it/s] 91%|█████████ | 324/358 [00:33<00:03,  9.64it/s] 91%|█████████ | 325/358 [00:33<00:03,  9.62it/s] 91%|█████████▏| 327/358 [00:33<00:03,  9.98it/s] 92%|█████████▏| 329/358 [00:33<00:02, 10.08it/s] 92%|█████████▏| 330/358 [00:33<00:02,  9.97it/s] 93%|█████████▎| 332/358 [00:33<00:02, 10.07it/s] 93%|█████████▎| 334/358 [00:34<00:02,  9.97it/s] 94%|█████████▎| 335/358 [00:34<00:02,  9.85it/s] 94%|█████████▍| 337/358 [00:34<00:02,  9.92it/s] 95%|█████████▍| 339/358 [00:34<00:01, 10.12it/s] 95%|█████████▌| 341/358 [00:34<00:01, 10.07it/s] 96%|█████████▌| 343/358 [00:34<00:01,  9.90it/s] 96%|█████████▌| 344/358 [00:35<00:01,  9.85it/s] 96%|█████████▋| 345/358 [00:35<00:01,  9.87it/s] 97%|█████████▋| 347/358 [00:35<00:01, 10.05it/s] 97%|█████████▋| 348/358 [00:35<00:01,  9.95it/s] 97%|█████████▋| 349/358 [00:35<00:00,  9.87it/s] 98%|█████████▊| 350/358 [00:35<00:00,  9.80it/s] 98%|█████████▊| 351/358 [00:35<00:00,  9.75it/s] 99%|█████████▊| 353/358 [00:35<00:00,  9.93it/s] 99%|█████████▉| 354/358 [00:36<00:00,  9.90it/s] 99%|█████████▉| 355/358 [00:36<00:00,  9.82it/s]100%|█████████▉| 357/358 [00:36<00:00,  9.88it/s]100%|██████████| 358/358 [00:36<00:00,  9.83it/s]
[32m2025-02-05 06:35:11.718[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    gen_loss  grad clip ratio  grad norm   ppl
       1.747                1      2.752 5.737[0m
[32m2025-02-05 06:35:11.718[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m169[0m - [1m[Valid][0m
  0%|          | 0/10256 [00:00<?, ?it/s]100%|██████████| 10256/10256 [00:00<00:00, 1099217.61it/s]
[32m2025-02-05 06:35:11.727[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:27,  1.42it/s]  5%|▌         | 2/40 [00:01<00:26,  1.44it/s]  8%|▊         | 3/40 [00:02<00:25,  1.44it/s] 10%|█         | 4/40 [00:02<00:24,  1.45it/s] 12%|█▎        | 5/40 [00:03<00:24,  1.44it/s] 15%|█▌        | 6/40 [00:04<00:23,  1.43it/s] 18%|█▊        | 7/40 [00:04<00:23,  1.43it/s] 20%|██        | 8/40 [00:05<00:22,  1.44it/s] 22%|██▎       | 9/40 [00:06<00:21,  1.44it/s] 25%|██▌       | 10/40 [00:06<00:20,  1.44it/s] 28%|██▊       | 11/40 [00:07<00:20,  1.44it/s] 30%|███       | 12/40 [00:08<00:19,  1.44it/s] 32%|███▎      | 13/40 [00:09<00:18,  1.44it/s] 35%|███▌      | 14/40 [00:09<00:18,  1.43it/s] 38%|███▊      | 15/40 [00:10<00:17,  1.44it/s] 40%|████      | 16/40 [00:11<00:16,  1.43it/s] 42%|████▎     | 17/40 [00:11<00:15,  1.44it/s] 45%|████▌     | 18/40 [00:12<00:15,  1.44it/s] 48%|████▊     | 19/40 [00:13<00:14,  1.44it/s] 50%|█████     | 20/40 [00:13<00:13,  1.44it/s] 52%|█████▎    | 21/40 [00:14<00:13,  1.45it/s] 55%|█████▌    | 22/40 [00:15<00:12,  1.44it/s] 57%|█████▊    | 23/40 [00:15<00:11,  1.44it/s] 60%|██████    | 24/40 [00:16<00:11,  1.43it/s] 62%|██████▎   | 25/40 [00:17<00:10,  1.44it/s] 65%|██████▌   | 26/40 [00:18<00:09,  1.45it/s] 68%|██████▊   | 27/40 [00:18<00:08,  1.45it/s] 70%|███████   | 28/40 [00:19<00:08,  1.45it/s] 72%|███████▎  | 29/40 [00:20<00:07,  1.45it/s] 75%|███████▌  | 30/40 [00:20<00:06,  1.46it/s] 78%|███████▊  | 31/40 [00:21<00:06,  1.45it/s] 80%|████████  | 32/40 [00:22<00:05,  1.45it/s] 82%|████████▎ | 33/40 [00:22<00:04,  1.45it/s] 85%|████████▌ | 34/40 [00:23<00:04,  1.45it/s] 88%|████████▊ | 35/40 [00:24<00:03,  1.44it/s] 90%|█████████ | 36/40 [00:24<00:02,  1.44it/s] 92%|█████████▎| 37/40 [00:25<00:02,  1.44it/s] 95%|█████████▌| 38/40 [00:26<00:01,  1.43it/s] 98%|█████████▊| 39/40 [00:27<00:00,  1.43it/s]100%|██████████| 40/40 [00:27<00:00,  1.58it/s]100%|██████████| 40/40 [00:27<00:00,  1.45it/s]
[32m2025-02-05 06:35:39.276[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    average  bleu@1  bleu@2  bleu@3  bleu@4  dist@1  dist@2  dist@3  dist@4  extreme  \
      .7830   .3013   .1113  .04357  .02299   .0429   .3085   .5926   .7602    .5993   
      f1  gen_loss  greedy  intra_dist@1  intra_dist@2  intra_dist@3  intra_dist@4  \
   .3499     5.361   .6682         .8609         .9645         .9551         .9244   
     ppl  rouge1  rouge2  rougeL  
   212.9   .3874  .09004   .3748[0m
[32m2025-02-05 06:35:39.283[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m163[0m - [1m[Conversation epoch 82][0m
[32m2025-02-05 06:35:39.283[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m164[0m - [1m[Train][0m
  0%|          | 0/92414 [00:00<?, ?it/s]100%|██████████| 92414/92414 [00:00<00:00, 998651.01it/s]
[32m2025-02-05 06:35:39.376[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/358 [00:00<?, ?it/s]  0%|          | 1/358 [00:00<00:36,  9.76it/s]  1%|          | 3/358 [00:00<00:35,  9.93it/s]  1%|          | 4/358 [00:00<00:35,  9.91it/s]  2%|▏         | 6/358 [00:00<00:35,  9.87it/s]  2%|▏         | 7/358 [00:00<00:35,  9.81it/s]  2%|▏         | 8/358 [00:00<00:35,  9.85it/s]  3%|▎         | 9/358 [00:00<00:35,  9.76it/s]  3%|▎         | 10/358 [00:01<00:35,  9.75it/s]  3%|▎         | 11/358 [00:01<00:35,  9.70it/s]  4%|▎         | 13/358 [00:01<00:34,  9.92it/s]  4%|▍         | 14/358 [00:01<00:34,  9.85it/s]  4%|▍         | 15/358 [00:01<00:35,  9.77it/s]  4%|▍         | 16/358 [00:01<00:35,  9.71it/s]  5%|▍         | 17/358 [00:01<00:35,  9.72it/s]  5%|▌         | 19/358 [00:01<00:34,  9.75it/s]  6%|▌         | 20/358 [00:02<00:34,  9.70it/s]  6%|▌         | 21/358 [00:02<00:34,  9.63it/s]  6%|▌         | 22/358 [00:02<00:34,  9.69it/s]  7%|▋         | 24/358 [00:02<00:34,  9.78it/s]  7%|▋         | 25/358 [00:02<00:34,  9.73it/s]  7%|▋         | 26/358 [00:02<00:34,  9.68it/s]  8%|▊         | 27/358 [00:02<00:34,  9.73it/s]  8%|▊         | 28/358 [00:02<00:34,  9.69it/s]  8%|▊         | 29/358 [00:02<00:34,  9.65it/s]  9%|▊         | 31/358 [00:03<00:33,  9.76it/s]  9%|▉         | 32/358 [00:03<00:33,  9.75it/s]  9%|▉         | 34/358 [00:03<00:32,  9.85it/s] 10%|█         | 36/358 [00:03<00:32,  9.85it/s] 10%|█         | 37/358 [00:03<00:32,  9.83it/s] 11%|█         | 38/358 [00:03<00:32,  9.79it/s] 11%|█         | 40/358 [00:04<00:31,  9.95it/s] 11%|█▏        | 41/358 [00:04<00:32,  9.86it/s] 12%|█▏        | 43/358 [00:04<00:31,  9.89it/s] 13%|█▎        | 45/358 [00:04<00:31,  9.98it/s] 13%|█▎        | 47/358 [00:04<00:31,  9.96it/s] 13%|█▎        | 48/358 [00:04<00:31,  9.95it/s] 14%|█▍        | 50/358 [00:05<00:31,  9.92it/s] 14%|█▍        | 51/358 [00:05<00:31,  9.85it/s] 15%|█▍        | 52/358 [00:05<00:31,  9.76it/s] 15%|█▍        | 53/358 [00:05<00:31,  9.71it/s] 15%|█▌        | 54/358 [00:05<00:31,  9.75it/s] 15%|█▌        | 55/358 [00:05<00:31,  9.70it/s] 16%|█▌        | 56/358 [00:05<00:31,  9.74it/s] 16%|█▌        | 57/358 [00:05<00:31,  9.70it/s] 16%|█▌        | 58/358 [00:05<00:31,  9.68it/s] 16%|█▋        | 59/358 [00:06<00:31,  9.64it/s] 17%|█▋        | 61/358 [00:06<00:30,  9.73it/s] 17%|█▋        | 62/358 [00:06<00:30,  9.65it/s] 18%|█▊        | 63/358 [00:06<00:30,  9.71it/s] 18%|█▊        | 64/358 [00:06<00:30,  9.67it/s] 18%|█▊        | 66/358 [00:06<00:29,  9.74it/s] 19%|█▊        | 67/358 [00:06<00:29,  9.73it/s] 19%|█▉        | 69/358 [00:07<00:29,  9.79it/s] 20%|█▉        | 70/358 [00:07<00:29,  9.74it/s] 20%|█▉        | 71/358 [00:07<00:29,  9.78it/s] 20%|██        | 72/358 [00:07<00:29,  9.73it/s] 20%|██        | 73/358 [00:07<00:29,  9.69it/s] 21%|██        | 74/358 [00:07<00:29,  9.66it/s] 21%|██        | 75/358 [00:07<00:29,  9.63it/s] 22%|██▏       | 77/358 [00:07<00:28,  9.71it/s] 22%|██▏       | 79/358 [00:08<00:28,  9.71it/s] 23%|██▎       | 81/358 [00:08<00:28,  9.76it/s] 23%|██▎       | 83/358 [00:08<00:28,  9.78it/s] 23%|██▎       | 84/358 [00:08<00:28,  9.74it/s] 24%|██▎       | 85/358 [00:08<00:28,  9.69it/s] 24%|██▍       | 86/358 [00:08<00:28,  9.68it/s] 24%|██▍       | 87/358 [00:08<00:28,  9.66it/s] 25%|██▍       | 88/358 [00:09<00:27,  9.68it/s] 25%|██▌       | 90/358 [00:09<00:27,  9.91it/s] 26%|██▌       | 92/358 [00:09<00:26, 10.01it/s] 26%|██▌       | 93/358 [00:09<00:26,  9.97it/s] 26%|██▋       | 94/358 [00:09<00:26,  9.88it/s] 27%|██▋       | 96/358 [00:09<00:25, 10.16it/s] 27%|██▋       | 98/358 [00:09<00:25, 10.05it/s] 28%|██▊       | 99/358 [00:10<00:25,  9.96it/s] 28%|██▊       | 101/358 [00:10<00:25,  9.93it/s] 29%|██▉       | 103/358 [00:10<00:25,  9.92it/s] 29%|██▉       | 104/358 [00:10<00:25,  9.87it/s] 29%|██▉       | 105/358 [00:10<00:25,  9.79it/s] 30%|██▉       | 106/358 [00:10<00:25,  9.78it/s] 30%|███       | 108/358 [00:11<00:25,  9.81it/s] 30%|███       | 109/358 [00:11<00:25,  9.72it/s] 31%|███       | 110/358 [00:11<00:25,  9.71it/s] 31%|███       | 111/358 [00:11<00:25,  9.66it/s] 32%|███▏      | 113/358 [00:11<00:24,  9.92it/s] 32%|███▏      | 114/358 [00:11<00:24,  9.88it/s] 32%|███▏      | 115/358 [00:11<00:24,  9.79it/s] 32%|███▏      | 116/358 [00:11<00:24,  9.70it/s] 33%|███▎      | 117/358 [00:11<00:24,  9.68it/s] 33%|███▎      | 119/358 [00:12<00:24,  9.80it/s] 34%|███▍      | 121/358 [00:12<00:23, 10.00it/s] 34%|███▍      | 123/358 [00:12<00:23, 10.09it/s] 35%|███▍      | 125/358 [00:12<00:23, 10.07it/s] 35%|███▌      | 127/358 [00:12<00:23, 10.00it/s] 36%|███▌      | 128/358 [00:13<00:23,  9.96it/s] 36%|███▋      | 130/358 [00:13<00:22, 10.01it/s] 37%|███▋      | 131/358 [00:13<00:22,  9.91it/s] 37%|███▋      | 132/358 [00:13<00:22,  9.93it/s] 37%|███▋      | 134/358 [00:13<00:22,  9.95it/s] 38%|███▊      | 135/358 [00:13<00:22,  9.89it/s] 38%|███▊      | 137/358 [00:13<00:22,  9.97it/s] 39%|███▊      | 138/358 [00:14<00:22,  9.95it/s] 39%|███▉      | 139/358 [00:14<00:22,  9.87it/s] 39%|███▉      | 141/358 [00:14<00:21,  9.99it/s] 40%|███▉      | 142/358 [00:14<00:21,  9.91it/s] 40%|███▉      | 143/358 [00:14<00:21,  9.88it/s] 40%|████      | 144/358 [00:14<00:21,  9.79it/s] 41%|████      | 145/358 [00:14<00:21,  9.81it/s] 41%|████      | 146/358 [00:14<00:21,  9.75it/s] 41%|████      | 147/358 [00:14<00:21,  9.69it/s] 41%|████▏     | 148/358 [00:15<00:21,  9.71it/s] 42%|████▏     | 149/358 [00:15<00:21,  9.70it/s] 42%|████▏     | 150/358 [00:15<00:21,  9.66it/s] 42%|████▏     | 151/358 [00:15<00:22,  9.39it/s] 42%|████▏     | 152/358 [00:15<00:21,  9.44it/s] 43%|████▎     | 153/358 [00:15<00:21,  9.46it/s] 43%|████▎     | 154/358 [00:15<00:21,  9.55it/s] 43%|████▎     | 155/358 [00:15<00:21,  9.56it/s] 44%|████▎     | 156/358 [00:15<00:20,  9.69it/s] 44%|████▍     | 157/358 [00:16<00:20,  9.63it/s] 44%|████▍     | 158/358 [00:16<00:20,  9.71it/s] 44%|████▍     | 159/358 [00:16<00:20,  9.70it/s] 45%|████▍     | 160/358 [00:16<00:20,  9.71it/s] 45%|████▌     | 162/358 [00:16<00:19, 10.01it/s] 46%|████▌     | 164/358 [00:16<00:19, 10.01it/s] 46%|████▌     | 165/358 [00:16<00:19,  9.97it/s] 47%|████▋     | 167/358 [00:17<00:19,  9.91it/s] 47%|████▋     | 169/358 [00:17<00:18,  9.95it/s] 48%|████▊     | 171/358 [00:17<00:18,  9.93it/s] 48%|████▊     | 172/358 [00:17<00:18,  9.88it/s] 48%|████▊     | 173/358 [00:17<00:18,  9.82it/s] 49%|████▉     | 175/358 [00:17<00:18,  9.84it/s] 49%|████▉     | 176/358 [00:17<00:18,  9.85it/s] 49%|████▉     | 177/358 [00:18<00:18,  9.84it/s] 50%|█████     | 179/358 [00:18<00:18,  9.86it/s] 50%|█████     | 180/358 [00:18<00:18,  9.80it/s] 51%|█████     | 182/358 [00:18<00:17,  9.94it/s] 51%|█████     | 183/358 [00:18<00:17,  9.90it/s] 51%|█████▏    | 184/358 [00:18<00:17,  9.79it/s] 52%|█████▏    | 185/358 [00:18<00:17,  9.73it/s] 52%|█████▏    | 187/358 [00:19<00:17,  9.95it/s] 53%|█████▎    | 188/358 [00:19<00:17,  9.89it/s] 53%|█████▎    | 189/358 [00:19<00:17,  9.84it/s] 53%|█████▎    | 191/358 [00:19<00:17,  9.76it/s] 54%|█████▎    | 192/358 [00:19<00:17,  9.70it/s] 54%|█████▍    | 193/358 [00:19<00:17,  9.70it/s] 54%|█████▍    | 194/358 [00:19<00:16,  9.68it/s] 54%|█████▍    | 195/358 [00:19<00:16,  9.74it/s] 55%|█████▌    | 197/358 [00:20<00:16,  9.92it/s] 55%|█████▌    | 198/358 [00:20<00:16,  9.85it/s] 56%|█████▌    | 199/358 [00:20<00:16,  9.88it/s] 56%|█████▌    | 200/358 [00:20<00:16,  9.81it/s] 56%|█████▌    | 201/358 [00:20<00:16,  9.77it/s] 57%|█████▋    | 203/358 [00:20<00:15,  9.86it/s] 57%|█████▋    | 204/358 [00:20<00:15,  9.76it/s] 57%|█████▋    | 205/358 [00:20<00:15,  9.71it/s] 58%|█████▊    | 207/358 [00:21<00:15,  9.88it/s] 58%|█████▊    | 208/358 [00:21<00:15,  9.81it/s] 59%|█████▊    | 210/358 [00:21<00:15,  9.83it/s] 59%|█████▉    | 212/358 [00:21<00:14,  9.82it/s] 60%|█████▉    | 214/358 [00:21<00:14,  9.90it/s] 60%|██████    | 215/358 [00:21<00:14,  9.83it/s] 60%|██████    | 216/358 [00:22<00:14,  9.77it/s] 61%|██████    | 217/358 [00:22<00:14,  9.80it/s] 61%|██████    | 218/358 [00:22<00:14,  9.78it/s] 61%|██████    | 219/358 [00:22<00:14,  9.78it/s] 62%|██████▏   | 221/358 [00:22<00:13,  9.91it/s] 62%|██████▏   | 222/358 [00:22<00:13,  9.81it/s] 62%|██████▏   | 223/358 [00:22<00:13,  9.75it/s] 63%|██████▎   | 224/358 [00:22<00:13,  9.69it/s] 63%|██████▎   | 226/358 [00:23<00:13,  9.74it/s] 64%|██████▎   | 228/358 [00:23<00:13,  9.77it/s] 64%|██████▍   | 229/358 [00:23<00:13,  9.75it/s] 64%|██████▍   | 230/358 [00:23<00:13,  9.70it/s] 65%|██████▍   | 232/358 [00:23<00:12,  9.74it/s] 65%|██████▌   | 234/358 [00:23<00:12, 10.02it/s] 66%|██████▌   | 236/358 [00:24<00:12,  9.98it/s] 66%|██████▋   | 238/358 [00:24<00:11, 10.04it/s] 67%|██████▋   | 240/358 [00:24<00:11, 10.00it/s] 68%|██████▊   | 242/358 [00:24<00:11,  9.98it/s] 68%|██████▊   | 243/358 [00:24<00:11,  9.92it/s] 68%|██████▊   | 244/358 [00:24<00:11,  9.85it/s] 69%|██████▊   | 246/358 [00:25<00:11,  9.88it/s] 69%|██████▉   | 247/358 [00:25<00:11,  9.80it/s] 69%|██████▉   | 248/358 [00:25<00:11,  9.76it/s] 70%|██████▉   | 250/358 [00:25<00:10,  9.86it/s] 70%|███████   | 251/358 [00:25<00:10,  9.79it/s] 70%|███████   | 252/358 [00:25<00:10,  9.73it/s] 71%|███████   | 253/358 [00:25<00:10,  9.69it/s] 71%|███████   | 254/358 [00:25<00:10,  9.66it/s] 72%|███████▏  | 256/358 [00:26<00:10,  9.84it/s] 72%|███████▏  | 257/358 [00:26<00:10,  9.85it/s] 72%|███████▏  | 258/358 [00:26<00:10,  9.72it/s] 72%|███████▏  | 259/358 [00:26<00:10,  9.68it/s] 73%|███████▎  | 260/358 [00:26<00:10,  9.71it/s] 73%|███████▎  | 262/358 [00:26<00:09,  9.90it/s] 74%|███████▎  | 264/358 [00:26<00:09,  9.92it/s] 74%|███████▍  | 266/358 [00:27<00:09,  9.91it/s] 75%|███████▍  | 267/358 [00:27<00:09,  9.85it/s] 75%|███████▌  | 269/358 [00:27<00:08,  9.91it/s] 75%|███████▌  | 270/358 [00:27<00:08,  9.83it/s] 76%|███████▌  | 271/358 [00:27<00:08,  9.76it/s] 76%|███████▌  | 272/358 [00:27<00:08,  9.74it/s] 76%|███████▋  | 273/358 [00:27<00:08,  9.64it/s] 77%|███████▋  | 274/358 [00:27<00:08,  9.64it/s] 77%|███████▋  | 275/358 [00:28<00:08,  9.69it/s] 77%|███████▋  | 276/358 [00:28<00:08,  9.69it/s] 77%|███████▋  | 277/358 [00:28<00:08,  9.65it/s] 78%|███████▊  | 278/358 [00:28<00:08,  9.63it/s] 78%|███████▊  | 280/358 [00:28<00:07,  9.82it/s] 78%|███████▊  | 281/358 [00:28<00:07,  9.83it/s] 79%|███████▉  | 282/358 [00:28<00:07,  9.77it/s] 79%|███████▉  | 283/358 [00:28<00:07,  9.71it/s] 79%|███████▉  | 284/358 [00:28<00:07,  9.68it/s] 80%|███████▉  | 285/358 [00:29<00:07,  9.74it/s] 80%|███████▉  | 286/358 [00:29<00:07,  9.70it/s] 80%|████████  | 287/358 [00:29<00:07,  9.68it/s] 80%|████████  | 288/358 [00:29<00:07,  9.64it/s] 81%|████████  | 290/358 [00:29<00:06,  9.85it/s] 81%|████████▏ | 291/358 [00:29<00:06,  9.84it/s] 82%|████████▏ | 293/358 [00:29<00:06,  9.84it/s] 82%|████████▏ | 295/358 [00:30<00:06,  9.92it/s] 83%|████████▎ | 296/358 [00:30<00:06,  9.86it/s] 83%|████████▎ | 297/358 [00:30<00:06,  9.75it/s] 84%|████████▎ | 299/358 [00:30<00:05,  9.91it/s] 84%|████████▍ | 301/358 [00:30<00:05,  9.94it/s] 84%|████████▍ | 302/358 [00:30<00:05,  9.88it/s] 85%|████████▍ | 303/358 [00:30<00:05,  9.88it/s] 85%|████████▌ | 305/358 [00:31<00:05,  9.91it/s] 85%|████████▌ | 306/358 [00:31<00:05,  9.83it/s] 86%|████████▌ | 308/358 [00:31<00:05,  9.93it/s] 86%|████████▋ | 309/358 [00:31<00:04,  9.83it/s] 87%|████████▋ | 310/358 [00:31<00:04,  9.77it/s] 87%|████████▋ | 311/358 [00:31<00:04,  9.70it/s] 87%|████████▋ | 312/358 [00:31<00:04,  9.71it/s] 87%|████████▋ | 313/358 [00:31<00:04,  9.73it/s] 88%|████████▊ | 315/358 [00:32<00:04,  9.99it/s] 88%|████████▊ | 316/358 [00:32<00:04,  9.94it/s] 89%|████████▊ | 317/358 [00:32<00:04,  9.86it/s] 89%|████████▉ | 318/358 [00:32<00:04,  9.81it/s] 89%|████████▉ | 319/358 [00:32<00:03,  9.76it/s] 89%|████████▉ | 320/358 [00:32<00:03,  9.82it/s] 90%|████████▉ | 321/358 [00:32<00:03,  9.75it/s] 90%|████████▉ | 322/358 [00:32<00:03,  9.71it/s] 90%|█████████ | 323/358 [00:32<00:03,  9.67it/s] 91%|█████████ | 324/358 [00:33<00:03,  9.63it/s] 91%|█████████ | 325/358 [00:33<00:03,  9.62it/s] 91%|█████████▏| 327/358 [00:33<00:03,  9.98it/s] 92%|█████████▏| 329/358 [00:33<00:02, 10.08it/s] 92%|█████████▏| 330/358 [00:33<00:02,  9.96it/s] 93%|█████████▎| 332/358 [00:33<00:02, 10.07it/s] 93%|█████████▎| 334/358 [00:34<00:02,  9.97it/s] 94%|█████████▎| 335/358 [00:34<00:02,  9.85it/s] 94%|█████████▍| 337/358 [00:34<00:02,  9.92it/s] 95%|█████████▍| 339/358 [00:34<00:01, 10.12it/s] 95%|█████████▌| 341/358 [00:34<00:01, 10.07it/s] 96%|█████████▌| 343/358 [00:34<00:01,  9.91it/s] 96%|█████████▌| 344/358 [00:35<00:01,  9.85it/s] 96%|█████████▋| 345/358 [00:35<00:01,  9.87it/s] 97%|█████████▋| 347/358 [00:35<00:01, 10.05it/s] 97%|█████████▋| 349/358 [00:35<00:00,  9.89it/s] 98%|█████████▊| 350/358 [00:35<00:00,  9.83it/s] 98%|█████████▊| 351/358 [00:35<00:00,  9.78it/s] 99%|█████████▊| 353/358 [00:35<00:00,  9.93it/s] 99%|█████████▉| 354/358 [00:36<00:00,  9.92it/s] 99%|█████████▉| 355/358 [00:36<00:00,  9.83it/s]100%|█████████▉| 357/358 [00:36<00:00,  9.88it/s]100%|██████████| 358/358 [00:36<00:00,  9.83it/s]
[32m2025-02-05 06:36:15.789[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    gen_loss  grad clip ratio  grad norm   ppl
       1.744                1      4.883 5.722[0m
[32m2025-02-05 06:36:15.789[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m169[0m - [1m[Valid][0m
  0%|          | 0/10256 [00:00<?, ?it/s]100%|██████████| 10256/10256 [00:00<00:00, 1121309.12it/s]
[32m2025-02-05 06:36:15.799[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:27,  1.43it/s]  5%|▌         | 2/40 [00:01<00:26,  1.44it/s]  8%|▊         | 3/40 [00:02<00:25,  1.44it/s] 10%|█         | 4/40 [00:02<00:24,  1.45it/s] 12%|█▎        | 5/40 [00:03<00:24,  1.44it/s] 15%|█▌        | 6/40 [00:04<00:23,  1.43it/s] 18%|█▊        | 7/40 [00:04<00:23,  1.43it/s] 20%|██        | 8/40 [00:05<00:22,  1.45it/s] 22%|██▎       | 9/40 [00:06<00:21,  1.44it/s] 25%|██▌       | 10/40 [00:06<00:20,  1.44it/s] 28%|██▊       | 11/40 [00:07<00:20,  1.45it/s] 30%|███       | 12/40 [00:08<00:19,  1.44it/s] 32%|███▎      | 13/40 [00:09<00:18,  1.45it/s] 35%|███▌      | 14/40 [00:09<00:18,  1.43it/s] 38%|███▊      | 15/40 [00:10<00:17,  1.44it/s] 40%|████      | 16/40 [00:11<00:16,  1.43it/s] 42%|████▎     | 17/40 [00:11<00:15,  1.44it/s] 45%|████▌     | 18/40 [00:12<00:15,  1.44it/s] 48%|████▊     | 19/40 [00:13<00:14,  1.44it/s] 50%|█████     | 20/40 [00:13<00:13,  1.45it/s] 52%|█████▎    | 21/40 [00:14<00:13,  1.45it/s] 55%|█████▌    | 22/40 [00:15<00:12,  1.44it/s] 57%|█████▊    | 23/40 [00:15<00:11,  1.44it/s] 60%|██████    | 24/40 [00:16<00:11,  1.43it/s] 62%|██████▎   | 25/40 [00:17<00:10,  1.43it/s] 65%|██████▌   | 26/40 [00:18<00:09,  1.45it/s] 68%|██████▊   | 27/40 [00:18<00:08,  1.45it/s] 70%|███████   | 28/40 [00:19<00:08,  1.44it/s] 72%|███████▎  | 29/40 [00:20<00:07,  1.44it/s] 75%|███████▌  | 30/40 [00:20<00:06,  1.45it/s] 78%|███████▊  | 31/40 [00:21<00:06,  1.44it/s] 80%|████████  | 32/40 [00:22<00:05,  1.45it/s] 82%|████████▎ | 33/40 [00:22<00:04,  1.45it/s] 85%|████████▌ | 34/40 [00:23<00:04,  1.45it/s] 88%|████████▊ | 35/40 [00:24<00:03,  1.44it/s] 90%|█████████ | 36/40 [00:24<00:02,  1.44it/s] 92%|█████████▎| 37/40 [00:25<00:02,  1.44it/s] 95%|█████████▌| 38/40 [00:26<00:01,  1.44it/s] 98%|█████████▊| 39/40 [00:27<00:00,  1.43it/s]100%|██████████| 40/40 [00:27<00:00,  1.58it/s]100%|██████████| 40/40 [00:27<00:00,  1.45it/s]
[32m2025-02-05 06:36:43.358[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    average  bleu@1  bleu@2  bleu@3  bleu@4  dist@1  dist@2  dist@3  dist@4  extreme  \
      .7789   .2983   .1140  .04443  .02271  .03987   .2809   .5512   .7154    .6001   
      f1  gen_loss  greedy  intra_dist@1  intra_dist@2  intra_dist@3  intra_dist@4  \
   .3492     5.375   .6693         .8487         .9516         .9468         .9177   
    ppl  rouge1  rouge2  rougeL  
    216   .3873  .09336   .3754[0m
[32m2025-02-05 06:36:43.374[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m163[0m - [1m[Conversation epoch 83][0m
[32m2025-02-05 06:36:43.374[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m164[0m - [1m[Train][0m
  0%|          | 0/92414 [00:00<?, ?it/s]100%|██████████| 92414/92414 [00:00<00:00, 993554.43it/s]
[32m2025-02-05 06:36:43.468[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/358 [00:00<?, ?it/s]  0%|          | 1/358 [00:00<00:36,  9.75it/s]  1%|          | 3/358 [00:00<00:35,  9.94it/s]  1%|          | 4/358 [00:00<00:35,  9.91it/s]  2%|▏         | 6/358 [00:00<00:35,  9.88it/s]  2%|▏         | 7/358 [00:00<00:35,  9.81it/s]  2%|▏         | 8/358 [00:00<00:35,  9.86it/s]  3%|▎         | 9/358 [00:00<00:35,  9.76it/s]  3%|▎         | 10/358 [00:01<00:35,  9.75it/s]  3%|▎         | 11/358 [00:01<00:35,  9.70it/s]  4%|▎         | 13/358 [00:01<00:34,  9.92it/s]  4%|▍         | 14/358 [00:01<00:34,  9.85it/s]  4%|▍         | 15/358 [00:01<00:35,  9.78it/s]  4%|▍         | 16/358 [00:01<00:35,  9.72it/s]  5%|▍         | 17/358 [00:01<00:35,  9.73it/s]  5%|▌         | 19/358 [00:01<00:34,  9.76it/s]  6%|▌         | 20/358 [00:02<00:34,  9.71it/s]  6%|▌         | 21/358 [00:02<00:34,  9.64it/s]  6%|▌         | 22/358 [00:02<00:34,  9.70it/s]  7%|▋         | 24/358 [00:02<00:34,  9.78it/s]  7%|▋         | 25/358 [00:02<00:34,  9.73it/s]  7%|▋         | 26/358 [00:02<00:34,  9.68it/s]  8%|▊         | 27/358 [00:02<00:34,  9.73it/s]  8%|▊         | 28/358 [00:02<00:34,  9.69it/s]  8%|▊         | 29/358 [00:02<00:34,  9.66it/s]  9%|▊         | 31/358 [00:03<00:33,  9.76it/s]  9%|▉         | 32/358 [00:03<00:33,  9.75it/s]  9%|▉         | 34/358 [00:03<00:32,  9.85it/s] 10%|█         | 36/358 [00:03<00:32,  9.86it/s] 10%|█         | 37/358 [00:03<00:32,  9.84it/s] 11%|█         | 38/358 [00:03<00:32,  9.79it/s] 11%|█         | 40/358 [00:04<00:31,  9.95it/s] 11%|█▏        | 41/358 [00:04<00:32,  9.87it/s] 12%|█▏        | 43/358 [00:04<00:31,  9.89it/s] 13%|█▎        | 45/358 [00:04<00:31,  9.99it/s] 13%|█▎        | 47/358 [00:04<00:31,  9.96it/s] 13%|█▎        | 48/358 [00:04<00:31,  9.95it/s] 14%|█▍        | 50/358 [00:05<00:31,  9.92it/s] 14%|█▍        | 51/358 [00:05<00:31,  9.85it/s] 15%|█▍        | 52/358 [00:05<00:31,  9.76it/s] 15%|█▍        | 53/358 [00:05<00:31,  9.71it/s] 15%|█▌        | 54/358 [00:05<00:31,  9.76it/s] 15%|█▌        | 55/358 [00:05<00:31,  9.71it/s] 16%|█▌        | 56/358 [00:05<00:30,  9.74it/s] 16%|█▌        | 57/358 [00:05<00:31,  9.70it/s] 16%|█▌        | 58/358 [00:05<00:30,  9.68it/s] 16%|█▋        | 59/358 [00:06<00:30,  9.65it/s] 17%|█▋        | 61/358 [00:06<00:30,  9.74it/s] 17%|█▋        | 62/358 [00:06<00:30,  9.66it/s] 18%|█▊        | 63/358 [00:06<00:30,  9.72it/s] 18%|█▊        | 64/358 [00:06<00:30,  9.67it/s] 18%|█▊        | 66/358 [00:06<00:29,  9.74it/s] 19%|█▊        | 67/358 [00:06<00:29,  9.72it/s] 19%|█▉        | 69/358 [00:07<00:29,  9.79it/s] 20%|█▉        | 70/358 [00:07<00:29,  9.73it/s] 20%|█▉        | 71/358 [00:07<00:29,  9.78it/s] 20%|██        | 72/358 [00:07<00:29,  9.72it/s] 20%|██        | 73/358 [00:07<00:29,  9.70it/s] 21%|██        | 74/358 [00:07<00:29,  9.66it/s] 21%|██        | 75/358 [00:07<00:29,  9.63it/s] 22%|██▏       | 77/358 [00:07<00:28,  9.71it/s] 22%|██▏       | 79/358 [00:08<00:28,  9.71it/s] 23%|██▎       | 81/358 [00:08<00:28,  9.76it/s] 23%|██▎       | 83/358 [00:08<00:28,  9.79it/s] 23%|██▎       | 84/358 [00:08<00:28,  9.73it/s] 24%|██▎       | 85/358 [00:08<00:28,  9.69it/s] 24%|██▍       | 86/358 [00:08<00:28,  9.67it/s] 24%|██▍       | 87/358 [00:08<00:28,  9.66it/s] 25%|██▍       | 88/358 [00:09<00:27,  9.68it/s] 25%|██▌       | 90/358 [00:09<00:27,  9.91it/s] 26%|██▌       | 92/358 [00:09<00:26, 10.01it/s] 26%|██▌       | 93/358 [00:09<00:26,  9.98it/s] 26%|██▋       | 94/358 [00:09<00:26,  9.89it/s] 27%|██▋       | 96/358 [00:09<00:25, 10.17it/s] 27%|██▋       | 98/358 [00:09<00:25, 10.06it/s] 28%|██▊       | 100/358 [00:10<00:25, 10.01it/s] 28%|██▊       | 101/358 [00:10<00:25,  9.92it/s] 29%|██▉       | 103/358 [00:10<00:25,  9.91it/s] 29%|██▉       | 104/358 [00:10<00:25,  9.86it/s] 29%|██▉       | 105/358 [00:10<00:25,  9.79it/s] 30%|██▉       | 106/358 [00:10<00:25,  9.77it/s] 30%|███       | 108/358 [00:11<00:25,  9.80it/s] 30%|███       | 109/358 [00:11<00:25,  9.72it/s] 31%|███       | 110/358 [00:11<00:25,  9.70it/s] 31%|███       | 111/358 [00:11<00:25,  9.65it/s] 32%|███▏      | 113/358 [00:11<00:24,  9.92it/s] 32%|███▏      | 114/358 [00:11<00:24,  9.88it/s] 32%|███▏      | 115/358 [00:11<00:24,  9.79it/s] 32%|███▏      | 116/358 [00:11<00:24,  9.70it/s] 33%|███▎      | 117/358 [00:11<00:24,  9.67it/s] 33%|███▎      | 119/358 [00:12<00:24,  9.78it/s] 34%|███▍      | 121/358 [00:12<00:23,  9.98it/s] 34%|███▍      | 123/358 [00:12<00:23, 10.08it/s] 35%|███▍      | 125/358 [00:12<00:23, 10.06it/s] 35%|███▌      | 127/358 [00:12<00:23,  9.98it/s] 36%|███▌      | 128/358 [00:13<00:23,  9.94it/s] 36%|███▋      | 130/358 [00:13<00:22,  9.99it/s] 37%|███▋      | 131/358 [00:13<00:22,  9.90it/s] 37%|███▋      | 132/358 [00:13<00:22,  9.92it/s] 37%|███▋      | 134/358 [00:13<00:22,  9.94it/s] 38%|███▊      | 135/358 [00:13<00:22,  9.88it/s] 38%|███▊      | 137/358 [00:13<00:22,  9.96it/s] 39%|███▊      | 138/358 [00:14<00:22,  9.95it/s] 39%|███▉      | 139/358 [00:14<00:22,  9.86it/s] 39%|███▉      | 141/358 [00:14<00:21,  9.99it/s] 40%|███▉      | 142/358 [00:14<00:21,  9.91it/s] 40%|███▉      | 143/358 [00:14<00:21,  9.87it/s] 40%|████      | 144/358 [00:14<00:21,  9.79it/s] 41%|████      | 145/358 [00:14<00:21,  9.81it/s] 41%|████      | 146/358 [00:14<00:21,  9.75it/s] 41%|████      | 147/358 [00:14<00:21,  9.69it/s] 41%|████▏     | 148/358 [00:15<00:21,  9.72it/s] 42%|████▏     | 149/358 [00:15<00:21,  9.70it/s] 42%|████▏     | 150/358 [00:15<00:21,  9.66it/s] 42%|████▏     | 151/358 [00:15<00:22,  9.39it/s] 42%|████▏     | 152/358 [00:15<00:21,  9.44it/s] 43%|████▎     | 153/358 [00:15<00:21,  9.46it/s] 43%|████▎     | 154/358 [00:15<00:21,  9.55it/s] 43%|████▎     | 155/358 [00:15<00:21,  9.56it/s] 44%|████▎     | 156/358 [00:15<00:20,  9.69it/s] 44%|████▍     | 157/358 [00:16<00:20,  9.63it/s] 44%|████▍     | 158/358 [00:16<00:20,  9.71it/s] 44%|████▍     | 159/358 [00:16<00:20,  9.71it/s] 45%|████▍     | 160/358 [00:16<00:20,  9.72it/s] 45%|████▌     | 162/358 [00:16<00:19, 10.01it/s] 46%|████▌     | 164/358 [00:16<00:19, 10.01it/s] 46%|████▌     | 165/358 [00:16<00:19,  9.97it/s] 47%|████▋     | 167/358 [00:17<00:19,  9.91it/s] 47%|████▋     | 169/358 [00:17<00:18,  9.96it/s] 48%|████▊     | 171/358 [00:17<00:18,  9.94it/s] 48%|████▊     | 172/358 [00:17<00:18,  9.88it/s] 48%|████▊     | 173/358 [00:17<00:18,  9.82it/s] 49%|████▉     | 175/358 [00:17<00:18,  9.85it/s] 49%|████▉     | 176/358 [00:17<00:18,  9.86it/s] 49%|████▉     | 177/358 [00:18<00:18,  9.84it/s] 50%|█████     | 179/358 [00:18<00:18,  9.86it/s] 50%|█████     | 180/358 [00:18<00:18,  9.79it/s] 51%|█████     | 182/358 [00:18<00:17,  9.95it/s] 51%|█████     | 183/358 [00:18<00:17,  9.90it/s] 51%|█████▏    | 184/358 [00:18<00:17,  9.79it/s] 52%|█████▏    | 185/358 [00:18<00:17,  9.73it/s] 52%|█████▏    | 187/358 [00:19<00:17,  9.95it/s] 53%|█████▎    | 188/358 [00:19<00:17,  9.90it/s] 53%|█████▎    | 189/358 [00:19<00:17,  9.84it/s] 53%|█████▎    | 191/358 [00:19<00:17,  9.76it/s] 54%|█████▎    | 192/358 [00:19<00:17,  9.70it/s] 54%|█████▍    | 193/358 [00:19<00:17,  9.70it/s] 54%|█████▍    | 194/358 [00:19<00:16,  9.68it/s] 54%|█████▍    | 195/358 [00:19<00:16,  9.75it/s] 55%|█████▌    | 197/358 [00:20<00:16,  9.92it/s] 55%|█████▌    | 198/358 [00:20<00:16,  9.85it/s] 56%|█████▌    | 199/358 [00:20<00:16,  9.88it/s] 56%|█████▌    | 200/358 [00:20<00:16,  9.81it/s] 56%|█████▌    | 201/358 [00:20<00:16,  9.77it/s] 57%|█████▋    | 203/358 [00:20<00:15,  9.86it/s] 57%|█████▋    | 204/358 [00:20<00:15,  9.76it/s] 57%|█████▋    | 205/358 [00:20<00:15,  9.72it/s] 58%|█████▊    | 207/358 [00:21<00:15,  9.89it/s] 58%|█████▊    | 208/358 [00:21<00:15,  9.81it/s] 59%|█████▊    | 210/358 [00:21<00:15,  9.83it/s] 59%|█████▉    | 212/358 [00:21<00:14,  9.82it/s] 60%|█████▉    | 214/358 [00:21<00:14,  9.90it/s] 60%|██████    | 215/358 [00:21<00:14,  9.84it/s] 60%|██████    | 216/358 [00:22<00:14,  9.77it/s] 61%|██████    | 217/358 [00:22<00:14,  9.81it/s] 61%|██████    | 218/358 [00:22<00:14,  9.78it/s] 61%|██████    | 219/358 [00:22<00:14,  9.78it/s] 62%|██████▏   | 221/358 [00:22<00:13,  9.91it/s] 62%|██████▏   | 222/358 [00:22<00:13,  9.81it/s] 62%|██████▏   | 223/358 [00:22<00:13,  9.75it/s] 63%|██████▎   | 224/358 [00:22<00:13,  9.70it/s] 63%|██████▎   | 226/358 [00:23<00:13,  9.74it/s] 64%|██████▎   | 228/358 [00:23<00:13,  9.77it/s] 64%|██████▍   | 229/358 [00:23<00:13,  9.75it/s] 64%|██████▍   | 230/358 [00:23<00:13,  9.70it/s] 65%|██████▍   | 232/358 [00:23<00:12,  9.75it/s] 65%|██████▌   | 234/358 [00:23<00:12, 10.02it/s] 66%|██████▌   | 236/358 [00:24<00:12,  9.99it/s] 66%|██████▋   | 238/358 [00:24<00:11, 10.04it/s] 67%|██████▋   | 240/358 [00:24<00:11, 10.01it/s] 68%|██████▊   | 242/358 [00:24<00:11,  9.98it/s] 68%|██████▊   | 243/358 [00:24<00:11,  9.92it/s] 68%|██████▊   | 244/358 [00:24<00:11,  9.85it/s] 69%|██████▊   | 246/358 [00:25<00:11,  9.88it/s] 69%|██████▉   | 247/358 [00:25<00:11,  9.81it/s] 69%|██████▉   | 248/358 [00:25<00:11,  9.76it/s] 70%|██████▉   | 250/358 [00:25<00:10,  9.86it/s] 70%|███████   | 251/358 [00:25<00:10,  9.80it/s] 70%|███████   | 252/358 [00:25<00:10,  9.73it/s] 71%|███████   | 253/358 [00:25<00:10,  9.69it/s] 71%|███████   | 254/358 [00:25<00:10,  9.66it/s] 72%|███████▏  | 256/358 [00:26<00:10,  9.84it/s] 72%|███████▏  | 257/358 [00:26<00:10,  9.85it/s] 72%|███████▏  | 258/358 [00:26<00:10,  9.72it/s] 72%|███████▏  | 259/358 [00:26<00:10,  9.68it/s] 73%|███████▎  | 260/358 [00:26<00:10,  9.72it/s] 73%|███████▎  | 262/358 [00:26<00:09,  9.90it/s] 74%|███████▎  | 264/358 [00:26<00:09,  9.92it/s] 74%|███████▍  | 266/358 [00:27<00:09,  9.91it/s] 75%|███████▍  | 267/358 [00:27<00:09,  9.85it/s] 75%|███████▌  | 269/358 [00:27<00:08,  9.91it/s] 75%|███████▌  | 270/358 [00:27<00:08,  9.84it/s] 76%|███████▌  | 271/358 [00:27<00:08,  9.76it/s] 76%|███████▌  | 272/358 [00:27<00:08,  9.74it/s] 76%|███████▋  | 273/358 [00:27<00:08,  9.64it/s] 77%|███████▋  | 274/358 [00:27<00:08,  9.64it/s] 77%|███████▋  | 275/358 [00:28<00:08,  9.69it/s] 77%|███████▋  | 276/358 [00:28<00:08,  9.69it/s] 77%|███████▋  | 277/358 [00:28<00:08,  9.66it/s] 78%|███████▊  | 278/358 [00:28<00:08,  9.64it/s] 78%|███████▊  | 280/358 [00:28<00:07,  9.82it/s] 78%|███████▊  | 281/358 [00:28<00:07,  9.83it/s] 79%|███████▉  | 282/358 [00:28<00:07,  9.78it/s] 79%|███████▉  | 283/358 [00:28<00:07,  9.71it/s] 79%|███████▉  | 284/358 [00:28<00:07,  9.68it/s] 80%|███████▉  | 285/358 [00:29<00:07,  9.74it/s] 80%|███████▉  | 286/358 [00:29<00:07,  9.70it/s] 80%|████████  | 287/358 [00:29<00:07,  9.68it/s] 80%|████████  | 288/358 [00:29<00:07,  9.63it/s] 81%|████████  | 290/358 [00:29<00:06,  9.85it/s] 81%|████████▏ | 291/358 [00:29<00:06,  9.83it/s] 82%|████████▏ | 293/358 [00:29<00:06,  9.84it/s] 82%|████████▏ | 295/358 [00:30<00:06,  9.92it/s] 83%|████████▎ | 296/358 [00:30<00:06,  9.85it/s] 83%|████████▎ | 297/358 [00:30<00:06,  9.74it/s] 84%|████████▎ | 299/358 [00:30<00:05,  9.91it/s] 84%|████████▍ | 301/358 [00:30<00:05,  9.94it/s] 84%|████████▍ | 302/358 [00:30<00:05,  9.88it/s] 85%|████████▍ | 303/358 [00:30<00:05,  9.89it/s] 85%|████████▌ | 305/358 [00:31<00:05,  9.91it/s] 85%|████████▌ | 306/358 [00:31<00:05,  9.84it/s] 86%|████████▌ | 308/358 [00:31<00:05,  9.94it/s] 86%|████████▋ | 309/358 [00:31<00:04,  9.84it/s] 87%|████████▋ | 310/358 [00:31<00:04,  9.78it/s] 87%|████████▋ | 311/358 [00:31<00:04,  9.70it/s] 87%|████████▋ | 312/358 [00:31<00:04,  9.72it/s] 87%|████████▋ | 313/358 [00:31<00:04,  9.74it/s] 88%|████████▊ | 315/358 [00:32<00:04,  9.93it/s] 88%|████████▊ | 316/358 [00:32<00:04,  9.89it/s] 89%|████████▊ | 317/358 [00:32<00:04,  9.82it/s] 89%|████████▉ | 318/358 [00:32<00:04,  9.78it/s] 89%|████████▉ | 319/358 [00:32<00:04,  9.74it/s] 89%|████████▉ | 320/358 [00:32<00:03,  9.81it/s] 90%|████████▉ | 321/358 [00:32<00:03,  9.74it/s] 90%|████████▉ | 322/358 [00:32<00:03,  9.70it/s] 90%|█████████ | 323/358 [00:32<00:03,  9.66it/s] 91%|█████████ | 324/358 [00:33<00:03,  9.63it/s] 91%|█████████ | 325/358 [00:33<00:03,  9.61it/s] 91%|█████████▏| 327/358 [00:33<00:03,  9.97it/s] 92%|█████████▏| 329/358 [00:33<00:02, 10.07it/s] 92%|█████████▏| 330/358 [00:33<00:02,  9.96it/s] 93%|█████████▎| 332/358 [00:33<00:02, 10.06it/s] 93%|█████████▎| 334/358 [00:34<00:02,  9.97it/s] 94%|█████████▎| 335/358 [00:34<00:02,  9.84it/s] 94%|█████████▍| 337/358 [00:34<00:02,  9.92it/s] 95%|█████████▍| 339/358 [00:34<00:01, 10.12it/s] 95%|█████████▌| 341/358 [00:34<00:01, 10.07it/s] 96%|█████████▌| 343/358 [00:34<00:01,  9.90it/s] 96%|█████████▌| 344/358 [00:35<00:01,  9.85it/s] 96%|█████████▋| 345/358 [00:35<00:01,  9.87it/s] 97%|█████████▋| 347/358 [00:35<00:01, 10.04it/s] 97%|█████████▋| 348/358 [00:35<00:01,  9.95it/s] 97%|█████████▋| 349/358 [00:35<00:00,  9.86it/s] 98%|█████████▊| 350/358 [00:35<00:00,  9.79it/s] 98%|█████████▊| 351/358 [00:35<00:00,  9.74it/s] 99%|█████████▊| 353/358 [00:35<00:00,  9.92it/s] 99%|█████████▉| 354/358 [00:36<00:00,  9.91it/s] 99%|█████████▉| 355/358 [00:36<00:00,  9.82it/s]100%|█████████▉| 357/358 [00:36<00:00,  9.87it/s]100%|██████████| 358/358 [00:36<00:00,  9.83it/s]
[32m2025-02-05 06:37:19.890[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    gen_loss  grad clip ratio  grad norm   ppl
       1.736                1       3.69 5.677[0m
[32m2025-02-05 06:37:19.890[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m169[0m - [1m[Valid][0m
  0%|          | 0/10256 [00:00<?, ?it/s]100%|██████████| 10256/10256 [00:00<00:00, 930656.00it/s]
[32m2025-02-05 06:37:19.901[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:27,  1.43it/s]  5%|▌         | 2/40 [00:01<00:26,  1.44it/s]  8%|▊         | 3/40 [00:02<00:25,  1.45it/s] 10%|█         | 4/40 [00:02<00:24,  1.45it/s] 12%|█▎        | 5/40 [00:03<00:24,  1.45it/s] 15%|█▌        | 6/40 [00:04<00:23,  1.45it/s] 18%|█▊        | 7/40 [00:04<00:22,  1.44it/s] 20%|██        | 8/40 [00:05<00:22,  1.45it/s] 22%|██▎       | 9/40 [00:06<00:21,  1.45it/s] 25%|██▌       | 10/40 [00:06<00:20,  1.45it/s] 28%|██▊       | 11/40 [00:07<00:20,  1.45it/s] 30%|███       | 12/40 [00:08<00:19,  1.45it/s] 32%|███▎      | 13/40 [00:08<00:18,  1.45it/s] 35%|███▌      | 14/40 [00:09<00:18,  1.44it/s] 38%|███▊      | 15/40 [00:10<00:17,  1.45it/s] 40%|████      | 16/40 [00:11<00:16,  1.45it/s] 42%|████▎     | 17/40 [00:11<00:15,  1.45it/s] 45%|████▌     | 18/40 [00:12<00:15,  1.45it/s] 48%|████▊     | 19/40 [00:13<00:14,  1.45it/s] 50%|█████     | 20/40 [00:13<00:13,  1.46it/s] 52%|█████▎    | 21/40 [00:14<00:13,  1.46it/s] 55%|█████▌    | 22/40 [00:15<00:12,  1.46it/s] 57%|█████▊    | 23/40 [00:15<00:11,  1.46it/s] 60%|██████    | 24/40 [00:16<00:11,  1.45it/s] 62%|██████▎   | 25/40 [00:17<00:10,  1.45it/s] 65%|██████▌   | 26/40 [00:17<00:09,  1.46it/s] 68%|██████▊   | 27/40 [00:18<00:08,  1.46it/s] 70%|███████   | 28/40 [00:19<00:08,  1.46it/s] 72%|███████▎  | 29/40 [00:19<00:07,  1.46it/s] 75%|███████▌  | 30/40 [00:20<00:06,  1.47it/s] 78%|███████▊  | 31/40 [00:21<00:06,  1.46it/s] 80%|████████  | 32/40 [00:22<00:05,  1.46it/s] 82%|████████▎ | 33/40 [00:22<00:04,  1.46it/s] 85%|████████▌ | 34/40 [00:23<00:04,  1.46it/s] 88%|████████▊ | 35/40 [00:24<00:03,  1.46it/s] 90%|█████████ | 36/40 [00:24<00:02,  1.45it/s] 92%|█████████▎| 37/40 [00:25<00:02,  1.45it/s] 95%|█████████▌| 38/40 [00:26<00:01,  1.44it/s] 98%|█████████▊| 39/40 [00:26<00:00,  1.44it/s]100%|██████████| 40/40 [00:27<00:00,  1.60it/s]100%|██████████| 40/40 [00:27<00:00,  1.46it/s]
[32m2025-02-05 06:37:47.238[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    average  bleu@1  bleu@2  bleu@3  bleu@4  dist@1  dist@2  dist@3  dist@4  extreme  \
      .7778   .2985   .1104  .04281   .0213  .04196   .2936   .5675   .7321    .6002   
      f1  gen_loss  greedy  intra_dist@1  intra_dist@2  intra_dist@3  intra_dist@4  \
   .3496     5.333   .6695         .8592         .9591         .9454         .9103   
    ppl  rouge1  rouge2  rougeL  
    207   .3863  .08997   .3735[0m
[32m2025-02-05 06:37:47.244[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m163[0m - [1m[Conversation epoch 84][0m
[32m2025-02-05 06:37:47.244[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m164[0m - [1m[Train][0m
  0%|          | 0/92414 [00:00<?, ?it/s]100%|██████████| 92414/92414 [00:00<00:00, 1086315.03it/s]
[32m2025-02-05 06:37:47.330[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/358 [00:00<?, ?it/s]  0%|          | 1/358 [00:00<00:36,  9.77it/s]  1%|          | 3/358 [00:00<00:35,  9.93it/s]  1%|          | 4/358 [00:00<00:35,  9.91it/s]  2%|▏         | 6/358 [00:00<00:35,  9.88it/s]  2%|▏         | 7/358 [00:00<00:35,  9.82it/s]  2%|▏         | 8/358 [00:00<00:35,  9.86it/s]  3%|▎         | 9/358 [00:00<00:35,  9.76it/s]  3%|▎         | 10/358 [00:01<00:35,  9.76it/s]  3%|▎         | 11/358 [00:01<00:35,  9.70it/s]  4%|▎         | 13/358 [00:01<00:34,  9.92it/s]  4%|▍         | 14/358 [00:01<00:34,  9.85it/s]  4%|▍         | 15/358 [00:01<00:35,  9.77it/s]  4%|▍         | 16/358 [00:01<00:35,  9.71it/s]  5%|▍         | 17/358 [00:01<00:35,  9.73it/s]  5%|▌         | 19/358 [00:01<00:34,  9.76it/s]  6%|▌         | 20/358 [00:02<00:34,  9.71it/s]  6%|▌         | 21/358 [00:02<00:34,  9.64it/s]  6%|▌         | 22/358 [00:02<00:34,  9.69it/s]  7%|▋         | 24/358 [00:02<00:34,  9.78it/s]  7%|▋         | 25/358 [00:02<00:34,  9.73it/s]  7%|▋         | 26/358 [00:02<00:34,  9.68it/s]  8%|▊         | 27/358 [00:02<00:33,  9.74it/s]  8%|▊         | 28/358 [00:02<00:34,  9.69it/s]  8%|▊         | 29/358 [00:02<00:34,  9.66it/s]  9%|▊         | 31/358 [00:03<00:33,  9.76it/s]  9%|▉         | 32/358 [00:03<00:33,  9.76it/s]  9%|▉         | 34/358 [00:03<00:32,  9.85it/s] 10%|█         | 36/358 [00:03<00:32,  9.85it/s] 10%|█         | 37/358 [00:03<00:32,  9.84it/s] 11%|█         | 38/358 [00:03<00:32,  9.79it/s] 11%|█         | 40/358 [00:04<00:31,  9.95it/s] 11%|█▏        | 41/358 [00:04<00:32,  9.86it/s] 12%|█▏        | 43/358 [00:04<00:31,  9.89it/s] 13%|█▎        | 45/358 [00:04<00:31,  9.99it/s] 13%|█▎        | 47/358 [00:04<00:31,  9.96it/s] 13%|█▎        | 48/358 [00:04<00:31,  9.95it/s] 14%|█▍        | 50/358 [00:05<00:31,  9.92it/s] 14%|█▍        | 51/358 [00:05<00:31,  9.85it/s] 15%|█▍        | 52/358 [00:05<00:31,  9.76it/s] 15%|█▍        | 53/358 [00:05<00:31,  9.71it/s] 15%|█▌        | 54/358 [00:05<00:31,  9.76it/s] 15%|█▌        | 55/358 [00:05<00:31,  9.70it/s] 16%|█▌        | 56/358 [00:05<00:30,  9.75it/s] 16%|█▌        | 57/358 [00:05<00:31,  9.71it/s] 16%|█▌        | 58/358 [00:05<00:30,  9.68it/s] 16%|█▋        | 59/358 [00:06<00:30,  9.65it/s] 17%|█▋        | 61/358 [00:06<00:30,  9.73it/s] 17%|█▋        | 62/358 [00:06<00:30,  9.65it/s] 18%|█▊        | 63/358 [00:06<00:30,  9.72it/s] 18%|█▊        | 64/358 [00:06<00:30,  9.67it/s] 18%|█▊        | 66/358 [00:06<00:29,  9.74it/s] 19%|█▊        | 67/358 [00:06<00:29,  9.72it/s] 19%|█▉        | 69/358 [00:07<00:29,  9.79it/s] 20%|█▉        | 70/358 [00:07<00:29,  9.73it/s] 20%|█▉        | 71/358 [00:07<00:29,  9.78it/s] 20%|██        | 72/358 [00:07<00:29,  9.73it/s] 20%|██        | 73/358 [00:07<00:29,  9.69it/s] 21%|██        | 74/358 [00:07<00:29,  9.66it/s] 21%|██        | 75/358 [00:07<00:29,  9.63it/s] 21%|██        | 76/358 [00:07<00:28,  9.73it/s] 22%|██▏       | 77/358 [00:07<00:28,  9.70it/s] 22%|██▏       | 79/358 [00:08<00:28,  9.70it/s] 23%|██▎       | 81/358 [00:08<00:28,  9.76it/s] 23%|██▎       | 83/358 [00:08<00:28,  9.78it/s] 23%|██▎       | 84/358 [00:08<00:28,  9.73it/s] 24%|██▎       | 85/358 [00:08<00:28,  9.69it/s] 24%|██▍       | 86/358 [00:08<00:28,  9.67it/s] 24%|██▍       | 87/358 [00:08<00:28,  9.65it/s] 25%|██▍       | 88/358 [00:09<00:27,  9.67it/s] 25%|██▌       | 90/358 [00:09<00:27,  9.90it/s] 26%|██▌       | 92/358 [00:09<00:26, 10.00it/s] 26%|██▌       | 93/358 [00:09<00:26,  9.96it/s] 26%|██▋       | 94/358 [00:09<00:26,  9.88it/s] 27%|██▋       | 96/358 [00:09<00:25, 10.16it/s] 27%|██▋       | 98/358 [00:09<00:25, 10.05it/s] 28%|██▊       | 99/358 [00:10<00:26,  9.96it/s] 28%|██▊       | 101/358 [00:10<00:25,  9.93it/s] 29%|██▉       | 103/358 [00:10<00:25,  9.92it/s] 29%|██▉       | 104/358 [00:10<00:25,  9.87it/s] 29%|██▉       | 105/358 [00:10<00:25,  9.79it/s] 30%|██▉       | 106/358 [00:10<00:25,  9.78it/s] 30%|███       | 108/358 [00:11<00:25,  9.81it/s] 30%|███       | 109/358 [00:11<00:25,  9.72it/s] 31%|███       | 110/358 [00:11<00:25,  9.70it/s] 31%|███       | 111/358 [00:11<00:25,  9.65it/s] 32%|███▏      | 113/358 [00:11<00:24,  9.92it/s] 32%|███▏      | 114/358 [00:11<00:24,  9.88it/s] 32%|███▏      | 115/358 [00:11<00:24,  9.78it/s] 32%|███▏      | 116/358 [00:11<00:24,  9.70it/s] 33%|███▎      | 117/358 [00:11<00:24,  9.67it/s] 33%|███▎      | 119/358 [00:12<00:24,  9.79it/s] 34%|███▍      | 121/358 [00:12<00:23,  9.99it/s] 34%|███▍      | 123/358 [00:12<00:23, 10.09it/s] 35%|███▍      | 125/358 [00:12<00:23, 10.07it/s] 35%|███▌      | 127/358 [00:12<00:23,  9.99it/s] 36%|███▌      | 128/358 [00:13<00:23,  9.95it/s] 36%|███▋      | 130/358 [00:13<00:22, 10.00it/s] 37%|███▋      | 131/358 [00:13<00:22,  9.91it/s] 37%|███▋      | 132/358 [00:13<00:22,  9.92it/s] 37%|███▋      | 134/358 [00:13<00:22,  9.94it/s] 38%|███▊      | 135/358 [00:13<00:22,  9.88it/s] 38%|███▊      | 137/358 [00:13<00:22,  9.97it/s] 39%|███▊      | 138/358 [00:14<00:22,  9.95it/s] 39%|███▉      | 139/358 [00:14<00:22,  9.86it/s] 39%|███▉      | 141/358 [00:14<00:21,  9.99it/s] 40%|███▉      | 142/358 [00:14<00:21,  9.91it/s] 40%|███▉      | 143/358 [00:14<00:21,  9.88it/s] 40%|████      | 144/358 [00:14<00:21,  9.79it/s] 41%|████      | 145/358 [00:14<00:21,  9.81it/s] 41%|████      | 146/358 [00:14<00:21,  9.75it/s] 41%|████      | 147/358 [00:14<00:21,  9.69it/s] 41%|████▏     | 148/358 [00:15<00:21,  9.72it/s] 42%|████▏     | 149/358 [00:15<00:21,  9.70it/s] 42%|████▏     | 150/358 [00:15<00:21,  9.66it/s] 42%|████▏     | 151/358 [00:15<00:22,  9.39it/s] 42%|████▏     | 152/358 [00:15<00:21,  9.44it/s] 43%|████▎     | 153/358 [00:15<00:21,  9.46it/s] 43%|████▎     | 154/358 [00:15<00:21,  9.55it/s] 43%|████▎     | 155/358 [00:15<00:21,  9.56it/s] 44%|████▎     | 156/358 [00:15<00:20,  9.69it/s] 44%|████▍     | 157/358 [00:16<00:20,  9.63it/s] 44%|████▍     | 158/358 [00:16<00:20,  9.71it/s] 44%|████▍     | 159/358 [00:16<00:20,  9.71it/s] 45%|████▍     | 160/358 [00:16<00:20,  9.71it/s] 45%|████▌     | 162/358 [00:16<00:19, 10.01it/s] 46%|████▌     | 164/358 [00:16<00:19, 10.01it/s] 46%|████▌     | 165/358 [00:16<00:19,  9.97it/s] 47%|████▋     | 167/358 [00:17<00:19,  9.91it/s] 47%|████▋     | 169/358 [00:17<00:18,  9.95it/s] 48%|████▊     | 171/358 [00:17<00:18,  9.93it/s] 48%|████▊     | 172/358 [00:17<00:18,  9.88it/s] 48%|████▊     | 173/358 [00:17<00:18,  9.82it/s] 49%|████▉     | 175/358 [00:17<00:18,  9.84it/s] 49%|████▉     | 176/358 [00:17<00:18,  9.85it/s] 49%|████▉     | 177/358 [00:18<00:18,  9.84it/s] 50%|█████     | 179/358 [00:18<00:18,  9.86it/s] 50%|█████     | 180/358 [00:18<00:18,  9.79it/s] 51%|█████     | 182/358 [00:18<00:17,  9.94it/s] 51%|█████     | 183/358 [00:18<00:17,  9.90it/s] 51%|█████▏    | 184/358 [00:18<00:17,  9.79it/s] 52%|█████▏    | 185/358 [00:18<00:17,  9.74it/s] 52%|█████▏    | 187/358 [00:19<00:17,  9.95it/s] 53%|█████▎    | 188/358 [00:19<00:17,  9.89it/s] 53%|█████▎    | 189/358 [00:19<00:17,  9.84it/s] 53%|█████▎    | 191/358 [00:19<00:17,  9.76it/s] 54%|█████▎    | 192/358 [00:19<00:17,  9.71it/s] 54%|█████▍    | 193/358 [00:19<00:17,  9.70it/s] 54%|█████▍    | 194/358 [00:19<00:16,  9.68it/s] 54%|█████▍    | 195/358 [00:19<00:16,  9.75it/s] 55%|█████▌    | 197/358 [00:20<00:16,  9.92it/s] 55%|█████▌    | 198/358 [00:20<00:16,  9.85it/s] 56%|█████▌    | 199/358 [00:20<00:16,  9.88it/s] 56%|█████▌    | 200/358 [00:20<00:16,  9.81it/s] 56%|█████▌    | 201/358 [00:20<00:16,  9.77it/s] 57%|█████▋    | 203/358 [00:20<00:15,  9.86it/s] 57%|█████▋    | 204/358 [00:20<00:15,  9.76it/s] 57%|█████▋    | 205/358 [00:20<00:15,  9.71it/s] 58%|█████▊    | 207/358 [00:21<00:15,  9.88it/s] 58%|█████▊    | 208/358 [00:21<00:15,  9.81it/s] 59%|█████▊    | 210/358 [00:21<00:15,  9.83it/s] 59%|█████▉    | 212/358 [00:21<00:14,  9.82it/s] 60%|█████▉    | 214/358 [00:21<00:14,  9.90it/s] 60%|██████    | 215/358 [00:21<00:14,  9.83it/s] 60%|██████    | 216/358 [00:22<00:14,  9.77it/s] 61%|██████    | 217/358 [00:22<00:14,  9.81it/s] 61%|██████    | 218/358 [00:22<00:14,  9.78it/s] 61%|██████    | 219/358 [00:22<00:14,  9.78it/s] 62%|██████▏   | 221/358 [00:22<00:13,  9.91it/s] 62%|██████▏   | 222/358 [00:22<00:13,  9.81it/s] 62%|██████▏   | 223/358 [00:22<00:13,  9.76it/s] 63%|██████▎   | 224/358 [00:22<00:13,  9.70it/s] 63%|██████▎   | 226/358 [00:23<00:13,  9.74it/s] 64%|██████▎   | 228/358 [00:23<00:13,  9.77it/s] 64%|██████▍   | 229/358 [00:23<00:13,  9.75it/s] 64%|██████▍   | 230/358 [00:23<00:13,  9.70it/s] 65%|██████▍   | 232/358 [00:23<00:12,  9.74it/s] 65%|██████▌   | 234/358 [00:23<00:12, 10.03it/s] 66%|██████▌   | 236/358 [00:24<00:12,  9.99it/s] 66%|██████▋   | 238/358 [00:24<00:11, 10.04it/s] 67%|██████▋   | 240/358 [00:24<00:11, 10.00it/s] 68%|██████▊   | 242/358 [00:24<00:11,  9.98it/s] 68%|██████▊   | 243/358 [00:24<00:11,  9.92it/s] 68%|██████▊   | 244/358 [00:24<00:11,  9.86it/s] 69%|██████▊   | 246/358 [00:25<00:11,  9.88it/s] 69%|██████▉   | 247/358 [00:25<00:11,  9.81it/s] 69%|██████▉   | 248/358 [00:25<00:11,  9.76it/s] 70%|██████▉   | 250/358 [00:25<00:10,  9.86it/s] 70%|███████   | 251/358 [00:25<00:10,  9.80it/s] 70%|███████   | 252/358 [00:25<00:10,  9.71it/s] 71%|███████   | 253/358 [00:25<00:10,  9.68it/s] 71%|███████   | 254/358 [00:25<00:10,  9.65it/s] 72%|███████▏  | 256/358 [00:26<00:10,  9.83it/s] 72%|███████▏  | 257/358 [00:26<00:10,  9.84it/s] 72%|███████▏  | 258/358 [00:26<00:10,  9.71it/s] 72%|███████▏  | 259/358 [00:26<00:10,  9.68it/s] 73%|███████▎  | 260/358 [00:26<00:10,  9.71it/s] 73%|███████▎  | 262/358 [00:26<00:09,  9.89it/s] 74%|███████▎  | 264/358 [00:26<00:09,  9.91it/s] 74%|███████▍  | 266/358 [00:27<00:09,  9.90it/s] 75%|███████▍  | 267/358 [00:27<00:09,  9.85it/s] 75%|███████▌  | 269/358 [00:27<00:08,  9.90it/s] 75%|███████▌  | 270/358 [00:27<00:08,  9.83it/s] 76%|███████▌  | 271/358 [00:27<00:08,  9.76it/s] 76%|███████▌  | 272/358 [00:27<00:08,  9.74it/s] 76%|███████▋  | 273/358 [00:27<00:08,  9.64it/s] 77%|███████▋  | 274/358 [00:27<00:08,  9.64it/s] 77%|███████▋  | 275/358 [00:28<00:08,  9.69it/s] 77%|███████▋  | 276/358 [00:28<00:08,  9.69it/s] 77%|███████▋  | 277/358 [00:28<00:08,  9.66it/s] 78%|███████▊  | 278/358 [00:28<00:08,  9.63it/s] 78%|███████▊  | 280/358 [00:28<00:07,  9.82it/s] 78%|███████▊  | 281/358 [00:28<00:07,  9.83it/s] 79%|███████▉  | 282/358 [00:28<00:07,  9.77it/s] 79%|███████▉  | 283/358 [00:28<00:07,  9.71it/s] 79%|███████▉  | 284/358 [00:28<00:07,  9.67it/s] 80%|███████▉  | 285/358 [00:29<00:07,  9.74it/s] 80%|███████▉  | 286/358 [00:29<00:07,  9.70it/s] 80%|████████  | 287/358 [00:29<00:07,  9.67it/s] 80%|████████  | 288/358 [00:29<00:07,  9.63it/s] 81%|████████  | 290/358 [00:29<00:06,  9.85it/s] 81%|████████▏ | 291/358 [00:29<00:06,  9.83it/s] 82%|████████▏ | 293/358 [00:29<00:06,  9.84it/s] 82%|████████▏ | 295/358 [00:30<00:06,  9.91it/s] 83%|████████▎ | 296/358 [00:30<00:06,  9.85it/s] 83%|████████▎ | 297/358 [00:30<00:06,  9.74it/s] 84%|████████▎ | 299/358 [00:30<00:05,  9.90it/s] 84%|████████▍ | 301/358 [00:30<00:05,  9.94it/s] 84%|████████▍ | 302/358 [00:30<00:05,  9.87it/s] 85%|████████▍ | 303/358 [00:30<00:05,  9.88it/s] 85%|████████▌ | 305/358 [00:31<00:05,  9.88it/s] 85%|████████▌ | 306/358 [00:31<00:05,  9.81it/s] 86%|████████▌ | 308/358 [00:31<00:05,  9.91it/s] 86%|████████▋ | 309/358 [00:31<00:04,  9.81it/s] 87%|████████▋ | 310/358 [00:31<00:04,  9.76it/s] 87%|████████▋ | 311/358 [00:31<00:04,  9.69it/s] 87%|████████▋ | 312/358 [00:31<00:04,  9.71it/s] 87%|████████▋ | 313/358 [00:31<00:04,  9.73it/s] 88%|████████▊ | 315/358 [00:32<00:04,  9.99it/s] 88%|████████▊ | 316/358 [00:32<00:04,  9.94it/s] 89%|████████▊ | 317/358 [00:32<00:04,  9.86it/s] 89%|████████▉ | 318/358 [00:32<00:04,  9.81it/s] 89%|████████▉ | 319/358 [00:32<00:03,  9.76it/s] 89%|████████▉ | 320/358 [00:32<00:03,  9.82it/s] 90%|████████▉ | 321/358 [00:32<00:03,  9.74it/s] 90%|████████▉ | 322/358 [00:32<00:03,  9.71it/s] 90%|█████████ | 323/358 [00:32<00:03,  9.66it/s] 91%|█████████ | 324/358 [00:33<00:03,  9.63it/s] 91%|█████████ | 325/358 [00:33<00:03,  9.61it/s] 91%|█████████▏| 327/358 [00:33<00:03,  9.97it/s] 92%|█████████▏| 329/358 [00:33<00:02, 10.08it/s] 92%|█████████▏| 330/358 [00:33<00:02,  9.97it/s] 93%|█████████▎| 332/358 [00:33<00:02, 10.06it/s] 93%|█████████▎| 334/358 [00:34<00:02,  9.97it/s] 94%|█████████▎| 335/358 [00:34<00:02,  9.84it/s] 94%|█████████▍| 337/358 [00:34<00:02,  9.92it/s] 95%|█████████▍| 339/358 [00:34<00:01, 10.12it/s] 95%|█████████▌| 341/358 [00:34<00:01, 10.06it/s] 96%|█████████▌| 343/358 [00:34<00:01,  9.90it/s] 96%|█████████▌| 344/358 [00:35<00:01,  9.84it/s] 96%|█████████▋| 345/358 [00:35<00:01,  9.86it/s] 97%|█████████▋| 347/358 [00:35<00:01, 10.04it/s] 97%|█████████▋| 348/358 [00:35<00:01,  9.95it/s] 97%|█████████▋| 349/358 [00:35<00:00,  9.87it/s] 98%|█████████▊| 350/358 [00:35<00:00,  9.79it/s] 98%|█████████▊| 351/358 [00:35<00:00,  9.75it/s] 99%|█████████▊| 353/358 [00:35<00:00,  9.93it/s] 99%|█████████▉| 354/358 [00:36<00:00,  9.90it/s] 99%|█████████▉| 355/358 [00:36<00:00,  9.82it/s]100%|█████████▉| 357/358 [00:36<00:00,  9.87it/s]100%|██████████| 358/358 [00:36<00:00,  9.83it/s]
[32m2025-02-05 06:38:23.755[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    gen_loss  grad clip ratio  grad norm   ppl
       1.733                1      2.477 5.658[0m
[32m2025-02-05 06:38:23.756[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m169[0m - [1m[Valid][0m
  0%|          | 0/10256 [00:00<?, ?it/s]100%|██████████| 10256/10256 [00:00<00:00, 922513.01it/s]
[32m2025-02-05 06:38:23.767[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:27,  1.42it/s]  5%|▌         | 2/40 [00:01<00:26,  1.44it/s]  8%|▊         | 3/40 [00:02<00:25,  1.44it/s] 10%|█         | 4/40 [00:02<00:24,  1.44it/s] 12%|█▎        | 5/40 [00:03<00:24,  1.44it/s] 15%|█▌        | 6/40 [00:04<00:23,  1.44it/s] 18%|█▊        | 7/40 [00:04<00:22,  1.44it/s] 20%|██        | 8/40 [00:05<00:22,  1.44it/s] 22%|██▎       | 9/40 [00:06<00:21,  1.45it/s] 25%|██▌       | 10/40 [00:06<00:20,  1.45it/s] 28%|██▊       | 11/40 [00:07<00:20,  1.45it/s] 30%|███       | 12/40 [00:08<00:19,  1.45it/s] 32%|███▎      | 13/40 [00:08<00:18,  1.45it/s] 35%|███▌      | 14/40 [00:09<00:18,  1.44it/s] 38%|███▊      | 15/40 [00:10<00:17,  1.45it/s] 40%|████      | 16/40 [00:11<00:16,  1.44it/s] 42%|████▎     | 17/40 [00:11<00:15,  1.45it/s] 45%|████▌     | 18/40 [00:12<00:15,  1.45it/s] 48%|████▊     | 19/40 [00:13<00:14,  1.44it/s] 50%|█████     | 20/40 [00:13<00:13,  1.45it/s] 52%|█████▎    | 21/40 [00:14<00:13,  1.45it/s] 55%|█████▌    | 22/40 [00:15<00:12,  1.45it/s] 57%|█████▊    | 23/40 [00:15<00:11,  1.45it/s] 60%|██████    | 24/40 [00:16<00:11,  1.44it/s] 62%|██████▎   | 25/40 [00:17<00:10,  1.44it/s] 65%|██████▌   | 26/40 [00:17<00:09,  1.46it/s] 68%|██████▊   | 27/40 [00:18<00:08,  1.45it/s] 70%|███████   | 28/40 [00:19<00:08,  1.45it/s] 72%|███████▎  | 29/40 [00:20<00:07,  1.45it/s] 75%|███████▌  | 30/40 [00:20<00:06,  1.46it/s] 78%|███████▊  | 31/40 [00:21<00:06,  1.46it/s] 80%|████████  | 32/40 [00:22<00:05,  1.46it/s] 82%|████████▎ | 33/40 [00:22<00:04,  1.45it/s] 85%|████████▌ | 34/40 [00:23<00:04,  1.45it/s] 88%|████████▊ | 35/40 [00:24<00:03,  1.45it/s] 90%|█████████ | 36/40 [00:24<00:02,  1.44it/s] 92%|█████████▎| 37/40 [00:25<00:02,  1.45it/s] 95%|█████████▌| 38/40 [00:26<00:01,  1.44it/s] 98%|█████████▊| 39/40 [00:26<00:00,  1.44it/s]100%|██████████| 40/40 [00:27<00:00,  1.59it/s]100%|██████████| 40/40 [00:27<00:00,  1.46it/s]
[32m2025-02-05 06:38:51.209[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    average  bleu@1  bleu@2  bleu@3  bleu@4  dist@1  dist@2  dist@3  dist@4  extreme  \
      .7787   .2962   .1089  .03945  .01815  .04239   .2976   .5793   .7518    .5974   
      f1  gen_loss  greedy  intra_dist@1  intra_dist@2  intra_dist@3  intra_dist@4  \
   .3497     5.348   .6682         .8612         .9624         .9506         .9237   
     ppl  rouge1  rouge2  rougeL  
   210.2   .3833  .08743   .3710[0m
[32m2025-02-05 06:38:51.216[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m163[0m - [1m[Conversation epoch 85][0m
[32m2025-02-05 06:38:51.216[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m164[0m - [1m[Train][0m
  0%|          | 0/92414 [00:00<?, ?it/s]100%|██████████| 92414/92414 [00:00<00:00, 1100649.44it/s]
[32m2025-02-05 06:38:51.300[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/358 [00:00<?, ?it/s]  0%|          | 1/358 [00:00<00:36,  9.76it/s]  1%|          | 3/358 [00:00<00:35,  9.94it/s]  1%|          | 4/358 [00:00<00:35,  9.92it/s]  2%|▏         | 6/358 [00:00<00:35,  9.89it/s]  2%|▏         | 7/358 [00:00<00:35,  9.82it/s]  2%|▏         | 8/358 [00:00<00:35,  9.87it/s]  3%|▎         | 9/358 [00:00<00:35,  9.77it/s]  3%|▎         | 10/358 [00:01<00:35,  9.76it/s]  3%|▎         | 11/358 [00:01<00:35,  9.71it/s]  4%|▎         | 13/358 [00:01<00:34,  9.93it/s]  4%|▍         | 14/358 [00:01<00:34,  9.86it/s]  4%|▍         | 15/358 [00:01<00:35,  9.78it/s]  4%|▍         | 16/358 [00:01<00:35,  9.72it/s]  5%|▍         | 17/358 [00:01<00:35,  9.73it/s]  5%|▌         | 18/358 [00:01<00:34,  9.81it/s]  5%|▌         | 19/358 [00:01<00:34,  9.74it/s]  6%|▌         | 20/358 [00:02<00:34,  9.68it/s]  6%|▌         | 21/358 [00:02<00:35,  9.61it/s]  6%|▌         | 22/358 [00:02<00:34,  9.68it/s]  7%|▋         | 24/358 [00:02<00:34,  9.78it/s]  7%|▋         | 25/358 [00:02<00:34,  9.72it/s]  7%|▋         | 26/358 [00:02<00:34,  9.68it/s]  8%|▊         | 27/358 [00:02<00:33,  9.74it/s]  8%|▊         | 28/358 [00:02<00:34,  9.69it/s]  8%|▊         | 29/358 [00:02<00:34,  9.66it/s]  9%|▊         | 31/358 [00:03<00:33,  9.76it/s]  9%|▉         | 32/358 [00:03<00:33,  9.75it/s]  9%|▉         | 34/358 [00:03<00:32,  9.86it/s] 10%|█         | 36/358 [00:03<00:32,  9.85it/s] 10%|█         | 37/358 [00:03<00:32,  9.84it/s] 11%|█         | 38/358 [00:03<00:32,  9.79it/s] 11%|█         | 40/358 [00:04<00:31,  9.95it/s] 11%|█▏        | 41/358 [00:04<00:32,  9.86it/s] 12%|█▏        | 43/358 [00:04<00:31,  9.88it/s] 13%|█▎        | 45/358 [00:04<00:31,  9.98it/s] 13%|█▎        | 47/358 [00:04<00:31,  9.95it/s] 13%|█▎        | 48/358 [00:04<00:31,  9.94it/s] 14%|█▍        | 50/358 [00:05<00:31,  9.91it/s] 14%|█▍        | 51/358 [00:05<00:31,  9.84it/s] 15%|█▍        | 52/358 [00:05<00:31,  9.75it/s] 15%|█▍        | 53/358 [00:05<00:31,  9.70it/s] 15%|█▌        | 54/358 [00:05<00:31,  9.75it/s] 15%|█▌        | 55/358 [00:05<00:31,  9.69it/s] 16%|█▌        | 56/358 [00:05<00:31,  9.74it/s] 16%|█▌        | 57/358 [00:05<00:31,  9.69it/s] 16%|█▌        | 58/358 [00:05<00:31,  9.67it/s] 16%|█▋        | 59/358 [00:06<00:31,  9.64it/s] 17%|█▋        | 61/358 [00:06<00:30,  9.73it/s] 17%|█▋        | 62/358 [00:06<00:30,  9.65it/s] 18%|█▊        | 63/358 [00:06<00:30,  9.71it/s] 18%|█▊        | 64/358 [00:06<00:30,  9.67it/s] 18%|█▊        | 66/358 [00:06<00:29,  9.74it/s] 19%|█▊        | 67/358 [00:06<00:29,  9.72it/s] 19%|█▉        | 69/358 [00:07<00:29,  9.79it/s] 20%|█▉        | 70/358 [00:07<00:29,  9.73it/s] 20%|█▉        | 71/358 [00:07<00:29,  9.78it/s] 20%|██        | 72/358 [00:07<00:29,  9.72it/s] 20%|██        | 73/358 [00:07<00:29,  9.69it/s] 21%|██        | 74/358 [00:07<00:29,  9.65it/s] 21%|██        | 75/358 [00:07<00:29,  9.62it/s] 22%|██▏       | 77/358 [00:07<00:28,  9.70it/s] 22%|██▏       | 79/358 [00:08<00:28,  9.71it/s] 23%|██▎       | 81/358 [00:08<00:28,  9.76it/s] 23%|██▎       | 83/358 [00:08<00:28,  9.78it/s] 23%|██▎       | 84/358 [00:08<00:28,  9.74it/s] 24%|██▎       | 85/358 [00:08<00:28,  9.69it/s] 24%|██▍       | 86/358 [00:08<00:28,  9.68it/s] 24%|██▍       | 87/358 [00:08<00:28,  9.66it/s] 25%|██▍       | 88/358 [00:09<00:27,  9.68it/s] 25%|██▌       | 90/358 [00:09<00:27,  9.91it/s] 26%|██▌       | 92/358 [00:09<00:26, 10.01it/s] 26%|██▌       | 93/358 [00:09<00:26,  9.97it/s] 26%|██▋       | 94/358 [00:09<00:26,  9.88it/s] 27%|██▋       | 96/358 [00:09<00:25, 10.17it/s] 27%|██▋       | 98/358 [00:09<00:25, 10.06it/s] 28%|██▊       | 100/358 [00:10<00:25, 10.01it/s] 28%|██▊       | 101/358 [00:10<00:25,  9.92it/s] 29%|██▉       | 103/358 [00:10<00:25,  9.91it/s] 29%|██▉       | 104/358 [00:10<00:25,  9.87it/s] 29%|██▉       | 105/358 [00:10<00:25,  9.79it/s] 30%|██▉       | 106/358 [00:10<00:25,  9.77it/s] 30%|███       | 108/358 [00:11<00:25,  9.80it/s] 30%|███       | 109/358 [00:11<00:25,  9.72it/s] 31%|███       | 110/358 [00:11<00:25,  9.70it/s] 31%|███       | 111/358 [00:11<00:25,  9.65it/s] 32%|███▏      | 113/358 [00:11<00:24,  9.92it/s] 32%|███▏      | 114/358 [00:11<00:24,  9.88it/s] 32%|███▏      | 115/358 [00:11<00:24,  9.79it/s] 32%|███▏      | 116/358 [00:11<00:24,  9.70it/s] 33%|███▎      | 117/358 [00:11<00:24,  9.67it/s] 33%|███▎      | 119/358 [00:12<00:24,  9.80it/s] 34%|███▍      | 121/358 [00:12<00:23,  9.99it/s] 34%|███▍      | 123/358 [00:12<00:23, 10.09it/s] 35%|███▍      | 125/358 [00:12<00:23, 10.07it/s] 35%|███▌      | 127/358 [00:12<00:23,  9.99it/s] 36%|███▌      | 128/358 [00:13<00:23,  9.95it/s] 36%|███▋      | 130/358 [00:13<00:22, 10.00it/s] 37%|███▋      | 131/358 [00:13<00:22,  9.91it/s] 37%|███▋      | 132/358 [00:13<00:22,  9.93it/s] 37%|███▋      | 134/358 [00:13<00:22,  9.94it/s] 38%|███▊      | 135/358 [00:13<00:22,  9.88it/s] 38%|███▊      | 137/358 [00:13<00:22,  9.97it/s] 39%|███▊      | 138/358 [00:14<00:22,  9.95it/s] 39%|███▉      | 139/358 [00:14<00:22,  9.87it/s] 39%|███▉      | 141/358 [00:14<00:21,  9.99it/s] 40%|███▉      | 142/358 [00:14<00:21,  9.91it/s] 40%|███▉      | 143/358 [00:14<00:21,  9.88it/s] 40%|████      | 144/358 [00:14<00:21,  9.79it/s] 41%|████      | 145/358 [00:14<00:21,  9.81it/s] 41%|████      | 146/358 [00:14<00:21,  9.75it/s] 41%|████      | 147/358 [00:14<00:21,  9.69it/s] 41%|████▏     | 148/358 [00:15<00:21,  9.72it/s] 42%|████▏     | 149/358 [00:15<00:21,  9.70it/s] 42%|████▏     | 150/358 [00:15<00:21,  9.66it/s] 42%|████▏     | 151/358 [00:15<00:22,  9.39it/s] 42%|████▏     | 152/358 [00:15<00:21,  9.44it/s] 43%|████▎     | 153/358 [00:15<00:21,  9.46it/s] 43%|████▎     | 154/358 [00:15<00:21,  9.55it/s] 43%|████▎     | 155/358 [00:15<00:21,  9.54it/s] 44%|████▎     | 156/358 [00:15<00:20,  9.67it/s] 44%|████▍     | 157/358 [00:16<00:20,  9.61it/s] 44%|████▍     | 158/358 [00:16<00:20,  9.70it/s] 44%|████▍     | 159/358 [00:16<00:20,  9.69it/s] 45%|████▍     | 160/358 [00:16<00:20,  9.70it/s] 45%|████▌     | 162/358 [00:16<00:19, 10.00it/s] 46%|████▌     | 164/358 [00:16<00:19, 10.00it/s] 46%|████▌     | 165/358 [00:16<00:19,  9.96it/s] 47%|████▋     | 167/358 [00:17<00:19,  9.91it/s] 47%|████▋     | 169/358 [00:17<00:18,  9.95it/s] 48%|████▊     | 171/358 [00:17<00:18,  9.93it/s] 48%|████▊     | 172/358 [00:17<00:18,  9.88it/s] 48%|████▊     | 173/358 [00:17<00:18,  9.81it/s] 49%|████▉     | 175/358 [00:17<00:18,  9.84it/s] 49%|████▉     | 176/358 [00:17<00:18,  9.85it/s] 49%|████▉     | 177/358 [00:18<00:18,  9.84it/s] 50%|█████     | 179/358 [00:18<00:18,  9.86it/s] 50%|█████     | 180/358 [00:18<00:18,  9.79it/s] 51%|█████     | 182/358 [00:18<00:17,  9.94it/s] 51%|█████     | 183/358 [00:18<00:17,  9.89it/s] 51%|█████▏    | 184/358 [00:18<00:17,  9.78it/s] 52%|█████▏    | 185/358 [00:18<00:17,  9.72it/s] 52%|█████▏    | 187/358 [00:19<00:17,  9.94it/s] 53%|█████▎    | 188/358 [00:19<00:17,  9.89it/s] 53%|█████▎    | 189/358 [00:19<00:17,  9.83it/s] 53%|█████▎    | 191/358 [00:19<00:17,  9.76it/s] 54%|█████▎    | 192/358 [00:19<00:17,  9.70it/s] 54%|█████▍    | 193/358 [00:19<00:17,  9.70it/s] 54%|█████▍    | 194/358 [00:19<00:16,  9.68it/s] 54%|█████▍    | 195/358 [00:19<00:16,  9.75it/s] 55%|█████▌    | 197/358 [00:20<00:16,  9.92it/s] 55%|█████▌    | 198/358 [00:20<00:16,  9.84it/s] 56%|█████▌    | 199/358 [00:20<00:16,  9.88it/s] 56%|█████▌    | 200/358 [00:20<00:16,  9.81it/s] 56%|█████▌    | 201/358 [00:20<00:16,  9.77it/s] 57%|█████▋    | 203/358 [00:20<00:15,  9.86it/s] 57%|█████▋    | 204/358 [00:20<00:15,  9.76it/s] 57%|█████▋    | 205/358 [00:20<00:15,  9.71it/s] 58%|█████▊    | 207/358 [00:21<00:15,  9.88it/s] 58%|█████▊    | 208/358 [00:21<00:15,  9.81it/s] 59%|█████▊    | 210/358 [00:21<00:15,  9.81it/s] 59%|█████▉    | 212/358 [00:21<00:14,  9.81it/s] 60%|█████▉    | 214/358 [00:21<00:14,  9.89it/s] 60%|██████    | 215/358 [00:21<00:14,  9.83it/s] 60%|██████    | 216/358 [00:22<00:14,  9.77it/s] 61%|██████    | 217/358 [00:22<00:14,  9.80it/s] 61%|██████    | 218/358 [00:22<00:14,  9.77it/s] 61%|██████    | 219/358 [00:22<00:14,  9.78it/s] 62%|██████▏   | 221/358 [00:22<00:13,  9.91it/s] 62%|██████▏   | 222/358 [00:22<00:13,  9.81it/s] 62%|██████▏   | 223/358 [00:22<00:13,  9.75it/s] 63%|██████▎   | 224/358 [00:22<00:13,  9.70it/s] 63%|██████▎   | 226/358 [00:23<00:13,  9.74it/s] 64%|██████▎   | 228/358 [00:23<00:13,  9.77it/s] 64%|██████▍   | 229/358 [00:23<00:13,  9.74it/s] 64%|██████▍   | 230/358 [00:23<00:13,  9.69it/s] 65%|██████▍   | 232/358 [00:23<00:12,  9.74it/s] 65%|██████▌   | 234/358 [00:23<00:12, 10.02it/s] 66%|██████▌   | 236/358 [00:24<00:12,  9.99it/s] 66%|██████▋   | 238/358 [00:24<00:11, 10.04it/s] 67%|██████▋   | 240/358 [00:24<00:11, 10.00it/s] 68%|██████▊   | 242/358 [00:24<00:11,  9.98it/s] 68%|██████▊   | 243/358 [00:24<00:11,  9.92it/s] 68%|██████▊   | 244/358 [00:24<00:11,  9.85it/s] 69%|██████▊   | 246/358 [00:25<00:11,  9.87it/s] 69%|██████▉   | 247/358 [00:25<00:11,  9.80it/s] 69%|██████▉   | 248/358 [00:25<00:11,  9.76it/s] 70%|██████▉   | 250/358 [00:25<00:10,  9.85it/s] 70%|███████   | 251/358 [00:25<00:10,  9.79it/s] 70%|███████   | 252/358 [00:25<00:10,  9.72it/s] 71%|███████   | 253/358 [00:25<00:10,  9.69it/s] 71%|███████   | 254/358 [00:25<00:10,  9.66it/s] 72%|███████▏  | 256/358 [00:26<00:10,  9.84it/s] 72%|███████▏  | 257/358 [00:26<00:10,  9.84it/s] 72%|███████▏  | 258/358 [00:26<00:10,  9.72it/s] 72%|███████▏  | 259/358 [00:26<00:10,  9.68it/s] 73%|███████▎  | 260/358 [00:26<00:10,  9.72it/s] 73%|███████▎  | 262/358 [00:26<00:09,  9.90it/s] 74%|███████▎  | 264/358 [00:26<00:09,  9.91it/s] 74%|███████▍  | 266/358 [00:27<00:09,  9.91it/s] 75%|███████▍  | 267/358 [00:27<00:09,  9.85it/s] 75%|███████▌  | 269/358 [00:27<00:08,  9.90it/s] 75%|███████▌  | 270/358 [00:27<00:08,  9.83it/s] 76%|███████▌  | 271/358 [00:27<00:08,  9.76it/s] 76%|███████▌  | 272/358 [00:27<00:08,  9.73it/s] 76%|███████▋  | 273/358 [00:27<00:08,  9.64it/s] 77%|███████▋  | 274/358 [00:27<00:08,  9.64it/s] 77%|███████▋  | 275/358 [00:28<00:08,  9.68it/s] 77%|███████▋  | 276/358 [00:28<00:08,  9.69it/s] 77%|███████▋  | 277/358 [00:28<00:08,  9.65it/s] 78%|███████▊  | 278/358 [00:28<00:08,  9.63it/s] 78%|███████▊  | 280/358 [00:28<00:07,  9.82it/s] 78%|███████▊  | 281/358 [00:28<00:07,  9.83it/s] 79%|███████▉  | 282/358 [00:28<00:07,  9.77it/s] 79%|███████▉  | 283/358 [00:28<00:07,  9.71it/s] 79%|███████▉  | 284/358 [00:28<00:07,  9.67it/s] 80%|███████▉  | 285/358 [00:29<00:07,  9.73it/s] 80%|███████▉  | 286/358 [00:29<00:07,  9.69it/s] 80%|████████  | 287/358 [00:29<00:07,  9.67it/s] 80%|████████  | 288/358 [00:29<00:07,  9.63it/s] 81%|████████  | 290/358 [00:29<00:06,  9.85it/s] 81%|████████▏ | 291/358 [00:29<00:06,  9.83it/s] 82%|████████▏ | 293/358 [00:29<00:06,  9.84it/s] 82%|████████▏ | 295/358 [00:30<00:06,  9.91it/s] 83%|████████▎ | 296/358 [00:30<00:06,  9.85it/s] 83%|████████▎ | 297/358 [00:30<00:06,  9.74it/s] 84%|████████▎ | 299/358 [00:30<00:05,  9.90it/s] 84%|████████▍ | 301/358 [00:30<00:05,  9.94it/s] 84%|████████▍ | 302/358 [00:30<00:05,  9.87it/s] 85%|████████▍ | 303/358 [00:30<00:05,  9.88it/s] 85%|████████▌ | 305/358 [00:31<00:05,  9.91it/s] 85%|████████▌ | 306/358 [00:31<00:05,  9.83it/s] 86%|████████▌ | 308/358 [00:31<00:05,  9.93it/s] 86%|████████▋ | 309/358 [00:31<00:04,  9.83it/s] 87%|████████▋ | 310/358 [00:31<00:04,  9.77it/s] 87%|████████▋ | 311/358 [00:31<00:04,  9.69it/s] 87%|████████▋ | 312/358 [00:31<00:04,  9.71it/s] 87%|████████▋ | 313/358 [00:31<00:04,  9.73it/s] 88%|████████▊ | 315/358 [00:32<00:04,  9.99it/s] 88%|████████▊ | 316/358 [00:32<00:04,  9.94it/s] 89%|████████▊ | 317/358 [00:32<00:04,  9.85it/s] 89%|████████▉ | 318/358 [00:32<00:04,  9.81it/s] 89%|████████▉ | 319/358 [00:32<00:03,  9.76it/s] 89%|████████▉ | 320/358 [00:32<00:03,  9.82it/s] 90%|████████▉ | 321/358 [00:32<00:03,  9.75it/s] 90%|████████▉ | 322/358 [00:32<00:03,  9.70it/s] 90%|█████████ | 323/358 [00:32<00:03,  9.66it/s] 91%|█████████ | 324/358 [00:33<00:03,  9.63it/s] 91%|█████████ | 325/358 [00:33<00:03,  9.61it/s] 91%|█████████▏| 327/358 [00:33<00:03,  9.97it/s] 92%|█████████▏| 329/358 [00:33<00:02, 10.07it/s] 92%|█████████▏| 330/358 [00:33<00:02,  9.96it/s] 93%|█████████▎| 332/358 [00:33<00:02, 10.06it/s] 93%|█████████▎| 334/358 [00:34<00:02,  9.96it/s] 94%|█████████▎| 335/358 [00:34<00:02,  9.84it/s] 94%|█████████▍| 337/358 [00:34<00:02,  9.92it/s] 95%|█████████▍| 339/358 [00:34<00:01, 10.12it/s] 95%|█████████▌| 341/358 [00:34<00:01, 10.06it/s] 96%|█████████▌| 343/358 [00:34<00:01,  9.90it/s] 96%|█████████▌| 344/358 [00:35<00:01,  9.85it/s] 96%|█████████▋| 345/358 [00:35<00:01,  9.86it/s] 97%|█████████▋| 347/358 [00:35<00:01, 10.04it/s] 97%|█████████▋| 348/358 [00:35<00:01,  9.94it/s] 97%|█████████▋| 349/358 [00:35<00:00,  9.86it/s] 98%|█████████▊| 350/358 [00:35<00:00,  9.79it/s] 98%|█████████▊| 351/358 [00:35<00:00,  9.75it/s] 99%|█████████▊| 353/358 [00:35<00:00,  9.92it/s] 99%|█████████▉| 354/358 [00:36<00:00,  9.90it/s] 99%|█████████▉| 355/358 [00:36<00:00,  9.82it/s]100%|█████████▉| 357/358 [00:36<00:00,  9.88it/s]100%|██████████| 358/358 [00:36<00:00,  9.83it/s]
[32m2025-02-05 06:39:27.726[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    gen_loss  grad clip ratio  grad norm   ppl
       1.727                1      4.109 5.625[0m
[32m2025-02-05 06:39:27.727[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m169[0m - [1m[Valid][0m
  0%|          | 0/10256 [00:00<?, ?it/s]100%|██████████| 10256/10256 [00:00<00:00, 929369.18it/s]
[32m2025-02-05 06:39:27.738[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:27,  1.42it/s]  5%|▌         | 2/40 [00:01<00:26,  1.44it/s]  8%|▊         | 3/40 [00:02<00:25,  1.44it/s] 10%|█         | 4/40 [00:02<00:24,  1.44it/s] 12%|█▎        | 5/40 [00:03<00:24,  1.44it/s] 15%|█▌        | 6/40 [00:04<00:23,  1.44it/s] 18%|█▊        | 7/40 [00:04<00:22,  1.44it/s] 20%|██        | 8/40 [00:05<00:22,  1.44it/s] 22%|██▎       | 9/40 [00:06<00:21,  1.44it/s] 25%|██▌       | 10/40 [00:06<00:20,  1.44it/s] 28%|██▊       | 11/40 [00:07<00:20,  1.44it/s] 30%|███       | 12/40 [00:08<00:19,  1.44it/s] 32%|███▎      | 13/40 [00:09<00:18,  1.44it/s] 35%|███▌      | 14/40 [00:09<00:18,  1.43it/s] 38%|███▊      | 15/40 [00:10<00:17,  1.44it/s] 40%|████      | 16/40 [00:11<00:16,  1.44it/s] 42%|████▎     | 17/40 [00:11<00:15,  1.45it/s] 45%|████▌     | 18/40 [00:12<00:15,  1.44it/s] 48%|████▊     | 19/40 [00:13<00:14,  1.44it/s] 50%|█████     | 20/40 [00:13<00:13,  1.45it/s] 52%|█████▎    | 21/40 [00:14<00:13,  1.45it/s] 55%|█████▌    | 22/40 [00:15<00:12,  1.45it/s] 57%|█████▊    | 23/40 [00:15<00:11,  1.44it/s] 60%|██████    | 24/40 [00:16<00:11,  1.44it/s] 62%|██████▎   | 25/40 [00:17<00:10,  1.43it/s] 65%|██████▌   | 26/40 [00:18<00:09,  1.45it/s] 68%|██████▊   | 27/40 [00:18<00:08,  1.45it/s] 70%|███████   | 28/40 [00:19<00:08,  1.44it/s] 72%|███████▎  | 29/40 [00:20<00:07,  1.45it/s] 75%|███████▌  | 30/40 [00:20<00:06,  1.45it/s] 78%|███████▊  | 31/40 [00:21<00:06,  1.45it/s] 80%|████████  | 32/40 [00:22<00:05,  1.45it/s] 82%|████████▎ | 33/40 [00:22<00:04,  1.44it/s] 85%|████████▌ | 34/40 [00:23<00:04,  1.45it/s] 88%|████████▊ | 35/40 [00:24<00:03,  1.44it/s] 90%|█████████ | 36/40 [00:24<00:02,  1.44it/s] 92%|█████████▎| 37/40 [00:25<00:02,  1.44it/s] 95%|█████████▌| 38/40 [00:26<00:01,  1.44it/s] 98%|█████████▊| 39/40 [00:27<00:00,  1.44it/s]100%|██████████| 40/40 [00:27<00:00,  1.59it/s]100%|██████████| 40/40 [00:27<00:00,  1.45it/s]
[32m2025-02-05 06:39:55.273[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    average  bleu@1  bleu@2  bleu@3  bleu@4  dist@1  dist@2  dist@3  dist@4  extreme  \
      .7816   .2945   .1074  .03776  .01839   .0452   .3256   .6160   .7893    .5976   
      f1  gen_loss  greedy  intra_dist@1  intra_dist@2  intra_dist@3  intra_dist@4  \
   .3486     5.366   .6657         .8643         .9695         .9589         .9282   
    ppl  rouge1  rouge2  rougeL  
    214   .3804   .0863   .3679[0m
[32m2025-02-05 06:39:55.280[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m163[0m - [1m[Conversation epoch 86][0m
[32m2025-02-05 06:39:55.286[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m164[0m - [1m[Train][0m
  0%|          | 0/92414 [00:00<?, ?it/s]100%|██████████| 92414/92414 [00:00<00:00, 1122330.09it/s]
[32m2025-02-05 06:39:55.368[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/358 [00:00<?, ?it/s]  0%|          | 1/358 [00:00<00:36,  9.77it/s]  1%|          | 3/358 [00:00<00:35,  9.94it/s]  1%|          | 4/358 [00:00<00:35,  9.91it/s]  2%|▏         | 6/358 [00:00<00:35,  9.88it/s]  2%|▏         | 7/358 [00:00<00:35,  9.82it/s]  2%|▏         | 8/358 [00:00<00:35,  9.86it/s]  3%|▎         | 9/358 [00:00<00:35,  9.76it/s]  3%|▎         | 10/358 [00:01<00:35,  9.75it/s]  3%|▎         | 11/358 [00:01<00:35,  9.70it/s]  4%|▎         | 13/358 [00:01<00:34,  9.92it/s]  4%|▍         | 14/358 [00:01<00:34,  9.85it/s]  4%|▍         | 15/358 [00:01<00:35,  9.77it/s]  4%|▍         | 16/358 [00:01<00:35,  9.71it/s]  5%|▍         | 17/358 [00:01<00:35,  9.73it/s]  5%|▌         | 19/358 [00:01<00:34,  9.76it/s]  6%|▌         | 20/358 [00:02<00:34,  9.71it/s]  6%|▌         | 21/358 [00:02<00:34,  9.64it/s]  6%|▌         | 22/358 [00:02<00:34,  9.70it/s]  7%|▋         | 24/358 [00:02<00:34,  9.79it/s]  7%|▋         | 25/358 [00:02<00:34,  9.73it/s]  7%|▋         | 26/358 [00:02<00:34,  9.68it/s]  8%|▊         | 27/358 [00:02<00:34,  9.73it/s]  8%|▊         | 28/358 [00:02<00:34,  9.69it/s]  8%|▊         | 29/358 [00:02<00:34,  9.66it/s]  9%|▊         | 31/358 [00:03<00:33,  9.76it/s]  9%|▉         | 32/358 [00:03<00:33,  9.76it/s]  9%|▉         | 34/358 [00:03<00:32,  9.85it/s] 10%|█         | 36/358 [00:03<00:32,  9.85it/s] 10%|█         | 37/358 [00:03<00:32,  9.83it/s] 11%|█         | 38/358 [00:03<00:32,  9.79it/s] 11%|█         | 40/358 [00:04<00:31,  9.95it/s] 11%|█▏        | 41/358 [00:04<00:32,  9.86it/s] 12%|█▏        | 43/358 [00:04<00:31,  9.89it/s] 13%|█▎        | 45/358 [00:04<00:31,  9.99it/s] 13%|█▎        | 47/358 [00:04<00:31,  9.96it/s] 13%|█▎        | 48/358 [00:04<00:31,  9.94it/s] 14%|█▍        | 50/358 [00:05<00:31,  9.92it/s] 14%|█▍        | 51/358 [00:05<00:31,  9.84it/s] 15%|█▍        | 52/358 [00:05<00:31,  9.76it/s] 15%|█▍        | 53/358 [00:05<00:31,  9.71it/s] 15%|█▌        | 54/358 [00:05<00:31,  9.75it/s] 15%|█▌        | 55/358 [00:05<00:31,  9.69it/s] 16%|█▌        | 56/358 [00:05<00:31,  9.73it/s] 16%|█▌        | 57/358 [00:05<00:31,  9.69it/s] 16%|█▌        | 58/358 [00:05<00:31,  9.67it/s] 16%|█▋        | 59/358 [00:06<00:31,  9.64it/s] 17%|█▋        | 61/358 [00:06<00:30,  9.73it/s] 17%|█▋        | 62/358 [00:06<00:30,  9.65it/s] 18%|█▊        | 63/358 [00:06<00:30,  9.72it/s] 18%|█▊        | 64/358 [00:06<00:30,  9.67it/s] 18%|█▊        | 66/358 [00:06<00:29,  9.74it/s] 19%|█▊        | 67/358 [00:06<00:29,  9.72it/s] 19%|█▉        | 69/358 [00:07<00:29,  9.79it/s] 20%|█▉        | 70/358 [00:07<00:29,  9.74it/s] 20%|█▉        | 71/358 [00:07<00:29,  9.78it/s] 20%|██        | 72/358 [00:07<00:29,  9.73it/s] 20%|██        | 73/358 [00:07<00:29,  9.70it/s] 21%|██        | 74/358 [00:07<00:29,  9.66it/s] 21%|██        | 75/358 [00:07<00:29,  9.63it/s] 21%|██        | 76/358 [00:07<00:28,  9.73it/s] 22%|██▏       | 77/358 [00:07<00:28,  9.70it/s] 22%|██▏       | 79/358 [00:08<00:28,  9.69it/s] 23%|██▎       | 81/358 [00:08<00:28,  9.75it/s] 23%|██▎       | 83/358 [00:08<00:28,  9.78it/s] 23%|██▎       | 84/358 [00:08<00:28,  9.73it/s] 24%|██▎       | 85/358 [00:08<00:28,  9.68it/s] 24%|██▍       | 86/358 [00:08<00:28,  9.67it/s] 24%|██▍       | 87/358 [00:08<00:28,  9.65it/s] 25%|██▍       | 88/358 [00:09<00:27,  9.67it/s] 25%|██▌       | 90/358 [00:09<00:27,  9.91it/s] 26%|██▌       | 92/358 [00:09<00:26, 10.01it/s] 26%|██▌       | 93/358 [00:09<00:26,  9.97it/s] 26%|██▋       | 94/358 [00:09<00:26,  9.88it/s] 27%|██▋       | 96/358 [00:09<00:25, 10.16it/s] 27%|██▋       | 98/358 [00:10<00:25, 10.05it/s] 28%|██▊       | 99/358 [00:10<00:26,  9.96it/s] 28%|██▊       | 101/358 [00:10<00:25,  9.93it/s] 29%|██▉       | 103/358 [00:10<00:25,  9.91it/s] 29%|██▉       | 104/358 [00:10<00:25,  9.87it/s] 29%|██▉       | 105/358 [00:10<00:25,  9.79it/s] 30%|██▉       | 106/358 [00:10<00:25,  9.77it/s] 30%|███       | 108/358 [00:11<00:25,  9.80it/s] 30%|███       | 109/358 [00:11<00:25,  9.71it/s] 31%|███       | 110/358 [00:11<00:25,  9.69it/s] 31%|███       | 111/358 [00:11<00:25,  9.65it/s] 32%|███▏      | 113/358 [00:11<00:24,  9.91it/s] 32%|███▏      | 114/358 [00:11<00:24,  9.87it/s] 32%|███▏      | 115/358 [00:11<00:24,  9.78it/s] 32%|███▏      | 116/358 [00:11<00:24,  9.70it/s] 33%|███▎      | 117/358 [00:11<00:24,  9.67it/s] 33%|███▎      | 119/358 [00:12<00:24,  9.79it/s] 34%|███▍      | 121/358 [00:12<00:23,  9.99it/s] 34%|███▍      | 123/358 [00:12<00:23, 10.09it/s] 35%|███▍      | 125/358 [00:12<00:23, 10.06it/s] 35%|███▌      | 127/358 [00:12<00:23,  9.99it/s] 36%|███▌      | 128/358 [00:13<00:23,  9.92it/s] 36%|███▋      | 130/358 [00:13<00:22,  9.98it/s] 37%|███▋      | 131/358 [00:13<00:22,  9.89it/s] 37%|███▋      | 132/358 [00:13<00:22,  9.91it/s] 37%|███▋      | 134/358 [00:13<00:22,  9.94it/s] 38%|███▊      | 135/358 [00:13<00:22,  9.88it/s] 38%|███▊      | 137/358 [00:13<00:22,  9.97it/s] 39%|███▊      | 138/358 [00:14<00:22,  9.94it/s] 39%|███▉      | 139/358 [00:14<00:22,  9.84it/s] 39%|███▉      | 141/358 [00:14<00:21,  9.97it/s] 40%|███▉      | 142/358 [00:14<00:21,  9.90it/s] 40%|███▉      | 143/358 [00:14<00:21,  9.87it/s] 40%|████      | 144/358 [00:14<00:21,  9.79it/s] 41%|████      | 145/358 [00:14<00:21,  9.81it/s] 41%|████      | 146/358 [00:14<00:21,  9.74it/s] 41%|████      | 147/358 [00:14<00:21,  9.68it/s] 41%|████▏     | 148/358 [00:15<00:21,  9.71it/s] 42%|████▏     | 149/358 [00:15<00:21,  9.69it/s] 42%|████▏     | 150/358 [00:15<00:21,  9.65it/s] 42%|████▏     | 151/358 [00:15<00:22,  9.38it/s] 42%|████▏     | 152/358 [00:15<00:21,  9.43it/s] 43%|████▎     | 153/358 [00:15<00:21,  9.45it/s] 43%|████▎     | 154/358 [00:15<00:21,  9.55it/s] 43%|████▎     | 155/358 [00:15<00:21,  9.56it/s] 44%|████▎     | 156/358 [00:15<00:20,  9.69it/s] 44%|████▍     | 157/358 [00:16<00:20,  9.62it/s] 44%|████▍     | 158/358 [00:16<00:20,  9.71it/s] 44%|████▍     | 159/358 [00:16<00:20,  9.70it/s] 45%|████▍     | 160/358 [00:16<00:20,  9.71it/s] 45%|████▌     | 162/358 [00:16<00:19, 10.00it/s] 46%|████▌     | 164/358 [00:16<00:19, 10.00it/s] 46%|████▌     | 165/358 [00:16<00:19,  9.96it/s] 47%|████▋     | 167/358 [00:17<00:19,  9.91it/s] 47%|████▋     | 169/358 [00:17<00:18,  9.95it/s] 48%|████▊     | 171/358 [00:17<00:18,  9.93it/s] 48%|████▊     | 172/358 [00:17<00:18,  9.88it/s] 48%|████▊     | 173/358 [00:17<00:18,  9.82it/s] 49%|████▉     | 175/358 [00:17<00:18,  9.84it/s] 49%|████▉     | 176/358 [00:17<00:18,  9.85it/s] 49%|████▉     | 177/358 [00:18<00:18,  9.84it/s] 50%|█████     | 179/358 [00:18<00:18,  9.86it/s] 50%|█████     | 180/358 [00:18<00:18,  9.79it/s] 51%|█████     | 182/358 [00:18<00:17,  9.94it/s] 51%|█████     | 183/358 [00:18<00:17,  9.90it/s] 51%|█████▏    | 184/358 [00:18<00:17,  9.79it/s] 52%|█████▏    | 185/358 [00:18<00:17,  9.73it/s] 52%|█████▏    | 187/358 [00:19<00:17,  9.94it/s] 53%|█████▎    | 188/358 [00:19<00:17,  9.89it/s] 53%|█████▎    | 189/358 [00:19<00:17,  9.83it/s] 53%|█████▎    | 190/358 [00:19<00:17,  9.87it/s] 53%|█████▎    | 191/358 [00:19<00:17,  9.71it/s] 54%|█████▎    | 192/358 [00:19<00:17,  9.66it/s] 54%|█████▍    | 193/358 [00:19<00:17,  9.66it/s] 54%|█████▍    | 194/358 [00:19<00:17,  9.64it/s] 54%|█████▍    | 195/358 [00:19<00:16,  9.73it/s] 55%|█████▌    | 197/358 [00:20<00:16,  9.92it/s] 55%|█████▌    | 198/358 [00:20<00:16,  9.84it/s] 56%|█████▌    | 199/358 [00:20<00:16,  9.88it/s] 56%|█████▌    | 200/358 [00:20<00:16,  9.80it/s] 56%|█████▌    | 201/358 [00:20<00:16,  9.77it/s] 57%|█████▋    | 203/358 [00:20<00:15,  9.86it/s] 57%|█████▋    | 204/358 [00:20<00:15,  9.75it/s] 57%|█████▋    | 205/358 [00:20<00:15,  9.71it/s] 58%|█████▊    | 207/358 [00:21<00:15,  9.88it/s] 58%|█████▊    | 208/358 [00:21<00:15,  9.81it/s] 59%|█████▊    | 210/358 [00:21<00:15,  9.83it/s] 59%|█████▉    | 212/358 [00:21<00:14,  9.82it/s] 60%|█████▉    | 214/358 [00:21<00:14,  9.90it/s] 60%|██████    | 215/358 [00:21<00:14,  9.84it/s] 60%|██████    | 216/358 [00:22<00:14,  9.77it/s] 61%|██████    | 217/358 [00:22<00:14,  9.81it/s] 61%|██████    | 218/358 [00:22<00:14,  9.78it/s] 61%|██████    | 219/358 [00:22<00:14,  9.78it/s] 62%|██████▏   | 221/358 [00:22<00:13,  9.91it/s] 62%|██████▏   | 222/358 [00:22<00:13,  9.80it/s] 62%|██████▏   | 223/358 [00:22<00:13,  9.75it/s] 63%|██████▎   | 224/358 [00:22<00:13,  9.69it/s] 63%|██████▎   | 226/358 [00:23<00:13,  9.74it/s] 64%|██████▎   | 228/358 [00:23<00:13,  9.76it/s] 64%|██████▍   | 229/358 [00:23<00:13,  9.74it/s] 64%|██████▍   | 230/358 [00:23<00:13,  9.69it/s] 65%|██████▍   | 232/358 [00:23<00:12,  9.74it/s] 65%|██████▌   | 234/358 [00:23<00:12, 10.02it/s] 66%|██████▌   | 236/358 [00:24<00:12,  9.98it/s] 66%|██████▋   | 238/358 [00:24<00:11, 10.04it/s] 67%|██████▋   | 240/358 [00:24<00:11, 10.00it/s] 68%|██████▊   | 242/358 [00:24<00:11,  9.98it/s] 68%|██████▊   | 243/358 [00:24<00:11,  9.92it/s] 68%|██████▊   | 244/358 [00:24<00:11,  9.85it/s] 69%|██████▊   | 246/358 [00:25<00:11,  9.87it/s] 69%|██████▉   | 247/358 [00:25<00:11,  9.80it/s] 69%|██████▉   | 248/358 [00:25<00:11,  9.76it/s] 70%|██████▉   | 250/358 [00:25<00:10,  9.86it/s] 70%|███████   | 251/358 [00:25<00:10,  9.79it/s] 70%|███████   | 252/358 [00:25<00:10,  9.73it/s] 71%|███████   | 253/358 [00:25<00:10,  9.69it/s] 71%|███████   | 254/358 [00:25<00:10,  9.66it/s] 72%|███████▏  | 256/358 [00:26<00:10,  9.84it/s] 72%|███████▏  | 257/358 [00:26<00:10,  9.84it/s] 72%|███████▏  | 258/358 [00:26<00:10,  9.72it/s] 72%|███████▏  | 259/358 [00:26<00:10,  9.68it/s] 73%|███████▎  | 260/358 [00:26<00:10,  9.72it/s] 73%|███████▎  | 262/358 [00:26<00:09,  9.90it/s] 74%|███████▎  | 264/358 [00:26<00:09,  9.91it/s] 74%|███████▍  | 266/358 [00:27<00:09,  9.91it/s] 75%|███████▍  | 267/358 [00:27<00:09,  9.85it/s] 75%|███████▌  | 269/358 [00:27<00:08,  9.90it/s] 75%|███████▌  | 270/358 [00:27<00:08,  9.83it/s] 76%|███████▌  | 271/358 [00:27<00:08,  9.76it/s] 76%|███████▌  | 272/358 [00:27<00:08,  9.73it/s] 76%|███████▋  | 273/358 [00:27<00:08,  9.63it/s] 77%|███████▋  | 274/358 [00:27<00:08,  9.63it/s] 77%|███████▋  | 275/358 [00:28<00:08,  9.67it/s] 77%|███████▋  | 276/358 [00:28<00:08,  9.68it/s] 77%|███████▋  | 277/358 [00:28<00:08,  9.65it/s] 78%|███████▊  | 278/358 [00:28<00:08,  9.63it/s] 78%|███████▊  | 280/358 [00:28<00:07,  9.83it/s] 78%|███████▊  | 281/358 [00:28<00:07,  9.84it/s] 79%|███████▉  | 282/358 [00:28<00:07,  9.78it/s] 79%|███████▉  | 283/358 [00:28<00:07,  9.72it/s] 79%|███████▉  | 284/358 [00:28<00:07,  9.68it/s] 80%|███████▉  | 285/358 [00:29<00:07,  9.75it/s] 80%|███████▉  | 286/358 [00:29<00:07,  9.70it/s] 80%|████████  | 287/358 [00:29<00:07,  9.68it/s] 80%|████████  | 288/358 [00:29<00:07,  9.63it/s] 81%|████████  | 290/358 [00:29<00:06,  9.85it/s] 81%|████████▏ | 291/358 [00:29<00:06,  9.83it/s] 82%|████████▏ | 293/358 [00:29<00:06,  9.84it/s] 82%|████████▏ | 295/358 [00:30<00:06,  9.91it/s] 83%|████████▎ | 296/358 [00:30<00:06,  9.85it/s] 83%|████████▎ | 297/358 [00:30<00:06,  9.74it/s] 84%|████████▎ | 299/358 [00:30<00:05,  9.90it/s] 84%|████████▍ | 301/358 [00:30<00:05,  9.94it/s] 84%|████████▍ | 302/358 [00:30<00:05,  9.87it/s] 85%|████████▍ | 303/358 [00:30<00:05,  9.88it/s] 85%|████████▌ | 305/358 [00:31<00:05,  9.91it/s] 85%|████████▌ | 306/358 [00:31<00:05,  9.83it/s] 86%|████████▌ | 308/358 [00:31<00:05,  9.93it/s] 86%|████████▋ | 309/358 [00:31<00:04,  9.83it/s] 87%|████████▋ | 310/358 [00:31<00:04,  9.77it/s] 87%|████████▋ | 311/358 [00:31<00:04,  9.70it/s] 87%|████████▋ | 312/358 [00:31<00:04,  9.71it/s] 87%|████████▋ | 313/358 [00:31<00:04,  9.73it/s] 88%|████████▊ | 315/358 [00:32<00:04,  9.99it/s] 88%|████████▊ | 316/358 [00:32<00:04,  9.94it/s] 89%|████████▊ | 317/358 [00:32<00:04,  9.86it/s] 89%|████████▉ | 318/358 [00:32<00:04,  9.81it/s] 89%|████████▉ | 319/358 [00:32<00:03,  9.76it/s] 89%|████████▉ | 320/358 [00:32<00:03,  9.82it/s] 90%|████████▉ | 321/358 [00:32<00:03,  9.74it/s] 90%|████████▉ | 322/358 [00:32<00:03,  9.71it/s] 90%|█████████ | 323/358 [00:32<00:03,  9.66it/s] 91%|█████████ | 324/358 [00:33<00:03,  9.63it/s] 91%|█████████ | 325/358 [00:33<00:03,  9.61it/s] 91%|█████████▏| 327/358 [00:33<00:03,  9.97it/s] 92%|█████████▏| 329/358 [00:33<00:02, 10.07it/s] 92%|█████████▏| 330/358 [00:33<00:02,  9.96it/s] 93%|█████████▎| 332/358 [00:33<00:02, 10.06it/s] 93%|█████████▎| 334/358 [00:34<00:02,  9.96it/s] 94%|█████████▎| 335/358 [00:34<00:02,  9.84it/s] 94%|█████████▍| 337/358 [00:34<00:02,  9.92it/s] 95%|█████████▍| 339/358 [00:34<00:01, 10.12it/s] 95%|█████████▌| 341/358 [00:34<00:01, 10.06it/s] 96%|█████████▌| 343/358 [00:34<00:01,  9.90it/s] 96%|█████████▌| 344/358 [00:35<00:01,  9.85it/s] 96%|█████████▋| 345/358 [00:35<00:01,  9.87it/s] 97%|█████████▋| 347/358 [00:35<00:01, 10.04it/s] 97%|█████████▋| 348/358 [00:35<00:01,  9.94it/s] 97%|█████████▋| 349/358 [00:35<00:00,  9.86it/s] 98%|█████████▊| 350/358 [00:35<00:00,  9.78it/s] 98%|█████████▊| 351/358 [00:35<00:00,  9.74it/s] 99%|█████████▊| 353/358 [00:35<00:00,  9.92it/s] 99%|█████████▉| 354/358 [00:36<00:00,  9.90it/s] 99%|█████████▉| 355/358 [00:36<00:00,  9.82it/s]100%|█████████▉| 357/358 [00:36<00:00,  9.87it/s]100%|██████████| 358/358 [00:36<00:00,  9.83it/s]
[32m2025-02-05 06:40:31.798[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    gen_loss  grad clip ratio  grad norm   ppl
       1.723                1      2.843 5.599[0m
[32m2025-02-05 06:40:31.799[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m169[0m - [1m[Valid][0m
  0%|          | 0/10256 [00:00<?, ?it/s]100%|██████████| 10256/10256 [00:00<00:00, 1026751.52it/s]
[32m2025-02-05 06:40:31.809[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:27,  1.40it/s]  5%|▌         | 2/40 [00:01<00:26,  1.43it/s]  8%|▊         | 3/40 [00:02<00:25,  1.44it/s] 10%|█         | 4/40 [00:02<00:25,  1.44it/s] 12%|█▎        | 5/40 [00:03<00:24,  1.43it/s] 15%|█▌        | 6/40 [00:04<00:23,  1.43it/s] 18%|█▊        | 7/40 [00:04<00:23,  1.43it/s] 20%|██        | 8/40 [00:05<00:22,  1.43it/s] 22%|██▎       | 9/40 [00:06<00:21,  1.43it/s] 25%|██▌       | 10/40 [00:06<00:20,  1.44it/s] 28%|██▊       | 11/40 [00:07<00:20,  1.44it/s] 30%|███       | 12/40 [00:08<00:19,  1.44it/s] 32%|███▎      | 13/40 [00:09<00:18,  1.44it/s] 35%|███▌      | 14/40 [00:09<00:18,  1.43it/s] 38%|███▊      | 15/40 [00:10<00:17,  1.43it/s] 40%|████      | 16/40 [00:11<00:16,  1.43it/s] 42%|████▎     | 17/40 [00:11<00:15,  1.44it/s] 45%|████▌     | 18/40 [00:12<00:15,  1.44it/s] 48%|████▊     | 19/40 [00:13<00:14,  1.43it/s] 50%|█████     | 20/40 [00:13<00:13,  1.44it/s] 52%|█████▎    | 21/40 [00:14<00:13,  1.45it/s] 55%|█████▌    | 22/40 [00:15<00:12,  1.44it/s] 57%|█████▊    | 23/40 [00:16<00:11,  1.44it/s] 60%|██████    | 24/40 [00:16<00:11,  1.43it/s] 62%|██████▎   | 25/40 [00:17<00:10,  1.43it/s] 65%|██████▌   | 26/40 [00:18<00:09,  1.44it/s] 68%|██████▊   | 27/40 [00:18<00:09,  1.44it/s] 70%|███████   | 28/40 [00:19<00:08,  1.44it/s] 72%|███████▎  | 29/40 [00:20<00:09,  1.21it/s] 75%|███████▌  | 30/40 [00:21<00:07,  1.28it/s] 78%|███████▊  | 31/40 [00:22<00:06,  1.32it/s] 80%|████████  | 32/40 [00:22<00:05,  1.36it/s] 82%|████████▎ | 33/40 [00:23<00:05,  1.39it/s] 85%|████████▌ | 34/40 [00:24<00:04,  1.40it/s] 88%|████████▊ | 35/40 [00:24<00:03,  1.41it/s] 90%|█████████ | 36/40 [00:25<00:02,  1.42it/s] 92%|█████████▎| 37/40 [00:26<00:02,  1.43it/s] 95%|█████████▌| 38/40 [00:26<00:01,  1.42it/s] 98%|█████████▊| 39/40 [00:27<00:00,  1.43it/s]100%|██████████| 40/40 [00:28<00:00,  1.58it/s]100%|██████████| 40/40 [00:28<00:00,  1.43it/s]
[32m2025-02-05 06:40:59.857[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    average  bleu@1  bleu@2  bleu@3  bleu@4  dist@1  dist@2  dist@3  dist@4  extreme  \
      .7726   .2930   .1095  .04348  .02239  .04417   .3183   .5936   .7538    .5900   
      f1  gen_loss  greedy  intra_dist@1  intra_dist@2  intra_dist@3  intra_dist@4  \
   .3441     5.421   .6629         .8540         .9582         .9548         .9236   
     ppl  rouge1  rouge2  rougeL  
   226.1   .3810  .08987   .3686[0m
[32m2025-02-05 06:40:59.865[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m163[0m - [1m[Conversation epoch 87][0m
[32m2025-02-05 06:40:59.865[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m164[0m - [1m[Train][0m
  0%|          | 0/92414 [00:00<?, ?it/s]100%|██████████| 92414/92414 [00:00<00:00, 1656746.49it/s]
[32m2025-02-05 06:40:59.921[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/358 [00:00<?, ?it/s]  0%|          | 1/358 [00:00<00:37,  9.48it/s]  1%|          | 3/358 [00:00<00:36,  9.86it/s]  1%|          | 4/358 [00:00<00:35,  9.86it/s]  2%|▏         | 6/358 [00:00<00:35,  9.85it/s]  2%|▏         | 7/358 [00:00<00:35,  9.80it/s]  2%|▏         | 8/358 [00:00<00:35,  9.85it/s]  3%|▎         | 9/358 [00:00<00:35,  9.76it/s]  3%|▎         | 10/358 [00:01<00:35,  9.75it/s]  3%|▎         | 11/358 [00:01<00:35,  9.70it/s]  4%|▎         | 13/358 [00:01<00:34,  9.92it/s]  4%|▍         | 14/358 [00:01<00:34,  9.85it/s]  4%|▍         | 15/358 [00:01<00:35,  9.77it/s]  4%|▍         | 16/358 [00:01<00:35,  9.71it/s]  5%|▍         | 17/358 [00:01<00:35,  9.73it/s]  5%|▌         | 19/358 [00:01<00:34,  9.75it/s]  6%|▌         | 20/358 [00:02<00:34,  9.70it/s]  6%|▌         | 21/358 [00:02<00:34,  9.64it/s]  6%|▌         | 22/358 [00:02<00:34,  9.69it/s]  7%|▋         | 24/358 [00:02<00:34,  9.78it/s]  7%|▋         | 25/358 [00:02<00:34,  9.73it/s]  7%|▋         | 26/358 [00:02<00:34,  9.68it/s]  8%|▊         | 27/358 [00:02<00:33,  9.74it/s]  8%|▊         | 28/358 [00:02<00:34,  9.69it/s]  8%|▊         | 29/358 [00:02<00:34,  9.66it/s]  9%|▊         | 31/358 [00:03<00:33,  9.76it/s]  9%|▉         | 32/358 [00:03<00:33,  9.76it/s]  9%|▉         | 34/358 [00:03<00:32,  9.85it/s] 10%|█         | 36/358 [00:03<00:32,  9.85it/s] 10%|█         | 37/358 [00:03<00:32,  9.83it/s] 11%|█         | 38/358 [00:03<00:32,  9.78it/s] 11%|█         | 40/358 [00:04<00:32,  9.94it/s] 11%|█▏        | 41/358 [00:04<00:32,  9.85it/s] 12%|█▏        | 43/358 [00:04<00:31,  9.88it/s] 13%|█▎        | 45/358 [00:04<00:31,  9.97it/s] 13%|█▎        | 47/358 [00:04<00:31,  9.95it/s] 13%|█▎        | 48/358 [00:04<00:31,  9.94it/s] 14%|█▍        | 50/358 [00:05<00:31,  9.92it/s] 14%|█▍        | 51/358 [00:05<00:31,  9.85it/s] 15%|█▍        | 52/358 [00:05<00:31,  9.76it/s] 15%|█▍        | 53/358 [00:05<00:31,  9.71it/s] 15%|█▌        | 54/358 [00:05<00:31,  9.75it/s] 15%|█▌        | 55/358 [00:05<00:31,  9.70it/s] 16%|█▌        | 56/358 [00:05<00:31,  9.74it/s] 16%|█▌        | 57/358 [00:05<00:31,  9.70it/s] 16%|█▌        | 58/358 [00:05<00:31,  9.68it/s] 16%|█▋        | 59/358 [00:06<00:31,  9.64it/s] 17%|█▋        | 61/358 [00:06<00:30,  9.73it/s] 17%|█▋        | 62/358 [00:06<00:30,  9.65it/s] 18%|█▊        | 63/358 [00:06<00:30,  9.72it/s] 18%|█▊        | 64/358 [00:06<00:30,  9.67it/s] 18%|█▊        | 66/358 [00:06<00:29,  9.74it/s] 19%|█▊        | 67/358 [00:06<00:29,  9.72it/s] 19%|█▉        | 69/358 [00:07<00:29,  9.79it/s] 20%|█▉        | 70/358 [00:07<00:29,  9.73it/s] 20%|█▉        | 71/358 [00:07<00:29,  9.78it/s] 20%|██        | 72/358 [00:07<00:29,  9.73it/s] 20%|██        | 73/358 [00:07<00:29,  9.70it/s] 21%|██        | 74/358 [00:07<00:29,  9.66it/s] 21%|██        | 75/358 [00:07<00:29,  9.63it/s] 22%|██▏       | 77/358 [00:07<00:28,  9.71it/s] 22%|██▏       | 79/358 [00:08<00:28,  9.71it/s] 23%|██▎       | 81/358 [00:08<00:28,  9.77it/s] 23%|██▎       | 83/358 [00:08<00:28,  9.79it/s] 23%|██▎       | 84/358 [00:08<00:28,  9.74it/s] 24%|██▎       | 85/358 [00:08<00:28,  9.70it/s] 24%|██▍       | 86/358 [00:08<00:28,  9.68it/s] 24%|██▍       | 87/358 [00:08<00:28,  9.66it/s] 25%|██▍       | 88/358 [00:09<00:27,  9.68it/s] 25%|██▌       | 90/358 [00:09<00:27,  9.91it/s] 26%|██▌       | 92/358 [00:09<00:26, 10.01it/s] 26%|██▌       | 93/358 [00:09<00:26,  9.97it/s] 26%|██▋       | 94/358 [00:09<00:26,  9.89it/s] 27%|██▋       | 96/358 [00:09<00:25, 10.17it/s] 27%|██▋       | 98/358 [00:10<00:25, 10.06it/s] 28%|██▊       | 100/358 [00:10<00:25, 10.02it/s] 28%|██▊       | 101/358 [00:10<00:25,  9.92it/s] 29%|██▉       | 103/358 [00:10<00:25,  9.91it/s] 29%|██▉       | 104/358 [00:10<00:25,  9.86it/s] 29%|██▉       | 105/358 [00:10<00:25,  9.79it/s] 30%|██▉       | 106/358 [00:10<00:25,  9.77it/s] 30%|███       | 108/358 [00:11<00:25,  9.81it/s] 30%|███       | 109/358 [00:11<00:25,  9.72it/s] 31%|███       | 110/358 [00:11<00:25,  9.71it/s] 31%|███       | 111/358 [00:11<00:25,  9.66it/s] 32%|███▏      | 113/358 [00:11<00:24,  9.93it/s] 32%|███▏      | 114/358 [00:11<00:24,  9.89it/s] 32%|███▏      | 115/358 [00:11<00:24,  9.79it/s] 32%|███▏      | 116/358 [00:11<00:24,  9.70it/s] 33%|███▎      | 117/358 [00:11<00:24,  9.66it/s] 33%|███▎      | 119/358 [00:12<00:24,  9.79it/s] 34%|███▍      | 121/358 [00:12<00:23,  9.99it/s] 34%|███▍      | 123/358 [00:12<00:23, 10.09it/s] 35%|███▍      | 125/358 [00:12<00:23, 10.07it/s] 35%|███▌      | 127/358 [00:12<00:23, 10.00it/s] 36%|███▌      | 128/358 [00:13<00:23,  9.96it/s] 36%|███▋      | 130/358 [00:13<00:22, 10.00it/s] 37%|███▋      | 131/358 [00:13<00:22,  9.91it/s] 37%|███▋      | 132/358 [00:13<00:22,  9.93it/s] 37%|███▋      | 134/358 [00:13<00:22,  9.95it/s] 38%|███▊      | 135/358 [00:13<00:22,  9.89it/s] 38%|███▊      | 137/358 [00:13<00:22,  9.97it/s] 39%|███▊      | 138/358 [00:14<00:22,  9.95it/s] 39%|███▉      | 139/358 [00:14<00:22,  9.87it/s] 39%|███▉      | 141/358 [00:14<00:21,  9.99it/s] 40%|███▉      | 142/358 [00:14<00:21,  9.91it/s] 40%|███▉      | 143/358 [00:14<00:21,  9.88it/s] 40%|████      | 144/358 [00:14<00:21,  9.79it/s] 41%|████      | 145/358 [00:14<00:21,  9.81it/s] 41%|████      | 146/358 [00:14<00:21,  9.75it/s] 41%|████      | 147/358 [00:14<00:21,  9.69it/s] 41%|████▏     | 148/358 [00:15<00:21,  9.72it/s] 42%|████▏     | 149/358 [00:15<00:21,  9.70it/s] 42%|████▏     | 150/358 [00:15<00:21,  9.66it/s] 42%|████▏     | 151/358 [00:15<00:22,  9.39it/s] 42%|████▏     | 152/358 [00:15<00:21,  9.44it/s] 43%|████▎     | 153/358 [00:15<00:21,  9.45it/s] 43%|████▎     | 154/358 [00:15<00:21,  9.55it/s] 43%|████▎     | 155/358 [00:15<00:21,  9.56it/s] 44%|████▎     | 156/358 [00:15<00:20,  9.69it/s] 44%|████▍     | 157/358 [00:16<00:20,  9.63it/s] 44%|████▍     | 158/358 [00:16<00:20,  9.72it/s] 44%|████▍     | 159/358 [00:16<00:20,  9.71it/s] 45%|████▍     | 160/358 [00:16<00:20,  9.71it/s] 45%|████▌     | 162/358 [00:16<00:19, 10.01it/s] 46%|████▌     | 164/358 [00:16<00:19, 10.01it/s] 46%|████▌     | 165/358 [00:16<00:19,  9.97it/s] 47%|████▋     | 167/358 [00:17<00:19,  9.92it/s] 47%|████▋     | 169/358 [00:17<00:18,  9.95it/s] 48%|████▊     | 171/358 [00:17<00:18,  9.94it/s] 48%|████▊     | 172/358 [00:17<00:18,  9.88it/s] 48%|████▊     | 173/358 [00:17<00:18,  9.82it/s] 49%|████▉     | 175/358 [00:17<00:18,  9.84it/s] 49%|████▉     | 176/358 [00:17<00:18,  9.86it/s] 49%|████▉     | 177/358 [00:18<00:18,  9.84it/s] 50%|█████     | 179/358 [00:18<00:18,  9.87it/s] 50%|█████     | 180/358 [00:18<00:18,  9.80it/s] 51%|█████     | 182/358 [00:18<00:17,  9.95it/s] 51%|█████     | 183/358 [00:18<00:17,  9.91it/s] 51%|█████▏    | 184/358 [00:18<00:17,  9.79it/s] 52%|█████▏    | 185/358 [00:18<00:17,  9.74it/s] 52%|█████▏    | 187/358 [00:19<00:17,  9.95it/s] 53%|█████▎    | 188/358 [00:19<00:17,  9.90it/s] 53%|█████▎    | 189/358 [00:19<00:17,  9.84it/s] 53%|█████▎    | 191/358 [00:19<00:17,  9.77it/s] 54%|█████▎    | 192/358 [00:19<00:17,  9.71it/s] 54%|█████▍    | 193/358 [00:19<00:16,  9.71it/s] 54%|█████▍    | 194/358 [00:19<00:16,  9.68it/s] 54%|█████▍    | 195/358 [00:19<00:16,  9.75it/s] 55%|█████▌    | 197/358 [00:20<00:16,  9.92it/s] 55%|█████▌    | 198/358 [00:20<00:16,  9.85it/s] 56%|█████▌    | 199/358 [00:20<00:16,  9.88it/s] 56%|█████▌    | 200/358 [00:20<00:16,  9.82it/s] 56%|█████▌    | 201/358 [00:20<00:16,  9.78it/s] 57%|█████▋    | 203/358 [00:20<00:15,  9.87it/s] 57%|█████▋    | 204/358 [00:20<00:15,  9.76it/s] 57%|█████▋    | 205/358 [00:20<00:15,  9.72it/s] 58%|█████▊    | 207/358 [00:21<00:15,  9.89it/s] 58%|█████▊    | 208/358 [00:21<00:15,  9.82it/s] 59%|█████▊    | 210/358 [00:21<00:15,  9.84it/s] 59%|█████▉    | 212/358 [00:21<00:14,  9.83it/s] 60%|█████▉    | 214/358 [00:21<00:14,  9.91it/s] 60%|██████    | 215/358 [00:21<00:14,  9.84it/s] 60%|██████    | 216/358 [00:22<00:14,  9.78it/s] 61%|██████    | 217/358 [00:22<00:14,  9.81it/s] 61%|██████    | 218/358 [00:22<00:14,  9.79it/s] 61%|██████    | 219/358 [00:22<00:14,  9.78it/s] 62%|██████▏   | 221/358 [00:22<00:13,  9.92it/s] 62%|██████▏   | 222/358 [00:22<00:13,  9.81it/s] 62%|██████▏   | 223/358 [00:22<00:13,  9.76it/s] 63%|██████▎   | 224/358 [00:22<00:13,  9.70it/s] 63%|██████▎   | 226/358 [00:23<00:13,  9.75it/s] 64%|██████▎   | 228/358 [00:23<00:13,  9.78it/s] 64%|██████▍   | 229/358 [00:23<00:13,  9.75it/s] 64%|██████▍   | 230/358 [00:23<00:13,  9.70it/s] 65%|██████▍   | 232/358 [00:23<00:12,  9.75it/s] 65%|██████▌   | 234/358 [00:23<00:12, 10.03it/s] 66%|██████▌   | 236/358 [00:24<00:12,  9.99it/s] 66%|██████▋   | 238/358 [00:24<00:11, 10.05it/s] 67%|██████▋   | 240/358 [00:24<00:11, 10.01it/s] 68%|██████▊   | 242/358 [00:24<00:11,  9.98it/s] 68%|██████▊   | 243/358 [00:24<00:11,  9.92it/s] 68%|██████▊   | 244/358 [00:24<00:11,  9.86it/s] 69%|██████▊   | 246/358 [00:25<00:11,  9.88it/s] 69%|██████▉   | 247/358 [00:25<00:11,  9.81it/s] 69%|██████▉   | 248/358 [00:25<00:11,  9.77it/s] 70%|██████▉   | 250/358 [00:25<00:10,  9.86it/s] 70%|███████   | 251/358 [00:25<00:10,  9.80it/s] 70%|███████   | 252/358 [00:25<00:10,  9.74it/s] 71%|███████   | 253/358 [00:25<00:10,  9.70it/s] 71%|███████   | 254/358 [00:25<00:10,  9.67it/s] 72%|███████▏  | 256/358 [00:26<00:10,  9.85it/s] 72%|███████▏  | 257/358 [00:26<00:10,  9.85it/s] 72%|███████▏  | 258/358 [00:26<00:10,  9.73it/s] 72%|███████▏  | 259/358 [00:26<00:10,  9.69it/s] 73%|███████▎  | 260/358 [00:26<00:10,  9.72it/s] 73%|███████▎  | 262/358 [00:26<00:09,  9.91it/s] 74%|███████▎  | 264/358 [00:26<00:09,  9.92it/s] 74%|███████▍  | 266/358 [00:27<00:09,  9.92it/s] 75%|███████▍  | 267/358 [00:27<00:09,  9.86it/s] 75%|███████▌  | 269/358 [00:27<00:08,  9.91it/s] 75%|███████▌  | 270/358 [00:27<00:08,  9.84it/s] 76%|███████▌  | 271/358 [00:27<00:08,  9.76it/s] 76%|███████▌  | 272/358 [00:27<00:08,  9.74it/s] 76%|███████▋  | 273/358 [00:27<00:08,  9.64it/s] 77%|███████▋  | 274/358 [00:27<00:08,  9.64it/s] 77%|███████▋  | 275/358 [00:28<00:08,  9.69it/s] 77%|███████▋  | 276/358 [00:28<00:08,  9.69it/s] 77%|███████▋  | 277/358 [00:28<00:08,  9.66it/s] 78%|███████▊  | 278/358 [00:28<00:08,  9.63it/s] 78%|███████▊  | 280/358 [00:28<00:07,  9.83it/s] 78%|███████▊  | 281/358 [00:28<00:07,  9.84it/s] 79%|███████▉  | 282/358 [00:28<00:07,  9.78it/s] 79%|███████▉  | 283/358 [00:28<00:07,  9.71it/s] 79%|███████▉  | 284/358 [00:28<00:07,  9.68it/s] 80%|███████▉  | 285/358 [00:29<00:07,  9.75it/s] 80%|███████▉  | 286/358 [00:29<00:07,  9.70it/s] 80%|████████  | 287/358 [00:29<00:07,  9.68it/s] 80%|████████  | 288/358 [00:29<00:07,  9.64it/s] 81%|████████  | 290/358 [00:29<00:06,  9.85it/s] 81%|████████▏ | 291/358 [00:29<00:06,  9.83it/s] 82%|████████▏ | 293/358 [00:29<00:06,  9.84it/s] 82%|████████▏ | 295/358 [00:30<00:06,  9.92it/s] 83%|████████▎ | 296/358 [00:30<00:06,  9.85it/s] 83%|████████▎ | 297/358 [00:30<00:06,  9.74it/s] 84%|████████▎ | 299/358 [00:30<00:05,  9.91it/s] 84%|████████▍ | 301/358 [00:30<00:05,  9.94it/s] 84%|████████▍ | 302/358 [00:30<00:05,  9.88it/s] 85%|████████▍ | 303/358 [00:30<00:05,  9.89it/s] 85%|████████▌ | 305/358 [00:31<00:05,  9.92it/s] 85%|████████▌ | 306/358 [00:31<00:05,  9.83it/s] 86%|████████▌ | 308/358 [00:31<00:05,  9.93it/s] 86%|████████▋ | 309/358 [00:31<00:04,  9.83it/s] 87%|████████▋ | 310/358 [00:31<00:04,  9.78it/s] 87%|████████▋ | 311/358 [00:31<00:04,  9.70it/s] 87%|████████▋ | 312/358 [00:31<00:04,  9.72it/s] 87%|████████▋ | 313/358 [00:31<00:04,  9.73it/s] 88%|████████▊ | 315/358 [00:32<00:04, 10.00it/s] 88%|████████▊ | 316/358 [00:32<00:04,  9.95it/s] 89%|████████▊ | 317/358 [00:32<00:04,  9.86it/s] 89%|████████▉ | 318/358 [00:32<00:04,  9.82it/s] 89%|████████▉ | 319/358 [00:32<00:03,  9.77it/s] 89%|████████▉ | 320/358 [00:32<00:03,  9.83it/s] 90%|████████▉ | 321/358 [00:32<00:03,  9.76it/s] 90%|████████▉ | 322/358 [00:32<00:03,  9.72it/s] 90%|█████████ | 323/358 [00:32<00:03,  9.67it/s] 91%|█████████ | 324/358 [00:33<00:03,  9.64it/s] 91%|█████████ | 325/358 [00:33<00:03,  9.62it/s] 91%|█████████▏| 327/358 [00:33<00:03,  9.98it/s] 92%|█████████▏| 329/358 [00:33<00:02, 10.09it/s] 92%|█████████▏| 330/358 [00:33<00:02,  9.97it/s] 93%|█████████▎| 332/358 [00:33<00:02, 10.07it/s] 93%|█████████▎| 334/358 [00:34<00:02,  9.98it/s] 94%|█████████▎| 335/358 [00:34<00:02,  9.85it/s] 94%|█████████▍| 337/358 [00:34<00:02,  9.92it/s] 95%|█████████▍| 339/358 [00:34<00:01, 10.13it/s] 95%|█████████▌| 341/358 [00:34<00:01, 10.07it/s] 96%|█████████▌| 343/358 [00:34<00:01,  9.91it/s] 96%|█████████▌| 344/358 [00:35<00:01,  9.85it/s] 96%|█████████▋| 345/358 [00:35<00:01,  9.87it/s] 97%|█████████▋| 347/358 [00:35<00:01, 10.04it/s] 97%|█████████▋| 348/358 [00:35<00:01,  9.95it/s] 97%|█████████▋| 349/358 [00:35<00:00,  9.87it/s] 98%|█████████▊| 350/358 [00:35<00:00,  9.80it/s] 98%|█████████▊| 351/358 [00:35<00:00,  9.75it/s] 99%|█████████▊| 353/358 [00:35<00:00,  9.93it/s] 99%|█████████▉| 354/358 [00:36<00:00,  9.91it/s] 99%|█████████▉| 355/358 [00:36<00:00,  9.83it/s]100%|█████████▉| 357/358 [00:36<00:00,  9.88it/s]100%|██████████| 358/358 [00:36<00:00,  9.84it/s]
[32m2025-02-05 06:41:36.327[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    gen_loss  grad clip ratio  grad norm   ppl
       1.719                1      3.123 5.579[0m
[32m2025-02-05 06:41:36.327[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m169[0m - [1m[Valid][0m
  0%|          | 0/10256 [00:00<?, ?it/s]100%|██████████| 10256/10256 [00:00<00:00, 1056093.04it/s]
[32m2025-02-05 06:41:36.337[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:26,  1.45it/s]  5%|▌         | 2/40 [00:01<00:25,  1.46it/s]  8%|▊         | 3/40 [00:02<00:25,  1.47it/s] 10%|█         | 4/40 [00:02<00:24,  1.47it/s] 12%|█▎        | 5/40 [00:03<00:23,  1.46it/s] 15%|█▌        | 6/40 [00:04<00:23,  1.46it/s] 18%|█▊        | 7/40 [00:04<00:22,  1.46it/s] 20%|██        | 8/40 [00:05<00:21,  1.47it/s] 22%|██▎       | 9/40 [00:06<00:21,  1.47it/s] 25%|██▌       | 10/40 [00:06<00:20,  1.47it/s] 28%|██▊       | 11/40 [00:07<00:19,  1.47it/s] 30%|███       | 12/40 [00:08<00:19,  1.46it/s] 32%|███▎      | 13/40 [00:08<00:18,  1.47it/s] 35%|███▌      | 14/40 [00:09<00:17,  1.46it/s] 38%|███▊      | 15/40 [00:10<00:17,  1.46it/s] 40%|████      | 16/40 [00:10<00:16,  1.46it/s] 42%|████▎     | 17/40 [00:11<00:15,  1.47it/s] 45%|████▌     | 18/40 [00:12<00:15,  1.47it/s] 48%|████▊     | 19/40 [00:12<00:14,  1.46it/s] 50%|█████     | 20/40 [00:13<00:13,  1.47it/s] 52%|█████▎    | 21/40 [00:14<00:12,  1.47it/s] 55%|█████▌    | 22/40 [00:15<00:12,  1.47it/s] 57%|█████▊    | 23/40 [00:15<00:11,  1.47it/s] 60%|██████    | 24/40 [00:16<00:10,  1.46it/s] 62%|██████▎   | 25/40 [00:17<00:10,  1.46it/s] 65%|██████▌   | 26/40 [00:17<00:09,  1.47it/s] 68%|██████▊   | 27/40 [00:18<00:08,  1.47it/s] 70%|███████   | 28/40 [00:19<00:08,  1.47it/s] 72%|███████▎  | 29/40 [00:19<00:07,  1.47it/s] 75%|███████▌  | 30/40 [00:20<00:06,  1.47it/s] 78%|███████▊  | 31/40 [00:21<00:06,  1.47it/s] 80%|████████  | 32/40 [00:21<00:05,  1.47it/s] 82%|████████▎ | 33/40 [00:22<00:04,  1.46it/s] 85%|████████▌ | 34/40 [00:23<00:04,  1.46it/s] 88%|████████▊ | 35/40 [00:23<00:03,  1.46it/s] 90%|█████████ | 36/40 [00:24<00:02,  1.46it/s] 92%|█████████▎| 37/40 [00:25<00:02,  1.46it/s] 95%|█████████▌| 38/40 [00:25<00:01,  1.45it/s] 98%|█████████▊| 39/40 [00:26<00:00,  1.45it/s]100%|██████████| 40/40 [00:27<00:00,  1.60it/s]100%|██████████| 40/40 [00:27<00:00,  1.47it/s]
[32m2025-02-05 06:42:03.478[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    average  bleu@1  bleu@2  bleu@3  bleu@4  dist@1  dist@2  dist@3  dist@4  extreme  \
      .7776   .3002   .1110  .04223  .02073  .04566   .3188   .6010   .7668    .5950   
      f1  gen_loss  greedy  intra_dist@1  intra_dist@2  intra_dist@3  intra_dist@4  \
   .3524       5.4   .6682         .8721         .9684         .9553         .9206   
     ppl  rouge1  rouge2  rougeL  
   221.4   .3868  .09064   .3742[0m
[32m2025-02-05 06:42:03.484[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m163[0m - [1m[Conversation epoch 88][0m
[32m2025-02-05 06:42:03.484[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m164[0m - [1m[Train][0m
  0%|          | 0/92414 [00:00<?, ?it/s]100%|██████████| 92414/92414 [00:00<00:00, 999678.67it/s]
[32m2025-02-05 06:42:03.577[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/358 [00:00<?, ?it/s]  0%|          | 1/358 [00:00<00:36,  9.76it/s]  1%|          | 3/358 [00:00<00:35,  9.95it/s]  1%|          | 4/358 [00:00<00:35,  9.92it/s]  2%|▏         | 6/358 [00:00<00:35,  9.89it/s]  2%|▏         | 7/358 [00:00<00:35,  9.82it/s]  2%|▏         | 8/358 [00:00<00:35,  9.87it/s]  3%|▎         | 9/358 [00:00<00:35,  9.77it/s]  3%|▎         | 10/358 [00:01<00:35,  9.76it/s]  3%|▎         | 11/358 [00:01<00:35,  9.71it/s]  4%|▎         | 13/358 [00:01<00:34,  9.93it/s]  4%|▍         | 14/358 [00:01<00:34,  9.85it/s]  4%|▍         | 15/358 [00:01<00:35,  9.78it/s]  4%|▍         | 16/358 [00:01<00:35,  9.71it/s]  5%|▍         | 17/358 [00:01<00:35,  9.73it/s]  5%|▌         | 18/358 [00:01<00:34,  9.80it/s]  5%|▌         | 19/358 [00:01<00:34,  9.74it/s]  6%|▌         | 20/358 [00:02<00:34,  9.68it/s]  6%|▌         | 21/358 [00:02<00:35,  9.61it/s]  6%|▌         | 22/358 [00:02<00:34,  9.68it/s]  7%|▋         | 24/358 [00:02<00:34,  9.78it/s]  7%|▋         | 25/358 [00:02<00:34,  9.73it/s]  7%|▋         | 26/358 [00:02<00:34,  9.68it/s]  8%|▊         | 27/358 [00:02<00:33,  9.74it/s]  8%|▊         | 28/358 [00:02<00:34,  9.69it/s]  8%|▊         | 29/358 [00:02<00:34,  9.65it/s]  9%|▊         | 31/358 [00:03<00:33,  9.75it/s]  9%|▉         | 32/358 [00:03<00:33,  9.75it/s]  9%|▉         | 34/358 [00:03<00:32,  9.86it/s] 10%|█         | 36/358 [00:03<00:32,  9.86it/s] 10%|█         | 37/358 [00:03<00:32,  9.83it/s] 11%|█         | 38/358 [00:03<00:32,  9.79it/s] 11%|█         | 40/358 [00:04<00:31,  9.95it/s] 11%|█▏        | 41/358 [00:04<00:32,  9.86it/s] 12%|█▏        | 43/358 [00:04<00:31,  9.89it/s] 13%|█▎        | 45/358 [00:04<00:31,  9.99it/s] 13%|█▎        | 47/358 [00:04<00:31,  9.96it/s] 13%|█▎        | 48/358 [00:04<00:31,  9.95it/s] 14%|█▍        | 50/358 [00:05<00:31,  9.92it/s] 14%|█▍        | 51/358 [00:05<00:31,  9.85it/s] 15%|█▍        | 52/358 [00:05<00:31,  9.76it/s] 15%|█▍        | 53/358 [00:05<00:31,  9.71it/s] 15%|█▌        | 54/358 [00:05<00:31,  9.75it/s] 15%|█▌        | 55/358 [00:05<00:31,  9.70it/s] 16%|█▌        | 56/358 [00:05<00:31,  9.74it/s] 16%|█▌        | 57/358 [00:05<00:31,  9.70it/s] 16%|█▌        | 58/358 [00:05<00:30,  9.68it/s] 16%|█▋        | 59/358 [00:06<00:31,  9.65it/s] 17%|█▋        | 61/358 [00:06<00:30,  9.73it/s] 17%|█▋        | 62/358 [00:06<00:30,  9.66it/s] 18%|█▊        | 63/358 [00:06<00:30,  9.72it/s] 18%|█▊        | 64/358 [00:06<00:30,  9.67it/s] 18%|█▊        | 66/358 [00:06<00:29,  9.74it/s] 19%|█▊        | 67/358 [00:06<00:29,  9.73it/s] 19%|█▉        | 69/358 [00:07<00:29,  9.79it/s] 20%|█▉        | 70/358 [00:07<00:29,  9.74it/s] 20%|█▉        | 71/358 [00:07<00:29,  9.79it/s] 20%|██        | 72/358 [00:07<00:29,  9.73it/s] 20%|██        | 73/358 [00:07<00:29,  9.70it/s] 21%|██        | 74/358 [00:07<00:29,  9.66it/s] 21%|██        | 75/358 [00:07<00:29,  9.63it/s] 22%|██▏       | 77/358 [00:07<00:28,  9.71it/s] 22%|██▏       | 79/358 [00:08<00:28,  9.71it/s] 23%|██▎       | 81/358 [00:08<00:28,  9.77it/s] 23%|██▎       | 83/358 [00:08<00:28,  9.79it/s] 23%|██▎       | 84/358 [00:08<00:28,  9.74it/s] 24%|██▎       | 85/358 [00:08<00:28,  9.70it/s] 24%|██▍       | 86/358 [00:08<00:28,  9.68it/s] 24%|██▍       | 87/358 [00:08<00:28,  9.66it/s] 25%|██▍       | 88/358 [00:09<00:27,  9.68it/s] 25%|██▌       | 90/358 [00:09<00:27,  9.92it/s] 26%|██▌       | 92/358 [00:09<00:26, 10.02it/s] 26%|██▌       | 93/358 [00:09<00:26,  9.98it/s] 26%|██▋       | 94/358 [00:09<00:26,  9.90it/s] 27%|██▋       | 96/358 [00:09<00:25, 10.18it/s] 27%|██▋       | 98/358 [00:09<00:25, 10.06it/s] 28%|██▊       | 100/358 [00:10<00:25, 10.02it/s] 28%|██▊       | 101/358 [00:10<00:25,  9.92it/s] 29%|██▉       | 103/358 [00:10<00:25,  9.91it/s] 29%|██▉       | 104/358 [00:10<00:25,  9.87it/s] 29%|██▉       | 105/358 [00:10<00:25,  9.79it/s] 30%|██▉       | 106/358 [00:10<00:25,  9.78it/s] 30%|███       | 108/358 [00:11<00:25,  9.81it/s] 30%|███       | 109/358 [00:11<00:25,  9.72it/s] 31%|███       | 110/358 [00:11<00:25,  9.70it/s] 31%|███       | 111/358 [00:11<00:25,  9.65it/s] 32%|███▏      | 113/358 [00:11<00:24,  9.93it/s] 32%|███▏      | 114/358 [00:11<00:24,  9.88it/s] 32%|███▏      | 115/358 [00:11<00:24,  9.78it/s] 32%|███▏      | 116/358 [00:11<00:24,  9.70it/s] 33%|███▎      | 117/358 [00:11<00:24,  9.68it/s] 33%|███▎      | 119/358 [00:12<00:24,  9.80it/s] 34%|███▍      | 121/358 [00:12<00:23,  9.99it/s] 34%|███▍      | 123/358 [00:12<00:23, 10.09it/s] 35%|███▍      | 125/358 [00:12<00:23, 10.07it/s] 35%|███▌      | 127/358 [00:12<00:23, 10.00it/s] 36%|███▌      | 128/358 [00:13<00:23,  9.96it/s] 36%|███▋      | 130/358 [00:13<00:22, 10.00it/s] 37%|███▋      | 131/358 [00:13<00:22,  9.91it/s] 37%|███▋      | 132/358 [00:13<00:22,  9.93it/s] 37%|███▋      | 134/358 [00:13<00:22,  9.95it/s] 38%|███▊      | 135/358 [00:13<00:22,  9.89it/s] 38%|███▊      | 137/358 [00:13<00:22,  9.98it/s] 39%|███▊      | 138/358 [00:14<00:22,  9.96it/s] 39%|███▉      | 139/358 [00:14<00:22,  9.87it/s] 39%|███▉      | 141/358 [00:14<00:21,  9.99it/s] 40%|███▉      | 142/358 [00:14<00:21,  9.92it/s] 40%|███▉      | 143/358 [00:14<00:21,  9.88it/s] 40%|████      | 144/358 [00:14<00:21,  9.80it/s] 41%|████      | 145/358 [00:14<00:21,  9.82it/s] 41%|████      | 146/358 [00:14<00:21,  9.75it/s] 41%|████      | 147/358 [00:14<00:21,  9.69it/s] 41%|████▏     | 148/358 [00:15<00:21,  9.72it/s] 42%|████▏     | 149/358 [00:15<00:21,  9.70it/s] 42%|████▏     | 150/358 [00:15<00:21,  9.66it/s] 42%|████▏     | 151/358 [00:15<00:22,  9.40it/s] 42%|████▏     | 152/358 [00:15<00:21,  9.44it/s] 43%|████▎     | 153/358 [00:15<00:21,  9.46it/s] 43%|████▎     | 154/358 [00:15<00:21,  9.55it/s] 43%|████▎     | 155/358 [00:15<00:21,  9.56it/s] 44%|████▎     | 156/358 [00:15<00:20,  9.68it/s] 44%|████▍     | 157/358 [00:16<00:20,  9.62it/s] 44%|████▍     | 158/358 [00:16<00:20,  9.71it/s] 44%|████▍     | 159/358 [00:16<00:20,  9.70it/s] 45%|████▍     | 160/358 [00:16<00:20,  9.72it/s] 45%|████▌     | 162/358 [00:16<00:19, 10.01it/s] 46%|████▌     | 164/358 [00:16<00:19, 10.01it/s] 46%|████▌     | 165/358 [00:16<00:19,  9.97it/s] 47%|████▋     | 167/358 [00:17<00:19,  9.92it/s] 47%|████▋     | 169/358 [00:17<00:18,  9.96it/s] 48%|████▊     | 171/358 [00:17<00:18,  9.94it/s] 48%|████▊     | 172/358 [00:17<00:18,  9.88it/s] 48%|████▊     | 173/358 [00:17<00:18,  9.82it/s] 49%|████▉     | 175/358 [00:17<00:18,  9.85it/s] 49%|████▉     | 176/358 [00:17<00:18,  9.86it/s] 49%|████▉     | 177/358 [00:18<00:18,  9.85it/s] 50%|█████     | 179/358 [00:18<00:18,  9.87it/s] 50%|█████     | 180/358 [00:18<00:18,  9.79it/s] 51%|█████     | 182/358 [00:18<00:17,  9.95it/s] 51%|█████     | 183/358 [00:18<00:17,  9.90it/s] 51%|█████▏    | 184/358 [00:18<00:17,  9.79it/s] 52%|█████▏    | 185/358 [00:18<00:17,  9.74it/s] 52%|█████▏    | 187/358 [00:19<00:17,  9.95it/s] 53%|█████▎    | 188/358 [00:19<00:17,  9.90it/s] 53%|█████▎    | 189/358 [00:19<00:17,  9.84it/s] 53%|█████▎    | 191/358 [00:19<00:17,  9.76it/s] 54%|█████▎    | 192/358 [00:19<00:17,  9.71it/s] 54%|█████▍    | 193/358 [00:19<00:17,  9.71it/s] 54%|█████▍    | 194/358 [00:19<00:16,  9.68it/s] 54%|█████▍    | 195/358 [00:19<00:16,  9.75it/s] 55%|█████▌    | 197/358 [00:20<00:16,  9.92it/s] 55%|█████▌    | 198/358 [00:20<00:16,  9.84it/s] 56%|█████▌    | 199/358 [00:20<00:16,  9.88it/s] 56%|█████▌    | 200/358 [00:20<00:16,  9.82it/s] 56%|█████▌    | 201/358 [00:20<00:16,  9.78it/s] 57%|█████▋    | 203/358 [00:20<00:15,  9.86it/s] 57%|█████▋    | 204/358 [00:20<00:15,  9.76it/s] 57%|█████▋    | 205/358 [00:20<00:15,  9.72it/s] 58%|█████▊    | 207/358 [00:21<00:15,  9.89it/s] 58%|█████▊    | 208/358 [00:21<00:15,  9.82it/s] 59%|█████▊    | 210/358 [00:21<00:15,  9.83it/s] 59%|█████▉    | 212/358 [00:21<00:14,  9.82it/s] 60%|█████▉    | 214/358 [00:21<00:14,  9.90it/s] 60%|██████    | 215/358 [00:21<00:14,  9.84it/s] 60%|██████    | 216/358 [00:21<00:14,  9.78it/s] 61%|██████    | 217/358 [00:22<00:14,  9.81it/s] 61%|██████    | 218/358 [00:22<00:14,  9.78it/s] 61%|██████    | 219/358 [00:22<00:14,  9.78it/s] 62%|██████▏   | 221/358 [00:22<00:13,  9.91it/s] 62%|██████▏   | 222/358 [00:22<00:13,  9.81it/s] 62%|██████▏   | 223/358 [00:22<00:13,  9.76it/s] 63%|██████▎   | 224/358 [00:22<00:13,  9.70it/s] 63%|██████▎   | 226/358 [00:23<00:13,  9.75it/s] 64%|██████▎   | 228/358 [00:23<00:13,  9.77it/s] 64%|██████▍   | 229/358 [00:23<00:13,  9.74it/s] 64%|██████▍   | 230/358 [00:23<00:13,  9.69it/s] 65%|██████▍   | 232/358 [00:23<00:12,  9.75it/s] 65%|██████▌   | 234/358 [00:23<00:12, 10.03it/s] 66%|██████▌   | 236/358 [00:24<00:12,  9.99it/s] 66%|██████▋   | 238/358 [00:24<00:11, 10.04it/s] 67%|██████▋   | 240/358 [00:24<00:11, 10.00it/s] 68%|██████▊   | 242/358 [00:24<00:11,  9.98it/s] 68%|██████▊   | 243/358 [00:24<00:11,  9.92it/s] 68%|██████▊   | 244/358 [00:24<00:11,  9.86it/s] 69%|██████▊   | 246/358 [00:25<00:11,  9.88it/s] 69%|██████▉   | 247/358 [00:25<00:11,  9.81it/s] 69%|██████▉   | 248/358 [00:25<00:11,  9.77it/s] 70%|██████▉   | 250/358 [00:25<00:10,  9.86it/s] 70%|███████   | 251/358 [00:25<00:10,  9.80it/s] 70%|███████   | 252/358 [00:25<00:10,  9.73it/s] 71%|███████   | 253/358 [00:25<00:10,  9.69it/s] 71%|███████   | 254/358 [00:25<00:10,  9.67it/s] 72%|███████▏  | 256/358 [00:26<00:10,  9.84it/s] 72%|███████▏  | 257/358 [00:26<00:10,  9.85it/s] 72%|███████▏  | 258/358 [00:26<00:10,  9.72it/s] 72%|███████▏  | 259/358 [00:26<00:10,  9.69it/s] 73%|███████▎  | 260/358 [00:26<00:10,  9.73it/s] 73%|███████▎  | 262/358 [00:26<00:09,  9.91it/s] 74%|███████▎  | 264/358 [00:26<00:09,  9.92it/s] 74%|███████▍  | 266/358 [00:27<00:09,  9.91it/s] 75%|███████▍  | 267/358 [00:27<00:09,  9.85it/s] 75%|███████▌  | 269/358 [00:27<00:08,  9.91it/s] 75%|███████▌  | 270/358 [00:27<00:08,  9.84it/s] 76%|███████▌  | 271/358 [00:27<00:08,  9.77it/s] 76%|███████▌  | 272/358 [00:27<00:08,  9.74it/s] 76%|███████▋  | 273/358 [00:27<00:08,  9.64it/s] 77%|███████▋  | 274/358 [00:27<00:08,  9.64it/s] 77%|███████▋  | 275/358 [00:28<00:08,  9.69it/s] 77%|███████▋  | 276/358 [00:28<00:08,  9.69it/s] 77%|███████▋  | 277/358 [00:28<00:08,  9.66it/s] 78%|███████▊  | 278/358 [00:28<00:08,  9.64it/s] 78%|███████▊  | 280/358 [00:28<00:07,  9.83it/s] 78%|███████▊  | 281/358 [00:28<00:07,  9.84it/s] 79%|███████▉  | 282/358 [00:28<00:07,  9.78it/s] 79%|███████▉  | 283/358 [00:28<00:07,  9.71it/s] 79%|███████▉  | 284/358 [00:28<00:07,  9.68it/s] 80%|███████▉  | 285/358 [00:29<00:07,  9.75it/s] 80%|███████▉  | 286/358 [00:29<00:07,  9.70it/s] 80%|████████  | 287/358 [00:29<00:07,  9.68it/s] 80%|████████  | 288/358 [00:29<00:07,  9.64it/s] 81%|████████  | 290/358 [00:29<00:06,  9.85it/s] 81%|████████▏ | 291/358 [00:29<00:06,  9.83it/s] 82%|████████▏ | 293/358 [00:29<00:06,  9.85it/s] 82%|████████▏ | 295/358 [00:30<00:06,  9.92it/s] 83%|████████▎ | 296/358 [00:30<00:06,  9.85it/s] 83%|████████▎ | 297/358 [00:30<00:06,  9.74it/s] 84%|████████▎ | 299/358 [00:30<00:05,  9.91it/s] 84%|████████▍ | 301/358 [00:30<00:05,  9.95it/s] 84%|████████▍ | 302/358 [00:30<00:05,  9.88it/s] 85%|████████▍ | 303/358 [00:30<00:05,  9.89it/s] 85%|████████▌ | 305/358 [00:31<00:05,  9.91it/s] 85%|████████▌ | 306/358 [00:31<00:05,  9.84it/s] 86%|████████▌ | 308/358 [00:31<00:05,  9.93it/s] 86%|████████▋ | 309/358 [00:31<00:04,  9.83it/s] 87%|████████▋ | 310/358 [00:31<00:04,  9.77it/s] 87%|████████▋ | 311/358 [00:31<00:04,  9.70it/s] 87%|████████▋ | 312/358 [00:31<00:04,  9.72it/s] 87%|████████▋ | 313/358 [00:31<00:04,  9.74it/s] 88%|████████▊ | 315/358 [00:32<00:04, 10.00it/s] 88%|████████▊ | 316/358 [00:32<00:04,  9.95it/s] 89%|████████▊ | 317/358 [00:32<00:04,  9.87it/s] 89%|████████▉ | 318/358 [00:32<00:04,  9.82it/s] 89%|████████▉ | 319/358 [00:32<00:03,  9.77it/s] 89%|████████▉ | 320/358 [00:32<00:03,  9.83it/s] 90%|████████▉ | 321/358 [00:32<00:03,  9.75it/s] 90%|████████▉ | 322/358 [00:32<00:03,  9.72it/s] 90%|█████████ | 323/358 [00:32<00:03,  9.67it/s] 91%|█████████ | 324/358 [00:33<00:03,  9.64it/s] 91%|█████████ | 325/358 [00:33<00:03,  9.62it/s] 91%|█████████▏| 327/358 [00:33<00:03,  9.98it/s] 92%|█████████▏| 329/358 [00:33<00:02, 10.08it/s] 92%|█████████▏| 330/358 [00:33<00:02,  9.97it/s] 93%|█████████▎| 332/358 [00:33<00:02, 10.07it/s] 93%|█████████▎| 334/358 [00:34<00:02,  9.97it/s] 94%|█████████▎| 335/358 [00:34<00:02,  9.85it/s] 94%|█████████▍| 337/358 [00:34<00:02,  9.93it/s] 95%|█████████▍| 339/358 [00:34<00:01, 10.13it/s] 95%|█████████▌| 341/358 [00:34<00:01, 10.08it/s] 96%|█████████▌| 343/358 [00:34<00:01,  9.91it/s] 96%|█████████▌| 344/358 [00:35<00:01,  9.85it/s] 96%|█████████▋| 345/358 [00:35<00:01,  9.87it/s] 97%|█████████▋| 347/358 [00:35<00:01, 10.05it/s] 97%|█████████▋| 349/358 [00:35<00:00,  9.90it/s] 98%|█████████▊| 350/358 [00:35<00:00,  9.83it/s] 98%|█████████▊| 351/358 [00:35<00:00,  9.79it/s] 99%|█████████▊| 353/358 [00:35<00:00,  9.94it/s] 99%|█████████▉| 354/358 [00:36<00:00,  9.92it/s] 99%|█████████▉| 355/358 [00:36<00:00,  9.84it/s]100%|█████████▉| 357/358 [00:36<00:00,  9.89it/s]100%|██████████| 358/358 [00:36<00:00,  9.84it/s]
[32m2025-02-05 06:42:39.975[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    gen_loss  grad clip ratio  grad norm   ppl
       1.716                1      2.594 5.562[0m
[32m2025-02-05 06:42:39.975[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m169[0m - [1m[Valid][0m
  0%|          | 0/10256 [00:00<?, ?it/s]100%|██████████| 10256/10256 [00:00<00:00, 1140272.55it/s]
[32m2025-02-05 06:42:39.985[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:27,  1.44it/s]  5%|▌         | 2/40 [00:01<00:26,  1.46it/s]  8%|▊         | 3/40 [00:02<00:25,  1.47it/s] 10%|█         | 4/40 [00:02<00:24,  1.47it/s] 12%|█▎        | 5/40 [00:03<00:24,  1.45it/s] 15%|█▌        | 6/40 [00:04<00:23,  1.45it/s] 18%|█▊        | 7/40 [00:04<00:22,  1.45it/s] 20%|██        | 8/40 [00:05<00:22,  1.45it/s] 22%|██▎       | 9/40 [00:06<00:21,  1.46it/s] 25%|██▌       | 10/40 [00:06<00:20,  1.46it/s] 28%|██▊       | 11/40 [00:07<00:19,  1.46it/s] 30%|███       | 12/40 [00:08<00:19,  1.46it/s] 32%|███▎      | 13/40 [00:08<00:18,  1.46it/s] 35%|███▌      | 14/40 [00:09<00:17,  1.45it/s] 38%|███▊      | 15/40 [00:10<00:17,  1.45it/s] 40%|████      | 16/40 [00:11<00:16,  1.45it/s] 42%|████▎     | 17/40 [00:11<00:15,  1.46it/s] 45%|████▌     | 18/40 [00:12<00:15,  1.46it/s] 48%|████▊     | 19/40 [00:13<00:14,  1.46it/s] 50%|█████     | 20/40 [00:13<00:13,  1.46it/s] 52%|█████▎    | 21/40 [00:14<00:12,  1.47it/s] 55%|█████▌    | 22/40 [00:15<00:12,  1.46it/s] 57%|█████▊    | 23/40 [00:15<00:11,  1.46it/s] 60%|██████    | 24/40 [00:16<00:11,  1.45it/s] 62%|██████▎   | 25/40 [00:17<00:10,  1.45it/s] 65%|██████▌   | 26/40 [00:17<00:09,  1.46it/s] 68%|██████▊   | 27/40 [00:18<00:08,  1.46it/s] 70%|███████   | 28/40 [00:19<00:08,  1.45it/s] 72%|███████▎  | 29/40 [00:19<00:07,  1.46it/s] 75%|███████▌  | 30/40 [00:20<00:06,  1.46it/s] 78%|███████▊  | 31/40 [00:21<00:06,  1.46it/s] 80%|████████  | 32/40 [00:21<00:05,  1.46it/s] 82%|████████▎ | 33/40 [00:22<00:04,  1.46it/s] 85%|████████▌ | 34/40 [00:23<00:04,  1.46it/s] 88%|████████▊ | 35/40 [00:24<00:03,  1.46it/s] 90%|█████████ | 36/40 [00:24<00:02,  1.45it/s] 92%|█████████▎| 37/40 [00:25<00:02,  1.45it/s] 95%|█████████▌| 38/40 [00:26<00:01,  1.45it/s] 98%|█████████▊| 39/40 [00:26<00:00,  1.45it/s]100%|██████████| 40/40 [00:27<00:00,  1.60it/s]100%|██████████| 40/40 [00:27<00:00,  1.47it/s]
[32m2025-02-05 06:43:07.263[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    average  bleu@1  bleu@2  bleu@3  bleu@4  dist@1  dist@2  dist@3  dist@4  extreme  \
      .7804   .2974   .1119  .04286  .02272  .04349   .3015   .5763   .7390    .5985   
      f1  gen_loss  greedy  intra_dist@1  intra_dist@2  intra_dist@3  intra_dist@4  \
   .3531     5.444   .6692         .8717         .9649         .9528         .9169   
     ppl  rouge1  rouge2  rougeL  
   231.3   .3877  .09253   .3755[0m
[32m2025-02-05 06:43:07.269[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m163[0m - [1m[Conversation epoch 89][0m
[32m2025-02-05 06:43:07.269[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m164[0m - [1m[Train][0m
  0%|          | 0/92414 [00:00<?, ?it/s]100%|██████████| 92414/92414 [00:00<00:00, 997551.01it/s]
[32m2025-02-05 06:43:07.362[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/358 [00:00<?, ?it/s]  0%|          | 1/358 [00:00<00:36,  9.75it/s]  1%|          | 3/358 [00:00<00:35,  9.94it/s]  1%|          | 4/358 [00:00<00:35,  9.92it/s]  2%|▏         | 6/358 [00:00<00:35,  9.88it/s]  2%|▏         | 7/358 [00:00<00:35,  9.82it/s]  2%|▏         | 8/358 [00:00<00:35,  9.86it/s]  3%|▎         | 9/358 [00:00<00:35,  9.76it/s]  3%|▎         | 10/358 [00:01<00:35,  9.75it/s]  3%|▎         | 11/358 [00:01<00:35,  9.71it/s]  4%|▎         | 13/358 [00:01<00:34,  9.93it/s]  4%|▍         | 14/358 [00:01<00:34,  9.85it/s]  4%|▍         | 15/358 [00:01<00:35,  9.78it/s]  4%|▍         | 16/358 [00:01<00:35,  9.72it/s]  5%|▍         | 17/358 [00:01<00:35,  9.73it/s]  5%|▌         | 19/358 [00:01<00:34,  9.75it/s]  6%|▌         | 20/358 [00:02<00:34,  9.70it/s]  6%|▌         | 21/358 [00:02<00:34,  9.64it/s]  6%|▌         | 22/358 [00:02<00:34,  9.69it/s]  7%|▋         | 24/358 [00:02<00:34,  9.78it/s]  7%|▋         | 25/358 [00:02<00:34,  9.73it/s]  7%|▋         | 26/358 [00:02<00:34,  9.68it/s]  8%|▊         | 27/358 [00:02<00:34,  9.73it/s]  8%|▊         | 28/358 [00:02<00:34,  9.69it/s]  8%|▊         | 29/358 [00:02<00:34,  9.65it/s]  9%|▊         | 31/358 [00:03<00:33,  9.76it/s]  9%|▉         | 32/358 [00:03<00:33,  9.75it/s]  9%|▉         | 34/358 [00:03<00:32,  9.86it/s] 10%|█         | 36/358 [00:03<00:32,  9.86it/s] 10%|█         | 37/358 [00:03<00:32,  9.84it/s] 11%|█         | 38/358 [00:03<00:32,  9.79it/s] 11%|█         | 40/358 [00:04<00:31,  9.95it/s] 11%|█▏        | 41/358 [00:04<00:32,  9.87it/s] 12%|█▏        | 43/358 [00:04<00:31,  9.89it/s] 13%|█▎        | 45/358 [00:04<00:31,  9.99it/s] 13%|█▎        | 47/358 [00:04<00:31,  9.96it/s] 13%|█▎        | 48/358 [00:04<00:31,  9.95it/s] 14%|█▍        | 50/358 [00:05<00:31,  9.92it/s] 14%|█▍        | 51/358 [00:05<00:31,  9.85it/s] 15%|█▍        | 52/358 [00:05<00:31,  9.76it/s] 15%|█▍        | 53/358 [00:05<00:31,  9.71it/s] 15%|█▌        | 54/358 [00:05<00:31,  9.75it/s] 15%|█▌        | 55/358 [00:05<00:31,  9.70it/s] 16%|█▌        | 56/358 [00:05<00:31,  9.74it/s] 16%|█▌        | 57/358 [00:05<00:31,  9.70it/s] 16%|█▌        | 58/358 [00:05<00:31,  9.68it/s] 16%|█▋        | 59/358 [00:06<00:31,  9.64it/s] 17%|█▋        | 61/358 [00:06<00:30,  9.73it/s] 17%|█▋        | 62/358 [00:06<00:30,  9.65it/s] 18%|█▊        | 63/358 [00:06<00:30,  9.72it/s] 18%|█▊        | 64/358 [00:06<00:30,  9.67it/s] 18%|█▊        | 66/358 [00:06<00:29,  9.74it/s] 19%|█▊        | 67/358 [00:06<00:29,  9.72it/s] 19%|█▉        | 69/358 [00:07<00:29,  9.79it/s] 20%|█▉        | 70/358 [00:07<00:29,  9.73it/s] 20%|█▉        | 71/358 [00:07<00:29,  9.78it/s] 20%|██        | 72/358 [00:07<00:29,  9.73it/s] 20%|██        | 73/358 [00:07<00:29,  9.69it/s] 21%|██        | 74/358 [00:07<00:29,  9.66it/s] 21%|██        | 75/358 [00:07<00:29,  9.63it/s] 22%|██▏       | 77/358 [00:07<00:28,  9.71it/s] 22%|██▏       | 79/358 [00:08<00:28,  9.71it/s] 23%|██▎       | 81/358 [00:08<00:28,  9.77it/s] 23%|██▎       | 83/358 [00:08<00:28,  9.79it/s] 23%|██▎       | 84/358 [00:08<00:28,  9.74it/s] 24%|██▎       | 85/358 [00:08<00:28,  9.70it/s] 24%|██▍       | 86/358 [00:08<00:28,  9.68it/s] 24%|██▍       | 87/358 [00:08<00:28,  9.67it/s] 25%|██▍       | 88/358 [00:09<00:27,  9.68it/s] 25%|██▌       | 90/358 [00:09<00:27,  9.92it/s] 26%|██▌       | 92/358 [00:09<00:26, 10.02it/s] 26%|██▌       | 93/358 [00:09<00:26,  9.98it/s] 26%|██▋       | 94/358 [00:09<00:26,  9.89it/s] 27%|██▋       | 96/358 [00:09<00:25, 10.17it/s] 27%|██▋       | 98/358 [00:09<00:25, 10.06it/s] 28%|██▊       | 100/358 [00:10<00:25, 10.02it/s] 28%|██▊       | 101/358 [00:10<00:25,  9.93it/s] 29%|██▉       | 103/358 [00:10<00:25,  9.92it/s] 29%|██▉       | 104/358 [00:10<00:25,  9.87it/s] 29%|██▉       | 105/358 [00:10<00:25,  9.79it/s] 30%|██▉       | 106/358 [00:10<00:25,  9.78it/s] 30%|███       | 108/358 [00:11<00:25,  9.81it/s] 30%|███       | 109/358 [00:11<00:25,  9.72it/s] 31%|███       | 110/358 [00:11<00:25,  9.70it/s] 31%|███       | 111/358 [00:11<00:25,  9.65it/s] 32%|███▏      | 113/358 [00:11<00:24,  9.92it/s] 32%|███▏      | 114/358 [00:11<00:24,  9.88it/s] 32%|███▏      | 115/358 [00:11<00:24,  9.79it/s] 32%|███▏      | 116/358 [00:11<00:24,  9.70it/s] 33%|███▎      | 117/358 [00:11<00:24,  9.67it/s] 33%|███▎      | 119/358 [00:12<00:24,  9.79it/s] 34%|███▍      | 121/358 [00:12<00:23,  9.99it/s] 34%|███▍      | 123/358 [00:12<00:23, 10.09it/s] 35%|███▍      | 125/358 [00:12<00:23, 10.07it/s] 35%|███▌      | 127/358 [00:12<00:23, 10.00it/s] 36%|███▌      | 128/358 [00:13<00:23,  9.96it/s] 36%|███▋      | 130/358 [00:13<00:22, 10.00it/s] 37%|███▋      | 131/358 [00:13<00:22,  9.91it/s] 37%|███▋      | 132/358 [00:13<00:22,  9.93it/s] 37%|███▋      | 134/358 [00:13<00:22,  9.95it/s] 38%|███▊      | 135/358 [00:13<00:22,  9.89it/s] 38%|███▊      | 137/358 [00:13<00:22,  9.97it/s] 39%|███▊      | 138/358 [00:14<00:22,  9.95it/s] 39%|███▉      | 139/358 [00:14<00:22,  9.87it/s] 39%|███▉      | 141/358 [00:14<00:21, 10.00it/s] 40%|███▉      | 142/358 [00:14<00:21,  9.91it/s] 40%|███▉      | 143/358 [00:14<00:21,  9.88it/s] 40%|████      | 144/358 [00:14<00:21,  9.80it/s] 41%|████      | 145/358 [00:14<00:21,  9.82it/s] 41%|████      | 146/358 [00:14<00:21,  9.75it/s] 41%|████      | 147/358 [00:14<00:21,  9.69it/s] 41%|████▏     | 148/358 [00:15<00:21,  9.72it/s] 42%|████▏     | 149/358 [00:15<00:21,  9.70it/s] 42%|████▏     | 150/358 [00:15<00:21,  9.66it/s] 42%|████▏     | 151/358 [00:15<00:22,  9.40it/s] 42%|████▏     | 152/358 [00:15<00:21,  9.44it/s] 43%|████▎     | 153/358 [00:15<00:21,  9.46it/s] 43%|████▎     | 154/358 [00:15<00:21,  9.55it/s] 43%|████▎     | 155/358 [00:15<00:21,  9.56it/s] 44%|████▎     | 156/358 [00:15<00:20,  9.69it/s] 44%|████▍     | 157/358 [00:16<00:20,  9.63it/s] 44%|████▍     | 158/358 [00:16<00:20,  9.72it/s] 44%|████▍     | 159/358 [00:16<00:20,  9.71it/s] 45%|████▍     | 160/358 [00:16<00:20,  9.72it/s] 45%|████▌     | 162/358 [00:16<00:19, 10.02it/s] 46%|████▌     | 164/358 [00:16<00:19, 10.02it/s] 46%|████▌     | 165/358 [00:16<00:19,  9.97it/s] 47%|████▋     | 167/358 [00:17<00:19,  9.92it/s] 47%|████▋     | 169/358 [00:17<00:18,  9.96it/s] 48%|████▊     | 171/358 [00:17<00:18,  9.94it/s] 48%|████▊     | 172/358 [00:17<00:18,  9.89it/s] 48%|████▊     | 173/358 [00:17<00:18,  9.82it/s] 49%|████▉     | 175/358 [00:17<00:18,  9.85it/s] 49%|████▉     | 176/358 [00:17<00:18,  9.86it/s] 49%|████▉     | 177/358 [00:18<00:18,  9.85it/s] 50%|█████     | 179/358 [00:18<00:18,  9.87it/s] 50%|█████     | 180/358 [00:18<00:18,  9.80it/s] 51%|█████     | 182/358 [00:18<00:17,  9.95it/s] 51%|█████     | 183/358 [00:18<00:17,  9.90it/s] 51%|█████▏    | 184/358 [00:18<00:17,  9.79it/s] 52%|█████▏    | 185/358 [00:18<00:17,  9.74it/s] 52%|█████▏    | 187/358 [00:19<00:17,  9.95it/s] 53%|█████▎    | 188/358 [00:19<00:17,  9.90it/s] 53%|█████▎    | 189/358 [00:19<00:17,  9.84it/s] 53%|█████▎    | 191/358 [00:19<00:17,  9.76it/s] 54%|█████▎    | 192/358 [00:19<00:17,  9.71it/s] 54%|█████▍    | 193/358 [00:19<00:17,  9.70it/s] 54%|█████▍    | 194/358 [00:19<00:16,  9.68it/s] 54%|█████▍    | 195/358 [00:19<00:16,  9.75it/s] 55%|█████▌    | 197/358 [00:20<00:16,  9.92it/s] 55%|█████▌    | 198/358 [00:20<00:16,  9.85it/s] 56%|█████▌    | 199/358 [00:20<00:16,  9.88it/s] 56%|█████▌    | 200/358 [00:20<00:16,  9.81it/s] 56%|█████▌    | 201/358 [00:20<00:16,  9.77it/s] 57%|█████▋    | 203/358 [00:20<00:15,  9.86it/s] 57%|█████▋    | 204/358 [00:20<00:15,  9.76it/s] 57%|█████▋    | 205/358 [00:20<00:15,  9.72it/s] 58%|█████▊    | 207/358 [00:21<00:15,  9.88it/s] 58%|█████▊    | 208/358 [00:21<00:15,  9.81it/s] 59%|█████▊    | 210/358 [00:21<00:15,  9.83it/s] 59%|█████▉    | 212/358 [00:21<00:14,  9.82it/s] 60%|█████▉    | 214/358 [00:21<00:14,  9.90it/s] 60%|██████    | 215/358 [00:21<00:14,  9.84it/s] 60%|██████    | 216/358 [00:22<00:14,  9.77it/s] 61%|██████    | 217/358 [00:22<00:14,  9.81it/s] 61%|██████    | 218/358 [00:22<00:14,  9.78it/s] 61%|██████    | 219/358 [00:22<00:14,  9.79it/s] 62%|██████▏   | 221/358 [00:22<00:13,  9.91it/s] 62%|██████▏   | 222/358 [00:22<00:13,  9.81it/s] 62%|██████▏   | 223/358 [00:22<00:13,  9.75it/s] 63%|██████▎   | 224/358 [00:22<00:13,  9.70it/s] 63%|██████▎   | 226/358 [00:23<00:13,  9.74it/s] 64%|██████▎   | 228/358 [00:23<00:13,  9.77it/s] 64%|██████▍   | 229/358 [00:23<00:13,  9.75it/s] 64%|██████▍   | 230/358 [00:23<00:13,  9.70it/s] 65%|██████▍   | 232/358 [00:23<00:12,  9.74it/s] 65%|██████▌   | 234/358 [00:23<00:12, 10.03it/s] 66%|██████▌   | 236/358 [00:24<00:12,  9.99it/s] 66%|██████▋   | 238/358 [00:24<00:11, 10.04it/s] 67%|██████▋   | 240/358 [00:24<00:11, 10.01it/s] 68%|██████▊   | 242/358 [00:24<00:11,  9.98it/s] 68%|██████▊   | 243/358 [00:24<00:11,  9.92it/s] 68%|██████▊   | 244/358 [00:24<00:11,  9.86it/s] 69%|██████▊   | 246/358 [00:25<00:11,  9.88it/s] 69%|██████▉   | 247/358 [00:25<00:11,  9.81it/s] 69%|██████▉   | 248/358 [00:25<00:11,  9.77it/s] 70%|██████▉   | 250/358 [00:25<00:10,  9.86it/s] 70%|███████   | 251/358 [00:25<00:10,  9.80it/s] 70%|███████   | 252/358 [00:25<00:10,  9.73it/s] 71%|███████   | 253/358 [00:25<00:10,  9.69it/s] 71%|███████   | 254/358 [00:25<00:10,  9.67it/s] 72%|███████▏  | 256/358 [00:26<00:10,  9.84it/s] 72%|███████▏  | 257/358 [00:26<00:10,  9.85it/s] 72%|███████▏  | 258/358 [00:26<00:10,  9.72it/s] 72%|███████▏  | 259/358 [00:26<00:10,  9.68it/s] 73%|███████▎  | 260/358 [00:26<00:10,  9.72it/s] 73%|███████▎  | 262/358 [00:26<00:09,  9.90it/s] 74%|███████▎  | 264/358 [00:26<00:09,  9.92it/s] 74%|███████▍  | 266/358 [00:27<00:09,  9.91it/s] 75%|███████▍  | 267/358 [00:27<00:09,  9.85it/s] 75%|███████▌  | 269/358 [00:27<00:08,  9.91it/s] 75%|███████▌  | 270/358 [00:27<00:08,  9.84it/s] 76%|███████▌  | 271/358 [00:27<00:08,  9.76it/s] 76%|███████▌  | 272/358 [00:27<00:08,  9.74it/s] 76%|███████▋  | 273/358 [00:27<00:08,  9.64it/s] 77%|███████▋  | 274/358 [00:27<00:08,  9.64it/s] 77%|███████▋  | 275/358 [00:28<00:08,  9.69it/s] 77%|███████▋  | 276/358 [00:28<00:08,  9.69it/s] 77%|███████▋  | 277/358 [00:28<00:08,  9.67it/s] 78%|███████▊  | 278/358 [00:28<00:08,  9.64it/s] 78%|███████▊  | 280/358 [00:28<00:07,  9.83it/s] 78%|███████▊  | 281/358 [00:28<00:07,  9.84it/s] 79%|███████▉  | 282/358 [00:28<00:07,  9.78it/s] 79%|███████▉  | 283/358 [00:28<00:07,  9.72it/s] 79%|███████▉  | 284/358 [00:28<00:07,  9.68it/s] 80%|███████▉  | 285/358 [00:29<00:07,  9.75it/s] 80%|███████▉  | 286/358 [00:29<00:07,  9.70it/s] 80%|████████  | 287/358 [00:29<00:07,  9.68it/s] 80%|████████  | 288/358 [00:29<00:07,  9.64it/s] 81%|████████  | 290/358 [00:29<00:06,  9.85it/s] 81%|████████▏ | 291/358 [00:29<00:06,  9.84it/s] 82%|████████▏ | 293/358 [00:29<00:06,  9.85it/s] 82%|████████▏ | 295/358 [00:30<00:06,  9.92it/s] 83%|████████▎ | 296/358 [00:30<00:06,  9.85it/s] 83%|████████▎ | 297/358 [00:30<00:06,  9.75it/s] 84%|████████▎ | 299/358 [00:30<00:05,  9.91it/s] 84%|████████▍ | 301/358 [00:30<00:05,  9.94it/s] 84%|████████▍ | 302/358 [00:30<00:05,  9.88it/s] 85%|████████▍ | 303/358 [00:30<00:05,  9.89it/s] 85%|████████▌ | 305/358 [00:31<00:05,  9.92it/s] 85%|████████▌ | 306/358 [00:31<00:05,  9.84it/s] 86%|████████▌ | 308/358 [00:31<00:05,  9.94it/s] 86%|████████▋ | 309/358 [00:31<00:04,  9.83it/s] 87%|████████▋ | 310/358 [00:31<00:04,  9.78it/s] 87%|████████▋ | 311/358 [00:31<00:04,  9.70it/s] 87%|████████▋ | 312/358 [00:31<00:04,  9.72it/s] 87%|████████▋ | 313/358 [00:31<00:04,  9.74it/s] 88%|████████▊ | 315/358 [00:32<00:04, 10.00it/s] 88%|████████▊ | 316/358 [00:32<00:04,  9.95it/s] 89%|████████▊ | 317/358 [00:32<00:04,  9.86it/s] 89%|████████▉ | 318/358 [00:32<00:04,  9.82it/s] 89%|████████▉ | 319/358 [00:32<00:03,  9.77it/s] 89%|████████▉ | 320/358 [00:32<00:03,  9.83it/s] 90%|████████▉ | 321/358 [00:32<00:03,  9.75it/s] 90%|████████▉ | 322/358 [00:32<00:03,  9.71it/s] 90%|█████████ | 323/358 [00:32<00:03,  9.67it/s] 91%|█████████ | 324/358 [00:33<00:03,  9.64it/s] 91%|█████████ | 325/358 [00:33<00:03,  9.62it/s] 91%|█████████▏| 327/358 [00:33<00:03,  9.98it/s] 92%|█████████▏| 329/358 [00:33<00:02, 10.07it/s] 92%|█████████▏| 330/358 [00:33<00:02,  9.97it/s] 93%|█████████▎| 332/358 [00:33<00:02, 10.07it/s] 93%|█████████▎| 334/358 [00:34<00:02,  9.97it/s] 94%|█████████▎| 335/358 [00:34<00:02,  9.85it/s] 94%|█████████▍| 337/358 [00:34<00:02,  9.93it/s] 95%|█████████▍| 339/358 [00:34<00:01, 10.13it/s] 95%|█████████▌| 341/358 [00:34<00:01, 10.07it/s] 96%|█████████▌| 343/358 [00:34<00:01,  9.91it/s] 96%|█████████▌| 344/358 [00:35<00:01,  9.85it/s] 96%|█████████▋| 345/358 [00:35<00:01,  9.87it/s] 97%|█████████▋| 347/358 [00:35<00:01, 10.05it/s] 97%|█████████▋| 348/358 [00:35<00:01,  9.95it/s] 97%|█████████▋| 349/358 [00:35<00:00,  9.87it/s] 98%|█████████▊| 350/358 [00:35<00:00,  9.79it/s] 98%|█████████▊| 351/358 [00:35<00:00,  9.75it/s] 99%|█████████▊| 353/358 [00:35<00:00,  9.93it/s] 99%|█████████▉| 354/358 [00:36<00:00,  9.92it/s] 99%|█████████▉| 355/358 [00:36<00:00,  9.83it/s]100%|█████████▉| 357/358 [00:36<00:00,  9.88it/s]100%|██████████| 358/358 [00:36<00:00,  9.84it/s]
[32m2025-02-05 06:43:43.762[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    gen_loss  grad clip ratio  grad norm   ppl
       1.712                1      2.532 5.539[0m
[32m2025-02-05 06:43:43.762[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m169[0m - [1m[Valid][0m
  0%|          | 0/10256 [00:00<?, ?it/s]100%|██████████| 10256/10256 [00:00<00:00, 1152554.24it/s]
[32m2025-02-05 06:43:43.771[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:27,  1.43it/s]  5%|▌         | 2/40 [00:01<00:26,  1.45it/s]  8%|▊         | 3/40 [00:02<00:25,  1.45it/s] 10%|█         | 4/40 [00:02<00:24,  1.46it/s] 12%|█▎        | 5/40 [00:03<00:24,  1.44it/s] 15%|█▌        | 6/40 [00:04<00:23,  1.45it/s] 18%|█▊        | 7/40 [00:04<00:22,  1.44it/s] 20%|██        | 8/40 [00:05<00:22,  1.45it/s] 22%|██▎       | 9/40 [00:06<00:21,  1.45it/s] 25%|██▌       | 10/40 [00:06<00:20,  1.45it/s] 28%|██▊       | 11/40 [00:07<00:19,  1.45it/s] 30%|███       | 12/40 [00:08<00:19,  1.45it/s] 32%|███▎      | 13/40 [00:08<00:18,  1.45it/s] 35%|███▌      | 14/40 [00:09<00:18,  1.44it/s] 38%|███▊      | 15/40 [00:10<00:17,  1.44it/s] 40%|████      | 16/40 [00:11<00:16,  1.44it/s] 42%|████▎     | 17/40 [00:11<00:15,  1.45it/s] 45%|████▌     | 18/40 [00:12<00:15,  1.45it/s] 48%|████▊     | 19/40 [00:13<00:14,  1.44it/s] 50%|█████     | 20/40 [00:13<00:13,  1.45it/s] 52%|█████▎    | 21/40 [00:14<00:12,  1.46it/s] 55%|█████▌    | 22/40 [00:15<00:12,  1.46it/s] 57%|█████▊    | 23/40 [00:15<00:11,  1.46it/s] 60%|██████    | 24/40 [00:16<00:11,  1.45it/s] 62%|██████▎   | 25/40 [00:17<00:10,  1.45it/s] 65%|██████▌   | 26/40 [00:17<00:09,  1.46it/s] 68%|██████▊   | 27/40 [00:18<00:08,  1.46it/s] 70%|███████   | 28/40 [00:19<00:08,  1.46it/s] 72%|███████▎  | 29/40 [00:19<00:07,  1.46it/s] 75%|███████▌  | 30/40 [00:20<00:06,  1.46it/s] 78%|███████▊  | 31/40 [00:21<00:06,  1.46it/s] 80%|████████  | 32/40 [00:22<00:05,  1.46it/s] 82%|████████▎ | 33/40 [00:22<00:04,  1.45it/s] 85%|████████▌ | 34/40 [00:23<00:04,  1.46it/s] 88%|████████▊ | 35/40 [00:24<00:03,  1.45it/s] 90%|█████████ | 36/40 [00:24<00:02,  1.44it/s] 92%|█████████▎| 37/40 [00:25<00:02,  1.45it/s] 95%|█████████▌| 38/40 [00:26<00:01,  1.44it/s] 98%|█████████▊| 39/40 [00:26<00:00,  1.44it/s]100%|██████████| 40/40 [00:27<00:00,  1.59it/s]100%|██████████| 40/40 [00:27<00:00,  1.46it/s]
[32m2025-02-05 06:44:11.176[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    average  bleu@1  bleu@2  bleu@3  bleu@4  dist@1  dist@2  dist@3  dist@4  extreme  \
      .7792   .2997   .1114   .0413  .02048  .04194   .2875   .5485   .7049    .6016   
      f1  gen_loss  greedy  intra_dist@1  intra_dist@2  intra_dist@3  intra_dist@4  \
   .3496     5.445   .6707         .8547         .9543         .9433         .9138   
     ppl  rouge1  rouge2  rougeL  
   231.6   .3884  .09096   .3768[0m
[32m2025-02-05 06:44:11.176[0m | [1mINFO    [0m | [36mcrslab.system.kgsf[0m:[36mtrain_conversation[0m:[36m176[0m - [1m[Test][0m
  0%|          | 0/14362 [00:00<?, ?it/s]100%|██████████| 14362/14362 [00:00<00:00, 1035685.81it/s]
[32m2025-02-05 06:44:11.196[0m | [1mINFO    [0m | [36mcrslab.data.dataloader.base[0m:[36mget_data[0m:[36m54[0m - [1m[Finish dataset process before batchify][0m
  0%|          | 0/56 [00:00<?, ?it/s]  2%|▏         | 1/56 [00:00<00:48,  1.13it/s]  4%|▎         | 2/56 [00:01<00:47,  1.15it/s]  5%|▌         | 3/56 [00:02<00:46,  1.15it/s]  7%|▋         | 4/56 [00:03<00:44,  1.16it/s]  9%|▉         | 5/56 [00:04<00:44,  1.15it/s] 11%|█         | 6/56 [00:05<00:42,  1.16it/s] 12%|█▎        | 7/56 [00:06<00:42,  1.15it/s] 14%|█▍        | 8/56 [00:06<00:41,  1.15it/s] 16%|█▌        | 9/56 [00:07<00:40,  1.15it/s] 18%|█▊        | 10/56 [00:08<00:39,  1.15it/s] 20%|█▉        | 11/56 [00:09<00:38,  1.16it/s] 21%|██▏       | 12/56 [00:10<00:37,  1.17it/s] 23%|██▎       | 13/56 [00:11<00:36,  1.16it/s] 25%|██▌       | 14/56 [00:12<00:36,  1.16it/s] 27%|██▋       | 15/56 [00:12<00:35,  1.16it/s] 29%|██▊       | 16/56 [00:13<00:34,  1.18it/s] 30%|███       | 17/56 [00:14<00:32,  1.19it/s] 32%|███▏      | 18/56 [00:15<00:32,  1.18it/s] 34%|███▍      | 19/56 [00:16<00:31,  1.16it/s] 36%|███▌      | 20/56 [00:17<00:31,  1.16it/s] 38%|███▊      | 21/56 [00:18<00:30,  1.16it/s] 39%|███▉      | 22/56 [00:18<00:29,  1.17it/s] 41%|████      | 23/56 [00:19<00:28,  1.16it/s] 43%|████▎     | 24/56 [00:20<00:27,  1.16it/s] 45%|████▍     | 25/56 [00:21<00:26,  1.15it/s] 46%|████▋     | 26/56 [00:22<00:25,  1.17it/s] 48%|████▊     | 27/56 [00:23<00:25,  1.15it/s] 50%|█████     | 28/56 [00:24<00:24,  1.15it/s] 52%|█████▏    | 29/56 [00:24<00:23,  1.16it/s] 54%|█████▎    | 30/56 [00:25<00:22,  1.17it/s] 55%|█████▌    | 31/56 [00:26<00:21,  1.19it/s] 57%|█████▋    | 32/56 [00:27<00:20,  1.18it/s] 59%|█████▉    | 33/56 [00:28<00:19,  1.17it/s] 61%|██████    | 34/56 [00:29<00:18,  1.18it/s] 62%|██████▎   | 35/56 [00:30<00:18,  1.16it/s] 64%|██████▍   | 36/56 [00:30<00:17,  1.16it/s] 66%|██████▌   | 37/56 [00:31<00:16,  1.15it/s] 68%|██████▊   | 38/56 [00:32<00:15,  1.15it/s] 70%|██████▉   | 39/56 [00:33<00:14,  1.15it/s] 71%|███████▏  | 40/56 [00:34<00:13,  1.15it/s] 73%|███████▎  | 41/56 [00:35<00:12,  1.16it/s] 75%|███████▌  | 42/56 [00:36<00:12,  1.15it/s] 77%|███████▋  | 43/56 [00:37<00:11,  1.15it/s] 79%|███████▊  | 44/56 [00:37<00:10,  1.14it/s] 80%|████████  | 45/56 [00:38<00:09,  1.16it/s] 82%|████████▏ | 46/56 [00:39<00:08,  1.15it/s] 84%|████████▍ | 47/56 [00:40<00:07,  1.14it/s] 86%|████████▌ | 48/56 [00:41<00:07,  1.14it/s] 88%|████████▊ | 49/56 [00:42<00:06,  1.14it/s] 89%|████████▉ | 50/56 [00:43<00:05,  1.17it/s] 91%|█████████ | 51/56 [00:43<00:04,  1.16it/s] 93%|█████████▎| 52/56 [00:44<00:03,  1.16it/s] 95%|█████████▍| 53/56 [00:45<00:02,  1.15it/s] 96%|█████████▋| 54/56 [00:46<00:01,  1.15it/s] 98%|█████████▊| 55/56 [00:47<00:00,  1.16it/s]100%|██████████| 56/56 [00:47<00:00,  1.40it/s]100%|██████████| 56/56 [00:47<00:00,  1.17it/s]
[32m2025-02-05 06:44:59.041[0m | [1mINFO    [0m | [36mcrslab.evaluator.standard[0m:[36mreport[0m:[36m130[0m - [1m
    average  bleu@1  bleu@2  bleu@3  bleu@4  dist@1  dist@2  dist@3  dist@4  extreme  \
      .7260   .1740  .04912  .02244  .01283  .03091   .1375   .2523   .3465    .5048   
      f1  greedy  intra_dist@1  intra_dist@2  intra_dist@3  intra_dist@4  rouge1  \
   .2155   .5976         .8460         .9898         .9958         .9906   .2502   
    rouge2  rougeL  
    .04595   .2440[0m

JOB STATISTICS
==============
Job ID: 9776977
Cluster: snellius
User/Group: jzhao/jzhao
State: COMPLETED (exit code 0)
Nodes: 1
Cores per node: 18
CPU Utilized: 01:58:31
CPU Efficiency: 6.20% of 1-07:51:54 core-walltime
Job Wall-clock time: 01:46:13
Memory Utilized: 7.11 GB
Memory Efficiency: 5.93% of 120.00 GB
